/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2014 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int init_proc();
// int __cdecl evutil_inet_pton(_DWORD, _DWORD, _DWORD); weak
// int __cdecl BIO_new_mem_buf(_DWORD, _DWORD); weak
// void evbuffer_drain(struct evbuffer *, size_t);
// int __cdecl SSL_get_rbio(_DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl std::__throw_length_error(const char *); idb
// int __cdecl evutil_socket_set_no_linger(_DWORD); weak
// __int32 sysconf(int name);
// int __cdecl evdns_base_new(_DWORD, _DWORD); weak
// int __cdecl BIO_free(_DWORD); weak
// int __cdecl std::ostream::operator<<(_DWORD, _DWORD); weak
// int __cdecl evutil_inet_ntop(_DWORD, _DWORD, _DWORD, _DWORD); weak
// struct evbuffer *evbuffer_new(void);
// int sk_pop_free(_DWORD, const char *, ...); weak
// int __cdecl evhttp_remove_header(_DWORD, _DWORD); weak
// int *_errno_location(void);
// int __cdecl BIO_ctrl(_DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD std::__throw_bad_cast(void); idb
// char *getenv(const char *name);
// int __cdecl event_base_free(_DWORD); weak
// _DWORD std::ios_base::ios_base(std::ios_base *this); idb
// int __cdecl bufferevent_openssl_socket_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl X509_STORE_CTX_get_error(_DWORD); weak
// int __cdecl evhttp_connection_set_reset_on_close(_DWORD, _DWORD); weak
// int __cdecl evhttp_make_request(_DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl std::runtime_error::runtime_error(std::runtime_error *__hidden this, const std::string *); idb
// int __cdecl SSL_CTX_set_cert_verify_callback(_DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl std::__throw_system_error(int); idb
// int __cdecl X509_NAME_oneline(_DWORD, _DWORD, _DWORD); weak
// int __cdecl ASN1_STRING_length(_DWORD); weak
// int __cdecl evhttp_request_set_error_cb(_DWORD, _DWORD); weak
// unsigned int sleep(unsigned int seconds);
// _DWORD __cdecl std::string::find_last_not_of(std::string *this, const char *, unsigned int, unsigned int); idb
// int evbuffer_remove(struct evbuffer *, void *, size_t);
// void __cdecl operator delete(void *); idb
// int __cdecl bufferevent_get_underlying(_DWORD); weak
// int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD); weak
// void bufferevent_free(struct bufferevent *bufev);
// _DWORD std::condition_variable::notify_all(std::condition_variable *this); idb
// int sysinfo(struct sysinfo *info);
// int __cdecl std::ctype<char>::_M_widen_init(_DWORD); weak
// int OPENSSL_add_all_algorithms_noconf(void); weak
// int __cdecl X509_NAME_get_index_by_NID(_DWORD, _DWORD, _DWORD); weak
// int __cdecl SSL_CTX_set_verify(_DWORD, _DWORD, _DWORD); weak
// int bufferevent_enable(struct bufferevent *bufev, __int16 event);
// int __cdecl evhttp_connection_get_bufferevent(_DWORD); weak
// int __cdecl bufferevent_setcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD std::istream::tellg(std::istream *this); idb
// int _cxa_rethrow(void); weak
// int __cdecl sk_value(_DWORD, _DWORD); weak
// _DWORD std::ios_base::Init::Init(std::ios_base::Init *this); idb
// int prctl(int option, ...);
// int deflate(z_streamp strm, int flush);
// int __cdecl bufferevent_socket_new(_DWORD, _DWORD, _DWORD); weak
// int __cdecl SSL_ctrl(_DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl std::string::find(std::string *this, char, unsigned int); idb
// int evbuffer_add_buffer(struct evbuffer *, struct evbuffer *);
// int SSL_load_error_strings(void); weak
// int __cdecl PEM_X509_INFO_read_bio(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall evutil_freeaddrinfo(_DWORD, _DWORD); weak
// int EVP_MD_CTX_create(void); weak
// _DWORD std::ostream::ostream(std::ostream *this); idb
// _DWORD std::chrono::_V2::system_clock::now(std::chrono::_V2::system_clock *this); idb
// int __cdecl std::_Rb_tree_decrement(_DWORD); weak
// __int32 atol(const char *nptr);
// void *malloc(size_t size);
// _DWORD __cdecl std::string::compare(std::string *this, const std::string *); idb
// _DWORD __cdecl std::string::string(std::string *this, const std::string *); idb
// int __cdecl std::this_thread::__sleep_for(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl evhttp_connection_base_bufferevent_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl std::thread::_M_start_thread(int a1, struct_thread_imp **a2); idb
// int __cdecl std::basic_filebuf<char,std::char_traits<char>>::open(_DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl std::__throw_out_of_range(const char *); idb
// _DWORD __cdecl std::runtime_error::~runtime_error(std::runtime_error *this); idb
// size_t strlen(const char *s);
// int pthread_mutex_lock(pthread_mutex_t *mutex);
// int __cdecl X509_get_subject_name(_DWORD); weak
// int __cdecl evdns_base_free(_DWORD, _DWORD); weak
// int __cdecl SSL_free(_DWORD); weak
// _DWORD __cdecl std::string::string(std::string *this, const std::string *, unsigned int, unsigned int); idb
// _DWORD __cdecl std::string::insert(std::string *this, unsigned int, const char *, unsigned int); idb
// _DWORD __cdecl std::ios_base::Init::~Init(std::ios_base::Init *this); idb
// ssize_t sendto(int fd, const void *buf, size_t n, int flags, const struct sockaddr *addr, socklen_t addr_len);
// int __cdecl X509_NAME_get_entry(_DWORD, _DWORD); weak
// int event_base_dispatch(struct event_base *);
// int snprintf(char *s, size_t maxlen, const char *format, ...);
// int __cdecl std::operator<<<std::char_traits<char>>(_DWORD, _DWORD); weak
// int __cdecl evbuffer_get_length(_DWORD); weak
// int dup2(int fd, int fd2);
// void evbuffer_free(struct evbuffer *);
// int __cdecl evdns_getaddrinfo(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// ssize_t read(int fd, void *buf, size_t nbytes);
// int __cdecl pcre_exec(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl evdns_getaddrinfo_cancel(_DWORD); weak
// int execv(const char *path, char *const *argv);
// int __cdecl evhttp_request_set_chunked_cb(_DWORD, _DWORD); weak
// void exit(int status);
// int __cdecl event_base_loopbreak(_DWORD); weak
// int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD); weak
// int __cdecl X509_get_ext_d2i(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int deflateEnd(z_streamp strm);
// void _assert(const char *assertion, const char *file, int line);
// int __cdecl evhttp_find_header(_DWORD, _DWORD); weak
// int __cdecl SSL_CTX_new(_DWORD); weak
// _DWORD __cdecl std::istream::read(std::istream *this, char *, int); idb
// int __cdecl evbuffer_commit_space(_DWORD, _DWORD, _DWORD); weak
// void *memmove(void *dest, const void *src, size_t n);
// int pclose(FILE *stream);
// int fclose(FILE *stream);
// _DWORD __cdecl std::string::replace(std::string *this, unsigned int, unsigned int, const char *, unsigned int); idb
// int __cdecl X509_verify_cert(_DWORD); weak
// size_t fread(void *ptr, size_t size, size_t n, FILE *stream);
// FILE *fopen(const char *filename, const char *modes);
// int __cdecl bufferevent_openssl_set_allow_dirty_shutdown(_DWORD, _DWORD); weak
// int __cdecl X509_verify_cert_error_string(_DWORD); weak
// int __cdecl event_remove_timer(_DWORD); weak
// time_t time(time_t *timer);
// int __cdecl std::_Rb_tree_increment(_DWORD); weak
// _DWORD __cdecl std::string::resize(std::string *this, unsigned int, char); idb
// _DWORD __cdecl std::string::compare(std::string *this, const char *); idb
// __int64 atoll(const char *nptr);
// int __cdecl std::string::string(_DWORD, _DWORD, _DWORD); weak
// _DWORD std::thread::join(std::thread *this); idb
// int __cdecl std::basic_ifstream<char,std::char_traits<char>>::~basic_ifstream(_DWORD); weak
// _DWORD std::condition_variable::condition_variable(std::condition_variable *this); idb
// int __cdecl evbuffer_reserve_space(_DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD std::terminate(void); idb
// int close(int fd);
// int __cdecl evutil_make_socket_nonblocking(_DWORD); weak
// int __cdecl bufferevent_getfd(_DWORD); weak
// _DWORD std::locale::locale(std::locale *this); idb
// int sigaction(int sig, const struct sigaction *act, struct sigaction *oact);
// int event_add(struct event *, struct timeval *);
// int __cdecl evhttp_connection_set_timeout(_DWORD, _DWORD); weak
// int __cdecl std::ostream::_M_insert<bool>(_DWORD, _DWORD); weak
// int pthread_cond_timedwait(pthread_cond_t *cond, pthread_mutex_t *mutex, const struct timespec *abstime);
// int __cdecl EVP_MD_CTX_destroy(_DWORD); weak
// _DWORD __cdecl operator new(unsigned int); idb
// int __cdecl SSL_get_wbio(_DWORD); weak
// int __cdecl sk_num(_DWORD); weak
// int __cdecl pcre_compile(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl std::condition_variable::~condition_variable(std::condition_variable *this);
// int __cdecl ASN1_STRING_data(_DWORD); weak
// int __cdecl bufferevent_socket_connect_hostname(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl evbuffer_add_reference(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD); weak
// int __cdecl evbuffer_pullup(_DWORD, _DWORD); weak
// int SSL_library_init(void); weak
// int __cdecl evhttp_request_new(_DWORD, _DWORD); weak
// int __cdecl evhttp_connection_set_bufferevent(_DWORD, _DWORD); weak
// int execl(const char *path, const char *arg, ...);
// _DWORD __cdecl std::string::_M_mutate(std::string *this, unsigned int, unsigned int, unsigned int); idb
// int __cdecl std::_Rb_tree_insert_and_rebalance(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl SSL_clear(_DWORD, _DWORD, _DWORD); weak
// int __cdecl evconnlistener_free(_DWORD); weak
// _DWORD std::ostream::flush(std::ostream *this); idb
// _DWORD std::__throw_bad_function_call(void); idb
// int __cdecl X509_STORE_CTX_get_current_cert(_DWORD); weak
// _DWORD __cdecl std::__detail::_Prime_rehash_policy::_M_need_rehash(std::__detail::_Prime_rehash_policy *this, unsigned int, unsigned int, unsigned int); idb
// int __cdecl bufferevent_setwatermark(_DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl std::ios_base::~ios_base(std::ios_base *this); idb
// int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD); weak
// int __cdecl SSL_new(_DWORD); weak
// int __cdecl std::__basic_file<char>::~__basic_file(_DWORD); weak
// int __cdecl evbuffer_add_buffer_reference(_DWORD, _DWORD); weak
// int fprintf(FILE *stream, const char *format, ...);
// int bufferevent_write(struct bufferevent *bufev, void *data, size_t size);
// int __cdecl _cxa_allocate_exception(_DWORD); weak
// int __cdecl evhttp_add_header(int a1, char *a2, char *a3);
// int __cdecl SSL_CTX_get_cert_store(_DWORD); weak
// int __cdecl bufferevent_getcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl event_free(_DWORD); weak
// void abort(void);
// int memcmp(const void *s1, const void *s2, size_t n);
// int pthread_equal(pthread_t thread1, pthread_t thread2);
// void syslog(int pri, const char *fmt, ...);
// int __cdecl bufferevent_openssl_filter_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl bufferevent_get_base(_DWORD); weak
// int sprintf(char *s, const char *format, ...);
// _DWORD __cdecl std::string::assign(std::string *this, const std::string *); idb
// int __cdecl bufferevent_set_timeouts(_DWORD, _DWORD, _DWORD); weak
// int event_base_new(void); weak
// _DWORD __cdecl std::__throw_logic_error(const char *); idb
// _DWORD __cdecl std::__detail::_Prime_rehash_policy::_M_next_bkt(std::__detail::_Prime_rehash_policy *this, unsigned int); idb
// _DWORD __cdecl std::string::assign(std::string *this, const char *, unsigned int); idb
// int __cdecl evhttp_connection_free(_DWORD, _DWORD, _DWORD); weak
// int socket(int domain, int type, int protocol);
// int deflateInit2_(z_streamp strm, int level, int method, int windowBits, int memLevel, int strategy, const char *version, int stream_size);
// int rand(void);
// int __cdecl evdns_base_set_option(_DWORD, _DWORD, _DWORD); weak
// int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD); weak
// int __cdecl _cxa_throw(_DWORD, _DWORD, _DWORD); weak
// int __cdecl evutil_closesocket(_DWORD); weak
// int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD); weak
// void exit(int status);
// __pid_t fork(void);
// int __cdecl std::basic_filebuf<char,std::char_traits<char>>::basic_filebuf(_DWORD); weak
// int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD); weak
// int pthread_mutex_unlock(pthread_mutex_t *mutex);
// int __cdecl std::_Rb_tree_increment(_DWORD); weak
// int __cdecl std::ostream::_M_insert<double>(_DWORD, _DWORD, _DWORD); weak
// _DWORD std::__throw_bad_alloc(void); idb
// int strcmp(const char *s1, const char *s2);
// int __cdecl std::string::_Rep::_S_create(_DWORD, _DWORD, _DWORD); weak
// int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD); weak
// __pid_t waitpid(__pid_t pid, int *stat_loc, int options);
// int __cdecl EVP_DigestInit_ex(_DWORD, _DWORD, _DWORD); weak
// int __cdecl EVP_DigestFinal_ex(_DWORD, _DWORD, _DWORD); weak
// int __cdecl std::endl<char,std::char_traits<char>>(_DWORD); weak
// int __cdecl evhttp_request_get_input_buffer(_DWORD); weak
// int __cdecl evbuffer_copyout(_DWORD, _DWORD, _DWORD); weak
// int ERR_load_crypto_strings(void); weak
// int __cdecl _cxa_begin_catch(_DWORD); weak
// int __cdecl std::istream::seekg(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl std::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_stringstream(_DWORD); weak
// int __cdecl bufferevent_get_input(_DWORD); weak
// _DWORD __cdecl std::string::append(std::string *this, const char *, unsigned int); idb
// void free(void *ptr);
// _DWORD __cdecl std::logic_error::~logic_error(std::logic_error *this); idb
// int atoi(const char *nptr);
// _DWORD std::chrono::_V2::steady_clock::now(std::chrono::_V2::steady_clock *this); idb
// int __cdecl event_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl BIO_int_ctrl(_DWORD, _DWORD, _DWORD, _DWORD); weak
// char *strchr(const char *s, int c);
// int __cdecl evconnlistener_new_bind(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD); weak
// int __cdecl event_base_once(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl bufferevent_get_output(_DWORD); weak
// FILE *popen(const char *command, const char *modes);
// int bufferevent_disable(struct bufferevent *bufev, __int16 event);
// int __cdecl Unwind_Resume(_DWORD); weak
// _DWORD __cdecl std::locale::~locale(std::locale *this); idb
// int fscanf(FILE *stream, const char *format, ...);
// _DWORD __cdecl std::ostream::put(std::ostream *this, char); idb
// _DWORD std::string::_M_leak_hard(std::string *this); idb
// int __cdecl bufferevent_setfd(_DWORD, _DWORD); weak
// _DWORD __cdecl std::string::swap(std::string *this, std::string *); idb
// __sighandler_t signal(int sig, __sighandler_t handler);
// int EVP_sha1(void); weak
// int __cdecl X509_NAME_ENTRY_get_data(_DWORD); weak
// _DWORD __cdecl std::string::append(std::string *this, const std::string *); idb
// int __cdecl SSL_CTX_free(_DWORD); weak
// int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD); weak
// int __cdecl std::basic_filebuf<char,std::char_traits<char>>::close(_DWORD); weak
// int pipe(int *pipedes);
// int __cdecl EVP_DigestUpdate(_DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl std::string::reserve(std::string *this, unsigned int); idb
// int __cdecl X509_STORE_add_cert(_DWORD, _DWORD); weak
// int kill(__pid_t pid, int sig);
// int SSLv23_method(void); weak
// int __usercall sub_804D5EC@<eax>(int a1@<eax>);
void __noreturn sub_804D6DE();
void __noreturn sub_804D724();
void __noreturn sub_804D74C();
void __noreturn sub_804D774();
int sub_804D7A0();
int sub_804D7C0();
int sub_804D880();
int sub_804D8A0();
int sub_804D8C0();
int sub_804D8E0();
int sub_804D910();
int sub_804D930();
int sub_804D950();
int sub_804D970();
int sub_804D990();
int sub_804D9C0();
int sub_804D9E0();
int sub_804DA00();
int sub_804DA20();
int sub_804DA40();
int sub_804DA60();
int sub_804DA80();
int sub_804DAA0();
int sub_804DAC0();
int sub_804DAE0();
int sub_804DB00();
int __cdecl main(int argc, const char **argv, const char **envp);
int sub_804DF70();
void sub_804DFA8();
signed int sub_804DFAC();
int __fastcall sub_804E00B(int a1, int a2);
int sub_804E053();
// int __usercall sub_804E060@<eax>(int a1@<eax>);
int __cdecl sub_804E080(void **a1, void **a2, signed int a3);
int __cdecl sub_804E120(void **a1, void **a2, signed int a3);
int __cdecl sub_804E1C0(void **a1, void **a2, signed int a3);
// void __usercall sub_804E260(unsigned int a1@<eax>);
// void __usercall sub_804E310(int a1@<eax>);
void __cdecl sub_804E8E0(int a1);
void __cdecl sub_804E980(void *a1);
int __cdecl sub_804EE40(int a1, int a2);
// int __userpurge sub_804F340@<eax>(int a1, int a2, int a3);
pthread_mutex_t *__cdecl sub_804F480(pthread_mutex_t *mutex, int a2, int a3);
// int __userpurge sub_804F5E0@<eax>(int a1, int a2, int a3);
// pthread_mutex_t *__usercall sub_804FB50@<eax>(int a1@<edi>, pthread_mutex_t *mutex, int a3, int a4);
// char __usercall sub_8050BF0@<al>(int a1@<edi>, std::ios_base *a2@<esi>, pthread_mutex_t *mutex, int a4);
_DWORD __cdecl loc_8050C70(pthread_mutex_t *mutex, _DWORD); // weak
// signed int __usercall sub_8051390@<eax>(int a1@<eax>, int *a2@<edx>);
int __cdecl sub_8051490(pthread_mutex_t *mutex, int); // idb
int __cdecl sub_8051580(pthread_mutex_t *); // idb
int __cdecl sub_80518D0(pthread_mutex_t *); // idb
int sub_80531A0(); // weak
int __cdecl sub_80531C0(pthread_mutex_t *mutex, int, int); // idb
// char __usercall sub_8055FC0@<al>(std::ios_base *a1@<esi>, pthread_mutex_t *mutex, int a3, int a4);
// int __usercall sub_8056B10@<eax>(std::ios_base *a1@<esi>, pthread_mutex_t ***a2, int a3, int *a4);
int __cdecl sub_8056CA0(int a1);
int __cdecl sub_8056CF0(int a1);
void __cdecl sub_8056D50(std::logic_error *a1);
void __cdecl sub_8056D80(void *a1);
void __cdecl sub_8056DD0(void *a1);
int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf(int a1);
void __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf(void *a1);
int __cdecl sub_8056F10(int a1);
char __cdecl sub_8056FF0(int a1, unsigned __int8 a2);
int __cdecl sub_8057050(int a1);
int __cdecl sub_8057220(int a1);
void __cdecl sub_8057760(int a1);
void __cdecl sub_8057D00(void *a1);
int __cdecl sub_8057D60(int a1, int a2);
void __cdecl sub_8057D90(void *a1);
void __cdecl sub_8057E00(void *a1, int a2, void *a3);
void __cdecl sub_8057E50(void *a1);
// int __userpurge sub_8057EB0@<eax>(int a1, int a2, int a3, int a4);
// int __userpurge sub_8058060@<eax>(int a1, int a2, int a3, int a4);
int __cdecl sub_8058140(int a1, int a2);
int __cdecl sub_8058470(int a1, int a2);
pthread_mutex_t *__cdecl sub_80584A0(int a1, int a2);
int __cdecl sub_80584E0(int a1, int a2);
int __cdecl sub_8058600(int a1, int a2);
int __cdecl sub_8058720(int a1, int a2);
void __cdecl sub_8058890(void *dest, void *src, size_t n, int a4);
int __cdecl sub_8058B80(int a1, int a2);
int __cdecl sub_8059130(int a1, int a2);
int __cdecl sub_8059240(int a1, int a2);
int __cdecl sub_80597C0(int a1, int a2);
// int __userpurge sub_80598E0@<eax>(int a1, int a2, int a3, unsigned int a4, int a5);
int __cdecl sub_8059AA0(int a1, int a2, int a3, int a4);
// int __userpurge sub_8059B00@<eax>(int a1, int a2, int a3, int a4);
// int __userpurge sub_8059D00@<eax>(int a1, int a2, int *a3);
// int __usercall std::string::_S_construct<char *>@<eax>(int a1@<ebx>, unsigned int a2@<ebp>, void *a3@<edi>, int a4, int a5, int a6);
int __cdecl sub_8059EC0(void **a1, void **a2, signed int a3);
int __cdecl init_loglevel(std::string *); // idb
int sub_805A040(); // weak
int __cdecl sub_805A050(char *s); // idb
std::string *__stdcall sub_805D460(std::string *a1);
int sub_805E7E0(); // weak
int sub_805E810(); // weak
int sub_805E830(); // weak
int __cdecl sub_805E890(int a1, const char **a2);
int __cdecl sub_805E8C0(void **a1, void **a2, signed int a3);
int __cdecl sub_805E960(void **a1, void **a2, signed int a3);
int __cdecl sub_805EA00(void **a1, void **a2, signed int a3);
int __cdecl sub_805EAA0(void **a1, void **a2, signed int a3);
signed int __cdecl sub_805EB40(int a1);
int __cdecl sub_805ED30(int a1, int a2);
int __cdecl sub_805EDA0(int a1, int a2);
int __cdecl sub_805EE10(int a1, int a2, signed int a3);
void __cdecl sub_805EF00(int a1, void *a2);
// int __userpurge sub_805EFB0@<eax>(int a1, int a2, const void **a3);
// int __userpurge sub_805F0F0@<eax>(int a1, int a2, int a3, int a4, int a5);
int __cdecl sub_805F4A0(int a1, int a2, int a3);
int __cdecl sub_805F840(int a1, int a2, int a3);
int __cdecl sub_805FC80(int a1);
int __cdecl sub_805FCA0(void **a1, void **a2, signed int a3);
int __cdecl sub_805FD40(void **a1, void **a2, signed int a3);
int __cdecl sub_805FDE0(void **a1, void **a2, signed int a3);
int __cdecl sub_805FE80(void **a1, void **a2, signed int a3);
int __cdecl sub_805FF20(void **a1, void **a2, signed int a3);
int __cdecl sub_805FFC0(void **a1, void **a2, signed int a3);
int __cdecl sub_8060060(void **a1, void **a2, signed int a3);
// int __userpurge sub_8060100@<eax>(int a1, int a2, int a3);
int __cdecl start_trace(int a1, int a2, int a3, int a4);
void __cdecl __noreturn sub_8060390(int a1);
int __cdecl sub_80603C0(int, std::string *, std::string *); // idb
pthread_mutex_t *__cdecl sub_80604C0(int a1, int a2);
int sub_80605C0(); // weak
int sub_8060680(); // weak
int __cdecl start_tunel(int a1, int a2, int a3, int a4);
int sub_8060F00(); // weak
char __cdecl sub_8060F60(int a1, int a2);
int __cdecl sub_8061500(int a1, int a2);
int __cdecl sub_80616D0(int **a1, int a2, int a3);
int __cdecl sub_8061930(int **a1, int a2, int a3);
char __cdecl sub_8061B10(pthread_mutex_t *a1, int a2);
char __cdecl sub_8062970(pthread_mutex_t *a1, int a2);
int __cdecl sub_8064190(pthread_mutex_t *, int); // idb
int __cdecl sub_8064980(pthread_mutex_t *, int); // idb
void __cdecl sub_8065A60(pthread_mutex_t *a1);
char __cdecl sub_8065EF0(pthread_mutex_t *a1);
int __cdecl sub_8067160(int a1);
void __cdecl sub_8067710(void *a1);
int __cdecl sub_8067CC0(int a1);
int __cdecl sub_8067D20(int a1);
// int __userpurge sub_8067DC0@<eax>(int a1, std::string *a2);
void __cdecl sub_8067E80(void *a1);
void __cdecl sub_8067F00(void *a1);
void __cdecl sub_8067F60(int a1);
// int __userpurge sub_8068500@<eax>(int a1, int a2);
int __cdecl sub_8068630(int a1, int a2);
int __cdecl sub_8068750(int a1, int a2);
int __cdecl sub_8068790(int a1, int a2);
int __cdecl sub_80688B0(int a1, int a2);
int __cdecl sub_80689D0(int a1, int a2);
int __cdecl sub_8069240(int a1, int a2);
int __cdecl sub_8069320(void *a1, int a2, int a3, int a4);
int __cdecl sub_80698F0(int a1, int a2);
int __cdecl sub_8069910(int a1, int a2, int a3, unsigned int a4);
int sub_806A0B0(); // weak
int __cdecl sub_806A110(int a1, int a2);
int __cdecl sub_806B560(int a1);
void __cdecl sub_806B590(void *a1);
int __cdecl sub_806B5D0(int a1);
void __cdecl sub_806B680(void *a1);
void __cdecl sub_806B730(int a1, unsigned int a2);
int __cdecl sub_806B850(int, void *); // idb
int __cdecl sub_806CCE0(void **a1, void **a2, signed int a3);
int __cdecl sub_806CD80(void **a1, void **a2, signed int a3);
void __cdecl sub_806CE20(int a1, int a2);
void __cdecl sub_806D3F0(int a1, int a2, int a3);
void __cdecl sub_806D9E0(int **a1, int a2);
int __cdecl sub_806DA10(int a1, int a2);
int __cdecl sub_806E1B0(int a1, int a2, int a3);
int __cdecl sub_806E980(int **a1, int a2);
// int __usercall sub_806E9B0@<eax>(int a1@<eax>);
// int __usercall sub_806E9F0@<eax>(int a1@<eax>);
int __cdecl sub_806EA30(int a1, int a2, int a3, int a4);
int __cdecl sub_806EB90(int a1);
int sub_806EC60(); // weak
int sub_806F1B0(); // weak
int sub_806F730(); // weak
void __cdecl sub_806F740(int a1);
int sub_8071250(); // weak
int sub_8071270(); // weak
int sub_8071F80(); // weak
int sub_8071FA0(); // weak
int sub_8071FC0(); // weak
int sub_8071FD0(); // weak
int __cdecl sub_8071FE0(void **a1, void **a2, signed int a3);
int __cdecl sub_8072080(int, int); // weak
int sub_8072160();
void *sub_80721E0();
int __cdecl HttpClient::HttpClient(int a1);
int __cdecl sub_80722A0(int a1);
void __cdecl sub_8072320(int a1, int a2);
void __cdecl sub_8072360(int a1);
int __cdecl sub_80725E0(int a1);
void __cdecl sub_8072800(void *a1);
void __cdecl sub_8072820(int a1, int a2);
void __cdecl sub_8072DC0(int a1, int a2);
void __cdecl sub_8072DE0(int a1, int a2);
int __cdecl do_http_create_request(int a1);
signed int __cdecl sub_80735F0(int a1, int a2);
signed int __cdecl sub_8073FC0(int a1, int a2);
signed int __cdecl sub_8073FE0(int a1, int a2);
void __cdecl sub_8074000(unsigned int a1, int a2);
void __cdecl sub_8074BA0(int a1);
int __cdecl sub_8075330(int a1);
void __cdecl sub_80785C0(int a1, int a2);
void __cdecl sub_8078940(int a1, int a2);
void __cdecl sub_8078970(int a1);
void __cdecl sub_8079EC0(int a1, int a2);
void __cdecl sub_8079ED0(int a1);
void __cdecl sub_807A530(int a1, int a2, int a3);
void __cdecl sub_807A540(int a1, int a2, int a3);
void __cdecl sub_807A760(int a1, int a2, int a3);
int __cdecl sub_807A7C0(int a1, int a2, int a3, int a4);
// int __userpurge sub_807B190@<eax>(int a1, int a2, int a3, int a4, int a5, int a6, int a7);
// int __userpurge sub_807B550@<eax>(int a1, int a2, int a3, int a4, int a5, int a6);
int __cdecl sub_807B640(int a1, int a2, int a3);
int __cdecl sub_807B6C0(std::runtime_error *a1);
void __cdecl sub_807B6D0(std::runtime_error *a1);
int __cdecl sub_807B700(int a1);
// int __userpurge sub_807B750@<eax>(int a1, int a2);
void __cdecl sub_807B8A0(int a1);
void __cdecl sub_807B930(int a1, void *a2);
void __cdecl sub_807B960(int a1, void *a2);
// int __userpurge sub_807B9B0@<eax>(int a1, int a2, int a3);
// int __usercall sub_807BAF0@<eax>(int a1@<edx>, int a2, int a3, int a4);
int __cdecl sub_807BE90(int, char *, int, int); // idb
void __cdecl sub_807CDD0(void ***a1);
int __cdecl sub_807CE10(void **a1, void **a2, signed int a3);
int __cdecl sub_807CEB0(void **a1, void **a2, signed int a3);
int __cdecl sub_807CF50(void **a1, void **a2, signed int a3);
int __cdecl sub_807CFF0(int a1, int a2, int a3, int a4);
int sub_807D160(); // weak
char __cdecl sub_807D180(int a1, int a2, int a3, int a4, int a5);
int sub_807E2E0(); // weak
void __cdecl sub_807E300(int a1);
void __cdecl sub_807E350(void *a1);
int __cdecl sub_807E370(int **a1);
int __cdecl sub_807E3A0(void **a1, void **a2, signed int a3);
int __cdecl sub_807E440(std::string *, std::string *, int, std::string *, int, int); // idb
int __cdecl sub_807E4C0(int a1);
int __cdecl sub_807E570(int a1, int a2);
int __cdecl sub_807E6D0(int a1, int a2, int a3, int a4, int a5);
int __cdecl sub_807E6E0(int a1, int a2);
void __cdecl sub_807ECE0(int a1);
void __cdecl sub_807ED60(void *a1);
int __cdecl sub_807ED80(int a1, int a2);
void __cdecl sub_807EE30(void *a1);
void __cdecl sub_807EE60(void *a1);
void __cdecl sub_807EE90(void *a1);
int __cdecl sub_807EEB0(void **a1, void **a2, signed int a3);
bool __cdecl sub_807EF50(int a1, char *a2, int a3, int a4, int a5);
void __cdecl sub_807F190(int a1);
void __cdecl sub_807F220(void *a1);
int __cdecl sub_807F240(int a1, int a2, int a3);
int sub_807FF00(); // weak
int sub_8081650(); // weak
int __cdecl sub_8081670(void **a1, void **a2, signed int a3);
int __cdecl sub_8081710(void **a1, void **a2, signed int a3);
int __cdecl sub_80817B0(int, std::string *, int); // idb
int __cdecl sub_8081810(int a1);
int __cdecl sub_8081910(int a1);
void __cdecl sub_8081A70(void *a1);
int sub_8082610(); // weak
int sub_8083350(); // weak
signed int __cdecl sub_8083370(int a1);
int sub_8084970(); // weak
char __cdecl sub_8084980(int a1, int a2);
signed int __cdecl sub_8085400(int a1);
signed int __cdecl sub_8087130(int a1);
signed int __cdecl sub_8088330(int a1);
int sub_808AA70(); // weak
int sub_808AA80();
std::string *__stdcall sub_808AAB0(std::string *a1, int a2);
int __cdecl sub_808ABF0(int, char *); // idb
// int __userpurge sub_808AF20@<eax>(int a1, int a2);
int __cdecl sub_808B220(int, int, int, std::string *); // idb
int __cdecl sub_808B430(int a1);
void __cdecl sub_808B480(void *a1);
int __cdecl sub_808B4D0(int a1);
void __cdecl sub_808B5F0(void *a1);
void __cdecl sub_808B700(int a1);
void __cdecl sub_808B710(int a1);
int __cdecl sub_808B720(int a1, unsigned int a2);
int __cdecl sub_808B830(int a1, int *a2);
// signed int __usercall sub_808B990@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>);
// signed int __usercall sub_808BB10@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// signed int __usercall sub_808BB30@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// signed int __usercall sub_808BB80@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// signed int __usercall sub_808BC30@<eax>(int a1@<eax>, int *a2@<edx>, int a3@<ecx>);
int __cdecl sub_808C080(int a1, int a2, int a3);
BOOL __cdecl sub_808C0E0(int a1);
signed int __cdecl sub_808C100(int a1, int a2);
signed int __cdecl sub_808C150(int a1, int *a2, int a3);
int __cdecl sub_808C350(int a1);
signed int __cdecl sub_808C370(int a1, unsigned int a2, int a3, unsigned int a4);
signed int __cdecl sub_808C480(int a1, unsigned int a2, const void **a3, int a4, void **a5, unsigned int a6);
int nullsub_1(); // weak
int sub_808C9F0(); // weak
int __cdecl sub_808CA10(int, std::string *); // idb
int sub_808CAF0(); // weak
int sub_808CB90(); // weak
int __cdecl sub_808CC30(void **a1, void **a2, signed int a3);
int sub_808CCD0(); // weak
int sub_808CD70(); // weak
int sub_808CE10(); // weak
int __cdecl sub_808CEB0(void **a1, void **a2, signed int a3);
int __cdecl sub_808CF50(void **a1, void **a2, signed int a3);
int __cdecl sub_808CFF0(void **a1, void **a2, signed int a3);
int __cdecl sub_808D090(void **a1, void **a2, signed int a3);
int __cdecl sub_808D130(void **a1, void **a2, signed int a3);
int __cdecl sub_808D1C0(void **a1, void **a2, signed int a3);
int __cdecl sub_808D260(void **a1, void **a2, signed int a3);
int __cdecl sub_808D300(void **a1, void **a2, signed int a3);
int __cdecl sub_808D3A0(void **a1, void **a2, signed int a3);
int __cdecl sub_808D440(void **a1, void **a2, signed int a3);
int __cdecl sub_808D4E0(void **a1, void **a2, signed int a3);
int __cdecl sub_808D580(void **a1, void **a2, signed int a3);
int __cdecl sub_808D620(void **a1, void **a2, signed int a3);
int __cdecl sub_808D6C0(void **a1, void **a2, signed int a3);
int __cdecl sub_808D760(void **a1, void **a2, signed int a3);
int __cdecl sub_808D800(void **a1, void **a2, signed int a3);
int __cdecl sub_808D8A0(void **a1, void **a2, signed int a3);
int __cdecl sub_808D940(void **a1, void **a2, signed int a3);
int __cdecl sub_808D9E0(void **a1, void **a2, signed int a3);
int __cdecl sub_808DA80(void **a1, void **a2, signed int a3);
int __cdecl sub_808DB20(void **a1, void **a2, signed int a3);
int __cdecl sub_808DBB0(void **a1, void **a2, signed int a3);
int __cdecl sub_808DC50(void **a1, void **a2, signed int a3);
int __cdecl sub_808DCF0(void **a1, void **a2, signed int a3);
int __cdecl sub_808DD90(std::string *, std::string *, std::string *); // idb
FILE *__cdecl sub_808DDF0(FILE *stream, int a2);
int __cdecl sub_808DE60(int a1, std::string *a2);
int sub_808DEE0(); // weak
int __cdecl sub_808DF40(int, void *); // idb
int sub_808E070(); // weak
int __cdecl sub_808E190(int, void *); // idb
int __cdecl sub_808E360(int, void *); // idb
__int16 __cdecl sub_808E530(int a1, void *a2);
int __cdecl sub_808E750(int, void *); // idb
int __cdecl sub_808F6A0(int, void *); // idb
int __cdecl sub_808FB70(int, std::string *); // idb
int __cdecl sub_808FBD0(int a1);
int __cdecl sub_808FE50(int a1, std::string *a2);
int __cdecl sub_808FEF0(int a1);
int sub_80905C0(); // weak
int sub_80905D0(); // weak
int sub_8090670(); // weak
int __cdecl sub_8090870(int **a1, int a2);
int __cdecl sub_8090BF0(int a1, int a2);
int __cdecl sub_80910D0(int a1, int a2);
int sub_8091420(); // weak
int sub_8091A30(); // weak
int __cdecl sub_8091A40(int ***a1, int a2);
int __cdecl sub_8091B60(int a1, int a2);
// int __userpurge sub_8091F30@<eax>(int a1, int stream, int *a3, int a4, int a5, char a6);
// int __userpurge sub_8093380@<eax>(int a1, int a2);
// int __userpurge sub_8093510@<eax>(int a1, int a2, int *a3, int a4, int a5, char a6);
// int __userpurge sub_8093670@<eax>(int a1, int a2, int a3);
int __cdecl sub_8093CA0(int a1, int a2, int a3, int a4);
int __cdecl sub_80940A0(int a1, int a2, int a3, int a4);
int __cdecl sub_8094160(int a1, int a2, char a3);
// int __userpurge sub_8094300@<eax>(int a1, int a2, int a3, char a4);
int __cdecl sub_80945C0(int a1, int a2);
int __cdecl sub_8094730(int a1, int a2, int a3);
int __cdecl sub_8094890(int a1, int a2);
int __cdecl sub_80949F0(int ***a1);
int sub_8094D60();
int __stdcall sub_8094DA0(int a1);
int __cdecl sub_8094DB0(int a1);
bool __cdecl sub_8094DE0(int a1);
int sub_8094DF0(); // weak
int __cdecl sub_8094E10(int a1);
int sub_8094E50();
int __cdecl sub_8094E60(int a1);
bool __cdecl sub_8094E80(int a1);
int __cdecl sub_8094E90(int a1);
void __cdecl sub_8094EC0(void *a1);
void __cdecl sub_8094F00(void *a1);
void __cdecl sub_8094F10(void *a1);
int __cdecl sub_8094F20(int a1);
int __cdecl sub_8094F70(int a1);
int __cdecl sub_8094FE0(int a1);
int __cdecl sub_8095040(int a1);
std::string *__stdcall sub_8095060(std::string *a1, int a2, unsigned int a3);
int sub_8095110(); // weak
__int64 __cdecl sub_8095130(int a1, int a2);
__int32 __cdecl sub_8095160(int a1, const char **a2);
int __cdecl sub_8095190(void **a1, void **a2, signed int a3);
int __cdecl sub_8095230(void **a1, void **a2, signed int a3);
int __cdecl sub_80952D0(void **a1, void **a2, signed int a3);
int __cdecl sub_8095370(void **a1, void **a2, signed int a3);
int __cdecl sub_8095410(void **a1, void **a2, signed int a3);
int __cdecl sub_80954B0(int a1, int a2);
int __cdecl sub_80954F0(int a1);
void __cdecl sub_8095530(void *a1);
int __cdecl sub_8095590(int a1);
void __cdecl sub_8095620(void *a1);
int __cdecl sub_80956B0(int a1);
void __cdecl sub_8095760(int a1);
void __cdecl sub_8095860(void *a1);
int __cdecl sub_8095920(int a1);
void __cdecl sub_8095A10(void *a1);
int __cdecl sub_8095D20(int a1, int a2);
int __cdecl sub_8095E00(int a1);
int __cdecl sub_8095E80(int a1);
struct evbuffer *__cdecl sub_8095FB0(int a1);
int __cdecl sub_8096130(int a1);
int __cdecl sub_8096450(int a1, unsigned __int8 a2);
int __cdecl sub_80967F0(int a1);
int __cdecl sub_8096830(int a1);
int __cdecl sub_8096930(int a1);
int __cdecl sub_8096C70(int *a1, int a2, int a3);
int __cdecl sub_8096E60(int a1, int *a2);
int __cdecl sub_8096EA0(int a1, int *a2);
int __cdecl sub_8096EF0(int a1);
void __cdecl sub_8096F50(int a1);
void __cdecl sub_8096FB0(int a1);
std::string *__stdcall sub_8097020(std::string *a1, int a2, unsigned int a3);
int __cdecl sub_8097120(int a1);
int __cdecl sub_80971B0(int a1);
int __cdecl sub_8097260(int a1);
int __cdecl sub_80972F0(int a1);
int __cdecl sub_8097450(int a1);
std::string *__stdcall sub_80974E0(std::string *a1, int a2);
std::string *__stdcall sub_8097AD0(std::string *a1, int a2, int *a3);
std::string *__stdcall sub_8097B50(std::string *a1, int a2, int *a3);
int __cdecl sub_8097BE0(int a1);
int __cdecl sub_8097C60(void *, int, char); // idb
int __cdecl sub_80981A0(void *, int, int); // idb
int __cdecl sub_8098450(void *, int); // idb
int __cdecl sub_8098700(int a1, int a2);
int __cdecl sub_8098730(int a1, int a2);
int sub_80987A0(); // weak
int sub_8098890(); // weak
int __cdecl sub_8098980(int a1, int a2);
int __cdecl sub_80989B0(int a1);
int sub_8098C20(); // weak
int __stdcall sub_8098D10(int a1);
void *__cdecl sub_8098E10(void *a1, char *a2, int *a3);
void *__cdecl sub_8098E70(void *a1, char *a2, int a3);
int __cdecl sub_8098EF0(int a1, int a2);
// int __userpurge sub_8098F20@<eax>(int a1, int a2);
int __cdecl sub_8098FA0(int a1, int a2);
int __cdecl sub_8099010(int a1);
int __cdecl sub_8099090(int a1);
signed int __cdecl sub_80990D0(int a1);
signed int __cdecl sub_80992C0(int a1);
int __cdecl sub_8099450(int, std::string *); // idb
int __cdecl sub_8099610(int a1, int a2);
int __cdecl sub_8099730(int a1, int a2);
int __cdecl sub_8099850(int a1, int a2, int a3);
int __cdecl sub_8099AC0(int a1, int a2, int a3);
int __cdecl sub_8099B80(int a1, int a2, int a3);
int __cdecl sub_8099C40(int a1, int a2, int a3);
int __cdecl sub_8099D00(int a1, int a2, int a3);
int __cdecl sub_8099E30(int a1, int a2, int a3, int a4);
// std::string *__userpurge sub_8099F70@<eax>(unsigned int a1@<ebp>, void *a2@<edi>, std::string *a3, int a4, int a5);
// std::string *__userpurge sub_809A080@<eax>(unsigned int a1@<ebp>, std::string *a2, int a3, void *a4);
int __cdecl sub_809A1F0(int a1, int a2);
int __cdecl sub_809A2E0(int a1, int a2);
__pid_t __cdecl sub_809A6F0(__pid_t pid, int *stat_loc);
void __cdecl __noreturn handler(int a1);
int sub_809A860(void); // weak
// int __usercall sub_809B0F0@<eax>(const char *a1@<eax>, std::ios_base *a2@<ebp>, int a3@<edi>);
int __cdecl parse_config(signed int a1, int a2);
int __cdecl sub_809C210(int a1);
std::string *__stdcall sub_809C930(std::string *a1, unsigned int a2);
time_t __cdecl sub_809CA20(int a1);
int __cdecl sub_809CB60(int a1);
void __cdecl sub_809D020(void *a1, int a2);
int __cdecl sub_809D0E0(int a1, int a2);
int __cdecl sub_809DC30(int a1, int a2);
// ssize_t __usercall sub_809DCE0@<eax>(int a1@<eax>, struct sockaddr *a2@<edx>, unsigned __int16 a3@<cx>, unsigned __int16 a4);
void __cdecl sub_809E380(int a1, int a2, char a3);
void __cdecl sub_809EB90(int a1, void *a2, int a3, int a4);
void __cdecl sub_809F2A0(int a1, int a2, int a3, int a4);
void __cdecl sub_809F890(int a1, int a2, int a3);
int sub_80A00D0(); // weak
char __cdecl sub_80A0100(int a1, int a2);
int __cdecl sub_80A0780(int a1, int a2);
int __cdecl sub_80A08D0(int a1, const void *a2);
int __cdecl sub_80A0A50(int a1);
// int __usercall sub_80A0C80@<eax>(int a1@<eax>);
// int __usercall sub_80A0CA0@<eax>(unsigned int a1@<eax>);
// int __usercall sub_80A0D50@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
int __cdecl sub_80A0DC0(int a1, int a2);
int __cdecl sub_80A0F20(int a1);
void __cdecl sub_80A0F70(void *a1);
char __cdecl sub_80A1030(int a1, int a2);
// int __userpurge sub_80A10A0@<eax>(int a1, int a2, unsigned int a3);
char __cdecl sub_80A1710(int a1, char a2);
void __cdecl sub_80A1770(int a1);
char __cdecl sub_80A1870(int a1, int a2, int a3, char *s, void *src, int a6, int a7, int a8, int a9);
ssize_t __cdecl sub_80A2E10(int a1, int a2, unsigned int a3);
ssize_t __cdecl sub_80A3A60(int a1);
// int __userpurge sub_80A3D50@<eax>(int a1, int a2, int a3, int a4, int a5);
// int __userpurge sub_80A3E40@<eax>(int a1, int a2, int a3);
void __cdecl sub_80A3E80(int a1, void *a2, int a3);
void __cdecl sub_80A4010(int a1, void *a2, int a3);
void *__cdecl sub_80A41A0(void *a1, int a2, int a3);
void __cdecl sub_80A4320(int a1, int a2);
// int __userpurge sub_80A43E0@<eax>(int a1, int a2, int a3, unsigned int a4, int a5);
int __cdecl sub_80A4600(int *a1);
int __cdecl sub_80A4630(void **a1, void **a2, signed int a3);
struct_thread_imp *__cdecl sub_80A46D0(struct_thread *t, int a2);
int __cdecl sub_80A4710(int a1);
void __cdecl sub_80A47A0(int a1);
signed __int32 __cdecl sub_80A4820(int a1);
int __cdecl sub_80A4940(int a1);
int __cdecl event_dispath_thread(int a1);
int __cdecl sub_80A5FA0(int a1);
void __cdecl sub_80A5FC0(int a1, int a2, int a3);
int __cdecl sub_80A5FD0(int a1, int a2);
int __cdecl sub_80A5FF0(int, int, void *, int, int); // idb
int __cdecl sub_80A61B0(int, int, void *, int); // idb
int __cdecl sub_80A61F0(int, int, void *, int); // idb
int __cdecl sub_80A6230(int a1);
char __cdecl sub_80A6280(int a1);
unsigned int __cdecl sub_80A6440(int a1);
unsigned int __cdecl sub_80A6460(__int128 a1);
void *__cdecl sub_80A65E0(int a1, unsigned int a2, int a3);
int __cdecl sub_80A6810(int a1);
int __cdecl sub_80A6820(int *a1);
int __cdecl sub_80A6850(int a1, int a2);
int __cdecl sub_80A6870(int a1, int a2);
unsigned int __cdecl sub_80A68E0(int a1, int a2, int a3);
int __cdecl sub_80A6950(int a1, int *a2);
signed int __cdecl sub_80A6EB0(unsigned int a1, signed int *a2, int a3, unsigned int *a4, int a5);
signed int __cdecl sub_80A71E0(int a1, unsigned int a2, int a3, int a4);
int __cdecl sub_80A7310(char *, int); // idb
// char __usercall sub_80A74C0@<al>(char result@<al>);
// BOOL __usercall sub_80A7680@<al>(char *a1@<eax>, char *a2@<edx>);
// signed int __usercall sub_80A7720@<eax>(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>);
char __cdecl sub_80A77B0(char *a1, char *a2);
char sub_80A7910();
int __cdecl sub_80A7990(void **a1, void **a2, signed int a3);
int __cdecl sub_80A7A30(void **a1, void **a2, signed int a3);
int __cdecl sub_80A7AD0(void **a1, void **a2, signed int a3);
int __cdecl sub_80A7B70(void **a1, void **a2, signed int a3);
int __cdecl sub_80A7C10(int a1, int a2, int a3, int a4);
int __cdecl sub_80A7DD0(int a1);
void __cdecl sub_80A83E0(int a1);
int __cdecl sub_80A8AC0(int a1, int a2);
int __cdecl sub_80A9210(int a1, int a2, int a3, std::string *a4, int a5);
int __cdecl sub_80A9B50(int, int, std::string *); // idb
void __cdecl sub_80AA430(int a1, int a2, std::string *a3);
int __cdecl sub_80AB5A0(int a1, int a2);
unsigned int __cdecl sub_80AB6A0(int a1, int a2, int a3);
int __cdecl sub_80AC000(int a1);
int __cdecl sub_80ACCA0(int a1, int a2, char a3);
void __cdecl sub_80AD210(int a1, int a2);
int __cdecl sub_80AD900(int a1, int a2, int a3, int a4);
int __cdecl sub_80AE810(int **a1);
int __cdecl sub_80AE840(int a1, int a2, int a3);
int __cdecl sub_80AE8A0(int a1, int a2, signed int a3);
void __cdecl sub_80AF000(int a1, int a2, int *a3);
void __cdecl sub_80AF930(int **a1, int *a2);
int __cdecl sub_80AF960(int a1, int a2, int a3);
int __cdecl sub_80B0890(int **a1, int a2);
int __cdecl sub_80B08C0(int **a1, int a2);
int __cdecl sub_80B0A40(int a1);
void __cdecl sub_80B0C50(void *a1);
// int __userpurge sub_80B0E70@<eax>(int a1, int a2, const char **a3);
// int __userpurge sub_80B1010@<eax>(int a1, int a2);
int __cdecl sub_80B1150(int a1);
int __cdecl sub_80B11F0(int a1);
int __cdecl sub_80B1290(int a1);
void __cdecl sub_80B1330(int a1, int a2, int a3);
void __cdecl sub_80B1360(int a1, int a2);
// int __userpurge sub_80B1420@<eax>(int a1, int a2, int a3, const void **a4);
int __cdecl sub_80B1640(int a1, int a2);
int __cdecl sub_80B16D0(void **a1, void **a2, signed int a3);
int __cdecl sub_80B1770(int a1, int a2);
int __cdecl sub_80B18C0(int a1);
// pthread_mutex_t *__usercall sub_80B2020@<eax>(int a1@<edi>, pthread_mutex_t *mutex, int a3, int a4);
int __cdecl sub_80B2040(pthread_mutex_t *, int); // idb
int __cdecl sub_80B2410(int a1);
char __cdecl sub_80B2770(int a1);
char __cdecl sub_80B3E80(int a1, int a2, int a3);
int __cdecl sub_80B5010(int a1);
void __cdecl sub_80B5060(void *a1);
void __cdecl sub_80B50F0(void *a1);
int __cdecl sub_80B5140(int a1);
int __cdecl sub_80B51D0(int a1);
int __cdecl sub_80B5260(int a1);
int __cdecl sub_80B52F0(int a1);
void __cdecl sub_80B5380(void *a1);
void __cdecl sub_80B5420(void *a1);
void __cdecl sub_80B54C0(void *a1);
void __cdecl sub_80B5560(void *a1);
int __cdecl sub_80B5600(int a1);
int __cdecl sub_80B56B0(int a1);
int __cdecl sub_80B5760(int a1);
void __cdecl sub_80B5810(void *a1);
void __cdecl sub_80B58D0(void *a1);
void __cdecl sub_80B5990(void *a1);
int __cdecl sub_80B5A50(int a1, int a2);
int __cdecl sub_80B5CF0(int a1);
int __cdecl sub_80B5ED0(int a1);
int __cdecl sub_80B60E0(int a1);
int __cdecl sub_80B62E0(int a1, int a2);
int sub_80B6350(); // weak
// pthread_mutex_t *__usercall sub_80B6420@<eax>(_UNKNOWN *a1@<esi>, int a2);
// pthread_mutex_t *__usercall sub_80B6720@<eax>(_UNKNOWN *a1@<esi>, int a2);
int __cdecl sub_80B6A20(int a1, int a2);
int __cdecl sub_80B6A90(int a1, int a2);
int __cdecl sub_80B6B00(int a1, int a2);
int __cdecl sub_80B6B30(int *a1, int *a2);
int __cdecl sub_80B6B90(int *a1, int *a2);
int __cdecl sub_80B6BF0(int *a1, int *a2);
int __cdecl sub_80B6C50(int, void *); // idb
int __cdecl sub_80B7910(int, void *); // idb
int __cdecl sub_80B8F80(int a1);
void __cdecl sub_80B9060(void *a1);
int __fastcall sub_80B914C(int a1, int a2);
int __fastcall term_proc(int a1, int a2);

//-------------------------------------------------------------------------
// Data declarations

// extern _UNKNOWN GENERAL_NAME_free; weak
// extern _UNKNOWN X509_INFO_free; weak
// extern _UNKNOWN _pthread_key_create; weak
_UNKNOWN loc_80518B0; // weak
void *off_80B9404 = &unk_80CF6B0; // weak
void *off_80B940C = &unk_80CF6B0; // weak
void *off_80B9414 = &unk_80CF6B0; // weak
void *off_80B94D8 = &loc_8056D40; // weak
int (__cdecl *off_80B94F0)(int) = &sub_8056CA0; // weak
int (__cdecl *off_80B9500)(int) = &sub_8056CF0; // weak
char byte_80B987B = ' '; // weak
void *off_80B9AB8 = &unk_80CF6B0; // weak
int dword_80B9AC0 = 0; // weak
void *off_80B9AC4 = &unk_80CF6B0; // weak
void *off_80B9B08 = &unk_80CF6B0; // weak
void *off_80B9B60 = &unk_80CF6B0; // weak
void *off_80B9BB0 = &unk_80CF6B0; // weak
void *off_80B9BEC = &unk_80CF6B0; // weak
__int16 word_80B9D72 = 26656; // weak
char byte_80B9D79 = ' '; // weak
void *off_80BA21C = &unk_80CF6B0; // weak
void *off_80BA224 = &unk_80CF6B0; // weak
void *off_80BA22C = &unk_80CF6B0; // weak
void *off_80BA234 = &unk_80CF6B0; // weak
void *off_80BA23C = &unk_80CF6B0; // weak
void *off_80BA244 = &unk_80CF6B0; // weak
void *off_80BA24C = &unk_80CF6B0; // weak
void *off_80BA2E8 = &loc_8066DC0; // weak
void *off_80BA2F8 = &loc_8066DE0; // weak
void *off_80BA308 = &loc_8066FB0; // weak
int (__cdecl *off_80BA318)(int) = &sub_8067160; // weak
void *off_80BA328 = &loc_8066EB0; // weak
int (__cdecl *off_80BA3F0)(int) = &sub_806B560; // weak
int (__cdecl *off_80BA408)(int) = &sub_806B5D0; // weak
void *off_80BA528 = &unk_80CF6B0; // weak
void *off_80BA530 = &unk_80CF6B0; // weak
char byte_80BA86B = 'p'; // weak
void *off_80BAAD4 = &unk_80CF6B0; // weak
void *off_80BAADC = &unk_80CF780; // weak
void *off_80BAB18 = &sub_807B6C0; // weak
int (__cdecl *HttpClient::vftable)(int) = &sub_80725E0; // weak
void *off_80BACC0 = &unk_80CF6B0; // weak
void *off_80BACC8 = &unk_80CF6B0; // weak
void *off_80BACD0 = &unk_80CF6B0; // weak
int (__cdecl *off_80BAD00)(int) = &sub_807E300; // weak
void *off_80BAD78 = &unk_80CF6B0; // weak
int (__cdecl *off_80BADA0)(int) = &sub_807ECE0; // weak
void *off_80BAEBC = &unk_80CF6B0; // weak
int (__cdecl *off_80BAEE8)(int) = &sub_807F190; // weak
void *off_80BB47C = &unk_80CF6B0; // weak
void *off_80BB484 = &unk_80CF6B0; // weak
int dword_80BB4A0[] = { 0 }; // weak
int dword_80BB4C0[] = { 0 }; // weak
int dword_80BB4E0[] = { 0 }; // weak
char byte_80BB500[] = { '\0' }; // weak
int (__cdecl *off_80BB6A0)(int) = &sub_808B430; // weak
int (__cdecl *off_80BB6C8)(int) = &sub_808B4D0; // weak
void *off_80BB6D8 = &loc_808B5D0; // weak
void *off_80BB6E8 = &loc_808B5E0; // weak
char byte_80BB8CF = 'v'; // weak
int off_80BBC2C = 134986678; // idb
void *off_80BCBB0 = &unk_80CF6B0; // weak
void *off_80BCBB8 = &unk_80CF6B0; // weak
void *off_80BCBC0 = &unk_80CF6B0; // weak
void *off_80BCBC8 = &unk_80CF6B0; // weak
void *off_80BCBD0 = &unk_80CF6B0; // weak
void *off_80BCBD8 = &unk_80CF6B0; // weak
void *off_80BCBE0 = &unk_80CF6B0; // weak
void *off_80BCBE8 = &unk_80CF6B0; // weak
void *off_80BCBF0 = &unk_80CF6B0; // weak
void *off_80BCBF8 = &unk_80CF6B0; // weak
void *off_80BCC00 = &unk_80CF6B0; // weak
void *off_80BCC08 = &unk_80CF6B0; // weak
void *off_80BCC10 = &unk_80CF6B0; // weak
void *off_80BCC18 = &unk_80CF6B0; // weak
void *off_80BCC20 = &unk_80CF6B0; // weak
void *off_80BCC28 = &unk_80CF6B0; // weak
void *off_80BCC30 = &unk_80CF6B0; // weak
void *off_80BCC38 = &unk_80CF6B0; // weak
void *off_80BCC40 = &unk_80CF6B0; // weak
void *off_80BCC48 = &unk_80CF6B0; // weak
void *off_80BCC50 = &unk_80CF6B0; // weak
void *off_80BCC70 = &unk_80CF6B0; // weak
void *off_80BCC88 = &unk_80CF6B0; // weak
void *off_80BCC90 = &unk_80CF6B0; // weak
void *off_80BCC98 = &unk_80CF6B0; // weak
int dword_80BCCA0 = 0; // weak
void *off_80BCFE8 = &unk_80CF6B0; // weak
void *off_80BD144 = &unk_80CF6B0; // weak
void *off_80BD18C = &unk_80CF6B0; // weak
void *off_80BD1D0 = &unk_80CF6B0; // weak
void *off_80BD210 = &unk_80CF6B0; // weak
void *off_80BD238 = &unk_80CF6B0; // weak
void *off_80BD2F0 = &loc_8094E30; // weak
void *off_80BD310 = &loc_8095B00; // weak
int (__cdecl *off_80BD328)(int) = &sub_8094DB0; // weak
int (__cdecl *off_80BD368)(int) = &sub_8094F20; // weak
int (__cdecl *off_80BD3A8)(int) = &sub_80956B0; // weak
int (__cdecl *off_80BD3E8)(int) = &sub_8095920; // weak
int (__cdecl *off_80BD428)(int) = &sub_8095590; // weak
void *off_80BD460 = &loc_8094E40; // weak
int dword_80BD478[3] = { 1869771333, 1931491954, 1634625385 }; // weak
char byte_80BD510[2] = { '-', '-' }; // weak
char byte_80BD54B = '-'; // weak
void *off_80BD870 = &loc_80A0720; // weak
void *off_80BDB08 = &loc_80A0E00; // weak
void *off_80BDB20 = &loc_80A0C30; // weak
void *off_80BDB88 = &loc_80A3A90; // weak
void *off_80BDBA0 = &loc_80A3BA0; // weak
void *ProxyWorker::workerLoop = &unk_80CF6B0; // weak
void *off_80BDD50 = &sub_80A4710; // weak
void *ProxyWorker_vftable = &loc_80A45B0; // weak
int dword_80BDDE0[] = { 0 }; // weak
char byte_80BDE00[] = { 'A' }; // weak
int dword_80BDEC8 = 757952120; // weak
void *off_80BE324 = &unk_80CF6B0; // weak
void *off_80BE32C = &unk_80CF6B0; // weak
void *off_80BE334 = &unk_80CF6B0; // weak
void *off_80BE33C = &unk_80CF6B0; // weak
int (__cdecl *off_80BE388)(int) = &sub_80B0A40; // weak
void *off_80BE398 = &loc_80B08F0; // weak
void *off_80BE66C = &unk_80CF6B0; // weak
void *off_80BE688 = &loc_80B17B0; // weak
void *off_80BE6A0 = &loc_80B1680; // weak
int (__cdecl *off_80BEA38)(int) = &sub_80B52F0; // weak
int (__cdecl *off_80BEA48)(int) = &sub_80B51D0; // weak
void *off_80BEA58 = &loc_80B4ED0; // weak
void *off_80BEA70 = &loc_80B4F90; // weak
int (__cdecl *off_80BEA88)(int) = &sub_80B5140; // weak
int (__cdecl *off_80BEA98)(int) = &sub_80B5600; // weak
int (__cdecl *off_80BEAA8)(int) = &sub_80B8F80; // weak
void *off_80BEAB8 = &loc_80B4F30; // weak
int (__cdecl *off_80BEAD0)(int) = &sub_80B5010; // weak
int (__cdecl *off_80BEAE8)(int) = &sub_80B5260; // weak
int (__cdecl *off_80BEAF8)(int) = &sub_80B56B0; // weak
int (__cdecl *off_80BEB08)(int) = &sub_80B5760; // weak
int (*off_80CE060)() = &sub_804DF70; // weak
int dword_80CE068[] = { 4294967295 }; // weak
_UNKNOWN unk_80CE0CC; // weak
int dword_80CE648 = 1080; // idb
char byte_80CE64C = '\x01'; // weak
int dword_80CE650 = 1082; // idb
int dword_80CE654 = 10485760; // weak
int dword_80CE658 = 2048; // weak
int dword_80CE65C = 30; // weak
int dword_80CE660 = 20; // weak
int dword_80CE664 = 100; // weak
int dword_80CE668 = 20; // weak
char byte_80CE66C = '\x01'; // weak
int dword_80CE670 = 30; // weak
int dword_80CE674 = 60; // weak
int dword_80CE678 = 40; // weak
unsigned int seconds = 30u; // idb
int dword_80CE680 = 3600; // weak
int dword_80CE684 = 30; // weak
int dword_80CE6A0 = 3696; // weak
_UNKNOWN unk_80CE6C0; // weak
_UNKNOWN unk_80CF530; // weak
_UNKNOWN unk_80CF533; // weak
_UNKNOWN unk_80CF54C; // weak
_UNKNOWN unk_80CF560; // weak
_UNKNOWN unk_80CF574; // weak
_UNKNOWN unk_80CF588; // weak
_UNKNOWN unk_80CF5C8; // weak
_UNKNOWN unk_80CF5DC; // weak
_UNKNOWN unk_80CF5F0; // weak
int (__cdecl *pcre_free)(_DWORD); // weak
int dword_80CF60C; // weak
int dword_80CF610; // weak
int dword_80CF614; // weak
int dword_80CF618; // weak
int dword_80CF61C; // weak
int dword_80CF620; // weak
_UNKNOWN unk_80CF638; // weak
int dword_80CF674; // weak
int dword_80CF678; // weak
_UNKNOWN unk_80CF68C; // weak
_UNKNOWN unk_80CF6A0; // weak
_DWORD std::cout; // weak
int dword_80CF764; // weak
int dword_80CF7AC; // weak
int dword_80CF7B0; // weak
_UNKNOWN unk_80CF7F0; // weak
_DWORD std::string::_Rep::_S_empty_rep_storage; // weak
_UNKNOWN unk_80CF83C; // weak
char byte_80CF840; // weak
int dword_80CF844; // weak
_UNKNOWN unk_80CF848; // weak
int dword_80CF84C; // weak
int dword_80CF850; // weak
int dword_80CF854; // weak
int dword_80CF858; // weak
int dword_80CF85C; // weak
int dword_80CF860; // weak
_UNKNOWN dword_80CF864; // weak
char byte_80CF868; // weak
int g_time; // weak
int dword_80CF870; // weak
int log_level; // weak
char graceful_terminate; // weak
int terminate_timeout; // weak
_UNKNOWN g_idrsa_path; // weak
int dword_80CF884; // weak
int dword_80CF888; // weak
char byte_80CF88C; // weak
_UNKNOWN dword_80CF890; // weak
int dword_80CF894; // weak
int dword_80CF898; // weak
_UNKNOWN unk_80CF89C; // weak
_UNKNOWN unk_80CF8A0; // weak
_UNKNOWN unk_80CF8D0; // weak
_UNKNOWN unk_80CF8D4; // weak
_UNKNOWN unk_80CF8D8; // weak
_UNKNOWN unk_80CF8DC; // weak
void *dword_80CF8E0; // idb
_UNKNOWN unk_80CF8E4; // weak
_UNKNOWN unk_80CF8E8; // weak
_UNKNOWN unk_80CF8EC; // weak
_UNKNOWN unk_80CF8F0; // weak
_UNKNOWN unk_80CF8F4; // weak
_UNKNOWN unk_80CF8F8; // weak
int dword_80CF8FC; // weak
_UNKNOWN unk_80CF900; // weak
_UNKNOWN unk_80CF904; // weak
_UNKNOWN unk_80CF908; // weak
_UNKNOWN unk_80CF90C; // weak
_UNKNOWN unk_80CF910; // weak
_UNKNOWN unk_80CF914; // weak
_UNKNOWN unk_80CF918; // weak
_UNKNOWN unk_80CF91C; // weak
int dword_80CF920; // weak
_UNKNOWN unk_80CF924; // weak
_UNKNOWN unk_80CF929; // weak
_UNKNOWN unk_80CF92C; // weak
_UNKNOWN unk_80CF930; // weak


//----- (0804C3B4) --------------------------------------------------------
int init_proc()
{
  int v0; // edx@1
  int v1; // ecx@1

  sub_804E053();
  return sub_80B914C(v1, v0);
}

//----- (0804D5EC) --------------------------------------------------------
int __usercall sub_804D5EC@<eax>(int a1@<eax>)
{
  int result; // eax@2

  if ( a1 )
    result = bufferevent_getfd(a1);
  else
    result = 0;
  return result;
}
// 804CC70: using guessed type int __cdecl bufferevent_getfd(_DWORD);

//----- (0804D6DE) --------------------------------------------------------
void __noreturn sub_804D6DE()
{
  _assert("!item_hook->_prev_item && !item_hook->_next_item", "util/intrusive_list.h", 178);
}

//----- (0804D724) --------------------------------------------------------
void __noreturn sub_804D724()
{
  _assert(
    "!item_hook->_prev_item && !item_hook->_next_item",
    "/home/abelyak/revizor/openwrt-x86-installer/package/build_dir/target-i386_i486_uClibc-0.9.33.2/revizor-1.3.0-38254/util/intrusive_list.h",
    178);
}

//----- (0804D74C) --------------------------------------------------------
void __noreturn sub_804D74C()
{
  _assert(
    "!item_hook->_prev_item && !item_hook->_next_item",
    "/home/abelyak/revizor/openwrt-x86-installer/package/build_dir/target-i386_i486_uClibc-0.9.33.2/revizor-1.3.0-38254/util/intrusive_list.h",
    178);
}

//----- (0804D774) --------------------------------------------------------
void __noreturn sub_804D774()
{
  _assert(
    "!item_hook->_prev_item && !item_hook->_next_item",
    "/home/abelyak/revizor/openwrt-x86-installer/package/build_dir/target-i386_i486_uClibc-0.9.33.2/revizor-1.3.0-38254/util/intrusive_list.h",
    178);
}

//----- (0804D7A0) --------------------------------------------------------
int sub_804D7A0()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF848);
}

//----- (0804D7C0) --------------------------------------------------------
int sub_804D7C0()
{
  char v1; // [sp+1Fh] [bp-Dh]@1

  std::string::_Rep::_M_dispose(dword_80CF864 - 12, &v1);
  std::string::_Rep::_M_dispose(dword_80CF870 - 12, &v1);
  std::string::_Rep::_M_dispose(g_idrsa_path - 12, &v1);
  std::string::_Rep::_M_dispose(dword_80CF884 - 12, &v1);
  std::string::_Rep::_M_dispose(dword_80CF888 - 12, &v1);
  std::string::_Rep::_M_dispose(dword_80CF890 - 12, &v1);
  std::string::_Rep::_M_dispose(dword_80CF894 - 12, &v1);
  std::string::_Rep::_M_dispose(dword_80CF898 - 12, &v1);
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF89C);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 80CF870: using guessed type int dword_80CF870;
// 80CF884: using guessed type int dword_80CF884;
// 80CF888: using guessed type int dword_80CF888;
// 80CF894: using guessed type int dword_80CF894;
// 80CF898: using guessed type int dword_80CF898;

//----- (0804D880) --------------------------------------------------------
int sub_804D880()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8D0);
}

//----- (0804D8A0) --------------------------------------------------------
int sub_804D8A0()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8D4);
}

//----- (0804D8C0) --------------------------------------------------------
int sub_804D8C0()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8D8);
}

//----- (0804D8E0) --------------------------------------------------------
int sub_804D8E0()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8DC);
}

//----- (0804D910) --------------------------------------------------------
int sub_804D910()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8E8);
}

//----- (0804D930) --------------------------------------------------------
int sub_804D930()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8EC);
}

//----- (0804D950) --------------------------------------------------------
int sub_804D950()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8F0);
}

//----- (0804D970) --------------------------------------------------------
int sub_804D970()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8F4);
}

//----- (0804D990) --------------------------------------------------------
int sub_804D990()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8F8);
}

//----- (0804D9C0) --------------------------------------------------------
int sub_804D9C0()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF904);
}

//----- (0804D9E0) --------------------------------------------------------
int sub_804D9E0()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF908);
}

//----- (0804DA00) --------------------------------------------------------
int sub_804DA00()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF90C);
}

//----- (0804DA20) --------------------------------------------------------
int sub_804DA20()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF910);
}

//----- (0804DA40) --------------------------------------------------------
int sub_804DA40()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF914);
}

//----- (0804DA60) --------------------------------------------------------
int sub_804DA60()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF918);
}

//----- (0804DA80) --------------------------------------------------------
int sub_804DA80()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF91C);
}

//----- (0804DAA0) --------------------------------------------------------
int sub_804DAA0()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF924);
}

//----- (0804DAC0) --------------------------------------------------------
int sub_804DAC0()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF929);
}

//----- (0804DAE0) --------------------------------------------------------
int sub_804DAE0()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF92C);
}

//----- (0804DB00) --------------------------------------------------------
int sub_804DB00()
{
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF930);
}

//----- (0804DDC0) --------------------------------------------------------
int __cdecl main(int argc, const char **argv, const char **envp)
{
  __pid_t (__cdecl *v4)(__pid_t, int *); // [sp+1Ch] [bp-18h]@1
  signed int v5; // [sp+20h] [bp-14h]@1

  signal(SIGPIPE, (__sighandler_t)1);
  signal(SIGSEGV, (__sighandler_t)handler);
  signal(SIGBUS, (__sighandler_t)handler);
  memset(&v4, 0, 0x14u);
  v5 = 4;
  v4 = sub_809A6F0;
  sigaction(SIGCHLD, (const struct sigaction *)&v4, 0);
  SSL_library_init();
  ERR_load_crypto_strings();
  SSL_load_error_strings();
  OPENSSL_add_all_algorithms_noconf();
  parse_config(argc, (int)argv);
  return sub_809A860();
}
// 804C680: using guessed type int OPENSSL_add_all_algorithms_noconf(void);
// 804C7B0: using guessed type int SSL_load_error_strings(void);
// 804CDB0: using guessed type int SSL_library_init(void);
// 804D210: using guessed type int ERR_load_crypto_strings(void);
// 809A860: using guessed type int sub_809A860(void);

//----- (0804DF70) --------------------------------------------------------
int sub_804DF70()
{
  return std::ios_base::Init::Init((std::ios_base::Init *)&unk_80CF930);
}

//----- (0804DF84) --------------------------------------------------------
#error "804DF87: positive sp value has been found (funcsize=2)"

//----- (0804DFA8) --------------------------------------------------------
void sub_804DFA8()
{
  ;
}

//----- (0804DFAC) --------------------------------------------------------
signed int sub_804DFAC()
{
  signed int result; // eax@1

  result = &unk_80CF533 - &unk_80CF530;
  if ( (unsigned int)(&unk_80CF533 - &unk_80CF530) > 6 )
    result = 0;
  return result;
}
// 804DFAC: could not find valid save-restore pair for ebp

//----- (0804E00B) --------------------------------------------------------
int __fastcall sub_804E00B(int a1, int a2)
{
  int result; // eax@5
  int v3; // [sp-Ch] [bp-Ch]@2

  if ( !byte_80CF840 )
  {
    v3 = a2;
    while ( dword_80CF844 < (unsigned int)(((&unk_80CE0CC - (_UNKNOWN *)dword_80CE068) >> 2) - 1) )
    {
      ++dword_80CF844;
      ((void (*)(void))dword_80CE068[dword_80CF844])();
    }
    sub_804DFAC();
    byte_80CF840 = 1;
    result = v3;
  }
  return result;
}
// 80CE068: using guessed type int dword_80CE068[];
// 80CF840: using guessed type char byte_80CF840;
// 80CF844: using guessed type int dword_80CF844;

//----- (0804E053) --------------------------------------------------------
int sub_804E053()
{
  return 0;
}

//----- (0804E060) --------------------------------------------------------
int __usercall sub_804E060@<eax>(int a1@<eax>)
{
  return std::basic_ios<char,std::char_traits<char>>::clear(
           *(_DWORD *)(*(_DWORD *)a1 - 12) + a1,
           *(_DWORD *)(*(_DWORD *)(*(_DWORD *)a1 - 12) + a1 + 20) | 1);
}
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);

//----- (0804E080) --------------------------------------------------------
int __cdecl sub_804E080(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80B940C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80B940C: using guessed type void *off_80B940C;

//----- (0804E120) --------------------------------------------------------
int __cdecl sub_804E120(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80B9404;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80B9404: using guessed type void *off_80B9404;

//----- (0804E1C0) --------------------------------------------------------
int __cdecl sub_804E1C0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80B9414;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80B9414: using guessed type void *off_80B9414;

//----- (0804E260) --------------------------------------------------------
void __usercall sub_804E260(unsigned int a1@<eax>)
{
  unsigned int v1; // edi@2
  int v2; // eax@2
  unsigned int v3; // edx@2
  void *v4; // edi@2
  int v5; // eax@14

  if ( a1 > 0x3FFFFFFF )
  {
    v5 = std::__throw_bad_alloc();
    sub_804E310(v5);
    return;
  }
  v1 = 4 * a1;
  v2 = operator new(4 * a1);
  v3 = v1;
  v4 = (void *)v2;
  if ( v3 >= 4 )
  {
    if ( v2 & 1 )
    {
      *(_BYTE *)v2 = 0;
      v4 = (void *)(v2 + 1);
      --v3;
    }
    if ( (unsigned __int8)v4 & 2 )
    {
      *(_WORD *)v4 = 0;
      v4 = (char *)v4 + 2;
      v3 -= 2;
    }
    memset(v4, 0, 4 * (v3 >> 2));
    v4 = (char *)v4 + 4 * (v3 >> 2);
  }
  if ( !(v3 & 2) )
  {
    if ( !(v3 & 1) )
      return;
LABEL_6:
    *(_BYTE *)v4 = 0;
    return;
  }
  *(_WORD *)v4 = 0;
  v4 = (char *)v4 + 2;
  if ( v3 & 1 )
    goto LABEL_6;
}

//----- (0804E310) --------------------------------------------------------
void __usercall sub_804E310(int a1@<eax>)
{
  int v1; // ecx@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@1
  void *v3; // eax@3
  int v4; // ebp@4
  int v5; // esi@5
  int v6; // eax@5
  int v7; // eax@8
  void *v8; // edi@11
  void *v9; // ebx@11
  int v10; // eax@12
  int v11; // edx@12
  void *v12; // edi@17
  void *v13; // ebx@17
  int v14; // eax@18
  int v15; // edx@18
  int v16; // eax@23
  int v17; // edx@23
  int v18; // eax@24
  void *v19; // eax@29
  int v20; // ebp@30
  int v21; // esi@31
  int v22; // eax@31
  int v23; // eax@34
  void *v24; // edi@37
  void *v25; // ebx@37
  int v26; // eax@38
  int v27; // edx@38
  void *v28; // edi@43
  void *v29; // ebx@43
  int v30; // eax@44
  int v31; // edx@44
  int v32; // eax@49
  int v33; // edx@49
  int v34; // eax@50
  int v35; // eax@55
  void *v36; // esi@57
  void *v37; // ebx@57
  int v38; // eax@58
  bool v39; // zf@58
  int v40; // eax@65
  signed __int32 v41; // eax@71
  signed __int32 v42; // eax@75
  signed __int32 v43; // eax@79
  signed __int32 v44; // eax@83
  signed __int32 v45; // ecx@86
  signed __int32 v46; // ecx@87
  signed __int32 v47; // ecx@88
  signed __int32 v48; // ecx@89
  signed __int32 v49; // ebx@91
  signed __int32 v50; // eax@95
  signed __int32 v51; // ebx@99
  signed __int32 v52; // eax@101
  signed __int32 v53; // ebx@105
  signed __int32 v54; // ebx@108
  int v55; // [sp+18h] [bp-54h]@4
  int v56; // [sp+18h] [bp-54h]@30
  void *v57; // [sp+1Ch] [bp-50h]@3
  void *v58; // [sp+1Ch] [bp-50h]@29
  int v59; // [sp+20h] [bp-4Ch]@4
  int v60; // [sp+20h] [bp-4Ch]@30
  void *v61; // [sp+28h] [bp-44h]@3
  void *v62; // [sp+28h] [bp-44h]@29
  int v63; // [sp+2Ch] [bp-40h]@4
  int v64; // [sp+2Ch] [bp-40h]@30
  int v65; // [sp+30h] [bp-3Ch]@4
  int v66; // [sp+30h] [bp-3Ch]@30
  int v67; // [sp+34h] [bp-38h]@4
  int v68; // [sp+34h] [bp-38h]@30
  int v69; // [sp+38h] [bp-34h]@4
  int v70; // [sp+38h] [bp-34h]@30
  void *v71; // [sp+3Ch] [bp-30h]@1
  char v72; // [sp+4Fh] [bp-1Dh]@73

  v1 = a1;
  v71 = (void *)a1;
  v2 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 72);
  if ( v2 )
    v2(v1 + 64, v1 + 64, 3);
  v61 = (void *)*((_DWORD *)v71 + 13);
  v3 = (void *)*((_DWORD *)v71 + 12);
  v57 = v3;
  if ( v61 != v3 )
  {
    v59 = (int)((char *)v3 + 28);
    v4 = (int)((char *)v3 + 48);
    v55 = *((_DWORD *)v71 + 12);
    v69 = (int)((char *)v3 + 60);
    v67 = (int)((char *)v3 + 56);
    v65 = (int)((char *)v3 + 20);
    v63 = (int)((char *)v3 + 8);
    do
    {
      v5 = v55 - (_DWORD)v57;
      v6 = *(_DWORD *)(v55 - (_DWORD)v57 + v69);
      if ( v6 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v6 + 4));
        if ( !v6 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v7 = *(_DWORD *)(v5 + v67);
      if ( v7 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v7 + 4));
        if ( !v7 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v8 = *(void **)v4;
      v9 = *(void **)(v4 - 4);
      if ( *(void **)v4 != v9 )
      {
        do
        {
          v10 = *(_DWORD *)v9;
          v11 = *(_DWORD *)v9 - 12;
          if ( (_DWORD *)v11 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v42 = _InterlockedExchangeAdd((volatile signed __int32 *)(v10 - 4), 0xFFFFFFFF);
            }
            else
            {
              v45 = *(_DWORD *)(v10 - 4);
              *(_DWORD *)(v10 - 4) = v45 - 1;
              v42 = v45;
            }
            if ( v42 <= 0 )
              std::string::_Rep::_M_destroy(v11, &v72);
          }
          v9 = (char *)v9 + 4;
        }
        while ( v8 != v9 );
        v8 = *(void **)(v55 + 44);
      }
      if ( v8 )
        operator delete(v8);
      v12 = *(void **)v59;
      v13 = *(void **)(v59 - 4);
      if ( *(void **)v59 != v13 )
      {
        do
        {
          v14 = *(_DWORD *)v13;
          v15 = *(_DWORD *)v13 - 12;
          if ( (_DWORD *)v15 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v43 = _InterlockedExchangeAdd((volatile signed __int32 *)(v14 - 4), 0xFFFFFFFF);
            }
            else
            {
              v48 = *(_DWORD *)(v14 - 4);
              *(_DWORD *)(v14 - 4) = v48 - 1;
              v43 = v48;
            }
            if ( v43 <= 0 )
              std::string::_Rep::_M_destroy(v15, &v72);
          }
          v13 = (char *)v13 + 4;
        }
        while ( v12 != v13 );
        v12 = *(void **)(v55 + 24);
      }
      if ( v12 )
        operator delete(v12);
      v16 = *(_DWORD *)(v5 + v65);
      v17 = v16 - 12;
      if ( (_DWORD *)(v16 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v50 = _InterlockedExchangeAdd((volatile signed __int32 *)(v16 - 4), 0xFFFFFFFF);
        }
        else
        {
          v51 = *(_DWORD *)(v16 - 4);
          *(_DWORD *)(v16 - 4) = v51 - 1;
          v50 = v51;
        }
        if ( v50 <= 0 )
          std::string::_Rep::_M_destroy(v17, &v72);
      }
      v18 = *(_DWORD *)(v5 + v63);
      if ( (_DWORD *)(v18 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v53 = _InterlockedExchangeAdd((volatile signed __int32 *)(v18 - 4), 0xFFFFFFFF);
        }
        else
        {
          v53 = *(_DWORD *)(v18 - 4);
          *(_DWORD *)(v18 - 4) = v53 - 1;
        }
        if ( v53 <= 0 )
          std::string::_Rep::_M_destroy(v18 - 12, &v72);
      }
      v55 += 64;
      v59 += 64;
      v4 += 64;
    }
    while ( v61 != (void *)v55 );
    v61 = (void *)*((_DWORD *)v71 + 12);
  }
  if ( v61 )
    operator delete(v61);
  v62 = (void *)*((_DWORD *)v71 + 10);
  v19 = (void *)*((_DWORD *)v71 + 9);
  v58 = v19;
  if ( v62 != v19 )
  {
    v60 = (int)((char *)v19 + 28);
    v20 = (int)((char *)v19 + 48);
    v56 = *((_DWORD *)v71 + 9);
    v68 = (int)((char *)v19 + 60);
    v66 = (int)((char *)v19 + 56);
    v64 = (int)((char *)v19 + 20);
    v70 = (int)((char *)v19 + 8);
    do
    {
      v21 = v56 - (_DWORD)v58;
      v22 = *(_DWORD *)(v56 - (_DWORD)v58 + v68);
      if ( v22 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v22 + 4));
        if ( !v22 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v23 = *(_DWORD *)(v21 + v66);
      if ( v23 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v23 + 4));
        if ( !v23 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v24 = *(void **)v20;
      v25 = *(void **)(v20 - 4);
      if ( *(void **)v20 != v25 )
      {
        do
        {
          v26 = *(_DWORD *)v25;
          v27 = *(_DWORD *)v25 - 12;
          if ( (_DWORD *)v27 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v44 = _InterlockedExchangeAdd((volatile signed __int32 *)(v26 - 4), 0xFFFFFFFF);
            }
            else
            {
              v47 = *(_DWORD *)(v26 - 4);
              *(_DWORD *)(v26 - 4) = v47 - 1;
              v44 = v47;
            }
            if ( v44 <= 0 )
              std::string::_Rep::_M_destroy(v27, &v72);
          }
          v25 = (char *)v25 + 4;
        }
        while ( v24 != v25 );
        v24 = *(void **)(v56 + 44);
      }
      if ( v24 )
        operator delete(v24);
      v28 = *(void **)v60;
      v29 = *(void **)(v60 - 4);
      if ( *(void **)v60 != v29 )
      {
        do
        {
          v30 = *(_DWORD *)v29;
          v31 = *(_DWORD *)v29 - 12;
          if ( (_DWORD *)v31 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v41 = _InterlockedExchangeAdd((volatile signed __int32 *)(v30 - 4), 0xFFFFFFFF);
            }
            else
            {
              v46 = *(_DWORD *)(v30 - 4);
              *(_DWORD *)(v30 - 4) = v46 - 1;
              v41 = v46;
            }
            if ( v41 <= 0 )
              std::string::_Rep::_M_destroy(v31, &v72);
          }
          v29 = (char *)v29 + 4;
        }
        while ( v28 != v29 );
        v28 = *(void **)(v56 + 24);
      }
      if ( v28 )
        operator delete(v28);
      v32 = *(_DWORD *)(v21 + v64);
      v33 = v32 - 12;
      if ( (_DWORD *)(v32 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v52 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
        }
        else
        {
          v54 = *(_DWORD *)(v32 - 4);
          *(_DWORD *)(v32 - 4) = v54 - 1;
          v52 = v54;
        }
        if ( v52 <= 0 )
          std::string::_Rep::_M_destroy(v33, &v72);
      }
      v34 = *(_DWORD *)(v21 + v70);
      if ( (_DWORD *)(v34 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v49 = _InterlockedExchangeAdd((volatile signed __int32 *)(v34 - 4), 0xFFFFFFFF);
        }
        else
        {
          v49 = *(_DWORD *)(v34 - 4);
          *(_DWORD *)(v34 - 4) = v49 - 1;
        }
        if ( v49 <= 0 )
          std::string::_Rep::_M_destroy(v34 - 12, &v72);
      }
      v56 += 64;
      v60 += 64;
      v20 += 64;
    }
    while ( v62 != (void *)v56 );
    v62 = (void *)*((_DWORD *)v71 + 9);
  }
  if ( v62 )
    operator delete(v62);
  v35 = *((_DWORD *)v71 + 5);
  if ( v35 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v35 + 4));
    if ( !v35 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v36 = (void *)*((_DWORD *)v71 + 3);
  v37 = (void *)*((_DWORD *)v71 + 2);
  if ( v36 != v37 )
  {
    do
    {
      v38 = *(_DWORD *)v37;
      v39 = *(_DWORD *)v37 == 0;
      if ( *(_DWORD *)v37 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v38 + 4));
        if ( v39 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v38 + 4))(v38);
      }
      v37 = (char *)v37 + 4;
    }
    while ( v36 != v37 );
    v36 = (void *)*((_DWORD *)v71 + 2);
  }
  if ( v36 )
    operator delete(v36);
  v40 = *((_DWORD *)v71 + 1);
  if ( v40 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v40 + 4));
    if ( !v40 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  operator delete(v71);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0804E8E0) --------------------------------------------------------
void __cdecl sub_804E8E0(int a1)
{
  unsigned int v1; // eax@1
  int v2; // eax@1

  memset((void *)a1, 0, 0x18u);
  *(_DWORD *)(a1 + 28) = 0;
  *(_DWORD *)(a1 + 32) = 0;
  *(_DWORD *)(a1 + 36) = 0;
  *(_DWORD *)(a1 + 40) = 1065353216;
  *(_DWORD *)(a1 + 44) = 0;
  v1 = std::__detail::_Prime_rehash_policy::_M_next_bkt((std::__detail::_Prime_rehash_policy *)(a1 + 40), 0xAu);
  *(_DWORD *)(a1 + 28) = v1;
  sub_804E260(v1);
  *(_DWORD *)(a1 + 24) = v2;
  *(_DWORD *)(a1 + 48) = 0;
  *(_DWORD *)(a1 + 52) = 0;
  *(_DWORD *)(a1 + 56) = 0;
  *(_DWORD *)(a1 + 60) = 0;
  *(_DWORD *)(a1 + 64) = 0;
  *(_DWORD *)(a1 + 68) = 0;
  *(_DWORD *)(a1 + 72) = 0;
  *(_DWORD *)(a1 + 76) = 0;
  *(_BYTE *)(a1 + 80) = 0;
}

//----- (0804E980) --------------------------------------------------------
void __cdecl sub_804E980(void *a1)
{
  int v1; // esi@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@2
  void (__cdecl *v3)(_DWORD, _DWORD, _DWORD); // eax@4
  int v4; // eax@6
  int v5; // edx@9
  int v6; // ecx@11
  int v7; // eax@15
  int v8; // eax@18
  int v9; // edx@21
  int v10; // ecx@23
  int v11; // eax@27
  int v12; // eax@30
  int v13; // edx@33
  int v14; // ecx@35
  int v15; // eax@39
  int v16; // eax@42
  int v17; // edx@45
  int v18; // ecx@47
  int v19; // eax@51
  int v20; // edi@54
  int v21; // eax@56
  int v22; // edx@59
  int v23; // ecx@61
  int v24; // eax@65
  void *v25; // edi@69
  void *v26; // esi@69
  int v27; // eax@70
  bool v28; // zf@70
  void *v29; // edi@77
  void *v30; // esi@77
  int v31; // eax@78
  bool v32; // zf@78
  int v33; // eax@85
  int v34; // esi@88
  unsigned int v35; // edx@89
  void *v36; // edi@89
  int v37; // eax@57

  v1 = *((_DWORD *)a1 + 19);
  if ( v1 )
  {
    v2 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(v1 + 92);
    if ( v2 )
      v2(v1 + 84, v1 + 84, 3);
    v3 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(v1 + 76);
    if ( v3 )
      v3(v1 + 68, v1 + 68, 3);
    v4 = *(_DWORD *)(v1 + 60);
    if ( v4 == v1 + 56 )
    {
      *(_DWORD *)(v1 + 56) = &off_80B94F0;
    }
    else
    {
      while ( 1 )
      {
        v5 = *(_DWORD *)(v4 + 4);
        if ( v5 )
        {
          *(_DWORD *)(v5 + 8) = *(_DWORD *)(v4 + 8);
          v5 = *(_DWORD *)(v4 + 4);
        }
        v6 = *(_DWORD *)(v4 + 8);
        if ( v6 )
        {
          *(_DWORD *)(v6 + 4) = v5;
          v5 = *(_DWORD *)(v4 + 4);
        }
        *(_DWORD *)(v4 + 4) = 0;
        *(_DWORD *)(v4 + 8) = 0;
        if ( v1 + 56 == v5 )
          break;
        v4 = v5;
      }
      v4 = *(_DWORD *)(v1 + 60);
      *(_DWORD *)(v1 + 56) = &off_80B94F0;
      if ( !v4 )
      {
        v7 = *(_DWORD *)(v1 + 64);
        if ( !v7 )
        {
LABEL_18:
          v8 = *(_DWORD *)(v1 + 48);
          if ( v8 == v1 + 44 )
          {
            *(_DWORD *)(v1 + 44) = &off_80B94F0;
          }
          else
          {
            while ( 1 )
            {
              v9 = *(_DWORD *)(v8 + 4);
              if ( v9 )
              {
                *(_DWORD *)(v9 + 8) = *(_DWORD *)(v8 + 8);
                v9 = *(_DWORD *)(v8 + 4);
              }
              v10 = *(_DWORD *)(v8 + 8);
              if ( v10 )
              {
                *(_DWORD *)(v10 + 4) = v9;
                v9 = *(_DWORD *)(v8 + 4);
              }
              *(_DWORD *)(v8 + 4) = 0;
              *(_DWORD *)(v8 + 8) = 0;
              if ( v1 + 44 == v9 )
                break;
              v8 = v9;
            }
            v8 = *(_DWORD *)(v1 + 48);
            *(_DWORD *)(v1 + 44) = &off_80B94F0;
            if ( !v8 )
            {
              v11 = *(_DWORD *)(v1 + 52);
              if ( !v11 )
              {
LABEL_30:
                v12 = *(_DWORD *)(v1 + 36);
                if ( v12 == v1 + 32 )
                {
                  *(_DWORD *)(v1 + 32) = &off_80B94F0;
                }
                else
                {
                  while ( 1 )
                  {
                    v13 = *(_DWORD *)(v12 + 4);
                    if ( v13 )
                    {
                      *(_DWORD *)(v13 + 8) = *(_DWORD *)(v12 + 8);
                      v13 = *(_DWORD *)(v12 + 4);
                    }
                    v14 = *(_DWORD *)(v12 + 8);
                    if ( v14 )
                    {
                      *(_DWORD *)(v14 + 4) = v13;
                      v13 = *(_DWORD *)(v12 + 4);
                    }
                    *(_DWORD *)(v12 + 4) = 0;
                    *(_DWORD *)(v12 + 8) = 0;
                    if ( v1 + 32 == v13 )
                      break;
                    v12 = v13;
                  }
                  v12 = *(_DWORD *)(v1 + 36);
                  *(_DWORD *)(v1 + 32) = &off_80B94F0;
                  if ( !v12 )
                  {
                    v15 = *(_DWORD *)(v1 + 40);
                    if ( !v15 )
                    {
LABEL_42:
                      v16 = *(_DWORD *)(v1 + 24);
                      if ( v16 == v1 + 20 )
                      {
                        *(_DWORD *)(v1 + 20) = &off_80B9500;
                      }
                      else
                      {
                        while ( 1 )
                        {
                          v17 = *(_DWORD *)(v16 + 4);
                          if ( v17 )
                          {
                            *(_DWORD *)(v17 + 8) = *(_DWORD *)(v16 + 8);
                            v17 = *(_DWORD *)(v16 + 4);
                          }
                          v18 = *(_DWORD *)(v16 + 8);
                          if ( v18 )
                          {
                            *(_DWORD *)(v18 + 4) = v17;
                            v17 = *(_DWORD *)(v16 + 4);
                          }
                          *(_DWORD *)(v16 + 4) = 0;
                          *(_DWORD *)(v16 + 8) = 0;
                          if ( v1 + 20 == v17 )
                            break;
                          v16 = v17;
                        }
                        v16 = *(_DWORD *)(v1 + 24);
                        *(_DWORD *)(v1 + 20) = &off_80B9500;
                        if ( !v16 )
                        {
                          v19 = *(_DWORD *)(v1 + 28);
                          if ( !v19 )
                          {
LABEL_54:
                            v20 = *(_DWORD *)(v1 + 16);
                            if ( v20 )
                            {
                              evdns_base_free(*(_DWORD *)(v20 + 4), 1);
                              operator delete((void *)v20);
                            }
                            *(_DWORD *)(v1 + 16) = 0;
                            v21 = *(_DWORD *)(v1 + 4);
                            if ( v21 == v1 )
                            {
                              *(_DWORD *)v1 = &off_80B9500;
                              v37 = v1;
                            }
                            else
                            {
                              while ( 1 )
                              {
                                v22 = *(_DWORD *)(v21 + 4);
                                if ( v22 )
                                {
                                  *(_DWORD *)(v22 + 8) = *(_DWORD *)(v21 + 8);
                                  v22 = *(_DWORD *)(v21 + 4);
                                }
                                v23 = *(_DWORD *)(v21 + 8);
                                if ( v23 )
                                {
                                  *(_DWORD *)(v23 + 4) = v22;
                                  v22 = *(_DWORD *)(v21 + 4);
                                }
                                *(_DWORD *)(v21 + 4) = 0;
                                *(_DWORD *)(v21 + 8) = 0;
                                if ( v1 == v22 )
                                  break;
                                v21 = v22;
                              }
                              v37 = *(_DWORD *)(v1 + 4);
                              *(_DWORD *)v1 = &off_80B9500;
                              if ( !v37 )
                              {
                                v24 = *(_DWORD *)(v1 + 8);
                                if ( !v24 )
                                  goto LABEL_68;
                                goto LABEL_66;
                              }
                            }
                            *(_DWORD *)(v37 + 8) = *(_DWORD *)(v1 + 8);
                            v24 = *(_DWORD *)(v1 + 8);
                            if ( !v24 )
                            {
LABEL_67:
                              *(_DWORD *)(v1 + 4) = 0;
                              *(_DWORD *)(v1 + 8) = 0;
LABEL_68:
                              operator delete((void *)v1);
                              goto LABEL_69;
                            }
LABEL_66:
                            *(_DWORD *)(v24 + 4) = *(_DWORD *)(v1 + 4);
                            goto LABEL_67;
                          }
                          goto LABEL_52;
                        }
                      }
                      *(_DWORD *)(v16 + 8) = *(_DWORD *)(v1 + 28);
                      v19 = *(_DWORD *)(v1 + 28);
                      if ( !v19 )
                      {
LABEL_53:
                        *(_DWORD *)(v1 + 24) = 0;
                        *(_DWORD *)(v1 + 28) = 0;
                        goto LABEL_54;
                      }
LABEL_52:
                      *(_DWORD *)(v19 + 4) = *(_DWORD *)(v1 + 24);
                      goto LABEL_53;
                    }
                    goto LABEL_40;
                  }
                }
                *(_DWORD *)(v12 + 8) = *(_DWORD *)(v1 + 40);
                v15 = *(_DWORD *)(v1 + 40);
                if ( !v15 )
                {
LABEL_41:
                  *(_DWORD *)(v1 + 36) = 0;
                  *(_DWORD *)(v1 + 40) = 0;
                  goto LABEL_42;
                }
LABEL_40:
                *(_DWORD *)(v15 + 4) = *(_DWORD *)(v1 + 36);
                goto LABEL_41;
              }
              goto LABEL_28;
            }
          }
          *(_DWORD *)(v8 + 8) = *(_DWORD *)(v1 + 52);
          v11 = *(_DWORD *)(v1 + 52);
          if ( !v11 )
          {
LABEL_29:
            *(_DWORD *)(v1 + 48) = 0;
            *(_DWORD *)(v1 + 52) = 0;
            goto LABEL_30;
          }
LABEL_28:
          *(_DWORD *)(v11 + 4) = *(_DWORD *)(v1 + 48);
          goto LABEL_29;
        }
        goto LABEL_16;
      }
    }
    *(_DWORD *)(v4 + 8) = *(_DWORD *)(v1 + 64);
    v7 = *(_DWORD *)(v1 + 64);
    if ( !v7 )
    {
LABEL_17:
      *(_DWORD *)(v1 + 60) = 0;
      *(_DWORD *)(v1 + 64) = 0;
      goto LABEL_18;
    }
LABEL_16:
    *(_DWORD *)(v7 + 4) = *(_DWORD *)(v1 + 60);
    goto LABEL_17;
  }
LABEL_69:
  *((_DWORD *)a1 + 19) = 0;
  v25 = (void *)*((_DWORD *)a1 + 17);
  v26 = (void *)*((_DWORD *)a1 + 16);
  if ( v25 != v26 )
  {
    do
    {
      v27 = *(_DWORD *)v26;
      v28 = *(_DWORD *)v26 == 0;
      if ( *(_DWORD *)v26 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v27 + 4));
        if ( v28 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v27 + 4))(v27);
      }
      v26 = (char *)v26 + 4;
    }
    while ( v25 != v26 );
    v25 = (void *)*((_DWORD *)a1 + 16);
  }
  if ( v25 )
    operator delete(v25);
  v29 = (void *)*((_DWORD *)a1 + 13);
  v30 = (void *)*((_DWORD *)a1 + 12);
  if ( v29 != v30 )
  {
    do
    {
      v31 = *(_DWORD *)v30;
      v32 = *(_DWORD *)v30 == 0;
      if ( *(_DWORD *)v30 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v31 + 4));
        if ( v32 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v31 + 4))(v31);
      }
      v30 = (char *)v30 + 4;
    }
    while ( v29 != v30 );
    v29 = (void *)*((_DWORD *)a1 + 12);
  }
  if ( v29 )
    operator delete(v29);
  v33 = *((_DWORD *)a1 + 8);
  if ( v33 )
  {
    while ( 1 )
    {
      v34 = *(_DWORD *)v33;
      sub_804E310(v33);
      if ( !v34 )
        break;
      v33 = v34;
    }
  }
  v35 = 4 * *((_DWORD *)a1 + 7);
  v36 = (void *)*((_DWORD *)a1 + 6);
  if ( v35 >= 4 )
  {
    if ( (unsigned __int8)v36 & 1 )
    {
      *(_BYTE *)v36 = 0;
      v36 = (char *)v36 + 1;
      --v35;
    }
    if ( (unsigned __int8)v36 & 2 )
    {
      *(_WORD *)v36 = 0;
      v36 = (char *)v36 + 2;
      v35 -= 2;
    }
    memset(v36, 0, 4 * (v35 >> 2));
    v36 = (char *)v36 + 4 * (v35 >> 2);
  }
  if ( v35 & 2 )
  {
    *(_WORD *)v36 = 0;
    v36 = (char *)v36 + 2;
  }
  if ( v35 & 1 )
    *(_BYTE *)v36 = 0;
  *((_DWORD *)a1 + 9) = 0;
  *((_DWORD *)a1 + 8) = 0;
  operator delete(*((void **)a1 + 6));
}
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 80B94F0: using guessed type int (__cdecl *off_80B94F0)(int);
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);

//----- (0804EE40) --------------------------------------------------------
int __cdecl sub_804EE40(int a1, int a2)
{
  int v2; // eax@1
  int v3; // eax@1
  int v4; // ebp@1
  int v5; // edx@1
  void (__cdecl *v6)(_DWORD, _DWORD, _DWORD); // eax@2
  int v7; // ST1C_4@3
  void (__cdecl *v8)(_DWORD, _DWORD, _DWORD); // eax@4
  int v9; // ST1C_4@5
  int v10; // eax@6
  int v11; // ecx@9
  int v12; // ebp@11
  int v13; // eax@15
  int v14; // eax@18
  int v15; // ecx@21
  int v16; // ebp@23
  int v17; // eax@27
  int v18; // eax@30
  int v19; // ecx@33
  int v20; // ebp@35
  int v21; // eax@39
  int v22; // eax@42
  int v23; // ecx@45
  int v24; // ebp@47
  int v25; // eax@51
  int v26; // ebx@54
  int v27; // ST1C_4@55
  int v28; // eax@56
  int v29; // ecx@59
  int v30; // ebx@61
  int v31; // eax@65
  int result; // eax@71
  int v33; // eax@57
  int v34; // [sp+20h] [bp-3Ch]@1
  int (__cdecl *v35)(void **, void **, signed int); // [sp+28h] [bp-34h]@1
  int (*v36)(); // [sp+2Ch] [bp-30h]@1
  int v37; // [sp+30h] [bp-2Ch]@1
  int (__cdecl *v38)(void **, void **, signed int); // [sp+38h] [bp-24h]@1
  int (__usercall *v39)@<eax>(std::ios_base *@<esi>, pthread_mutex_t ***, int, int *); // [sp+3Ch] [bp-20h]@1

  v2 = operator new(4u);
  *(_DWORD *)v2 = a1;
  v34 = v2;
  v36 = sub_80531A0;
  v35 = sub_804E080;
  v3 = operator new(4u);
  *(_DWORD *)v3 = a1;
  v37 = v3;
  v39 = sub_8056B10;
  v38 = sub_804E120;
  v4 = operator new(0x70u);
  sub_80A7C10(v4, a2, (int)&v34, (int)&v37);
  v5 = *(_DWORD *)(a1 + 76);
  *(_DWORD *)(a1 + 76) = v4;
  if ( v5 )
  {
    v6 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(v5 + 92);
    if ( v6 )
    {
      v7 = v5;
      v6(v5 + 84, v5 + 84, 3);
      v5 = v7;
    }
    v8 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(v5 + 76);
    if ( v8 )
    {
      v9 = v5;
      v8(v5 + 68, v5 + 68, 3);
      v5 = v9;
    }
    v10 = *(_DWORD *)(v5 + 60);
    if ( v10 == v5 + 56 )
    {
      *(_DWORD *)(v5 + 56) = &off_80B94F0;
    }
    else
    {
      while ( 1 )
      {
        v11 = *(_DWORD *)(v10 + 4);
        if ( v11 )
        {
          *(_DWORD *)(v11 + 8) = *(_DWORD *)(v10 + 8);
          v11 = *(_DWORD *)(v10 + 4);
        }
        v12 = *(_DWORD *)(v10 + 8);
        if ( v12 )
        {
          *(_DWORD *)(v12 + 4) = v11;
          v11 = *(_DWORD *)(v10 + 4);
        }
        *(_DWORD *)(v10 + 4) = 0;
        *(_DWORD *)(v10 + 8) = 0;
        if ( v5 + 56 == v11 )
          break;
        v10 = v11;
      }
      v10 = *(_DWORD *)(v5 + 60);
      *(_DWORD *)(v5 + 56) = &off_80B94F0;
      if ( !v10 )
      {
        v13 = *(_DWORD *)(v5 + 64);
        if ( !v13 )
        {
LABEL_18:
          v14 = *(_DWORD *)(v5 + 48);
          if ( v14 == v5 + 44 )
          {
            *(_DWORD *)(v5 + 44) = &off_80B94F0;
          }
          else
          {
            while ( 1 )
            {
              v15 = *(_DWORD *)(v14 + 4);
              if ( v15 )
              {
                *(_DWORD *)(v15 + 8) = *(_DWORD *)(v14 + 8);
                v15 = *(_DWORD *)(v14 + 4);
              }
              v16 = *(_DWORD *)(v14 + 8);
              if ( v16 )
              {
                *(_DWORD *)(v16 + 4) = v15;
                v15 = *(_DWORD *)(v14 + 4);
              }
              *(_DWORD *)(v14 + 4) = 0;
              *(_DWORD *)(v14 + 8) = 0;
              if ( v5 + 44 == v15 )
                break;
              v14 = v15;
            }
            v14 = *(_DWORD *)(v5 + 48);
            *(_DWORD *)(v5 + 44) = &off_80B94F0;
            if ( !v14 )
            {
              v17 = *(_DWORD *)(v5 + 52);
              if ( !v17 )
              {
LABEL_30:
                v18 = *(_DWORD *)(v5 + 36);
                if ( v18 == v5 + 32 )
                {
                  *(_DWORD *)(v5 + 32) = &off_80B94F0;
                }
                else
                {
                  while ( 1 )
                  {
                    v19 = *(_DWORD *)(v18 + 4);
                    if ( v19 )
                    {
                      *(_DWORD *)(v19 + 8) = *(_DWORD *)(v18 + 8);
                      v19 = *(_DWORD *)(v18 + 4);
                    }
                    v20 = *(_DWORD *)(v18 + 8);
                    if ( v20 )
                    {
                      *(_DWORD *)(v20 + 4) = v19;
                      v19 = *(_DWORD *)(v18 + 4);
                    }
                    *(_DWORD *)(v18 + 4) = 0;
                    *(_DWORD *)(v18 + 8) = 0;
                    if ( v5 + 32 == v19 )
                      break;
                    v18 = v19;
                  }
                  v18 = *(_DWORD *)(v5 + 36);
                  *(_DWORD *)(v5 + 32) = &off_80B94F0;
                  if ( !v18 )
                  {
                    v21 = *(_DWORD *)(v5 + 40);
                    if ( !v21 )
                    {
LABEL_42:
                      v22 = *(_DWORD *)(v5 + 24);
                      if ( v22 == v5 + 20 )
                      {
                        *(_DWORD *)(v5 + 20) = &off_80B9500;
                      }
                      else
                      {
                        while ( 1 )
                        {
                          v23 = *(_DWORD *)(v22 + 4);
                          if ( v23 )
                          {
                            *(_DWORD *)(v23 + 8) = *(_DWORD *)(v22 + 8);
                            v23 = *(_DWORD *)(v22 + 4);
                          }
                          v24 = *(_DWORD *)(v22 + 8);
                          if ( v24 )
                          {
                            *(_DWORD *)(v24 + 4) = v23;
                            v23 = *(_DWORD *)(v22 + 4);
                          }
                          *(_DWORD *)(v22 + 4) = 0;
                          *(_DWORD *)(v22 + 8) = 0;
                          if ( v5 + 20 == v23 )
                            break;
                          v22 = v23;
                        }
                        v22 = *(_DWORD *)(v5 + 24);
                        *(_DWORD *)(v5 + 20) = &off_80B9500;
                        if ( !v22 )
                        {
                          v25 = *(_DWORD *)(v5 + 28);
                          if ( !v25 )
                          {
LABEL_54:
                            v26 = *(_DWORD *)(v5 + 16);
                            if ( v26 )
                            {
                              v27 = v5;
                              evdns_base_free(*(_DWORD *)(v26 + 4), 1);
                              operator delete((void *)v26);
                              v5 = v27;
                            }
                            *(_DWORD *)(v5 + 16) = 0;
                            v28 = *(_DWORD *)(v5 + 4);
                            if ( v28 == v5 )
                            {
                              *(_DWORD *)v5 = &off_80B9500;
                              v33 = v5;
                            }
                            else
                            {
                              while ( 1 )
                              {
                                v29 = *(_DWORD *)(v28 + 4);
                                if ( v29 )
                                {
                                  *(_DWORD *)(v29 + 8) = *(_DWORD *)(v28 + 8);
                                  v29 = *(_DWORD *)(v28 + 4);
                                }
                                v30 = *(_DWORD *)(v28 + 8);
                                if ( v30 )
                                {
                                  *(_DWORD *)(v30 + 4) = v29;
                                  v29 = *(_DWORD *)(v28 + 4);
                                }
                                *(_DWORD *)(v28 + 4) = 0;
                                *(_DWORD *)(v28 + 8) = 0;
                                if ( v5 == v29 )
                                  break;
                                v28 = v29;
                              }
                              v33 = *(_DWORD *)(v5 + 4);
                              *(_DWORD *)v5 = &off_80B9500;
                              if ( !v33 )
                              {
                                v31 = *(_DWORD *)(v5 + 8);
                                if ( !v31 )
                                  goto LABEL_68;
                                goto LABEL_66;
                              }
                            }
                            *(_DWORD *)(v33 + 8) = *(_DWORD *)(v5 + 8);
                            v31 = *(_DWORD *)(v5 + 8);
                            if ( !v31 )
                            {
LABEL_67:
                              *(_DWORD *)(v5 + 4) = 0;
                              *(_DWORD *)(v5 + 8) = 0;
LABEL_68:
                              operator delete((void *)v5);
                              goto LABEL_69;
                            }
LABEL_66:
                            *(_DWORD *)(v31 + 4) = *(_DWORD *)(v5 + 4);
                            goto LABEL_67;
                          }
                          goto LABEL_52;
                        }
                      }
                      *(_DWORD *)(v22 + 8) = *(_DWORD *)(v5 + 28);
                      v25 = *(_DWORD *)(v5 + 28);
                      if ( !v25 )
                      {
LABEL_53:
                        *(_DWORD *)(v5 + 24) = 0;
                        *(_DWORD *)(v5 + 28) = 0;
                        goto LABEL_54;
                      }
LABEL_52:
                      *(_DWORD *)(v25 + 4) = *(_DWORD *)(v5 + 24);
                      goto LABEL_53;
                    }
                    goto LABEL_40;
                  }
                }
                *(_DWORD *)(v18 + 8) = *(_DWORD *)(v5 + 40);
                v21 = *(_DWORD *)(v5 + 40);
                if ( !v21 )
                {
LABEL_41:
                  *(_DWORD *)(v5 + 36) = 0;
                  *(_DWORD *)(v5 + 40) = 0;
                  goto LABEL_42;
                }
LABEL_40:
                *(_DWORD *)(v21 + 4) = *(_DWORD *)(v5 + 36);
                goto LABEL_41;
              }
              goto LABEL_28;
            }
          }
          *(_DWORD *)(v14 + 8) = *(_DWORD *)(v5 + 52);
          v17 = *(_DWORD *)(v5 + 52);
          if ( !v17 )
          {
LABEL_29:
            *(_DWORD *)(v5 + 48) = 0;
            *(_DWORD *)(v5 + 52) = 0;
            goto LABEL_30;
          }
LABEL_28:
          *(_DWORD *)(v17 + 4) = *(_DWORD *)(v5 + 48);
          goto LABEL_29;
        }
        goto LABEL_16;
      }
    }
    *(_DWORD *)(v10 + 8) = *(_DWORD *)(v5 + 64);
    v13 = *(_DWORD *)(v5 + 64);
    if ( !v13 )
    {
LABEL_17:
      *(_DWORD *)(v5 + 60) = 0;
      *(_DWORD *)(v5 + 64) = 0;
      goto LABEL_18;
    }
LABEL_16:
    *(_DWORD *)(v13 + 4) = *(_DWORD *)(v5 + 60);
    goto LABEL_17;
  }
LABEL_69:
  if ( v38 )
    v38((void **)&v37, (void **)&v37, 3);
  result = (int)v35;
  if ( v35 )
    result = v35((void **)&v34, (void **)&v34, 3);
  return result;
}
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 80531A0: using guessed type int sub_80531A0();
// 80B94F0: using guessed type int (__cdecl *off_80B94F0)(int);
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);

//----- (0804F340) --------------------------------------------------------
int __userpurge sub_804F340@<eax>(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // esi@1
  int v5; // ST18_4@1
  int v6; // eax@2
  int v7; // eax@4
  __int64 v9; // [sp+28h] [bp-20h]@1

  v3 = *(_DWORD *)(*(_DWORD *)(a2 + 24) + 32);
  *(_DWORD *)a1 = a3;
  *(_DWORD *)(a1 + 8) = &unk_80CF83C;
  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = &unk_80CF83C;
  *(_DWORD *)(a1 + 24) = 0;
  *(_DWORD *)(a1 + 28) = 0;
  *(_DWORD *)(a1 + 32) = 0;
  *(_DWORD *)(a1 + 36) = 0;
  *(_DWORD *)(a1 + 40) = 0;
  *(_DWORD *)(a1 + 44) = 0;
  *(_DWORD *)(a1 + 48) = 0;
  *(_DWORD *)(a1 + 52) = 0;
  *(_DWORD *)(a1 + 56) = 0;
  v4 = *(_DWORD *)(v3 + 12);
  v5 = *(_DWORD *)(v4 + 44);
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v9);
  *(_DWORD *)(a1 + 4) = v5 + (signed int)((long double)(v9 - *(_QWORD *)(v4 + 48)) / 1000000000.0);
  if ( a2 + 28 != a1 + 56 )
  {
    v6 = *(_DWORD *)(a1 + 56);
    if ( v6 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v6 + 4));
      if ( !v6 )
        (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
    }
    v7 = *(_DWORD *)(a2 + 28);
    *(_DWORD *)(a1 + 56) = v7;
    if ( v7 )
      _InterlockedIncrement((volatile signed __int32 *)(v7 + 4));
  }
  if ( *(_DWORD *)(a2 + 36) != *(_DWORD *)(a2 + 32) )
    sub_8058140(a1 + 44, a2 + 32);
  return a1;
}

//----- (0804F480) --------------------------------------------------------
pthread_mutex_t *__cdecl sub_804F480(pthread_mutex_t *mutex, int a2, int a3)
{
  int v3; // eax@3
  int v4; // ebx@4
  pthread_mutex_t *result; // eax@7
  int v6; // edx@8
  int v7; // ST18_4@12
  int v8; // [sp+1Ch] [bp-2Ch]@12
  pthread_mutex_t *v9; // [sp+28h] [bp-20h]@1
  char v10; // [sp+2Ch] [bp-1Ch]@1

  v9 = mutex;
  v10 = 0;
  if ( !mutex )
    goto LABEL_20;
  if ( &_pthread_key_create )
  {
    v3 = pthread_mutex_lock(mutex);
    if ( v3 )
    {
      std::__throw_system_error(v3);
LABEL_20:
      std::__throw_system_error(1);
      return (pthread_mutex_t *)sub_804F5E0((int)mutex, a2, a3);
    }
  }
  v10 = 1;
  v4 = mutex[1].__owner;
  if ( !v4 )
    goto LABEL_23;
  do
  {
    while ( 1 )
    {
      result = *(pthread_mutex_t **)(v4 + 4);
      if ( *(_DWORD *)(result->__kind + 8) == a2 )
        break;
      v4 = *(_DWORD *)v4;
      if ( !v4 )
        goto LABEL_13;
    }
    v6 = mutex[2].__spins;
    if ( v6 == mutex[3].__lock )
    {
      sub_80584E0((int)&mutex[2].__nusers, v4 + 4);
    }
    else
    {
      if ( v6 )
      {
        *(_DWORD *)v6 = result;
        _InterlockedIncrement((volatile signed __int32 *)&result->__count);
        v6 = mutex[2].__spins;
      }
      mutex[2].__spins = v6 + 4;
    }
    v7 = mutex[2].__count;
    sub_8057EB0((int)&v8, mutex[2].__lock, v7, v4 + 4);
    result = (pthread_mutex_t *)sub_8058060((int)&v8, (int)&mutex[2], v8, v7);
    v4 = *(_DWORD *)v4;
  }
  while ( v4 );
LABEL_13:
  if ( v10 )
  {
LABEL_23:
    result = v9;
    if ( v9 )
    {
      if ( &_pthread_key_create )
        result = (pthread_mutex_t *)pthread_mutex_unlock(v9);
    }
  }
  return result;
}

//----- (0804F5E0) --------------------------------------------------------
int __userpurge sub_804F5E0@<eax>(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // esi@1
  int v5; // ST28_4@1
  int v6; // eax@2
  int v7; // eax@4
  int v8; // eax@6
  int v9; // eax@8
  int v10; // esi@9
  int v11; // eax@12
  size_t v12; // ST24_4@12
  int v13; // eax@12
  int v14; // ST24_4@12
  int v15; // eax@12
  int v16; // eax@12
  int v17; // eax@12
  int v18; // edx@16
  int v19; // eax@17
  int i; // ebx@18
  int v21; // eax@20
  unsigned int v22; // eax@20
  int v23; // eax@20
  int v24; // edx@20
  int v25; // eax@21
  int v26; // edx@25
  int v27; // edx@26
  int v28; // eax@28
  const char *v29; // esi@30
  int v31; // eax@35
  size_t v32; // ST24_4@35
  int v33; // eax@35
  int v34; // eax@35
  signed __int32 v35; // esi@38
  signed __int32 v36; // esi@42
  signed __int32 v37; // esi@46
  signed __int32 v38; // ecx@50
  size_t n; // [sp+20h] [bp-48h]@12
  int v40; // [sp+24h] [bp-44h]@10
  __int64 v41; // [sp+38h] [bp-30h]@1
  char v42; // [sp+42h] [bp-26h]@20
  char v43; // [sp+43h] [bp-25h]@44
  int v44; // [sp+44h] [bp-24h]@20
  int v45; // [sp+48h] [bp-20h]@16
  int v46; // [sp+4Ch] [bp-1Ch]@16

  v3 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a2 + 180) + 24) + 32);
  *(_DWORD *)a1 = a3;
  *(_DWORD *)(a1 + 8) = &unk_80CF83C;
  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = &unk_80CF83C;
  *(_DWORD *)(a1 + 24) = 0;
  *(_DWORD *)(a1 + 28) = 0;
  *(_DWORD *)(a1 + 32) = 0;
  *(_DWORD *)(a1 + 36) = 0;
  *(_DWORD *)(a1 + 40) = 0;
  *(_DWORD *)(a1 + 44) = 0;
  *(_DWORD *)(a1 + 48) = 0;
  *(_DWORD *)(a1 + 52) = 0;
  *(_DWORD *)(a1 + 56) = 0;
  v4 = *(_DWORD *)(v3 + 12);
  v5 = *(_DWORD *)(v4 + 44);
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v41);
  *(_DWORD *)(a1 + 4) = v5 + (signed int)((long double)(v41 - *(_QWORD *)(v4 + 48)) / 1000000000.0);
  std::string::assign((std::string *)(a1 + 8), (const std::string *)(a2 + 12));
  if ( a2 + 4 != a1 + 56 )
  {
    v6 = *(_DWORD *)(a1 + 56);
    if ( v6 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v6 + 4));
      if ( !v6 )
        (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
    }
    v7 = *(_DWORD *)(a2 + 4);
    *(_DWORD *)(a1 + 56) = v7;
    if ( v7 )
      _InterlockedIncrement((volatile signed __int32 *)(v7 + 4));
  }
  *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 8);
  v8 = *(_DWORD *)(a2 + 180);
  if ( *(_DWORD *)(v8 + 36) != *(_DWORD *)(v8 + 32) )
    sub_8058140(a1 + 44, v8 + 32);
  v9 = *(_DWORD *)(a2 + 100);
  if ( v9 )
  {
    *(_DWORD *)(a1 + 16) = *(_DWORD *)(v9 + 64);
    v10 = *(_DWORD *)(a2 + 100);
    if ( *(_DWORD *)(v10 + 64) > 0 )
    {
      v40 = dword_80CF850;
      if ( v10 )
      {
        if ( *(_DWORD *)(a2 + 156) == *(_DWORD *)(a2 + 152) )
        {
          v31 = evhttp_request_get_input_buffer(v10);
          v32 = evbuffer_get_length(v31);
          v33 = evhttp_request_get_input_buffer(v10);
          n = evbuffer_pullup(v33, v32);
          v34 = evhttp_request_get_input_buffer(v10);
          v17 = evbuffer_get_length(v34);
        }
        else
        {
          v11 = evhttp_request_get_input_buffer(v10);
          v12 = evbuffer_get_length(v11);
          v13 = evhttp_request_get_input_buffer(v10);
          v14 = evbuffer_pullup(v13, v12);
          v15 = evhttp_request_get_input_buffer(v10);
          v16 = evbuffer_get_length(v15);
          sub_8058890((void *)(a2 + 152), *(void **)(a2 + 156), v14, v14 + v16);
          n = *(_DWORD *)(a2 + 152);
          v17 = *(_DWORD *)(a2 + 156) - n;
        }
      }
      else
      {
        v17 = 0;
        n = 0;
      }
      if ( v40 > 0 && v17 > (unsigned int)v40 )
        v17 = v40;
      std::string::string(&v46, n, v17, &v45);
      std::string::swap((std::string *)(a1 + 20), (std::string *)&v46);
      v18 = v46 - 12;
      if ( (_DWORD *)(v46 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
        }
        else
        {
          v38 = *(_DWORD *)(v46 - 4);
          *(_DWORD *)(v46 - 4) = v38 - 1;
        }
        if ( v38 <= 0 )
          std::string::_Rep::_M_destroy(v18, &v45);
      }
      v19 = *(_DWORD *)(*(_DWORD *)(a2 + 100) + 16);
      if ( v19 )
      {
        for ( i = *(_DWORD *)v19; i; i = *(_DWORD *)i )
        {
          v28 = *(_DWORD *)(i + 8);
          if ( v28 && *(_BYTE *)v28 )
          {
            v29 = *(const char **)(i + 12);
            if ( !v29 )
              v29 = "";
            std::string::string(&v44, v28, &v42);
            v21 = std::string::append((std::string *)&v44, ": ", 2u);
            v45 = *(_DWORD *)v21;
            *(_DWORD *)v21 = &unk_80CF83C;
            v22 = strlen(v29);
            v23 = std::string::append((std::string *)&v45, v29, v22);
            v46 = *(_DWORD *)v23;
            *(_DWORD *)v23 = &unk_80CF83C;
            v24 = *(_DWORD *)(a1 + 28);
            if ( v24 == *(_DWORD *)(a1 + 32) )
            {
              sub_8058720(a1 + 24, (int)&v46);
              v25 = v46;
            }
            else
            {
              v25 = v46;
              if ( v24 )
              {
                *(_DWORD *)v24 = v46;
                v46 = (int)&unk_80CF83C;
                v24 = *(_DWORD *)(a1 + 28);
                v25 = (int)&unk_80CF83C;
              }
              *(_DWORD *)(a1 + 28) = v24 + 4;
            }
            if ( (_DWORD *)(v25 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v25 - 4), 0xFFFFFFFF);
              }
              else
              {
                v36 = *(_DWORD *)(v25 - 4);
                *(_DWORD *)(v25 - 4) = v36 - 1;
              }
              if ( v36 <= 0 )
                std::string::_Rep::_M_destroy(v25 - 12, &v43);
            }
            v26 = v45 - 12;
            if ( (_DWORD *)(v45 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v45 - 4), 0xFFFFFFFF);
              }
              else
              {
                v37 = *(_DWORD *)(v45 - 4);
                *(_DWORD *)(v45 - 4) = v37 - 1;
              }
              if ( v37 <= 0 )
                std::string::_Rep::_M_destroy(v26, &v46);
            }
            v27 = v44 - 12;
            if ( (_DWORD *)(v44 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v35 = _InterlockedExchangeAdd((volatile signed __int32 *)(v44 - 4), 0xFFFFFFFF);
              }
              else
              {
                v35 = *(_DWORD *)(v44 - 4);
                *(_DWORD *)(v44 - 4) = v35 - 1;
              }
              if ( v35 <= 0 )
                std::string::_Rep::_M_destroy(v27, &v46);
            }
          }
        }
      }
    }
  }
  return a1;
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CDA0: using guessed type int __cdecl evbuffer_pullup(_DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D1F0: using guessed type int __cdecl evhttp_request_get_input_buffer(_DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF850: using guessed type int dword_80CF850;

//----- (0804FB50) --------------------------------------------------------
pthread_mutex_t *__usercall sub_804FB50@<eax>(int a1@<edi>, pthread_mutex_t *mutex, int a3, int a4)
{
  int v4; // eax@1
  int v5; // esi@2
  int i; // ebx@3
  int v7; // eax@4
  int v8; // edx@4
  int v9; // eax@9
  int v10; // eax@10
  int v11; // edx@10
  int v12; // eax@10
  int v13; // eax@12
  int v14; // eax@14
  int v15; // eax@16
  int v16; // edx@16
  int v17; // eax@16
  int v18; // eax@16
  int v19; // edi@20
  int v20; // eax@20
  int v21; // eax@23
  void *v22; // esi@26
  void *v23; // ebx@26
  int v24; // eax@27
  int v25; // edx@27
  void *v26; // esi@32
  void *v27; // ebx@32
  int v28; // eax@33
  int v29; // edx@33
  int v30; // eax@38
  int v31; // edx@38
  int v32; // eax@39
  int v33; // eax@46
  int v34; // eax@49
  void *v35; // esi@52
  void *v36; // ebx@52
  int v37; // eax@53
  int v38; // edx@53
  void *v39; // esi@58
  void *v40; // ebx@58
  int v41; // eax@59
  int v42; // edx@59
  int v43; // eax@64
  int v44; // edx@64
  int v45; // eax@65
  int v46; // eax@70
  bool v47; // zf@70
  void *v48; // ebx@72
  void *v49; // esi@72
  int v50; // eax@73
  bool v51; // zf@73
  int v52; // eax@80
  bool v53; // zf@80
  int v54; // eax@86
  int v55; // eax@89
  void *v56; // esi@92
  void *v57; // ebx@92
  int v58; // eax@93
  int v59; // edx@93
  void *v60; // esi@98
  void *v61; // ebx@98
  int v62; // eax@99
  int v63; // edx@99
  int v64; // eax@104
  int v65; // edx@104
  int v66; // eax@105
  int v67; // edi@112
  int v68; // eax@112
  int v69; // eax@115
  void *v70; // esi@118
  void *v71; // ebx@118
  int v72; // eax@119
  int v73; // edx@119
  void *v74; // esi@124
  void *v75; // ebx@124
  int v76; // eax@125
  int v77; // edx@125
  int v78; // eax@130
  int v79; // edx@130
  int v80; // eax@131
  int v81; // eax@136
  bool v82; // zf@136
  void *v83; // ebx@138
  void *v84; // esi@138
  int v85; // eax@139
  bool v86; // zf@139
  int v87; // edx@146
  unsigned int v88; // eax@146
  int v89; // edx@148
  pthread_mutex_t *result; // eax@150
  int v91; // edx@153
  unsigned int v92; // eax@153
  int j; // edx@154
  int v94; // ecx@155
  signed __int32 v95; // eax@168
  signed __int32 v96; // eax@172
  signed __int32 v97; // eax@176
  signed __int32 v98; // eax@180
  signed __int32 v99; // eax@184
  signed __int32 v100; // eax@188
  signed __int32 v101; // eax@192
  signed __int32 v102; // eax@196
  signed __int32 v103; // ecx@199
  signed __int32 v104; // ecx@200
  signed __int32 v105; // ecx@201
  signed __int32 v106; // ecx@202
  signed __int32 v107; // ecx@203
  signed __int32 v108; // ecx@204
  signed __int32 v109; // ecx@205
  signed __int32 v110; // ecx@206
  signed __int32 v111; // ebx@208
  signed __int32 v112; // eax@212
  signed __int32 v113; // ebx@216
  signed __int32 v114; // ebx@218
  signed __int32 v115; // eax@222
  signed __int32 v116; // eax@226
  signed __int32 v117; // ebx@230
  signed __int32 v118; // eax@235
  signed __int32 v119; // ebx@239
  signed __int32 v120; // ebx@241
  signed __int32 v121; // ebx@243
  signed __int32 v122; // ebx@246
  int v123; // [sp+8h] [bp-F0h]@0
  int v124; // [sp+10h] [bp-E8h]@0
  int v125; // [sp+10h] [bp-E8h]@19
  int v126; // [sp+10h] [bp-E8h]@111
  int v127; // [sp+14h] [bp-E4h]@0
  int v128; // [sp+14h] [bp-E4h]@19
  int v129; // [sp+14h] [bp-E4h]@111
  int v130; // [sp+18h] [bp-E0h]@0
  int v131; // [sp+18h] [bp-E0h]@19
  int v132; // [sp+18h] [bp-E0h]@111
  int v133; // [sp+1Ch] [bp-DCh]@0
  int v134; // [sp+1Ch] [bp-DCh]@19
  int v135; // [sp+1Ch] [bp-DCh]@111
  int v136; // [sp+20h] [bp-D8h]@0
  int v137; // [sp+20h] [bp-D8h]@18
  int v138; // [sp+20h] [bp-D8h]@110
  int v139; // [sp+28h] [bp-D0h]@0
  int v140; // [sp+28h] [bp-D0h]@19
  int v141; // [sp+28h] [bp-D0h]@111
  int v142; // [sp+2Ch] [bp-CCh]@0
  int v143; // [sp+2Ch] [bp-CCh]@19
  int v144; // [sp+2Ch] [bp-CCh]@111
  int v145; // [sp+30h] [bp-C8h]@0
  int v146; // [sp+30h] [bp-C8h]@18
  int v147; // [sp+30h] [bp-C8h]@110
  int v148; // [sp+34h] [bp-C4h]@0
  int v149; // [sp+34h] [bp-C4h]@19
  int v150; // [sp+34h] [bp-C4h]@111
  char v151; // [sp+38h] [bp-C0h]@16
  char v152; // [sp+43h] [bp-B5h]@170
  pthread_mutex_t *v153; // [sp+44h] [bp-B4h]@7
  char v154; // [sp+48h] [bp-B0h]@7
  void *v155; // [sp+4Ch] [bp-ACh]@10
  void *v156; // [sp+50h] [bp-A8h]@10
  int v157; // [sp+54h] [bp-A4h]@10
  int v158; // [sp+58h] [bp-A0h]@10
  char v159; // [sp+5Ch] [bp-9Ch]@12
  char v160; // [sp+5Dh] [bp-9Bh]@12
  char v161; // [sp+5Eh] [bp-9Ah]@12
  int v162; // [sp+60h] [bp-98h]@12
  int v163; // [sp+64h] [bp-94h]@12
  int v164; // [sp+68h] [bp-90h]@12
  int v165; // [sp+6Ch] [bp-8Ch]@12
  int v166; // [sp+70h] [bp-88h]@12
  int v167; // [sp+74h] [bp-84h]@12
  int v168; // [sp+78h] [bp-80h]@12
  int v169; // [sp+7Ch] [bp-7Ch]@12
  int v170; // [sp+80h] [bp-78h]@12
  int v171; // [sp+84h] [bp-74h]@13
  int v172; // [sp+88h] [bp-70h]@16
  int v173; // [sp+8Ch] [bp-6Ch]@12
  int v174; // [sp+90h] [bp-68h]@13
  int v175; // [sp+94h] [bp-64h]@14
  void *v176; // [sp+98h] [bp-60h]@16
  void *v177; // [sp+9Ch] [bp-5Ch]@16
  int v178; // [sp+A0h] [bp-58h]@16
  int v179; // [sp+A4h] [bp-54h]@16
  char v180; // [sp+A8h] [bp-50h]@16
  char v181; // [sp+A9h] [bp-4Fh]@16
  char v182; // [sp+AAh] [bp-4Eh]@16
  int v183; // [sp+ACh] [bp-4Ch]@16
  int v184; // [sp+B0h] [bp-48h]@16
  int v185; // [sp+B4h] [bp-44h]@16
  int v186; // [sp+B8h] [bp-40h]@16
  int v187; // [sp+BCh] [bp-3Ch]@16
  int v188; // [sp+C0h] [bp-38h]@16
  int v189; // [sp+C4h] [bp-34h]@16
  int v190; // [sp+C8h] [bp-30h]@16
  int v191; // [sp+CCh] [bp-2Ch]@16
  int v192; // [sp+D0h] [bp-28h]@16
  int v193; // [sp+D4h] [bp-24h]@16
  int v194; // [sp+D8h] [bp-20h]@16
  int v195; // [sp+DCh] [bp-1Ch]@16

  v4 = *(_DWORD *)a3;
  if ( *(_BYTE *)(*(_DWORD *)(*(_DWORD *)a3 + 20) + 41) )
  {
    a1 = *(_DWORD *)(v4 + 12);
    v5 = *(_DWORD *)(v4 + 8);
    if ( a1 != v5 )
    {
      for ( i = v5 + 4; a1 != i; i += 4 )
      {
        v7 = v5 + 4 * (rand() % (((i - v5) >> 2) + 1));
        v8 = *(_DWORD *)i;
        *(_DWORD *)i = 0;
        if ( i != v7 )
        {
          *(_DWORD *)i = *(_DWORD *)v7;
          *(_DWORD *)v7 = 0;
        }
        *(_DWORD *)v7 = v8;
      }
    }
  }
  else
  {
    v91 = *(_DWORD *)(v4 + 12);
    v92 = *(_DWORD *)(v4 + 8);
    if ( v91 != v92 )
    {
      for ( j = v91 - 4; v92 < j; j -= 4 )
      {
        v94 = *(_DWORD *)v92;
        *(_DWORD *)v92 = 0;
        if ( v92 != j )
        {
          *(_DWORD *)v92 = *(_DWORD *)j;
          *(_DWORD *)j = 0;
        }
        *(_DWORD *)j = v94;
        v92 += 4;
      }
    }
  }
  v153 = mutex;
  v154 = 0;
  if ( !mutex )
  {
    v43 = std::__throw_system_error(1);
    goto LABEL_234;
  }
  if ( &_pthread_key_create )
  {
    v9 = pthread_mutex_lock(mutex);
    if ( v9 )
    {
      v64 = std::__throw_system_error(v9);
      goto LABEL_241;
    }
  }
  v154 = 1;
  v10 = *(_DWORD *)a3;
  v157 = 0;
  v155 = *(void **)(v10 + 8);
  *(_DWORD *)(v10 + 8) = 0;
  v156 = *(void **)(v10 + 12);
  *(_DWORD *)(v10 + 12) = 0;
  v11 = v157;
  v157 = *(_DWORD *)(v10 + 16);
  *(_DWORD *)(v10 + 16) = v11;
  v12 = *(_DWORD *)(v10 + 20);
  v158 = v12;
  if ( v12 )
    _InterlockedIncrement((volatile signed __int32 *)(v12 + 4));
  v159 = 0;
  v160 = 0;
  v161 = 0;
  v162 = 0;
  v163 = 0;
  v164 = 0;
  v165 = 0;
  v166 = 0;
  v167 = 0;
  v168 = 0;
  v169 = 0;
  v170 = 0;
  v173 = 0;
  v13 = *(_DWORD *)(a4 + 8);
  if ( v13 )
  {
    v174 = *(_DWORD *)(a4 + 12);
    v173 = v13;
    ((void (__cdecl *)(int *, int, signed int))v13)(&v171, a4, 2);
  }
  v14 = *(_DWORD *)(*(_DWORD *)a3 + 20);
  v175 = v14;
  if ( v14 )
    _InterlockedIncrement((volatile signed __int32 *)(v14 + 4));
  v176 = v155;
  v155 = 0;
  v177 = v156;
  v156 = 0;
  v178 = v157;
  v157 = 0;
  v179 = v158;
  v158 = 0;
  v180 = v159;
  v181 = v160;
  v182 = v161;
  v183 = v162;
  v184 = v163;
  v185 = v164;
  v164 = 0;
  v186 = v165;
  v165 = 0;
  v187 = v166;
  v166 = 0;
  v188 = v167;
  v167 = 0;
  v189 = v168;
  v168 = 0;
  v190 = v169;
  v169 = 0;
  v191 = v170;
  v15 = v171;
  v16 = v172;
  v171 = v192;
  v172 = v193;
  v192 = v15;
  v193 = v16;
  v17 = v173;
  v173 = 0;
  v194 = v17;
  v18 = v174;
  v174 = v195;
  v195 = v18;
  LOBYTE(v123) = 0;
  sub_8059B00((int)&v151, (int)&mutex[1], v123, (int)&v175);
  if ( v194 )
    ((void (__cdecl *)(int *, int *, signed int))v194)(&v192, &v192, 3);
  v137 = v189;
  v146 = v188;
  if ( v189 != v188 )
  {
    v143 = v188 + 28;
    v140 = v188 + 48;
    v149 = v188;
    v125 = v188 + 60;
    v128 = v188 + 56;
    v131 = v188 + 20;
    v134 = v188 + 8;
    do
    {
      v19 = v149 - v146;
      v20 = *(_DWORD *)(v149 - v146 + v125);
      if ( v20 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v20 + 4));
        if ( !v20 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v21 = *(_DWORD *)(v19 + v128);
      if ( v21 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v21 + 4));
        if ( !v21 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v22 = *(void **)v140;
      v23 = *(void **)(v140 - 4);
      if ( *(void **)v140 != v23 )
      {
        do
        {
          v24 = *(_DWORD *)v23;
          v25 = *(_DWORD *)v23 - 12;
          if ( (_DWORD *)v25 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v102 = _InterlockedExchangeAdd((volatile signed __int32 *)(v24 - 4), 0xFFFFFFFF);
            }
            else
            {
              v106 = *(_DWORD *)(v24 - 4);
              *(_DWORD *)(v24 - 4) = v106 - 1;
              v102 = v106;
            }
            if ( v102 <= 0 )
              std::string::_Rep::_M_destroy(v25, &v152);
          }
          v23 = (char *)v23 + 4;
        }
        while ( v22 != v23 );
        v22 = *(void **)(v149 + 44);
      }
      if ( v22 )
        operator delete(v22);
      v26 = *(void **)v143;
      v27 = *(void **)(v143 - 4);
      if ( *(void **)v143 != v27 )
      {
        do
        {
          v28 = *(_DWORD *)v27;
          v29 = *(_DWORD *)v27 - 12;
          if ( (_DWORD *)v29 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v98 = _InterlockedExchangeAdd((volatile signed __int32 *)(v28 - 4), 0xFFFFFFFF);
            }
            else
            {
              v108 = *(_DWORD *)(v28 - 4);
              *(_DWORD *)(v28 - 4) = v108 - 1;
              v98 = v108;
            }
            if ( v98 <= 0 )
              std::string::_Rep::_M_destroy(v29, &v152);
          }
          v27 = (char *)v27 + 4;
        }
        while ( v26 != v27 );
        v26 = *(void **)(v149 + 24);
      }
      if ( v26 )
        operator delete(v26);
      v30 = *(_DWORD *)(v19 + v131);
      v31 = v30 - 12;
      if ( (_DWORD *)(v30 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v112 = _InterlockedExchangeAdd((volatile signed __int32 *)(v30 - 4), 0xFFFFFFFF);
        }
        else
        {
          v113 = *(_DWORD *)(v30 - 4);
          *(_DWORD *)(v30 - 4) = v113 - 1;
          v112 = v113;
        }
        if ( v112 <= 0 )
          std::string::_Rep::_M_destroy(v31, &v152);
      }
      v32 = *(_DWORD *)(v19 + v134);
      if ( (_DWORD *)(v32 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v111 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
        }
        else
        {
          v111 = *(_DWORD *)(v32 - 4);
          *(_DWORD *)(v32 - 4) = v111 - 1;
        }
        if ( v111 <= 0 )
          std::string::_Rep::_M_destroy(v32 - 12, &v152);
      }
      v149 += 64;
      v143 += 64;
      v140 += 64;
    }
    while ( v137 != v149 );
    v137 = v188;
  }
  if ( v137 )
    operator delete((void *)v137);
  v136 = v186;
  v145 = v185;
  if ( v186 != v185 )
  {
    v142 = v185 + 28;
    v139 = v185 + 48;
    v148 = v185;
    v124 = v185 + 60;
    v127 = v185 + 56;
    v130 = v185 + 20;
    v133 = v185 + 8;
    do
    {
      a1 = v148 - v145;
      v33 = *(_DWORD *)(v148 - v145 + v124);
      if ( v33 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v33 + 4));
        if ( !v33 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v34 = *(_DWORD *)(a1 + v127);
      if ( v34 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v34 + 4));
        if ( !v34 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v35 = *(void **)v139;
      v36 = *(void **)(v139 - 4);
      if ( *(void **)v139 != v36 )
      {
        do
        {
          v37 = *(_DWORD *)v36;
          v38 = *(_DWORD *)v36 - 12;
          if ( (_DWORD *)v38 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v97 = _InterlockedExchangeAdd((volatile signed __int32 *)(v37 - 4), 0xFFFFFFFF);
            }
            else
            {
              v109 = *(_DWORD *)(v37 - 4);
              *(_DWORD *)(v37 - 4) = v109 - 1;
              v97 = v109;
            }
            if ( v97 <= 0 )
              std::string::_Rep::_M_destroy(v38, &v152);
          }
          v36 = (char *)v36 + 4;
        }
        while ( v35 != v36 );
        v35 = *(void **)(v148 + 44);
      }
      if ( v35 )
        operator delete(v35);
      v39 = *(void **)v142;
      v40 = *(void **)(v142 - 4);
      if ( *(void **)v142 != v40 )
      {
        do
        {
          v41 = *(_DWORD *)v40;
          v42 = *(_DWORD *)v40 - 12;
          if ( (_DWORD *)v42 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v95 = _InterlockedExchangeAdd((volatile signed __int32 *)(v41 - 4), 0xFFFFFFFF);
            }
            else
            {
              v110 = *(_DWORD *)(v41 - 4);
              *(_DWORD *)(v41 - 4) = v110 - 1;
              v95 = v110;
            }
            if ( v95 <= 0 )
              std::string::_Rep::_M_destroy(v42, &v152);
          }
          v40 = (char *)v40 + 4;
        }
        while ( v39 != v40 );
        v39 = *(void **)(v148 + 24);
      }
      if ( v39 )
        operator delete(v39);
      v43 = *(_DWORD *)(a1 + v130);
      v44 = v43 - 12;
      if ( (_DWORD *)(v43 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
LABEL_234:
        if ( &_pthread_key_create )
        {
          v118 = _InterlockedExchangeAdd((volatile signed __int32 *)(v43 - 4), 0xFFFFFFFF);
        }
        else
        {
          v119 = *(_DWORD *)(v43 - 4);
          *(_DWORD *)(v43 - 4) = v119 - 1;
          v118 = v119;
        }
        if ( v118 <= 0 )
          std::string::_Rep::_M_destroy(v44, &v152);
      }
      v45 = *(_DWORD *)(a1 + v133);
      if ( (_DWORD *)(v45 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v121 = _InterlockedExchangeAdd((volatile signed __int32 *)(v45 - 4), 0xFFFFFFFF);
        }
        else
        {
          v121 = *(_DWORD *)(v45 - 4);
          *(_DWORD *)(v45 - 4) = v121 - 1;
        }
        if ( v121 <= 0 )
          std::string::_Rep::_M_destroy(v45 - 12, &v152);
      }
      v148 += 64;
      v142 += 64;
      v139 += 64;
    }
    while ( v136 != v148 );
    v136 = v185;
  }
  if ( v136 )
    operator delete((void *)v136);
  v46 = v179;
  v47 = v179 == 0;
  if ( v179 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v179 + 4));
    if ( v47 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v46 + 4))(v46);
  }
  v48 = v177;
  v49 = v176;
  if ( v177 != v176 )
  {
    do
    {
      v50 = *(_DWORD *)v49;
      v51 = *(_DWORD *)v49 == 0;
      if ( *(_DWORD *)v49 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v50 + 4));
        if ( v51 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v50 + 4))(v50);
      }
      v49 = (char *)v49 + 4;
    }
    while ( v48 != v49 );
    v48 = v176;
  }
  if ( v48 )
    operator delete(v48);
  v52 = v175;
  v53 = v175 == 0;
  if ( v175 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v175 + 4));
    if ( v53 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v52 + 4))(v52);
  }
  if ( v173 )
    ((void (__cdecl *)(int *, int *, signed int))v173)(&v171, &v171, 3);
  v136 = v168;
  v145 = v167;
  if ( v168 != v167 )
  {
    v139 = v167 + 28;
    v142 = v167 + 48;
    v148 = v167;
    v124 = v167 + 60;
    v127 = v167 + 56;
    v130 = v167 + 20;
    v133 = v167 + 8;
    do
    {
      a1 = v148 - v145;
      v54 = *(_DWORD *)(v148 - v145 + v124);
      if ( v54 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v54 + 4));
        if ( !v54 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v55 = *(_DWORD *)(a1 + v127);
      if ( v55 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v55 + 4));
        if ( !v55 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v56 = *(void **)v142;
      v57 = *(void **)(v142 - 4);
      if ( *(void **)v142 != v57 )
      {
        do
        {
          v58 = *(_DWORD *)v57;
          v59 = *(_DWORD *)v57 - 12;
          if ( (_DWORD *)v59 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v96 = _InterlockedExchangeAdd((volatile signed __int32 *)(v58 - 4), 0xFFFFFFFF);
            }
            else
            {
              v103 = *(_DWORD *)(v58 - 4);
              *(_DWORD *)(v58 - 4) = v103 - 1;
              v96 = v103;
            }
            if ( v96 <= 0 )
              std::string::_Rep::_M_destroy(v59, &v175);
          }
          v57 = (char *)v57 + 4;
        }
        while ( v56 != v57 );
        v56 = *(void **)(v148 + 44);
      }
      if ( v56 )
        operator delete(v56);
      v60 = *(void **)v139;
      v61 = *(void **)(v139 - 4);
      if ( *(void **)v139 != v61 )
      {
        do
        {
          v62 = *(_DWORD *)v61;
          v63 = *(_DWORD *)v61 - 12;
          if ( (_DWORD *)v63 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v99 = _InterlockedExchangeAdd((volatile signed __int32 *)(v62 - 4), 0xFFFFFFFF);
            }
            else
            {
              v105 = *(_DWORD *)(v62 - 4);
              *(_DWORD *)(v62 - 4) = v105 - 1;
              v99 = v105;
            }
            if ( v99 <= 0 )
              std::string::_Rep::_M_destroy(v63, &v175);
          }
          v61 = (char *)v61 + 4;
        }
        while ( v60 != v61 );
        v60 = *(void **)(v148 + 24);
      }
      if ( v60 )
        operator delete(v60);
      v64 = *(_DWORD *)(a1 + v130);
      v65 = v64 - 12;
      if ( (_DWORD *)(v64 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v116 = _InterlockedExchangeAdd((volatile signed __int32 *)(v64 - 4), 0xFFFFFFFF);
        }
        else
        {
LABEL_241:
          v120 = *(_DWORD *)(v64 - 4);
          *(_DWORD *)(v64 - 4) = v120 - 1;
          v116 = v120;
        }
        if ( v116 <= 0 )
          std::string::_Rep::_M_destroy(v65, &v175);
      }
      v66 = *(_DWORD *)(a1 + v133);
      if ( (_DWORD *)(v66 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v114 = _InterlockedExchangeAdd((volatile signed __int32 *)(v66 - 4), 0xFFFFFFFF);
        }
        else
        {
          v114 = *(_DWORD *)(v66 - 4);
          *(_DWORD *)(v66 - 4) = v114 - 1;
        }
        if ( v114 <= 0 )
          std::string::_Rep::_M_destroy(v66 - 12, &v175);
      }
      v148 += 64;
      v139 += 64;
      v142 += 64;
    }
    while ( v136 != v148 );
    v136 = v167;
  }
  if ( v136 )
    operator delete((void *)v136);
  v138 = v165;
  v147 = v164;
  if ( v165 != v164 )
  {
    v144 = v164 + 28;
    v141 = v164 + 48;
    v150 = v164;
    v126 = v164 + 60;
    v129 = v164 + 56;
    v132 = v164 + 20;
    v135 = v164 + 8;
    do
    {
      v67 = v150 - v147;
      v68 = *(_DWORD *)(v150 - v147 + v126);
      if ( v68 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v68 + 4));
        if ( !v68 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v69 = *(_DWORD *)(v67 + v129);
      if ( v69 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v69 + 4));
        if ( !v69 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v70 = *(void **)v141;
      v71 = *(void **)(v141 - 4);
      if ( *(void **)v141 != v71 )
      {
        do
        {
          v72 = *(_DWORD *)v71;
          v73 = *(_DWORD *)v71 - 12;
          if ( (_DWORD *)v73 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v100 = _InterlockedExchangeAdd((volatile signed __int32 *)(v72 - 4), 0xFFFFFFFF);
            }
            else
            {
              v104 = *(_DWORD *)(v72 - 4);
              *(_DWORD *)(v72 - 4) = v104 - 1;
              v100 = v104;
            }
            if ( v100 <= 0 )
              std::string::_Rep::_M_destroy(v73, &v175);
          }
          v71 = (char *)v71 + 4;
        }
        while ( v70 != v71 );
        v70 = *(void **)(v150 + 44);
      }
      if ( v70 )
        operator delete(v70);
      v74 = *(void **)v144;
      v75 = *(void **)(v144 - 4);
      if ( *(void **)v144 != v75 )
      {
        do
        {
          v76 = *(_DWORD *)v75;
          v77 = *(_DWORD *)v75 - 12;
          if ( (_DWORD *)v77 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v101 = _InterlockedExchangeAdd((volatile signed __int32 *)(v76 - 4), 0xFFFFFFFF);
            }
            else
            {
              v107 = *(_DWORD *)(v76 - 4);
              *(_DWORD *)(v76 - 4) = v107 - 1;
              v101 = v107;
            }
            if ( v101 <= 0 )
              std::string::_Rep::_M_destroy(v77, &v175);
          }
          v75 = (char *)v75 + 4;
        }
        while ( v74 != v75 );
        v74 = *(void **)(v150 + 24);
      }
      if ( v74 )
        operator delete(v74);
      v78 = *(_DWORD *)(v67 + v132);
      v79 = v78 - 12;
      if ( (_DWORD *)(v78 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v115 = _InterlockedExchangeAdd((volatile signed __int32 *)(v78 - 4), 0xFFFFFFFF);
        }
        else
        {
          v122 = *(_DWORD *)(v78 - 4);
          *(_DWORD *)(v78 - 4) = v122 - 1;
          v115 = v122;
        }
        if ( v115 <= 0 )
          std::string::_Rep::_M_destroy(v79, &v175);
      }
      v80 = *(_DWORD *)(v67 + v135);
      if ( (_DWORD *)(v80 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v117 = _InterlockedExchangeAdd((volatile signed __int32 *)(v80 - 4), 0xFFFFFFFF);
        }
        else
        {
          v117 = *(_DWORD *)(v80 - 4);
          *(_DWORD *)(v80 - 4) = v117 - 1;
        }
        if ( v117 <= 0 )
          std::string::_Rep::_M_destroy(v80 - 12, &v175);
      }
      v150 += 64;
      v144 += 64;
      v141 += 64;
    }
    while ( v138 != v150 );
    v138 = v164;
  }
  if ( v138 )
    operator delete((void *)v138);
  v81 = v158;
  v82 = v158 == 0;
  if ( v158 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v158 + 4));
    if ( v82 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v81 + 4))(v81);
  }
  v83 = v156;
  v84 = v155;
  if ( v156 != v155 )
  {
    do
    {
      v85 = *(_DWORD *)v84;
      v86 = *(_DWORD *)v84 == 0;
      if ( *(_DWORD *)v84 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v85 + 4));
        if ( v86 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v85 + 4))(v85);
      }
      v84 = (char *)v84 + 4;
    }
    while ( v83 != v84 );
    v83 = v155;
  }
  if ( v83 )
    operator delete(v83);
  v87 = *(_DWORD *)a3;
  v88 = mutex[2].__count;
  if ( v88 == mutex[2].__owner )
  {
    result = (pthread_mutex_t *)sub_80584E0((int)&mutex[2], v87 + 20);
  }
  else
  {
    if ( v88 )
    {
      v89 = *(_DWORD *)(v87 + 20);
      *(_DWORD *)v88 = v89;
      if ( v89 )
      {
        _InterlockedIncrement((volatile signed __int32 *)(v89 + 4));
        v88 = mutex[2].__count;
      }
      else
      {
        v88 = mutex[2].__count;
      }
    }
    result = (pthread_mutex_t *)(v88 + 4);
    mutex[2].__count = (unsigned int)result;
  }
  if ( v154 )
  {
    result = v153;
    if ( v153 )
    {
      if ( &_pthread_key_create )
        result = (pthread_mutex_t *)pthread_mutex_unlock(v153);
    }
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08050BF0) --------------------------------------------------------
char __usercall sub_8050BF0@<al>(int a1@<edi>, std::ios_base *a2@<esi>, pthread_mutex_t *mutex, int a4)
{
  int v4; // eax@3
  char v5; // di@5
  pthread_mutex_t *v7; // ebx@11
  int v8; // eax@13
  int v9; // edi@14
  signed int v10; // ecx@14
  unsigned int v11; // esi@15
  int v12; // edi@16
  int v13; // ecx@17
  unsigned int v14; // edx@19
  int *v15; // edi@19
  unsigned int v16; // eax@20
  int v17; // edi@20
  int v18; // ebx@22
  int v19; // eax@23
  int v20; // eax@28
  __int64 v21; // rcx@31
  unsigned int v22; // esi@34
  bool v23; // zf@37
  int v24; // edx@46
  int v25; // ecx@48
  unsigned int v26; // eax@49
  int v27; // eax@53
  int v28; // edx@53
  int v29; // edi@55
  int v30; // edx@56
  bool v31; // zf@56
  int v32; // eax@61
  int v33; // eax@68
  bool v34; // zf@68
  int v35; // esi@78
  int v36; // eax@78
  int v37; // eax@78
  int v38; // eax@79
  int v39; // ebx@85
  int v40; // esi@87
  int v41; // [sp+0h] [bp-120h]@34
  int v42; // [sp+4h] [bp-11Ch]@34
  __int64 v43; // [sp+8h] [bp-118h]@34
  int v44; // [sp+10h] [bp-110h]@34
  unsigned int v45; // [sp+14h] [bp-10Ch]@34
  int v46; // [sp+18h] [bp-108h]@15
  unsigned __int64 v47; // [sp+18h] [bp-108h]@41
  __int64 v48; // [sp+28h] [bp-F8h]@74
  int v49; // [sp+34h] [bp-ECh]@16
  char v50; // [sp+47h] [bp-D9h]@86
  int v51; // [sp+48h] [bp-D8h]@78
  pthread_mutex_t *v52; // [sp+4Ch] [bp-D4h]@11
  char v53; // [sp+50h] [bp-D0h]@11
  int v54; // [sp+54h] [bp-CCh]@46
  int v55; // [sp+58h] [bp-C8h]@78
  int v56; // [sp+5Ch] [bp-C4h]@78
  int v57; // [sp+60h] [bp-C0h]@78
  int v58; // [sp+64h] [bp-BCh]@78
  int v59; // [sp+68h] [bp-B8h]@78
  int v60; // [sp+6Ch] [bp-B4h]@78
  int v61; // [sp+70h] [bp-B0h]@78
  char v62; // [sp+74h] [bp-ACh]@78
  int v63; // [sp+78h] [bp-A8h]@78
  int v64; // [sp+7Ch] [bp-A4h]@78
  int v65; // [sp+80h] [bp-A0h]@78
  int v66; // [sp+D0h] [bp-50h]@83
  pthread_mutex_t *v67; // [sp+E8h] [bp-38h]@11
  std::ios_base *v68; // [sp+ECh] [bp-34h]@11
  int v69; // [sp+F0h] [bp-30h]@11
  int *v70; // [sp+F4h] [bp-2Ch]@11
  int v71; // [sp+F8h] [bp-28h]@4
  int v72; // [sp+FCh] [bp-24h]@78
  int v73; // [sp+100h] [bp-20h]@78
  int v74; // [sp+104h] [bp-1Ch]@4
  int savedregs; // [sp+120h] [bp+0h]@11
  pthread_mutex_t *mutexa; // [sp+128h] [bp+8h]@22

  if ( mutex )
  {
    a2 = (std::ios_base *)&_pthread_key_create;
    if ( !&_pthread_key_create || (v4 = pthread_mutex_lock(mutex)) == 0 )
    {
      v71 = sub_8059D00((int)&v74, (int)&mutex[1], (int *)a4);
      if ( v74 )
        v5 = v74 + 8;
      else
        v5 = 0;
      if ( &_pthread_key_create )
        pthread_mutex_unlock(mutex);
      return v5;
    }
    std::__throw_system_error(v4);
  }
  std::__throw_system_error(1);
  v70 = &savedregs;
  v69 = a1;
  v68 = a2;
  v67 = mutex;
  v7 = mutex;
  v52 = mutex;
  v53 = 0;
  if ( !mutex )
  {
    v39 = std::__throw_system_error(1);
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf(a1);
    v54 = dword_80CF674;
    *(int *)((char *)&v54 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v65 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base(a2);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v50);
    goto LABEL_82;
  }
  if ( &_pthread_key_create )
  {
    v8 = pthread_mutex_lock(mutex);
    if ( v8 )
    {
      v39 = std::__throw_system_error(v8);
      sub_8056F10(v54);
      goto LABEL_82;
    }
  }
  v53 = 1;
  v9 = mutex[2].__lock;
  v10 = (signed int)(mutex[2].__count - v9) >> 2;
  if ( !v10 )
  {
    BYTE4(v21) = 0;
    goto LABEL_71;
  }
  v46 = (int)&mutex[1].__lock;
  v11 = 0;
  while ( 1 )
  {
    v14 = (v7[2].__kind + 1) % (unsigned int)v10;
    v7[2].__kind = v14;
    v15 = (int *)(v9 + 4 * v14);
    sub_8059D00((int)&v49, v46, v15);
    if ( v49 )
      break;
    v16 = v7[2].__count;
    v17 = (int)(v15 + 1);
    if ( v16 != v17 && (signed int)(v16 - v17) >> 2 > 0 )
    {
      mutexa = v7;
      v18 = (signed int)(v16 - v17) >> 2;
      do
      {
        v19 = *(_DWORD *)(v17 - 4);
        if ( v19 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v19 + 4));
          if ( !v19 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        *(_DWORD *)(v17 - 4) = *(_DWORD *)v17;
        *(_DWORD *)v17 = 0;
        v17 += 4;
        --v18;
      }
      while ( v18 );
      v7 = mutexa;
      v16 = mutexa[2].__count;
    }
    v13 = v16 - 4;
    v7[2].__count = v16 - 4;
    v20 = *(_DWORD *)(v16 - 4);
    if ( !v20 )
      goto LABEL_18;
    _InterlockedDecrement((volatile signed __int32 *)(v20 + 4));
    if ( v20 )
    {
LABEL_17:
      v13 = v7[2].__count;
LABEL_18:
      ++v11;
      v9 = v7[2].__lock;
      v10 = (v13 - v9) >> 2;
      if ( v11 >= v10 )
        goto LABEL_31;
    }
    else
    {
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      ++v11;
      v9 = v7[2].__lock;
      v10 = (signed int)(v7[2].__count - v9) >> 2;
      if ( v11 >= v10 )
        goto LABEL_31;
    }
  }
  v12 = *(_DWORD *)(v49 + 12);
  if ( v12 == *(_DWORD *)(v49 + 8) )
    goto LABEL_17;
  v42 = *(_DWORD *)(v49 + 12);
  v43 = 0LL;
  v22 = 0;
  HIDWORD(v21) = 0;
  v41 = v12 - 4;
  v44 = v49;
  v45 = 0;
  while ( 1 )
  {
    v24 = *(_DWORD *)(v41 + v12 - v42);
    v54 = v24;
    if ( v24 )
    {
      _InterlockedIncrement((volatile signed __int32 *)(v24 + 4));
      v24 = v54;
    }
    v25 = *(_DWORD *)(v24 + 40);
    if ( !v25 )
      break;
    v26 = *(_DWORD *)(v25 + 4);
    LODWORD(v21) = *(_DWORD *)(v25 + 8);
    HIDWORD(v21) = v26 | v21;
    if ( !(v26 | (unsigned int)v21) )
      break;
    HIDWORD(v21) = v43 | HIDWORD(v43);
    if ( v43 )
    {
      v47 = __PAIR__(v21, v26);
    }
    else
    {
      std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v48);
      v43 = v48;
      v24 = v54;
      v21 = *(_QWORD *)(*(_DWORD *)(v54 + 40) + 4);
      v47 = *(_QWORD *)(*(_DWORD *)(v54 + 40) + 4);
    }
    if ( SHIDWORD(v47) < SHIDWORD(v43) || SHIDWORD(v47) <= SHIDWORD(v43) && (unsigned int)v47 <= (unsigned int)v43 )
      break;
    v23 = (v22 | v45) == 0;
    if ( v22 | v45 )
    {
      v23 = HIDWORD(v47) == v45;
      if ( SHIDWORD(v47) >= (signed int)v45 )
      {
        if ( SHIDWORD(v47) > (signed int)v45 || (v23 = (_DWORD)v47 == v22, (unsigned int)v47 > v22) )
          v47 = __PAIR__(v45, v22);
      }
    }
    _InterlockedDecrement((volatile signed __int32 *)(v24 + 4));
    if ( v23 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v24 + 4))(v24);
    v12 -= 4;
    if ( v12 == *(_DWORD *)(v44 + 8) )
    {
      if ( v47 && log_level <= 1 )
      {
        std::ios_base::ios_base((std::ios_base *)&v65);
        v65 = (int)&unk_80CF5C8;
        v69 = 0;
        LOWORD(v70) = 0;
        v71 = 0;
        v72 = 0;
        v73 = 0;
        v74 = 0;
        std::ostream::ostream((std::ostream *)&v54);
        v54 = (int)&unk_80CF5DC;
        v65 = (int)&unk_80CF5F0;
        v55 = (int)&unk_80CF7F0;
        v56 = 0;
        v57 = 0;
        v58 = 0;
        v59 = 0;
        v60 = 0;
        v61 = 0;
        std::locale::locale((std::locale *)&v62);
        v55 = (int)&unk_80CF588;
        v63 = 16;
        v64 = (int)&unk_80CF83C;
        std::basic_ios<char,std::char_traits<char>>::init(&v65, &v55);
        v35 = std::__ostream_insert<char,std::char_traits<char>>(
                &v54,
                &unk_80CF83C,
                std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v35, "validation job retry in: ", 25);
        v36 = std::ostream::_M_insert<double>(
                v35,
                COERCE_UNSIGNED_INT64((long double)(signed __int64)(v47 - v43) / 1000000000.0),
                COERCE_UNSIGNED_INT64((long double)(signed __int64)(v47 - v43) / 1000000000.0) >> 32);
        v37 = std::operator<<<std::char_traits<char>>(v36, " sec");
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v51, v37 + 4);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v54);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v54);
        if ( byte_80CE64C )
        {
          v38 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v51, *(_DWORD *)(v51 - 12));
          std::endl<char,std::char_traits<char>>(v38);
        }
        syslog(7, "%s", v51);
        std::string::_Rep::_M_dispose(v51 - 12, &v54);
      }
LABEL_31:
      BYTE4(v21) = 0;
LABEL_32:
      if ( !v53 )
        return BYTE4(v21);
LABEL_71:
      if ( !v52 || !&_pthread_key_create )
        return BYTE4(v21);
      pthread_mutex_unlock(v52);
      return BYTE4(v21);
    }
    v45 = HIDWORD(v47);
    v22 = v47;
  }
  v27 = v44;
  v28 = *(_DWORD *)(v44 + 12);
  if ( v12 != v28 )
  {
    HIDWORD(v21) = (v28 - v12) >> 2;
    if ( SHIDWORD(v21) > 0 )
    {
      v29 = v12 - 4;
      do
      {
        v30 = *(_DWORD *)v29;
        v31 = *(_DWORD *)v29 == 0;
        if ( *(_DWORD *)v29 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v30 + 4));
          if ( v31 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v30 + 4))(v30);
        }
        *(_DWORD *)v29 = *(_DWORD *)(v29 + 4);
        *(_DWORD *)(v29 + 4) = 0;
        v29 += 4;
        --HIDWORD(v21);
      }
      while ( HIDWORD(v21) );
      v27 = v44;
      v28 = *(_DWORD *)(v44 + 12);
    }
  }
  *(_DWORD *)(v27 + 12) = v28 - 4;
  v32 = *(_DWORD *)(v28 - 4);
  if ( v32 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v32 + 4));
    if ( !v32 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  BYTE4(v21) = v53;
  if ( !v53 )
  {
    v40 = std::__throw_system_error(1);
    std::string::_Rep::_M_dispose(v51 - 12, HIDWORD(v21));
    v39 = v40;
LABEL_82:
    if ( v53 )
      sub_80584A0((int)&v52, v66);
    Unwind_Resume(v39);
  }
  if ( v52 )
  {
    if ( &_pthread_key_create )
      pthread_mutex_unlock(v52);
    v53 = 0;
  }
  sub_80AB5A0(a4, (int)&v54);
  v33 = v54;
  v34 = v54 == 0;
  if ( !v54 )
    goto LABEL_32;
  _InterlockedDecrement((volatile signed __int32 *)(v54 + 4));
  if ( !v34 )
    goto LABEL_32;
  (*(void (__cdecl **)(int))(*(_DWORD *)v33 + 4))(v33);
  if ( v53 )
    goto LABEL_71;
  return BYTE4(v21);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C9B0: using guessed type int __cdecl std::operator<<<std::char_traits<char>>(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D140: using guessed type int __cdecl std::ostream::_M_insert<double>(_DWORD, _DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08051390) --------------------------------------------------------
signed int __usercall sub_8051390@<eax>(int a1@<eax>, int *a2@<edx>)
{
  int v2; // ebx@1
  unsigned int v3; // eax@1
  int v4; // edi@1
  int v5; // eax@1
  int v6; // ecx@1
  int v7; // ebp@2
  int v8; // eax@2
  int v9; // esi@2
  int v10; // edx@4
  int v12; // edx@9
  int v13; // edi@10
  unsigned int v14; // [sp+14h] [bp-28h]@1
  int v15; // [sp+18h] [bp-24h]@2

  v2 = a1;
  v3 = *(_DWORD *)(a1 + 4);
  v14 = v3;
  v4 = *a2 % v3;
  v5 = sub_8059AA0(v2, v4, (int)a2, *a2);
  v6 = v5;
  if ( v5 )
  {
    v7 = *(_DWORD *)v5;
    v15 = *(_DWORD *)v2;
    v8 = 4 * v4 + *(_DWORD *)v2;
    v9 = *(_DWORD *)v7;
    if ( v6 != *(_DWORD *)v8 )
    {
      if ( v9 )
      {
        v10 = *(_DWORD *)(v9 + 80) % v14;
        if ( v4 != v10 )
        {
          *(_DWORD *)(v15 + 4 * v10) = v6;
          v9 = *(_DWORD *)v7;
        }
      }
      goto LABEL_6;
    }
    if ( v9 )
    {
      v12 = *(_DWORD *)(v9 + 80) % v14;
      if ( v4 == v12 )
      {
LABEL_6:
        *(_DWORD *)v6 = v9;
        sub_804E310(v7);
        --*(_DWORD *)(v2 + 12);
        return 1;
      }
      *(_DWORD *)(v15 + 4 * v12) = v6;
      v8 = *(_DWORD *)v2 + 4 * v4;
      v13 = *(_DWORD *)v8;
    }
    else
    {
      v13 = v6;
    }
    if ( v13 == v2 + 8 )
      *(_DWORD *)(v2 + 8) = v9;
    *(_DWORD *)v8 = 0;
    v9 = *(_DWORD *)v7;
    goto LABEL_6;
  }
  return 0;
}

//----- (08051490) --------------------------------------------------------
int __cdecl sub_8051490(pthread_mutex_t *mutex, int a2)
{
  int v2; // eax@3
  int v3; // ST18_4@4
  int v5; // ST18_4@7
  int v6; // [sp+1Ch] [bp-1Ch]@4

  if ( !mutex )
  {
    v2 = std::__throw_system_error(1);
LABEL_6:
    std::__throw_system_error(v2);
    goto LABEL_7;
  }
  if ( &_pthread_key_create )
  {
    v2 = pthread_mutex_lock(mutex);
    if ( !v2 )
    {
      sub_8051390((int)&mutex[1], (int *)a2);
      v3 = mutex[2].__count;
      sub_8057EB0((int)&v6, mutex[2].__lock, v3, a2);
      sub_8058060((int)&v6, (int)&mutex[2], v6, v3);
      return pthread_mutex_unlock(mutex);
    }
    goto LABEL_6;
  }
LABEL_7:
  sub_8051390((int)&mutex[1], (int *)a2);
  v5 = mutex[2].__count;
  sub_8057EB0((int)&v6, mutex[2].__lock, v5, a2);
  return sub_8058060((int)&v6, (int)&mutex[2], v6, v5);
}

//----- (08051580) --------------------------------------------------------
int __cdecl sub_8051580(pthread_mutex_t *a1)
{
  int v1; // eax@2
  int v2; // esi@3
  unsigned int v3; // ecx@3
  int *v4; // ebp@4
  int v5; // esi@11
  int v6; // eax@16
  void *v7; // esi@17
  void *v8; // ebp@17
  int v9; // eax@18
  bool v10; // zf@18
  int result; // eax@25
  int v12; // ebp@26
  int v13; // ebp@27
  int v14; // esi@29
  int v15; // eax@33
  int v16; // edx@49
  int i; // ecx@49
  int v18; // eax@53
  int v19; // ST0C_4@59
  pthread_mutex_t *v20; // [sp+4h] [bp-48h]@0
  int v21; // [sp+4h] [bp-48h]@40
  pthread_mutex_t *v22; // [sp+1Ch] [bp-30h]@1
  char v23; // [sp+20h] [bp-2Ch]@1
  unsigned int v24; // [sp+24h] [bp-28h]@4
  void *v25; // [sp+28h] [bp-24h]@4
  int v26; // [sp+2Ch] [bp-20h]@4

  while ( 1 )
  {
    a1[3].__size[8] = 0;
    v22 = a1;
    v23 = 0;
    if ( &_pthread_key_create )
    {
      v1 = pthread_mutex_lock(a1);
      if ( v1 )
        goto LABEL_61;
    }
    v23 = 1;
    v2 = a1[2].__spins;
    v3 = a1[2].__nusers;
    if ( v2 == v3 )
      goto LABEL_25;
    v24 = a1[2].__nusers;
    a1[2].__nusers = 0;
    v25 = (void *)v2;
    a1[2].__spins = 0;
    v26 = a1[3].__lock;
    a1[3].__lock = 0;
    v4 = (int *)v3;
    do
    {
      sub_8051390((int)&a1[1], v4);
      ++v4;
    }
    while ( (int *)v2 != v4 );
    if ( !v23 )
    {
      v1 = std::__throw_system_error(1);
LABEL_61:
      v6 = std::__throw_system_error(v1);
      goto LABEL_62;
    }
    if ( v22 )
    {
      if ( &_pthread_key_create )
        pthread_mutex_unlock(v22);
      v23 = 0;
    }
    v5 = v24;
    if ( (void *)v24 != v25 )
    {
      do
      {
        sub_80AD210(a1[3].__count, v5);
        v5 += 4;
      }
      while ( v25 != (void *)v5 );
    }
    if ( v22 )
      break;
LABEL_64:
    std::__throw_system_error(1);
    v20 = *(pthread_mutex_t **)v20->__lock;
  }
  if ( v23 )
  {
LABEL_63:
    std::__throw_system_error(35);
    goto LABEL_64;
  }
  if ( &_pthread_key_create )
  {
    v6 = pthread_mutex_lock(v22);
    if ( v6 )
    {
LABEL_62:
      std::__throw_system_error(v6);
      goto LABEL_63;
    }
  }
  v23 = 1;
  v7 = v25;
  v8 = (void *)v24;
  if ( v25 != (void *)v24 )
  {
    do
    {
      v9 = *(_DWORD *)v8;
      v10 = *(_DWORD *)v8 == 0;
      if ( *(_DWORD *)v8 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v9 + 4));
        if ( v10 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v9 + 4))(v9);
      }
      v8 = (char *)v8 + 4;
    }
    while ( v25 != v8 );
    v7 = (void *)v24;
  }
  if ( v7 )
    operator delete(v7);
LABEL_25:
  result = a1[3].__count;
  if ( *(_DWORD *)(result + 108) + *(_DWORD *)(result + 104) > dword_80CF85C )
  {
    if ( dword_80CF85C )
      goto LABEL_41;
    v12 = dword_80CF860;
    if ( dword_80CF860 )
      goto LABEL_49;
LABEL_27:
    v13 = 0x7FFFFFFF;
LABEL_28:
    if ( v23 )
    {
      result = (int)v22;
      v14 = 0;
      while ( 1 )
      {
        if ( result )
        {
          if ( &_pthread_key_create )
            pthread_mutex_unlock((pthread_mutex_t *)result);
          v23 = 0;
        }
        result = loc_8050C70(a1, a1[3].__count);
        if ( !(_BYTE)result )
          goto LABEL_41;
        result = (int)v22;
        if ( !v22 )
          break;
        if ( v23 )
        {
          v18 = std::__throw_system_error(35);
          goto LABEL_59;
        }
        if ( &_pthread_key_create )
        {
          v15 = pthread_mutex_lock(v22);
          if ( v15 )
          {
            v18 = std::__throw_system_error(v15);
            goto LABEL_54;
          }
          result = (int)v22;
        }
        v23 = 1;
        ++v14;
        if ( v14 >= v13 )
          goto LABEL_44;
      }
      v18 = std::__throw_system_error(1);
LABEL_54:
      if ( v23 )
      {
LABEL_59:
        v19 = v18;
        sub_80584A0((int)&v22, v21);
        v18 = v19;
      }
    }
    else
    {
      v18 = std::__throw_system_error(1);
    }
    Unwind_Resume(v18);
  }
  v12 = dword_80CF860;
  if ( !dword_80CF860 )
    goto LABEL_27;
LABEL_49:
  v16 = *(_DWORD *)(result + 4);
  for ( i = 0; result != v16; v16 = *(_DWORD *)(v16 + 4) )
    ++i;
  v13 = v12 - i;
  if ( v13 > 0 )
    goto LABEL_28;
LABEL_41:
  if ( v23 )
  {
    result = (int)v22;
LABEL_44:
    if ( result )
    {
      if ( &_pthread_key_create )
        result = pthread_mutex_unlock((pthread_mutex_t *)result);
    }
  }
  return result;
}
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 8050C70: using guessed type _DWORD __cdecl loc_8050C70(pthread_mutex_t *mutex, _DWORD);
// 80CF85C: using guessed type int dword_80CF85C;
// 80CF860: using guessed type int dword_80CF860;

//----- (080518D0) --------------------------------------------------------
int __cdecl sub_80518D0(pthread_mutex_t *a1)
{
  sub_80A83E0(a1[3].__count);
  return sub_8051580(a1);
}

//----- (080531C0) --------------------------------------------------------
int __cdecl sub_80531C0(pthread_mutex_t *mutex, int a2, int a3)
{
  unsigned int v3; // ebp@0
  unsigned int v4; // eax@2
  int v5; // esi@2
  int v6; // ebx@4
  int v7; // eax@4
  size_t v8; // eax@6
  char *v9; // edx@6
  int v10; // ebx@8
  int v11; // ebx@8
  int v12; // ebx@8
  int v13; // eax@8
  int v14; // edx@8
  int v15; // ecx@9
  int v16; // ebx@11
  int v17; // ebx@12
  int v18; // eax@14
  int v19; // esi@14
  int v20; // eax@14
  int v21; // ebx@14
  char v22; // al@16
  std::ostream *v23; // eax@17
  int v24; // edx@18
  int v25; // eax@19
  int v26; // eax@21
  int v27; // edx@21
  int v28; // ecx@21
  int v29; // esi@22
  int v30; // eax@23
  void *v31; // edx@23
  int v32; // edx@23
  void *v33; // edx@25
  int v34; // edx@25
  int v35; // eax@25
  int v36; // eax@27
  bool v37; // zf@27
  int v38; // eax@30
  bool v39; // zf@30
  void *v40; // edi@33
  void *v41; // ebx@33
  int v42; // eax@34
  int v43; // edx@34
  void *v44; // edi@39
  void *v45; // ebx@39
  int v46; // eax@40
  int v47; // edx@40
  int v48; // edx@45
  int v49; // edx@46
  int v50; // ecx@49
  int v51; // eax@51
  void *v52; // edx@51
  int v53; // edx@51
  void *v54; // edx@53
  int v55; // edx@53
  int v56; // eax@53
  int v57; // eax@55
  bool v58; // zf@55
  int v59; // eax@58
  bool v60; // zf@58
  void *v61; // edi@61
  void *v62; // ebx@61
  int v63; // eax@62
  int v64; // edx@62
  void *v65; // edi@67
  void *v66; // ebx@67
  int v67; // eax@68
  int v68; // edx@68
  int v69; // edx@73
  int v70; // eax@74
  int v71; // edx@74
  int v72; // ecx@76
  std::locale *v73; // eax@77
  int v74; // edi@79
  int v75; // eax@79
  void *v76; // esi@82
  void *v77; // ebx@82
  int v78; // eax@84
  int v79; // edx@84
  void *v80; // esi@89
  void *v81; // ebx@89
  int v82; // eax@91
  int v83; // edx@91
  int v84; // eax@96
  int v85; // edx@96
  int v86; // eax@97
  std::locale *v87; // eax@102
  int v88; // edi@104
  int v89; // eax@104
  void *v90; // esi@107
  int v91; // ebx@107
  int v92; // eax@109
  int v93; // edx@109
  void *v94; // esi@114
  void *v95; // ebx@114
  int v96; // eax@116
  int v97; // edx@116
  int v98; // eax@121
  int v99; // edx@121
  int v100; // eax@122
  int result; // eax@132
  int v102; // edi@135
  int v103; // ebx@136
  int v104; // edi@138
  int v105; // eax@138
  void *v106; // esi@141
  void *v107; // ebx@141
  int v108; // eax@142
  int v109; // edx@142
  void *v110; // esi@147
  void *v111; // ebx@147
  int v112; // eax@148
  int v113; // edx@148
  int v114; // eax@153
  int v115; // edx@153
  int v116; // eax@154
  int v117; // edi@158
  int v118; // eax@158
  void *v119; // esi@161
  void *v120; // ebx@161
  int v121; // eax@162
  int v122; // edx@162
  void *v123; // esi@167
  void *v124; // ebx@167
  int v125; // eax@168
  int v126; // edx@168
  int v127; // eax@173
  int v128; // edx@173
  int v129; // eax@174
  int v130; // eax@176
  int v131; // edx@178
  int v132; // esi@183
  int v133; // ebx@183
  int v134; // eax@183
  char *v135; // esi@184
  size_t v136; // eax@185
  int v137; // ebx@187
  int v138; // eax@188
  std::ostream *v139; // ebx@188
  int v140; // eax@188
  char v141; // al@189
  std::ostream *v142; // eax@189
  unsigned int v143; // ebx@195
  unsigned int v144; // edx@200
  int v145; // ebx@204
  int v146; // eax@205
  int v147; // eax@208
  char v148; // di@210
  int v149; // eax@210
  int v150; // edx@210
  void *v151; // ecx@210
  std::locale *v152; // edi@212
  int v153; // edi@214
  int v154; // eax@214
  int v155; // eax@217
  void *v156; // esi@220
  void *v157; // ebx@220
  int v158; // eax@221
  int v159; // edx@221
  void *v160; // esi@226
  void *v161; // ebx@226
  int v162; // eax@227
  int v163; // edx@227
  int v164; // eax@232
  int v165; // eax@233
  int v166; // ecx@237
  int v167; // edi@237
  int v168; // edi@239
  int v169; // eax@239
  int v170; // eax@242
  void *v171; // esi@245
  void *v172; // ebx@245
  int v173; // eax@246
  int v174; // edx@246
  void *v175; // esi@251
  void *v176; // ebx@251
  int v177; // eax@252
  int v178; // edx@252
  int v179; // eax@257
  int v180; // eax@258
  int v181; // esi@264
  int v182; // ebx@264
  int v183; // eax@264
  int v184; // edx@264
  int v185; // ecx@265
  int v186; // ebx@268
  int v187; // eax@270
  int v188; // eax@270
  char v189; // al@272
  std::ostream *v190; // eax@273
  int v191; // ecx@274
  signed __int32 v192; // edx@276
  signed __int32 v193; // eax@282
  signed __int32 v194; // eax@286
  signed __int32 v195; // eax@290
  signed __int32 v196; // eax@294
  signed __int32 v197; // eax@302
  signed __int32 v198; // eax@306
  signed __int32 v199; // eax@311
  signed __int32 v200; // eax@315
  std::locale *v201; // ST44_4@320
  int v202; // esi@320
  int v203; // esi@320
  int v204; // esi@320
  int v205; // esi@320
  int v206; // eax@321
  std::ostream *v207; // ebx@321
  int v208; // eax@321
  char v209; // al@322
  std::ostream *v210; // eax@322
  signed __int32 v211; // ecx@325
  int v212; // ebx@326
  signed __int32 v213; // ecx@328
  signed __int32 v214; // ecx@329
  signed __int32 v215; // ecx@330
  signed __int32 v216; // ebx@333
  signed __int32 v217; // eax@337
  signed __int32 v218; // ebx@341
  signed __int32 v219; // ebx@343
  signed __int32 v220; // ebx@347
  signed __int32 v221; // eax@353
  signed __int32 v222; // eax@357
  signed __int32 v223; // ecx@360
  signed __int32 v224; // ecx@361
  signed __int32 v225; // ebx@363
  signed __int32 v226; // ebx@367
  signed __int32 v227; // eax@373
  signed __int32 v228; // eax@377
  signed __int32 v229; // ecx@380
  signed __int32 v230; // ecx@381
  signed __int32 v231; // edx@383
  signed __int32 v232; // ecx@388
  signed __int32 v233; // ecx@389
  signed __int32 v234; // ecx@391
  signed __int32 v235; // ecx@393
  signed __int32 v236; // eax@398
  signed __int32 v237; // ebx@402
  signed __int32 v238; // ecx@406
  signed __int32 v239; // ebx@409
  signed __int32 v240; // ecx@413
  signed __int32 v241; // ebx@418
  signed __int32 v242; // eax@423
  signed __int32 v243; // ebx@427
  signed __int32 v244; // ebx@430
  signed __int32 v245; // edx@433
  signed __int32 v246; // eax@437
  signed __int32 v247; // eax@441
  signed __int32 v248; // eax@445
  signed __int32 v249; // ecx@448
  signed __int32 v250; // ecx@449
  signed __int32 v251; // ebx@451
  signed __int32 v252; // ebx@456
  signed __int32 v253; // eax@460
  signed __int32 v254; // ebx@464
  signed __int32 v255; // eax@466
  signed __int32 v256; // ecx@470
  signed __int32 v257; // ebx@472
  signed __int32 v258; // ebx@478
  signed __int32 v259; // ecx@481
  int v260; // [sp+Ch] [bp-15Ch]@0
  void *v261; // [sp+20h] [bp-148h]@76
  void *v262; // [sp+20h] [bp-148h]@135
  int v263; // [sp+24h] [bp-144h]@0
  int v264; // [sp+28h] [bp-140h]@0
  int v265; // [sp+2Ch] [bp-13Ch]@0
  std::locale *v266; // [sp+2Ch] [bp-13Ch]@212
  std::locale *v267; // [sp+2Ch] [bp-13Ch]@237
  void *v268; // [sp+30h] [bp-138h]@2
  void *v269; // [sp+30h] [bp-138h]@22
  void *v270; // [sp+30h] [bp-138h]@77
  void *v271; // [sp+30h] [bp-138h]@136
  void *v272; // [sp+30h] [bp-138h]@156
  int v273; // [sp+34h] [bp-134h]@0
  int v274; // [sp+34h] [bp-134h]@210
  int v275; // [sp+34h] [bp-134h]@213
  int v276; // [sp+34h] [bp-134h]@238
  int v277; // [sp+38h] [bp-130h]@2
  int v278; // [sp+38h] [bp-130h]@21
  int v279; // [sp+38h] [bp-130h]@137
  int v280; // [sp+38h] [bp-130h]@157
  int v281; // [sp+38h] [bp-130h]@200
  int v282; // [sp+38h] [bp-130h]@210
  int v283; // [sp+38h] [bp-130h]@213
  int v284; // [sp+38h] [bp-130h]@238
  int v285; // [sp+3Ch] [bp-12Ch]@3
  int v286; // [sp+3Ch] [bp-12Ch]@21
  int v287; // [sp+3Ch] [bp-12Ch]@137
  int v288; // [sp+3Ch] [bp-12Ch]@157
  char v289; // [sp+3Ch] [bp-12Ch]@210
  std::locale *v290; // [sp+3Ch] [bp-12Ch]@213
  std::locale *v291; // [sp+3Ch] [bp-12Ch]@238
  std::locale *v292; // [sp+40h] [bp-128h]@77
  std::locale *v293; // [sp+40h] [bp-128h]@102
  std::locale *v294; // [sp+40h] [bp-128h]@137
  std::locale *v295; // [sp+40h] [bp-128h]@157
  std::locale *v296; // [sp+40h] [bp-128h]@183
  char v297; // [sp+40h] [bp-128h]@210
  std::locale *v298; // [sp+40h] [bp-128h]@212
  std::locale *v299; // [sp+40h] [bp-128h]@237
  int v300; // [sp+44h] [bp-124h]@4
  int v301; // [sp+44h] [bp-124h]@78
  int *v302; // [sp+44h] [bp-124h]@103
  void *v303; // [sp+44h] [bp-124h]@136
  void *v304; // [sp+44h] [bp-124h]@156
  int v305; // [sp+44h] [bp-124h]@202
  __int64 v306; // [sp+48h] [bp-120h]@136
  char v307; // [sp+56h] [bp-112h]@267
  char v308; // [sp+57h] [bp-111h]@10
  int v309; // [sp+58h] [bp-110h]@8
  int v310; // [sp+5Ch] [bp-10Ch]@10
  unsigned int v311; // [sp+70h] [bp-F8h]@195
  int v312; // [sp+9Ch] [bp-CCh]@4
  int v313; // [sp+A0h] [bp-C8h]@4
  int v314; // [sp+A4h] [bp-C4h]@4
  int v315; // [sp+A8h] [bp-C0h]@4
  int v316; // [sp+ACh] [bp-BCh]@4
  int v317; // [sp+B0h] [bp-B8h]@4
  void *v318; // [sp+B4h] [bp-B4h]@4
  void *v319; // [sp+B8h] [bp-B0h]@4
  int v320; // [sp+BCh] [bp-ACh]@4
  int v321; // [sp+C0h] [bp-A8h]@4
  int v322; // [sp+C4h] [bp-A4h]@4
  void *v323; // [sp+C8h] [bp-A0h]@4
  void *v324; // [sp+CCh] [bp-9Ch]@25
  int v325; // [sp+D0h] [bp-98h]@25
  int v326; // [sp+D4h] [bp-94h]@25
  int v327; // [sp+D8h] [bp-90h]@25
  int v328; // [sp+138h] [bp-30h]@4
  char v329; // [sp+13Ch] [bp-2Ch]@4
  char v330; // [sp+13Dh] [bp-2Bh]@4
  int v331; // [sp+140h] [bp-28h]@4
  int v332; // [sp+144h] [bp-24h]@4
  int v333; // [sp+148h] [bp-20h]@4
  int v334; // [sp+14Ch] [bp-1Ch]@4

  if ( log_level > 2 )
    goto LABEL_19;
  v4 = mutex[3].__count;
  v277 = *(_DWORD *)(v4 + 100);
  v273 = *(_DWORD *)(v4 + 108);
  v268 = *(void **)(v4 + 104);
  v5 = *(_DWORD *)(*(_DWORD *)(a3 + 12) + 64) + ((*(_DWORD *)(a3 + 4) - *(_DWORD *)a3) >> 2);
  v265 = *(_DWORD *)a2;
  if ( *(_DWORD *)(*(_DWORD *)(*(_DWORD *)a2 + 40) + 12) == 1 )
    v285 = (int)"passed";
  else
    v285 = (int)"failed";
  v300 = (int)&v312;
  std::ios_base::ios_base((std::ios_base *)&v323);
  v323 = &unk_80CF5C8;
  v328 = 0;
  v329 = 0;
  v330 = 0;
  v331 = 0;
  v332 = 0;
  v333 = 0;
  v334 = 0;
  v312 = dword_80CF674;
  *(int *)((char *)&v312 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v312 + *(_DWORD *)(v312 - 12), 0);
  v312 = (int)&unk_80CF5DC;
  v323 = &unk_80CF5F0;
  v313 = (int)&unk_80CF7F0;
  v314 = 0;
  v315 = 0;
  v316 = 0;
  v317 = 0;
  v318 = 0;
  v319 = 0;
  std::locale::locale((std::locale *)&v320);
  v313 = (int)&unk_80CF588;
  v321 = 16;
  v322 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v323, &v313);
  v6 = std::__ostream_insert<char,std::char_traits<char>>(&v312, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v6, "done target ", 12);
  v7 = *(_DWORD *)(v265 + 16);
  if ( v7 )
  {
    if ( !*(_DWORD *)(v7 + 8) )
    {
      std::basic_ios<char,std::char_traits<char>>::clear(
        v6 + *(_DWORD *)(*(_DWORD *)v6 - 12),
        *(_DWORD *)(v6 + *(_DWORD *)(*(_DWORD *)v6 - 12) + 20) | 1);
      goto LABEL_8;
    }
    v265 = *(_DWORD *)(v7 + 8);
    v8 = strlen(*(const char **)(v7 + 8));
    v9 = (char *)v265;
  }
  else
  {
    v8 = 0;
    v9 = "";
  }
  std::__ostream_insert<char,std::char_traits<char>>(v6, v9, v8);
LABEL_8:
  std::__ostream_insert<char,std::char_traits<char>>(v6, " : ", 3);
  std::__ostream_insert<char,std::char_traits<char>>(v6, v285, 6);
  std::__ostream_insert<char,std::char_traits<char>>(v6, ", left: ", 8);
  v10 = std::ostream::operator<<(v6, v5);
  std::__ostream_insert<char,std::char_traits<char>>(v10, ", running http: ", 16);
  v11 = std::ostream::operator<<(v10, v268);
  std::__ostream_insert<char,std::char_traits<char>>(v11, " https: ", 8);
  v12 = std::ostream::operator<<(v11, v273);
  std::__ostream_insert<char,std::char_traits<char>>(v12, " dns: ", 6);
  v13 = std::ostream::operator<<(v12, v277);
  v309 = (int)&unk_80CF83C;
  v14 = *(_DWORD *)(v13 + 24);
  if ( v14 )
  {
    v15 = *(_DWORD *)(v13 + 16);
    LOBYTE(v260) = 0;
    if ( v14 <= (unsigned int)v15 )
    {
      v310 = std::string::_S_construct<char *>((int)&v308, v3, &v323, *(_DWORD *)(v13 + 20), v15, (int)&v308);
      std::string::swap((std::string *)&v309, (std::string *)&v310);
    }
    else
    {
      v310 = std::string::_S_construct<char *>((int)&v308, v3, &v323, *(_DWORD *)(v13 + 20), v14, (int)&v308);
      std::string::swap((std::string *)&v309, (std::string *)&v310);
    }
    v16 = v310 - 12;
    if ( (_DWORD *)(v310 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v245 = _InterlockedExchangeAdd((volatile signed __int32 *)(v310 - 4), 0xFFFFFFFF);
      }
      else
      {
        v245 = *(_DWORD *)(v310 - 4);
        *(_DWORD *)(v310 - 4) = v245 - 1;
      }
      if ( v245 <= 0 )
        std::string::_Rep::_M_destroy(v16, &v307);
    }
  }
  else
  {
    std::string::assign((std::string *)&v309, (const std::string *)(v13 + 40));
  }
  v312 = (int)&unk_80CF5DC;
  v323 = &unk_80CF5F0;
  v313 = (int)&unk_80CF588;
  v17 = v322 - 12;
  if ( (_DWORD *)(v322 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v240 = _InterlockedExchangeAdd((volatile signed __int32 *)(v322 - 4), 0xFFFFFFFF);
    }
    else
    {
      v240 = *(_DWORD *)(v322 - 4);
      *(_DWORD *)(v322 - 4) = v240 - 1;
    }
    if ( v240 <= 0 )
      std::string::_Rep::_M_destroy(v17, &v310);
  }
  v313 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v320);
  v312 = dword_80CF674;
  *(int *)((char *)&v312 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  v323 = &unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v323);
  if ( byte_80CE64C )
  {
    v18 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v309, *(_DWORD *)(v309 - 12));
    v19 = v18;
    v20 = *(_DWORD *)(*(_DWORD *)v18 - 12);
    v21 = *(_DWORD *)(v19 + v20 + 124);
    if ( !v21 )
    {
      v70 = std::__throw_bad_cast();
      goto LABEL_477;
    }
    if ( *(_BYTE *)(v21 + 28) )
    {
      v22 = *(_BYTE *)(v21 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)(v19 + v20 + 124));
      v22 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v21 + 24))(v21, 10);
    }
    v23 = (std::ostream *)std::ostream::put((std::ostream *)v19, v22);
    std::ostream::flush(v23);
  }
  syslog(6, "%s", v309, v260);
  v24 = v309 - 12;
  if ( (_DWORD *)(v309 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v238 = _InterlockedExchangeAdd((volatile signed __int32 *)(v309 - 4), 0xFFFFFFFF);
    }
    else
    {
      v238 = *(_DWORD *)(v309 - 4);
      *(_DWORD *)(v309 - 4) = v238 - 1;
    }
    if ( v238 <= 0 )
      std::string::_Rep::_M_destroy(v24, &v312);
  }
LABEL_19:
  v25 = *(_DWORD *)(*(_DWORD *)a2 + 40);
  if ( *(_DWORD *)(v25 + 12) == 1 )
  {
    --*(_DWORD *)v25;
    v102 = *(_DWORD *)(*(_DWORD *)a2 + 40);
    v262 = *(void **)(*(_DWORD *)a2 + 40);
    if ( *(_DWORD *)v102 <= 0 )
    {
      ++*(_DWORD *)(a3 + 20);
      goto LABEL_21;
    }
    v103 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)a2 + 32) + 52);
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v306);
    *(_QWORD *)(v102 + 4) = v306 + 1000000000LL * v103;
    *(_DWORD *)(v102 + 12) = 0;
    v303 = *(void **)(v102 + 24);
    v271 = *(void **)(v102 + 28);
    if ( v303 != v271 )
    {
      v279 = (int)((char *)v303 + 28);
      v287 = (int)((char *)v303 + 48);
      v294 = *(std::locale **)(v102 + 24);
      do
      {
        v104 = v294 - (std::locale *)v303;
        v105 = *(_DWORD *)((char *)v303 + v294 - (std::locale *)v303 + 56);
        if ( v105 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v105 + 4));
          if ( !v105 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v106 = *(void **)v287;
        v107 = *(void **)(v287 - 4);
        if ( *(void **)v287 != v107 )
        {
          do
          {
            v108 = *(_DWORD *)v107;
            v109 = *(_DWORD *)v107 - 12;
            if ( (_DWORD *)v109 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v248 = _InterlockedExchangeAdd((volatile signed __int32 *)(v108 - 4), 0xFFFFFFFF);
              }
              else
              {
                v250 = *(_DWORD *)(v108 - 4);
                *(_DWORD *)(v108 - 4) = v250 - 1;
                v248 = v250;
              }
              if ( v248 <= 0 )
                std::string::_Rep::_M_destroy(v109, &v312);
            }
            v107 = (char *)v107 + 4;
          }
          while ( v106 != v107 );
          v106 = (void *)*((_DWORD *)v294 + 11);
        }
        if ( v106 )
          operator delete(v106);
        v110 = *(void **)v279;
        v111 = *(void **)(v279 - 4);
        if ( *(void **)v279 != v111 )
        {
          do
          {
            v112 = *(_DWORD *)v111;
            v113 = *(_DWORD *)v111 - 12;
            if ( (_DWORD *)v113 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v247 = _InterlockedExchangeAdd((volatile signed __int32 *)(v112 - 4), 0xFFFFFFFF);
              }
              else
              {
                v249 = *(_DWORD *)(v112 - 4);
                *(_DWORD *)(v112 - 4) = v249 - 1;
                v247 = v249;
              }
              if ( v247 <= 0 )
                std::string::_Rep::_M_destroy(v113, &v312);
            }
            v111 = (char *)v111 + 4;
          }
          while ( v110 != v111 );
          v110 = (void *)*((_DWORD *)v294 + 6);
        }
        if ( v110 )
          operator delete(v110);
        v114 = *(_DWORD *)((char *)v303 + v104 + 20);
        v115 = v114 - 12;
        if ( (_DWORD *)(v114 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v253 = _InterlockedExchangeAdd((volatile signed __int32 *)(v114 - 4), 0xFFFFFFFF);
          }
          else
          {
            v254 = *(_DWORD *)(v114 - 4);
            *(_DWORD *)(v114 - 4) = v254 - 1;
            v253 = v254;
          }
          if ( v253 <= 0 )
            std::string::_Rep::_M_destroy(v115, &v312);
        }
        v116 = *(_DWORD *)((char *)v303 + v104 + 8);
        if ( (_DWORD *)(v116 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v252 = _InterlockedExchangeAdd((volatile signed __int32 *)(v116 - 4), 0xFFFFFFFF);
          }
          else
          {
            v252 = *(_DWORD *)(v116 - 4);
            *(_DWORD *)(v116 - 4) = v252 - 1;
          }
          if ( v252 <= 0 )
            std::string::_Rep::_M_destroy(v116 - 12, &v312);
        }
        v294 = (std::locale *)((char *)v294 + 60);
        v279 += 60;
        v287 += 60;
      }
      while ( v271 != (void *)v294 );
    }
    *((_DWORD *)v262 + 7) = v303;
    v304 = (void *)*((_DWORD *)v262 + 9);
    v272 = (void *)*((_DWORD *)v262 + 10);
    if ( v304 != v272 )
    {
      v280 = (int)((char *)v304 + 28);
      v288 = (int)((char *)v304 + 48);
      v295 = (std::locale *)*((_DWORD *)v262 + 9);
      do
      {
        v117 = v295 - (std::locale *)v304;
        v118 = *(_DWORD *)((char *)v304 + v295 - (std::locale *)v304 + 56);
        if ( v118 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v118 + 4));
          if ( !v118 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v119 = *(void **)v288;
        v120 = *(void **)(v288 - 4);
        if ( *(void **)v288 != v120 )
        {
          do
          {
            v121 = *(_DWORD *)v120;
            v122 = *(_DWORD *)v120 - 12;
            if ( (_DWORD *)v122 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v255 = _InterlockedExchangeAdd((volatile signed __int32 *)(v121 - 4), 0xFFFFFFFF);
              }
              else
              {
                v256 = *(_DWORD *)(v121 - 4);
                *(_DWORD *)(v121 - 4) = v256 - 1;
                v255 = v256;
              }
              if ( v255 <= 0 )
                std::string::_Rep::_M_destroy(v122, &v312);
            }
            v120 = (char *)v120 + 4;
          }
          while ( v119 != v120 );
          v119 = (void *)*((_DWORD *)v295 + 11);
        }
        if ( v119 )
          operator delete(v119);
        v123 = *(void **)v280;
        v124 = *(void **)(v280 - 4);
        if ( *(void **)v280 != v124 )
        {
          do
          {
            v125 = *(_DWORD *)v124;
            v126 = *(_DWORD *)v124 - 12;
            if ( (_DWORD *)v126 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v246 = _InterlockedExchangeAdd((volatile signed __int32 *)(v125 - 4), 0xFFFFFFFF);
              }
              else
              {
                v259 = *(_DWORD *)(v125 - 4);
                *(_DWORD *)(v125 - 4) = v259 - 1;
                v246 = v259;
              }
              if ( v246 <= 0 )
                std::string::_Rep::_M_destroy(v126, &v312);
            }
            v124 = (char *)v124 + 4;
          }
          while ( v123 != v124 );
          v123 = (void *)*((_DWORD *)v295 + 6);
        }
        if ( v123 )
          operator delete(v123);
        v127 = *(_DWORD *)((char *)v304 + v117 + 20);
        v128 = v127 - 12;
        if ( (_DWORD *)(v127 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v217 = _InterlockedExchangeAdd((volatile signed __int32 *)(v127 - 4), 0xFFFFFFFF);
          }
          else
          {
            v218 = *(_DWORD *)(v127 - 4);
            *(_DWORD *)(v127 - 4) = v218 - 1;
            v217 = v218;
          }
          if ( v217 <= 0 )
            std::string::_Rep::_M_destroy(v128, &v312);
        }
        v129 = *(_DWORD *)((char *)v304 + v117 + 8);
        if ( (_DWORD *)(v129 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v216 = _InterlockedExchangeAdd((volatile signed __int32 *)(v129 - 4), 0xFFFFFFFF);
          }
          else
          {
            v216 = *(_DWORD *)(v129 - 4);
            *(_DWORD *)(v129 - 4) = v216 - 1;
          }
          if ( v216 <= 0 )
            std::string::_Rep::_M_destroy(v129 - 12, &v312);
        }
        v295 = (std::locale *)((char *)v295 + 60);
        v280 += 60;
        v288 += 60;
      }
      while ( v272 != (void *)v295 );
    }
    *((_DWORD *)v262 + 10) = v304;
    v130 = *(_DWORD *)(a3 + 4);
    if ( v130 == *(_DWORD *)(a3 + 8) )
    {
      result = sub_8058600(a3, a2);
    }
    else
    {
      if ( v130 )
      {
        v131 = *(_DWORD *)a2;
        *(_DWORD *)v130 = *(_DWORD *)a2;
        if ( v131 )
          _InterlockedIncrement((volatile signed __int32 *)(v131 + 4));
        v130 = *(_DWORD *)(a3 + 4);
      }
      result = v130 + 4;
      *(_DWORD *)(a3 + 4) = result;
    }
    if ( log_level > 1 )
      return result;
    v132 = *(_DWORD *)a2;
    v296 = (std::locale *)**(_DWORD **)(*(_DWORD *)a2 + 40);
    std::ios_base::ios_base((std::ios_base *)&v323);
    v323 = &unk_80CF5C8;
    v328 = 0;
    v329 = 0;
    v330 = 0;
    v331 = 0;
    v332 = 0;
    v333 = 0;
    v334 = 0;
    v312 = dword_80CF674;
    *(int *)((char *)&v312 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v312 + *(_DWORD *)(v312 - 12), 0);
    v312 = (int)&unk_80CF5DC;
    v323 = &unk_80CF5F0;
    v313 = (int)&unk_80CF7F0;
    v314 = 0;
    v315 = 0;
    v316 = 0;
    v317 = 0;
    v318 = 0;
    v319 = 0;
    std::locale::locale((std::locale *)&v320);
    v313 = (int)&unk_80CF588;
    v321 = 16;
    v322 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v323, &v313);
    v133 = std::__ostream_insert<char,std::char_traits<char>>(
             &v312,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v133, "retrying target ", 16);
    v134 = *(_DWORD *)(v132 + 16);
    if ( v134 )
    {
      v135 = *(char **)(v134 + 8);
      if ( !v135 )
      {
        sub_804E060(v133);
LABEL_187:
        std::__ostream_insert<char,std::char_traits<char>>(v133, " (", 2);
        v137 = std::ostream::operator<<(v133, v296);
        std::__ostream_insert<char,std::char_traits<char>>(v137, " more)", 6);
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v310, v137 + 4);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v312);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v312);
        if ( byte_80CE64C )
        {
          v138 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v310, *(_DWORD *)(v310 - 12));
          v139 = (std::ostream *)v138;
          v140 = *(_DWORD *)(v138 + *(_DWORD *)(*(_DWORD *)v138 - 12) + 124);
          if ( !v140 )
          {
            v212 = std::__throw_bad_cast();
            std::string::_Rep::_M_dispose(v310 - 12, &v312);
            goto LABEL_327;
          }
          v141 = sub_8056FF0(v140, 0xAu);
          v142 = (std::ostream *)std::ostream::put(v139, v141);
          std::ostream::flush(v142);
        }
        syslog(7, "%s", v310);
        return std::string::_Rep::_M_dispose(v310 - 12, &v312);
      }
      v136 = strlen(*(const char **)(v134 + 8));
    }
    else
    {
      v136 = 0;
      v135 = "";
    }
    std::__ostream_insert<char,std::char_traits<char>>(v133, v135, v136);
    goto LABEL_187;
  }
  ++*(_DWORD *)(a3 + 24);
LABEL_21:
  v26 = *(_DWORD *)a2;
  v27 = *(_DWORD *)(*(_DWORD *)a2 + 40);
  v28 = *(_DWORD *)(v27 + 24);
  v286 = v28;
  v278 = *(_DWORD *)(v27 + 28);
  if ( v28 != v278 )
  {
    v273 = a3 + 28;
    v29 = *(_DWORD *)(v27 + 24);
    v269 = (void *)(v28 + 8);
    v265 = v28 + 20;
    v264 = v28 + 56;
    do
    {
      v312 = *(_DWORD *)v29;
      v313 = *(_DWORD *)(v29 + 4);
      v30 = v29 - v286;
      v314 = *(_DWORD *)((char *)v269 + v29 - v286);
      *(_DWORD *)((char *)v269 + v30) = &unk_80CF83C;
      v315 = *(_DWORD *)(v29 + 12);
      v316 = *(_DWORD *)(v29 + 16);
      v317 = *(_DWORD *)(v29 - v286 + v265);
      *(_DWORD *)(v30 + v265) = &unk_80CF83C;
      v318 = 0;
      v319 = 0;
      v320 = 0;
      v318 = *(void **)(v29 + 24);
      *(_DWORD *)(v29 + 24) = 0;
      v31 = v319;
      v319 = *(void **)(v29 + 28);
      *(_DWORD *)(v29 + 28) = v31;
      v32 = v320;
      v320 = *(_DWORD *)(v29 + 32);
      *(_DWORD *)(v29 + 32) = v32;
      LOBYTE(v321) = 0;
      v322 = 0;
      if ( *(_BYTE *)(v29 + 36) )
      {
        v322 = *(_DWORD *)(v29 + 40);
        LOBYTE(v321) = 1;
      }
      v323 = 0;
      v324 = 0;
      v325 = 0;
      v323 = *(void **)(v29 + 44);
      *(_DWORD *)(v29 + 44) = 0;
      v33 = v324;
      v324 = *(void **)(v29 + 48);
      *(_DWORD *)(v29 + 48) = v33;
      v34 = v325;
      v325 = *(_DWORD *)(v29 + 52);
      *(_DWORD *)(v29 + 52) = v34;
      v326 = *(_DWORD *)(v30 + v264);
      *(_DWORD *)(v30 + v264) = 0;
      v35 = *(_DWORD *)a2;
      v327 = v35;
      if ( v35 )
        _InterlockedIncrement((volatile signed __int32 *)(v35 + 4));
      sub_80597C0(v273, (int)&v312);
      v36 = v327;
      v37 = v327 == 0;
      if ( v327 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v327 + 4));
        if ( v37 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v36 + 4))(v36);
      }
      v38 = v326;
      v39 = v326 == 0;
      if ( v326 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v326 + 4));
        if ( v39 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v38 + 4))(v38);
      }
      v40 = v324;
      v41 = v323;
      if ( v324 != v323 )
      {
        do
        {
          v42 = *(_DWORD *)v41;
          v43 = *(_DWORD *)v41 - 12;
          if ( (_DWORD *)v43 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v195 = _InterlockedExchangeAdd((volatile signed __int32 *)(v42 - 4), 0xFFFFFFFF);
            }
            else
            {
              v233 = *(_DWORD *)(v42 - 4);
              *(_DWORD *)(v42 - 4) = v233 - 1;
              v195 = v233;
            }
            if ( v195 <= 0 )
              std::string::_Rep::_M_destroy(v43, &v310);
          }
          v41 = (char *)v41 + 4;
        }
        while ( v40 != v41 );
        v40 = v323;
      }
      if ( v40 )
        operator delete(v40);
      v44 = v319;
      v45 = v318;
      if ( v319 != v318 )
      {
        do
        {
          v46 = *(_DWORD *)v45;
          v47 = *(_DWORD *)v45 - 12;
          if ( (_DWORD *)v47 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v196 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
            }
            else
            {
              v232 = *(_DWORD *)(v46 - 4);
              *(_DWORD *)(v46 - 4) = v232 - 1;
              v196 = v232;
            }
            if ( v196 <= 0 )
              std::string::_Rep::_M_destroy(v47, &v310);
          }
          v45 = (char *)v45 + 4;
        }
        while ( v44 != v45 );
        v44 = v318;
      }
      if ( v44 )
        operator delete(v44);
      v48 = v317 - 12;
      if ( (_DWORD *)(v317 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v251 = _InterlockedExchangeAdd((volatile signed __int32 *)(v317 - 4), 0xFFFFFFFF);
        }
        else
        {
          v251 = *(_DWORD *)(v317 - 4);
          *(_DWORD *)(v317 - 4) = v251 - 1;
        }
        if ( v251 <= 0 )
          std::string::_Rep::_M_destroy(v48, &v310);
      }
      v49 = v314 - 12;
      if ( (_DWORD *)(v314 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v257 = _InterlockedExchangeAdd((volatile signed __int32 *)(v314 - 4), 0xFFFFFFFF);
        }
        else
        {
          v257 = *(_DWORD *)(v314 - 4);
          *(_DWORD *)(v314 - 4) = v257 - 1;
        }
        if ( v257 <= 0 )
          std::string::_Rep::_M_destroy(v49, &v310);
      }
      v29 += 60;
    }
    while ( v278 != v29 );
    v26 = *(_DWORD *)a2;
    v27 = *(_DWORD *)(*(_DWORD *)a2 + 40);
  }
  v50 = *(_DWORD *)(v27 + 36);
  v285 = v50;
  v277 = *(_DWORD *)(v27 + 40);
  if ( v50 == v277 )
  {
    *(_DWORD *)(v26 + 40) = 0;
    v261 = (void *)v27;
  }
  else
  {
    v273 = a3 + 40;
    v19 = *(_DWORD *)(v27 + 36);
    v300 = (int)&v312;
    v268 = (void *)(v50 + 8);
    v265 = v50 + 20;
    v264 = v50 + 56;
    do
    {
      v312 = *(_DWORD *)v19;
      v313 = *(_DWORD *)(v19 + 4);
      v51 = v19 - v285;
      v314 = *(_DWORD *)((char *)v268 + v19 - v285);
      *(_DWORD *)((char *)v268 + v51) = &unk_80CF83C;
      v315 = *(_DWORD *)(v19 + 12);
      v316 = *(_DWORD *)(v19 + 16);
      v317 = *(_DWORD *)(v19 - v285 + v265);
      *(_DWORD *)(v51 + v265) = &unk_80CF83C;
      v318 = 0;
      v319 = 0;
      v320 = 0;
      v318 = *(void **)(v19 + 24);
      *(_DWORD *)(v19 + 24) = 0;
      v52 = v319;
      v319 = *(void **)(v19 + 28);
      *(_DWORD *)(v19 + 28) = v52;
      v53 = v320;
      v320 = *(_DWORD *)(v19 + 32);
      *(_DWORD *)(v19 + 32) = v53;
      LOBYTE(v321) = 0;
      v322 = 0;
      if ( *(_BYTE *)(v19 + 36) )
      {
        v322 = *(_DWORD *)(v19 + 40);
        LOBYTE(v321) = 1;
      }
      v323 = 0;
      v324 = 0;
      v325 = 0;
      v323 = *(void **)(v19 + 44);
      *(_DWORD *)(v19 + 44) = 0;
      v54 = v324;
      v324 = *(void **)(v19 + 48);
      *(_DWORD *)(v19 + 48) = v54;
      v55 = v325;
      v325 = *(_DWORD *)(v19 + 52);
      *(_DWORD *)(v19 + 52) = v55;
      v326 = *(_DWORD *)(v51 + v264);
      *(_DWORD *)(v51 + v264) = 0;
      v56 = *(_DWORD *)a2;
      v327 = v56;
      if ( v56 )
        _InterlockedIncrement((volatile signed __int32 *)(v56 + 4));
      sub_80597C0(v273, v300);
      v57 = v327;
      v58 = v327 == 0;
      if ( v327 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v327 + 4));
        if ( v58 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v57 + 4))(v57);
      }
      v59 = v326;
      v60 = v326 == 0;
      if ( v326 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v326 + 4));
        if ( v60 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v59 + 4))(v59);
      }
      v61 = v324;
      v62 = v323;
      if ( v324 != v323 )
      {
        do
        {
          v63 = *(_DWORD *)v62;
          v64 = *(_DWORD *)v62 - 12;
          if ( (_DWORD *)v64 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v193 = _InterlockedExchangeAdd((volatile signed __int32 *)(v63 - 4), 0xFFFFFFFF);
            }
            else
            {
              v234 = *(_DWORD *)(v63 - 4);
              *(_DWORD *)(v63 - 4) = v234 - 1;
              v193 = v234;
            }
            if ( v193 <= 0 )
              std::string::_Rep::_M_destroy(v64, &v310);
          }
          v62 = (char *)v62 + 4;
        }
        while ( v61 != v62 );
        v61 = v323;
      }
      if ( v61 )
        operator delete(v61);
      v65 = v319;
      v66 = v318;
      if ( v319 != v318 )
      {
        do
        {
          v67 = *(_DWORD *)v66;
          v68 = *(_DWORD *)v66 - 12;
          if ( (_DWORD *)v68 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v194 = _InterlockedExchangeAdd((volatile signed __int32 *)(v67 - 4), 0xFFFFFFFF);
            }
            else
            {
              v215 = *(_DWORD *)(v67 - 4);
              *(_DWORD *)(v67 - 4) = v215 - 1;
              v194 = v215;
            }
            if ( v194 <= 0 )
              std::string::_Rep::_M_destroy(v68, &v310);
          }
          v66 = (char *)v66 + 4;
        }
        while ( v65 != v66 );
        v65 = v318;
      }
      if ( v65 )
        operator delete(v65);
      v69 = v317 - 12;
      if ( (_DWORD *)(v317 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v237 = _InterlockedExchangeAdd((volatile signed __int32 *)(v317 - 4), 0xFFFFFFFF);
        }
        else
        {
          v237 = *(_DWORD *)(v317 - 4);
          *(_DWORD *)(v317 - 4) = v237 - 1;
        }
        if ( v237 <= 0 )
          std::string::_Rep::_M_destroy(v69, &v310);
      }
      v70 = v314;
      v71 = v314 - 12;
      if ( (_DWORD *)(v314 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
LABEL_477:
        if ( &_pthread_key_create )
        {
          v258 = _InterlockedExchangeAdd((volatile signed __int32 *)(v70 - 4), 0xFFFFFFFF);
        }
        else
        {
          v258 = *(_DWORD *)(v70 - 4);
          *(_DWORD *)(v70 - 4) = v258 - 1;
        }
        if ( v258 <= 0 )
          std::string::_Rep::_M_destroy(v71, &v310);
      }
      v19 += 60;
    }
    while ( v277 != v19 );
    v261 = *(void **)(*(_DWORD *)a2 + 40);
    v72 = *(_DWORD *)(*(_DWORD *)a2 + 40);
    *(_DWORD *)(*(_DWORD *)a2 + 40) = 0;
    if ( !v72 )
      goto LABEL_128;
  }
  v270 = (void *)*((_DWORD *)v261 + 10);
  v73 = (std::locale *)*((_DWORD *)v261 + 9);
  v292 = v73;
  if ( v270 != (void *)v73 )
  {
    v277 = (int)((char *)v73 + 28);
    v285 = (int)((char *)v73 + 48);
    v301 = *((_DWORD *)v261 + 9);
    v263 = (int)((char *)v73 + 56);
    v264 = (int)((char *)v73 + 20);
    v265 = (int)((char *)v73 + 8);
    do
    {
      v74 = v301 - (_DWORD)v292;
      v75 = *(_DWORD *)(v301 - (_DWORD)v292 + v263);
      if ( v75 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v75 + 4));
        if ( !v75 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v76 = *(void **)v285;
      v77 = *(void **)(v285 - 4);
      if ( *(void **)v285 != v77 )
      {
        v273 = v301 - (_DWORD)v292;
        do
        {
          v78 = *(_DWORD *)v77;
          v79 = *(_DWORD *)v77 - 12;
          if ( (_DWORD *)v79 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v199 = _InterlockedExchangeAdd((volatile signed __int32 *)(v78 - 4), 0xFFFFFFFF);
            }
            else
            {
              v214 = *(_DWORD *)(v78 - 4);
              *(_DWORD *)(v78 - 4) = v214 - 1;
              v199 = v214;
            }
            if ( v199 <= 0 )
              std::string::_Rep::_M_destroy(v79, &v312);
          }
          v77 = (char *)v77 + 4;
        }
        while ( v76 != v77 );
        v76 = *(void **)(v301 + 44);
      }
      if ( v76 )
        operator delete(v76);
      v80 = *(void **)v277;
      v81 = *(void **)(v277 - 4);
      if ( *(void **)v277 != v81 )
      {
        v273 = v301 - (_DWORD)v292;
        do
        {
          v82 = *(_DWORD *)v81;
          v83 = *(_DWORD *)v81 - 12;
          if ( (_DWORD *)v83 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v198 = _InterlockedExchangeAdd((volatile signed __int32 *)(v82 - 4), 0xFFFFFFFF);
            }
            else
            {
              v211 = *(_DWORD *)(v82 - 4);
              *(_DWORD *)(v82 - 4) = v211 - 1;
              v198 = v211;
            }
            if ( v198 <= 0 )
              std::string::_Rep::_M_destroy(v83, &v312);
          }
          v81 = (char *)v81 + 4;
        }
        while ( v80 != v81 );
        v80 = *(void **)(v301 + 24);
      }
      if ( v80 )
        operator delete(v80);
      v84 = *(_DWORD *)(v74 + v264);
      v85 = v84 - 12;
      if ( (_DWORD *)(v84 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v242 = _InterlockedExchangeAdd((volatile signed __int32 *)(v84 - 4), 0xFFFFFFFF);
        }
        else
        {
          v244 = *(_DWORD *)(v84 - 4);
          *(_DWORD *)(v84 - 4) = v244 - 1;
          v242 = v244;
        }
        if ( v242 <= 0 )
          std::string::_Rep::_M_destroy(v85, &v312);
      }
      v86 = *(_DWORD *)(v74 + v265);
      if ( (_DWORD *)(v86 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v243 = _InterlockedExchangeAdd((volatile signed __int32 *)(v86 - 4), 0xFFFFFFFF);
        }
        else
        {
          v243 = *(_DWORD *)(v86 - 4);
          *(_DWORD *)(v86 - 4) = v243 - 1;
        }
        if ( v243 <= 0 )
          std::string::_Rep::_M_destroy(v86 - 12, &v312);
      }
      v301 += 60;
      v277 += 60;
      v285 += 60;
    }
    while ( v270 != (void *)v301 );
    v270 = (void *)*((_DWORD *)v261 + 9);
  }
  if ( v270 )
    operator delete(v270);
  v268 = (void *)*((_DWORD *)v261 + 7);
  v87 = (std::locale *)*((_DWORD *)v261 + 6);
  v293 = v87;
  if ( v268 != (void *)v87 )
  {
    v277 = (int)((char *)v87 + 28);
    v285 = (int)((char *)v87 + 48);
    v302 = (int *)*((_DWORD *)v261 + 6);
    v263 = (int)((char *)v87 + 56);
    v264 = (int)((char *)v87 + 20);
    v265 = (int)((char *)v87 + 8);
    goto LABEL_104;
  }
  while ( 1 )
  {
    if ( v268 )
      operator delete(v268);
    operator delete(v261);
LABEL_128:
    if ( *(_DWORD *)(*(_DWORD *)(a3 + 12) + 64) + ((*(_DWORD *)(a3 + 4) - *(_DWORD *)a3) >> 2) )
    {
      result = ((*(_DWORD *)(a3 + 44) - *(_DWORD *)(a3 + 40)) >> 6)
             + ((*(_DWORD *)(a3 + 32) - *(_DWORD *)(a3 + 28)) >> 6);
      if ( (unsigned int)(result - *(_DWORD *)(a3 + 52)) <= 0x31 )
        return result;
      *(_DWORD *)(a3 + 52) = result;
      v143 = dword_80CF84C;
      sysinfo((struct sysinfo *)&v310);
      if ( v311 <= 0x1E8480 )
        v311 = 0;
      else
        v311 -= 2000000;
      if ( v143 && v143 > v311 >> 1 )
        v143 = v311 >> 1;
      v281 = ((*(_DWORD *)(a3 + 44) - *(_DWORD *)(a3 + 40)) >> 6) + ((*(_DWORD *)(a3 + 32) - *(_DWORD *)(a3 + 28)) >> 6);
      result = -1431655765 * v281 * dword_80CF850;
      v144 = 4 * (v281 * dword_80CF850 / 3u);
      if ( v144 < v143 )
        return result;
      if ( log_level > 2 )
      {
        v305 = (int)&v312;
LABEL_203:
        if ( *(_DWORD *)(a3 + 64) )
        {
          v145 = a3 + 12;
          sub_8058470(a3 + 56, a3 + 12);
        }
        else
        {
          v145 = a3 + 12;
        }
        v146 = *(_DWORD *)(*(_DWORD *)a2 + 32);
        v312 = v146;
        if ( v146 )
          _InterlockedIncrement((volatile signed __int32 *)(v146 + 4));
        LOWORD(v313) = 1;
        BYTE2(v313) = 0;
        v314 = 0;
        v315 = 0;
        v316 = 0;
        v317 = 0;
        v318 = 0;
        v319 = 0;
        v320 = 0;
        v321 = 0;
        v322 = 0;
        if ( v145 == v305 )
        {
          v151 = 0;
          v150 = 0;
          v149 = 0;
          v274 = 0;
          v282 = 0;
          v148 = 0;
          v289 = 0;
          v297 = 1;
        }
        else
        {
          v147 = *(_DWORD *)(a3 + 12);
          if ( v147 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v147 + 4));
            if ( !v147 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            v289 = BYTE1(v313);
            v297 = v313;
            v148 = BYTE2(v313);
            v282 = v314;
            v274 = v315;
            v149 = v316;
            v150 = v317;
            v151 = v318;
          }
          else
          {
            v151 = 0;
            v150 = 0;
            v149 = 0;
            v274 = 0;
            v282 = 0;
            v148 = 0;
            v289 = 0;
            v297 = 1;
          }
          *(_DWORD *)(a3 + 12) = v312;
          v312 = 0;
        }
        *(_BYTE *)(a3 + 16) = v297;
        *(_BYTE *)(a3 + 17) = v289;
        *(_BYTE *)(a3 + 18) = v148;
        *(_DWORD *)(a3 + 20) = v282;
        *(_DWORD *)(a3 + 24) = v274;
        v298 = *(std::locale **)(a3 + 28);
        v152 = *(std::locale **)(a3 + 28);
        v266 = *(std::locale **)(a3 + 32);
        *(_DWORD *)(a3 + 28) = v149;
        v316 = 0;
        *(_DWORD *)(a3 + 32) = v150;
        v317 = 0;
        *(_DWORD *)(a3 + 36) = v151;
        v318 = 0;
        if ( v152 != v266 )
        {
          v275 = (int)((char *)v298 + 28);
          v283 = (int)((char *)v298 + 48);
          v290 = v298;
          do
          {
            v153 = v290 - v298;
            v154 = *(_DWORD *)((char *)v298 + v290 - v298 + 60);
            if ( v154 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v154 + 4));
              if ( !v154 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v155 = *(_DWORD *)((char *)v298 + v153 + 56);
            if ( v155 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v155 + 4));
              if ( !v155 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v156 = *(void **)v283;
            v157 = *(void **)(v283 - 4);
            if ( *(void **)v283 != v157 )
            {
              do
              {
                v158 = *(_DWORD *)v157;
                v159 = *(_DWORD *)v157 - 12;
                if ( (_DWORD *)v159 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v228 = _InterlockedExchangeAdd((volatile signed __int32 *)(v158 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v230 = *(_DWORD *)(v158 - 4);
                    *(_DWORD *)(v158 - 4) = v230 - 1;
                    v228 = v230;
                  }
                  if ( v228 <= 0 )
                    std::string::_Rep::_M_destroy(v159, &v309);
                }
                v157 = (char *)v157 + 4;
              }
              while ( v156 != v157 );
              v156 = (void *)*((_DWORD *)v290 + 11);
            }
            if ( v156 )
              operator delete(v156);
            v160 = *(void **)v275;
            v161 = *(void **)(v275 - 4);
            if ( *(void **)v275 != v161 )
            {
              do
              {
                v162 = *(_DWORD *)v161;
                v163 = *(_DWORD *)v161 - 12;
                if ( (_DWORD *)v163 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v227 = _InterlockedExchangeAdd((volatile signed __int32 *)(v162 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v229 = *(_DWORD *)(v162 - 4);
                    *(_DWORD *)(v162 - 4) = v229 - 1;
                    v227 = v229;
                  }
                  if ( v227 <= 0 )
                    std::string::_Rep::_M_destroy(v163, &v309);
                }
                v161 = (char *)v161 + 4;
              }
              while ( v160 != v161 );
              v160 = (void *)*((_DWORD *)v290 + 6);
            }
            if ( v160 )
              operator delete(v160);
            v164 = *(_DWORD *)((char *)v298 + v153 + 20);
            if ( (_DWORD *)(v164 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v226 = _InterlockedExchangeAdd((volatile signed __int32 *)(v164 - 4), 0xFFFFFFFF);
              }
              else
              {
                v226 = *(_DWORD *)(v164 - 4);
                *(_DWORD *)(v164 - 4) = v226 - 1;
              }
              if ( v226 <= 0 )
                std::string::_Rep::_M_destroy(v164 - 12, &v309);
            }
            v165 = *(_DWORD *)((char *)v298 + v153 + 8);
            if ( (_DWORD *)(v165 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v225 = _InterlockedExchangeAdd((volatile signed __int32 *)(v165 - 4), 0xFFFFFFFF);
              }
              else
              {
                v225 = *(_DWORD *)(v165 - 4);
                *(_DWORD *)(v165 - 4) = v225 - 1;
              }
              if ( v225 <= 0 )
                std::string::_Rep::_M_destroy(v165 - 12, &v309);
            }
            v290 = (std::locale *)((char *)v290 + 64);
            v275 += 64;
            v283 += 64;
          }
          while ( v266 != v290 );
        }
        if ( v298 )
          operator delete((void *)v298);
        v299 = *(std::locale **)(a3 + 40);
        v166 = *(_DWORD *)(a3 + 40);
        v267 = *(std::locale **)(a3 + 44);
        v167 = *(_DWORD *)(a3 + 44);
        *(_DWORD *)(a3 + 40) = v319;
        v319 = 0;
        *(_DWORD *)(a3 + 44) = v320;
        v320 = 0;
        *(_DWORD *)(a3 + 48) = v321;
        v321 = 0;
        if ( v166 != v167 )
        {
          v284 = (int)((char *)v299 + 28);
          v276 = (int)((char *)v299 + 48);
          v291 = v299;
          do
          {
            v168 = v291 - v299;
            v169 = *(_DWORD *)((char *)v299 + v291 - v299 + 60);
            if ( v169 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v169 + 4));
              if ( !v169 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v170 = *(_DWORD *)((char *)v299 + v168 + 56);
            if ( v170 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v170 + 4));
              if ( !v170 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v171 = *(void **)v276;
            v172 = *(void **)(v276 - 4);
            if ( *(void **)v276 != v172 )
            {
              do
              {
                v173 = *(_DWORD *)v172;
                v174 = *(_DWORD *)v172 - 12;
                if ( (_DWORD *)v174 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v222 = _InterlockedExchangeAdd((volatile signed __int32 *)(v173 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v224 = *(_DWORD *)(v173 - 4);
                    *(_DWORD *)(v173 - 4) = v224 - 1;
                    v222 = v224;
                  }
                  if ( v222 <= 0 )
                    std::string::_Rep::_M_destroy(v174, &v309);
                }
                v172 = (char *)v172 + 4;
              }
              while ( v171 != v172 );
              v171 = (void *)*((_DWORD *)v291 + 11);
            }
            if ( v171 )
              operator delete(v171);
            v175 = *(void **)v284;
            v176 = *(void **)(v284 - 4);
            if ( *(void **)v284 != v176 )
            {
              do
              {
                v177 = *(_DWORD *)v176;
                v178 = *(_DWORD *)v176 - 12;
                if ( (_DWORD *)v178 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v221 = _InterlockedExchangeAdd((volatile signed __int32 *)(v177 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v223 = *(_DWORD *)(v177 - 4);
                    *(_DWORD *)(v177 - 4) = v223 - 1;
                    v221 = v223;
                  }
                  if ( v221 <= 0 )
                    std::string::_Rep::_M_destroy(v178, &v309);
                }
                v176 = (char *)v176 + 4;
              }
              while ( v175 != v176 );
              v175 = (void *)*((_DWORD *)v291 + 6);
            }
            if ( v175 )
              operator delete(v175);
            v179 = *(_DWORD *)((char *)v299 + v168 + 20);
            if ( (_DWORD *)(v179 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v220 = _InterlockedExchangeAdd((volatile signed __int32 *)(v179 - 4), 0xFFFFFFFF);
              }
              else
              {
                v220 = *(_DWORD *)(v179 - 4);
                *(_DWORD *)(v179 - 4) = v220 - 1;
              }
              if ( v220 <= 0 )
                std::string::_Rep::_M_destroy(v179 - 12, &v309);
            }
            v180 = *(_DWORD *)((char *)v299 + v168 + 8);
            if ( (_DWORD *)(v180 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v219 = _InterlockedExchangeAdd((volatile signed __int32 *)(v180 - 4), 0xFFFFFFFF);
              }
              else
              {
                v219 = *(_DWORD *)(v180 - 4);
                *(_DWORD *)(v180 - 4) = v219 - 1;
              }
              if ( v219 <= 0 )
                std::string::_Rep::_M_destroy(v180 - 12, &v309);
            }
            v291 = (std::locale *)((char *)v291 + 64);
            v284 += 64;
            v276 += 64;
          }
          while ( v267 != v291 );
        }
        if ( v299 )
          operator delete((void *)v299);
        *(_DWORD *)(a3 + 52) = v322;
        return sub_8057220(v305);
      }
      v201 = (std::locale *)(v144 >> 10);
      v305 = (int)&v312;
      std::ios_base::ios_base((std::ios_base *)&v323);
      v323 = &unk_80CF5C8;
      v328 = 0;
      v329 = 0;
      v330 = 0;
      v331 = 0;
      v332 = 0;
      v333 = 0;
      v334 = 0;
      v312 = dword_80CF674;
      *(int *)((char *)&v312 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v312 + *(_DWORD *)(v312 - 12), 0);
      v312 = (int)&unk_80CF5DC;
      v323 = &unk_80CF5F0;
      v313 = (int)&unk_80CF7F0;
      v314 = 0;
      v315 = 0;
      v316 = 0;
      v317 = 0;
      v318 = 0;
      v319 = 0;
      std::locale::locale((std::locale *)&v320);
      v313 = (int)&unk_80CF588;
      v321 = 16;
      v322 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v323, &v313);
      v202 = std::__ostream_insert<char,std::char_traits<char>>(
               &v312,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v202, "partial result with ", 20);
      v203 = std::ostream::_M_insert<unsigned long>(v202, v281);
      std::__ostream_insert<char,std::char_traits<char>>(v203, " details. ", 10);
      std::__ostream_insert<char,std::char_traits<char>>(v203, "max report size: ", 17);
      v204 = std::ostream::_M_insert<unsigned long>(v203, v143 >> 10);
      std::__ostream_insert<char,std::char_traits<char>>(v204, " KB, ", 5);
      std::__ostream_insert<char,std::char_traits<char>>(v204, " estimated report size: ", 24);
      v205 = std::ostream::_M_insert<unsigned long>(v204, v201);
      std::__ostream_insert<char,std::char_traits<char>>(v205, " KB ", 4);
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v309, v205 + 4);
      v312 = (int)&unk_80CF5DC;
      v323 = &unk_80CF5F0;
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf((int)&v313);
      v312 = dword_80CF674;
      *(int *)((char *)&v312 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v323 = &unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v323);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v312);
      if ( !byte_80CE64C )
      {
LABEL_323:
        syslog(6, "%s", v309, v260);
        std::string::_Rep::_M_dispose(v309 - 12, &v312);
        goto LABEL_203;
      }
      v206 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v309, *(_DWORD *)(v309 - 12));
      v207 = (std::ostream *)v206;
      v208 = *(_DWORD *)(v206 + *(_DWORD *)(*(_DWORD *)v206 - 12) + 124);
      if ( v208 )
      {
        v209 = sub_8056FF0(v208, 0xAu);
        v210 = (std::ostream *)std::ostream::put(v207, v209);
        std::ostream::flush(v210);
        goto LABEL_323;
      }
      v212 = std::__throw_bad_cast();
      std::string::_Rep::_M_dispose(v309 - 12, &v312);
LABEL_327:
      Unwind_Resume(v212);
    }
    if ( log_level > 2 )
      goto LABEL_130;
    v181 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)a2 + 32) + 8);
    v302 = &v312;
    std::ios_base::ios_base((std::ios_base *)&v323);
    v323 = &unk_80CF5C8;
    v328 = 0;
    v329 = 0;
    v330 = 0;
    v331 = 0;
    v332 = 0;
    v333 = 0;
    v334 = 0;
    v312 = dword_80CF674;
    *(int *)((char *)&v312 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v312 + *(_DWORD *)(v312 - 12), 0);
    v312 = (int)&unk_80CF5DC;
    v323 = &unk_80CF5F0;
    v313 = (int)&unk_80CF7F0;
    v314 = 0;
    v315 = 0;
    v316 = 0;
    v317 = 0;
    v318 = 0;
    v319 = 0;
    v293 = (std::locale *)&v320;
    std::locale::locale((std::locale *)&v320);
    v313 = (int)&unk_80CF588;
    v321 = 16;
    v322 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v323, &v313);
    v182 = std::__ostream_insert<char,std::char_traits<char>>(
             &v312,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v182, "suit done: ", 11);
    v183 = std::ostream::operator<<(v182, v181);
    v309 = (int)&unk_80CF83C;
    v184 = *(_DWORD *)(v183 + 24);
    if ( v184 )
    {
      v185 = *(_DWORD *)(v183 + 16);
      LOBYTE(v260) = 0;
      if ( v184 <= (unsigned int)v185 )
      {
        v310 = std::string::_S_construct<char *>((int)&v308, v3, &v323, *(_DWORD *)(v183 + 20), v185, (int)&v308);
        std::string::swap((std::string *)&v309, (std::string *)&v310);
      }
      else
      {
        v310 = std::string::_S_construct<char *>((int)&v308, v3, &v323, *(_DWORD *)(v183 + 20), v184, (int)&v308);
        std::string::swap((std::string *)&v309, (std::string *)&v310);
      }
      std::string::_Rep::_M_dispose(v310 - 12, &v307);
    }
    else
    {
      std::string::assign((std::string *)&v309, (const std::string *)(v183 + 40));
    }
    v312 = (int)&unk_80CF5DC;
    v323 = &unk_80CF5F0;
    v313 = (int)&unk_80CF588;
    v186 = v322 - 12;
    if ( (_DWORD *)(v322 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v231 = _InterlockedExchangeAdd((volatile signed __int32 *)(v322 - 4), 0xFFFFFFFF);
      }
      else
      {
        v231 = *(_DWORD *)(v322 - 4);
        *(_DWORD *)(v322 - 4) = v231 - 1;
      }
      if ( v231 <= 0 )
        std::string::_Rep::_M_destroy(v186, &v310);
    }
    v313 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v320);
    v312 = dword_80CF674;
    *(int *)((char *)&v312 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v323 = &unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v323);
    if ( !byte_80CE64C )
      goto LABEL_274;
    v187 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v309, *(_DWORD *)(v309 - 12));
    v90 = (void *)v187;
    v188 = *(_DWORD *)(*(_DWORD *)v187 - 12);
    v91 = *(_DWORD *)((char *)v90 + v188 + 124);
    if ( v91 )
      break;
    v92 = std::__throw_bad_cast();
LABEL_393:
    v235 = *(_DWORD *)(v92 - 4);
    *(_DWORD *)(v92 - 4) = v235 - 1;
    v200 = v235;
LABEL_316:
    if ( v200 <= 0 )
      std::string::_Rep::_M_destroy(v93, &v312);
    while ( 1 )
    {
      v91 += 4;
      if ( v90 == (void *)v91 )
        break;
LABEL_109:
      v92 = *(_DWORD *)v91;
      v93 = *(_DWORD *)v91 - 12;
      if ( (_DWORD *)v93 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( !&_pthread_key_create )
          goto LABEL_393;
        v200 = _InterlockedExchangeAdd((volatile signed __int32 *)(v92 - 4), 0xFFFFFFFF);
        goto LABEL_316;
      }
    }
    v88 = v273;
    v90 = *(void **)((char *)v293 + v273 + 44);
    while ( 1 )
    {
      if ( v90 )
        operator delete(v90);
      v94 = *(void **)v277;
      v95 = *(void **)(v277 - 4);
      if ( *(void **)v277 != v95 )
      {
        v273 = v88;
        do
        {
          v96 = *(_DWORD *)v95;
          v97 = *(_DWORD *)v95 - 12;
          if ( (_DWORD *)v97 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v197 = _InterlockedExchangeAdd((volatile signed __int32 *)(v96 - 4), 0xFFFFFFFF);
            }
            else
            {
              v213 = *(_DWORD *)(v96 - 4);
              *(_DWORD *)(v96 - 4) = v213 - 1;
              v197 = v213;
            }
            if ( v197 <= 0 )
              std::string::_Rep::_M_destroy(v97, &v312);
          }
          v95 = (char *)v95 + 4;
        }
        while ( v94 != v95 );
        v94 = *(void **)((char *)v293 + v88 + 24);
      }
      if ( v94 )
        operator delete(v94);
      v98 = *(_DWORD *)(v88 + v264);
      v99 = v98 - 12;
      if ( (_DWORD *)(v98 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v236 = _InterlockedExchangeAdd((volatile signed __int32 *)(v98 - 4), 0xFFFFFFFF);
        }
        else
        {
          v239 = *(_DWORD *)(v98 - 4);
          *(_DWORD *)(v98 - 4) = v239 - 1;
          v236 = v239;
        }
        if ( v236 <= 0 )
          std::string::_Rep::_M_destroy(v99, &v312);
      }
      v100 = *(_DWORD *)(v88 + v265);
      if ( (_DWORD *)(v100 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v241 = _InterlockedExchangeAdd((volatile signed __int32 *)(v100 - 4), 0xFFFFFFFF);
        }
        else
        {
          v241 = *(_DWORD *)(v100 - 4);
          *(_DWORD *)(v100 - 4) = v241 - 1;
        }
        if ( v241 <= 0 )
          std::string::_Rep::_M_destroy(v100 - 12, &v312);
      }
      v302 += 15;
      v277 += 60;
      v285 += 60;
      if ( v268 == v302 )
        break;
LABEL_104:
      v88 = (char *)v302 - (char *)v293;
      v89 = *(_DWORD *)((char *)v302 - (char *)v293 + v263);
      if ( v89 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v89 + 4));
        if ( !v89 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v90 = *(void **)v285;
      v91 = *(_DWORD *)(v285 - 4);
      if ( *(_DWORD *)v285 != v91 )
      {
        v273 = (char *)v302 - (char *)v293;
        goto LABEL_109;
      }
    }
    v268 = (void *)*((_DWORD *)v261 + 6);
  }
  if ( *(_BYTE *)(v91 + 28) )
  {
    v189 = *(_BYTE *)(v91 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v90 + v188 + 124));
    v189 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v91 + 24))(v91, 10);
  }
  v190 = (std::ostream *)std::ostream::put((std::ostream *)v90, v189);
  std::ostream::flush(v190);
LABEL_274:
  syslog(6, "%s", v309, v260);
  v191 = v309 - 12;
  if ( (_DWORD *)(v309 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v192 = _InterlockedExchangeAdd((volatile signed __int32 *)(v309 - 4), 0xFFFFFFFF);
    }
    else
    {
      v192 = *(_DWORD *)(v309 - 4);
      *(_DWORD *)(v309 - 4) = v192 - 1;
    }
    if ( v192 <= 0 )
      std::string::_Rep::_M_destroy(v191, &v312);
  }
LABEL_130:
  if ( *(_DWORD *)(a3 + 64) )
  {
    *(_BYTE *)(a3 + 17) = 1;
    sub_8058470(a3 + 56, a3 + 12);
  }
  return sub_8051490(mutex, *(_DWORD *)a2 + 32);
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF84C: using guessed type int dword_80CF84C;
// 80CF850: using guessed type int dword_80CF850;
// 80CF874: using guessed type int log_level;

//----- (08055FC0) --------------------------------------------------------
char __usercall sub_8055FC0@<al>(std::ios_base *a1@<esi>, pthread_mutex_t *mutex, int a3, int a4)
{
  int v4; // eax@1
  int v5; // eax@3
  int v6; // eax@8
  int v7; // edx@11
  bool v8; // zf@11
  volatile signed __int32 *v9; // ebx@12
  int v10; // eax@18
  bool v11; // zf@18
  void *v12; // esi@20
  void *v13; // ebx@20
  int v14; // eax@21
  int v15; // edx@21
  void *v16; // esi@26
  void *v17; // ebx@26
  int v18; // eax@27
  int v19; // edx@27
  int v20; // edx@32
  int v21; // edx@33
  signed __int32 v22; // ecx@35
  int v23; // eax@39
  bool v24; // zf@39
  void *v25; // esi@41
  void *v26; // ebx@41
  int v27; // eax@42
  int v28; // edx@42
  void *v29; // esi@47
  void *v30; // ebx@47
  int v31; // eax@48
  int v32; // edx@48
  int v33; // edx@53
  int v34; // edx@54
  signed __int32 v35; // ecx@56
  int v36; // eax@63
  int v37; // edi@63
  void *v38; // eax@64
  int v39; // edi@66
  int v40; // eax@66
  void *v41; // esi@69
  void *v42; // ebx@69
  int v43; // eax@70
  int v44; // edx@70
  void *v45; // esi@75
  void *v46; // ebx@75
  int v47; // eax@76
  int v48; // edx@76
  int v49; // eax@81
  int v50; // edx@81
  int v51; // eax@82
  void *v52; // eax@87
  int v53; // edi@89
  int v54; // eax@89
  void *v55; // esi@92
  void *v56; // ebx@92
  int v57; // eax@93
  int v58; // edx@93
  void *v59; // esi@98
  void *v60; // ebx@98
  int v61; // eax@99
  int v62; // edx@99
  int v63; // eax@104
  int v64; // edx@104
  int v65; // eax@105
  signed __int32 v66; // eax@113
  signed __int32 v67; // eax@117
  signed __int32 v68; // eax@121
  signed __int32 v69; // eax@125
  signed __int32 v70; // eax@129
  signed __int32 v71; // eax@133
  signed __int32 v72; // eax@137
  signed __int32 v73; // eax@141
  signed __int32 v74; // ecx@144
  signed __int32 v75; // ecx@145
  signed __int32 v76; // eax@147
  signed __int32 v77; // ecx@150
  signed __int32 v78; // ebx@151
  signed __int32 v79; // ecx@154
  signed __int32 v80; // ecx@160
  signed __int32 v81; // ecx@163
  signed __int32 v82; // ebx@166
  signed __int32 v83; // eax@170
  signed __int32 v84; // ebx@174
  signed __int32 v85; // ecx@175
  signed __int32 v86; // ecx@176
  signed __int32 v87; // ebx@178
  signed __int32 v88; // ecx@182
  signed __int32 v89; // ecx@183
  void *v91; // [sp+10h] [bp-C8h]@63
  int v92; // [sp+14h] [bp-C4h]@65
  int v93; // [sp+14h] [bp-C4h]@88
  int v94; // [sp+18h] [bp-C0h]@65
  int v95; // [sp+18h] [bp-C0h]@88
  int v96; // [sp+1Ch] [bp-BCh]@65
  int v97; // [sp+1Ch] [bp-BCh]@88
  void *v98; // [sp+20h] [bp-B8h]@64
  void *v99; // [sp+20h] [bp-B8h]@87
  int v100; // [sp+28h] [bp-B0h]@65
  int v101; // [sp+28h] [bp-B0h]@88
  int v102; // [sp+2Ch] [bp-ACh]@65
  int v103; // [sp+2Ch] [bp-ACh]@88
  void *v104; // [sp+30h] [bp-A8h]@64
  void *v105; // [sp+30h] [bp-A8h]@87
  int v106; // [sp+34h] [bp-A4h]@65
  int v107; // [sp+34h] [bp-A4h]@88
  int v108; // [sp+38h] [bp-A0h]@3
  int v109; // [sp+3Ch] [bp-9Ch]@1
  char v110; // [sp+48h] [bp-90h]@37
  int v111; // [sp+50h] [bp-88h]@54
  int v112; // [sp+5Ch] [bp-7Ch]@53
  void *v113; // [sp+60h] [bp-78h]@47
  void *v114; // [sp+64h] [bp-74h]@47
  void *v115; // [sp+74h] [bp-64h]@41
  void *v116; // [sp+78h] [bp-60h]@41
  int v117; // [sp+80h] [bp-58h]@39
  int v118; // [sp+84h] [bp-54h]@12
  int v119; // [sp+8Ch] [bp-4Ch]@33
  int v120; // [sp+98h] [bp-40h]@32
  void *v121; // [sp+9Ch] [bp-3Ch]@26
  void *v122; // [sp+A0h] [bp-38h]@26
  void *v123; // [sp+B0h] [bp-28h]@20
  void *v124; // [sp+B4h] [bp-24h]@20
  int v125; // [sp+BCh] [bp-1Ch]@18

  v4 = *(_DWORD *)(a3 + 24);
  v109 = v4;
  if ( v4 )
    _InterlockedIncrement((volatile signed __int32 *)(v4 + 4));
  LOBYTE(v5) = sub_8050BF0(v4, a1, mutex, v4 + 32);
  v108 = v5;
  if ( v5 )
  {
    if ( !*(_DWORD *)(v109 + 40) )
    {
      v36 = operator new(0x30u);
      *(_DWORD *)v36 = *(_DWORD *)(*(_DWORD *)(v109 + 32) + 48);
      *(_DWORD *)(v36 + 4) = 0;
      *(_DWORD *)(v36 + 8) = 0;
      *(_DWORD *)(v36 + 12) = 0;
      *(_DWORD *)(v36 + 16) = 0;
      *(_DWORD *)(v36 + 20) = 0;
      *(_DWORD *)(v36 + 24) = 0;
      *(_DWORD *)(v36 + 28) = 0;
      *(_DWORD *)(v36 + 32) = 0;
      *(_DWORD *)(v36 + 36) = 0;
      *(_DWORD *)(v36 + 40) = 0;
      *(_DWORD *)(v36 + 44) = 0;
      v91 = *(void **)(v109 + 40);
      v37 = *(_DWORD *)(v109 + 40);
      *(_DWORD *)(v109 + 40) = v36;
      if ( v37 )
      {
        v98 = *(void **)(v37 + 40);
        v38 = *(void **)(v37 + 36);
        v104 = v38;
        if ( v98 != v38 )
        {
          v102 = (int)((char *)v38 + 28);
          v100 = (int)((char *)v38 + 48);
          v106 = *(_DWORD *)(v37 + 36);
          v92 = (int)((char *)v38 + 56);
          v94 = (int)((char *)v38 + 20);
          v96 = (int)((char *)v38 + 8);
          do
          {
            v39 = v106 - (_DWORD)v104;
            v40 = *(_DWORD *)(v106 - (_DWORD)v104 + v92);
            if ( v40 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v40 + 4));
              if ( !v40 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v41 = *(void **)v100;
            v42 = *(void **)(v100 - 4);
            if ( *(void **)v100 != v42 )
            {
              do
              {
                v43 = *(_DWORD *)v42;
                v44 = *(_DWORD *)v42 - 12;
                if ( (_DWORD *)v44 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v69 = _InterlockedExchangeAdd((volatile signed __int32 *)(v43 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v77 = *(_DWORD *)(v43 - 4);
                    *(_DWORD *)(v43 - 4) = v77 - 1;
                    v69 = v77;
                  }
                  if ( v69 <= 0 )
                    std::string::_Rep::_M_destroy(v44, &v118);
                }
                v42 = (char *)v42 + 4;
              }
              while ( v41 != v42 );
              v41 = *(void **)(v106 + 44);
            }
            if ( v41 )
              operator delete(v41);
            v45 = *(void **)v102;
            v46 = *(void **)(v102 - 4);
            if ( *(void **)v102 != v46 )
            {
              do
              {
                v47 = *(_DWORD *)v46;
                v48 = *(_DWORD *)v46 - 12;
                if ( (_DWORD *)v48 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v68 = _InterlockedExchangeAdd((volatile signed __int32 *)(v47 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v86 = *(_DWORD *)(v47 - 4);
                    *(_DWORD *)(v47 - 4) = v86 - 1;
                    v68 = v86;
                  }
                  if ( v68 <= 0 )
                    std::string::_Rep::_M_destroy(v48, &v118);
                }
                v46 = (char *)v46 + 4;
              }
              while ( v45 != v46 );
              v45 = *(void **)(v106 + 24);
            }
            if ( v45 )
              operator delete(v45);
            v49 = *(_DWORD *)(v39 + v94);
            v50 = v49 - 12;
            if ( (_DWORD *)(v49 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v83 = _InterlockedExchangeAdd((volatile signed __int32 *)(v49 - 4), 0xFFFFFFFF);
              }
              else
              {
                v84 = *(_DWORD *)(v49 - 4);
                *(_DWORD *)(v49 - 4) = v84 - 1;
                v83 = v84;
              }
              if ( v83 <= 0 )
                std::string::_Rep::_M_destroy(v50, &v118);
            }
            v51 = *(_DWORD *)(v39 + v96);
            if ( (_DWORD *)(v51 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v82 = _InterlockedExchangeAdd((volatile signed __int32 *)(v51 - 4), 0xFFFFFFFF);
              }
              else
              {
                v82 = *(_DWORD *)(v51 - 4);
                *(_DWORD *)(v51 - 4) = v82 - 1;
              }
              if ( v82 <= 0 )
                std::string::_Rep::_M_destroy(v51 - 12, &v118);
            }
            v106 += 60;
            v102 += 60;
            v100 += 60;
          }
          while ( v98 != (void *)v106 );
          v98 = (void *)*((_DWORD *)v91 + 9);
        }
        if ( v98 )
          operator delete(v98);
        v99 = (void *)*((_DWORD *)v91 + 7);
        v52 = (void *)*((_DWORD *)v91 + 6);
        v105 = v52;
        if ( v99 != v52 )
        {
          v103 = (int)((char *)v52 + 28);
          v101 = (int)((char *)v52 + 48);
          v107 = *((_DWORD *)v91 + 6);
          v93 = (int)((char *)v52 + 56);
          v95 = (int)((char *)v52 + 20);
          v97 = (int)((char *)v52 + 8);
          do
          {
            v53 = v107 - (_DWORD)v105;
            v54 = *(_DWORD *)(v107 - (_DWORD)v105 + v93);
            if ( v54 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v54 + 4));
              if ( !v54 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v55 = *(void **)v101;
            v56 = *(void **)(v101 - 4);
            if ( *(void **)v101 != v56 )
            {
              do
              {
                v57 = *(_DWORD *)v56;
                v58 = *(_DWORD *)v56 - 12;
                if ( (_DWORD *)v58 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v67 = _InterlockedExchangeAdd((volatile signed __int32 *)(v57 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v85 = *(_DWORD *)(v57 - 4);
                    *(_DWORD *)(v57 - 4) = v85 - 1;
                    v67 = v85;
                  }
                  if ( v67 <= 0 )
                    std::string::_Rep::_M_destroy(v58, &v118);
                }
                v56 = (char *)v56 + 4;
              }
              while ( v55 != v56 );
              v55 = *(void **)(v107 + 44);
            }
            if ( v55 )
              operator delete(v55);
            v59 = *(void **)v103;
            v60 = *(void **)(v103 - 4);
            if ( *(void **)v103 != v60 )
            {
              do
              {
                v61 = *(_DWORD *)v60;
                v62 = *(_DWORD *)v60 - 12;
                if ( (_DWORD *)v62 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v66 = _InterlockedExchangeAdd((volatile signed __int32 *)(v61 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v74 = *(_DWORD *)(v61 - 4);
                    *(_DWORD *)(v61 - 4) = v74 - 1;
                    v66 = v74;
                  }
                  if ( v66 <= 0 )
                    std::string::_Rep::_M_destroy(v62, &v118);
                }
                v60 = (char *)v60 + 4;
              }
              while ( v59 != v60 );
              v59 = *(void **)(v107 + 24);
            }
            if ( v59 )
              operator delete(v59);
            v63 = *(_DWORD *)(v53 + v95);
            v64 = v63 - 12;
            if ( (_DWORD *)(v63 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v76 = _InterlockedExchangeAdd((volatile signed __int32 *)(v63 - 4), 0xFFFFFFFF);
              }
              else
              {
                v78 = *(_DWORD *)(v63 - 4);
                *(_DWORD *)(v63 - 4) = v78 - 1;
                v76 = v78;
              }
              if ( v76 <= 0 )
                std::string::_Rep::_M_destroy(v64, &v118);
            }
            v65 = *(_DWORD *)(v53 + v97);
            if ( (_DWORD *)(v65 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v87 = _InterlockedExchangeAdd((volatile signed __int32 *)(v65 - 4), 0xFFFFFFFF);
              }
              else
              {
                v87 = *(_DWORD *)(v65 - 4);
                *(_DWORD *)(v65 - 4) = v87 - 1;
              }
              if ( v87 <= 0 )
                std::string::_Rep::_M_destroy(v65 - 12, &v118);
            }
            v107 += 60;
            v103 += 60;
            v101 += 60;
          }
          while ( v99 != (void *)v107 );
          v99 = (void *)*((_DWORD *)v91 + 6);
        }
        if ( v99 )
          operator delete(v99);
        operator delete(v91);
      }
    }
    if ( a4 != 1 )
    {
      if ( a4 < 1 || (unsigned int)(a4 - 4) > 2 )
      {
        *(_DWORD *)(*(_DWORD *)(v109 + 40) + 12) = 2;
        sub_804F340((int)&v118, a3, a4);
        sub_8059130(*(_DWORD *)(v109 + 40) + 36, (int)&v118);
        v10 = v125;
        v11 = v125 == 0;
        if ( v125 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v125 + 4));
          if ( v11 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v10 + 4))(v10);
        }
        v12 = v124;
        v13 = v123;
        if ( v124 != v123 )
        {
          do
          {
            v14 = *(_DWORD *)v13;
            v15 = *(_DWORD *)v13 - 12;
            if ( (_DWORD *)v15 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v70 = _InterlockedExchangeAdd((volatile signed __int32 *)(v14 - 4), 0xFFFFFFFF);
              }
              else
              {
                v81 = *(_DWORD *)(v14 - 4);
                *(_DWORD *)(v14 - 4) = v81 - 1;
                v70 = v81;
              }
              if ( v70 <= 0 )
                std::string::_Rep::_M_destroy(v15, &v110);
            }
            v13 = (char *)v13 + 4;
          }
          while ( v12 != v13 );
          v12 = v123;
        }
        if ( v12 )
          operator delete(v12);
        v16 = v122;
        v17 = v121;
        if ( v122 != v121 )
        {
          do
          {
            v18 = *(_DWORD *)v17;
            v19 = *(_DWORD *)v17 - 12;
            if ( (_DWORD *)v19 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v71 = _InterlockedExchangeAdd((volatile signed __int32 *)(v18 - 4), 0xFFFFFFFF);
              }
              else
              {
                v88 = *(_DWORD *)(v18 - 4);
                *(_DWORD *)(v18 - 4) = v88 - 1;
                v71 = v88;
              }
              if ( v71 <= 0 )
                std::string::_Rep::_M_destroy(v19, &v110);
            }
            v17 = (char *)v17 + 4;
          }
          while ( v16 != v17 );
          v16 = v121;
        }
        if ( v16 )
          operator delete(v16);
        v20 = v120 - 12;
        if ( (_DWORD *)(v120 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v80 = _InterlockedExchangeAdd((volatile signed __int32 *)(v120 - 4), 0xFFFFFFFF);
          }
          else
          {
            v80 = *(_DWORD *)(v120 - 4);
            *(_DWORD *)(v120 - 4) = v80 - 1;
          }
          if ( v80 <= 0 )
            std::string::_Rep::_M_destroy(v20, &v110);
        }
        v21 = v119 - 12;
        if ( (_DWORD *)(v119 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v22 = _InterlockedExchangeAdd((volatile signed __int32 *)(v119 - 4), 0xFFFFFFFF);
          }
          else
          {
            v22 = *(_DWORD *)(v119 - 4);
            *(_DWORD *)(v119 - 4) = v22 - 1;
          }
          if ( v22 <= 0 )
            std::string::_Rep::_M_destroy(v21, &v110);
        }
      }
      else
      {
        v6 = *(_DWORD *)(v109 + 40);
        if ( !*(_DWORD *)(v6 + 12) )
          *(_DWORD *)(v6 + 12) = 1;
        if ( *(_BYTE *)(*(_DWORD *)(v109 + 32) + 36) )
        {
          sub_804F340((int)&v110, a3, a4);
          sub_8059130(*(_DWORD *)(v109 + 40) + 24, (int)&v110);
          v23 = v117;
          v24 = v117 == 0;
          if ( v117 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v117 + 4));
            if ( v24 )
              (*(void (__cdecl **)(int))(*(_DWORD *)v23 + 4))(v23);
          }
          v25 = v116;
          v26 = v115;
          if ( v116 != v115 )
          {
            do
            {
              v27 = *(_DWORD *)v26;
              v28 = *(_DWORD *)v26 - 12;
              if ( (_DWORD *)v28 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v73 = _InterlockedExchangeAdd((volatile signed __int32 *)(v27 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v75 = *(_DWORD *)(v27 - 4);
                  *(_DWORD *)(v27 - 4) = v75 - 1;
                  v73 = v75;
                }
                if ( v73 <= 0 )
                  std::string::_Rep::_M_destroy(v28, &v118);
              }
              v26 = (char *)v26 + 4;
            }
            while ( v25 != v26 );
            v25 = v115;
          }
          if ( v25 )
            operator delete(v25);
          v29 = v114;
          v30 = v113;
          if ( v114 != v113 )
          {
            do
            {
              v31 = *(_DWORD *)v30;
              v32 = *(_DWORD *)v30 - 12;
              if ( (_DWORD *)v32 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v72 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v89 = *(_DWORD *)(v31 - 4);
                  *(_DWORD *)(v31 - 4) = v89 - 1;
                  v72 = v89;
                }
                if ( v72 <= 0 )
                  std::string::_Rep::_M_destroy(v32, &v118);
              }
              v30 = (char *)v30 + 4;
            }
            while ( v29 != v30 );
            v29 = v113;
          }
          if ( v29 )
            operator delete(v29);
          v33 = v112 - 12;
          if ( (_DWORD *)(v112 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v79 = _InterlockedExchangeAdd((volatile signed __int32 *)(v112 - 4), 0xFFFFFFFF);
            }
            else
            {
              v79 = *(_DWORD *)(v112 - 4);
              *(_DWORD *)(v112 - 4) = v79 - 1;
            }
            if ( v79 <= 0 )
              std::string::_Rep::_M_destroy(v33, &v118);
          }
          v34 = v111 - 12;
          if ( (_DWORD *)(v111 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v35 = _InterlockedExchangeAdd((volatile signed __int32 *)(v111 - 4), 0xFFFFFFFF);
            }
            else
            {
              v35 = *(_DWORD *)(v111 - 4);
              *(_DWORD *)(v111 - 4) = v35 - 1;
            }
            if ( v35 <= 0 )
              std::string::_Rep::_M_destroy(v34, &v118);
          }
        }
      }
    }
    LOBYTE(v5) = v109;
    v7 = *(_DWORD *)(v109 + 36);
    v8 = v7 == 0;
    if ( v7 )
    {
      v9 = (volatile signed __int32 *)(v109 + 4);
    }
    else
    {
      v118 = v109;
      v9 = (volatile signed __int32 *)(v109 + 4);
      _InterlockedIncrement((volatile signed __int32 *)(v109 + 4));
      sub_80531C0(mutex, (int)&v118, v108);
      v5 = v118;
      v8 = v118 == 0;
      if ( v118 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v118 + 4));
        if ( v8 )
          LOBYTE(v5) = (*(int (__cdecl **)(int))(*(_DWORD *)v5 + 4))(v5);
      }
    }
    _InterlockedDecrement(v9);
    if ( v8 )
      goto LABEL_16;
  }
  else if ( v109 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v109 + 4));
    if ( !v109 )
    {
LABEL_16:
      LOBYTE(v5) = (*(int (__cdecl **)(int))(*(_DWORD *)v109 + 4))(v109);
      return v5;
    }
  }
  return v5;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08056B10) --------------------------------------------------------
int __usercall sub_8056B10@<eax>(std::ios_base *a1@<esi>, pthread_mutex_t ***a2, int a3, int *a4)
{
  pthread_mutex_t **v4; // ebx@1
  int result; // eax@1
  pthread_mutex_t *v6; // esi@3
  int v7; // eax@3
  int v8; // esi@3
  int v9; // eax@3
  int v10; // ebx@3
  int (__cdecl *v11)(void **, void **, signed int); // eax@3
  int v12; // [sp+28h] [bp-24h]@5
  int v13; // [sp+2Ch] [bp-20h]@5
  int v14; // [sp+30h] [bp-1Ch]@3
  int (__cdecl *v15)(void **, void **, signed int); // [sp+38h] [bp-14h]@3
  int v16; // [sp+3Ch] [bp-10h]@3

  v4 = *a2;
  sub_8055FC0(a1, **a2, a3, *a4);
  result = (int)*v4;
  if ( !(*v4)[3].__size[8] )
  {
    *(_BYTE *)(result + 80) = 1;
    v6 = *v4;
    v7 = operator new(4u);
    *(_DWORD *)v7 = v6;
    v14 = v7;
    v16 = (int)&loc_80518B0;
    v15 = sub_804E1C0;
    v8 = *(_DWORD *)((*v4)[3].__count + 12);
    v9 = operator new(0x10u);
    v10 = v9;
    *(_DWORD *)(v9 + 8) = 0;
    v11 = v15;
    if ( v15 )
    {
      *(_DWORD *)(v10 + 12) = v16;
      *(_DWORD *)(v10 + 8) = v11;
      v15((void **)v10, (void **)&v14, 2);
    }
    v12 = 0;
    v13 = 0;
    event_base_once(*(_DWORD *)(v8 + 4), -1, 1, sub_8057E00, v10, &v12);
    result = (int)v15;
    if ( v15 )
      result = v15((void **)&v14, (void **)&v14, 3);
  }
  return result;
}
// 804D310: using guessed type int __cdecl event_base_once(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (08056CA0) --------------------------------------------------------
int __cdecl sub_8056CA0(int a1)
{
  int result; // eax@1
  int v2; // edx@1
  int v3; // edx@2

  result = a1;
  *(_DWORD *)a1 = &off_80B94F0;
  v2 = *(_DWORD *)(a1 + 4);
  if ( v2 )
  {
    *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 8);
    v3 = *(_DWORD *)(a1 + 8);
    if ( !v3 )
    {
LABEL_4:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_3:
    *(_DWORD *)(v3 + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_4;
  }
  v3 = *(_DWORD *)(a1 + 8);
  if ( v3 )
    goto LABEL_3;
  return result;
}
// 80B94F0: using guessed type int (__cdecl *off_80B94F0)(int);

//----- (08056CF0) --------------------------------------------------------
int __cdecl sub_8056CF0(int a1)
{
  int result; // eax@1
  int v2; // edx@1
  int v3; // edx@2

  result = a1;
  *(_DWORD *)a1 = &off_80B9500;
  v2 = *(_DWORD *)(a1 + 4);
  if ( v2 )
  {
    *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 8);
    v3 = *(_DWORD *)(a1 + 8);
    if ( !v3 )
    {
LABEL_4:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_3:
    *(_DWORD *)(v3 + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_4;
  }
  v3 = *(_DWORD *)(a1 + 8);
  if ( v3 )
    goto LABEL_3;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);

//----- (08056D50) --------------------------------------------------------
void __cdecl sub_8056D50(std::logic_error *a1)
{
  *(_DWORD *)a1 = &off_80B94D8;
  std::logic_error::~logic_error(a1);
  operator delete((void *)a1);
}
// 80B94D8: using guessed type void *off_80B94D8;

//----- (08056D80) --------------------------------------------------------
void __cdecl sub_8056D80(void *a1)
{
  int v1; // edx@1
  int v2; // edx@2

  *(_DWORD *)a1 = &off_80B94F0;
  v1 = *((_DWORD *)a1 + 1);
  if ( !v1 )
  {
    v2 = *((_DWORD *)a1 + 2);
    if ( !v2 )
      goto LABEL_5;
    goto LABEL_3;
  }
  *(_DWORD *)(v1 + 8) = *((_DWORD *)a1 + 2);
  v2 = *((_DWORD *)a1 + 2);
  if ( v2 )
LABEL_3:
    *(_DWORD *)(v2 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_5:
  operator delete(a1);
}
// 80B94F0: using guessed type int (__cdecl *off_80B94F0)(int);

//----- (08056DD0) --------------------------------------------------------
void __cdecl sub_8056DD0(void *a1)
{
  int v1; // edx@1
  int v2; // edx@2

  *(_DWORD *)a1 = &off_80B9500;
  v1 = *((_DWORD *)a1 + 1);
  if ( !v1 )
  {
    v2 = *((_DWORD *)a1 + 2);
    if ( !v2 )
      goto LABEL_5;
    goto LABEL_3;
  }
  *(_DWORD *)(v1 + 8) = *((_DWORD *)a1 + 2);
  v2 = *((_DWORD *)a1 + 2);
  if ( v2 )
LABEL_3:
    *(_DWORD *)(v2 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_5:
  operator delete(a1);
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);

//----- (08056E20) --------------------------------------------------------
int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf(int a1)
{
  int v1; // eax@1
  int v2; // edx@1
  signed __int32 v4; // eax@4
  signed __int32 v5; // ecx@7
  char v6; // [sp+1Fh] [bp-Dh]@6

  *(_DWORD *)a1 = &unk_80CF588;
  v1 = *(_DWORD *)(a1 + 36);
  v2 = v1 - 12;
  if ( (_DWORD *)(v1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v4 = _InterlockedExchangeAdd((volatile signed __int32 *)(v1 - 4), 0xFFFFFFFF);
    }
    else
    {
      v5 = *(_DWORD *)(v1 - 4);
      *(_DWORD *)(v1 - 4) = v5 - 1;
      v4 = v5;
    }
    if ( v4 <= 0 )
      std::string::_Rep::_M_destroy(v2, &v6);
  }
  *(_DWORD *)a1 = &unk_80CF7F0;
  return std::locale::~locale((std::locale *)(a1 + 28));
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08056E90) --------------------------------------------------------
void __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf(void *a1)
{
  int v1; // eax@1
  int v2; // edx@1
  signed __int32 v3; // eax@4
  signed __int32 v4; // ecx@7
  char v5; // [sp+1Fh] [bp-Dh]@6

  *(_DWORD *)a1 = &unk_80CF588;
  v1 = *((_DWORD *)a1 + 9);
  v2 = v1 - 12;
  if ( (_DWORD *)(v1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v3 = _InterlockedExchangeAdd((volatile signed __int32 *)(v1 - 4), 0xFFFFFFFF);
    }
    else
    {
      v4 = *(_DWORD *)(v1 - 4);
      *(_DWORD *)(v1 - 4) = v4 - 1;
      v3 = v4;
    }
    if ( v3 <= 0 )
      std::string::_Rep::_M_destroy(v2, &v5);
  }
  *(_DWORD *)a1 = &unk_80CF7F0;
  std::locale::~locale((std::locale *)((char *)a1 + 28));
  operator delete(a1);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08056F10) --------------------------------------------------------
int __cdecl sub_8056F10(int a1)
{
  int result; // eax@1

  result = a1;
  if ( a1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(a1 + 4));
    if ( !a1 )
      result = (*(int (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  return result;
}

//----- (08056FF0) --------------------------------------------------------
char __cdecl sub_8056FF0(int a1, unsigned __int8 a2)
{
  char result; // al@2

  if ( *(_BYTE *)(a1 + 28) )
  {
    result = *(_BYTE *)(a1 + a2 + 29);
  }
  else
  {
    std::ctype<char>::_M_widen_init(a1);
    result = (*(int (__cdecl **)(int, _DWORD))(*(_DWORD *)a1 + 24))(a1, (char)a2);
  }
  return result;
}
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);

//----- (08057050) --------------------------------------------------------
int __cdecl sub_8057050(int a1)
{
  int v1; // eax@1
  void *v2; // esi@3
  void *v3; // ebx@3
  int v4; // eax@4
  int v5; // edx@4
  void *v6; // esi@9
  void *v7; // ebx@9
  int v8; // eax@10
  int v9; // edx@10
  int v10; // eax@15
  int v11; // edx@15
  int result; // eax@16
  int v13; // edx@16
  signed __int32 v14; // ecx@20
  signed __int32 v15; // ecx@24
  int v16; // ecx@32
  signed __int32 v17; // eax@34
  signed __int32 v18; // ecx@38
  char v19; // [sp+1Fh] [bp-1Dh]@22

  v1 = *(_DWORD *)(a1 + 56);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v2 = *(void **)(a1 + 48);
  v3 = *(void **)(a1 + 44);
  if ( v2 != v3 )
  {
    do
    {
      v4 = *(_DWORD *)v3;
      v5 = *(_DWORD *)v3 - 12;
      if ( (_DWORD *)v5 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v15 = _InterlockedExchangeAdd((volatile signed __int32 *)(v4 - 4), 0xFFFFFFFF);
        }
        else
        {
          v15 = *(_DWORD *)(v4 - 4);
          *(_DWORD *)(v4 - 4) = v15 - 1;
        }
        if ( v15 <= 0 )
          std::string::_Rep::_M_destroy(v5, &v19);
      }
      v3 = (char *)v3 + 4;
    }
    while ( v2 != v3 );
    v2 = *(void **)(a1 + 44);
  }
  if ( v2 )
    operator delete(v2);
  v6 = *(void **)(a1 + 28);
  v7 = *(void **)(a1 + 24);
  if ( v6 != v7 )
  {
    do
    {
      v8 = *(_DWORD *)v7;
      v9 = *(_DWORD *)v7 - 12;
      if ( (_DWORD *)v9 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v14 = _InterlockedExchangeAdd((volatile signed __int32 *)(v8 - 4), 0xFFFFFFFF);
        }
        else
        {
          v14 = *(_DWORD *)(v8 - 4);
          *(_DWORD *)(v8 - 4) = v14 - 1;
        }
        if ( v14 <= 0 )
          std::string::_Rep::_M_destroy(v9, &v19);
      }
      v7 = (char *)v7 + 4;
    }
    while ( v6 != v7 );
    v6 = *(void **)(a1 + 24);
  }
  if ( v6 )
    operator delete(v6);
  v10 = *(_DWORD *)(a1 + 20);
  v11 = v10 - 12;
  if ( (_DWORD *)(v10 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v17 = _InterlockedExchangeAdd((volatile signed __int32 *)(v10 - 4), 0xFFFFFFFF);
    }
    else
    {
      v18 = *(_DWORD *)(v10 - 4);
      *(_DWORD *)(v10 - 4) = v18 - 1;
      v17 = v18;
    }
    if ( v17 <= 0 )
      std::string::_Rep::_M_destroy(v11, &v19);
  }
  result = *(_DWORD *)(a1 + 8);
  v13 = result - 12;
  if ( (_DWORD *)(result - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      result = _InterlockedExchangeAdd((volatile signed __int32 *)(result - 4), 0xFFFFFFFF);
    }
    else
    {
      v16 = *(_DWORD *)(result - 4);
      *(_DWORD *)(result - 4) = v16 - 1;
      result = v16;
    }
    if ( result <= 0 )
      result = std::string::_Rep::_M_destroy(v13, &v19);
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08057220) --------------------------------------------------------
int __cdecl sub_8057220(int a1)
{
  void *v1; // eax@1
  int v2; // ebp@2
  int v3; // esi@3
  int v4; // eax@3
  int v5; // eax@6
  void *v6; // edi@9
  void *v7; // ebx@9
  int v8; // eax@10
  int v9; // edx@10
  void *v10; // edi@15
  void *v11; // ebx@15
  int v12; // eax@16
  int v13; // edx@16
  int v14; // eax@21
  int v15; // edx@21
  int v16; // eax@22
  void *v17; // eax@27
  int v18; // ebp@28
  int v19; // esi@29
  int v20; // eax@29
  int v21; // eax@32
  void *v22; // edi@35
  void *v23; // ebx@35
  int v24; // eax@36
  int v25; // edx@36
  void *v26; // edi@41
  void *v27; // ebx@41
  int v28; // eax@42
  int v29; // edx@42
  int v30; // eax@47
  int v31; // edx@47
  int v32; // eax@48
  int result; // eax@53
  bool v34; // zf@53
  signed __int32 v35; // eax@58
  signed __int32 v36; // eax@62
  signed __int32 v37; // eax@66
  signed __int32 v38; // eax@70
  signed __int32 v39; // ecx@73
  signed __int32 v40; // ecx@74
  signed __int32 v41; // ecx@75
  signed __int32 v42; // ecx@76
  signed __int32 v43; // ebx@78
  signed __int32 v44; // eax@82
  signed __int32 v45; // ebx@86
  signed __int32 v46; // eax@88
  signed __int32 v47; // ebx@92
  signed __int32 v48; // ebx@95
  int v49; // [sp+Ch] [bp-50h]@2
  int v50; // [sp+Ch] [bp-50h]@28
  void *v51; // [sp+10h] [bp-4Ch]@1
  void *v52; // [sp+10h] [bp-4Ch]@27
  int v53; // [sp+14h] [bp-48h]@2
  int v54; // [sp+14h] [bp-48h]@28
  void *v55; // [sp+1Ch] [bp-40h]@1
  void *v56; // [sp+1Ch] [bp-40h]@27
  int v57; // [sp+20h] [bp-3Ch]@2
  int v58; // [sp+20h] [bp-3Ch]@28
  int v59; // [sp+24h] [bp-38h]@2
  int v60; // [sp+24h] [bp-38h]@28
  int v61; // [sp+28h] [bp-34h]@2
  int v62; // [sp+28h] [bp-34h]@28
  int v63; // [sp+2Ch] [bp-30h]@2
  int v64; // [sp+2Ch] [bp-30h]@28
  char v65; // [sp+3Fh] [bp-1Dh]@60

  v55 = *(void **)(a1 + 32);
  v1 = *(void **)(a1 + 28);
  v51 = v1;
  if ( v55 != v1 )
  {
    v53 = (int)((char *)v1 + 28);
    v2 = (int)((char *)v1 + 48);
    v49 = *(_DWORD *)(a1 + 28);
    v59 = (int)((char *)v1 + 60);
    v57 = (int)((char *)v1 + 56);
    v63 = (int)((char *)v1 + 20);
    v61 = (int)((char *)v1 + 8);
    do
    {
      v3 = v49 - (_DWORD)v51;
      v4 = *(_DWORD *)(v49 - (_DWORD)v51 + v59);
      if ( v4 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v4 + 4));
        if ( !v4 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v5 = *(_DWORD *)(v3 + v57);
      if ( v5 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
        if ( !v5 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v6 = *(void **)v2;
      v7 = *(void **)(v2 - 4);
      if ( *(void **)v2 != v7 )
      {
        do
        {
          v8 = *(_DWORD *)v7;
          v9 = *(_DWORD *)v7 - 12;
          if ( (_DWORD *)v9 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v8 - 4), 0xFFFFFFFF);
            }
            else
            {
              v39 = *(_DWORD *)(v8 - 4);
              *(_DWORD *)(v8 - 4) = v39 - 1;
              v36 = v39;
            }
            if ( v36 <= 0 )
              std::string::_Rep::_M_destroy(v9, &v65);
          }
          v7 = (char *)v7 + 4;
        }
        while ( v6 != v7 );
        v6 = *(void **)(v49 + 44);
      }
      if ( v6 )
        operator delete(v6);
      v10 = *(void **)v53;
      v11 = *(void **)(v53 - 4);
      if ( *(void **)v53 != v11 )
      {
        do
        {
          v12 = *(_DWORD *)v11;
          v13 = *(_DWORD *)v11 - 12;
          if ( (_DWORD *)v13 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v12 - 4), 0xFFFFFFFF);
            }
            else
            {
              v42 = *(_DWORD *)(v12 - 4);
              *(_DWORD *)(v12 - 4) = v42 - 1;
              v37 = v42;
            }
            if ( v37 <= 0 )
              std::string::_Rep::_M_destroy(v13, &v65);
          }
          v11 = (char *)v11 + 4;
        }
        while ( v10 != v11 );
        v10 = *(void **)(v49 + 24);
      }
      if ( v10 )
        operator delete(v10);
      v14 = *(_DWORD *)(v3 + v63);
      v15 = v14 - 12;
      if ( (_DWORD *)(v14 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v44 = _InterlockedExchangeAdd((volatile signed __int32 *)(v14 - 4), 0xFFFFFFFF);
        }
        else
        {
          v45 = *(_DWORD *)(v14 - 4);
          *(_DWORD *)(v14 - 4) = v45 - 1;
          v44 = v45;
        }
        if ( v44 <= 0 )
          std::string::_Rep::_M_destroy(v15, &v65);
      }
      v16 = *(_DWORD *)(v3 + v61);
      if ( (_DWORD *)(v16 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v47 = _InterlockedExchangeAdd((volatile signed __int32 *)(v16 - 4), 0xFFFFFFFF);
        }
        else
        {
          v47 = *(_DWORD *)(v16 - 4);
          *(_DWORD *)(v16 - 4) = v47 - 1;
        }
        if ( v47 <= 0 )
          std::string::_Rep::_M_destroy(v16 - 12, &v65);
      }
      v49 += 64;
      v53 += 64;
      v2 += 64;
    }
    while ( v55 != (void *)v49 );
    v55 = *(void **)(a1 + 28);
  }
  if ( v55 )
    operator delete(v55);
  v56 = *(void **)(a1 + 20);
  v17 = *(void **)(a1 + 16);
  v52 = v17;
  if ( v56 != v17 )
  {
    v54 = (int)((char *)v17 + 28);
    v18 = (int)((char *)v17 + 48);
    v50 = *(_DWORD *)(a1 + 16);
    v64 = (int)((char *)v17 + 60);
    v62 = (int)((char *)v17 + 56);
    v60 = (int)((char *)v17 + 20);
    v58 = (int)((char *)v17 + 8);
    do
    {
      v19 = v50 - (_DWORD)v52;
      v20 = *(_DWORD *)(v50 - (_DWORD)v52 + v64);
      if ( v20 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v20 + 4));
        if ( !v20 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v21 = *(_DWORD *)(v19 + v62);
      if ( v21 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v21 + 4));
        if ( !v21 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v22 = *(void **)v18;
      v23 = *(void **)(v18 - 4);
      if ( *(void **)v18 != v23 )
      {
        do
        {
          v24 = *(_DWORD *)v23;
          v25 = *(_DWORD *)v23 - 12;
          if ( (_DWORD *)v25 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v24 - 4), 0xFFFFFFFF);
            }
            else
            {
              v41 = *(_DWORD *)(v24 - 4);
              *(_DWORD *)(v24 - 4) = v41 - 1;
              v38 = v41;
            }
            if ( v38 <= 0 )
              std::string::_Rep::_M_destroy(v25, &v65);
          }
          v23 = (char *)v23 + 4;
        }
        while ( v22 != v23 );
        v22 = *(void **)(v50 + 44);
      }
      if ( v22 )
        operator delete(v22);
      v26 = *(void **)v54;
      v27 = *(void **)(v54 - 4);
      if ( *(void **)v54 != v27 )
      {
        do
        {
          v28 = *(_DWORD *)v27;
          v29 = *(_DWORD *)v27 - 12;
          if ( (_DWORD *)v29 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v35 = _InterlockedExchangeAdd((volatile signed __int32 *)(v28 - 4), 0xFFFFFFFF);
            }
            else
            {
              v40 = *(_DWORD *)(v28 - 4);
              *(_DWORD *)(v28 - 4) = v40 - 1;
              v35 = v40;
            }
            if ( v35 <= 0 )
              std::string::_Rep::_M_destroy(v29, &v65);
          }
          v27 = (char *)v27 + 4;
        }
        while ( v26 != v27 );
        v26 = *(void **)(v50 + 24);
      }
      if ( v26 )
        operator delete(v26);
      v30 = *(_DWORD *)(v19 + v60);
      v31 = v30 - 12;
      if ( (_DWORD *)(v30 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v30 - 4), 0xFFFFFFFF);
        }
        else
        {
          v48 = *(_DWORD *)(v30 - 4);
          *(_DWORD *)(v30 - 4) = v48 - 1;
          v46 = v48;
        }
        if ( v46 <= 0 )
          std::string::_Rep::_M_destroy(v31, &v65);
      }
      v32 = *(_DWORD *)(v19 + v58);
      if ( (_DWORD *)(v32 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v43 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
        }
        else
        {
          v43 = *(_DWORD *)(v32 - 4);
          *(_DWORD *)(v32 - 4) = v43 - 1;
        }
        if ( v43 <= 0 )
          std::string::_Rep::_M_destroy(v32 - 12, &v65);
      }
      v50 += 64;
      v54 += 64;
      v18 += 64;
    }
    while ( v56 != (void *)v50 );
    v56 = *(void **)(a1 + 16);
  }
  if ( v56 )
    operator delete(v56);
  result = *(_DWORD *)a1;
  v34 = *(_DWORD *)a1 == 0;
  if ( *(_DWORD *)a1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(result + 4));
    if ( v34 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08057760) --------------------------------------------------------
void __cdecl sub_8057760(int a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@1
  void *v2; // eax@3
  int v3; // ebp@4
  int v4; // esi@5
  int v5; // eax@5
  int v6; // eax@8
  void *v7; // edi@11
  void *v8; // ebx@11
  int v9; // eax@12
  int v10; // edx@12
  void *v11; // edi@17
  void *v12; // ebx@17
  int v13; // eax@18
  int v14; // edx@18
  int v15; // eax@23
  int v16; // edx@23
  int v17; // eax@24
  void *v18; // eax@29
  int v19; // ebp@30
  int v20; // esi@31
  int v21; // eax@31
  int v22; // eax@34
  void *v23; // edi@37
  void *v24; // ebx@37
  int v25; // eax@38
  int v26; // edx@38
  void *v27; // edi@43
  void *v28; // ebx@43
  int v29; // eax@44
  int v30; // edx@44
  int v31; // eax@49
  int v32; // edx@49
  int v33; // eax@50
  int v34; // eax@55
  void *v35; // esi@57
  void *v36; // ebx@57
  int v37; // eax@58
  bool v38; // zf@58
  signed __int32 v39; // eax@68
  signed __int32 v40; // eax@72
  signed __int32 v41; // eax@76
  signed __int32 v42; // eax@80
  signed __int32 v43; // ecx@83
  signed __int32 v44; // ecx@84
  signed __int32 v45; // ecx@85
  signed __int32 v46; // ecx@86
  signed __int32 v47; // ebx@88
  signed __int32 v48; // eax@92
  signed __int32 v49; // ebx@96
  signed __int32 v50; // eax@98
  signed __int32 v51; // ebx@102
  signed __int32 v52; // ebx@105
  int v53; // [sp+Ch] [bp-50h]@4
  int v54; // [sp+Ch] [bp-50h]@30
  void *v55; // [sp+10h] [bp-4Ch]@3
  void *v56; // [sp+10h] [bp-4Ch]@29
  int v57; // [sp+14h] [bp-48h]@4
  int v58; // [sp+14h] [bp-48h]@30
  void *v59; // [sp+1Ch] [bp-40h]@3
  void *v60; // [sp+1Ch] [bp-40h]@29
  int v61; // [sp+20h] [bp-3Ch]@4
  int v62; // [sp+20h] [bp-3Ch]@30
  int v63; // [sp+24h] [bp-38h]@4
  int v64; // [sp+24h] [bp-38h]@30
  int v65; // [sp+28h] [bp-34h]@4
  int v66; // [sp+28h] [bp-34h]@30
  int v67; // [sp+2Ch] [bp-30h]@4
  int v68; // [sp+2Ch] [bp-30h]@30
  char v69; // [sp+3Fh] [bp-1Dh]@70

  v1 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 64);
  if ( v1 )
    v1(a1 + 56, a1 + 56, 3);
  v59 = *(void **)(a1 + 44);
  v2 = *(void **)(a1 + 40);
  v55 = v2;
  if ( v59 != v2 )
  {
    v57 = (int)((char *)v2 + 28);
    v3 = (int)((char *)v2 + 48);
    v53 = *(_DWORD *)(a1 + 40);
    v67 = (int)((char *)v2 + 60);
    v65 = (int)((char *)v2 + 56);
    v63 = (int)((char *)v2 + 20);
    v61 = (int)((char *)v2 + 8);
    do
    {
      v4 = v53 - (_DWORD)v55;
      v5 = *(_DWORD *)(v53 - (_DWORD)v55 + v67);
      if ( v5 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
        if ( !v5 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v6 = *(_DWORD *)(v4 + v65);
      if ( v6 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v6 + 4));
        if ( !v6 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v7 = *(void **)v3;
      v8 = *(void **)(v3 - 4);
      if ( *(void **)v3 != v8 )
      {
        do
        {
          v9 = *(_DWORD *)v8;
          v10 = *(_DWORD *)v8 - 12;
          if ( (_DWORD *)v10 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v9 - 4), 0xFFFFFFFF);
            }
            else
            {
              v43 = *(_DWORD *)(v9 - 4);
              *(_DWORD *)(v9 - 4) = v43 - 1;
              v40 = v43;
            }
            if ( v40 <= 0 )
              std::string::_Rep::_M_destroy(v10, &v69);
          }
          v8 = (char *)v8 + 4;
        }
        while ( v7 != v8 );
        v7 = *(void **)(v53 + 44);
      }
      if ( v7 )
        operator delete(v7);
      v11 = *(void **)v57;
      v12 = *(void **)(v57 - 4);
      if ( *(void **)v57 != v12 )
      {
        do
        {
          v13 = *(_DWORD *)v12;
          v14 = *(_DWORD *)v12 - 12;
          if ( (_DWORD *)v14 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v41 = _InterlockedExchangeAdd((volatile signed __int32 *)(v13 - 4), 0xFFFFFFFF);
            }
            else
            {
              v46 = *(_DWORD *)(v13 - 4);
              *(_DWORD *)(v13 - 4) = v46 - 1;
              v41 = v46;
            }
            if ( v41 <= 0 )
              std::string::_Rep::_M_destroy(v14, &v69);
          }
          v12 = (char *)v12 + 4;
        }
        while ( v11 != v12 );
        v11 = *(void **)(v53 + 24);
      }
      if ( v11 )
        operator delete(v11);
      v15 = *(_DWORD *)(v4 + v63);
      v16 = v15 - 12;
      if ( (_DWORD *)(v15 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v48 = _InterlockedExchangeAdd((volatile signed __int32 *)(v15 - 4), 0xFFFFFFFF);
        }
        else
        {
          v49 = *(_DWORD *)(v15 - 4);
          *(_DWORD *)(v15 - 4) = v49 - 1;
          v48 = v49;
        }
        if ( v48 <= 0 )
          std::string::_Rep::_M_destroy(v16, &v69);
      }
      v17 = *(_DWORD *)(v4 + v61);
      if ( (_DWORD *)(v17 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v51 = _InterlockedExchangeAdd((volatile signed __int32 *)(v17 - 4), 0xFFFFFFFF);
        }
        else
        {
          v51 = *(_DWORD *)(v17 - 4);
          *(_DWORD *)(v17 - 4) = v51 - 1;
        }
        if ( v51 <= 0 )
          std::string::_Rep::_M_destroy(v17 - 12, &v69);
      }
      v53 += 64;
      v57 += 64;
      v3 += 64;
    }
    while ( v59 != (void *)v53 );
    v59 = *(void **)(a1 + 40);
  }
  if ( v59 )
    operator delete(v59);
  v60 = *(void **)(a1 + 32);
  v18 = *(void **)(a1 + 28);
  v56 = v18;
  if ( v60 != v18 )
  {
    v58 = (int)((char *)v18 + 28);
    v19 = (int)((char *)v18 + 48);
    v54 = *(_DWORD *)(a1 + 28);
    v64 = (int)((char *)v18 + 60);
    v62 = (int)((char *)v18 + 56);
    v68 = (int)((char *)v18 + 20);
    v66 = (int)((char *)v18 + 8);
    do
    {
      v20 = v54 - (_DWORD)v56;
      v21 = *(_DWORD *)(v54 - (_DWORD)v56 + v64);
      if ( v21 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v21 + 4));
        if ( !v21 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v22 = *(_DWORD *)(v20 + v62);
      if ( v22 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v22 + 4));
        if ( !v22 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v23 = *(void **)v19;
      v24 = *(void **)(v19 - 4);
      if ( *(void **)v19 != v24 )
      {
        do
        {
          v25 = *(_DWORD *)v24;
          v26 = *(_DWORD *)v24 - 12;
          if ( (_DWORD *)v26 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v42 = _InterlockedExchangeAdd((volatile signed __int32 *)(v25 - 4), 0xFFFFFFFF);
            }
            else
            {
              v45 = *(_DWORD *)(v25 - 4);
              *(_DWORD *)(v25 - 4) = v45 - 1;
              v42 = v45;
            }
            if ( v42 <= 0 )
              std::string::_Rep::_M_destroy(v26, &v69);
          }
          v24 = (char *)v24 + 4;
        }
        while ( v23 != v24 );
        v23 = *(void **)(v54 + 44);
      }
      if ( v23 )
        operator delete(v23);
      v27 = *(void **)v58;
      v28 = *(void **)(v58 - 4);
      if ( *(void **)v58 != v28 )
      {
        do
        {
          v29 = *(_DWORD *)v28;
          v30 = *(_DWORD *)v28 - 12;
          if ( (_DWORD *)v30 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
            }
            else
            {
              v44 = *(_DWORD *)(v29 - 4);
              *(_DWORD *)(v29 - 4) = v44 - 1;
              v39 = v44;
            }
            if ( v39 <= 0 )
              std::string::_Rep::_M_destroy(v30, &v69);
          }
          v28 = (char *)v28 + 4;
        }
        while ( v27 != v28 );
        v27 = *(void **)(v54 + 24);
      }
      if ( v27 )
        operator delete(v27);
      v31 = *(_DWORD *)(v20 + v68);
      v32 = v31 - 12;
      if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v50 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
        }
        else
        {
          v52 = *(_DWORD *)(v31 - 4);
          *(_DWORD *)(v31 - 4) = v52 - 1;
          v50 = v52;
        }
        if ( v50 <= 0 )
          std::string::_Rep::_M_destroy(v32, &v69);
      }
      v33 = *(_DWORD *)(v20 + v66);
      if ( (_DWORD *)(v33 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v47 = _InterlockedExchangeAdd((volatile signed __int32 *)(v33 - 4), 0xFFFFFFFF);
        }
        else
        {
          v47 = *(_DWORD *)(v33 - 4);
          *(_DWORD *)(v33 - 4) = v47 - 1;
        }
        if ( v47 <= 0 )
          std::string::_Rep::_M_destroy(v33 - 12, &v69);
      }
      v54 += 64;
      v58 += 64;
      v19 += 64;
    }
    while ( v60 != (void *)v54 );
    v60 = *(void **)(a1 + 28);
  }
  if ( v60 )
    operator delete(v60);
  v34 = *(_DWORD *)(a1 + 12);
  if ( v34 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v34 + 4));
    if ( !v34 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v35 = *(void **)(a1 + 4);
  v36 = *(void **)a1;
  if ( v35 != *(void **)a1 )
  {
    do
    {
      v37 = *(_DWORD *)v36;
      v38 = *(_DWORD *)v36 == 0;
      if ( *(_DWORD *)v36 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v37 + 4));
        if ( v38 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v37 + 4))(v37);
      }
      v36 = (char *)v36 + 4;
    }
    while ( v35 != v36 );
    v35 = *(void **)a1;
  }
  if ( v35 )
    operator delete(v35);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08057D00) --------------------------------------------------------
void __cdecl sub_8057D00(void *a1)
{
  void *v1; // esi@1
  void *v2; // ebx@1
  int v3; // eax@2
  bool v4; // zf@2

  v1 = (void *)*((_DWORD *)a1 + 1);
  v2 = *(void **)a1;
  if ( v1 != *(void **)a1 )
  {
    do
    {
      v3 = *(_DWORD *)v2;
      v4 = *(_DWORD *)v2 == 0;
      if ( *(_DWORD *)v2 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
        if ( v4 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
      }
      v2 = (char *)v2 + 4;
    }
    while ( v1 != v2 );
    v1 = *(void **)a1;
  }
  if ( v1 )
    operator delete(v1);
}

//----- (08057D60) --------------------------------------------------------
int __cdecl sub_8057D60(int a1, int a2)
{
  int result; // eax@1

  result = a1;
  *(_BYTE *)a1 = 0;
  *(_DWORD *)(a1 + 4) = 0;
  if ( *(_BYTE *)a2 )
  {
    *(_DWORD *)(a1 + 4) = *(_DWORD *)(a2 + 4);
    *(_BYTE *)a1 = 1;
  }
  return result;
}

//----- (08057D90) --------------------------------------------------------
void __cdecl sub_8057D90(void *a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@4

  if ( *((_DWORD *)a1 + 2) )
  {
    (*(void (__cdecl **)(void *))((void (__cdecl **)(_DWORD))a1 + 3))(a1);
  }
  else
  {
    std::__throw_bad_function_call();
    sub_8057D90(a1);
    if ( a1 )
    {
      v1 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 2);
      if ( v1 )
        v1(a1, a1, 3);
      operator delete(a1);
    }
  }
}

//----- (08057E00) --------------------------------------------------------
void __cdecl sub_8057E00(void *a1, int a2, void *a3)
{
  void (__cdecl *v3)(_DWORD, _DWORD, _DWORD); // eax@2

  sub_8057D90(a3);
  if ( a3 )
  {
    v3 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a3 + 2);
    if ( v3 )
      v3(a3, a3, 3);
    operator delete(a3);
  }
}

//----- (08057E50) --------------------------------------------------------
void __cdecl sub_8057E50(void *a1)
{
  void *v1; // esi@1
  void *v2; // ebx@1
  int v3; // eax@2
  bool v4; // zf@2

  v1 = (void *)*((_DWORD *)a1 + 1);
  v2 = *(void **)a1;
  if ( v1 != *(void **)a1 )
  {
    do
    {
      v3 = *(_DWORD *)v2;
      v4 = *(_DWORD *)v2 == 0;
      if ( *(_DWORD *)v2 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
        if ( v4 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
      }
      v2 = (char *)v2 + 4;
    }
    while ( v1 != v2 );
    v1 = *(void **)a1;
  }
  if ( v1 )
    operator delete(v1);
}

//----- (08057EB0) --------------------------------------------------------
int __userpurge sub_8057EB0@<eax>(int a1, int a2, int a3, int a4)
{
  int v4; // edx@1
  int v5; // esi@1
  int v6; // ecx@2
  int i; // ebp@6
  int v8; // ebx@12
  int j; // esi@20
  int v11; // eax@21
  int v12; // edx@23
  bool v13; // zf@23
  int v14; // eax@34

  v4 = (a3 - a2) >> 2;
  v5 = (a3 - a2) >> 4;
  if ( v5 > 0 )
  {
    v6 = *(_DWORD *)a4;
    if ( *(_DWORD *)a2 == *(_DWORD *)a4 )
    {
      v8 = a2;
    }
    else if ( v6 == *(_DWORD *)(a2 + 4) )
    {
      v8 = a2 + 4;
    }
    else if ( v6 == *(_DWORD *)(a2 + 8) )
    {
      v8 = a2 + 8;
    }
    else if ( v6 == *(_DWORD *)(a2 + 12) )
    {
      v8 = a2 + 12;
    }
    else
    {
      for ( i = a2; ; i += 16 )
      {
        v8 = i + 16;
        --v5;
        if ( !v5 )
        {
          v4 = (a3 - (i + 16)) >> 2;
          goto LABEL_14;
        }
        if ( *(_DWORD *)v8 == v6 )
          goto LABEL_19;
        if ( *(_DWORD *)(i + 20) == v6 )
        {
          v8 = i + 20;
          goto LABEL_19;
        }
        if ( *(_DWORD *)(i + 24) == v6 )
        {
          v8 = i + 24;
          goto LABEL_19;
        }
        if ( *(_DWORD *)(i + 28) == v6 )
          break;
      }
      v8 = i + 28;
    }
    goto LABEL_19;
  }
  v8 = a2;
LABEL_14:
  if ( v4 == 2 )
  {
    v14 = *(_DWORD *)a4;
LABEL_40:
    if ( v14 == *(_DWORD *)v8 )
      goto LABEL_19;
    v8 += 4;
    goto LABEL_35;
  }
  if ( v4 == 3 )
  {
    v14 = *(_DWORD *)a4;
    if ( *(_DWORD *)v8 == *(_DWORD *)a4 )
      goto LABEL_19;
    v8 += 4;
    goto LABEL_40;
  }
  if ( v4 != 1 )
  {
LABEL_17:
    *(_DWORD *)a1 = a3;
    return a1;
  }
  v14 = *(_DWORD *)a4;
LABEL_35:
  if ( v14 != *(_DWORD *)v8 )
    goto LABEL_17;
LABEL_19:
  if ( a3 == v8 )
    goto LABEL_17;
  for ( j = v8 + 4; a3 != j; j += 4 )
  {
    v11 = *(_DWORD *)j;
    if ( *(_DWORD *)j != *(_DWORD *)a4 )
    {
      if ( j != v8 )
      {
        v12 = *(_DWORD *)v8;
        v13 = *(_DWORD *)v8 == 0;
        if ( *(_DWORD *)v8 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v12 + 4));
          if ( v13 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v12 + 4))(v12);
          v11 = *(_DWORD *)j;
        }
        *(_DWORD *)v8 = v11;
        *(_DWORD *)j = 0;
      }
      v8 += 4;
    }
  }
  *(_DWORD *)a1 = v8;
  return a1;
}

//----- (08058060) --------------------------------------------------------
int __userpurge sub_8058060@<eax>(int a1, int a2, int a3, int a4)
{
  int v4; // ebx@2
  int v5; // eax@3
  int v6; // ebp@3
  int v7; // esi@4
  int v8; // ebx@4
  int v9; // eax@6
  bool v10; // zf@6
  int v11; // esi@12
  int i; // ebp@12
  int v13; // eax@13
  bool v14; // zf@13
  int result; // eax@18

  if ( a3 != a4 )
  {
    v4 = *(_DWORD *)(a2 + 4);
    if ( v4 == a4 )
    {
      v5 = 0;
    }
    else
    {
      v5 = (v4 - a4) >> 2;
      v6 = v5;
      if ( v5 > 0 )
      {
        v7 = a4;
        v8 = a3;
        do
        {
          if ( v7 != v8 )
          {
            v9 = *(_DWORD *)v8;
            v10 = *(_DWORD *)v8 == 0;
            if ( *(_DWORD *)v8 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v9 + 4));
              if ( v10 )
                (*(void (__cdecl **)(int))(*(_DWORD *)v9 + 4))(v9);
            }
            *(_DWORD *)v8 = *(_DWORD *)v7;
            *(_DWORD *)v7 = 0;
          }
          v7 += 4;
          v8 += 4;
          --v6;
        }
        while ( v6 );
        v4 = *(_DWORD *)(a2 + 4);
        v5 = (*(_DWORD *)(a2 + 4) - a4) >> 2;
      }
    }
    v11 = a3 + 4 * v5;
    for ( i = v11; i != v4; i += 4 )
    {
      v13 = *(_DWORD *)i;
      v14 = *(_DWORD *)i == 0;
      if ( *(_DWORD *)i )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v13 + 4));
        if ( v14 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v13 + 4))(v13);
      }
    }
    *(_DWORD *)(a2 + 4) = v11;
  }
  result = a1;
  *(_DWORD *)a1 = a3;
  return result;
}

//----- (08058140) --------------------------------------------------------
int __cdecl sub_8058140(int a1, int a2)
{
  const std::string *v2; // ebx@2
  std::string *v3; // esi@2
  int v4; // ebp@2
  std::string *v5; // edi@2
  std::string *v6; // eax@3
  int v7; // eax@3
  std::string *v8; // esi@5
  int v9; // eax@9
  int v10; // edx@9
  std::string *v11; // eax@11
  int v12; // eax@12
  int v14; // ebp@15
  std::string *v15; // edi@17
  int v16; // ebp@17
  int v17; // ebx@17
  std::string *v18; // esi@18
  std::string *v19; // ebp@25
  std::string *i; // edi@26
  void *v21; // esi@30
  std::string *v22; // ebx@30
  int v23; // eax@31
  int v24; // edx@31
  signed __int32 v25; // eax@40
  signed __int32 v26; // eax@44
  int v27; // eax@47
  signed __int32 v28; // ecx@50
  signed __int32 v29; // ecx@52
  int v30; // [sp+8h] [bp-34h]@2
  std::string *v31; // [sp+Ch] [bp-30h]@3
  char v32; // [sp+1Fh] [bp-1Dh]@42

  if ( a2 != a1 )
  {
    v2 = *(const std::string **)a2;
    v3 = *(std::string **)(a2 + 4);
    v30 = (*(_DWORD *)(a2 + 4) - *(_DWORD *)a2) >> 2;
    v4 = (*(_DWORD *)(a2 + 4) - *(_DWORD *)a2) >> 2;
    v5 = *(std::string **)a1;
    if ( v30 > (unsigned int)((*(_DWORD *)(a1 + 8) - *(_DWORD *)a1) >> 2) )
    {
      if ( v30 )
      {
        if ( (unsigned int)v30 > 0x3FFFFFFF )
        {
          v27 = std::__throw_bad_alloc();
          _cxa_begin_catch(v27);
          while ( v3 != v5 )
          {
            std::string::_Rep::_M_dispose(*(_DWORD *)v5 - 12, &v32);
            v5 = (std::string *)((char *)v5 + 4);
          }
          _cxa_rethrow();
        }
        v19 = (std::string *)operator new(4 * v30);
      }
      else
      {
        v19 = 0;
      }
      for ( i = v19; v3 != v2; i = (std::string *)((char *)i + 4) )
      {
        if ( i )
          std::string::string(i, v2);
        v2 = (const std::string *)((char *)v2 + 4);
      }
      v21 = *(void **)(a1 + 4);
      v22 = *(std::string **)a1;
      if ( v21 != *(void **)a1 )
      {
        do
        {
          v23 = *(_DWORD *)v22;
          v24 = *(_DWORD *)v22 - 12;
          if ( (_DWORD *)v24 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v23 - 4), 0xFFFFFFFF);
            }
            else
            {
              v28 = *(_DWORD *)(v23 - 4);
              *(_DWORD *)(v23 - 4) = v28 - 1;
              v26 = v28;
            }
            if ( v26 <= 0 )
              std::string::_Rep::_M_destroy(v24, &v32);
          }
          v22 = (std::string *)((char *)v22 + 4);
        }
        while ( v21 != (void *)v22 );
        v21 = *(void **)a1;
      }
      if ( v21 )
        operator delete(v21);
      *(_DWORD *)a1 = v19;
      v12 = (int)((char *)v19 + 4 * v30);
      *(_DWORD *)(a1 + 8) = v12;
      goto LABEL_13;
    }
    v6 = *(std::string **)(a1 + 4);
    v31 = v6;
    v7 = (v6 - v5) >> 2;
    if ( v30 > (unsigned int)v7 )
    {
      v14 = v7;
      if ( v7 <= 0 )
      {
        v17 = (int)((char *)v2 + 4 * v7);
        v11 = *(std::string **)a1;
        v16 = *(_DWORD *)(a2 + 4);
        v15 = v31;
      }
      else
      {
        do
        {
          std::string::assign(v5, v2);
          v2 = (const std::string *)((char *)v2 + 4);
          v5 = (std::string *)((char *)v5 + 4);
          --v14;
        }
        while ( v14 );
        v15 = *(std::string **)(a1 + 4);
        v16 = *(_DWORD *)(a2 + 4);
        v11 = *(std::string **)a1;
        v17 = *(_DWORD *)a2 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFFC);
      }
      v18 = v15;
      if ( v16 == v17 )
        goto LABEL_12;
      do
      {
        if ( v18 )
          std::string::string(v18, (const std::string *)v17);
        v17 += 4;
        v18 = (std::string *)((char *)v18 + 4);
      }
      while ( v16 != v17 );
    }
    else
    {
      if ( v30 > 0 )
      {
        v8 = *(std::string **)a1;
        do
        {
          std::string::assign(v8, v2);
          v2 = (const std::string *)((char *)v2 + 4);
          v8 = (std::string *)((char *)v8 + 4);
          --v4;
        }
        while ( v4 );
        v5 = (std::string *)((char *)v5 + 4 * v30);
      }
      for ( ; v31 != v5; v5 = (std::string *)((char *)v5 + 4) )
      {
        v9 = *(_DWORD *)v5;
        v10 = *(_DWORD *)v5 - 12;
        if ( (_DWORD *)v10 != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v9 - 4), 0xFFFFFFFF);
          }
          else
          {
            v29 = *(_DWORD *)(v9 - 4);
            *(_DWORD *)(v9 - 4) = v29 - 1;
            v25 = v29;
          }
          if ( v25 <= 0 )
            std::string::_Rep::_M_destroy(v10, &v32);
        }
      }
    }
    v11 = *(std::string **)a1;
LABEL_12:
    v12 = (int)((char *)v11 + 4 * v30);
LABEL_13:
    *(_DWORD *)(a1 + 4) = v12;
  }
  return a1;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C710: using guessed type int _cxa_rethrow(void);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804D220: using guessed type int __cdecl _cxa_begin_catch(_DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08058470) --------------------------------------------------------
int __cdecl sub_8058470(int a1, int a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a1 + 8) )
  {
    result = (*(int (**)(void))(a1 + 12))();
  }
  else
  {
    std::__throw_bad_function_call();
    result = (int)sub_80584A0(a1, a2);
  }
  return result;
}

//----- (080584A0) --------------------------------------------------------
pthread_mutex_t *__cdecl sub_80584A0(int a1, int a2)
{
  pthread_mutex_t *result; // eax@2

  if ( *(_BYTE *)(a1 + 4) )
  {
    result = *(pthread_mutex_t **)a1;
    if ( *(_DWORD *)a1 )
    {
      if ( &_pthread_key_create )
        result = (pthread_mutex_t *)pthread_mutex_unlock(*(pthread_mutex_t **)a1);
      *(_BYTE *)(a1 + 4) = 0;
    }
  }
  else
  {
    std::__throw_system_error(1);
    result = (pthread_mutex_t *)sub_80584E0(a1, a2);
  }
  return result;
}

//----- (080584E0) --------------------------------------------------------
int __cdecl sub_80584E0(int a1, int a2)
{
  int v2; // edi@1
  unsigned __int8 v3; // cf@2
  int v4; // edi@2
  int v5; // eax@3
  int v6; // esi@4
  void *v7; // ecx@4
  unsigned int v8; // edx@4
  int v9; // eax@5
  void *v10; // edi@7
  int v11; // ebp@9
  int v12; // eax@11
  void *v13; // ebp@14
  int v14; // eax@15
  bool v15; // zf@15
  int result; // eax@22
  unsigned int v17; // [sp+8h] [bp-24h]@3
  int v18; // [sp+Ch] [bp-20h]@4

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFFF )
    {
      v17 = -4;
      v5 = operator new(0xFFFFFFFC);
    }
    else
    {
      v17 = 4 * v4;
      v5 = operator new(4 * v4);
    }
  }
  else
  {
    v17 = 4;
    v5 = operator new(4u);
  }
  v6 = v5;
  v7 = *(void **)a1;
  v18 = v5 + 4;
  v8 = v5 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFFC);
  if ( v8 )
  {
    v9 = *(_DWORD *)a2;
    *(_DWORD *)v8 = *(_DWORD *)a2;
    if ( v9 )
      _InterlockedIncrement((volatile signed __int32 *)(v9 + 4));
    v10 = *(void **)(a1 + 4);
    v7 = *(void **)a1;
  }
  else
  {
    v10 = *(void **)(a1 + 4);
  }
  if ( v10 != v7 )
  {
    v11 = v6;
    do
    {
      if ( v11 )
      {
        v12 = *(_DWORD *)v7;
        *(_DWORD *)v11 = *(_DWORD *)v7;
        if ( v12 )
          _InterlockedIncrement((volatile signed __int32 *)(v12 + 4));
      }
      v7 = (char *)v7 + 4;
      v11 += 4;
    }
    while ( v7 != v10 );
    v18 = v11 + 4;
    v10 = *(void **)(a1 + 4);
    v13 = *(void **)a1;
    if ( v10 != *(void **)a1 )
    {
      do
      {
        v14 = *(_DWORD *)v13;
        v15 = *(_DWORD *)v13 == 0;
        if ( *(_DWORD *)v13 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v14 + 4));
          if ( v15 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v14 + 4))(v14);
        }
        v13 = (char *)v13 + 4;
      }
      while ( v10 != v13 );
      v10 = *(void **)a1;
    }
  }
  if ( v10 )
    operator delete(v10);
  *(_DWORD *)a1 = v6;
  result = v18;
  *(_DWORD *)(a1 + 4) = v18;
  *(_DWORD *)(a1 + 8) = v17 + v6;
  return result;
}

//----- (08058600) --------------------------------------------------------
int __cdecl sub_8058600(int a1, int a2)
{
  int v2; // edi@1
  unsigned __int8 v3; // cf@2
  int v4; // edi@2
  int v5; // eax@3
  int v6; // esi@4
  void *v7; // ecx@4
  unsigned int v8; // edx@4
  int v9; // eax@5
  void *v10; // edi@7
  int v11; // ebp@9
  int v12; // eax@11
  void *v13; // ebp@14
  int v14; // eax@15
  bool v15; // zf@15
  int result; // eax@22
  unsigned int v17; // [sp+8h] [bp-24h]@3
  int v18; // [sp+Ch] [bp-20h]@4

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFFF )
    {
      v17 = -4;
      v5 = operator new(0xFFFFFFFC);
    }
    else
    {
      v17 = 4 * v4;
      v5 = operator new(4 * v4);
    }
  }
  else
  {
    v17 = 4;
    v5 = operator new(4u);
  }
  v6 = v5;
  v7 = *(void **)a1;
  v18 = v5 + 4;
  v8 = v5 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFFC);
  if ( v8 )
  {
    v9 = *(_DWORD *)a2;
    *(_DWORD *)v8 = *(_DWORD *)a2;
    if ( v9 )
      _InterlockedIncrement((volatile signed __int32 *)(v9 + 4));
    v10 = *(void **)(a1 + 4);
    v7 = *(void **)a1;
  }
  else
  {
    v10 = *(void **)(a1 + 4);
  }
  if ( v10 != v7 )
  {
    v11 = v6;
    do
    {
      if ( v11 )
      {
        v12 = *(_DWORD *)v7;
        *(_DWORD *)v11 = *(_DWORD *)v7;
        if ( v12 )
          _InterlockedIncrement((volatile signed __int32 *)(v12 + 4));
      }
      v7 = (char *)v7 + 4;
      v11 += 4;
    }
    while ( v7 != v10 );
    v18 = v11 + 4;
    v10 = *(void **)(a1 + 4);
    v13 = *(void **)a1;
    if ( v10 != *(void **)a1 )
    {
      do
      {
        v14 = *(_DWORD *)v13;
        v15 = *(_DWORD *)v13 == 0;
        if ( *(_DWORD *)v13 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v14 + 4));
          if ( v15 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v14 + 4))(v14);
        }
        v13 = (char *)v13 + 4;
      }
      while ( v10 != v13 );
      v10 = *(void **)a1;
    }
  }
  if ( v10 )
    operator delete(v10);
  *(_DWORD *)a1 = v6;
  result = v18;
  *(_DWORD *)(a1 + 4) = v18;
  *(_DWORD *)(a1 + 8) = v17 + v6;
  return result;
}

//----- (08058720) --------------------------------------------------------
int __cdecl sub_8058720(int a1, int a2)
{
  int v2; // eax@1
  unsigned __int8 v3; // cf@2
  int v4; // eax@2
  int v5; // eax@3
  int v6; // ebp@4
  void *v7; // edx@4
  void *v8; // esi@4
  unsigned int v9; // eax@4
  void *v10; // eax@7
  int v11; // ecx@7
  void *v12; // ebx@11
  int v13; // edx@12
  int v14; // ecx@12
  int result; // eax@17
  signed __int32 v16; // edx@20
  signed __int32 v17; // eax@25
  unsigned int v18; // [sp+10h] [bp-3Ch]@3
  int v19; // [sp+14h] [bp-38h]@4
  char v20; // [sp+2Fh] [bp-1Dh]@22

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFFF )
    {
      v18 = -4;
      v5 = operator new(0xFFFFFFFC);
    }
    else
    {
      v18 = 4 * v4;
      v5 = operator new(4 * v4);
    }
  }
  else
  {
    v18 = 4;
    v5 = operator new(4u);
  }
  v6 = v5;
  v7 = *(void **)a1;
  v8 = *(void **)(a1 + 4);
  v19 = v5 + 4;
  v9 = v5 + ((unsigned int)((char *)v8 - *(_DWORD *)a1) & 0xFFFFFFFC);
  if ( v9 )
  {
    *(_DWORD *)v9 = *(_DWORD *)a2;
    *(_DWORD *)a2 = &unk_80CF83C;
    v8 = *(void **)(a1 + 4);
    v7 = *(void **)a1;
  }
  if ( v8 != v7 )
  {
    v10 = v7;
    v11 = v6;
    do
    {
      if ( v11 )
      {
        *(_DWORD *)v11 = *(_DWORD *)v10;
        *(_DWORD *)v10 = &unk_80CF83C;
      }
      v10 = (char *)v10 + 4;
      v11 += 4;
    }
    while ( v10 != v8 );
    v19 = v6 + 4 * ((unsigned int)((_BYTE *)v8 - ((_BYTE *)v7 + 4)) >> 2) + 8;
    v8 = *(void **)(a1 + 4);
    v12 = *(void **)a1;
    if ( v8 != *(void **)a1 )
    {
      do
      {
        v13 = *(_DWORD *)v12;
        v14 = *(_DWORD *)v12 - 12;
        if ( (_DWORD *)v14 != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v16 = _InterlockedExchangeAdd((volatile signed __int32 *)(v13 - 4), 0xFFFFFFFF);
          }
          else
          {
            v17 = *(_DWORD *)(v13 - 4);
            *(_DWORD *)(v13 - 4) = v17 - 1;
            v16 = v17;
          }
          if ( v16 <= 0 )
            std::string::_Rep::_M_destroy(v14, &v20);
        }
        v12 = (char *)v12 + 4;
      }
      while ( v8 != v12 );
      v8 = *(void **)a1;
    }
  }
  if ( v8 )
    operator delete(v8);
  *(_DWORD *)a1 = v6;
  result = v19;
  *(_DWORD *)(a1 + 4) = v19;
  *(_DWORD *)(a1 + 8) = v18 + v6;
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08058890) --------------------------------------------------------
void __cdecl sub_8058890(void *dest, void *src, size_t n, int a4)
{
  const void *v4; // edx@1
  size_t v5; // ebp@1
  size_t v6; // esi@2
  void *v7; // edi@2
  int v8; // ecx@4
  int v9; // eax@5
  size_t v10; // ecx@6
  void *v11; // edi@10
  void *v12; // eax@13
  int v13; // edi@13
  unsigned __int8 v14; // cf@15
  void *v15; // ST18_4@17
  void *v16; // edi@17
  void *v17; // ecx@19
  void *v18; // ecx@20
  void *v19; // esi@21
  size_t v20; // ebp@21
  size_t v21; // ecx@22
  int v22; // esi@23
  size_t v23; // ST14_4@30
  void *v24; // ST18_4@36
  void *v25; // ST1C_4@38
  void *v26; // ST18_4@38
  void *v27; // ST1C_4@39
  void *v28; // ST18_4@39
  size_t v29; // [sp+14h] [bp-28h]@3
  unsigned int v30; // [sp+14h] [bp-28h]@16
  const void *v31; // [sp+1Ch] [bp-20h]@9
  size_t na; // [sp+48h] [bp+Ch]@12

  v4 = src;
  v5 = n;
  if ( n == a4 )
    return;
  v6 = a4 - n;
  v7 = (void *)*((_DWORD *)dest + 1);
  if ( a4 - n > *((_DWORD *)dest + 2) - (signed int)v7 )
  {
    v12 = *(void **)dest;
    v13 = (int)((char *)v7 - *(_DWORD *)dest);
    if ( v6 > ~v13 )
    {
      std::__throw_length_error("vector::_M_range_insert");
    }
    else
    {
      if ( v6 < v13 )
      {
        v14 = __CFADD__(v13, v13);
        v13 *= 2;
        if ( v14 )
          goto LABEL_16;
      }
      else
      {
        v14 = __CFADD__(v6, v13);
        v13 += v6;
        if ( v14 )
        {
LABEL_16:
          v30 = -1;
LABEL_17:
          v15 = (void *)v4;
          v16 = (void *)operator new(v30);
          v12 = *(void **)dest;
          v4 = v15;
LABEL_18:
          if ( v4 == v12 )
          {
            v17 = 0;
          }
          else
          {
            v27 = (void *)v4;
            v28 = (void *)((_BYTE *)v4 - (_BYTE *)v12);
            memmove(v16, v12, (_BYTE *)v4 - (_BYTE *)v12);
            v17 = v28;
            v4 = v27;
          }
          v18 = (char *)v17 + (_DWORD)v16;
          if ( a4 != n )
          {
            v25 = (void *)v4;
            v26 = v18;
            memmove(v18, (const void *)n, v6);
            v4 = v25;
            v18 = v26;
          }
          v19 = (char *)v18 + v6;
          v20 = *((_DWORD *)dest + 1) - (_DWORD)v4;
          if ( *((const void **)dest + 1) == v4 )
          {
            v21 = 0;
          }
          else
          {
            memmove(v19, v4, v20);
            v21 = v20;
          }
          v22 = (int)((char *)v19 + v21);
          if ( *(_DWORD *)dest )
            operator delete(*(void **)dest);
          *(_DWORD *)dest = v16;
          *((_DWORD *)dest + 1) = v22;
          *((_DWORD *)dest + 2) = (char *)v16 + v30;
          return;
        }
      }
      if ( !v13 )
      {
        v30 = 0;
        v16 = 0;
        goto LABEL_18;
      }
    }
    v30 = v13;
    goto LABEL_17;
  }
  v29 = (_BYTE *)v7 - (_BYTE *)src;
  if ( v6 >= (_BYTE *)v7 - (_BYTE *)src )
  {
    v31 = (const void *)(n + v29);
    if ( a4 != n + v29 )
    {
      memmove(v7, v31, a4 - (n + v29));
      v7 = (void *)*((_DWORD *)dest + 1);
      v4 = src;
    }
    v11 = (char *)v7 + v6 - v29;
    *((_DWORD *)dest + 1) = v11;
    if ( v29 )
    {
      v24 = (void *)v4;
      memmove(v11, v4, v29);
      v11 = (void *)*((_DWORD *)dest + 1);
      v4 = v24;
    }
    *((_DWORD *)dest + 1) = (char *)v11 + v29;
    if ( v31 != (const void *)n )
    {
      na = v29;
LABEL_29:
      memmove((void *)v4, (const void *)v5, na);
      return;
    }
  }
  else
  {
    v8 = (int)((char *)v7 - v6);
    if ( v7 == (char *)v7 - v6 )
    {
      v9 = *((_DWORD *)dest + 1);
    }
    else
    {
      memmove(v7, (char *)v7 - v6, (_BYTE *)v7 - ((char *)v7 - v6));
      v9 = *((_DWORD *)dest + 1);
      v8 = (int)((char *)v7 - v6);
      v4 = src;
    }
    *((_DWORD *)dest + 1) = v6 + v9;
    v10 = v8 - (_DWORD)v4;
    if ( !v10 )
    {
      if ( a4 == n )
        return;
      goto LABEL_28;
    }
    v23 = (size_t)v4;
    memmove((char *)v7 - v10, v4, v10);
    v4 = (const void *)v23;
    if ( a4 != n )
    {
LABEL_28:
      na = a4 - n;
      goto LABEL_29;
    }
  }
}

//----- (08058B80) --------------------------------------------------------
int __cdecl sub_8058B80(int a1, int a2)
{
  int v2; // eax@2
  int v3; // eax@3
  int v4; // ebp@4
  void *v5; // esi@4
  int v6; // eax@4
  int v7; // edx@5
  int v8; // edx@5
  int v9; // edx@7
  int v10; // edx@7
  void *v11; // eax@9
  int v12; // edx@9
  int v13; // ebx@11
  int v14; // ecx@11
  int v15; // edi@11
  int v16; // edi@11
  int v17; // edi@13
  int v18; // edi@13
  void *v19; // eax@15
  int v20; // ebp@16
  int v21; // esi@17
  int v22; // eax@17
  void *v23; // edi@20
  void *v24; // ebx@20
  int v25; // eax@21
  int v26; // edx@21
  void *v27; // edi@26
  void *v28; // ebx@26
  int v29; // eax@27
  int v30; // edx@27
  int v31; // eax@32
  int v32; // edx@32
  int v33; // eax@33
  int result; // eax@38
  signed __int32 v35; // eax@42
  signed __int32 v36; // eax@46
  signed __int32 v37; // ecx@49
  signed __int32 v38; // ecx@50
  signed __int32 v39; // ebx@54
  signed __int32 v40; // eax@58
  signed __int32 v41; // ebx@62
  void *v42; // [sp+14h] [bp-58h]@16
  void *v43; // [sp+18h] [bp-54h]@15
  void *v44; // [sp+1Ch] [bp-50h]@7
  int v45; // [sp+20h] [bp-4Ch]@16
  int v46; // [sp+28h] [bp-44h]@16
  int v47; // [sp+2Ch] [bp-40h]@16
  int v48; // [sp+30h] [bp-3Ch]@16
  unsigned int v49; // [sp+34h] [bp-38h]@3
  int v50; // [sp+38h] [bp-34h]@4
  int v51; // [sp+3Ch] [bp-30h]@16
  char v52; // [sp+4Fh] [bp-1Dh]@44

  if ( -286331153 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2) )
  {
    v2 = -286331153 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
    if ( __CFADD__(v2, v2) || (unsigned int)(-572662306 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2)) > 0x4444444 )
    {
      v49 = -16;
      v3 = operator new(0xFFFFFFF0);
    }
    else
    {
      v49 = 8 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
      v3 = operator new(8 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2));
    }
  }
  else
  {
    v49 = 60;
    v3 = operator new(0x3Cu);
  }
  v4 = v3;
  v5 = *(void **)a1;
  v50 = v3 + 60;
  v6 = v3 + 4 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
  if ( v6 )
  {
    *(_DWORD *)v6 = *(_DWORD *)a2;
    *(_DWORD *)(v6 + 4) = *(_DWORD *)(a2 + 4);
    *(_DWORD *)(v6 + 8) = *(_DWORD *)(a2 + 8);
    *(_DWORD *)(a2 + 8) = &unk_80CF83C;
    *(_DWORD *)(v6 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(v6 + 16) = *(_DWORD *)(a2 + 16);
    *(_DWORD *)(v6 + 20) = *(_DWORD *)(a2 + 20);
    *(_DWORD *)(a2 + 20) = &unk_80CF83C;
    *(_DWORD *)(v6 + 24) = 0;
    *(_DWORD *)(v6 + 28) = 0;
    *(_DWORD *)(v6 + 32) = 0;
    *(_DWORD *)(v6 + 24) = *(_DWORD *)(a2 + 24);
    *(_DWORD *)(a2 + 24) = 0;
    v7 = *(_DWORD *)(v6 + 28);
    *(_DWORD *)(v6 + 28) = *(_DWORD *)(a2 + 28);
    *(_DWORD *)(a2 + 28) = v7;
    v8 = *(_DWORD *)(v6 + 32);
    *(_DWORD *)(v6 + 32) = *(_DWORD *)(a2 + 32);
    *(_DWORD *)(a2 + 32) = v8;
    *(_BYTE *)(v6 + 36) = 0;
    *(_DWORD *)(v6 + 40) = 0;
    if ( *(_BYTE *)(a2 + 36) )
    {
      *(_DWORD *)(v6 + 40) = *(_DWORD *)(a2 + 40);
      *(_BYTE *)(v6 + 36) = 1;
    }
    *(_DWORD *)(v6 + 44) = 0;
    *(_DWORD *)(v6 + 48) = 0;
    *(_DWORD *)(v6 + 52) = 0;
    *(_DWORD *)(v6 + 44) = *(_DWORD *)(a2 + 44);
    *(_DWORD *)(a2 + 44) = 0;
    v9 = *(_DWORD *)(v6 + 48);
    *(_DWORD *)(v6 + 48) = *(_DWORD *)(a2 + 48);
    *(_DWORD *)(a2 + 48) = v9;
    v10 = *(_DWORD *)(v6 + 52);
    *(_DWORD *)(v6 + 52) = *(_DWORD *)(a2 + 52);
    *(_DWORD *)(a2 + 52) = v10;
    *(_DWORD *)(v6 + 56) = *(_DWORD *)(a2 + 56);
    *(_DWORD *)(a2 + 56) = 0;
    v44 = *(void **)(a1 + 4);
    v5 = *(void **)a1;
  }
  else
  {
    v44 = *(void **)(a1 + 4);
  }
  if ( v44 != v5 )
  {
    v11 = v5;
    v12 = v4;
    do
    {
      if ( v12 )
      {
        *(_DWORD *)v12 = *(_DWORD *)v11;
        *(_DWORD *)(v12 + 4) = *((_DWORD *)v11 + 1);
        v13 = (_BYTE *)v11 - (_BYTE *)v5;
        v14 = v12 - v4;
        *(_DWORD *)(v4 + v14 + 8) = *((_DWORD *)v11 + 2);
        *(_DWORD *)((char *)v5 + v13 + 8) = &unk_80CF83C;
        *(_DWORD *)(v12 + 12) = *((_DWORD *)v11 + 3);
        *(_DWORD *)(v12 + 16) = *((_DWORD *)v11 + 4);
        *(_DWORD *)(v4 + v14 + 20) = *((_DWORD *)v11 + 5);
        *(_DWORD *)((char *)v5 + v13 + 20) = &unk_80CF83C;
        *(_DWORD *)(v14 + v4 + 24) = 0;
        *(_DWORD *)(v14 + v4 + 28) = 0;
        *(_DWORD *)(v14 + v4 + 32) = 0;
        *(_DWORD *)(v12 + 24) = *((_DWORD *)v11 + 6);
        *((_DWORD *)v11 + 6) = 0;
        v15 = *(_DWORD *)(v12 + 28);
        *(_DWORD *)(v12 + 28) = *((_DWORD *)v11 + 7);
        *((_DWORD *)v11 + 7) = v15;
        v16 = *(_DWORD *)(v12 + 32);
        *(_DWORD *)(v12 + 32) = *((_DWORD *)v11 + 8);
        *((_DWORD *)v11 + 8) = v16;
        *(_BYTE *)(v14 + v4 + 36) = 0;
        *(_DWORD *)(v12 + 40) = 0;
        if ( *((_BYTE *)v11 + 36) )
        {
          *(_DWORD *)(v12 + 40) = *((_DWORD *)v11 + 10);
          *(_BYTE *)(v12 + 36) = 1;
        }
        *(_DWORD *)(v12 + 44) = 0;
        *(_DWORD *)(v12 + 48) = 0;
        *(_DWORD *)(v12 + 52) = 0;
        *(_DWORD *)(v12 + 44) = *((_DWORD *)v11 + 11);
        *((_DWORD *)v11 + 11) = 0;
        v17 = *(_DWORD *)(v12 + 48);
        *(_DWORD *)(v12 + 48) = *((_DWORD *)v11 + 12);
        *((_DWORD *)v11 + 12) = v17;
        v18 = *(_DWORD *)(v12 + 52);
        *(_DWORD *)(v12 + 52) = *((_DWORD *)v11 + 13);
        *((_DWORD *)v11 + 13) = v18;
        *(_DWORD *)(v12 + 56) = *((_DWORD *)v11 + 14);
        *(_DWORD *)((char *)v5 + v13 + 56) = 0;
      }
      v11 = (char *)v11 + 60;
      v12 += 60;
    }
    while ( v11 != v44 );
    v50 = v4 + 20 * (3 * (787410671 * ((unsigned int)((_BYTE *)v44 - ((_BYTE *)v5 + 60)) >> 2) & 0x3FFFFFFF) + 3) + 60;
    v44 = *(void **)(a1 + 4);
    v19 = *(void **)a1;
    v43 = *(void **)a1;
    if ( v44 != *(void **)a1 )
    {
      v45 = (int)((char *)v19 + 28);
      v42 = *(void **)a1;
      v48 = (int)((char *)v19 + 56);
      v47 = (int)((char *)v19 + 20);
      v46 = (int)((char *)v19 + 8);
      v51 = v4;
      v20 = (int)((char *)v19 + 48);
      do
      {
        v21 = (_BYTE *)v42 - (_BYTE *)v43;
        v22 = *(_DWORD *)((_BYTE *)v42 - (_BYTE *)v43 + v48);
        if ( v22 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v22 + 4));
          if ( !v22 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v23 = *(void **)v20;
        v24 = *(void **)(v20 - 4);
        if ( *(void **)v20 != v24 )
        {
          do
          {
            v25 = *(_DWORD *)v24;
            v26 = *(_DWORD *)v24 - 12;
            if ( (_DWORD *)v26 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v35 = _InterlockedExchangeAdd((volatile signed __int32 *)(v25 - 4), 0xFFFFFFFF);
              }
              else
              {
                v38 = *(_DWORD *)(v25 - 4);
                *(_DWORD *)(v25 - 4) = v38 - 1;
                v35 = v38;
              }
              if ( v35 <= 0 )
                std::string::_Rep::_M_destroy(v26, &v52);
            }
            v24 = (char *)v24 + 4;
          }
          while ( v23 != v24 );
          v23 = (void *)*((_DWORD *)v42 + 11);
        }
        if ( v23 )
          operator delete(v23);
        v27 = *(void **)v45;
        v28 = *(void **)(v45 - 4);
        if ( *(void **)v45 != v28 )
        {
          do
          {
            v29 = *(_DWORD *)v28;
            v30 = *(_DWORD *)v28 - 12;
            if ( (_DWORD *)v30 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
              }
              else
              {
                v37 = *(_DWORD *)(v29 - 4);
                *(_DWORD *)(v29 - 4) = v37 - 1;
                v36 = v37;
              }
              if ( v36 <= 0 )
                std::string::_Rep::_M_destroy(v30, &v52);
            }
            v28 = (char *)v28 + 4;
          }
          while ( v27 != v28 );
          v27 = (void *)*((_DWORD *)v42 + 6);
        }
        if ( v27 )
          operator delete(v27);
        v31 = *(_DWORD *)(v21 + v47);
        v32 = v31 - 12;
        if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
          }
          else
          {
            v41 = *(_DWORD *)(v31 - 4);
            *(_DWORD *)(v31 - 4) = v41 - 1;
            v40 = v41;
          }
          if ( v40 <= 0 )
            std::string::_Rep::_M_destroy(v32, &v52);
        }
        v33 = *(_DWORD *)(v21 + v46);
        if ( (_DWORD *)(v33 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v33 - 4), 0xFFFFFFFF);
          }
          else
          {
            v39 = *(_DWORD *)(v33 - 4);
            *(_DWORD *)(v33 - 4) = v39 - 1;
          }
          if ( v39 <= 0 )
            std::string::_Rep::_M_destroy(v33 - 12, &v52);
        }
        v42 = (char *)v42 + 60;
        v45 += 60;
        v20 += 60;
      }
      while ( v44 != v42 );
      v4 = v51;
      v44 = *(void **)a1;
    }
  }
  if ( v44 )
    operator delete(v44);
  *(_DWORD *)a1 = v4;
  *(_DWORD *)(a1 + 4) = v50;
  result = v4 + v49;
  *(_DWORD *)(a1 + 8) = v4 + v49;
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08059130) --------------------------------------------------------
int __cdecl sub_8059130(int a1, int a2)
{
  int v2; // eax@1
  int v3; // ebx@3
  int v4; // ebx@3
  int v5; // ebx@5
  int v6; // ebx@5
  int result; // eax@6

  v2 = *(_DWORD *)(a1 + 4);
  if ( v2 == *(_DWORD *)(a1 + 8) )
  {
    result = sub_8058B80(a1, a2);
  }
  else
  {
    if ( v2 )
    {
      *(_DWORD *)v2 = *(_DWORD *)a2;
      *(_DWORD *)(v2 + 4) = *(_DWORD *)(a2 + 4);
      *(_DWORD *)(v2 + 8) = *(_DWORD *)(a2 + 8);
      *(_DWORD *)(a2 + 8) = &unk_80CF83C;
      *(_DWORD *)(v2 + 12) = *(_DWORD *)(a2 + 12);
      *(_DWORD *)(v2 + 16) = *(_DWORD *)(a2 + 16);
      *(_DWORD *)(v2 + 20) = *(_DWORD *)(a2 + 20);
      *(_DWORD *)(a2 + 20) = &unk_80CF83C;
      *(_DWORD *)(v2 + 24) = 0;
      *(_DWORD *)(v2 + 28) = 0;
      *(_DWORD *)(v2 + 32) = 0;
      *(_DWORD *)(v2 + 24) = *(_DWORD *)(a2 + 24);
      *(_DWORD *)(a2 + 24) = 0;
      v3 = *(_DWORD *)(v2 + 28);
      *(_DWORD *)(v2 + 28) = *(_DWORD *)(a2 + 28);
      *(_DWORD *)(a2 + 28) = v3;
      v4 = *(_DWORD *)(v2 + 32);
      *(_DWORD *)(v2 + 32) = *(_DWORD *)(a2 + 32);
      *(_DWORD *)(a2 + 32) = v4;
      *(_BYTE *)(v2 + 36) = 0;
      *(_DWORD *)(v2 + 40) = 0;
      if ( *(_BYTE *)(a2 + 36) )
      {
        *(_DWORD *)(v2 + 40) = *(_DWORD *)(a2 + 40);
        *(_BYTE *)(v2 + 36) = 1;
      }
      *(_DWORD *)(v2 + 44) = 0;
      *(_DWORD *)(v2 + 48) = 0;
      *(_DWORD *)(v2 + 52) = 0;
      *(_DWORD *)(v2 + 44) = *(_DWORD *)(a2 + 44);
      *(_DWORD *)(a2 + 44) = 0;
      v5 = *(_DWORD *)(v2 + 48);
      *(_DWORD *)(v2 + 48) = *(_DWORD *)(a2 + 48);
      *(_DWORD *)(a2 + 48) = v5;
      v6 = *(_DWORD *)(v2 + 52);
      *(_DWORD *)(v2 + 52) = *(_DWORD *)(a2 + 52);
      *(_DWORD *)(a2 + 52) = v6;
      *(_DWORD *)(v2 + 56) = *(_DWORD *)(a2 + 56);
      *(_DWORD *)(a2 + 56) = 0;
      v2 = *(_DWORD *)(a1 + 4);
    }
    result = v2 + 60;
    *(_DWORD *)(a1 + 4) = result;
  }
  return result;
}

//----- (08059240) --------------------------------------------------------
int __cdecl sub_8059240(int a1, int a2)
{
  int v2; // eax@1
  unsigned __int8 v3; // cf@2
  int v4; // eax@2
  int v5; // eax@3
  int v6; // ebp@4
  void *v7; // esi@4
  void *v8; // edx@4
  unsigned int v9; // eax@4
  int v10; // edx@5
  int v11; // edx@5
  int v12; // edx@7
  int v13; // edx@7
  void *v14; // eax@8
  int v15; // edx@8
  int v16; // ebx@10
  int v17; // ecx@10
  int v18; // edi@10
  int v19; // edi@10
  int v20; // edi@12
  int v21; // edi@12
  void *v22; // eax@14
  int v23; // ebp@15
  int v24; // esi@16
  int v25; // eax@16
  int v26; // eax@19
  void *v27; // edi@22
  void *v28; // ebx@22
  int v29; // eax@23
  int v30; // edx@23
  void *v31; // edi@28
  void *v32; // ebx@28
  int v33; // eax@29
  int v34; // edx@29
  int v35; // eax@34
  int v36; // edx@34
  int v37; // eax@35
  int result; // eax@40
  signed __int32 v39; // eax@45
  signed __int32 v40; // eax@49
  signed __int32 v41; // ecx@52
  signed __int32 v42; // ecx@53
  signed __int32 v43; // ebx@57
  signed __int32 v44; // eax@61
  signed __int32 v45; // ebx@65
  void *v46; // [sp+10h] [bp-5Ch]@15
  void *v47; // [sp+14h] [bp-58h]@7
  void *v48; // [sp+14h] [bp-58h]@14
  int v49; // [sp+18h] [bp-54h]@15
  void *v50; // [sp+20h] [bp-4Ch]@14
  int v51; // [sp+24h] [bp-48h]@15
  int v52; // [sp+28h] [bp-44h]@15
  int v53; // [sp+2Ch] [bp-40h]@15
  int v54; // [sp+30h] [bp-3Ch]@15
  unsigned int v55; // [sp+34h] [bp-38h]@3
  int v56; // [sp+38h] [bp-34h]@4
  int v57; // [sp+3Ch] [bp-30h]@15
  char v58; // [sp+4Fh] [bp-1Dh]@47

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 6;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFF )
    {
      v55 = -64;
      v5 = operator new(0xFFFFFFC0);
    }
    else
    {
      v55 = v4 << 6;
      v5 = operator new(v4 << 6);
    }
  }
  else
  {
    v55 = 64;
    v5 = operator new(0x40u);
  }
  v6 = v5;
  v7 = *(void **)a1;
  v8 = *(void **)(a1 + 4);
  v56 = v5 + 64;
  v9 = v5 + ((unsigned int)((char *)v8 - *(_DWORD *)a1) & 0xFFFFFFC0);
  if ( v9 )
  {
    *(_DWORD *)v9 = *(_DWORD *)a2;
    *(_DWORD *)(v9 + 4) = *(_DWORD *)(a2 + 4);
    *(_DWORD *)(v9 + 8) = *(_DWORD *)(a2 + 8);
    *(_DWORD *)(a2 + 8) = &unk_80CF83C;
    *(_DWORD *)(v9 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(v9 + 16) = *(_DWORD *)(a2 + 16);
    *(_DWORD *)(v9 + 20) = *(_DWORD *)(a2 + 20);
    *(_DWORD *)(a2 + 20) = &unk_80CF83C;
    *(_DWORD *)(v9 + 24) = 0;
    *(_DWORD *)(v9 + 28) = 0;
    *(_DWORD *)(v9 + 32) = 0;
    *(_DWORD *)(v9 + 24) = *(_DWORD *)(a2 + 24);
    *(_DWORD *)(a2 + 24) = 0;
    v10 = *(_DWORD *)(v9 + 28);
    *(_DWORD *)(v9 + 28) = *(_DWORD *)(a2 + 28);
    *(_DWORD *)(a2 + 28) = v10;
    v11 = *(_DWORD *)(v9 + 32);
    *(_DWORD *)(v9 + 32) = *(_DWORD *)(a2 + 32);
    *(_DWORD *)(a2 + 32) = v11;
    *(_BYTE *)(v9 + 36) = 0;
    *(_DWORD *)(v9 + 40) = 0;
    if ( *(_BYTE *)(a2 + 36) )
    {
      *(_DWORD *)(v9 + 40) = *(_DWORD *)(a2 + 40);
      *(_BYTE *)(v9 + 36) = 1;
    }
    *(_DWORD *)(v9 + 44) = 0;
    *(_DWORD *)(v9 + 48) = 0;
    *(_DWORD *)(v9 + 52) = 0;
    *(_DWORD *)(v9 + 44) = *(_DWORD *)(a2 + 44);
    *(_DWORD *)(a2 + 44) = 0;
    v12 = *(_DWORD *)(v9 + 48);
    *(_DWORD *)(v9 + 48) = *(_DWORD *)(a2 + 48);
    *(_DWORD *)(a2 + 48) = v12;
    v13 = *(_DWORD *)(v9 + 52);
    *(_DWORD *)(v9 + 52) = *(_DWORD *)(a2 + 52);
    *(_DWORD *)(a2 + 52) = v13;
    *(_DWORD *)(v9 + 56) = *(_DWORD *)(a2 + 56);
    *(_DWORD *)(a2 + 56) = 0;
    *(_DWORD *)(v9 + 60) = *(_DWORD *)(a2 + 60);
    *(_DWORD *)(a2 + 60) = 0;
    v47 = *(void **)(a1 + 4);
    v7 = *(void **)a1;
    if ( *(void **)a1 != v47 )
      goto LABEL_8;
LABEL_43:
    v50 = v7;
    goto LABEL_38;
  }
  v47 = *(void **)(a1 + 4);
  if ( v7 == v8 )
    goto LABEL_43;
LABEL_8:
  v14 = v7;
  v15 = v6;
  do
  {
    if ( v15 )
    {
      *(_DWORD *)v15 = *(_DWORD *)v14;
      *(_DWORD *)(v15 + 4) = *((_DWORD *)v14 + 1);
      v16 = (_BYTE *)v14 - (_BYTE *)v7;
      v17 = v15 - v6;
      *(_DWORD *)(v6 + v17 + 8) = *((_DWORD *)v14 + 2);
      *(_DWORD *)((char *)v7 + v16 + 8) = &unk_80CF83C;
      *(_DWORD *)(v15 + 12) = *((_DWORD *)v14 + 3);
      *(_DWORD *)(v15 + 16) = *((_DWORD *)v14 + 4);
      *(_DWORD *)(v6 + v17 + 20) = *((_DWORD *)v14 + 5);
      *(_DWORD *)((char *)v7 + v16 + 20) = &unk_80CF83C;
      *(_DWORD *)(v17 + v6 + 24) = 0;
      *(_DWORD *)(v17 + v6 + 28) = 0;
      *(_DWORD *)(v17 + v6 + 32) = 0;
      *(_DWORD *)(v15 + 24) = *((_DWORD *)v14 + 6);
      *((_DWORD *)v14 + 6) = 0;
      v18 = *(_DWORD *)(v15 + 28);
      *(_DWORD *)(v15 + 28) = *((_DWORD *)v14 + 7);
      *((_DWORD *)v14 + 7) = v18;
      v19 = *(_DWORD *)(v15 + 32);
      *(_DWORD *)(v15 + 32) = *((_DWORD *)v14 + 8);
      *((_DWORD *)v14 + 8) = v19;
      *(_BYTE *)(v17 + v6 + 36) = 0;
      *(_DWORD *)(v15 + 40) = 0;
      if ( *((_BYTE *)v14 + 36) )
      {
        *(_DWORD *)(v15 + 40) = *((_DWORD *)v14 + 10);
        *(_BYTE *)(v15 + 36) = 1;
      }
      *(_DWORD *)(v15 + 44) = 0;
      *(_DWORD *)(v15 + 48) = 0;
      *(_DWORD *)(v15 + 52) = 0;
      *(_DWORD *)(v15 + 44) = *((_DWORD *)v14 + 11);
      *((_DWORD *)v14 + 11) = 0;
      v20 = *(_DWORD *)(v15 + 48);
      *(_DWORD *)(v15 + 48) = *((_DWORD *)v14 + 12);
      *((_DWORD *)v14 + 12) = v20;
      v21 = *(_DWORD *)(v15 + 52);
      *(_DWORD *)(v15 + 52) = *((_DWORD *)v14 + 13);
      *((_DWORD *)v14 + 13) = v21;
      *(_DWORD *)(v15 + 56) = *((_DWORD *)v14 + 14);
      *(_DWORD *)((char *)v7 + v16 + 56) = 0;
      *(_DWORD *)(v15 + 60) = *((_DWORD *)v14 + 15);
      *(_DWORD *)((char *)v7 + v16 + 60) = 0;
    }
    v14 = (char *)v14 + 64;
    v15 += 64;
  }
  while ( v14 != v47 );
  v56 = v6 + (((_BYTE *)v14 - ((_BYTE *)v7 + 64)) & 0xFFFFFFC0) + 128;
  v50 = *(void **)(a1 + 4);
  v22 = *(void **)a1;
  v48 = *(void **)a1;
  if ( v50 != *(void **)a1 )
  {
    v49 = (int)((char *)v22 + 28);
    v46 = *(void **)a1;
    v54 = (int)((char *)v22 + 60);
    v53 = (int)((char *)v22 + 56);
    v52 = (int)((char *)v22 + 20);
    v51 = (int)((char *)v22 + 8);
    v57 = v6;
    v23 = (int)((char *)v22 + 48);
    do
    {
      v24 = (_BYTE *)v46 - (_BYTE *)v48;
      v25 = *(_DWORD *)((_BYTE *)v46 - (_BYTE *)v48 + v54);
      if ( v25 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v25 + 4));
        if ( !v25 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v26 = *(_DWORD *)(v24 + v53);
      if ( v26 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v26 + 4));
        if ( !v26 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      v27 = *(void **)v23;
      v28 = *(void **)(v23 - 4);
      if ( *(void **)v23 != v28 )
      {
        do
        {
          v29 = *(_DWORD *)v28;
          v30 = *(_DWORD *)v28 - 12;
          if ( (_DWORD *)v30 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
            }
            else
            {
              v42 = *(_DWORD *)(v29 - 4);
              *(_DWORD *)(v29 - 4) = v42 - 1;
              v39 = v42;
            }
            if ( v39 <= 0 )
              std::string::_Rep::_M_destroy(v30, &v58);
          }
          v28 = (char *)v28 + 4;
        }
        while ( v27 != v28 );
        v27 = (void *)*((_DWORD *)v46 + 11);
      }
      if ( v27 )
        operator delete(v27);
      v31 = *(void **)v49;
      v32 = *(void **)(v49 - 4);
      if ( *(void **)v49 != v32 )
      {
        do
        {
          v33 = *(_DWORD *)v32;
          v34 = *(_DWORD *)v32 - 12;
          if ( (_DWORD *)v34 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v33 - 4), 0xFFFFFFFF);
            }
            else
            {
              v41 = *(_DWORD *)(v33 - 4);
              *(_DWORD *)(v33 - 4) = v41 - 1;
              v40 = v41;
            }
            if ( v40 <= 0 )
              std::string::_Rep::_M_destroy(v34, &v58);
          }
          v32 = (char *)v32 + 4;
        }
        while ( v31 != v32 );
        v31 = (void *)*((_DWORD *)v46 + 6);
      }
      if ( v31 )
        operator delete(v31);
      v35 = *(_DWORD *)(v24 + v52);
      v36 = v35 - 12;
      if ( (_DWORD *)(v35 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v44 = _InterlockedExchangeAdd((volatile signed __int32 *)(v35 - 4), 0xFFFFFFFF);
        }
        else
        {
          v45 = *(_DWORD *)(v35 - 4);
          *(_DWORD *)(v35 - 4) = v45 - 1;
          v44 = v45;
        }
        if ( v44 <= 0 )
          std::string::_Rep::_M_destroy(v36, &v58);
      }
      v37 = *(_DWORD *)(v24 + v51);
      if ( (_DWORD *)(v37 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v43 = _InterlockedExchangeAdd((volatile signed __int32 *)(v37 - 4), 0xFFFFFFFF);
        }
        else
        {
          v43 = *(_DWORD *)(v37 - 4);
          *(_DWORD *)(v37 - 4) = v43 - 1;
        }
        if ( v43 <= 0 )
          std::string::_Rep::_M_destroy(v37 - 12, &v58);
      }
      v46 = (char *)v46 + 64;
      v49 += 64;
      v23 += 64;
    }
    while ( v50 != v46 );
    v6 = v57;
    v50 = *(void **)a1;
  }
LABEL_38:
  if ( v50 )
    operator delete(v50);
  *(_DWORD *)a1 = v6;
  *(_DWORD *)(a1 + 4) = v56;
  result = v6 + v55;
  *(_DWORD *)(a1 + 8) = v6 + v55;
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (080597C0) --------------------------------------------------------
int __cdecl sub_80597C0(int a1, int a2)
{
  int v2; // eax@1
  int v3; // ebx@3
  int v4; // ebx@3
  int v5; // ebx@5
  int v6; // ebx@5
  int result; // eax@6

  v2 = *(_DWORD *)(a1 + 4);
  if ( v2 == *(_DWORD *)(a1 + 8) )
  {
    result = sub_8059240(a1, a2);
  }
  else
  {
    if ( v2 )
    {
      *(_DWORD *)v2 = *(_DWORD *)a2;
      *(_DWORD *)(v2 + 4) = *(_DWORD *)(a2 + 4);
      *(_DWORD *)(v2 + 8) = *(_DWORD *)(a2 + 8);
      *(_DWORD *)(a2 + 8) = &unk_80CF83C;
      *(_DWORD *)(v2 + 12) = *(_DWORD *)(a2 + 12);
      *(_DWORD *)(v2 + 16) = *(_DWORD *)(a2 + 16);
      *(_DWORD *)(v2 + 20) = *(_DWORD *)(a2 + 20);
      *(_DWORD *)(a2 + 20) = &unk_80CF83C;
      *(_DWORD *)(v2 + 24) = 0;
      *(_DWORD *)(v2 + 28) = 0;
      *(_DWORD *)(v2 + 32) = 0;
      *(_DWORD *)(v2 + 24) = *(_DWORD *)(a2 + 24);
      *(_DWORD *)(a2 + 24) = 0;
      v3 = *(_DWORD *)(v2 + 28);
      *(_DWORD *)(v2 + 28) = *(_DWORD *)(a2 + 28);
      *(_DWORD *)(a2 + 28) = v3;
      v4 = *(_DWORD *)(v2 + 32);
      *(_DWORD *)(v2 + 32) = *(_DWORD *)(a2 + 32);
      *(_DWORD *)(a2 + 32) = v4;
      *(_BYTE *)(v2 + 36) = 0;
      *(_DWORD *)(v2 + 40) = 0;
      if ( *(_BYTE *)(a2 + 36) )
      {
        *(_DWORD *)(v2 + 40) = *(_DWORD *)(a2 + 40);
        *(_BYTE *)(v2 + 36) = 1;
      }
      *(_DWORD *)(v2 + 44) = 0;
      *(_DWORD *)(v2 + 48) = 0;
      *(_DWORD *)(v2 + 52) = 0;
      *(_DWORD *)(v2 + 44) = *(_DWORD *)(a2 + 44);
      *(_DWORD *)(a2 + 44) = 0;
      v5 = *(_DWORD *)(v2 + 48);
      *(_DWORD *)(v2 + 48) = *(_DWORD *)(a2 + 48);
      *(_DWORD *)(a2 + 48) = v5;
      v6 = *(_DWORD *)(v2 + 52);
      *(_DWORD *)(v2 + 52) = *(_DWORD *)(a2 + 52);
      *(_DWORD *)(a2 + 52) = v6;
      *(_DWORD *)(v2 + 56) = *(_DWORD *)(a2 + 56);
      *(_DWORD *)(a2 + 56) = 0;
      *(_DWORD *)(v2 + 60) = *(_DWORD *)(a2 + 60);
      *(_DWORD *)(a2 + 60) = 0;
      v2 = *(_DWORD *)(a1 + 4);
    }
    result = v2 + 64;
    *(_DWORD *)(a1 + 4) = result;
  }
  return result;
}

//----- (080598E0) --------------------------------------------------------
int __userpurge sub_80598E0@<eax>(int a1, int a2, int a3, unsigned int a4, int a5)
{
  int v5; // esi@1
  int v6; // ebx@1
  int v7; // eax@2
  int v8; // ecx@2
  int v9; // edi@7
  int v10; // edx@7
  int v11; // ebx@7
  int v12; // ecx@12
  int v13; // eax@12
  int result; // eax@14
  int v15; // [sp+1Ch] [bp-2Ch]@2
  int v16; // [sp+20h] [bp-28h]@2
  unsigned int v17; // [sp+24h] [bp-24h]@1
  char v18; // [sp+28h] [bp-20h]@1
  unsigned int v19; // [sp+2Ch] [bp-1Ch]@1

  v5 = a2;
  v6 = *(_DWORD *)(a2 + 20);
  std::__detail::_Prime_rehash_policy::_M_need_rehash(
    (std::__detail::_Prime_rehash_policy *)&v18,
    a2 + 16,
    *(_DWORD *)(a2 + 4),
    *(_DWORD *)(a2 + 12));
  v17 = v19;
  if ( !v18 )
    goto LABEL_12;
  sub_804E260(v19);
  v15 = v7;
  v8 = *(_DWORD *)(a2 + 8);
  *(_DWORD *)(a2 + 8) = 0;
  v16 = 0;
  if ( !v8 )
    goto LABEL_11;
  while ( 1 )
  {
    v9 = *(_DWORD *)v8;
    v10 = *(_DWORD *)(v8 + 80) % v17;
    v11 = v7 + 4 * v10;
    if ( *(_DWORD *)v11 )
    {
      *(_DWORD *)v8 = **(_DWORD **)v11;
      **(_DWORD **)v11 = v8;
      goto LABEL_5;
    }
    *(_DWORD *)v8 = *(_DWORD *)(a2 + 8);
    *(_DWORD *)(a2 + 8) = v8;
    *(_DWORD *)v11 = a2 + 8;
    if ( *(_DWORD *)v8 )
      break;
    v16 = v10;
LABEL_5:
    if ( !v9 )
      goto LABEL_10;
LABEL_6:
    v8 = v9;
  }
  *(_DWORD *)(v7 + 4 * v16) = v8;
  v16 = v10;
  if ( v9 )
    goto LABEL_6;
LABEL_10:
  v5 = a2;
LABEL_11:
  operator delete(*(void **)v5);
  *(_DWORD *)(v5 + 4) = v17;
  *(_DWORD *)v5 = v15;
  a3 = a4 % v17;
LABEL_12:
  *(_DWORD *)(a5 + 80) = a4;
  v12 = 4 * a3;
  v13 = *(_DWORD *)(*(_DWORD *)v5 + 4 * a3);
  if ( v13 )
  {
    *(_DWORD *)a5 = *(_DWORD *)v13;
    **(_DWORD **)(*(_DWORD *)v5 + v12) = a5;
  }
  else
  {
    *(_DWORD *)a5 = *(_DWORD *)(v5 + 8);
    *(_DWORD *)(v5 + 8) = a5;
    if ( *(_DWORD *)a5 )
      *(_DWORD *)(*(_DWORD *)v5 + 4 * (*(_DWORD *)(*(_DWORD *)a5 + 80) % *(_DWORD *)(v5 + 4))) = a5;
    *(_DWORD *)(*(_DWORD *)v5 + v12) = v5 + 8;
  }
  ++*(_DWORD *)(v5 + 12);
  result = a1;
  *(_DWORD *)a1 = a5;
  return result;
}

//----- (08059AA0) --------------------------------------------------------
int __cdecl sub_8059AA0(int a1, int a2, int a3, int a4)
{
  int result; // eax@1
  int v5; // esi@2
  int v6; // ebx@3

  result = *(_DWORD *)(*(_DWORD *)a1 + 4 * a2);
  if ( result )
  {
    v5 = *(_DWORD *)result;
    if ( a4 == *(_DWORD *)(*(_DWORD *)result + 80) )
      goto LABEL_6;
    while ( 1 )
    {
      v6 = *(_DWORD *)v5;
      if ( !*(_DWORD *)v5 || a2 != *(_DWORD *)(v6 + 80) % *(_DWORD *)(a1 + 4) )
        break;
      result = v5;
      v5 = *(_DWORD *)v5;
      if ( a4 == *(_DWORD *)(v6 + 80) )
      {
LABEL_6:
        if ( *(_DWORD *)a3 == *(_DWORD *)(v5 + 4) )
          return result;
      }
    }
  }
  return 0;
}

//----- (08059B00) --------------------------------------------------------
int __userpurge sub_8059B00@<eax>(int a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  int v5; // ebx@1
  int v6; // eax@2
  int v7; // eax@2
  int v8; // eax@2
  int v9; // eax@2
  int v10; // eax@2
  int v11; // eax@2
  int v12; // ST20_4@2
  int v13; // ST24_4@2
  int v14; // edx@2
  int v15; // eax@2
  int v16; // eax@2
  unsigned int v17; // edi@3
  int v18; // ST20_4@3
  int v19; // eax@3
  int v20; // edx@3
  int result; // eax@5
  int v22; // [sp+20h] [bp-28h]@4
  int v23; // [sp+2Ch] [bp-1Ch]@6

  v4 = operator new(0x54u);
  v5 = v4;
  if ( v4 )
  {
    *(_DWORD *)v4 = 0;
    *(_DWORD *)(v4 + 4) = *(_DWORD *)a4;
    *(_DWORD *)a4 = 0;
    *(_DWORD *)(v4 + 8) = 0;
    *(_DWORD *)(v4 + 12) = 0;
    *(_DWORD *)(v4 + 16) = 0;
    *(_DWORD *)(v4 + 8) = *(_DWORD *)(a4 + 4);
    *(_DWORD *)(a4 + 4) = 0;
    v6 = *(_DWORD *)(v4 + 12);
    *(_DWORD *)(v5 + 12) = *(_DWORD *)(a4 + 8);
    *(_DWORD *)(a4 + 8) = v6;
    v7 = *(_DWORD *)(v5 + 16);
    *(_DWORD *)(v5 + 16) = *(_DWORD *)(a4 + 12);
    *(_DWORD *)(a4 + 12) = v7;
    *(_DWORD *)(v5 + 20) = *(_DWORD *)(a4 + 16);
    *(_DWORD *)(a4 + 16) = 0;
    *(_BYTE *)(v5 + 24) = *(_BYTE *)(a4 + 20);
    *(_BYTE *)(v5 + 25) = *(_BYTE *)(a4 + 21);
    *(_BYTE *)(v5 + 26) = *(_BYTE *)(a4 + 22);
    *(_DWORD *)(v5 + 28) = *(_DWORD *)(a4 + 24);
    *(_DWORD *)(v5 + 32) = *(_DWORD *)(a4 + 28);
    *(_DWORD *)(v5 + 36) = 0;
    *(_DWORD *)(v5 + 40) = 0;
    *(_DWORD *)(v5 + 44) = 0;
    *(_DWORD *)(v5 + 36) = *(_DWORD *)(a4 + 32);
    *(_DWORD *)(a4 + 32) = 0;
    v8 = *(_DWORD *)(v5 + 40);
    *(_DWORD *)(v5 + 40) = *(_DWORD *)(a4 + 36);
    *(_DWORD *)(a4 + 36) = v8;
    v9 = *(_DWORD *)(v5 + 44);
    *(_DWORD *)(v5 + 44) = *(_DWORD *)(a4 + 40);
    *(_DWORD *)(a4 + 40) = v9;
    *(_DWORD *)(v5 + 48) = 0;
    *(_DWORD *)(v5 + 52) = 0;
    *(_DWORD *)(v5 + 56) = 0;
    *(_DWORD *)(v5 + 48) = *(_DWORD *)(a4 + 44);
    *(_DWORD *)(a4 + 44) = 0;
    v10 = *(_DWORD *)(v5 + 52);
    *(_DWORD *)(v5 + 52) = *(_DWORD *)(a4 + 48);
    *(_DWORD *)(a4 + 48) = v10;
    v11 = *(_DWORD *)(v5 + 56);
    *(_DWORD *)(v5 + 56) = *(_DWORD *)(a4 + 52);
    *(_DWORD *)(a4 + 52) = v11;
    *(_DWORD *)(v5 + 60) = *(_DWORD *)(a4 + 56);
    *(_DWORD *)(v5 + 72) = 0;
    v12 = *(_DWORD *)(a4 + 60);
    v13 = *(_DWORD *)(a4 + 64);
    v14 = *(_DWORD *)(v5 + 68);
    *(_DWORD *)(a4 + 60) = *(_DWORD *)(v5 + 64);
    *(_DWORD *)(a4 + 64) = v14;
    *(_DWORD *)(v5 + 64) = v12;
    *(_DWORD *)(v5 + 68) = v13;
    v15 = *(_DWORD *)(a4 + 68);
    *(_DWORD *)(a4 + 68) = *(_DWORD *)(v5 + 72);
    *(_DWORD *)(v5 + 72) = v15;
    v16 = *(_DWORD *)(a4 + 72);
    *(_DWORD *)(a4 + 72) = *(_DWORD *)(v5 + 76);
    *(_DWORD *)(v5 + 76) = v16;
    *(_DWORD *)(v5 + 80) = 0;
  }
  v17 = *(_DWORD *)(v5 + 4);
  v18 = v17 % *(_DWORD *)(a2 + 4);
  v19 = sub_8059AA0(a2, v18, v5 + 4, *(_DWORD *)(v5 + 4));
  v20 = v18;
  if ( v19 && (v22 = *(_DWORD *)v19) != 0 )
  {
    sub_804E310(v5);
    *(_DWORD *)a1 = v22;
    *(_BYTE *)(a1 + 4) = 0;
    result = a1;
  }
  else
  {
    sub_80598E0((int)&v23, a2, v20, v17, v5);
    *(_DWORD *)a1 = v23;
    *(_BYTE *)(a1 + 4) = 1;
    result = a1;
  }
  return result;
}

//----- (08059D00) --------------------------------------------------------
int __userpurge sub_8059D00@<eax>(int a1, int a2, int *a3)
{
  int v3; // eax@1
  int v4; // eax@2
  int result; // eax@3

  v3 = sub_8059AA0(a2, (unsigned int)*a3 % *(_DWORD *)(a2 + 4), (int)a3, *a3);
  if ( v3 && (v4 = *(_DWORD *)v3) != 0 )
  {
    *(_DWORD *)a1 = v4;
    result = a1;
  }
  else
  {
    *(_DWORD *)a1 = 0;
    result = a1;
  }
  return result;
}

//----- (08059D60) --------------------------------------------------------
int __usercall std::string::_S_construct<char *>@<eax>(int a1@<ebx>, unsigned int a2@<ebp>, void *a3@<edi>, int a4, int a5, int a6)
{
  const void *v6; // esi@1
  int result; // eax@3
  signed int v8; // ecx@9
  int v9; // [sp+18h] [bp-24h]@0

  v6 = (const void *)a4;
  if ( a4 == a5 )
    return (int)&unk_80CF83C;
  if ( a4 )
  {
    a1 = a5 - a4;
    v9 = std::string::_Rep::_S_create(a5 - a4, 0, a6);
    result = v9 + 12;
    if ( a5 - a4 == 1 )
    {
      *(_BYTE *)(v9 + 12) = *(_BYTE *)a4;
      goto LABEL_5;
    }
  }
  else
  {
    if ( a5 )
    {
      result = std::__throw_logic_error("basic_string::_S_construct null not valid");
LABEL_21:
      *(_WORD *)a3 = *(_WORD *)v6;
      a3 = (char *)a3 + 2;
      v6 = (char *)v6 + 2;
      a2 -= 2;
      goto LABEL_16;
    }
    v9 = std::string::_Rep::_S_create(0, 0, a6);
    result = v9 + 12;
    a1 = 0;
  }
  a2 = a1;
  a3 = (void *)result;
  if ( (unsigned int)a1 < 4 )
  {
    v8 = 0;
    if ( !(a1 & 2) )
      goto LABEL_10;
    goto LABEL_12;
  }
  if ( result & 1 )
  {
    *(_BYTE *)result = *(_BYTE *)a4;
    a3 = (void *)(result + 1);
    v6 = (const void *)(a4 + 1);
    a2 = a1 - 1;
  }
  if ( (unsigned __int8)a3 & 2 )
    goto LABEL_21;
LABEL_16:
  qmemcpy(a3, v6, 4 * (a2 >> 2));
  v6 = (char *)v6 + 4 * (a2 >> 2);
  a3 = (char *)a3 + 4 * (a2 >> 2);
  v8 = 0;
  if ( !(a2 & 2) )
  {
LABEL_10:
    if ( !(a2 & 1) )
      goto LABEL_5;
    goto LABEL_11;
  }
LABEL_12:
  *(_WORD *)a3 = *(_WORD *)v6;
  v8 = 2;
  if ( a2 & 1 )
LABEL_11:
    *((_BYTE *)a3 + v8) = *((_BYTE *)v6 + v8);
LABEL_5:
  if ( (_DWORD *)v9 != &std::string::_Rep::_S_empty_rep_storage )
  {
    *(_DWORD *)(v9 + 8) = 0;
    *(_DWORD *)v9 = a1;
    *(_BYTE *)(result + a1) = 0;
  }
  return result;
}
// 804D180: using guessed type int __cdecl std::string::_Rep::_S_create(_DWORD, _DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08059EC0) --------------------------------------------------------
int __cdecl sub_8059EC0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80B9AB8;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    *a1 = (void *)operator new(1u);
    result = 0;
  }
  return result;
}
// 80B9AB8: using guessed type void *off_80B9AB8;

//----- (08059F50) --------------------------------------------------------
int __cdecl init_loglevel(std::string *a1)
{
  int result; // eax@1

  result = std::string::compare(a1, "none");
  if ( result )
  {
    result = std::string::compare(a1, "error");
    if ( result )
    {
      result = std::string::compare(a1, "warn");
      if ( result )
      {
        result = std::string::compare(a1, "notice");
        if ( result )
        {
          result = std::string::compare(a1, "info");
          if ( result )
          {
            result = std::string::compare(a1, "debug") == 0;
            log_level = result;
          }
          else
          {
            log_level = 2;
          }
        }
        else
        {
          log_level = 3;
        }
      }
      else
      {
        log_level = 4;
      }
    }
    else
    {
      log_level = 5;
    }
  }
  else
  {
    log_level = 6;
  }
  return result;
}
// 80CF874: using guessed type int log_level;

//----- (0805A050) --------------------------------------------------------
int __cdecl sub_805A050(char *s)
{
  unsigned int v1; // ebp@0
  int v2; // esi@5
  int v3; // ebx@5
  size_t v4; // eax@6
  int v5; // eax@7
  int v6; // edx@8
  int v7; // ebx@10
  int v8; // ebx@11
  int v9; // eax@13
  std::ostream *v10; // esi@13
  int v11; // eax@13
  int v12; // ebx@13
  char v13; // al@15
  std::ostream *v14; // eax@16
  int v15; // edx@17
  int v17; // ebx@20
  char *v18; // eax@21
  void *v19; // edi@22
  int v20; // esi@22
  unsigned int v21; // edx@22
  int v22; // eax@27
  int v23; // ebx@27
  void *v24; // ebx@29
  size_t v25; // esi@30
  const void *v26; // eax@32
  size_t v27; // edi@32
  size_t v28; // ecx@32
  int v29; // eax@34
  const void *v30; // eax@39
  size_t v31; // ebx@39
  size_t v32; // edx@39
  int v33; // eax@41
  int v34; // ecx@44
  int v35; // eax@45
  int v36; // edx@45
  int (__cdecl *v37)(int, int, signed int); // ebx@45
  signed int (__cdecl *v38)(int); // ST3C_4@45
  int v39; // edi@45
  int v40; // eax@45
  int v41; // ebx@47
  int v42; // eax@56
  int v43; // ebx@56
  void *v44; // ebx@58
  size_t v45; // esi@59
  const void *v46; // eax@61
  size_t v47; // edi@61
  size_t v48; // ecx@61
  int v49; // eax@63
  const void *v50; // eax@68
  size_t v51; // ebx@68
  size_t v52; // edx@68
  int v53; // eax@70
  int v54; // ecx@73
  int v55; // eax@74
  int v56; // edx@74
  int (__cdecl *v57)(int, int, signed int); // ebx@74
  signed int (__cdecl *v58)(int); // ST3C_4@74
  int v59; // edi@74
  int v60; // eax@74
  int v61; // ebx@76
  int v62; // eax@85
  int v63; // ebx@85
  void *v64; // ebx@87
  const void *v65; // esi@88
  const void *v66; // eax@90
  size_t v67; // edi@90
  size_t v68; // ecx@90
  int v69; // eax@92
  const void *v70; // eax@97
  size_t v71; // ebx@97
  size_t v72; // edx@97
  int v73; // eax@99
  int v74; // ecx@102
  int v75; // eax@103
  int v76; // edx@103
  int (__cdecl *v77)(int, int, signed int); // ebx@103
  signed int (__cdecl *v78)(int); // ST3C_4@103
  int v79; // edi@103
  int v80; // eax@103
  char *v81; // ebx@105
  int v82; // eax@114
  int v83; // eax@114
  int v84; // eax@114
  int v85; // eax@114
  int v86; // eax@114
  int v87; // ebx@114
  int v88; // eax@114
  int v89; // ebx@114
  int v90; // eax@116
  int v91; // ebx@116
  int v92; // eax@118
  int v93; // eax@118
  int v94; // eax@118
  int v95; // eax@118
  int v96; // eax@118
  int v97; // ebx@118
  int v98; // eax@118
  int v99; // eax@120
  int v100; // ebx@120
  int v101; // ebx@122
  size_t v102; // esi@123
  const void *v103; // eax@125
  size_t v104; // edi@125
  size_t v105; // ecx@125
  int v106; // eax@127
  const void *v107; // eax@132
  size_t v108; // ebx@132
  size_t v109; // edx@132
  int v110; // eax@134
  int v111; // ecx@137
  int v112; // eax@138
  int v113; // edx@138
  int (__cdecl *v114)(int, int, signed int); // ebx@138
  signed int (__cdecl *v115)(int); // ST3C_4@138
  int v116; // edi@138
  int v117; // eax@138
  int v118; // ebx@140
  int v119; // eax@149
  int v120; // ebx@149
  int v121; // eax@151
  int v122; // ebx@151
  int v123; // eax@151
  int v124; // ebx@151
  int v125; // eax@153
  int v126; // ebx@153
  int v127; // ebx@155
  int v128; // ebx@157
  size_t v129; // esi@158
  const void *v130; // eax@160
  size_t v131; // edi@160
  size_t v132; // ecx@160
  int v133; // eax@162
  const void *v134; // eax@167
  size_t v135; // ebx@167
  size_t v136; // edx@167
  int v137; // eax@169
  int v138; // ecx@172
  int v139; // eax@173
  int v140; // edx@173
  int (__cdecl *v141)(int, int, signed int); // ebx@173
  signed int (__cdecl *v142)(int); // ST3C_4@173
  int v143; // edi@173
  int v144; // eax@173
  int v145; // ebx@175
  int v146; // eax@184
  int v147; // eax@184
  int v148; // eax@188
  signed int v149; // eax@190
  signed int v150; // ebx@190
  void *v151; // ebx@199
  int v152; // eax@199
  const void *v153; // eax@202
  size_t v154; // ecx@202
  int v155; // eax@204
  const void *v156; // eax@209
  unsigned int v157; // ebx@209
  size_t v158; // edx@209
  int v159; // eax@211
  unsigned int v160; // eax@220
  int v161; // esi@223
  int v162; // ebx@223
  int v163; // eax@223
  int v164; // edx@223
  int v165; // ecx@224
  int v166; // ebx@226
  int v167; // ebx@227
  int v168; // eax@229
  std::ostream *v169; // esi@229
  int v170; // eax@229
  int v171; // ebx@229
  char v172; // al@231
  std::ostream *v173; // eax@232
  int v174; // ecx@233
  int v175; // ebx@242
  int v176; // eax@266
  int v177; // ebx@267
  signed __int32 v178; // ecx@282
  signed __int32 v179; // ecx@286
  signed __int32 v180; // ecx@290
  signed __int32 v181; // eax@297
  signed __int32 v182; // ecx@301
  signed __int32 v183; // ecx@303
  signed __int32 v184; // ecx@307
  signed __int32 v185; // edx@314
  signed __int32 v186; // edx@318
  signed __int32 v187; // eax@324
  signed __int32 v188; // edx@327
  signed __int32 v189; // edx@329
  signed __int32 v190; // ecx@334
  signed __int32 v191; // ecx@338
  int v192; // [sp+Ch] [bp-72Ch]@0
  int v193; // [sp+Ch] [bp-72Ch]@20
  char *v194; // [sp+18h] [bp-720h]@21
  int *v195; // [sp+20h] [bp-718h]@200
  int v196; // [sp+24h] [bp-714h]@186
  const void *v197; // [sp+28h] [bp-710h]@200
  int v198; // [sp+2Ch] [bp-70Ch]@118
  int v199; // [sp+2Ch] [bp-70Ch]@155
  int v200; // [sp+2Ch] [bp-70Ch]@204
  unsigned int v201; // [sp+30h] [bp-708h]@22
  unsigned int v202; // [sp+30h] [bp-708h]@200
  int v203; // [sp+34h] [bp-704h]@30
  int v204; // [sp+34h] [bp-704h]@59
  int v205; // [sp+34h] [bp-704h]@88
  int v206; // [sp+34h] [bp-704h]@123
  int v207; // [sp+34h] [bp-704h]@158
  signed int v208; // [sp+34h] [bp-704h]@191
  const void *s2; // [sp+38h] [bp-700h]@30
  const void *s2a; // [sp+38h] [bp-700h]@59
  void *s2b; // [sp+38h] [bp-700h]@88
  const void *s2c; // [sp+38h] [bp-700h]@123
  const void *s2d; // [sp+38h] [bp-700h]@158
  int v214; // [sp+3Ch] [bp-6FCh]@239
  char v215; // [sp+4Eh] [bp-6EAh]@268
  const void *v216; // [sp+50h] [bp-6E8h]@29
  int *v217; // [sp+54h] [bp-6E4h]@257
  const void *v218; // [sp+58h] [bp-6E0h]@58
  int *v219; // [sp+5Ch] [bp-6DCh]@255
  void *s1; // [sp+60h] [bp-6D8h]@87
  void **v221; // [sp+64h] [bp-6D4h]@253
  const void *v222; // [sp+68h] [bp-6D0h]@122
  int *v223; // [sp+6Ch] [bp-6CCh]@251
  const void *v224; // [sp+70h] [bp-6C8h]@157
  int *v225; // [sp+74h] [bp-6C4h]@239
  int v226; // [sp+78h] [bp-6C0h]@186
  int v227; // [sp+7Ch] [bp-6BCh]@20
  int v228; // [sp+8Ch] [bp-6ACh]@27
  int (__cdecl *v229)(void **, void **, signed int); // [sp+94h] [bp-6A4h]@27
  int (*v230)(); // [sp+98h] [bp-6A0h]@27
  int v231; // [sp+9Ch] [bp-69Ch]@27
  int (__cdecl *v232)(void **, void **, signed int); // [sp+A4h] [bp-694h]@27
  int (*v233)(); // [sp+A8h] [bp-690h]@27
  int v234; // [sp+ACh] [bp-68Ch]@27
  int (__cdecl *v235)(int, int, signed int); // [sp+B4h] [bp-684h]@27
  signed int (__cdecl *v236)(int); // [sp+B8h] [bp-680h]@27
  int v237; // [sp+BCh] [bp-67Ch]@56
  int (__cdecl *v238)(void **, void **, signed int); // [sp+C4h] [bp-674h]@56
  int (*v239)(); // [sp+C8h] [bp-670h]@56
  int v240; // [sp+CCh] [bp-66Ch]@56
  int (__cdecl *v241)(int, int, signed int); // [sp+D4h] [bp-664h]@56
  signed int (__cdecl *v242)(int); // [sp+D8h] [bp-660h]@56
  int v243; // [sp+DCh] [bp-65Ch]@85
  int (__cdecl *v244)(void **, void **, signed int); // [sp+E4h] [bp-654h]@85
  int (*v245)(); // [sp+E8h] [bp-650h]@85
  int v246; // [sp+ECh] [bp-64Ch]@85
  int (__cdecl *v247)(int, int, signed int); // [sp+F4h] [bp-644h]@85
  signed int (__cdecl *v248)(int); // [sp+F8h] [bp-640h]@85
  int v249; // [sp+FCh] [bp-63Ch]@114
  int (__cdecl *v250)(void **, void **, signed int); // [sp+104h] [bp-634h]@114
  int (*v251)(); // [sp+108h] [bp-630h]@114
  int v252; // [sp+10Ch] [bp-62Ch]@116
  int (__cdecl *v253)(void **, void **, signed int); // [sp+114h] [bp-624h]@116
  int (*v254)(); // [sp+118h] [bp-620h]@116
  int v255; // [sp+11Ch] [bp-61Ch]@118
  int (__cdecl *v256)(void **, void **, signed int); // [sp+124h] [bp-614h]@118
  int (*v257)(); // [sp+128h] [bp-610h]@118
  int v258; // [sp+12Ch] [bp-60Ch]@120
  int (__cdecl *v259)(void **, void **, signed int); // [sp+134h] [bp-604h]@120
  int (*v260)(); // [sp+138h] [bp-600h]@120
  int v261; // [sp+13Ch] [bp-5FCh]@120
  int (__cdecl *v262)(int, int, signed int); // [sp+144h] [bp-5F4h]@120
  signed int (__cdecl *v263)(int); // [sp+148h] [bp-5F0h]@120
  int v264; // [sp+14Ch] [bp-5ECh]@149
  int (__cdecl *v265)(void **, void **, signed int); // [sp+154h] [bp-5E4h]@149
  int (*v266)(); // [sp+158h] [bp-5E0h]@149
  int v267; // [sp+15Ch] [bp-5DCh]@151
  int (__cdecl *v268)(void **, void **, signed int); // [sp+164h] [bp-5D4h]@151
  int (*v269)(); // [sp+168h] [bp-5D0h]@151
  int v270; // [sp+16Ch] [bp-5CCh]@153
  int (__cdecl *v271)(void **, void **, signed int); // [sp+174h] [bp-5C4h]@153
  int (*v272)(); // [sp+178h] [bp-5C0h]@153
  int v273; // [sp+17Ch] [bp-5BCh]@155
  int (__cdecl *v274)(int, int, signed int); // [sp+184h] [bp-5B4h]@155
  signed int (__cdecl *v275)(int); // [sp+188h] [bp-5B0h]@155
  int v276; // [sp+18Ch] [bp-5ACh]@184
  int v277; // [sp+194h] [bp-5A4h]@184
  int (*v278)(); // [sp+198h] [bp-5A0h]@184
  int *v279; // [sp+19Ch] [bp-59Ch]@27
  char v280; // [sp+1A0h] [bp-598h]@27
  void (__cdecl *v281)(char *, char *, signed int); // [sp+1A8h] [bp-590h]@52
  int v282; // [sp+1B0h] [bp-588h]@27
  int v283; // [sp+1B4h] [bp-584h]@28
  int v284; // [sp+1B8h] [bp-580h]@45
  int (__cdecl *v285)(int, int, signed int); // [sp+1BCh] [bp-57Ch]@27
  signed int (__cdecl *v286)(int); // [sp+1C0h] [bp-578h]@28
  int *v287; // [sp+1C4h] [bp-574h]@56
  char v288; // [sp+1C8h] [bp-570h]@56
  void (__cdecl *v289)(char *, char *, signed int); // [sp+1D0h] [bp-568h]@81
  int v290; // [sp+1D8h] [bp-560h]@56
  int v291; // [sp+1DCh] [bp-55Ch]@57
  int v292; // [sp+1E0h] [bp-558h]@74
  int (__cdecl *v293)(int, int, signed int); // [sp+1E4h] [bp-554h]@56
  signed int (__cdecl *v294)(int); // [sp+1E8h] [bp-550h]@57
  int *v295; // [sp+1ECh] [bp-54Ch]@85
  char v296; // [sp+1F0h] [bp-548h]@85
  void (__cdecl *v297)(char *, char *, signed int); // [sp+1F8h] [bp-540h]@110
  int v298; // [sp+200h] [bp-538h]@85
  int v299; // [sp+204h] [bp-534h]@86
  int v300; // [sp+208h] [bp-530h]@103
  int (__cdecl *v301)(int, int, signed int); // [sp+20Ch] [bp-52Ch]@85
  signed int (__cdecl *v302)(int); // [sp+210h] [bp-528h]@86
  int v303; // [sp+214h] [bp-524h]@120
  char v304; // [sp+218h] [bp-520h]@120
  void (__cdecl *v305)(char *, char *, signed int); // [sp+220h] [bp-518h]@145
  int v306; // [sp+228h] [bp-510h]@120
  int v307; // [sp+22Ch] [bp-50Ch]@121
  int v308; // [sp+230h] [bp-508h]@138
  int (__cdecl *v309)(int, int, signed int); // [sp+234h] [bp-504h]@120
  signed int (__cdecl *v310)(int); // [sp+238h] [bp-500h]@121
  int v311; // [sp+23Ch] [bp-4FCh]@155
  char v312; // [sp+240h] [bp-4F8h]@155
  void (__cdecl *v313)(char *, char *, signed int); // [sp+248h] [bp-4F0h]@180
  int v314; // [sp+250h] [bp-4E8h]@9
  int v315; // [sp+254h] [bp-4E4h]@156
  int v316; // [sp+258h] [bp-4E0h]@173
  int (__cdecl *v317)(int, int, signed int); // [sp+25Ch] [bp-4DCh]@155
  signed int (__cdecl *v318)(int); // [sp+260h] [bp-4D8h]@156
  int v319; // [sp+264h] [bp-4D4h]@5
  int v320; // [sp+268h] [bp-4D0h]@5
  void (__cdecl *v321)(int *, int *, signed int, int); // [sp+26Ch] [bp-4CCh]@5
  int v322; // [sp+270h] [bp-4C8h]@5
  int v323; // [sp+274h] [bp-4C4h]@5
  int v324; // [sp+278h] [bp-4C0h]@5
  void *v325; // [sp+27Ch] [bp-4BCh]@5
  int *v326; // [sp+280h] [bp-4B8h]@5
  int *v327; // [sp+284h] [bp-4B4h]@5
  int v328; // [sp+288h] [bp-4B0h]@5
  int *v329; // [sp+28Ch] [bp-4ACh]@5
  int v330; // [sp+290h] [bp-4A8h]@5
  int v331; // [sp+300h] [bp-438h]@5
  char v332; // [sp+304h] [bp-434h]@5
  char v333; // [sp+305h] [bp-433h]@5
  int v334; // [sp+308h] [bp-430h]@5
  int v335; // [sp+30Ch] [bp-42Ch]@5
  int v336; // [sp+310h] [bp-428h]@5
  int v337; // [sp+314h] [bp-424h]@5
  int v338; // [sp+318h] [bp-420h]@7
  int v339; // [sp+31Ch] [bp-41Ch]@223
  int v340; // [sp+320h] [bp-418h]@223
  int v341; // [sp+324h] [bp-414h]@223
  int v342; // [sp+328h] [bp-410h]@223
  int v343; // [sp+32Ch] [bp-40Ch]@223
  int v344; // [sp+330h] [bp-408h]@223
  int v345; // [sp+334h] [bp-404h]@223
  char v346; // [sp+338h] [bp-400h]@223
  int v347; // [sp+33Ch] [bp-3FCh]@223
  int v348; // [sp+340h] [bp-3F8h]@223
  int v349; // [sp+344h] [bp-3F4h]@223
  int v350; // [sp+3B4h] [bp-384h]@223
  char v351; // [sp+3B8h] [bp-380h]@223
  char v352; // [sp+3B9h] [bp-37Fh]@223
  int v353; // [sp+3BCh] [bp-37Ch]@223
  int v354; // [sp+3C0h] [bp-378h]@223
  int v355; // [sp+3C4h] [bp-374h]@223
  int v356; // [sp+3C8h] [bp-370h]@223
  int v357; // [sp+3CCh] [bp-36Ch]@1
  int v358; // [sp+3D0h] [bp-368h]@1
  int v359; // [sp+3D4h] [bp-364h]@1
  char v360; // [sp+3F0h] [bp-348h]@19
  char v361; // [sp+40Ch] [bp-32Ch]@19
  int v362; // [sp+45Ch] [bp-2DCh]@1
  char v363; // [sp+470h] [bp-2C8h]@3
  int v364; // [sp+4CCh] [bp-26Ch]@1
  char v365; // [sp+4D0h] [bp-268h]@1
  char v366; // [sp+4D1h] [bp-267h]@1
  int v367; // [sp+4D4h] [bp-264h]@1
  int v368; // [sp+4D8h] [bp-260h]@1
  int v369; // [sp+4DCh] [bp-25Ch]@1
  int v370; // [sp+4E0h] [bp-258h]@1
  int v371; // [sp+4E4h] [bp-254h]@9
  int v372; // [sp+4E8h] [bp-250h]@45
  int v373; // [sp+4ECh] [bp-24Ch]@45
  signed int (__cdecl *v374)(int); // [sp+4F0h] [bp-248h]@45
  char v375; // [sp+4F4h] [bp-244h]@184
  char v376; // [sp+6F4h] [bp-44h]@184
  int v377; // [sp+6FCh] [bp-3Ch]@192
  char *v378; // [sp+700h] [bp-38h]@198
  unsigned int v379; // [sp+704h] [bp-34h]@198
  int v380; // [sp+718h] [bp-20h]@184
  int v381; // [sp+71Ch] [bp-1Ch]@184

  std::ios_base::ios_base((std::ios_base *)&v362);
  v362 = (int)&unk_80CF5C8;
  v364 = 0;
  v365 = 0;
  v366 = 0;
  v367 = 0;
  v368 = 0;
  v369 = 0;
  v370 = 0;
  v357 = dword_80CF7AC;
  *(int *)((char *)&v357 + *(_DWORD *)(dword_80CF7AC - 12)) = dword_80CF7B0;
  v358 = 0;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v357 + *(_DWORD *)(v357 - 12), 0);
  v357 = (int)&unk_80CF68C;
  v362 = (int)&unk_80CF6A0;
  std::basic_filebuf<char,std::char_traits<char>>::basic_filebuf(&v359);
  std::basic_ios<char,std::char_traits<char>>::init(&v362, &v359);
  if ( std::basic_filebuf<char,std::char_traits<char>>::open(&v359, s, 8) )
    std::basic_ios<char,std::char_traits<char>>::clear((char *)&v357 + *(_DWORD *)(v357 - 12), 0);
  else
    std::basic_ios<char,std::char_traits<char>>::clear(
      (char *)&v357 + *(_DWORD *)(v357 - 12),
      *(int *)((char *)&v357 + *(_DWORD *)(v357 - 12) + 20) | 4);
  if ( v363 & 5 )
  {
    if ( log_level <= 5 )
    {
      std::ios_base::ios_base((std::ios_base *)&v330);
      v330 = (int)&unk_80CF5C8;
      v331 = 0;
      v332 = 0;
      v333 = 0;
      v334 = 0;
      v335 = 0;
      v336 = 0;
      v337 = 0;
      v2 = dword_80CF674;
      v319 = dword_80CF674;
      *(int *)((char *)&v319 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v319 + *(_DWORD *)(v319 - 12), 0);
      v319 = (int)&unk_80CF5DC;
      v330 = (int)&unk_80CF5F0;
      v320 = (int)&unk_80CF7F0;
      v321 = 0;
      v322 = 0;
      v323 = 0;
      v324 = 0;
      v325 = 0;
      v326 = 0;
      std::locale::locale((std::locale *)&v327);
      v320 = (int)&unk_80CF588;
      v328 = 16;
      v329 = (int *)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v330, &v320);
      v3 = std::__ostream_insert<char,std::char_traits<char>>(
             &v319,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v3, "Cannot open config file: ", 25);
      if ( s )
      {
        v4 = strlen(s);
        std::__ostream_insert<char,std::char_traits<char>>(v3, s, v4);
      }
      else
      {
        std::basic_ios<char,std::char_traits<char>>::clear(
          v3 + *(_DWORD *)(*(_DWORD *)v3 - 12),
          *(_DWORD *)(v3 + *(_DWORD *)(*(_DWORD *)v3 - 12) + 20) | 1);
      }
      v338 = (int)&unk_80CF83C;
      v5 = *(_DWORD *)(v3 + 24);
      if ( v5 )
      {
        v6 = *(_DWORD *)(v3 + 16);
        LOBYTE(v192) = 0;
        if ( v5 > (unsigned int)v6 )
        {
          v371 = std::string::_S_construct<char *>(v3, v1, &v330, *(_DWORD *)(v3 + 20), v5, (int)&v314);
          std::string::swap((std::string *)&v338, (std::string *)&v371);
        }
        else
        {
          v371 = std::string::_S_construct<char *>(v3, v1, &v330, *(_DWORD *)(v3 + 20), v6, (int)&v314);
          std::string::swap((std::string *)&v338, (std::string *)&v371);
        }
        v7 = v371 - 12;
        if ( (_DWORD *)(v371 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v180 = _InterlockedExchangeAdd((volatile signed __int32 *)(v371 - 4), 0xFFFFFFFF);
          }
          else
          {
            v180 = *(_DWORD *)(v371 - 4);
            *(_DWORD *)(v371 - 4) = v180 - 1;
          }
          if ( v180 <= 0 )
            std::string::_Rep::_M_destroy(v7, &v311);
        }
      }
      else
      {
        std::string::assign((std::string *)&v338, (const std::string *)(v3 + 40));
      }
      v319 = (int)&unk_80CF5DC;
      v330 = (int)&unk_80CF5F0;
      v320 = (int)&unk_80CF588;
      v8 = (int)(v329 - 3);
      if ( v329 - 3 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v179 = _InterlockedExchangeAdd((volatile signed __int32 *)v329 - 1, 0xFFFFFFFF);
        }
        else
        {
          v179 = *(v329 - 1);
          *(v329 - 1) = v179 - 1;
        }
        if ( v179 <= 0 )
          std::string::_Rep::_M_destroy(v8, &v371);
      }
      v320 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v327);
      v319 = v2;
      *(int *)((char *)&v319 + *(_DWORD *)(v2 - 12)) = dword_80CF678;
      v330 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v330);
      if ( byte_80CE64C )
      {
        v9 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v338, *(_DWORD *)(v338 - 12));
        v10 = (std::ostream *)v9;
        v11 = *(_DWORD *)(*(_DWORD *)v9 - 12);
        v12 = *(_DWORD *)((char *)v10 + v11 + 124);
        if ( !v12 )
        {
          v177 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v338 - 12, &v371);
          goto LABEL_274;
        }
        if ( *(_BYTE *)(v12 + 28) )
        {
          v13 = *(_BYTE *)(v12 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v10 + v11 + 124));
          v13 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v12 + 24))(v12, 10);
        }
        v14 = (std::ostream *)std::ostream::put(v10, v13);
        std::ostream::flush(v14);
      }
      syslog(3, "%s", v338, v192);
      v15 = v338 - 12;
      if ( (_DWORD *)(v338 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v181 = _InterlockedExchangeAdd((volatile signed __int32 *)(v338 - 4), 0xFFFFFFFF);
        }
        else
        {
          v182 = *(_DWORD *)(v338 - 4);
          *(_DWORD *)(v338 - 4) = v182 - 1;
          v181 = v182;
        }
        if ( v181 <= 0 )
          std::string::_Rep::_M_destroy(v15, &v371);
      }
    }
    v357 = (int)&unk_80CF68C;
    v362 = (int)&unk_80CF6A0;
    v359 = (int)&unk_80CF638;
    std::basic_filebuf<char,std::char_traits<char>>::close(&v359);
    goto LABEL_19;
  }
  std::istream::seekg(&v357, 0, 0, 2);
  std::istream::tellg((std::istream *)&v227);
  v17 = v227;
  std::istream::seekg(&v357, 0, 0, 0);
  if ( v17 == -1 )
  {
    v18 = 0;
    v194 = 0;
  }
  else
  {
    v18 = (char *)operator new(v17 + 1);
    v194 = v18;
  }
  v19 = v194;
  v20 = (int)&v194[v17 + 1];
  v201 = v20 - (_DWORD)v18;
  v21 = v20 - (_DWORD)v18;
  if ( (unsigned int)(v20 - (_DWORD)v18) >= 4 )
  {
    if ( (unsigned __int8)v194 & 1 )
    {
      *v194 = 0;
      v19 = v194 + 1;
      v21 = v201 - 1;
    }
    if ( (unsigned __int8)v19 & 2 )
    {
      *(_WORD *)v19 = 0;
      v19 = (char *)v19 + 2;
      v21 -= 2;
    }
    memset(v19, 0, 4 * (v21 >> 2));
    v19 = (char *)v19 + 4 * (v21 >> 2);
  }
  if ( v21 & 2 )
  {
    *(_WORD *)v19 = 0;
    v19 = (char *)v19 + 2;
  }
  if ( v21 & 1 )
    *(_BYTE *)v19 = 0;
  std::istream::read((std::istream *)&v357, v194, v17);
  v321 = 0;
  memset(&v324, 0, 0x10u);
  v328 = 0;
  v326 = &v324;
  v327 = &v324;
  v329 = 0;
  v229 = 0;
  v228 = operator new(1u);
  v230 = sub_805A040;
  v229 = sub_8059EC0;
  v232 = 0;
  v22 = operator new(4u);
  *(_DWORD *)v22 = &dword_80CF898;
  v231 = v22;
  v233 = sub_805E810;
  v232 = sub_805E960;
  v279 = &v319;
  sub_805EDA0((int)&v280, (int)&v231);
  v235 = 0;
  v23 = operator new(0x14u);
  *(_DWORD *)v23 = v279;
  sub_805EDA0(v23 + 4, (int)&v280);
  v234 = v23;
  v236 = sub_805EB40;
  v235 = sub_805EE10;
  v282 = 1;
  v285 = 0;
  if ( sub_805EE10 )
  {
    v286 = sub_805EB40;
    v285 = sub_805EE10;
    sub_805EE10((int)&v283, (int)&v234, 2);
  }
  std::string::string(&v216, "node_id", &v338);
  v24 = v325;
  if ( v325 )
  {
    s2 = v216;
    v25 = *((_DWORD *)v216 - 3);
    v203 = (int)&v324;
    do
    {
      while ( 1 )
      {
        v26 = (const void *)*((_DWORD *)v24 + 4);
        v27 = *((_DWORD *)v26 - 3);
        v28 = v25;
        if ( v25 > v27 )
          v28 = *((_DWORD *)v26 - 3);
        v29 = memcmp(v26, s2, v28);
        if ( !v29 )
          v29 = v27 - v25;
        if ( v29 < 0 )
          break;
        v203 = (int)v24;
        v24 = (void *)*((_DWORD *)v24 + 2);
        if ( !v24 )
          goto LABEL_38;
      }
      v24 = (void *)*((_DWORD *)v24 + 3);
    }
    while ( v24 );
LABEL_38:
    if ( (int *)v203 != &v324 )
    {
      v30 = *(const void **)(v203 + 16);
      v31 = *((_DWORD *)v30 - 3);
      v32 = v25;
      if ( v25 > v31 )
        v32 = *((_DWORD *)v30 - 3);
      v33 = memcmp(s2, v30, v32);
      if ( !v33 )
        v33 = v25 - v31;
      if ( v33 >= 0 )
      {
        v34 = v203;
        goto LABEL_45;
      }
    }
  }
  else
  {
    v203 = (int)&v324;
  }
  v217 = (int *)&v216;
  sub_805F0F0((int)&v214, (int)&v323, v203, (int)&dword_80B9AC0, (int)&v217);
  v34 = v214;
LABEL_45:
  *(_DWORD *)(v34 + 20) = v282;
  v35 = v283;
  v36 = v284;
  v283 = v371;
  v284 = v372;
  v371 = v35;
  v372 = v36;
  v37 = v285;
  v285 = 0;
  v38 = v286;
  v286 = v374;
  v39 = *(_DWORD *)(v34 + 28);
  v371 = *(_DWORD *)(v34 + 24);
  v372 = v39;
  *(_DWORD *)(v34 + 24) = v35;
  *(_DWORD *)(v34 + 28) = v36;
  v373 = *(_DWORD *)(v34 + 32);
  v40 = v373;
  *(_DWORD *)(v34 + 32) = v37;
  v374 = *(signed int (__cdecl **)(int))(v34 + 36);
  *(_DWORD *)(v34 + 36) = v38;
  if ( v40 )
    ((void (__cdecl *)(int *, int *, signed int))v40)(&v371, &v371, 3);
  v41 = (int)((char *)v216 - 12);
  if ( (_DWORD *)((char *)v216 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v178 = _InterlockedExchangeAdd((volatile signed __int32 *)v216 - 1, 0xFFFFFFFF);
    }
    else
    {
      v178 = *((_DWORD *)v216 - 1);
      *((_DWORD *)v216 - 1) = v178 - 1;
    }
    if ( v178 <= 0 )
      std::string::_Rep::_M_destroy(v41, &v371);
  }
  if ( v285 )
    v285((int)&v283, (int)&v283, 3);
  if ( v235 )
    v235((int)&v234, (int)&v234, 3);
  if ( v281 )
    v281(&v280, &v280, 3);
  if ( v232 )
    v232((void **)&v231, (void **)&v231, 3);
  v238 = 0;
  v42 = operator new(4u);
  *(_DWORD *)v42 = &dword_80CF894;
  v237 = v42;
  v239 = sub_805E810;
  v238 = sub_805E960;
  v287 = &v319;
  sub_805EDA0((int)&v288, (int)&v237);
  v241 = 0;
  v43 = operator new(0x14u);
  *(_DWORD *)v43 = v287;
  sub_805EDA0(v43 + 4, (int)&v288);
  v240 = v43;
  v242 = sub_805EB40;
  v241 = sub_805EE10;
  v290 = 1;
  v293 = 0;
  if ( sub_805EE10 )
  {
    v294 = sub_805EB40;
    v293 = sub_805EE10;
    sub_805EE10((int)&v291, (int)&v240, 2);
  }
  std::string::string(&v218, "server_url", &v338);
  v44 = v325;
  if ( v325 )
  {
    s2a = v218;
    v45 = *((_DWORD *)v218 - 3);
    v204 = (int)&v324;
    do
    {
      while ( 1 )
      {
        v46 = (const void *)*((_DWORD *)v44 + 4);
        v47 = *((_DWORD *)v46 - 3);
        v48 = v45;
        if ( v45 > v47 )
          v48 = *((_DWORD *)v46 - 3);
        v49 = memcmp(v46, s2a, v48);
        if ( !v49 )
          v49 = v47 - v45;
        if ( v49 < 0 )
          break;
        v204 = (int)v44;
        v44 = (void *)*((_DWORD *)v44 + 2);
        if ( !v44 )
          goto LABEL_67;
      }
      v44 = (void *)*((_DWORD *)v44 + 3);
    }
    while ( v44 );
LABEL_67:
    if ( (int *)v204 != &v324 )
    {
      v50 = *(const void **)(v204 + 16);
      v51 = *((_DWORD *)v50 - 3);
      v52 = v45;
      if ( v45 > v51 )
        v52 = *((_DWORD *)v50 - 3);
      v53 = memcmp(s2a, v50, v52);
      if ( !v53 )
        v53 = v45 - v51;
      if ( v53 >= 0 )
      {
        v54 = v204;
        goto LABEL_74;
      }
    }
  }
  else
  {
    v204 = (int)&v324;
  }
  v219 = (int *)&v218;
  sub_805F0F0((int)&v214, (int)&v323, v204, (int)&dword_80B9AC0, (int)&v219);
  v54 = v214;
LABEL_74:
  *(_DWORD *)(v54 + 20) = v290;
  v55 = v291;
  v56 = v292;
  v291 = v371;
  v292 = v372;
  v371 = v55;
  v372 = v56;
  v57 = v293;
  v293 = 0;
  v58 = v294;
  v294 = v374;
  v59 = *(_DWORD *)(v54 + 28);
  v371 = *(_DWORD *)(v54 + 24);
  v372 = v59;
  *(_DWORD *)(v54 + 24) = v55;
  *(_DWORD *)(v54 + 28) = v56;
  v373 = *(_DWORD *)(v54 + 32);
  v60 = v373;
  *(_DWORD *)(v54 + 32) = v57;
  v374 = *(signed int (__cdecl **)(int))(v54 + 36);
  *(_DWORD *)(v54 + 36) = v58;
  if ( v60 )
    ((void (__cdecl *)(int *, int *, signed int))v60)(&v371, &v371, 3);
  v61 = (int)((char *)v218 - 12);
  if ( (_DWORD *)((char *)v218 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v183 = _InterlockedExchangeAdd((volatile signed __int32 *)v218 - 1, 0xFFFFFFFF);
    }
    else
    {
      v183 = *((_DWORD *)v218 - 1);
      *((_DWORD *)v218 - 1) = v183 - 1;
    }
    if ( v183 <= 0 )
      std::string::_Rep::_M_destroy(v61, &v371);
  }
  if ( v293 )
    v293((int)&v291, (int)&v291, 3);
  if ( v241 )
    v241((int)&v240, (int)&v240, 3);
  if ( v289 )
    v289(&v288, &v288, 3);
  if ( v238 )
    v238((void **)&v237, (void **)&v237, 3);
  v244 = 0;
  v62 = operator new(4u);
  *(_DWORD *)v62 = &dword_80CF890;
  v243 = v62;
  v245 = sub_805E810;
  v244 = sub_805E960;
  v295 = &v319;
  sub_805EDA0((int)&v296, (int)&v243);
  v247 = 0;
  v63 = operator new(0x14u);
  *(_DWORD *)v63 = v295;
  sub_805EDA0(v63 + 4, (int)&v296);
  v246 = v63;
  v248 = sub_805EB40;
  v247 = sub_805EE10;
  v298 = 1;
  v301 = 0;
  if ( sub_805EE10 )
  {
    v302 = sub_805EB40;
    v301 = sub_805EE10;
    sub_805EE10((int)&v299, (int)&v246, 2);
  }
  std::string::string(&s1, "proxy", &v338);
  v64 = v325;
  if ( v325 )
  {
    v65 = s1;
    s2b = (void *)*((_DWORD *)s1 - 3);
    v205 = (int)&v324;
    do
    {
      while ( 1 )
      {
        v66 = (const void *)*((_DWORD *)v64 + 4);
        v67 = *((_DWORD *)v66 - 3);
        v68 = v67;
        if ( v67 > (unsigned int)s2b )
          v68 = (size_t)s2b;
        v69 = memcmp(v66, v65, v68);
        if ( !v69 )
          v69 = v67 - (_DWORD)s2b;
        if ( v69 < 0 )
          break;
        v205 = (int)v64;
        v64 = (void *)*((_DWORD *)v64 + 2);
        if ( !v64 )
          goto LABEL_96;
      }
      v64 = (void *)*((_DWORD *)v64 + 3);
    }
    while ( v64 );
LABEL_96:
    if ( (int *)v205 != &v324 )
    {
      v70 = *(const void **)(v205 + 16);
      v71 = *((_DWORD *)v70 - 3);
      v72 = v71;
      if ( v71 > (unsigned int)s2b )
        v72 = (size_t)s2b;
      v73 = memcmp(v65, v70, v72);
      if ( !v73 )
        v73 = (int)((char *)s2b - v71);
      if ( v73 >= 0 )
      {
        v74 = v205;
        goto LABEL_103;
      }
    }
  }
  else
  {
    v205 = (int)&v324;
  }
  v221 = &s1;
  sub_805F0F0((int)&v214, (int)&v323, v205, (int)&dword_80B9AC0, (int)&v221);
  v74 = v214;
LABEL_103:
  *(_DWORD *)(v74 + 20) = v298;
  v75 = v299;
  v76 = v300;
  v299 = v371;
  v300 = v372;
  v371 = v75;
  v372 = v76;
  v77 = v301;
  v301 = 0;
  v78 = v302;
  v302 = v374;
  v79 = *(_DWORD *)(v74 + 28);
  v371 = *(_DWORD *)(v74 + 24);
  v372 = v79;
  *(_DWORD *)(v74 + 24) = v75;
  *(_DWORD *)(v74 + 28) = v76;
  v373 = *(_DWORD *)(v74 + 32);
  v80 = v373;
  *(_DWORD *)(v74 + 32) = v77;
  v374 = *(signed int (__cdecl **)(int))(v74 + 36);
  *(_DWORD *)(v74 + 36) = v78;
  if ( v80 )
    ((void (__cdecl *)(int *, int *, signed int))v80)(&v371, &v371, 3);
  v81 = (char *)s1 - 12;
  if ( (_DWORD *)((char *)s1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v184 = _InterlockedExchangeAdd((volatile signed __int32 *)s1 - 1, 0xFFFFFFFF);
    }
    else
    {
      v184 = *((_DWORD *)s1 - 1);
      *((_DWORD *)s1 - 1) = v184 - 1;
    }
    if ( v184 <= 0 )
      std::string::_Rep::_M_destroy(v81, &v371);
  }
  if ( v301 )
    v301((int)&v299, (int)&v299, 3);
  if ( v247 )
    v247((int)&v246, (int)&v246, 3);
  if ( v297 )
    v297(&v296, &v296, 3);
  if ( v244 )
    v244((void **)&v243, (void **)&v243, 3);
  v82 = sub_805F840((int)&v319, (int)"tasks_fetch_interval", (int)&dword_80CE684);
  v83 = sub_805F840(v82, (int)"stats_report_interval", (int)&dword_80CE680);
  v84 = sub_805F840(v83, (int)"server_retry_interval", (int)&seconds);
  v85 = sub_805F840(v84, (int)"server_error_retry_count", (int)&dword_80CE678);
  v86 = sub_805F840(v85, (int)"server_connection_error_retry_count", (int)&dword_80CE674);
  v87 = sub_805F840(v86, (int)"server_request_timeout", (int)&dword_80CE670);
  v250 = 0;
  v88 = operator new(4u);
  *(_DWORD *)v88 = &byte_80CE66C;
  v249 = v88;
  v251 = sub_805E830;
  v250 = sub_805EAA0;
  v89 = sub_805F4A0(v87, (int)"server_request_allow_deflate", (int)&v249);
  if ( v250 )
    v250((void **)&v249, (void **)&v249, 3);
  v253 = 0;
  v90 = operator new(4u);
  *(_DWORD *)v90 = &byte_80CF88C;
  v252 = v90;
  v254 = sub_805E830;
  v253 = sub_805EAA0;
  v91 = sub_805F4A0(v89, (int)"check_ipv6", (int)&v252);
  if ( v253 )
    v253((void **)&v252, (void **)&v252, 3);
  v92 = sub_805F840(v91, (int)"default_max_dns_jobs", (int)&dword_80CE668);
  v93 = sub_805F840(v92, (int)"default_max_total_connections", (int)&dword_80CE664);
  v94 = sub_805F840(v93, (int)"default_max_https_connections", (int)&dword_80CE660);
  v95 = sub_805F840(v94, (int)"default_job_timeout", (int)&dword_80CE65C);
  v96 = sub_805F840(v95, (int)"default_max_content_size", (int)&dword_80CE658);
  v97 = sub_805F840(v96, (int)"default_max_report_size", (int)&dword_80CE654);
  v256 = 0;
  v98 = operator new(4u);
  *(_DWORD *)v98 = &dword_80CF888;
  v255 = v98;
  v257 = sub_805E810;
  v256 = sub_805E960;
  v198 = sub_805F4A0(v97, (int)"validator_user_agent", (int)&v255);
  if ( v256 )
    v256((void **)&v255, (void **)&v255, 3);
  v259 = 0;
  v99 = operator new(4u);
  *(_DWORD *)v99 = &dword_80CF884;
  v258 = v99;
  v260 = sub_805E810;
  v259 = sub_805E960;
  v303 = v198;
  sub_805EDA0((int)&v304, (int)&v258);
  v262 = 0;
  v100 = operator new(0x14u);
  *(_DWORD *)v100 = v303;
  sub_805EDA0(v100 + 4, (int)&v304);
  v261 = v100;
  v263 = sub_805EB40;
  v262 = sub_805EE10;
  v306 = 1;
  v309 = 0;
  if ( sub_805EE10 )
  {
    v310 = sub_805EB40;
    v309 = sub_805EE10;
    sub_805EE10((int)&v307, (int)&v261, 2);
  }
  std::string::string(&v222, "tunnel_remote_username", &v338);
  v101 = *(_DWORD *)(v198 + 24);
  if ( v101 )
  {
    s2c = v222;
    v102 = *((_DWORD *)v222 - 3);
    v206 = v198 + 20;
    do
    {
      while ( 1 )
      {
        v103 = *(const void **)(v101 + 16);
        v104 = *((_DWORD *)v103 - 3);
        v105 = v102;
        if ( v102 > v104 )
          v105 = *((_DWORD *)v103 - 3);
        v106 = memcmp(v103, s2c, v105);
        if ( !v106 )
          v106 = v104 - v102;
        if ( v106 < 0 )
          break;
        v206 = v101;
        v101 = *(_DWORD *)(v101 + 8);
        if ( !v101 )
          goto LABEL_131;
      }
      v101 = *(_DWORD *)(v101 + 12);
    }
    while ( v101 );
LABEL_131:
    if ( v198 + 20 != v206 )
    {
      v107 = *(const void **)(v206 + 16);
      v108 = *((_DWORD *)v107 - 3);
      v109 = v102;
      if ( v102 > v108 )
        v109 = *((_DWORD *)v107 - 3);
      v110 = memcmp(s2c, v107, v109);
      if ( !v110 )
        v110 = v102 - v108;
      if ( v110 >= 0 )
      {
        v111 = v206;
        goto LABEL_138;
      }
    }
  }
  else
  {
    v206 = v198 + 20;
  }
  v223 = (int *)&v222;
  sub_805F0F0((int)&v214, v198 + 16, v206, (int)&dword_80B9AC0, (int)&v223);
  v111 = v214;
LABEL_138:
  *(_DWORD *)(v111 + 20) = v306;
  v112 = v307;
  v113 = v308;
  v307 = v371;
  v308 = v372;
  v371 = v112;
  v372 = v113;
  v114 = v309;
  v309 = 0;
  v115 = v310;
  v310 = v374;
  v116 = *(_DWORD *)(v111 + 28);
  v371 = *(_DWORD *)(v111 + 24);
  v372 = v116;
  *(_DWORD *)(v111 + 24) = v112;
  *(_DWORD *)(v111 + 28) = v113;
  v373 = *(_DWORD *)(v111 + 32);
  v117 = v373;
  *(_DWORD *)(v111 + 32) = v114;
  v374 = *(signed int (__cdecl **)(int))(v111 + 36);
  *(_DWORD *)(v111 + 36) = v115;
  if ( v117 )
    ((void (__cdecl *)(int *, int *, signed int))v117)(&v371, &v371, 3);
  v118 = (int)((char *)v222 - 12);
  if ( (_DWORD *)((char *)v222 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v190 = _InterlockedExchangeAdd((volatile signed __int32 *)v222 - 1, 0xFFFFFFFF);
    }
    else
    {
      v190 = *((_DWORD *)v222 - 1);
      *((_DWORD *)v222 - 1) = v190 - 1;
    }
    if ( v190 <= 0 )
      std::string::_Rep::_M_destroy(v118, &v371);
  }
  if ( v309 )
    v309((int)&v307, (int)&v307, 3);
  if ( v262 )
    v262((int)&v261, (int)&v261, 3);
  if ( v305 )
    v305(&v304, &v304, 3);
  if ( v259 )
    v259((void **)&v258, (void **)&v258, 3);
  v265 = 0;
  v119 = operator new(4u);
  *(_DWORD *)v119 = &g_idrsa_path;
  v264 = v119;
  v266 = sub_805E810;
  v265 = sub_805E960;
  v120 = sub_805F4A0(v198, (int)"tunnel_key_path", (int)&v264);
  if ( v265 )
    v265((void **)&v264, (void **)&v264, 3);
  v121 = sub_805F840(v120, (int)"tunnel_local_port", (int)&dword_80CE650);
  v122 = sub_805F840(v121, (int)"terminate_after", (int)&terminate_timeout);
  v268 = 0;
  v123 = operator new(4u);
  *(_DWORD *)v123 = &graceful_terminate;
  v267 = v123;
  v269 = sub_805E830;
  v268 = sub_805EAA0;
  v124 = sub_805F4A0(v122, (int)"graceful_terminate", (int)&v267);
  if ( v268 )
    v268((void **)&v267, (void **)&v267, 3);
  v271 = 0;
  v125 = operator new(4u);
  *(_DWORD *)v125 = &dword_80CF864;
  v270 = v125;
  v272 = sub_805E810;
  v271 = sub_805E960;
  v126 = sub_805F4A0(v124, (int)"socks_listen_address", (int)&v270);
  if ( v271 )
    v271((void **)&v270, (void **)&v270, 3);
  v199 = sub_805F840(v126, (int)"socks_listen_port", (int)&dword_80CE648);
  v311 = v199;
  sub_805EDA0((int)&v312, (int)&v228);
  v274 = 0;
  v127 = operator new(0x14u);
  *(_DWORD *)v127 = v311;
  sub_805EDA0(v127 + 4, (int)&v312);
  v273 = v127;
  v275 = sub_805EB40;
  v274 = sub_805EE10;
  v314 = 1;
  v317 = 0;
  if ( sub_805EE10 )
  {
    v318 = sub_805EB40;
    v317 = sub_805EE10;
    sub_805EE10((int)&v315, (int)&v273, 2);
  }
  std::string::string(&v224, "log_level", &v338);
  v128 = *(_DWORD *)(v199 + 24);
  if ( v128 )
  {
    s2d = v224;
    v129 = *((_DWORD *)v224 - 3);
    v207 = v199 + 20;
    do
    {
      while ( 1 )
      {
        v130 = *(const void **)(v128 + 16);
        v131 = *((_DWORD *)v130 - 3);
        v132 = v129;
        if ( v129 > v131 )
          v132 = *((_DWORD *)v130 - 3);
        v133 = memcmp(v130, s2d, v132);
        if ( !v133 )
          v133 = v131 - v129;
        if ( v133 < 0 )
          break;
        v207 = v128;
        v128 = *(_DWORD *)(v128 + 8);
        if ( !v128 )
          goto LABEL_166;
      }
      v128 = *(_DWORD *)(v128 + 12);
    }
    while ( v128 );
LABEL_166:
    if ( v207 != v199 + 20 )
    {
      v134 = *(const void **)(v207 + 16);
      v135 = *((_DWORD *)v134 - 3);
      v136 = v129;
      if ( v129 > v135 )
        v136 = *((_DWORD *)v134 - 3);
      v137 = memcmp(s2d, v134, v136);
      if ( !v137 )
        v137 = v129 - v135;
      if ( v137 >= 0 )
      {
        v138 = v207;
        goto LABEL_173;
      }
    }
  }
  else
  {
    v207 = v199 + 20;
  }
  v225 = (int *)&v224;
  sub_805F0F0((int)&v214, v199 + 16, v207, (int)&dword_80B9AC0, (int)&v225);
  v138 = v214;
LABEL_173:
  *(_DWORD *)(v138 + 20) = v314;
  v139 = v315;
  v140 = v316;
  v315 = v371;
  v316 = v372;
  v371 = v139;
  v372 = v140;
  v141 = v317;
  v317 = 0;
  v142 = v318;
  v318 = v374;
  v143 = *(_DWORD *)(v138 + 28);
  v371 = *(_DWORD *)(v138 + 24);
  v372 = v143;
  *(_DWORD *)(v138 + 24) = v139;
  *(_DWORD *)(v138 + 28) = v140;
  v373 = *(_DWORD *)(v138 + 32);
  v144 = v373;
  *(_DWORD *)(v138 + 32) = v141;
  v374 = *(signed int (__cdecl **)(int))(v138 + 36);
  *(_DWORD *)(v138 + 36) = v142;
  if ( v144 )
    ((void (__cdecl *)(int *, int *, signed int))v144)(&v371, &v371, 3);
  v145 = (int)((char *)v224 - 12);
  if ( (_DWORD *)((char *)v224 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v191 = _InterlockedExchangeAdd((volatile signed __int32 *)v224 - 1, 0xFFFFFFFF);
    }
    else
    {
      v191 = *((_DWORD *)v224 - 1);
      *((_DWORD *)v224 - 1) = v191 - 1;
    }
    if ( v191 <= 0 )
      std::string::_Rep::_M_destroy(v145, &v371);
  }
  if ( v317 )
    v317((int)&v315, (int)&v315, 3);
  if ( v274 )
    v274((int)&v273, (int)&v273, 3);
  if ( v313 )
    v313(&v312, &v312, 3);
  if ( v229 )
    v229((void **)&v228, (void **)&v228, 3);
  v277 = 0;
  v146 = operator new(0xCu);
  *(_DWORD *)v146 = v194;
  *(_DWORD *)(v146 + 4) = v201;
  *(_BYTE *)(v146 + 8) = 0;
  v276 = v146;
  v278 = sub_805E7E0;
  v277 = (int)sub_805E8C0;
  sub_805ED30((int)&v371, (int)&v276);
  sub_808C080((int)&v376, (int)&v375, 512);
  v381 = 0;
  v380 = 0;
  v147 = v277;
  if ( v277 )
  {
    ((void (__cdecl *)(int *, int *, signed int))v277)(&v276, &v276, 3);
    v147 = v381;
  }
  v329 = &v371;
  v226 = (int)&unk_80CF83C;
  v196 = 0;
  while ( 1 )
  {
    while ( 1 )
    {
      v149 = sub_808C150((int)&v376, &v380, v147);
      v150 = v149;
      if ( v149 == 4 )
        break;
      v208 = v149;
      if ( v149 && v149 != 2 )
        goto LABEL_221;
      switch ( v377 )
      {
        case 4:
        case 6:
          ++v196;
          goto LABEL_196;
        case 3:
          std::string::append((std::string *)&v226, v378, v379);
          if ( v150 )
            goto LABEL_197;
          v151 = v325;
          v152 = v226;
          if ( !v325 )
            goto LABEL_216;
          v197 = (const void *)v226;
          v202 = *(_DWORD *)(v226 - 12);
          v195 = &v324;
          do
          {
            while ( 1 )
            {
              v153 = (const void *)*((_DWORD *)v151 + 4);
              v154 = *((_DWORD *)v153 - 3);
              if ( v154 > v202 )
                v154 = v202;
              v200 = *((_DWORD *)v153 - 3);
              v155 = memcmp(v153, v197, v154);
              if ( !v155 )
                v155 = v200 - v202;
              if ( v155 < 0 )
                break;
              v195 = (int *)v151;
              v151 = (void *)*((_DWORD *)v151 + 2);
              if ( !v151 )
                goto LABEL_208;
            }
            v151 = (void *)*((_DWORD *)v151 + 3);
          }
          while ( v151 );
LABEL_208:
          if ( v195 == &v324 )
            goto LABEL_217;
          v156 = (const void *)v195[4];
          v157 = *((_DWORD *)v156 - 3);
          v158 = v157;
          if ( v157 > v202 )
            v158 = v202;
          v159 = memcmp(v197, v156, v158);
          if ( !v159 )
            v159 = v202 - v157;
          if ( v159 < 0 )
            goto LABEL_217;
          if ( !v195[8] )
          {
            v176 = std::__throw_bad_function_call();
LABEL_267:
            v177 = v176;
            goto LABEL_268;
          }
          v208 = ((int (__cdecl *)(int))v195[9])(v195 + 6);
          v152 = v226;
LABEL_216:
          v202 = *(_DWORD *)(v152 - 12);
LABEL_217:
          std::string::_M_mutate((std::string *)&v226, 0, v202, 0);
          goto LABEL_196;
        case 5:
        case 7:
          if ( !v196 )
          {
            if ( v321 )
              sub_8057D90(&v319);
            goto LABEL_242;
          }
          --v196;
LABEL_196:
          if ( v208 )
            goto LABEL_221;
LABEL_197:
          v147 = v381;
          break;
        default:
          goto LABEL_197;
      }
    }
    if ( !v373 )
    {
      v176 = std::__throw_bad_function_call();
      goto LABEL_267;
    }
    v148 = ((int (__cdecl *)(int *, int *))v374)(&v371, &v380);
    if ( !v148 )
      break;
    v147 = v380 + v148;
    v381 = v147;
  }
  LOBYTE(v160) = sub_808C0E0((int)&v376);
  v208 = v160 < 1 ? 3 : 1;
LABEL_221:
  v329 = 0;
  if ( !sub_808C100((int)&v376, v208) )
  {
    if ( log_level <= 5 )
    {
      std::ios_base::ios_base((std::ios_base *)&v349);
      v349 = (int)&unk_80CF5C8;
      v350 = 0;
      v351 = 0;
      v352 = 0;
      v353 = 0;
      v354 = 0;
      v355 = 0;
      v356 = 0;
      v161 = dword_80CF674;
      v338 = dword_80CF674;
      *(int *)((char *)&v338 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v338 + *(_DWORD *)(v338 - 12), 0);
      v338 = (int)&unk_80CF5DC;
      v349 = (int)&unk_80CF5F0;
      v339 = (int)&unk_80CF7F0;
      v340 = 0;
      v341 = 0;
      v342 = 0;
      v343 = 0;
      v344 = 0;
      v345 = 0;
      std::locale::locale((std::locale *)&v346);
      v339 = (int)&unk_80CF588;
      v347 = 16;
      v348 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v349, &v339);
      v162 = std::__ostream_insert<char,std::char_traits<char>>(
               &v338,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v162, "VERIFY failed (", 15);
      std::__ostream_insert<char,std::char_traits<char>>(v162, "parser->done(res)", 17);
      std::__ostream_insert<char,std::char_traits<char>>(v162, "): ", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v162, "Parse error: ", 13);
      v163 = std::ostream::operator<<(v162, v208);
      v311 = (int)&unk_80CF83C;
      v164 = *(_DWORD *)(v163 + 24);
      if ( v164 )
      {
        v165 = *(_DWORD *)(v163 + 16);
        LOBYTE(v193) = 0;
        if ( v164 <= (unsigned int)v165 )
        {
          v314 = std::string::_S_construct<char *>(v162, v1, &v349, *(_DWORD *)(v163 + 20), v165, (int)&v306);
          std::string::swap((std::string *)&v311, (std::string *)&v314);
        }
        else
        {
          v314 = std::string::_S_construct<char *>(v162, v1, &v349, *(_DWORD *)(v163 + 20), v164, (int)&v306);
          std::string::swap((std::string *)&v311, (std::string *)&v314);
        }
        v166 = v314 - 12;
        if ( (_DWORD *)(v314 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v186 = _InterlockedExchangeAdd((volatile signed __int32 *)(v314 - 4), 0xFFFFFFFF);
          }
          else
          {
            v186 = *(_DWORD *)(v314 - 4);
            *(_DWORD *)(v314 - 4) = v186 - 1;
          }
          if ( v186 <= 0 )
            std::string::_Rep::_M_destroy(v166, &v303);
        }
      }
      else
      {
        std::string::assign((std::string *)&v311, (const std::string *)(v163 + 40));
      }
      v338 = (int)&unk_80CF5DC;
      v349 = (int)&unk_80CF5F0;
      v339 = (int)&unk_80CF588;
      v167 = v348 - 12;
      if ( (_DWORD *)(v348 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v185 = _InterlockedExchangeAdd((volatile signed __int32 *)(v348 - 4), 0xFFFFFFFF);
        }
        else
        {
          v185 = *(_DWORD *)(v348 - 4);
          *(_DWORD *)(v348 - 4) = v185 - 1;
        }
        if ( v185 <= 0 )
          std::string::_Rep::_M_destroy(v167, &v314);
      }
      v339 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v346);
      v338 = v161;
      *(int *)((char *)&v338 + *(_DWORD *)(v161 - 12)) = dword_80CF678;
      v349 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v349);
      if ( byte_80CE64C )
      {
        v168 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v311, *(_DWORD *)(v311 - 12));
        v169 = (std::ostream *)v168;
        v170 = *(_DWORD *)(*(_DWORD *)v168 - 12);
        v171 = *(_DWORD *)((char *)v169 + v170 + 124);
        if ( v171 )
        {
          if ( *(_BYTE *)(v171 + 28) )
          {
            v172 = *(_BYTE *)(v171 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v169 + v170 + 124));
            v172 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v171 + 24))(v171, 10);
          }
          v173 = (std::ostream *)std::ostream::put(v169, v172);
          std::ostream::flush(v173);
          goto LABEL_233;
        }
        v177 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v311 - 12, &v338);
LABEL_268:
        std::string::_Rep::_M_dispose(v226 - 12, &v215);
        if ( v373 )
          ((void (__cdecl *)(int *, int *, signed int, int))v373)(&v371, &v371, 3, v193);
        sub_805EF00((int)&v323, v325);
        if ( v321 )
          v321(&v319, &v319, 3, v193);
        if ( v194 )
          operator delete(v194);
LABEL_274:
        std::basic_ifstream<char,std::char_traits<char>>::~basic_ifstream(&v357);
        Unwind_Resume(v177);
      }
LABEL_233:
      syslog(3, "%s", v311, v193);
      v174 = v311 - 12;
      if ( (_DWORD *)(v311 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v187 = _InterlockedExchangeAdd((volatile signed __int32 *)(v311 - 4), 0xFFFFFFFF);
        }
        else
        {
          v188 = *(_DWORD *)(v311 - 4);
          *(_DWORD *)(v311 - 4) = v188 - 1;
          v187 = v188;
        }
        if ( v187 <= 0 )
          std::string::_Rep::_M_destroy(v174, &v338);
      }
    }
    abort();
  }
  if ( v321 )
    sub_8057D90(&v319);
LABEL_242:
  v175 = v226 - 12;
  if ( (_DWORD *)(v226 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v189 = _InterlockedExchangeAdd((volatile signed __int32 *)(v226 - 4), 0xFFFFFFFF);
    }
    else
    {
      v189 = *(_DWORD *)(v226 - 4);
      *(_DWORD *)(v226 - 4) = v189 - 1;
    }
    if ( v189 <= 0 )
      std::string::_Rep::_M_destroy(v175, &v338);
  }
  if ( v373 )
    ((void (__cdecl *)(int *, int *, signed int))v373)(&v371, &v371, 3);
  sub_805EF00((int)&v323, v325);
  if ( v321 )
    ((void (__cdecl *)(int *, int *, signed int))v321)(&v319, &v319, 3);
  if ( v194 )
    operator delete(v194);
  v357 = (int)&unk_80CF68C;
  v362 = (int)&unk_80CF6A0;
  v359 = (int)&unk_80CF638;
  std::basic_filebuf<char,std::char_traits<char>>::close(&v359);
LABEL_19:
  std::__basic_file<char>::~__basic_file(&v361);
  v359 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v360);
  v357 = dword_80CF7AC;
  *(int *)((char *)&v357 + *(_DWORD *)(dword_80CF7AC - 12)) = dword_80CF7B0;
  v358 = 0;
  v362 = (int)&unk_80CF5C8;
  return std::ios_base::~ios_base((std::ios_base *)&v362);
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C8C0: using guessed type int __cdecl std::basic_filebuf<char,std::char_traits<char>>::open(_DWORD, _DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CC10: using guessed type int __cdecl std::basic_ifstream<char,std::char_traits<char>>::~basic_ifstream(_DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CEB0: using guessed type int __cdecl std::__basic_file<char>::~__basic_file(_DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D100: using guessed type int __cdecl std::basic_filebuf<char,std::char_traits<char>>::basic_filebuf(_DWORD);
// 804D230: using guessed type int __cdecl std::istream::seekg(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 804D420: using guessed type int __cdecl std::basic_filebuf<char,std::char_traits<char>>::close(_DWORD);
// 805A040: using guessed type int sub_805A040();
// 805E7E0: using guessed type int sub_805E7E0();
// 805E810: using guessed type int sub_805E810();
// 805E830: using guessed type int sub_805E830();
// 80B9AC0: using guessed type int dword_80B9AC0;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CE654: using guessed type int dword_80CE654;
// 80CE658: using guessed type int dword_80CE658;
// 80CE65C: using guessed type int dword_80CE65C;
// 80CE660: using guessed type int dword_80CE660;
// 80CE664: using guessed type int dword_80CE664;
// 80CE668: using guessed type int dword_80CE668;
// 80CE66C: using guessed type char byte_80CE66C;
// 80CE670: using guessed type int dword_80CE670;
// 80CE674: using guessed type int dword_80CE674;
// 80CE678: using guessed type int dword_80CE678;
// 80CE680: using guessed type int dword_80CE680;
// 80CE684: using guessed type int dword_80CE684;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF7AC: using guessed type int dword_80CF7AC;
// 80CF7B0: using guessed type int dword_80CF7B0;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF878: using guessed type char graceful_terminate;
// 80CF87C: using guessed type int terminate_timeout;
// 80CF884: using guessed type int dword_80CF884;
// 80CF888: using guessed type int dword_80CF888;
// 80CF88C: using guessed type char byte_80CF88C;
// 80CF894: using guessed type int dword_80CF894;
// 80CF898: using guessed type int dword_80CF898;

//----- (0805D460) --------------------------------------------------------
std::string *__stdcall sub_805D460(std::string *a1)
{
  const char *v1; // esi@2
  const char *v2; // edi@3
  int v3; // eax@4
  std::ostream *v4; // ebp@4
  int v5; // eax@4
  int v6; // ebx@4
  char v7; // al@6
  std::ostream *v8; // eax@7
  int v9; // ebx@7
  int v10; // eax@7
  std::ostream *v11; // ebp@7
  int v12; // eax@7
  int v13; // ebx@7
  char v14; // al@9
  std::ostream *v15; // eax@10
  int v16; // ebx@10
  int v17; // eax@10
  unsigned int v18; // ebp@10
  int v19; // eax@10
  int v20; // ebx@10
  char v21; // al@12
  std::ostream *v22; // eax@13
  int v23; // ebx@13
  std::ostream *v24; // ebx@13
  size_t v25; // eax@13
  int v26; // eax@13
  void *v27; // edi@13
  char v28; // al@15
  std::ostream *v29; // eax@16
  std::ostream *v30; // ebx@16
  size_t v31; // eax@16
  int v32; // eax@16
  int v33; // esi@16
  char v34; // al@18
  std::ostream *v35; // eax@19
  int v36; // ebx@19
  std::ostream *v37; // ebx@19
  int v38; // eax@19
  int v39; // esi@19
  char v40; // al@21
  std::ostream *v41; // eax@22
  int v42; // ebx@22
  std::ostream *v43; // ebx@22
  int v44; // eax@22
  int v45; // esi@22
  char v46; // al@24
  std::ostream *v47; // eax@25
  int v48; // ebx@25
  std::ostream *v49; // ebx@25
  int v50; // eax@25
  int v51; // esi@25
  char v52; // al@27
  std::ostream *v53; // eax@28
  int v54; // ebx@28
  int v55; // eax@28
  std::ostream *v56; // esi@28
  int v57; // eax@28
  int v58; // ebx@28
  char v59; // al@30
  std::ostream *v60; // eax@31
  int v61; // ebx@31
  int v62; // eax@31
  std::ostream *v63; // esi@31
  int v64; // eax@31
  int v65; // ebx@31
  char v66; // al@33
  std::ostream *v67; // eax@34
  int v68; // ebx@34
  std::ostream *v69; // ebx@34
  int v70; // eax@34
  int v71; // esi@34
  char v72; // al@36
  std::ostream *v73; // eax@37
  int v74; // ebx@37
  int v75; // eax@37
  std::ostream *v76; // esi@37
  int v77; // eax@37
  int v78; // ebx@37
  char v79; // al@39
  std::ostream *v80; // eax@40
  int v81; // ebx@40
  int v82; // eax@40
  std::ostream *v83; // esi@40
  int v84; // eax@40
  int v85; // ebx@40
  char v86; // al@42
  std::ostream *v87; // eax@43
  int v88; // ebx@43
  int v89; // eax@43
  std::ostream *v90; // esi@43
  int v91; // eax@43
  int v92; // ebx@43
  char v93; // al@45
  std::ostream *v94; // eax@46
  int v95; // ebx@46
  int v96; // eax@46
  std::ostream *v97; // esi@46
  int v98; // eax@46
  int v99; // ebx@46
  char v100; // al@48
  std::ostream *v101; // eax@49
  int v102; // ebx@49
  int v103; // eax@49
  std::ostream *v104; // esi@49
  int v105; // eax@49
  int v106; // ebx@49
  char v107; // al@51
  std::ostream *v108; // eax@52
  int v109; // ebx@52
  std::ostream *v110; // ebx@52
  int v111; // eax@52
  int v112; // esi@52
  char v113; // al@54
  std::ostream *v114; // eax@55
  int v115; // ebx@55
  int v116; // eax@55
  std::ostream *v117; // esi@55
  int v118; // eax@55
  int v119; // ebx@55
  char v120; // al@57
  std::ostream *v121; // eax@58
  int v122; // ebx@58
  int v123; // eax@58
  std::ostream *v124; // esi@58
  int v125; // eax@58
  int v126; // ebx@58
  char v127; // al@60
  std::ostream *v128; // eax@61
  int v129; // ebx@61
  int v130; // eax@61
  std::ostream *v131; // esi@61
  int v132; // eax@61
  int v133; // ebx@61
  char v134; // al@63
  std::ostream *v135; // eax@64
  int v136; // ebx@64
  int v137; // eax@64
  std::ostream *v138; // esi@64
  int v139; // eax@64
  int v140; // ebx@64
  char v141; // al@66
  std::ostream *v142; // eax@67
  int v143; // ebx@67
  int v144; // eax@67
  std::ostream *v145; // esi@67
  int v146; // eax@67
  int v147; // ebx@67
  char v148; // al@69
  std::ostream *v149; // eax@70
  int v150; // ebx@70
  int v151; // eax@70
  std::ostream *v152; // esi@70
  int v153; // eax@70
  int v154; // ebx@70
  char v155; // al@72
  std::ostream *v156; // eax@73
  int v157; // ebx@73
  std::ostream *v158; // ebx@73
  int v159; // eax@73
  int v160; // esi@73
  char v161; // al@75
  std::ostream *v162; // eax@76
  int v163; // ebx@76
  int v164; // eax@76
  std::ostream *v165; // esi@76
  int v166; // eax@76
  int v167; // ebx@76
  char v168; // al@78
  std::ostream *v169; // eax@79
  int v170; // ebx@79
  int v171; // ebx@79
  int v172; // eax@79
  std::ostream *v173; // esi@79
  int v174; // eax@79
  int v175; // ebx@79
  char v176; // al@81
  std::ostream *v177; // eax@82
  int v178; // ebx@82
  int v179; // eax@82
  int v180; // edx@82
  int v181; // ecx@83
  int v182; // eax@85
  int v183; // edx@85
  int v184; // edx@86
  signed __int32 v186; // ecx@119
  int v187; // esi@122
  char *v188; // ebx@122
  signed __int32 v189; // ecx@141
  int v190; // [sp+18h] [bp-124h]@1
  int v191; // [sp+1Ch] [bp-120h]@4
  unsigned int v192; // [sp+20h] [bp-11Ch]@1
  int v193; // [sp+24h] [bp-118h]@1
  int v194; // [sp+28h] [bp-114h]@1
  int v195; // [sp+2Ch] [bp-110h]@1
  int v196; // [sp+30h] [bp-10Ch]@1
  int v197; // [sp+34h] [bp-108h]@1
  int v198; // [sp+38h] [bp-104h]@1
  int v199; // [sp+3Ch] [bp-100h]@1
  int v200; // [sp+40h] [bp-FCh]@1
  int v201; // [sp+44h] [bp-F8h]@1
  int v202; // [sp+48h] [bp-F4h]@1
  int v203; // [sp+4Ch] [bp-F0h]@1
  int v204; // [sp+50h] [bp-ECh]@1
  char v205; // [sp+55h] [bp-E7h]@1
  char v206; // [sp+56h] [bp-E6h]@1
  char v207; // [sp+57h] [bp-E5h]@1
  int v208; // [sp+58h] [bp-E4h]@1
  int v209; // [sp+5Ch] [bp-E0h]@1
  char v210; // [sp+66h] [bp-D6h]@143
  char v211; // [sp+67h] [bp-D5h]@84
  int v212; // [sp+68h] [bp-D4h]@84
  int v213; // [sp+6Ch] [bp-D0h]@4
  int v214; // [sp+70h] [bp-CCh]@4
  int v215; // [sp+74h] [bp-C8h]@4
  int v216; // [sp+78h] [bp-C4h]@4
  int v217; // [sp+7Ch] [bp-C0h]@4
  int v218; // [sp+80h] [bp-BCh]@4
  int v219; // [sp+84h] [bp-B8h]@4
  int v220; // [sp+88h] [bp-B4h]@4
  char v221; // [sp+8Ch] [bp-B0h]@4
  int v222; // [sp+90h] [bp-ACh]@4
  int v223; // [sp+94h] [bp-A8h]@4
  int v224; // [sp+98h] [bp-A4h]@4
  int v225; // [sp+108h] [bp-34h]@4
  char v226; // [sp+10Ch] [bp-30h]@4
  char v227; // [sp+10Dh] [bp-2Fh]@4
  int v228; // [sp+110h] [bp-2Ch]@4
  int v229; // [sp+114h] [bp-28h]@4
  int v230; // [sp+118h] [bp-24h]@4
  int v231; // [sp+11Ch] [bp-20h]@4

  v209 = log_level;
  v204 = dword_80CE648;
  v207 = graceful_terminate;
  v208 = terminate_timeout;
  v203 = dword_80CE650;
  v202 = dword_80CE654;
  v200 = dword_80CE658;
  v201 = dword_80CE65C;
  v197 = dword_80CE660;
  v198 = dword_80CE664;
  v199 = dword_80CE668;
  v205 = byte_80CF88C;
  v206 = byte_80CE66C;
  v194 = dword_80CE670;
  v195 = dword_80CE674;
  v196 = dword_80CE678;
  v192 = seconds;
  v193 = dword_80CE680;
  v190 = dword_80CE684;
  if ( *(_DWORD *)(dword_80CF890 - 12) )
  {
    v1 = "yes";
    if ( byte_80CF868 )
      goto LABEL_3;
  }
  else
  {
    v1 = "no";
    if ( byte_80CF868 )
    {
LABEL_3:
      v2 = " (continue)";
      goto LABEL_4;
    }
  }
  v2 = "";
LABEL_4:
  v191 = g_time;
  std::ios_base::ios_base((std::ios_base *)&v224);
  v224 = (int)&unk_80CF5C8;
  v225 = 0;
  v226 = 0;
  v227 = 0;
  v228 = 0;
  v229 = 0;
  v230 = 0;
  v231 = 0;
  v213 = dword_80CF674;
  *(int *)((char *)&v213 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v213 + *(_DWORD *)(v213 - 12), 0);
  v213 = (int)&unk_80CF5DC;
  v224 = (int)&unk_80CF5F0;
  v214 = (int)&unk_80CF7F0;
  v215 = 0;
  v216 = 0;
  v217 = 0;
  v218 = 0;
  v219 = 0;
  v220 = 0;
  std::locale::locale((std::locale *)&v221);
  v214 = (int)&unk_80CF588;
  v222 = 16;
  v223 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v224, &v214);
  v3 = std::__ostream_insert<char,std::char_traits<char>>(&v213, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  v4 = (std::ostream *)v3;
  v5 = *(_DWORD *)(*(_DWORD *)v3 - 12);
  v6 = *(_DWORD *)((char *)v4 + v5 + 124);
  if ( !v6 )
  {
LABEL_151:
    std::__throw_bad_cast();
LABEL_152:
    std::__throw_bad_cast();
LABEL_153:
    v187 = std::__throw_bad_cast();
    v224 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v224);
    v188 = &v211;
    goto LABEL_123;
  }
  if ( *(_BYTE *)(v6 + 28) )
  {
    v7 = *(_BYTE *)(v6 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v4 + v5 + 124));
    v7 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v6 + 24))(v6, 10);
  }
  v8 = (std::ostream *)std::ostream::put(v4, v7);
  v9 = std::ostream::flush(v8);
  std::__ostream_insert<char,std::char_traits<char>>(v9, "  node id: ", 11);
  v10 = std::__ostream_insert<char,std::char_traits<char>>(v9, dword_80CF898, *(_DWORD *)(dword_80CF898 - 12));
  v11 = (std::ostream *)v10;
  v12 = *(_DWORD *)(*(_DWORD *)v10 - 12);
  v13 = *(_DWORD *)((char *)v11 + v12 + 124);
  if ( !v13 )
    goto LABEL_148;
  if ( *(_BYTE *)(v13 + 28) )
  {
    v14 = *(_BYTE *)(v13 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v11 + v12 + 124));
    v14 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v13 + 24))(v13, 10);
  }
  v15 = (std::ostream *)std::ostream::put(v11, v14);
  v16 = std::ostream::flush(v15);
  std::__ostream_insert<char,std::char_traits<char>>(v16, "  server: ", 10);
  v17 = std::__ostream_insert<char,std::char_traits<char>>(v16, dword_80CF894, *(_DWORD *)(dword_80CF894 - 12));
  v18 = v17;
  v19 = *(_DWORD *)(*(_DWORD *)v17 - 12);
  v20 = *(_DWORD *)(v18 + v19 + 124);
  if ( !v20 )
    goto LABEL_149;
  if ( *(_BYTE *)(v20 + 28) )
  {
    v21 = *(_BYTE *)(v20 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)(v18 + v19 + 124));
    v21 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v20 + 24))(v20, 10);
  }
  v22 = (std::ostream *)std::ostream::put((std::ostream *)v18, v21);
  v23 = std::ostream::flush(v22);
  std::__ostream_insert<char,std::char_traits<char>>(v23, "  session id: ", 14);
  v24 = (std::ostream *)std::ostream::operator<<(v23, v191);
  v25 = strlen(v2);
  std::__ostream_insert<char,std::char_traits<char>>(v24, v2, v25);
  v26 = *(_DWORD *)(*(_DWORD *)v24 - 12);
  v27 = *(void **)((char *)v24 + v26 + 124);
  if ( !v27 )
    goto LABEL_152;
  if ( *((_BYTE *)v27 + 28) )
  {
    v28 = *((_BYTE *)v27 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v24 + v26 + 124));
    v28 = (*(int (__cdecl **)(void *, signed int))(*(_DWORD *)v27 + 24))(v27, 10);
  }
  v29 = (std::ostream *)std::ostream::put(v24, v28);
  v30 = (std::ostream *)std::ostream::flush(v29);
  std::__ostream_insert<char,std::char_traits<char>>(v30, "  proxy: ", 9);
  v31 = strlen(v1);
  std::__ostream_insert<char,std::char_traits<char>>(v30, v1, v31);
  v32 = *(_DWORD *)(*(_DWORD *)v30 - 12);
  v33 = *(_DWORD *)((char *)v30 + v32 + 124);
  if ( !v33 )
  {
LABEL_147:
    std::__throw_bad_cast();
LABEL_148:
    std::__throw_bad_cast();
LABEL_149:
    std::__throw_bad_cast();
LABEL_150:
    std::__throw_bad_cast();
    goto LABEL_151;
  }
  if ( *(_BYTE *)(v33 + 28) )
  {
    v34 = *(_BYTE *)(v33 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v30 + v32 + 124));
    v34 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v33 + 24))(v33, 10);
  }
  v35 = (std::ostream *)std::ostream::put(v30, v34);
  v36 = std::ostream::flush(v35);
  std::__ostream_insert<char,std::char_traits<char>>(v36, "  tasks fetch interval: ", 24);
  v37 = (std::ostream *)std::ostream::operator<<(v36, v190);
  std::__ostream_insert<char,std::char_traits<char>>(v37, " sec", 4);
  v38 = *(_DWORD *)(*(_DWORD *)v37 - 12);
  v39 = *(_DWORD *)((char *)v37 + v38 + 124);
  if ( !v39 )
    goto LABEL_134;
  if ( *(_BYTE *)(v39 + 28) )
  {
    v40 = *(_BYTE *)(v39 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v37 + v38 + 124));
    v40 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v39 + 24))(v39, 10);
  }
  v41 = (std::ostream *)std::ostream::put(v37, v40);
  v42 = std::ostream::flush(v41);
  std::__ostream_insert<char,std::char_traits<char>>(v42, "  stats report interval: ", 25);
  v43 = (std::ostream *)std::ostream::operator<<(v42, v193);
  std::__ostream_insert<char,std::char_traits<char>>(v43, " sec", 4);
  v44 = *(_DWORD *)(*(_DWORD *)v43 - 12);
  v45 = *(_DWORD *)((char *)v43 + v44 + 124);
  if ( !v45 )
    goto LABEL_135;
  if ( *(_BYTE *)(v45 + 28) )
  {
    v46 = *(_BYTE *)(v45 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v43 + v44 + 124));
    v46 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v45 + 24))(v45, 10);
  }
  v47 = (std::ostream *)std::ostream::put(v43, v46);
  v48 = std::ostream::flush(v47);
  std::__ostream_insert<char,std::char_traits<char>>(v48, "  server retry interval: ", 25);
  v49 = (std::ostream *)std::ostream::operator<<(v48, v192);
  std::__ostream_insert<char,std::char_traits<char>>(v49, " sec", 4);
  v50 = *(_DWORD *)(*(_DWORD *)v49 - 12);
  v51 = *(_DWORD *)((char *)v49 + v50 + 124);
  if ( !v51 )
    goto LABEL_132;
  if ( *(_BYTE *)(v51 + 28) )
  {
    v52 = *(_BYTE *)(v51 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v49 + v50 + 124));
    v52 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v51 + 24))(v51, 10);
  }
  v53 = (std::ostream *)std::ostream::put(v49, v52);
  v54 = std::ostream::flush(v53);
  std::__ostream_insert<char,std::char_traits<char>>(v54, "  server error retry count: ", 28);
  v55 = std::ostream::operator<<(v54, v196);
  v56 = (std::ostream *)v55;
  v57 = *(_DWORD *)(*(_DWORD *)v55 - 12);
  v58 = *(_DWORD *)((char *)v56 + v57 + 124);
  if ( !v58 )
    goto LABEL_133;
  if ( *(_BYTE *)(v58 + 28) )
  {
    v59 = *(_BYTE *)(v58 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v56 + v57 + 124));
    v59 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v58 + 24))(v58, 10);
  }
  v60 = (std::ostream *)std::ostream::put(v56, v59);
  v61 = std::ostream::flush(v60);
  std::__ostream_insert<char,std::char_traits<char>>(v61, "  server connection error retry count: ", 39);
  v62 = std::ostream::operator<<(v61, v195);
  v63 = (std::ostream *)v62;
  v64 = *(_DWORD *)(*(_DWORD *)v62 - 12);
  v65 = *(_DWORD *)((char *)v63 + v64 + 124);
  if ( !v65 )
    goto LABEL_138;
  if ( *(_BYTE *)(v65 + 28) )
  {
    v66 = *(_BYTE *)(v65 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v63 + v64 + 124));
    v66 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v65 + 24))(v65, 10);
  }
  v67 = (std::ostream *)std::ostream::put(v63, v66);
  v68 = std::ostream::flush(v67);
  std::__ostream_insert<char,std::char_traits<char>>(v68, "  server request timeout: ", 26);
  v69 = (std::ostream *)std::ostream::operator<<(v68, v194);
  std::__ostream_insert<char,std::char_traits<char>>(v69, " sec", 4);
  v70 = *(_DWORD *)(*(_DWORD *)v69 - 12);
  v71 = *(_DWORD *)((char *)v69 + v70 + 124);
  if ( !v71 )
    goto LABEL_139;
  if ( *(_BYTE *)(v71 + 28) )
  {
    v72 = *(_BYTE *)(v71 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v69 + v70 + 124));
    v72 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v71 + 24))(v71, 10);
  }
  v73 = (std::ostream *)std::ostream::put(v69, v72);
  v74 = std::ostream::flush(v73);
  std::__ostream_insert<char,std::char_traits<char>>(v74, "  server request deflate allowed: ", 34);
  v75 = std::ostream::_M_insert<bool>(v74, (unsigned __int8)v206);
  v76 = (std::ostream *)v75;
  v77 = *(_DWORD *)(*(_DWORD *)v75 - 12);
  v78 = *(_DWORD *)((char *)v76 + v77 + 124);
  if ( !v78 )
    goto LABEL_136;
  if ( *(_BYTE *)(v78 + 28) )
  {
    v79 = *(_BYTE *)(v78 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v76 + v77 + 124));
    v79 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v78 + 24))(v78, 10);
  }
  v80 = (std::ostream *)std::ostream::put(v76, v79);
  v81 = std::ostream::flush(v80);
  std::__ostream_insert<char,std::char_traits<char>>(v81, "  check IPv6: ", 14);
  v82 = std::ostream::_M_insert<bool>(v81, (unsigned __int8)v205);
  v83 = (std::ostream *)v82;
  v84 = *(_DWORD *)(*(_DWORD *)v82 - 12);
  v85 = *(_DWORD *)((char *)v83 + v84 + 124);
  if ( !v85 )
    goto LABEL_137;
  if ( *(_BYTE *)(v85 + 28) )
  {
    v86 = *(_BYTE *)(v85 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v83 + v84 + 124));
    v86 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v85 + 24))(v85, 10);
  }
  v87 = (std::ostream *)std::ostream::put(v83, v86);
  v88 = std::ostream::flush(v87);
  std::__ostream_insert<char,std::char_traits<char>>(v88, "  default max dns jobs: ", 24);
  v89 = std::ostream::operator<<(v88, v199);
  v90 = (std::ostream *)v89;
  v91 = *(_DWORD *)(*(_DWORD *)v89 - 12);
  v92 = *(_DWORD *)((char *)v90 + v91 + 124);
  if ( !v92 )
    goto LABEL_126;
  if ( *(_BYTE *)(v92 + 28) )
  {
    v93 = *(_BYTE *)(v92 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v90 + v91 + 124));
    v93 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v92 + 24))(v92, 10);
  }
  v94 = (std::ostream *)std::ostream::put(v90, v93);
  v95 = std::ostream::flush(v94);
  std::__ostream_insert<char,std::char_traits<char>>(v95, "  default max total connections: ", 33);
  v96 = std::ostream::operator<<(v95, v198);
  v97 = (std::ostream *)v96;
  v98 = *(_DWORD *)(*(_DWORD *)v96 - 12);
  v99 = *(_DWORD *)((char *)v97 + v98 + 124);
  if ( !v99 )
    goto LABEL_127;
  if ( *(_BYTE *)(v99 + 28) )
  {
    v100 = *(_BYTE *)(v99 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v97 + v98 + 124));
    v100 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v99 + 24))(v99, 10);
  }
  v101 = (std::ostream *)std::ostream::put(v97, v100);
  v102 = std::ostream::flush(v101);
  std::__ostream_insert<char,std::char_traits<char>>(v102, "  default max https connections: ", 33);
  v103 = std::ostream::operator<<(v102, v197);
  v104 = (std::ostream *)v103;
  v105 = *(_DWORD *)(*(_DWORD *)v103 - 12);
  v106 = *(_DWORD *)((char *)v104 + v105 + 124);
  if ( !v106 )
    goto LABEL_150;
  if ( *(_BYTE *)(v106 + 28) )
  {
    v107 = *(_BYTE *)(v106 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v104 + v105 + 124));
    v107 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v106 + 24))(v106, 10);
  }
  v108 = (std::ostream *)std::ostream::put(v104, v107);
  v109 = std::ostream::flush(v108);
  std::__ostream_insert<char,std::char_traits<char>>(v109, "  default request timeout: ", 27);
  v110 = (std::ostream *)std::ostream::operator<<(v109, v201);
  std::__ostream_insert<char,std::char_traits<char>>(v110, " sec", 4);
  v111 = *(_DWORD *)(*(_DWORD *)v110 - 12);
  v112 = *(_DWORD *)((char *)v110 + v111 + 124);
  if ( !v112 )
  {
    std::__throw_bad_cast();
LABEL_126:
    std::__throw_bad_cast();
LABEL_127:
    std::__throw_bad_cast();
LABEL_128:
    std::__throw_bad_cast();
LABEL_129:
    std::__throw_bad_cast();
LABEL_130:
    std::__throw_bad_cast();
LABEL_131:
    std::__throw_bad_cast();
LABEL_132:
    std::__throw_bad_cast();
LABEL_133:
    std::__throw_bad_cast();
LABEL_134:
    std::__throw_bad_cast();
LABEL_135:
    std::__throw_bad_cast();
LABEL_136:
    std::__throw_bad_cast();
LABEL_137:
    std::__throw_bad_cast();
LABEL_138:
    std::__throw_bad_cast();
LABEL_139:
    v182 = std::__throw_bad_cast();
LABEL_140:
    if ( &_pthread_key_create )
    {
      v189 = _InterlockedExchangeAdd((volatile signed __int32 *)(v182 - 4), 0xFFFFFFFF);
    }
    else
    {
      v189 = *(_DWORD *)(v182 - 4);
      *(_DWORD *)(v182 - 4) = v189 - 1;
    }
    if ( v189 <= 0 )
      std::string::_Rep::_M_destroy(v183, &v210);
    goto LABEL_86;
  }
  if ( *(_BYTE *)(v112 + 28) )
  {
    v113 = *(_BYTE *)(v112 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v110 + v111 + 124));
    v113 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v112 + 24))(v112, 10);
  }
  v114 = (std::ostream *)std::ostream::put(v110, v113);
  v115 = std::ostream::flush(v114);
  std::__ostream_insert<char,std::char_traits<char>>(v115, "  default max stored content size: ", 35);
  v116 = std::ostream::operator<<(v115, v200);
  v117 = (std::ostream *)v116;
  v118 = *(_DWORD *)(*(_DWORD *)v116 - 12);
  v119 = *(_DWORD *)((char *)v117 + v118 + 124);
  if ( !v119 )
    goto LABEL_130;
  if ( *(_BYTE *)(v119 + 28) )
  {
    v120 = *(_BYTE *)(v119 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v117 + v118 + 124));
    v120 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v119 + 24))(v119, 10);
  }
  v121 = (std::ostream *)std::ostream::put(v117, v120);
  v122 = std::ostream::flush(v121);
  std::__ostream_insert<char,std::char_traits<char>>(v122, &byte_80B987B, 27);
  v123 = std::ostream::operator<<(v122, v202);
  v124 = (std::ostream *)v123;
  v125 = *(_DWORD *)(*(_DWORD *)v123 - 12);
  v126 = *(_DWORD *)((char *)v124 + v125 + 124);
  if ( !v126 )
    goto LABEL_131;
  if ( *(_BYTE *)(v126 + 28) )
  {
    v127 = *(_BYTE *)(v126 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v124 + v125 + 124));
    v127 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v126 + 24))(v126, 10);
  }
  v128 = (std::ostream *)std::ostream::put(v124, v127);
  v129 = std::ostream::flush(v128);
  std::__ostream_insert<char,std::char_traits<char>>(v129, "  validator user agent: ", 24);
  v130 = std::__ostream_insert<char,std::char_traits<char>>(v129, dword_80CF888, *(_DWORD *)(dword_80CF888 - 12));
  v131 = (std::ostream *)v130;
  v132 = *(_DWORD *)(*(_DWORD *)v130 - 12);
  v133 = *(_DWORD *)((char *)v131 + v132 + 124);
  if ( !v133 )
    goto LABEL_128;
  if ( *(_BYTE *)(v133 + 28) )
  {
    v134 = *(_BYTE *)(v133 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v131 + v132 + 124));
    v134 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v133 + 24))(v133, 10);
  }
  v135 = (std::ostream *)std::ostream::put(v131, v134);
  v136 = std::ostream::flush(v135);
  std::__ostream_insert<char,std::char_traits<char>>(v136, "  tunnel user: ", 15);
  v137 = std::__ostream_insert<char,std::char_traits<char>>(v136, dword_80CF884, *(_DWORD *)(dword_80CF884 - 12));
  v138 = (std::ostream *)v137;
  v139 = *(_DWORD *)(*(_DWORD *)v137 - 12);
  v140 = *(_DWORD *)((char *)v138 + v139 + 124);
  if ( !v140 )
    goto LABEL_129;
  if ( *(_BYTE *)(v140 + 28) )
  {
    v141 = *(_BYTE *)(v140 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v138 + v139 + 124));
    v141 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v140 + 24))(v140, 10);
  }
  v142 = (std::ostream *)std::ostream::put(v138, v141);
  v143 = std::ostream::flush(v142);
  std::__ostream_insert<char,std::char_traits<char>>(v143, "  tunnel key path: ", 19);
  v144 = std::__ostream_insert<char,std::char_traits<char>>(v143, g_idrsa_path, *(_DWORD *)(g_idrsa_path - 12));
  v145 = (std::ostream *)v144;
  v146 = *(_DWORD *)(*(_DWORD *)v144 - 12);
  v147 = *(_DWORD *)((char *)v145 + v146 + 124);
  if ( !v147 )
  {
    std::__throw_bad_cast();
LABEL_145:
    std::__throw_bad_cast();
LABEL_146:
    std::__throw_bad_cast();
    goto LABEL_147;
  }
  if ( *(_BYTE *)(v147 + 28) )
  {
    v148 = *(_BYTE *)(v147 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v145 + v146 + 124));
    v148 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v147 + 24))(v147, 10);
  }
  v149 = (std::ostream *)std::ostream::put(v145, v148);
  v150 = std::ostream::flush(v149);
  std::__ostream_insert<char,std::char_traits<char>>(v150, "  tunnel proxy port: ", 21);
  v151 = std::ostream::operator<<(v150, v203);
  v152 = (std::ostream *)v151;
  v153 = *(_DWORD *)(*(_DWORD *)v151 - 12);
  v154 = *(_DWORD *)((char *)v152 + v153 + 124);
  if ( !v154 )
    goto LABEL_153;
  if ( *(_BYTE *)(v154 + 28) )
  {
    v155 = *(_BYTE *)(v154 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v152 + v153 + 124));
    v155 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v154 + 24))(v154, 10);
  }
  v156 = (std::ostream *)std::ostream::put(v152, v155);
  v157 = std::ostream::flush(v156);
  std::__ostream_insert<char,std::char_traits<char>>(v157, "  terminate after: ", 19);
  v158 = (std::ostream *)std::ostream::operator<<(v157, v208);
  std::__ostream_insert<char,std::char_traits<char>>(v158, " sec", 4);
  v159 = *(_DWORD *)(*(_DWORD *)v158 - 12);
  v160 = *(_DWORD *)((char *)v158 + v159 + 124);
  if ( !v160 )
    goto LABEL_145;
  if ( *(_BYTE *)(v160 + 28) )
  {
    v161 = *(_BYTE *)(v160 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v158 + v159 + 124));
    v161 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v160 + 24))(v160, 10);
  }
  v162 = (std::ostream *)std::ostream::put(v158, v161);
  v163 = std::ostream::flush(v162);
  std::__ostream_insert<char,std::char_traits<char>>(v163, "  graceful terminate: ", 22);
  v164 = std::ostream::_M_insert<bool>(v163, (unsigned __int8)v207);
  v165 = (std::ostream *)v164;
  v166 = *(_DWORD *)(*(_DWORD *)v164 - 12);
  v167 = *(_DWORD *)((char *)v165 + v166 + 124);
  if ( !v167 )
    goto LABEL_146;
  if ( *(_BYTE *)(v167 + 28) )
  {
    v168 = *(_BYTE *)(v167 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v165 + v166 + 124));
    v168 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v167 + 24))(v167, 10);
  }
  v169 = (std::ostream *)std::ostream::put(v165, v168);
  v170 = std::ostream::flush(v169);
  std::__ostream_insert<char,std::char_traits<char>>(v170, "  socks proxy: ", 15);
  v171 = std::__ostream_insert<char,std::char_traits<char>>(v170, dword_80CF864, *(_DWORD *)(dword_80CF864 - 12));
  std::__ostream_insert<char,std::char_traits<char>>(v171, ":", 1);
  v172 = std::ostream::operator<<(v171, v204);
  v173 = (std::ostream *)v172;
  v174 = *(_DWORD *)(*(_DWORD *)v172 - 12);
  v175 = *(_DWORD *)((char *)v173 + v174 + 124);
  if ( !v175 )
  {
    v187 = std::__throw_bad_cast();
    v188 = &v211;
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v213);
LABEL_123:
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v188);
    Unwind_Resume(v187);
  }
  if ( *(_BYTE *)(v175 + 28) )
  {
    v176 = *(_BYTE *)(v175 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v173 + v174 + 124));
    v176 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v175 + 24))(v175, 10);
  }
  v177 = (std::ostream *)std::ostream::put(v173, v176);
  v178 = std::ostream::flush(v177);
  std::__ostream_insert<char,std::char_traits<char>>(v178, "  log level: ", 13);
  v179 = std::ostream::operator<<(v178, v209);
  *(_DWORD *)a1 = &unk_80CF83C;
  v180 = *(_DWORD *)(v179 + 24);
  if ( !v180 )
  {
    std::string::assign(a1, (const std::string *)(v179 + 40));
    goto LABEL_86;
  }
  v181 = *(_DWORD *)(v179 + 16);
  if ( v180 > (unsigned int)v181 )
  {
    v212 = std::string::_S_construct<char *>((int)&v211, v18, v27, *(_DWORD *)(v179 + 20), v180, (int)&v211);
    std::string::swap(a1, (std::string *)&v212);
  }
  else
  {
    v212 = std::string::_S_construct<char *>((int)&v211, v18, v27, *(_DWORD *)(v179 + 20), v181, (int)&v211);
    std::string::swap(a1, (std::string *)&v212);
  }
  v182 = v212;
  v183 = v212 - 12;
  if ( (_DWORD *)(v212 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    goto LABEL_140;
LABEL_86:
  v213 = (int)&unk_80CF5DC;
  v224 = (int)&unk_80CF5F0;
  v214 = (int)&unk_80CF588;
  v184 = v223 - 12;
  if ( (_DWORD *)(v223 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v186 = _InterlockedExchangeAdd((volatile signed __int32 *)(v223 - 4), 0xFFFFFFFF);
    }
    else
    {
      v186 = *(_DWORD *)(v223 - 4);
      *(_DWORD *)(v223 - 4) = v186 - 1;
    }
    if ( v186 <= 0 )
      std::string::_Rep::_M_destroy(v184, &v212);
  }
  v214 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v221);
  v213 = dword_80CF674;
  *(int *)((char *)&v213 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  v224 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v224);
  return a1;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CCC0: using guessed type int __cdecl std::ostream::_M_insert<bool>(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80B987B: using guessed type char byte_80B987B;
// 80CE654: using guessed type int dword_80CE654;
// 80CE658: using guessed type int dword_80CE658;
// 80CE65C: using guessed type int dword_80CE65C;
// 80CE660: using guessed type int dword_80CE660;
// 80CE664: using guessed type int dword_80CE664;
// 80CE668: using guessed type int dword_80CE668;
// 80CE66C: using guessed type char byte_80CE66C;
// 80CE670: using guessed type int dword_80CE670;
// 80CE674: using guessed type int dword_80CE674;
// 80CE678: using guessed type int dword_80CE678;
// 80CE680: using guessed type int dword_80CE680;
// 80CE684: using guessed type int dword_80CE684;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF868: using guessed type char byte_80CF868;
// 80CF86C: using guessed type int g_time;
// 80CF874: using guessed type int log_level;
// 80CF878: using guessed type char graceful_terminate;
// 80CF87C: using guessed type int terminate_timeout;
// 80CF884: using guessed type int dword_80CF884;
// 80CF888: using guessed type int dword_80CF888;
// 80CF88C: using guessed type char byte_80CF88C;
// 80CF894: using guessed type int dword_80CF894;
// 80CF898: using guessed type int dword_80CF898;

//----- (0805E890) --------------------------------------------------------
int __cdecl sub_805E890(int a1, const char **a2)
{
  int v2; // ebx@1
  int result; // eax@1

  v2 = **(_DWORD **)a1;
  result = atoi(*a2);
  *(_DWORD *)v2 = result;
  return result;
}

//----- (0805E8C0) --------------------------------------------------------
int __cdecl sub_805E8C0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  const void *v4; // esi@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80B9AC4;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(0xCu);
    qmemcpy(v5, v4, 0xCu);
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80B9AC4: using guessed type void *off_80B9AC4;

//----- (0805E960) --------------------------------------------------------
int __cdecl sub_805E960(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80B9B60;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80B9B60: using guessed type void *off_80B9B60;

//----- (0805EA00) --------------------------------------------------------
int __cdecl sub_805EA00(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80B9BB0;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80B9BB0: using guessed type void *off_80B9BB0;

//----- (0805EAA0) --------------------------------------------------------
int __cdecl sub_805EAA0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80B9BEC;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80B9BEC: using guessed type void *off_80B9BEC;

//----- (0805EB40) --------------------------------------------------------
signed int __cdecl sub_805EB40(int a1)
{
  int v1; // ebp@1
  int v2; // ebx@2
  int i; // eax@2
  int v4; // eax@4
  signed int result; // eax@6
  unsigned int v6; // eax@9
  int v7; // ecx@10
  int v8; // ebx@12
  int v9; // eax@15
  int v10; // edx@15
  unsigned int v11; // edx@18
  const char *v12; // eax@19
  signed __int32 v13; // edx@24
  signed int v14; // ST0C_4@26
  const char *v15; // ebx@28
  signed __int32 v16; // ebx@30
  char v17; // [sp+1Bh] [bp-21h]@12
  int v18; // [sp+1Ch] [bp-20h]@1

  v1 = *(_DWORD *)a1;
  v18 = (int)&unk_80CF83C;
  while ( 2 )
  {
    v2 = *(_DWORD *)(*(_DWORD *)v1 + 40);
    for ( i = *(_DWORD *)(v2 + 568); ; *(_DWORD *)(v2 + 568) = i )
    {
      result = sub_808C150(v2 + 528, (int *)(v2 + 564), i);
      if ( result != 4 )
        break;
      if ( !*(_DWORD *)(v2 + 8) )
      {
        v8 = std::__throw_bad_function_call();
        std::string::_Rep::_M_dispose(v18 - 12, &v17);
        Unwind_Resume(v8);
      }
      v4 = (*(int (__cdecl **)(int, int))(v2 + 12))(v2, v2 + 564);
      if ( !v4 )
      {
        LOBYTE(v6) = sub_808C0E0(v2 + 528);
        result = v6 < 1 ? 3 : 1;
        goto LABEL_10;
      }
      i = *(_DWORD *)(v2 + 564) + v4;
    }
    if ( result == 2 )
    {
      std::string::append(
        (std::string *)&v18,
        *(const char **)(*(_DWORD *)(*(_DWORD *)v1 + 40) + 540),
        *(_DWORD *)(*(_DWORD *)(*(_DWORD *)v1 + 40) + 544));
      continue;
    }
    break;
  }
  if ( !result )
  {
    v9 = *(_DWORD *)(*(_DWORD *)v1 + 40);
    v10 = *(_DWORD *)(v9 + 536);
    if ( v10 == 2 )
    {
      v11 = *(_DWORD *)(v9 + 544);
    }
    else
    {
      if ( v10 != 1 )
      {
LABEL_17:
        result = 0;
        goto LABEL_10;
      }
      v11 = *(_DWORD *)(v9 + 544);
      if ( v11 == 4 )
        goto LABEL_28;
    }
    v12 = *(const char **)(v9 + 540);
    while ( 1 )
    {
      std::string::append((std::string *)&v18, v12, v11);
      if ( *(_DWORD *)(v1 + 12) )
        break;
      v9 = std::__throw_bad_function_call();
LABEL_28:
      v15 = *(const char **)(v9 + 540);
      if ( !memcmp(*(const void **)(v9 + 540), "null", 4u) )
        goto LABEL_17;
      v12 = v15;
      v11 = 4;
    }
    (*(void (__cdecl **)(int, int *))(v1 + 16))(v1 + 4, &v18);
    result = 0;
  }
LABEL_10:
  v7 = v18 - 12;
  if ( (_DWORD *)(v18 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v13 = _InterlockedExchangeAdd((volatile signed __int32 *)(v18 - 4), 0xFFFFFFFF);
    }
    else
    {
      v16 = *(_DWORD *)(v18 - 4);
      *(_DWORD *)(v18 - 4) = v16 - 1;
      v13 = v16;
    }
    if ( v13 <= 0 )
    {
      v14 = result;
      std::string::_Rep::_M_destroy(v7, &v17);
      result = v14;
    }
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0805ED30) --------------------------------------------------------
int __cdecl sub_805ED30(int a1, int a2)
{
  int result; // eax@1

  result = a2;
  *(_DWORD *)(a1 + 8) = 0;
  if ( *(_DWORD *)(a2 + 8) )
  {
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
    result = (*(int (__cdecl **)(int, int, signed int))(a2 + 8))(a1, a2, 2);
  }
  return result;
}

//----- (0805EDA0) --------------------------------------------------------
int __cdecl sub_805EDA0(int a1, int a2)
{
  int result; // eax@1

  result = a2;
  *(_DWORD *)(a1 + 8) = 0;
  if ( *(_DWORD *)(a2 + 8) )
  {
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
    result = (*(int (__cdecl **)(int, int, signed int))(a2 + 8))(a1, a2, 2);
  }
  return result;
}

//----- (0805EE10) --------------------------------------------------------
int __cdecl sub_805EE10(int a1, int a2, signed int a3)
{
  int v3; // ebx@5
  void (__cdecl *v4)(_DWORD, _DWORD, _DWORD); // eax@6
  int v6; // esi@9
  int v7; // ebx@9

  if ( a3 == 1 )
  {
    *(_DWORD *)a1 = *(_DWORD *)a2;
    return 0;
  }
  if ( a3 <= 1 )
  {
    if ( !a3 )
    {
      *(_DWORD *)a1 = &off_80B9B08;
      return 0;
    }
    return 0;
  }
  if ( a3 == 2 )
  {
    v6 = *(_DWORD *)a2;
    v7 = operator new(0x14u);
    *(_DWORD *)v7 = *(_DWORD *)v6;
    sub_805EDA0(v7 + 4, v6 + 4);
    *(_DWORD *)a1 = v7;
    return 0;
  }
  if ( a3 != 3 )
    return 0;
  v3 = *(_DWORD *)a1;
  if ( !*(_DWORD *)a1 )
    return 0;
  v4 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(v3 + 12);
  if ( v4 )
    v4(v3 + 4, v3 + 4, 3);
  operator delete((void *)v3);
  return 0;
}
// 80B9B08: using guessed type void *off_80B9B08;

//----- (0805EF00) --------------------------------------------------------
void __cdecl sub_805EF00(int a1, void *a2)
{
  void *v2; // ebx@1
  void *v3; // esi@4
  void (__cdecl *v4)(_DWORD, _DWORD, _DWORD); // eax@4
  int v5; // eax@6
  signed __int32 v6; // ecx@10
  char v7; // [sp+1Fh] [bp-1Dh]@12

  v2 = a2;
  if ( a2 )
  {
    while ( 1 )
    {
      sub_805EF00(a1, *((void **)v2 + 3));
      v3 = (void *)*((_DWORD *)v2 + 2);
      v4 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)v2 + 8);
      if ( v4 )
        v4((char *)v2 + 24, (char *)v2 + 24, 3);
      v5 = *((_DWORD *)v2 + 4);
      if ( (_DWORD *)(v5 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v6 = _InterlockedExchangeAdd((volatile signed __int32 *)(v5 - 4), 0xFFFFFFFF);
        }
        else
        {
          v6 = *(_DWORD *)(v5 - 4);
          *(_DWORD *)(v5 - 4) = v6 - 1;
        }
        if ( v6 <= 0 )
          std::string::_Rep::_M_destroy(v5 - 12, &v7);
      }
      operator delete(v2);
      if ( !v3 )
        break;
      v2 = v3;
    }
  }
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0805EFB0) --------------------------------------------------------
int __userpurge sub_805EFB0@<eax>(int a1, int a2, const void **a3)
{
  int v3; // ebx@1
  int v4; // eax@3
  char v5; // cl@3
  const void *v6; // edi@5
  size_t v7; // esi@5
  size_t v8; // ebp@5
  int v9; // eax@7
  size_t v10; // edx@12
  int v11; // ecx@12
  int v12; // eax@13
  int result; // eax@17
  size_t v14; // [sp+14h] [bp-28h]@2
  const void *v15; // [sp+18h] [bp-24h]@2
  int v16; // [sp+1Ch] [bp-20h]@13

  v3 = *(_DWORD *)(a2 + 8);
  if ( !v3 )
  {
    v3 = a2 + 4;
    goto LABEL_19;
  }
  v15 = *a3;
  v14 = *((_DWORD *)*a3 - 3);
  while ( 1 )
  {
    v6 = *(const void **)(v3 + 16);
    v7 = *((_DWORD *)v6 - 3);
    v8 = v14;
    if ( v14 > v7 )
      v8 = *((_DWORD *)v6 - 3);
    v9 = memcmp(v15, v6, v8);
    if ( !v9 )
      v9 = v14 - v7;
    if ( v9 >= 0 )
      break;
    v4 = *(_DWORD *)(v3 + 8);
    v5 = 1;
    if ( !v4 )
      goto LABEL_11;
LABEL_4:
    v3 = v4;
  }
  v4 = *(_DWORD *)(v3 + 12);
  v5 = 0;
  if ( v4 )
    goto LABEL_4;
LABEL_11:
  if ( !v5 )
  {
    v10 = v8;
    v11 = v3;
    goto LABEL_13;
  }
LABEL_19:
  if ( *(_DWORD *)(a2 + 12) == v3 )
  {
    *(_DWORD *)a1 = 0;
    *(_DWORD *)(a1 + 4) = v3;
LABEL_17:
    result = a1;
  }
  else
  {
    v11 = std::_Rb_tree_decrement(v3);
    v15 = *a3;
    v14 = *((_DWORD *)*a3 - 3);
    v6 = *(const void **)(v11 + 16);
    v7 = *((_DWORD *)v6 - 3);
    v10 = v14;
    if ( v14 > v7 )
      v10 = *((_DWORD *)v6 - 3);
LABEL_13:
    v16 = v11;
    v12 = memcmp(v6, v15, v10);
    if ( !v12 )
      v12 = v7 - v14;
    if ( v12 >= 0 )
    {
      *(_DWORD *)a1 = v16;
      *(_DWORD *)(a1 + 4) = 0;
      goto LABEL_17;
    }
    *(_DWORD *)a1 = 0;
    *(_DWORD *)(a1 + 4) = v3;
    result = a1;
  }
  return result;
}
// 804C820: using guessed type int __cdecl std::_Rb_tree_decrement(_DWORD);

//----- (0805F0F0) --------------------------------------------------------
int __userpurge sub_805F0F0@<eax>(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // ebx@1
  int v6; // eax@2
  const void *v7; // esi@4
  const void *v8; // edx@4
  size_t v9; // ecx@4
  int v10; // eax@7
  void (__cdecl *v11)(_DWORD, _DWORD, _DWORD); // eax@10
  int v12; // eax@12
  int v14; // eax@17
  int v15; // edx@17
  const void *v16; // eax@17
  size_t v17; // ecx@17
  size_t v18; // edi@17
  int v19; // eax@18
  int v20; // edx@18
  const void *v21; // eax@23
  const void *v22; // ecx@23
  size_t v23; // esi@23
  int v24; // ST30_4@25
  int v25; // eax@25
  signed int v26; // eax@28
  int v27; // eax@30
  int v28; // ecx@30
  const void *v29; // eax@30
  size_t v30; // edi@30
  size_t v31; // edx@30
  int v32; // eax@32
  const void *v33; // eax@45
  const void *v34; // ecx@45
  size_t v35; // edi@45
  size_t v36; // esi@45
  int v37; // ST30_4@46
  int v38; // eax@46
  signed __int32 v39; // ecx@54
  int v40; // [sp+18h] [bp-50h]@5
  const void **v41; // [sp+1Ch] [bp-4Ch]@3
  size_t n; // [sp+20h] [bp-48h]@5
  const void *s1; // [sp+24h] [bp-44h]@5
  int v44; // [sp+28h] [bp-40h]@3
  size_t v45; // [sp+2Ch] [bp-3Ch]@4
  int v46; // [sp+2Ch] [bp-3Ch]@18
  int v47; // [sp+30h] [bp-38h]@3
  size_t v48; // [sp+34h] [bp-34h]@4
  size_t v49; // [sp+34h] [bp-34h]@45
  int v50; // [sp+38h] [bp-30h]@41
  int v51; // [sp+3Ch] [bp-2Ch]@42
  char v52; // [sp+4Fh] [bp-19h]@56

  v5 = operator new(0x28u);
  if ( v5 )
  {
    memset((void *)v5, 0, 0x10u);
    v6 = *(_DWORD *)a5;
    *(_DWORD *)(v5 + 16) = **(_DWORD **)a5;
    *(_DWORD *)v6 = &unk_80CF83C;
    *(_DWORD *)(v5 + 20) = 0;
    *(_DWORD *)(v5 + 32) = 0;
  }
  v41 = (const void **)(v5 + 16);
  v47 = a3;
  v44 = a2 + 4;
  if ( a2 + 4 != a3 )
  {
    v7 = *(const void **)(v5 + 16);
    v48 = *((_DWORD *)v7 - 3);
    v8 = *(const void **)(a3 + 16);
    v45 = *((_DWORD *)v8 - 3);
    v9 = v45;
    if ( v45 > v48 )
      v9 = *((_DWORD *)v7 - 3);
    n = v9;
    s1 = *(const void **)(a3 + 16);
    v40 = memcmp(v7, v8, v9);
    if ( v40 )
    {
      if ( v40 >= 0 )
      {
LABEL_7:
        v10 = memcmp(s1, v7, n);
        if ( !v10 )
          v10 = v45 - v48;
        if ( v10 >= 0 )
          goto LABEL_10;
        v20 = *(_DWORD *)(a2 + 16);
        if ( v20 != a3 )
        {
          v27 = std::_Rb_tree_increment(a3);
          v28 = v27;
          v29 = *(const void **)(v27 + 16);
          v30 = *((_DWORD *)v29 - 3);
          v31 = v30;
          if ( v30 > v48 )
            v31 = v48;
          v47 = v28;
          v32 = memcmp(v7, v29, v31);
          if ( !v32 )
            v32 = v48 - v30;
          if ( v32 < 0 )
          {
            if ( !*(_DWORD *)(a3 + 12) )
            {
              v25 = v40;
              v20 = a3;
              goto LABEL_26;
            }
            goto LABEL_36;
          }
          goto LABEL_41;
        }
        goto LABEL_22;
      }
    }
    else if ( ((v48 - v45) & 0x80000000) == 0 )
    {
      goto LABEL_7;
    }
    if ( *(_DWORD *)(a2 + 12) == a3 )
    {
      v47 = a3;
    }
    else
    {
      v14 = std::_Rb_tree_decrement(a3);
      v15 = v14;
      v16 = *(const void **)(v14 + 16);
      v17 = *((_DWORD *)v16 - 3);
      v18 = v17;
      if ( v17 > v48 )
        v17 = v48;
      v46 = v15;
      v19 = memcmp(v16, v7, v17);
      v20 = v46;
      if ( !v19 )
        v19 = v18 - v48;
      if ( v19 >= 0 )
      {
LABEL_41:
        sub_805EFB0((int)&v50, a2, v41);
        goto LABEL_42;
      }
      if ( !*(_DWORD *)(v46 + 12) )
      {
LABEL_22:
        if ( v44 == v20 )
        {
LABEL_38:
          v26 = 1;
LABEL_39:
          std::_Rb_tree_insert_and_rebalance(v26, v5, v20, v44);
          ++*(_DWORD *)(a2 + 20);
          *(_DWORD *)a1 = v5;
          return a1;
        }
        v21 = *(const void **)(v5 + 16);
        v48 = *((_DWORD *)v21 - 3);
        v22 = *(const void **)(v20 + 16);
        v45 = *((_DWORD *)v22 - 3);
        v23 = v45;
        if ( v45 > v48 )
          v23 = *((_DWORD *)v21 - 3);
        v24 = v20;
        v25 = memcmp(v21, v22, v23);
        v20 = v24;
LABEL_26:
        if ( !v25 )
          v25 = v48 - v45;
        v26 = (unsigned int)v25 >> 31;
        goto LABEL_39;
      }
    }
LABEL_36:
    v20 = v47;
    goto LABEL_37;
  }
  if ( *(_DWORD *)(a2 + 20) )
  {
    v33 = *(const void **)(*(_DWORD *)(a2 + 16) + 16);
    v49 = *((_DWORD *)v33 - 3);
    v34 = *(const void **)(v5 + 16);
    v35 = *((_DWORD *)v34 - 3);
    v36 = v35;
    if ( v35 > v49 )
      v36 = *((_DWORD *)v33 - 3);
    v37 = *(_DWORD *)(a2 + 16);
    v38 = memcmp(v33, v34, v36);
    v20 = v37;
    if ( !v38 )
      v38 = v49 - v35;
    if ( v38 < 0 )
      goto LABEL_22;
  }
  sub_805EFB0((int)&v50, a2, v41);
LABEL_42:
  v47 = v50;
  v20 = v51;
  if ( v51 )
  {
LABEL_37:
    if ( v47 )
      goto LABEL_38;
    goto LABEL_22;
  }
LABEL_10:
  v11 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(v5 + 32);
  if ( v11 )
    v11(v5 + 24, v5 + 24, 3);
  v12 = *(_DWORD *)(v5 + 16);
  if ( (_DWORD *)(v12 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v12 - 4), 0xFFFFFFFF);
    }
    else
    {
      v39 = *(_DWORD *)(v12 - 4);
      *(_DWORD *)(v12 - 4) = v39 - 1;
    }
    if ( v39 <= 0 )
      std::string::_Rep::_M_destroy(v12 - 12, &v52);
  }
  operator delete((void *)v5);
  *(_DWORD *)a1 = v47;
  return a1;
}
// 804C820: using guessed type int __cdecl std::_Rb_tree_decrement(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CE00: using guessed type int __cdecl std::_Rb_tree_insert_and_rebalance(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D130: using guessed type int __cdecl std::_Rb_tree_increment(_DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0805F4A0) --------------------------------------------------------
int __cdecl sub_805F4A0(int a1, int a2, int a3)
{
  int v3; // ebx@1
  int v4; // ebx@3
  size_t v5; // esi@4
  const void *v6; // eax@6
  size_t v7; // edi@6
  size_t v8; // ecx@6
  int v9; // eax@8
  const void *v10; // eax@13
  size_t v11; // ebx@13
  size_t v12; // edx@13
  int v13; // eax@14
  int v14; // ecx@17
  int *v15; // eax@18
  int v16; // edx@18
  int (__cdecl *v17)(int, int, signed int); // ST28_4@18
  signed int (__cdecl *v18)(int); // ebx@18
  int v19; // edi@18
  int v20; // eax@18
  int v21; // edx@20
  signed __int32 v23; // eax@32
  signed __int32 v24; // ecx@35
  int v25; // [sp+24h] [bp-74h]@4
  const void *s2; // [sp+28h] [bp-70h]@4
  int v27; // [sp+2Ch] [bp-6Ch]@30
  char v28; // [sp+32h] [bp-66h]@3
  const void *v29; // [sp+34h] [bp-64h]@3
  int v30; // [sp+38h] [bp-60h]@1
  int (__cdecl *v31)(int, int, signed int); // [sp+40h] [bp-58h]@1
  signed int (__cdecl *v32)(int); // [sp+44h] [bp-54h]@1
  int *v33; // [sp+48h] [bp-50h]@18
  int v34; // [sp+4Ch] [bp-4Ch]@18
  int v35; // [sp+50h] [bp-48h]@18
  signed int (__cdecl *v36)(int); // [sp+54h] [bp-44h]@18
  int v37; // [sp+58h] [bp-40h]@1
  char v38; // [sp+5Ch] [bp-3Ch]@1
  void (__cdecl *v39)(char *, char *, signed int); // [sp+64h] [bp-34h]@25
  int v40; // [sp+6Ch] [bp-2Ch]@1
  int *v41; // [sp+70h] [bp-28h]@2
  int v42; // [sp+74h] [bp-24h]@18
  int (__cdecl *v43)(int, int, signed int); // [sp+78h] [bp-20h]@1
  signed int (__cdecl *v44)(int); // [sp+7Ch] [bp-1Ch]@2

  v37 = a1;
  sub_805EDA0((int)&v38, a3);
  v3 = operator new(0x14u);
  *(_DWORD *)v3 = a1;
  sub_805EDA0(v3 + 4, (int)&v38);
  v30 = v3;
  v32 = sub_805EB40;
  v31 = sub_805EE10;
  v40 = 1;
  v43 = 0;
  if ( sub_805EE10 )
  {
    v44 = sub_805EB40;
    v43 = sub_805EE10;
    sub_805EE10((int)&v41, (int)&v30, 2);
  }
  std::string::string(&v29, a2, &v28);
  v4 = *(_DWORD *)(a1 + 24);
  if ( v4 )
  {
    s2 = v29;
    v5 = *((_DWORD *)v29 - 3);
    v25 = a1 + 20;
    do
    {
      while ( 1 )
      {
        v6 = *(const void **)(v4 + 16);
        v7 = *((_DWORD *)v6 - 3);
        v8 = v5;
        if ( v5 > v7 )
          v8 = *((_DWORD *)v6 - 3);
        v9 = memcmp(v6, s2, v8);
        if ( !v9 )
          v9 = v7 - v5;
        if ( v9 < 0 )
          break;
        v25 = v4;
        v4 = *(_DWORD *)(v4 + 8);
        if ( !v4 )
          goto LABEL_12;
      }
      v4 = *(_DWORD *)(v4 + 12);
    }
    while ( v4 );
LABEL_12:
    if ( a1 + 20 != v25 )
    {
      v10 = *(const void **)(v25 + 16);
      v11 = *((_DWORD *)v10 - 3);
      v12 = v5;
      if ( v5 > v11 )
        v12 = *((_DWORD *)v10 - 3);
      v13 = memcmp(s2, v10, v12);
      if ( !v13 )
        v13 = v5 - v11;
      if ( v13 >= 0 )
      {
        v14 = v25;
        goto LABEL_18;
      }
    }
  }
  else
  {
    v25 = a1 + 20;
  }
  v33 = (int *)&v29;
  sub_805F0F0((int)&v27, a1 + 16, v25, (int)&dword_80B9AC0, (int)&v33);
  v14 = v27;
LABEL_18:
  *(_DWORD *)(v14 + 20) = v40;
  v15 = v41;
  v16 = v42;
  v41 = v33;
  v42 = v34;
  v33 = v15;
  v34 = v16;
  v17 = v43;
  v43 = 0;
  v18 = v44;
  v44 = v36;
  v19 = *(_DWORD *)(v14 + 28);
  v33 = *(int **)(v14 + 24);
  v34 = v19;
  *(_DWORD *)(v14 + 24) = v15;
  *(_DWORD *)(v14 + 28) = v16;
  v35 = *(_DWORD *)(v14 + 32);
  v20 = v35;
  *(_DWORD *)(v14 + 32) = v17;
  v36 = *(signed int (__cdecl **)(int))(v14 + 36);
  *(_DWORD *)(v14 + 36) = v18;
  if ( v20 )
    ((void (__cdecl *)(int **, int **, signed int))v20)(&v33, &v33, 3);
  v21 = (int)((char *)v29 - 12);
  if ( (_DWORD *)((char *)v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v23 = _InterlockedExchangeAdd((volatile signed __int32 *)v29 - 1, 0xFFFFFFFF);
    }
    else
    {
      v24 = *((_DWORD *)v29 - 1);
      *((_DWORD *)v29 - 1) = v24 - 1;
      v23 = v24;
    }
    if ( v23 <= 0 )
      std::string::_Rep::_M_destroy(v21, &v33);
  }
  if ( v43 )
    v43((int)&v41, (int)&v41, 3);
  if ( v31 )
    v31((int)&v30, (int)&v30, 3);
  if ( v39 )
    v39(&v38, &v38, 3);
  return a1;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80B9AC0: using guessed type int dword_80B9AC0;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0805F840) --------------------------------------------------------
int __cdecl sub_805F840(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // ebx@1
  int v5; // ebx@3
  size_t v6; // esi@4
  const void *v7; // eax@6
  size_t v8; // edi@6
  size_t v9; // ecx@6
  int v10; // eax@8
  const void *v11; // eax@13
  size_t v12; // ebx@13
  size_t v13; // edx@13
  int v14; // eax@14
  int v15; // ecx@17
  int *v16; // eax@18
  int v17; // edx@18
  int (__cdecl *v18)(int, int, signed int); // ST28_4@18
  signed int (__cdecl *v19)(int); // ebx@18
  int v20; // edi@18
  int v21; // eax@18
  int v22; // edx@20
  signed __int32 v24; // ecx@34
  int v25; // [sp+24h] [bp-84h]@4
  const void *s2; // [sp+28h] [bp-80h]@4
  int v27; // [sp+2Ch] [bp-7Ch]@32
  char v28; // [sp+32h] [bp-76h]@3
  const void *v29; // [sp+34h] [bp-74h]@3
  int v30; // [sp+38h] [bp-70h]@1
  int (__cdecl *v31)(void **, void **, signed int); // [sp+40h] [bp-68h]@1
  int (__cdecl *v32)(int, const char **); // [sp+44h] [bp-64h]@1
  int v33; // [sp+48h] [bp-60h]@1
  int (__cdecl *v34)(int, int, signed int); // [sp+50h] [bp-58h]@1
  signed int (__cdecl *v35)(int); // [sp+54h] [bp-54h]@1
  int *v36; // [sp+58h] [bp-50h]@18
  int v37; // [sp+5Ch] [bp-4Ch]@18
  int v38; // [sp+60h] [bp-48h]@18
  signed int (__cdecl *v39)(int); // [sp+64h] [bp-44h]@18
  int v40; // [sp+68h] [bp-40h]@1
  char v41; // [sp+6Ch] [bp-3Ch]@1
  void (__cdecl *v42)(char *, char *, signed int); // [sp+74h] [bp-34h]@25
  int v43; // [sp+7Ch] [bp-2Ch]@1
  int *v44; // [sp+80h] [bp-28h]@2
  int v45; // [sp+84h] [bp-24h]@18
  int (__cdecl *v46)(int, int, signed int); // [sp+88h] [bp-20h]@1
  signed int (__cdecl *v47)(int); // [sp+8Ch] [bp-1Ch]@2

  v3 = operator new(4u);
  *(_DWORD *)v3 = a3;
  v30 = v3;
  v32 = sub_805E890;
  v31 = sub_805EA00;
  v40 = a1;
  sub_805EDA0((int)&v41, (int)&v30);
  v34 = 0;
  v4 = operator new(0x14u);
  *(_DWORD *)v4 = v40;
  sub_805EDA0(v4 + 4, (int)&v41);
  v33 = v4;
  v35 = sub_805EB40;
  v34 = sub_805EE10;
  v43 = 1;
  v46 = 0;
  if ( sub_805EE10 )
  {
    v47 = sub_805EB40;
    v46 = sub_805EE10;
    sub_805EE10((int)&v44, (int)&v33, 2);
  }
  std::string::string(&v29, a2, &v28);
  v5 = *(_DWORD *)(a1 + 24);
  if ( v5 )
  {
    s2 = v29;
    v6 = *((_DWORD *)v29 - 3);
    v25 = a1 + 20;
    do
    {
      while ( 1 )
      {
        v7 = *(const void **)(v5 + 16);
        v8 = *((_DWORD *)v7 - 3);
        v9 = v6;
        if ( v6 > v8 )
          v9 = *((_DWORD *)v7 - 3);
        v10 = memcmp(v7, s2, v9);
        if ( !v10 )
          v10 = v8 - v6;
        if ( v10 < 0 )
          break;
        v25 = v5;
        v5 = *(_DWORD *)(v5 + 8);
        if ( !v5 )
          goto LABEL_12;
      }
      v5 = *(_DWORD *)(v5 + 12);
    }
    while ( v5 );
LABEL_12:
    if ( a1 + 20 != v25 )
    {
      v11 = *(const void **)(v25 + 16);
      v12 = *((_DWORD *)v11 - 3);
      v13 = v6;
      if ( v6 > v12 )
        v13 = *((_DWORD *)v11 - 3);
      v14 = memcmp(s2, v11, v13);
      if ( !v14 )
        v14 = v6 - v12;
      if ( v14 >= 0 )
      {
        v15 = v25;
        goto LABEL_18;
      }
    }
  }
  else
  {
    v25 = a1 + 20;
  }
  v36 = (int *)&v29;
  sub_805F0F0((int)&v27, a1 + 16, v25, (int)&dword_80B9AC0, (int)&v36);
  v15 = v27;
LABEL_18:
  *(_DWORD *)(v15 + 20) = v43;
  v16 = v44;
  v17 = v45;
  v44 = v36;
  v45 = v37;
  v36 = v16;
  v37 = v17;
  v18 = v46;
  v46 = 0;
  v19 = v47;
  v47 = v39;
  v20 = *(_DWORD *)(v15 + 28);
  v36 = *(int **)(v15 + 24);
  v37 = v20;
  *(_DWORD *)(v15 + 24) = v16;
  *(_DWORD *)(v15 + 28) = v17;
  v38 = *(_DWORD *)(v15 + 32);
  v21 = v38;
  *(_DWORD *)(v15 + 32) = v18;
  v39 = *(signed int (__cdecl **)(int))(v15 + 36);
  *(_DWORD *)(v15 + 36) = v19;
  if ( v21 )
    ((void (__cdecl *)(int **, int **, signed int))v21)(&v36, &v36, 3);
  v22 = (int)((char *)v29 - 12);
  if ( (_DWORD *)((char *)v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v24 = _InterlockedExchangeAdd((volatile signed __int32 *)v29 - 1, 0xFFFFFFFF);
    }
    else
    {
      v24 = *((_DWORD *)v29 - 1);
      *((_DWORD *)v29 - 1) = v24 - 1;
    }
    if ( v24 <= 0 )
      std::string::_Rep::_M_destroy(v22, &v36);
  }
  if ( v46 )
    v46((int)&v44, (int)&v44, 3);
  if ( v34 )
    v34((int)&v33, (int)&v33, 3);
  if ( v42 )
    v42(&v41, &v41, 3);
  if ( v31 )
    v31((void **)&v30, (void **)&v30, 3);
  return a1;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80B9AC0: using guessed type int dword_80B9AC0;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0805FC80) --------------------------------------------------------
int __cdecl sub_805FC80(int a1)
{
  return (*(int (__cdecl **)(_DWORD))(****(_DWORD ****)a1 + 8))(***(_DWORD ***)a1);
}

//----- (0805FCA0) --------------------------------------------------------
int __cdecl sub_805FCA0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BA24C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BA24C: using guessed type void *off_80BA24C;

//----- (0805FD40) --------------------------------------------------------
int __cdecl sub_805FD40(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BA244;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BA244: using guessed type void *off_80BA244;

//----- (0805FDE0) --------------------------------------------------------
int __cdecl sub_805FDE0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BA234;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BA234: using guessed type void *off_80BA234;

//----- (0805FE80) --------------------------------------------------------
int __cdecl sub_805FE80(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BA23C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BA23C: using guessed type void *off_80BA23C;

//----- (0805FF20) --------------------------------------------------------
int __cdecl sub_805FF20(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BA22C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BA22C: using guessed type void *off_80BA22C;

//----- (0805FFC0) --------------------------------------------------------
int __cdecl sub_805FFC0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BA224;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BA224: using guessed type void *off_80BA224;

//----- (08060060) --------------------------------------------------------
int __cdecl sub_8060060(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BA21C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BA21C: using guessed type void *off_80BA21C;

//----- (08060100) --------------------------------------------------------
int __userpurge sub_8060100@<eax>(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // edx@1
  int v5; // edi@6
  int v6; // esi@12
  int v8; // eax@20
  int v9; // [sp+0h] [bp-18h]@6
  int v10; // [sp+4h] [bp-14h]@1

  v10 = *(_DWORD *)(a2 + 360);
  v3 = *(_DWORD *)(a2 + 356);
  v4 = (v10 - v3) >> 2;
  if ( (v10 - v3) >> 4 > 0 )
  {
    if ( a3 == *(_DWORD *)(*(_DWORD *)v3 + 8) )
    {
      v6 = *(_DWORD *)(a2 + 356);
    }
    else if ( a3 == *(_DWORD *)(*(_DWORD *)(v3 + 4) + 8) )
    {
      v6 = v3 + 4;
    }
    else if ( a3 == *(_DWORD *)(*(_DWORD *)(v3 + 8) + 8) )
    {
      v6 = v3 + 8;
    }
    else if ( a3 == *(_DWORD *)(*(_DWORD *)(v3 + 12) + 8) )
    {
      v6 = v3 + 12;
    }
    else
    {
      v5 = *(_DWORD *)(a2 + 356);
      v9 = (v10 - v3) >> 4;
      while ( 1 )
      {
        v6 = v5 + 16;
        --v9;
        if ( !v9 )
        {
          v4 = (v10 - (v5 + 16)) >> 2;
          goto LABEL_14;
        }
        if ( a3 == *(_DWORD *)(*(_DWORD *)v6 + 8) )
          goto LABEL_19;
        if ( a3 == *(_DWORD *)(*(_DWORD *)(v5 + 20) + 8) )
        {
          v6 = v5 + 20;
          goto LABEL_19;
        }
        if ( a3 == *(_DWORD *)(*(_DWORD *)(v5 + 24) + 8) )
        {
          v6 = v5 + 24;
          goto LABEL_19;
        }
        if ( a3 == *(_DWORD *)(*(_DWORD *)(v5 + 28) + 8) )
          break;
        v5 += 16;
      }
      v6 = v5 + 28;
    }
    goto LABEL_19;
  }
  v6 = *(_DWORD *)(a2 + 356);
LABEL_14:
  if ( v4 == 2 )
    goto LABEL_28;
  if ( v4 == 3 )
  {
    if ( a3 == *(_DWORD *)(*(_DWORD *)v6 + 8) )
      goto LABEL_19;
    v6 += 4;
LABEL_28:
    if ( a3 == *(_DWORD *)(*(_DWORD *)v6 + 8) )
      goto LABEL_19;
    v6 += 4;
    goto LABEL_30;
  }
  if ( v4 != 1 )
  {
LABEL_17:
    *(_DWORD *)a1 = 0;
    return a1;
  }
LABEL_30:
  if ( a3 != *(_DWORD *)(*(_DWORD *)v6 + 8) )
    goto LABEL_17;
LABEL_19:
  if ( v10 == v6 )
    goto LABEL_17;
  v8 = *(_DWORD *)v6;
  *(_DWORD *)a1 = *(_DWORD *)v6;
  if ( v8 )
    _InterlockedIncrement((volatile signed __int32 *)(v8 + 4));
  return a1;
}

//----- (08060290) --------------------------------------------------------
int __cdecl start_trace(int a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  int v5; // eax@1
  int v6; // esi@1
  int v8; // [sp+3Ch] [bp-20h]@1
  int v9; // [sp+40h] [bp-1Ch]@1
  int (__cdecl *v10)(void **, void **, signed int); // [sp+48h] [bp-14h]@1
  int (__cdecl *v11)(int **, int, int); // [sp+4Ch] [bp-10h]@1

  v4 = operator new(4u);
  *(_DWORD *)v4 = a1;
  v9 = v4;
  v11 = sub_8061930;
  v10 = sub_805FDE0;
  v8 = *(_DWORD *)a3;
  LOBYTE(v5) = sub_80A1870(a1 + 368, a2, a4, "/usr/bin/traceroute", &v8, 1, (int)&v9, 1, 0);
  v6 = v5;
  if ( v10 )
    v10((void **)&v9, (void **)&v9, 3);
  return v6;
}

//----- (08060390) --------------------------------------------------------
void __cdecl __noreturn sub_8060390(int a1)
{
  if ( *(_DWORD *)(a1 + 344) > 0 )
    exit(0);
  exit(1);
}

//----- (080603C0) --------------------------------------------------------
int __cdecl sub_80603C0(int a1, std::string *a2, std::string *a3)
{
  int result; // eax@1

  sub_80B2410(a1);
  sub_808DD90((std::string *)(a1 + 336), a2, a3);
  *(_DWORD *)(a1 + 356) = 0;
  *(_DWORD *)(a1 + 360) = 0;
  *(_DWORD *)(a1 + 364) = 0;
  sub_80A0F20(a1 + 368);
  *(_BYTE *)(a1 + 392) = 1;
  memset((void *)(a1 + 396), 0, 0x18u);
  result = std::condition_variable::condition_variable((std::condition_variable *)(a1 + 420));
  *(_DWORD *)(a1 + 468) = 0;
  *(_DWORD *)(a1 + 472) = 0;
  *(_DWORD *)(a1 + 476) = 0;
  *(_DWORD *)(a1 + 480) = 0;
  *(_DWORD *)(a1 + 484) = 0;
  *(_DWORD *)(a1 + 488) = 0;
  return result;
}

//----- (080604C0) --------------------------------------------------------
pthread_mutex_t *__cdecl sub_80604C0(int a1, int a2)
{
  _DWORD *v2; // ebx@1
  pthread_mutex_t *v3; // eax@1
  int v4; // eax@3
  int v5; // edx@4
  int v6; // eax@4
  int v7; // ecx@6
  pthread_mutex_t *result; // eax@10
  int v9; // ebx@17
  int v10; // [sp+4h] [bp-28h]@0
  pthread_mutex_t *v11; // [sp+18h] [bp-14h]@1
  char v12; // [sp+1Ch] [bp-10h]@1

  v2 = *(_DWORD **)a1;
  v3 = (pthread_mutex_t *)(**(_DWORD **)a1 + 396);
  v11 = v3;
  v12 = 0;
  if ( !v3 )
  {
    v4 = std::__throw_system_error(1);
    goto LABEL_17;
  }
  if ( &_pthread_key_create )
  {
    v4 = pthread_mutex_lock(v3);
    if ( v4 )
    {
LABEL_17:
      v9 = std::__throw_system_error(v4);
      if ( v12 )
        sub_80584A0((int)&v11, v10);
      Unwind_Resume(v9);
    }
  }
  v12 = 1;
  v5 = *v2;
  v6 = *(_DWORD *)(*v2 + 472);
  if ( v6 == *(_DWORD *)(*v2 + 476) )
  {
    sub_8068790(v5 + 468, a2);
  }
  else
  {
    if ( v6 )
    {
      v7 = *(_DWORD *)a2;
      *(_DWORD *)v6 = *(_DWORD *)a2;
      if ( v7 )
        _InterlockedIncrement((volatile signed __int32 *)(v7 + 4));
      v6 = *(_DWORD *)(v5 + 472);
    }
    *(_DWORD *)(v5 + 472) = v6 + 4;
  }
  result = (pthread_mutex_t *)std::condition_variable::notify_all((std::condition_variable *)(*v2 + 420));
  if ( v12 )
  {
    result = v11;
    if ( v11 )
    {
      if ( &_pthread_key_create )
        result = (pthread_mutex_t *)pthread_mutex_unlock(v11);
    }
  }
  return result;
}
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);

//----- (08060740) --------------------------------------------------------
int __cdecl start_tunel(int a1, int a2, int a3, int a4)
{
  unsigned int v4; // ebp@0
  int v5; // ST2C_4@2
  char *v6; // ebx@2
  int v7; // eax@2
  int v8; // eax@2
  int v9; // edx@2
  int v10; // ecx@3
  int v11; // edx@5
  int v12; // edx@6
  int v13; // eax@8
  int v14; // eax@8
  int v15; // edi@8
  int v16; // edx@10
  int v18; // edx@13
  int v19; // edx@15
  int v20; // eax@16
  bool v21; // zf@16
  signed __int32 v22; // eax@23
  signed __int32 v23; // esi@27
  signed __int32 v24; // ecx@31
  signed __int32 v25; // esi@35
  signed __int32 v26; // ecx@38
  char v27; // [sp+3Fh] [bp-169h]@14
  int v28; // [sp+40h] [bp-168h]@2
  int v29; // [sp+44h] [bp-164h]@12
  int v30; // [sp+48h] [bp-160h]@4
  int (__cdecl *v31)(void **, void **, signed int); // [sp+50h] [bp-158h]@8
  int (__cdecl *v32)(int **, int, int); // [sp+54h] [bp-154h]@8
  int src; // [sp+58h] [bp-150h]@4
  int v34; // [sp+5Ch] [bp-14Ch]@8
  int v35; // [sp+60h] [bp-148h]@8
  int v36; // [sp+64h] [bp-144h]@8
  int v37; // [sp+68h] [bp-140h]@8
  int v38; // [sp+6Ch] [bp-13Ch]@8
  int v39; // [sp+70h] [bp-138h]@8
  char *v40; // [sp+74h] [bp-134h]@8
  int v41; // [sp+78h] [bp-130h]@8
  int v42; // [sp+7Ch] [bp-12Ch]@8
  int v43; // [sp+80h] [bp-128h]@8
  int v44; // [sp+84h] [bp-124h]@8
  char *v45; // [sp+88h] [bp-120h]@8
  char s; // [sp+8Ch] [bp-11Ch]@1
  char v47[4]; // [sp+DCh] [bp-CCh]@2
  int v48; // [sp+E0h] [bp-C8h]@2
  int v49; // [sp+E4h] [bp-C4h]@2
  int v50; // [sp+E8h] [bp-C0h]@2
  int v51; // [sp+ECh] [bp-BCh]@2
  int v52; // [sp+F0h] [bp-B8h]@2
  int v53; // [sp+F4h] [bp-B4h]@2
  int v54; // [sp+F8h] [bp-B0h]@2
  char v55; // [sp+FCh] [bp-ACh]@2
  int v56; // [sp+100h] [bp-A8h]@2
  int v57; // [sp+104h] [bp-A4h]@2
  int v58; // [sp+108h] [bp-A0h]@2
  int v59; // [sp+178h] [bp-30h]@2
  char v60; // [sp+17Ch] [bp-2Ch]@2
  char v61; // [sp+17Dh] [bp-2Bh]@2
  int v62; // [sp+180h] [bp-28h]@2
  int v63; // [sp+184h] [bp-24h]@2
  int v64; // [sp+188h] [bp-20h]@2
  int v65; // [sp+18Ch] [bp-1Ch]@2

  snprintf(&s, 0x50u, "0.0.0.0:%d:127.0.0.1:%d", a3, dword_80CE648);
  if ( sub_80721E0() )
  {
    v5 = dword_80CE650;
    v6 = v47;
    std::ios_base::ios_base((std::ios_base *)&v58);
    v58 = (int)&unk_80CF5C8;
    v59 = 0;
    v60 = 0;
    v61 = 0;
    v62 = 0;
    v63 = 0;
    v64 = 0;
    v65 = 0;
    *(_DWORD *)v47 = dword_80CF674;
    *(_DWORD *)&v47[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init(&v47[*(_DWORD *)(*(_DWORD *)v47 - 12)], 0);
    *(_DWORD *)v47 = &unk_80CF5DC;
    v58 = (int)&unk_80CF5F0;
    v48 = (int)&unk_80CF7F0;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    v52 = 0;
    v53 = 0;
    v54 = 0;
    std::locale::locale((std::locale *)&v55);
    v48 = (int)&unk_80CF588;
    v56 = 16;
    v57 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v58, &v48);
    v7 = std::__ostream_insert<char,std::char_traits<char>>(v47, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    v8 = std::ostream::operator<<(v7, v5);
    v28 = (int)&unk_80CF83C;
    v9 = *(_DWORD *)(v8 + 24);
    if ( v9 )
    {
      v10 = *(_DWORD *)(v8 + 16);
      if ( v9 <= (unsigned int)v10 )
      {
        src = std::string::_S_construct<char *>((int)v47, v4, &s, *(_DWORD *)(v8 + 20), v10, (int)&v30);
        std::string::swap((std::string *)&v28, (std::string *)&src);
      }
      else
      {
        src = std::string::_S_construct<char *>((int)v47, v4, &s, *(_DWORD *)(v8 + 20), v9, (int)&v30);
        std::string::swap((std::string *)&v28, (std::string *)&src);
      }
      v11 = src - 12;
      if ( (_DWORD *)(src - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v23 = _InterlockedExchangeAdd((volatile signed __int32 *)(src - 4), 0xFFFFFFFF);
        }
        else
        {
          v23 = *(_DWORD *)(src - 4);
          *(_DWORD *)(src - 4) = v23 - 1;
        }
        if ( v23 <= 0 )
          std::string::_Rep::_M_destroy(v11, &v29);
      }
    }
    else
    {
      std::string::assign((std::string *)&v28, (const std::string *)(v8 + 40));
    }
    *(_DWORD *)v47 = &unk_80CF5DC;
    v58 = (int)&unk_80CF5F0;
    v48 = (int)&unk_80CF588;
    v12 = v57 - 12;
    if ( (_DWORD *)(v57 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v57 - 4), 0xFFFFFFFF);
      }
      else
      {
        v25 = *(_DWORD *)(v57 - 4);
        *(_DWORD *)(v57 - 4) = v25 - 1;
      }
      if ( v25 <= 0 )
        std::string::_Rep::_M_destroy(v12, &src);
    }
    v48 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v55);
    *(_DWORD *)v47 = dword_80CF674;
    *(_DWORD *)&v47[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    v58 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v58);
    snprintf(v47, 0x50u, "%s@%s", dword_80CF884, "127.0.0.1");
  }
  else
  {
    v6 = v47;
    std::string::string(&v28, "22", v47);
    sub_8067DC0((int)&v29, (std::string *)&dword_80CF894);
    if ( v29 && (v18 = *(_DWORD *)(v29 + 32)) != 0 )
      std::string::string(&src, *(_DWORD *)(v29 + 28), v18, &v27);
    else
      std::string::string((std::string *)&src, (const std::string *)&dword_80CF8FC);
    snprintf(v47, 0x50u, "%s@%s", dword_80CF884, src);
    v19 = src - 12;
    if ( (_DWORD *)(src - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(src - 4), 0xFFFFFFFF);
      }
      else
      {
        v24 = *(_DWORD *)(src - 4);
        *(_DWORD *)(src - 4) = v24 - 1;
      }
      if ( v24 <= 0 )
        std::string::_Rep::_M_destroy(v19, &v30);
    }
    v20 = v29;
    v21 = v29 == 0;
    if ( v29 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v29 + 4));
      if ( v21 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v20 + 4))(v20);
    }
  }
  v31 = 0;
  v13 = operator new(4u);
  *(_DWORD *)v13 = a1;
  v30 = v13;
  v32 = sub_80616D0;
  v31 = sub_805FD40;
  src = (int)"-y";
  v34 = (int)"-y";
  v35 = (int)"-K";
  v36 = (int)"30";
  v37 = (int)"-N";
  v38 = (int)"-T";
  v39 = (int)"-R";
  v40 = &s;
  v41 = (int)"-p";
  v42 = v28;
  v43 = (int)"-i";
  v44 = g_idrsa_path;
  v45 = v6;
  LOBYTE(v14) = sub_80A1870(a1 + 368, a2, a4, "/usr/bin/ssh", &src, 13, (int)&v30, 1, 5000);
  v15 = v14;
  if ( v31 )
    v31((void **)&v30, (void **)&v30, 3);
  v16 = v28 - 12;
  if ( (_DWORD *)(v28 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v22 = _InterlockedExchangeAdd((volatile signed __int32 *)(v28 - 4), 0xFFFFFFFF);
    }
    else
    {
      v26 = *(_DWORD *)(v28 - 4);
      *(_DWORD *)(v28 - 4) = v26 - 1;
      v22 = v26;
    }
    if ( v22 <= 0 )
      std::string::_Rep::_M_destroy(v16, &src);
  }
  return v15;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF884: using guessed type int dword_80CF884;
// 80CF894: using guessed type int dword_80CF894;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (08060F60) --------------------------------------------------------
char __cdecl sub_8060F60(int a1, int a2)
{
  int v2; // edx@2
  int v3; // edi@2
  int v4; // eax@4
  int v6; // ebx@8
  int v7; // ebp@9
  int v8; // eax@10
  int v9; // eax@15
  unsigned int v10; // ebp@19
  int v11; // edi@19
  int v12; // eax@19
  int v13; // edx@19
  int v14; // ecx@20
  int v15; // edx@22
  int v16; // edx@23
  int v17; // eax@25
  std::ostream *v18; // ebp@25
  int v19; // eax@25
  int v20; // edi@25
  char v21; // al@27
  std::ostream *v22; // eax@28
  int v23; // eax@29
  int v24; // edx@29
  signed __int32 v25; // eax@31
  signed __int32 v26; // ecx@38
  signed __int32 v27; // edi@40
  signed __int32 v28; // edi@44
  int v29; // [sp+Ch] [bp-F0h]@0
  char v30; // [sp+22h] [bp-DAh]@46
  char v31; // [sp+23h] [bp-D9h]@21
  int v32; // [sp+24h] [bp-D8h]@19
  int v33; // [sp+28h] [bp-D4h]@21
  unsigned int v34; // [sp+2Ch] [bp-D0h]@19
  int v35; // [sp+30h] [bp-CCh]@19
  int v36; // [sp+34h] [bp-C8h]@19
  int v37; // [sp+38h] [bp-C4h]@19
  int v38; // [sp+3Ch] [bp-C0h]@19
  int v39; // [sp+40h] [bp-BCh]@19
  int v40; // [sp+44h] [bp-B8h]@19
  int v41; // [sp+48h] [bp-B4h]@19
  char v42; // [sp+4Ch] [bp-B0h]@19
  int v43; // [sp+50h] [bp-ACh]@19
  int v44; // [sp+54h] [bp-A8h]@19
  int v45; // [sp+58h] [bp-A4h]@19
  int v46; // [sp+C8h] [bp-34h]@19
  char v47; // [sp+CCh] [bp-30h]@19
  char v48; // [sp+CDh] [bp-2Fh]@19
  int v49; // [sp+D0h] [bp-2Ch]@19
  int v50; // [sp+D4h] [bp-28h]@19
  int v51; // [sp+D8h] [bp-24h]@19
  int v52; // [sp+DCh] [bp-20h]@19

  if ( log_level > 3 )
    goto LABEL_2;
  std::ios_base::ios_base((std::ios_base *)&v45);
  v45 = (int)&unk_80CF5C8;
  v46 = 0;
  v47 = 0;
  v48 = 0;
  v49 = 0;
  v50 = 0;
  v51 = 0;
  v52 = 0;
  v10 = dword_80CF674;
  v34 = dword_80CF674;
  *(unsigned int *)((char *)&v34 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v34 + *(_DWORD *)(v34 - 12), 0);
  v34 = (unsigned int)&unk_80CF5DC;
  v45 = (int)&unk_80CF5F0;
  v35 = (int)&unk_80CF7F0;
  v36 = 0;
  v37 = 0;
  v38 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  std::locale::locale((std::locale *)&v42);
  v35 = (int)&unk_80CF588;
  v43 = 16;
  v44 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v45, &v35);
  v11 = std::__ostream_insert<char,std::char_traits<char>>(&v34, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v11, "deleting task: ", 15);
  v12 = std::ostream::_M_insert<unsigned long>(v11, a2);
  v32 = (int)&unk_80CF83C;
  v13 = *(_DWORD *)(v12 + 24);
  if ( v13 )
  {
    v14 = *(_DWORD *)(v12 + 16);
    LOBYTE(v29) = 0;
    if ( v13 > (unsigned int)v14 )
    {
      v33 = std::string::_S_construct<char *>(a2, v10, &v31, *(_DWORD *)(v12 + 20), v13, (int)&v31);
      std::string::swap((std::string *)&v32, (std::string *)&v33);
    }
    else
    {
      v33 = std::string::_S_construct<char *>(a2, v10, &v31, *(_DWORD *)(v12 + 20), v14, (int)&v31);
      std::string::swap((std::string *)&v32, (std::string *)&v33);
    }
    v15 = v33 - 12;
    if ( (_DWORD *)(v33 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v28 = _InterlockedExchangeAdd((volatile signed __int32 *)(v33 - 4), 0xFFFFFFFF);
      }
      else
      {
        v28 = *(_DWORD *)(v33 - 4);
        *(_DWORD *)(v33 - 4) = v28 - 1;
      }
      if ( v28 <= 0 )
        std::string::_Rep::_M_destroy(v15, &v30);
    }
  }
  else
  {
    std::string::assign((std::string *)&v32, (const std::string *)(v12 + 40));
  }
  v34 = (unsigned int)&unk_80CF5DC;
  v45 = (int)&unk_80CF5F0;
  v35 = (int)&unk_80CF588;
  v16 = v44 - 12;
  if ( (_DWORD *)(v44 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v27 = _InterlockedExchangeAdd((volatile signed __int32 *)(v44 - 4), 0xFFFFFFFF);
    }
    else
    {
      v27 = *(_DWORD *)(v44 - 4);
      *(_DWORD *)(v44 - 4) = v27 - 1;
    }
    if ( v27 <= 0 )
      std::string::_Rep::_M_destroy(v16, &v33);
  }
  v35 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v42);
  v34 = v10;
  *(unsigned int *)((char *)&v34 + *(_DWORD *)(v10 - 12)) = dword_80CF678;
  v45 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v45);
  if ( byte_80CE64C )
  {
    v17 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v32, *(_DWORD *)(v32 - 12));
    v18 = (std::ostream *)v17;
    v19 = *(_DWORD *)(*(_DWORD *)v17 - 12);
    v20 = *(_DWORD *)((char *)v18 + v19 + 124);
    if ( !v20 )
    {
      v23 = std::__throw_bad_cast();
      goto LABEL_38;
    }
    if ( *(_BYTE *)(v20 + 28) )
    {
      v21 = *(_BYTE *)(v20 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v18 + v19 + 124));
      v21 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v20 + 24))(v20, 10);
    }
    v22 = (std::ostream *)std::ostream::put(v18, v21);
    std::ostream::flush(v22);
  }
  syslog(5, "%s", v32, v29);
  v23 = v32;
  v24 = v32 - 12;
  if ( (_DWORD *)(v32 - 12) == &std::string::_Rep::_S_empty_rep_storage )
    goto LABEL_2;
  if ( &_pthread_key_create )
  {
    v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
    goto LABEL_32;
  }
LABEL_38:
  v26 = *(_DWORD *)(v23 - 4);
  *(_DWORD *)(v23 - 4) = v26 - 1;
  v25 = v26;
LABEL_32:
  if ( v25 <= 0 )
    std::string::_Rep::_M_destroy(v24, &v34);
LABEL_2:
  v2 = *(_DWORD *)(a1 + 356);
  v3 = *(_DWORD *)(a1 + 360);
  if ( v2 == v3 )
    return 0;
  if ( a2 != *(_DWORD *)(*(_DWORD *)v2 + 8) )
  {
    v4 = v2 + 4;
    do
    {
      v2 = v4;
      if ( v4 == v3 )
        return 0;
      v4 += 4;
    }
    while ( a2 != *(_DWORD *)(*(_DWORD *)v2 + 8) );
  }
  v6 = v2 + 4;
  if ( v3 != v2 + 4 )
  {
    v7 = (v3 - v6) >> 2;
    if ( v7 > 0 )
    {
      do
      {
        v8 = *(_DWORD *)(v6 - 4);
        if ( v8 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v8 + 4));
          if ( !v8 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        *(_DWORD *)(v6 - 4) = *(_DWORD *)v6;
        *(_DWORD *)v6 = 0;
        v6 += 4;
        --v7;
      }
      while ( v7 );
      v3 = *(_DWORD *)(a1 + 360);
    }
  }
  *(_DWORD *)(a1 + 360) = v3 - 4;
  v9 = *(_DWORD *)(v3 - 4);
  if ( v9 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v9 + 4));
    if ( !v9 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  return 1;
}
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08061500) --------------------------------------------------------
int __cdecl sub_8061500(int a1, int a2)
{
  int v2; // ebx@1
  int v3; // edi@3
  int v4; // eax@3
  int v5; // edx@3
  int result; // eax@6
  bool v7; // zf@6
  signed __int32 v8; // eax@11
  signed __int32 v9; // ecx@14
  __int64 v10; // [sp+28h] [bp-40h]@3
  char v11; // [sp+36h] [bp-32h]@3
  char v12; // [sp+37h] [bp-31h]@13
  int v13; // [sp+38h] [bp-30h]@1
  int v14; // [sp+3Ch] [bp-2Ch]@3
  int v15; // [sp+40h] [bp-28h]@3
  int (__cdecl *v16)(void **, void **, signed int); // [sp+48h] [bp-20h]@3
  int (__cdecl *v17)(int); // [sp+4Ch] [bp-1Ch]@3

  v2 = *(_DWORD *)(*(_DWORD *)a2 + 8);
  v13 = v2;
  if ( v2 )
  {
    _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
    v2 = v13;
  }
  v3 = *(_DWORD *)(v2 + 44);
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v10);
  *(_DWORD *)(v2 + 60) = (signed int)((long double)(v10 - *(_QWORD *)(v2 + 48)) / 1000000000.0) + v3;
  v16 = 0;
  v4 = operator new(4u);
  *(_DWORD *)v4 = a2;
  v15 = v4;
  v17 = sub_805FC80;
  v16 = sub_805FCA0;
  std::string::string(&v14, "FINISHED", &v11);
  sub_8093CA0(a1 + 336, (int)&v13, (int)&v14, (int)&v15);
  v5 = v14 - 12;
  if ( (_DWORD *)(v14 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v8 = _InterlockedExchangeAdd((volatile signed __int32 *)(v14 - 4), 0xFFFFFFFF);
    }
    else
    {
      v9 = *(_DWORD *)(v14 - 4);
      *(_DWORD *)(v14 - 4) = v9 - 1;
      v8 = v9;
    }
    if ( v8 <= 0 )
      std::string::_Rep::_M_destroy(v5, &v12);
  }
  if ( v16 )
    v16((void **)&v15, (void **)&v15, 3);
  sub_8060F60(a1, *(_DWORD *)(v13 + 8));
  result = v13;
  v7 = v13 == 0;
  if ( v13 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v13 + 4));
    if ( v7 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (080616D0) --------------------------------------------------------
int __cdecl sub_80616D0(int **a1, int a2, int a3)
{
  int v3; // edi@1
  int *v4; // ebx@1
  int v5; // esi@1
  int v6; // edx@3
  int result; // eax@6
  bool v8; // zf@6
  int v9; // edx@10
  signed __int32 v10; // eax@12
  signed __int32 v11; // eax@16
  signed __int32 v12; // ecx@19
  signed __int32 v13; // ecx@20
  __int64 v14; // [sp+28h] [bp-40h]@1
  char v15; // [sp+36h] [bp-32h]@18
  char v16; // [sp+37h] [bp-31h]@3
  int v17; // [sp+38h] [bp-30h]@1
  int v18; // [sp+3Ch] [bp-2Ch]@3
  int v19; // [sp+40h] [bp-28h]@3
  void (__cdecl *v20)(int *, int *, signed int); // [sp+48h] [bp-20h]@3

  v17 = *(_DWORD *)a2;
  v3 = v17;
  *(_DWORD *)a2 = 0;
  v4 = *a1;
  v5 = *(_DWORD *)(v3 + 44);
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v14);
  *(_DWORD *)(v3 + 60) = (signed int)((long double)(v14 - *(_QWORD *)(v3 + 48)) / 1000000000.0) + v5;
  if ( sub_8060F60(*v4, *(_DWORD *)(v17 + 8)) )
  {
    if ( *(_BYTE *)a3 )
    {
      v20 = 0;
      std::string::string(&v18, "FINISHED", &v16);
      sub_8093CA0(*v4 + 336, (int)&v17, (int)&v18, (int)&v19);
      v6 = v18 - 12;
      if ( (_DWORD *)(v18 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v11 = _InterlockedExchangeAdd((volatile signed __int32 *)(v18 - 4), 0xFFFFFFFF);
        }
        else
        {
          v12 = *(_DWORD *)(v18 - 4);
          *(_DWORD *)(v18 - 4) = v12 - 1;
          v11 = v12;
        }
        if ( v11 <= 0 )
          std::string::_Rep::_M_destroy(v6, &v15);
      }
      if ( v20 )
        v20(&v19, &v19, 3);
    }
    else
    {
      std::string::string(&v19, "FAILED", &v16);
      sub_80940A0(*v4 + 336, (int)&v17, (int)&v19, a3 + 4);
      v9 = v19 - 12;
      if ( (_DWORD *)(v19 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v10 = _InterlockedExchangeAdd((volatile signed __int32 *)(v19 - 4), 0xFFFFFFFF);
        }
        else
        {
          v13 = *(_DWORD *)(v19 - 4);
          *(_DWORD *)(v19 - 4) = v13 - 1;
          v10 = v13;
        }
        if ( v10 <= 0 )
          std::string::_Rep::_M_destroy(v9, &v18);
      }
    }
  }
  result = v17;
  v8 = v17 == 0;
  if ( v17 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v17 + 4));
    if ( v8 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08061930) --------------------------------------------------------
int __cdecl sub_8061930(int **a1, int a2, int a3)
{
  int v3; // edi@1
  int *v4; // ebx@1
  int v5; // esi@1
  int result; // eax@2
  bool v7; // zf@2
  int v8; // eax@6
  int v9; // edx@6
  signed __int32 v10; // eax@10
  signed __int32 v11; // ecx@13
  __int64 v12; // [sp+28h] [bp-40h]@1
  char v13; // [sp+36h] [bp-32h]@12
  char v14; // [sp+37h] [bp-31h]@6
  int v15; // [sp+38h] [bp-30h]@1
  int v16; // [sp+3Ch] [bp-2Ch]@6
  int v17; // [sp+40h] [bp-28h]@6
  int (__cdecl *v18)(void **, void **, signed int); // [sp+48h] [bp-20h]@6
  int (*v19)(); // [sp+4Ch] [bp-1Ch]@6

  v15 = *(_DWORD *)a2;
  v3 = v15;
  *(_DWORD *)a2 = 0;
  v4 = *a1;
  v5 = *(_DWORD *)(v3 + 44);
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v12);
  *(_DWORD *)(v3 + 60) = (signed int)((long double)(v12 - *(_QWORD *)(v3 + 48)) / 1000000000.0) + v5;
  if ( sub_8060F60(*v4, *(_DWORD *)(v15 + 8)) )
  {
    v18 = 0;
    v8 = operator new(4u);
    *(_DWORD *)v8 = a3;
    v17 = v8;
    v19 = sub_8060F00;
    v18 = sub_805FE80;
    std::string::string(&v16, "FINISHED", &v14);
    sub_8093CA0(*v4 + 336, (int)&v15, (int)&v16, (int)&v17);
    v9 = v16 - 12;
    if ( (_DWORD *)(v16 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v10 = _InterlockedExchangeAdd((volatile signed __int32 *)(v16 - 4), 0xFFFFFFFF);
      }
      else
      {
        v11 = *(_DWORD *)(v16 - 4);
        *(_DWORD *)(v16 - 4) = v11 - 1;
        v10 = v11;
      }
      if ( v10 <= 0 )
        std::string::_Rep::_M_destroy(v9, &v13);
    }
    if ( v18 )
      v18((void **)&v17, (void **)&v17, 3);
  }
  result = v15;
  v7 = v15 == 0;
  if ( v15 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v15 + 4));
    if ( v7 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 8060F00: using guessed type int sub_8060F00();
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08061B10) --------------------------------------------------------
char __cdecl sub_8061B10(pthread_mutex_t *a1, int a2)
{
  unsigned int v2; // ebp@0
  int v3; // edx@1
  int v4; // ebx@3
  int v5; // ecx@3
  int v6; // eax@4
  bool v7; // zf@8
  int v8; // eax@9
  int v9; // esi@9
  int v10; // ebx@9
  int v11; // ST20_4@15
  int v12; // edi@15
  int v13; // esi@15
  int v14; // esi@15
  size_t v15; // eax@15
  int v16; // eax@15
  int v17; // edx@16
  int v18; // edx@18
  int v19; // edx@19
  int v20; // eax@21
  std::ostream *v21; // edi@21
  int v22; // eax@21
  int v23; // esi@21
  char v24; // al@23
  std::ostream *v25; // eax@24
  int v26; // edx@25
  int v27; // eax@35
  char *v28; // eax@36
  int v29; // eax@37
  char *v30; // ST24_4@40
  int v31; // edi@40
  int v32; // edi@40
  size_t v33; // eax@41
  int v34; // eax@42
  int v35; // edx@42
  int v36; // eax@44
  std::ostream *v37; // edi@44
  int v38; // eax@44
  int v39; // ebx@44
  char v40; // al@46
  std::ostream *v41; // eax@47
  int v42; // edi@50
  int v43; // esi@50
  int v44; // ebx@62
  signed __int32 v45; // ecx@66
  signed __int32 v46; // ecx@72
  signed __int32 v47; // esi@77
  signed __int32 v48; // esi@81
  int v50; // [sp+Ch] [bp-1DCh]@0
  char v51; // [sp+1Bh] [bp-1CDh]@13
  char *s; // [sp+20h] [bp-1C8h]@14
  char *v53; // [sp+24h] [bp-1C4h]@39
  __int64 v54; // [sp+38h] [bp-1B0h]@50
  int v55; // [sp+4Ch] [bp-19Ch]@1
  int v56; // [sp+50h] [bp-198h]@56
  int v57; // [sp+54h] [bp-194h]@56
  int v58; // [sp+58h] [bp-190h]@52
  int v59; // [sp+5Ch] [bp-18Ch]@52
  int v60; // [sp+60h] [bp-188h]@17
  int v61; // [sp+64h] [bp-184h]@15
  int v62; // [sp+68h] [bp-180h]@17
  int v63; // [sp+6Ch] [bp-17Ch]@40
  int v64; // [sp+70h] [bp-178h]@40
  int v65; // [sp+74h] [bp-174h]@40
  int v66; // [sp+78h] [bp-170h]@40
  int v67; // [sp+7Ch] [bp-16Ch]@40
  int v68; // [sp+80h] [bp-168h]@40
  int v69; // [sp+84h] [bp-164h]@40
  char v70; // [sp+88h] [bp-160h]@40
  int v71; // [sp+8Ch] [bp-15Ch]@40
  int v72; // [sp+90h] [bp-158h]@40
  int v73; // [sp+94h] [bp-154h]@40
  int v74; // [sp+104h] [bp-E4h]@40
  char v75; // [sp+108h] [bp-E0h]@40
  char v76; // [sp+109h] [bp-DFh]@40
  int v77; // [sp+10Ch] [bp-DCh]@40
  int v78; // [sp+110h] [bp-D8h]@40
  int v79; // [sp+114h] [bp-D4h]@40
  int v80; // [sp+118h] [bp-D0h]@40
  int v81; // [sp+11Ch] [bp-CCh]@15
  int v82; // [sp+120h] [bp-C8h]@15
  int v83; // [sp+124h] [bp-C4h]@15
  int v84; // [sp+128h] [bp-C0h]@15
  int v85; // [sp+12Ch] [bp-BCh]@15
  int v86; // [sp+130h] [bp-B8h]@15
  int v87; // [sp+134h] [bp-B4h]@15
  int v88; // [sp+138h] [bp-B0h]@15
  char v89; // [sp+13Ch] [bp-ACh]@15
  int v90; // [sp+140h] [bp-A8h]@15
  int v91; // [sp+144h] [bp-A4h]@15
  int v92; // [sp+148h] [bp-A0h]@15
  int v93; // [sp+1B8h] [bp-30h]@15
  char v94; // [sp+1BCh] [bp-2Ch]@15
  char v95; // [sp+1BDh] [bp-2Bh]@15
  int v96; // [sp+1C0h] [bp-28h]@15
  int v97; // [sp+1C4h] [bp-24h]@15
  int v98; // [sp+1C8h] [bp-20h]@15
  int v99; // [sp+1CCh] [bp-1Ch]@15

  v3 = *(_DWORD *)(*(_DWORD *)a2 + 12);
  v55 = v3;
  if ( v3 )
  {
    _InterlockedIncrement((volatile signed __int32 *)(v3 + 4));
    v3 = v55;
  }
  v4 = *(_DWORD *)(a2 + 28);
  v5 = *(_DWORD *)(a2 + 32);
  if ( v4 == v5 )
    goto LABEL_8;
  v6 = v4 + 64;
  if ( *(_DWORD *)v4 != 1 )
  {
    while ( 1 )
    {
      v4 = v6;
      if ( v5 == v6 )
        break;
      v6 += 64;
      if ( *(_DWORD *)(v6 - 64) == 1 )
        goto LABEL_31;
    }
LABEL_8:
    v6 = *(_DWORD *)(v3 + 92) - 1;
    v7 = *(_DWORD *)(v3 + 92) == 1;
    if ( *(_DWORD *)(v3 + 92) == 1 )
      goto LABEL_33;
    *(_DWORD *)(v3 + 92) = 2;
    v8 = *(_DWORD *)(a2 + 16);
    v9 = *(_DWORD *)(a2 + 20);
    v10 = 0;
    if ( v8 == v9 )
    {
LABEL_13:
      v51 = 0;
      if ( log_level > 3 )
        goto LABEL_27;
      s = ": items not available";
    }
    else
    {
      while ( 1 )
      {
        if ( *(_DWORD *)v8 != 4 )
        {
          LOBYTE(v10) = 1;
          if ( *(_DWORD *)v8 == 1 )
            break;
        }
        v8 += 64;
        if ( v9 == v8 )
          goto LABEL_13;
      }
      v51 = 1;
      if ( log_level > 3 )
        goto LABEL_27;
      s = ": by rules";
    }
    v11 = *(_DWORD *)(v3 + 8);
    std::ios_base::ios_base((std::ios_base *)&v92);
    v92 = (int)&unk_80CF5C8;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    v98 = 0;
    v99 = 0;
    v12 = dword_80CF674;
    v81 = dword_80CF674;
    *(int *)((char *)&v81 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v81 + *(_DWORD *)(v81 - 12), 0);
    v81 = (int)&unk_80CF5DC;
    v92 = (int)&unk_80CF5F0;
    v82 = (int)&unk_80CF7F0;
    v83 = 0;
    v84 = 0;
    v85 = 0;
    v86 = 0;
    v87 = 0;
    v88 = 0;
    std::locale::locale((std::locale *)&v89);
    v82 = (int)&unk_80CF588;
    v90 = 16;
    v91 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v92, &v82);
    v13 = std::__ostream_insert<char,std::char_traits<char>>(
            &v81,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v13, "whitelist failed for task ", 26);
    v14 = std::ostream::_M_insert<unsigned long>(v13, v11);
    v15 = strlen(s);
    std::__ostream_insert<char,std::char_traits<char>>(v14, s, v15);
    v61 = (int)&unk_80CF83C;
    v16 = *(_DWORD *)(v14 + 24);
    if ( v16 )
    {
      v17 = *(_DWORD *)(v14 + 16);
      LOBYTE(v50) = 0;
      if ( v16 <= (unsigned int)v17 )
      {
        v62 = std::string::_S_construct<char *>(v10, v2, (void *)v12, *(_DWORD *)(v14 + 20), v17, (int)&v60);
        std::string::swap((std::string *)&v61, (std::string *)&v62);
      }
      else
      {
        v62 = std::string::_S_construct<char *>(v10, v2, (void *)v12, *(_DWORD *)(v14 + 20), v16, (int)&v60);
        std::string::swap((std::string *)&v61, (std::string *)&v62);
      }
      v18 = v62 - 12;
      if ( (_DWORD *)(v62 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v48 = _InterlockedExchangeAdd((volatile signed __int32 *)(v62 - 4), 0xFFFFFFFF);
        }
        else
        {
          v48 = *(_DWORD *)(v62 - 4);
          *(_DWORD *)(v62 - 4) = v48 - 1;
        }
        if ( v48 <= 0 )
          std::string::_Rep::_M_destroy(v18, &v59);
      }
    }
    else
    {
      std::string::assign((std::string *)&v61, (const std::string *)(v14 + 40));
    }
    v81 = (int)&unk_80CF5DC;
    v92 = (int)&unk_80CF5F0;
    v82 = (int)&unk_80CF588;
    v19 = v91 - 12;
    if ( (_DWORD *)(v91 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v47 = _InterlockedExchangeAdd((volatile signed __int32 *)(v91 - 4), 0xFFFFFFFF);
      }
      else
      {
        v47 = *(_DWORD *)(v91 - 4);
        *(_DWORD *)(v91 - 4) = v47 - 1;
      }
      if ( v47 <= 0 )
        std::string::_Rep::_M_destroy(v19, &v62);
    }
    v82 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v89);
    v81 = v12;
    *(int *)((char *)&v81 + *(_DWORD *)(v12 - 12)) = dword_80CF678;
    v92 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v92);
    if ( byte_80CE64C )
    {
      v20 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v61, *(_DWORD *)(v61 - 12));
      v21 = (std::ostream *)v20;
      v22 = *(_DWORD *)(*(_DWORD *)v20 - 12);
      v23 = *(_DWORD *)((char *)v21 + v22 + 124);
      if ( !v23 )
      {
        v44 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v61 - 12, &v81);
        goto LABEL_60;
      }
      if ( *(_BYTE *)(v23 + 28) )
      {
        v24 = *(_BYTE *)(v23 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v21 + v22 + 124));
        v24 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v23 + 24))(v23, 10);
      }
      v25 = (std::ostream *)std::ostream::put(v21, v24);
      std::ostream::flush(v25);
    }
    syslog(5, "%s", v61, v50);
    v26 = v61 - 12;
    if ( (_DWORD *)(v61 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v61 - 4), 0xFFFFFFFF);
      }
      else
      {
        v46 = *(_DWORD *)(v61 - 4);
        *(_DWORD *)(v61 - 4) = v46 - 1;
      }
      if ( v46 <= 0 )
        std::string::_Rep::_M_destroy(v26, &v81);
    }
    v3 = v55;
LABEL_27:
    sub_80B2040(a1, *(_DWORD *)(v3 + 8));
    LOBYTE(v6) = sub_8060F60((int)a1, *(_DWORD *)(v55 + 8));
    if ( !(_BYTE)v6 )
    {
LABEL_28:
      v3 = v55;
      goto LABEL_29;
    }
    v42 = v55;
    v43 = *(_DWORD *)(v55 + 44);
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v54);
    *(_DWORD *)(v42 + 60) = (signed int)((long double)(v54 - *(_QWORD *)(v42 + 48)) / 1000000000.0) + v43;
    if ( (_BYTE)v10 )
    {
      if ( v51 )
      {
        std::string::string(&v61, "whiteitems check failed: by rules", &v62);
        std::string::string(&v60, "FAILED", &v59);
        sub_80940A0((int)&a1[14], (int)&v55, (int)&v60, (int)&v61);
        std::string::_Rep::_M_dispose(v60 - 12, &v81);
        LOBYTE(v6) = std::string::_Rep::_M_dispose(v61 - 12, &v81);
        goto LABEL_28;
      }
      std::string::string(&v59, "whiteitems check failed: not available", &v62);
      std::string::string(&v58, "FAILED", &v61);
      sub_80940A0((int)&a1[14], (int)&v55, (int)&v58, (int)&v59);
      std::string::_Rep::_M_dispose(v58 - 12, &v81);
      LOBYTE(v6) = std::string::_Rep::_M_dispose(v59 - 12, &v81);
      v3 = v55;
    }
    else
    {
      std::string::string(&v57, "whiteitems check failed: unknown ip address", &v62);
      std::string::string(&v56, "FAILED", &v61);
      sub_80940A0((int)&a1[14], (int)&v55, (int)&v56, (int)&v57);
      std::string::_Rep::_M_dispose(v56 - 12, &v81);
      LOBYTE(v6) = std::string::_Rep::_M_dispose(v57 - 12, &v81);
      v3 = v55;
    }
LABEL_29:
    v7 = v3 == 0;
    if ( !v3 )
      return v6;
    goto LABEL_33;
  }
LABEL_31:
  v7 = log_level == 2;
  if ( log_level <= 2 )
  {
    v27 = *(_DWORD *)(v4 + 56);
    if ( !v27 || (v28 = *(char **)(v27 + 8), !*((_DWORD *)v28 - 3)) )
    {
      v29 = *(_DWORD *)(*(_DWORD *)(v4 + 60) + 16);
      if ( !v29 )
      {
        v53 = "";
        goto LABEL_40;
      }
      v28 = *(char **)(v29 + 8);
    }
    v53 = v28;
LABEL_40:
    v30 = *(char **)(v3 + 8);
    std::ios_base::ios_base((std::ios_base *)&v73);
    v73 = (int)&unk_80CF5C8;
    v74 = 0;
    v75 = 0;
    v76 = 0;
    v77 = 0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v62 = dword_80CF674;
    *(int *)((char *)&v62 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v62 + *(_DWORD *)(v62 - 12), 0);
    v62 = (int)&unk_80CF5DC;
    v73 = (int)&unk_80CF5F0;
    v63 = (int)&unk_80CF7F0;
    v64 = 0;
    v65 = 0;
    v66 = 0;
    v67 = 0;
    v68 = 0;
    v69 = 0;
    std::locale::locale((std::locale *)&v70);
    v63 = (int)&unk_80CF588;
    v71 = 16;
    v72 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v73, &v63);
    v31 = std::__ostream_insert<char,std::char_traits<char>>(
            &v62,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v31, "whitelist passed for task ", 26);
    v32 = std::ostream::_M_insert<unsigned long>(v31, v30);
    std::__ostream_insert<char,std::char_traits<char>>(v32, ": ", 2);
    if ( v53 )
    {
      v33 = strlen(v53);
      std::__ostream_insert<char,std::char_traits<char>>(v32, v53, v33);
    }
    else
    {
      std::basic_ios<char,std::char_traits<char>>::clear(
        v32 + *(_DWORD *)(*(_DWORD *)v32 - 12),
        *(_DWORD *)(v32 + *(_DWORD *)(*(_DWORD *)v32 - 12) + 20) | 1);
    }
    std::__ostream_insert<char,std::char_traits<char>>(v32, " ", 1);
    v34 = std::__ostream_insert<char,std::char_traits<char>>(
            v32,
            *(_DWORD *)(v4 + 8),
            *(_DWORD *)(*(_DWORD *)(v4 + 8) - 12));
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v81, v34 + 4);
    v62 = (int)&unk_80CF5DC;
    v73 = (int)&unk_80CF5F0;
    v63 = (int)&unk_80CF588;
    v35 = v72 - 12;
    if ( (_DWORD *)(v72 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v45 = _InterlockedExchangeAdd((volatile signed __int32 *)(v72 - 4), 0xFFFFFFFF);
      }
      else
      {
        v45 = *(_DWORD *)(v72 - 4);
        *(_DWORD *)(v72 - 4) = v45 - 1;
      }
      if ( v45 <= 0 )
        std::string::_Rep::_M_destroy(v35, &v61);
    }
    v63 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v70);
    v62 = dword_80CF674;
    *(int *)((char *)&v62 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v73 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v73);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v62);
    if ( !byte_80CE64C )
      goto LABEL_48;
    v36 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v81, *(_DWORD *)(v81 - 12));
    v37 = (std::ostream *)v36;
    v38 = *(_DWORD *)(*(_DWORD *)v36 - 12);
    v39 = *(_DWORD *)((char *)v37 + v38 + 124);
    if ( v39 )
    {
      if ( *(_BYTE *)(v39 + 28) )
      {
        v40 = *(_BYTE *)(v39 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v37 + v38 + 124));
        v40 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v39 + 24))(v39, 10);
      }
      v41 = (std::ostream *)std::ostream::put(v37, v40);
      std::ostream::flush(v41);
LABEL_48:
      syslog(6, "%s", v81);
      LOBYTE(v6) = std::string::_Rep::_M_dispose(v81 - 12, &v62);
      v3 = v55;
      goto LABEL_32;
    }
    v44 = std::__throw_bad_cast();
    std::string::_Rep::_M_dispose(v81 - 12, &v62);
LABEL_60:
    sub_8056F10(v55);
    Unwind_Resume(v44);
  }
LABEL_32:
  *(_DWORD *)(v3 + 92) = 1;
LABEL_33:
  _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
  if ( v7 )
    LOBYTE(v6) = (*(int (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
  return v6;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08062970) --------------------------------------------------------
char __cdecl sub_8062970(pthread_mutex_t *a1, int a2)
{
  unsigned int v2; // ebp@0
  int v3; // esi@1
  signed int v4; // eax@1
  int v5; // edx@4
  int v6; // eax@8
  int v7; // edx@10
  bool v8; // zf@13
  int v9; // ebx@17
  char result; // al@19
  int v11; // ST24_4@22
  int v12; // esi@22
  int v13; // ebx@22
  int v14; // ebx@22
  int v15; // eax@22
  int v16; // edx@23
  int v17; // edx@25
  int v18; // edx@26
  int v19; // eax@28
  std::ostream *v20; // esi@28
  int v21; // eax@28
  int v22; // ebx@28
  char v23; // al@30
  std::ostream *v24; // eax@31
  int v25; // edx@33
  int v26; // ST24_4@36
  int v27; // esi@36
  int v28; // ebx@36
  int v29; // ebx@36
  int v30; // eax@36
  int v31; // edx@37
  int v32; // edx@39
  int v33; // edx@40
  int v34; // eax@42
  std::ostream *v35; // esi@42
  int v36; // eax@42
  int v37; // ebx@42
  char v38; // al@44
  std::ostream *v39; // eax@45
  int v40; // ecx@47
  int v41; // edx@47
  int v42; // ST20_4@50
  int v43; // esi@50
  int v44; // esi@50
  int v45; // eax@51
  int v46; // esi@55
  int v47; // ST1C_4@55
  int v48; // ST24_4@55
  int v49; // ST20_4@55
  int v50; // esi@55
  int v51; // esi@55
  int v52; // esi@55
  int v53; // esi@55
  int v54; // edx@55
  int v55; // eax@58
  int v56; // eax@60
  int v57; // edx@62
  int v58; // edx@64
  bool v59; // zf@64
  char v60; // ST28_1@66
  int v61; // edx@67
  int v62; // eax@68
  int v63; // eax@75
  int v64; // edx@75
  int v65; // edx@77
  int v66; // ecx@79
  int v67; // ST24_4@86
  int v68; // ebx@86
  int v69; // ST24_4@86
  int v70; // edx@86
  int v71; // eax@89
  int v72; // esi@92
  int v73; // ebx@92
  signed __int32 v74; // ecx@98
  signed __int32 v75; // ecx@102
  signed __int32 v76; // ebx@106
  signed __int32 v77; // ebx@110
  signed __int32 v78; // ecx@117
  signed __int32 v79; // ecx@122
  signed __int32 v80; // ebx@127
  int v81; // edi@130
  int v82; // ebx@130
  signed __int32 v83; // ebx@134
  int v84; // [sp+Ch] [bp-34Ch]@8
  int *v85; // [sp+18h] [bp-340h]@56
  int *v86; // [sp+18h] [bp-340h]@87
  int v87; // [sp+1Ch] [bp-33Ch]@50
  int v88; // [sp+20h] [bp-338h]@50
  int v89; // [sp+24h] [bp-334h]@2
  __int64 v90; // [sp+38h] [bp-320h]@17
  int v91; // [sp+44h] [bp-314h]@8
  int v92; // [sp+48h] [bp-310h]@92
  int v93; // [sp+4Ch] [bp-30Ch]@92
  int v94; // [sp+50h] [bp-308h]@51
  int (__cdecl *v95)(void **, void **, signed int); // [sp+58h] [bp-300h]@51
  int (*v96)(); // [sp+5Ch] [bp-2FCh]@51
  int v97; // [sp+60h] [bp-2F8h]@60
  int (__cdecl *v98)(void **, void **, signed int); // [sp+68h] [bp-2F0h]@60
  int (*v99)(); // [sp+6Ch] [bp-2ECh]@60
  int v100; // [sp+70h] [bp-2E8h]@17
  int v101; // [sp+74h] [bp-2E4h]@86
  char v102; // [sp+90h] [bp-2C8h]@88
  int v103; // [sp+98h] [bp-2C0h]@86
  int v104; // [sp+9Ch] [bp-2BCh]@86
  int v105; // [sp+124h] [bp-234h]@17
  int v106; // [sp+128h] [bp-230h]@55
  char v107; // [sp+144h] [bp-214h]@57
  int v108; // [sp+14Ch] [bp-20Ch]@55
  int v109; // [sp+150h] [bp-208h]@55
  int v110; // [sp+1D8h] [bp-180h]@4
  int v111; // [sp+1DCh] [bp-17Ch]@22
  int v112; // [sp+1E0h] [bp-178h]@22
  int v113; // [sp+1E4h] [bp-174h]@22
  int v114; // [sp+1E8h] [bp-170h]@22
  int v115; // [sp+1ECh] [bp-16Ch]@22
  int v116; // [sp+1F0h] [bp-168h]@22
  int v117; // [sp+1F4h] [bp-164h]@22
  char v118; // [sp+1F8h] [bp-160h]@22
  int v119; // [sp+1FCh] [bp-15Ch]@22
  int v120; // [sp+200h] [bp-158h]@22
  int v121; // [sp+204h] [bp-154h]@22
  int v122; // [sp+274h] [bp-E4h]@22
  char v123; // [sp+278h] [bp-E0h]@22
  char v124; // [sp+279h] [bp-DFh]@22
  int v125; // [sp+27Ch] [bp-DCh]@22
  int v126; // [sp+280h] [bp-D8h]@22
  int v127; // [sp+284h] [bp-D4h]@22
  int v128; // [sp+288h] [bp-D0h]@22
  std::ostream *v129; // [sp+28Ch] [bp-CCh]@4
  int v130; // [sp+290h] [bp-C8h]@36
  void (__cdecl *v131)(std::ostream **, std::ostream **, signed int); // [sp+294h] [bp-C4h]@4
  int v132; // [sp+298h] [bp-C0h]@36
  int v133; // [sp+29Ch] [bp-BCh]@36
  int v134; // [sp+2A0h] [bp-B8h]@36
  int v135; // [sp+2A4h] [bp-B4h]@36
  int v136; // [sp+2A8h] [bp-B0h]@36
  char v137; // [sp+2ACh] [bp-ACh]@36
  int v138; // [sp+2B0h] [bp-A8h]@36
  int v139; // [sp+2B4h] [bp-A4h]@36
  int v140; // [sp+2B8h] [bp-A0h]@36
  int v141; // [sp+328h] [bp-30h]@36
  char v142; // [sp+32Ch] [bp-2Ch]@36
  char v143; // [sp+32Dh] [bp-2Bh]@36
  int v144; // [sp+330h] [bp-28h]@36
  int v145; // [sp+334h] [bp-24h]@36
  int v146; // [sp+338h] [bp-20h]@36
  int v147; // [sp+33Ch] [bp-1Ch]@36

  ++*(_DWORD *)(*(_DWORD *)a2 + 72);
  v3 = *(_DWORD *)a2;
  v4 = *(_DWORD *)(*(_DWORD *)a2 + 72);
  if ( v4 > *(_DWORD *)(*(_DWORD *)a2 + 20) )
  {
LABEL_17:
    v9 = *(_DWORD *)(v3 + 44);
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v90);
    *(_DWORD *)(v3 + 60) = (signed int)((long double)(v90 - *(_QWORD *)(v3 + 48)) / 1000000000.0) + v9;
    v131 = 0;
    std::string::string(&v110, "FINISHED", &v100);
    sub_8093CA0((int)&a1[14], a2, (int)&v110, (int)&v129);
    std::string::_Rep::_M_dispose(v110 - 12, &v105);
    if ( v131 )
      v131(&v129, &v129, 3);
    sub_8060F60((int)a1, *(_DWORD *)(*(_DWORD *)a2 + 8));
    return 0;
  }
  v89 = (int)&a1[14].__lock;
  while ( 1 )
  {
    if ( v4 > 1 )
    {
      v131 = 0;
      v110 = (int)&unk_80CF83C;
      sub_8093CA0(v89, a2, (int)&v110, (int)&v129);
      v5 = v110 - 12;
      if ( (_DWORD *)(v110 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v74 = _InterlockedExchangeAdd((volatile signed __int32 *)(v110 - 4), 0xFFFFFFFF);
        }
        else
        {
          v74 = *(_DWORD *)(v110 - 4);
          *(_DWORD *)(v110 - 4) = v74 - 1;
        }
        if ( v74 <= 0 )
          std::string::_Rep::_M_destroy(v5, &v105);
      }
      if ( v131 )
        v131(&v129, &v129, 3);
      v3 = *(_DWORD *)a2;
    }
    sub_8094300((int)&v91, v89, a2, *(_DWORD *)(v3 + 72));
    v6 = v91;
    if ( !v91 )
      break;
    if ( *(_DWORD *)(v91 + 12) == *(_DWORD *)(v91 + 8) )
    {
      v7 = *(_DWORD *)(*(_DWORD *)(v91 + 20) + 16);
      if ( v7 && *(_DWORD *)(v7 + 4) != *(_DWORD *)v7 )
      {
        if ( log_level <= 4 )
        {
          v26 = *(_DWORD *)(*(_DWORD *)a2 + 72);
          std::ios_base::ios_base((std::ios_base *)&v140);
          v140 = (int)&unk_80CF5C8;
          v141 = 0;
          v142 = 0;
          v143 = 0;
          v144 = 0;
          v145 = 0;
          v146 = 0;
          v147 = 0;
          v27 = dword_80CF674;
          v129 = (std::ostream *)dword_80CF674;
          *(std::ostream **)((char *)&v129 + *(_DWORD *)(dword_80CF674 - 12)) = (std::ostream *)dword_80CF678;
          std::basic_ios<char,std::char_traits<char>>::init((char *)&v129 + *((_DWORD *)v129 - 3), 0);
          v129 = (std::ostream *)&unk_80CF5DC;
          v140 = (int)&unk_80CF5F0;
          v130 = (int)&unk_80CF7F0;
          v131 = 0;
          v132 = 0;
          v133 = 0;
          v134 = 0;
          v135 = 0;
          v136 = 0;
          std::locale::locale((std::locale *)&v137);
          v130 = (int)&unk_80CF588;
          v138 = 16;
          v139 = (int)&unk_80CF83C;
          std::basic_ios<char,std::char_traits<char>>::init(&v140, &v130);
          v28 = std::__ostream_insert<char,std::char_traits<char>>(
                  &v129,
                  &unk_80CF83C,
                  std::string::_Rep::_S_empty_rep_storage);
          std::__ostream_insert<char,std::char_traits<char>>(v28, "checklist ", 10);
          v29 = std::ostream::operator<<(v28, v26);
          std::__ostream_insert<char,std::char_traits<char>>(v29, " has no targets", 15);
          v105 = (int)&unk_80CF83C;
          v30 = *(_DWORD *)(v29 + 24);
          if ( v30 )
          {
            v31 = *(_DWORD *)(v29 + 16);
            LOBYTE(v84) = 0;
            if ( v30 <= (unsigned int)v31 )
            {
              v110 = std::string::_S_construct<char *>(v29, v2, (void *)a2, *(_DWORD *)(v29 + 20), v31, (int)&v100);
              std::string::swap((std::string *)&v105, (std::string *)&v110);
            }
            else
            {
              v110 = std::string::_S_construct<char *>(v29, v2, (void *)a2, *(_DWORD *)(v29 + 20), v30, (int)&v100);
              std::string::swap((std::string *)&v105, (std::string *)&v110);
            }
            v32 = v110 - 12;
            if ( (_DWORD *)(v110 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v80 = _InterlockedExchangeAdd((volatile signed __int32 *)(v110 - 4), 0xFFFFFFFF);
              }
              else
              {
                v80 = *(_DWORD *)(v110 - 4);
                *(_DWORD *)(v110 - 4) = v80 - 1;
              }
              if ( v80 <= 0 )
                std::string::_Rep::_M_destroy(v32, &v97);
            }
          }
          else
          {
            std::string::assign((std::string *)&v105, (const std::string *)(v29 + 40));
          }
          v129 = (std::ostream *)&unk_80CF5DC;
          v140 = (int)&unk_80CF5F0;
          v130 = (int)&unk_80CF588;
          v33 = v139 - 12;
          if ( (_DWORD *)(v139 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v76 = _InterlockedExchangeAdd((volatile signed __int32 *)(v139 - 4), 0xFFFFFFFF);
            }
            else
            {
              v76 = *(_DWORD *)(v139 - 4);
              *(_DWORD *)(v139 - 4) = v76 - 1;
            }
            if ( v76 <= 0 )
              std::string::_Rep::_M_destroy(v33, &v110);
          }
          v130 = (int)&unk_80CF7F0;
          std::locale::~locale((std::locale *)&v137);
          v129 = (std::ostream *)v27;
          *(std::ostream **)((char *)&v129 + *(_DWORD *)(v27 - 12)) = (std::ostream *)dword_80CF678;
          v140 = (int)&unk_80CF5C8;
          std::ios_base::~ios_base((std::ios_base *)&v140);
          if ( byte_80CE64C )
          {
            v34 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v105, *(_DWORD *)(v105 - 12));
            v35 = (std::ostream *)v34;
            v36 = *(_DWORD *)(*(_DWORD *)v34 - 12);
            v37 = *(_DWORD *)((char *)v35 + v36 + 124);
            if ( !v37 )
            {
              v81 = std::__throw_bad_cast();
              std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf(0);
              v129 = v35;
              *(std::ostream **)((char *)&v129 + *((_DWORD *)v35 - 3)) = (std::ostream *)dword_80CF678;
              v82 = v81;
              v140 = (int)&unk_80CF5C8;
              std::ios_base::~ios_base((std::ios_base *)&v140);
              std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v110);
              goto LABEL_113;
            }
            if ( *(_BYTE *)(v37 + 28) )
            {
              v38 = *(_BYTE *)(v37 + 39);
            }
            else
            {
              std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v35 + v36 + 124));
              v38 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v37 + 24))(v37, 10);
            }
            v39 = (std::ostream *)std::ostream::put(v35, v38);
            std::ostream::flush(v39);
          }
          syslog(4, "%s", v105, v84);
          goto LABEL_33;
        }
        goto LABEL_13;
      }
    }
    else
    {
      v40 = *(_DWORD *)(v91 + 20);
      v41 = *(_DWORD *)(v40 + 16);
      if ( v41 && *(_DWORD *)(v41 + 4) != *(_DWORD *)v41 )
      {
        if ( *(_DWORD *)(v40 + 28) == *(_DWORD *)(v40 + 24) )
        {
          *(_DWORD *)(*(_DWORD *)a2 + 92) = 1;
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)a2 + 92) = 0;
          v42 = *(_DWORD *)(v6 + 20);
          sub_8068500((int)&v110, a2);
          v43 = v110;
          v88 = v110;
          *(_BYTE *)(*(_DWORD *)(v110 + 20) + 68) = 1;
          *(_DWORD *)(*(_DWORD *)(v43 + 20) + 44) = 0;
          *(_BYTE *)(*(_DWORD *)(v43 + 20) + 36) = 1;
          *(_DWORD *)(*(_DWORD *)(v43 + 20) + 48) = 2;
          *(_DWORD *)(*(_DWORD *)(v43 + 20) + 52) = 1;
          v44 = *(_DWORD *)(v42 + 24);
          v87 = *(_DWORD *)(v42 + 28);
          if ( v44 != v87 )
          {
            while ( 1 )
            {
              v63 = operator new(0x2Cu);
              *(_DWORD *)(v63 + 4) = 0;
              *(_DWORD *)v63 = &off_80BA318;
              *(_DWORD *)(v63 + 8) = 0;
              *(_DWORD *)(v63 + 12) = 0;
              v64 = *(_DWORD *)v44;
              *(_DWORD *)(v63 + 16) = *(_DWORD *)v44;
              if ( v64 )
                _InterlockedIncrement((volatile signed __int32 *)(v64 + 4));
              *(_DWORD *)(v63 + 20) = 0;
              *(_DWORD *)(v63 + 24) = 0;
              *(_DWORD *)(v63 + 28) = 0;
              v65 = *(_DWORD *)(v88 + 20);
              *(_DWORD *)(v63 + 32) = v65;
              if ( v65 )
                _InterlockedIncrement((volatile signed __int32 *)(v65 + 4));
              *(_DWORD *)(v63 + 36) = 0;
              *(_DWORD *)(v63 + 40) = 0;
              v129 = (std::ostream *)v63;
              _InterlockedIncrement((volatile signed __int32 *)(v63 + 4));
              v66 = v110;
              v62 = *(_DWORD *)(v110 + 12);
              if ( v62 == *(_DWORD *)(v110 + 16) )
              {
                sub_80688B0(v110 + 8, (int)&v129);
                v61 = (int)v129;
              }
              else
              {
                v61 = (int)v129;
                if ( v62 )
                {
                  *(_DWORD *)v62 = v129;
                  v129 = 0;
                  v62 = *(_DWORD *)(v66 + 12);
                  v61 = 0;
                }
                *(_DWORD *)(v66 + 12) = v62 + 4;
              }
              if ( v61 )
              {
                _InterlockedDecrement((volatile signed __int32 *)(v61 + 4));
                if ( !v61 )
                  (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
              }
              v44 += 4;
              if ( v87 == v44 )
                break;
              v88 = v110;
            }
          }
          v95 = 0;
          v45 = operator new(4u);
          *(_DWORD *)v45 = a1;
          v94 = v45;
          v96 = sub_80605C0;
          v95 = sub_805FFC0;
          sub_80B2020(a2, a1, (int)&v110, (int)&v94);
          if ( v95 )
            v95((void **)&v94, (void **)&v94, 3);
          sub_8056F10(v110);
        }
        if ( log_level <= 2 )
        {
          v46 = *(_DWORD *)(v91 + 20);
          v47 = 954437177 * ((*(_DWORD *)(*(_DWORD *)(v46 + 16) + 4) - **(_DWORD **)(v46 + 16)) >> 2);
          v48 = (*(_DWORD *)(v91 + 12) - *(_DWORD *)(v91 + 8)) >> 2;
          v49 = *(_DWORD *)(v46 + 8);
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v105, 16);
          v50 = std::__ostream_insert<char,std::char_traits<char>>(
                  &v105,
                  &unk_80CF83C,
                  std::string::_Rep::_S_empty_rep_storage);
          std::__ostream_insert<char,std::char_traits<char>>(v50, "checklist: ", 11);
          v51 = std::ostream::operator<<(v50, v49);
          std::__ostream_insert<char,std::char_traits<char>>(v51, " ", 1);
          v52 = std::ostream::_M_insert<unsigned long>(v51, v48);
          std::__ostream_insert<char,std::char_traits<char>>(v52, " targets ", 9);
          v53 = std::ostream::_M_insert<unsigned long>(v52, v47);
          std::__ostream_insert<char,std::char_traits<char>>(v53, &byte_80B9D79, 6);
          std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v129, v53 + 4);
          v105 = (int)&unk_80CF5DC;
          v109 = (int)&unk_80CF5F0;
          v106 = (int)&unk_80CF588;
          v54 = v108 - 12;
          if ( (_DWORD *)(v108 - 12) == &std::string::_Rep::_S_empty_rep_storage )
          {
            v85 = &v110;
          }
          else
          {
            if ( &_pthread_key_create )
            {
              v78 = _InterlockedExchangeAdd((volatile signed __int32 *)(v108 - 4), 0xFFFFFFFF);
            }
            else
            {
              v78 = *(_DWORD *)(v108 - 4);
              *(_DWORD *)(v108 - 4) = v78 - 1;
            }
            v85 = &v110;
            if ( v78 <= 0 )
              std::string::_Rep::_M_destroy(v54, &v110);
          }
          v106 = (int)&unk_80CF7F0;
          std::locale::~locale((std::locale *)&v107);
          v105 = dword_80CF674;
          *(int *)((char *)&v105 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
          v109 = (int)&unk_80CF5C8;
          std::ios_base::~ios_base((std::ios_base *)&v109);
          std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v85);
          if ( byte_80CE64C )
          {
            v55 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v129, *((_DWORD *)v129 - 3));
            std::endl<char,std::char_traits<char>>(v55);
          }
          syslog(6, "%s", v129);
          std::string::_Rep::_M_dispose((char *)v129 - 12, v85);
        }
        v98 = 0;
        v56 = operator new(4u);
        *(_DWORD *)v56 = a1;
        v97 = v56;
        v99 = sub_8060680;
        v98 = sub_8060060;
        sub_80B2020(a2, a1, (int)&v91, (int)&v97);
        if ( v98 )
          v98((void **)&v97, (void **)&v97, 3);
        v57 = *(_DWORD *)(*(_DWORD *)a2 + 72);
        if ( v57 < *(_DWORD *)(*(_DWORD *)a2 + 20) )
          sub_8094160(v89, a2, v57 + 1);
        result = 1;
        goto LABEL_64;
      }
    }
    if ( log_level <= 4 )
    {
      v11 = *(_DWORD *)(*(_DWORD *)a2 + 72);
      std::ios_base::ios_base((std::ios_base *)&v121);
      v121 = (int)&unk_80CF5C8;
      v122 = 0;
      v123 = 0;
      v124 = 0;
      v125 = 0;
      v126 = 0;
      v127 = 0;
      v128 = 0;
      v12 = dword_80CF674;
      v110 = dword_80CF674;
      *(int *)((char *)&v110 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v110 + *(_DWORD *)(v110 - 12), 0);
      v110 = (int)&unk_80CF5DC;
      v121 = (int)&unk_80CF5F0;
      v111 = (int)&unk_80CF7F0;
      v112 = 0;
      v113 = 0;
      v114 = 0;
      v115 = 0;
      v116 = 0;
      v117 = 0;
      std::locale::locale((std::locale *)&v118);
      v111 = (int)&unk_80CF588;
      v119 = 16;
      v120 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v121, &v111);
      v13 = std::__ostream_insert<char,std::char_traits<char>>(
              &v110,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v13, "checklist ", 10);
      v14 = std::ostream::operator<<(v13, v11);
      std::__ostream_insert<char,std::char_traits<char>>(v14, &word_80B9D72, 13);
      v105 = (int)&unk_80CF83C;
      v15 = *(_DWORD *)(v14 + 24);
      if ( v15 )
      {
        v16 = *(_DWORD *)(v14 + 16);
        LOBYTE(v84) = 0;
        if ( v15 <= (unsigned int)v16 )
        {
          v129 = (std::ostream *)std::string::_S_construct<char *>(
                                   v14,
                                   v2,
                                   (void *)a2,
                                   *(_DWORD *)(v14 + 20),
                                   v16,
                                   (int)&v100);
          std::string::swap((std::string *)&v105, (std::string *)&v129);
        }
        else
        {
          v129 = (std::ostream *)std::string::_S_construct<char *>(
                                   v14,
                                   v2,
                                   (void *)a2,
                                   *(_DWORD *)(v14 + 20),
                                   v15,
                                   (int)&v100);
          std::string::swap((std::string *)&v105, (std::string *)&v129);
        }
        v17 = (int)((char *)v129 - 12);
        if ( (_DWORD *)((char *)v129 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v83 = _InterlockedExchangeAdd((volatile signed __int32 *)v129 - 1, 0xFFFFFFFF);
          }
          else
          {
            v83 = *((_DWORD *)v129 - 1);
            *((_DWORD *)v129 - 1) = v83 - 1;
          }
          if ( v83 <= 0 )
            std::string::_Rep::_M_destroy(v17, &v97);
        }
      }
      else
      {
        std::string::assign((std::string *)&v105, (const std::string *)(v14 + 40));
      }
      v110 = (int)&unk_80CF5DC;
      v121 = (int)&unk_80CF5F0;
      v111 = (int)&unk_80CF588;
      v18 = v120 - 12;
      if ( (_DWORD *)(v120 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v77 = _InterlockedExchangeAdd((volatile signed __int32 *)(v120 - 4), 0xFFFFFFFF);
        }
        else
        {
          v77 = *(_DWORD *)(v120 - 4);
          *(_DWORD *)(v120 - 4) = v77 - 1;
        }
        if ( v77 <= 0 )
          std::string::_Rep::_M_destroy(v18, &v129);
      }
      v111 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v118);
      v110 = v12;
      *(int *)((char *)&v110 + *(_DWORD *)(v12 - 12)) = dword_80CF678;
      v121 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v121);
      if ( byte_80CE64C )
      {
        v19 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v105, *(_DWORD *)(v105 - 12));
        v20 = (std::ostream *)v19;
        v21 = *(_DWORD *)(*(_DWORD *)v19 - 12);
        v22 = *(_DWORD *)((char *)v20 + v21 + 124);
        if ( !v22 )
        {
          v82 = std::__throw_bad_cast();
          if ( v95 )
            ((void (__cdecl *)(int *, int *, signed int, int))v95)(&v94, &v94, 3, v84);
          sub_8056F10(v110);
LABEL_113:
          sub_8056F10(v91);
          Unwind_Resume(v82);
        }
        if ( *(_BYTE *)(v22 + 28) )
        {
          v23 = *(_BYTE *)(v22 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v20 + v21 + 124));
          v23 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v22 + 24))(v22, 10);
        }
        v24 = (std::ostream *)std::ostream::put(v20, v23);
        std::ostream::flush(v24);
      }
      syslog(4, "%s", v105, v84);
LABEL_33:
      v25 = v105 - 12;
      if ( (_DWORD *)(v105 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v75 = _InterlockedExchangeAdd((volatile signed __int32 *)(v105 - 4), 0xFFFFFFFF);
        }
        else
        {
          v75 = *(_DWORD *)(v105 - 4);
          *(_DWORD *)(v105 - 4) = v75 - 1;
        }
        if ( v75 <= 0 )
          std::string::_Rep::_M_destroy(v25, &v129);
      }
      v6 = v91;
      ++*(_DWORD *)(*(_DWORD *)a2 + 72);
      v8 = v6 == 0;
      if ( !v6 )
        goto LABEL_16;
      goto LABEL_14;
    }
LABEL_13:
    v8 = (*(_DWORD *)(*(_DWORD *)a2 + 72))++ == -1;
LABEL_14:
    _InterlockedDecrement((volatile signed __int32 *)(v6 + 4));
    if ( v8 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v6 + 4))(v6);
LABEL_16:
    v3 = *(_DWORD *)a2;
    v4 = *(_DWORD *)(*(_DWORD *)a2 + 72);
    if ( v4 > *(_DWORD *)(*(_DWORD *)a2 + 20) )
      goto LABEL_17;
  }
  if ( log_level <= 5 )
  {
    v67 = *(_DWORD *)(*(_DWORD *)a2 + 8);
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v100, 16);
    v68 = std::__ostream_insert<char,std::char_traits<char>>(
            &v100,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v68, 134978863, 5);
    v69 = std::ostream::_M_insert<unsigned long>(v68, v67);
    std::__ostream_insert<char,std::char_traits<char>>(v69, ": failed to fetch checklist", 27);
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v129, v69 + 4);
    v100 = (int)&unk_80CF5DC;
    v104 = (int)&unk_80CF5F0;
    v101 = (int)&unk_80CF588;
    v70 = v103 - 12;
    if ( (_DWORD *)(v103 - 12) == &std::string::_Rep::_S_empty_rep_storage )
    {
      v86 = &v110;
    }
    else
    {
      if ( &_pthread_key_create )
      {
        v79 = _InterlockedExchangeAdd((volatile signed __int32 *)(v103 - 4), 0xFFFFFFFF);
      }
      else
      {
        v79 = *(_DWORD *)(v103 - 4);
        *(_DWORD *)(v103 - 4) = v79 - 1;
      }
      v86 = &v110;
      if ( v79 <= 0 )
        std::string::_Rep::_M_destroy(v70, &v110);
    }
    v101 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v102);
    v100 = dword_80CF674;
    *(int *)((char *)&v100 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v104 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v104);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v86);
    if ( byte_80CE64C )
    {
      v71 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v129, *((_DWORD *)v129 - 3));
      std::endl<char,std::char_traits<char>>(v71);
    }
    syslog(3, "%s", v129);
    std::string::_Rep::_M_dispose((char *)v129 - 12, v86);
  }
  sub_80B2040(a1, *(_DWORD *)(*(_DWORD *)a2 + 8));
  result = sub_8060F60((int)a1, *(_DWORD *)(*(_DWORD *)a2 + 8));
  if ( result )
  {
    v72 = *(_DWORD *)a2;
    v73 = *(_DWORD *)(*(_DWORD *)a2 + 44);
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v90);
    *(_DWORD *)(v72 + 60) = (signed int)((long double)(v90 - *(_QWORD *)(v72 + 48)) / 1000000000.0) + v73;
    std::string::string(&v93, 134978871, &v110);
    std::string::string(&v92, "FAILED", &v105);
    sub_80940A0(v89, a2, (int)&v92, (int)&v93);
    std::string::_Rep::_M_dispose(v92 - 12, &v129);
    std::string::_Rep::_M_dispose(v93 - 12, &v129);
    result = 0;
  }
LABEL_64:
  v58 = v91;
  v59 = v91 == 0;
  if ( v91 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v91 + 4));
    if ( v59 )
    {
      v60 = result;
      (*(void (__cdecl **)(int))(*(_DWORD *)v58 + 4))(v58);
      result = v60;
    }
  }
  return result;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80605C0: using guessed type int sub_80605C0();
// 8060680: using guessed type int sub_8060680();
// 80B9D72: using guessed type __int16 word_80B9D72;
// 80B9D79: using guessed type char byte_80B9D79;
// 80BA318: using guessed type int (__cdecl *off_80BA318)(int);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08064190) --------------------------------------------------------
int __cdecl sub_8064190(pthread_mutex_t *a1, int a2)
{
  unsigned int v2; // ebp@0
  int v3; // eax@1
  int v4; // eax@3
  bool v5; // zf@3
  int v6; // eax@7
  char v7; // si@7
  int v8; // ST14_4@9
  int v9; // edi@9
  int v10; // esi@9
  int v11; // esi@9
  int v12; // eax@9
  int v13; // edx@10
  int v14; // edx@13
  int v15; // eax@15
  std::ostream *v16; // edi@15
  int v17; // eax@15
  int v18; // esi@15
  char v19; // al@17
  std::ostream *v20; // eax@18
  int v21; // edx@19
  int result; // eax@21
  bool v23; // zf@21
  int v24; // eax@29
  bool v25; // zf@29
  int v26; // edi@32
  int v27; // esi@32
  signed __int32 v28; // ecx@37
  int v29; // esi@42
  signed __int32 v30; // esi@44
  int v31; // [sp+Ch] [bp-10Ch]@0
  char *v32; // [sp+10h] [bp-108h]@11
  __int64 v33; // [sp+28h] [bp-F0h]@32
  char v34; // [sp+3Eh] [bp-DAh]@12
  char v35; // [sp+3Fh] [bp-D9h]@11
  int v36; // [sp+40h] [bp-D8h]@1
  int v37; // [sp+44h] [bp-D4h]@9
  int v38; // [sp+48h] [bp-D0h]@11
  int v39; // [sp+4Ch] [bp-CCh]@3
  int v40; // [sp+50h] [bp-C8h]@9
  int v41; // [sp+54h] [bp-C4h]@9
  int v42; // [sp+58h] [bp-C0h]@9
  int v43; // [sp+5Ch] [bp-BCh]@9
  int v44; // [sp+60h] [bp-B8h]@9
  int v45; // [sp+64h] [bp-B4h]@9
  int v46; // [sp+68h] [bp-B0h]@9
  char v47; // [sp+6Ch] [bp-ACh]@9
  int v48; // [sp+70h] [bp-A8h]@9
  int v49; // [sp+74h] [bp-A4h]@9
  int v50; // [sp+78h] [bp-A0h]@9
  int v51; // [sp+E8h] [bp-30h]@9
  char v52; // [sp+ECh] [bp-2Ch]@9
  char v53; // [sp+EDh] [bp-2Bh]@9
  int v54; // [sp+F0h] [bp-28h]@9
  int v55; // [sp+F4h] [bp-24h]@9
  int v56; // [sp+F8h] [bp-20h]@9
  int v57; // [sp+FCh] [bp-1Ch]@9

  v3 = *(_DWORD *)(*(_DWORD *)a2 + 12);
  v36 = v3;
  if ( v3 )
  {
    _InterlockedIncrement((volatile signed __int32 *)(v3 + 4));
    v3 = v36;
  }
  sub_8060100((int)&v39, (int)a1, *(_DWORD *)(v3 + 8));
  v4 = v39;
  v5 = v39 == 0;
  if ( v39 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v39 + 4));
    if ( v5 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v4 + 4))(v4);
    if ( *(_BYTE *)(*(_DWORD *)a2 + 68) )
    {
      sub_8061B10(a1, a2);
    }
    else
    {
      v6 = v36;
      *(_DWORD *)(v6 + 76) += *(_DWORD *)(a2 + 8);
      *(_DWORD *)(v6 + 80) += *(_DWORD *)(a2 + 12);
      v7 = *(_BYTE *)(a2 + 5);
      if ( (unsigned __int8)sub_80945C0((int)&a1[14], a2) )
      {
        if ( v7 )
        {
          v39 = v36;
          if ( v36 )
            _InterlockedIncrement((volatile signed __int32 *)(v36 + 4));
          sub_8062970(a1, (int)&v39);
          v24 = v39;
          v25 = v39 == 0;
          if ( v39 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v39 + 4));
            if ( v25 )
              (*(void (__cdecl **)(int))(*(_DWORD *)v24 + 4))(v24);
          }
        }
      }
      else
      {
        if ( log_level <= 5 )
        {
          v8 = *(_DWORD *)(v36 + 8);
          std::ios_base::ios_base((std::ios_base *)&v50);
          v50 = (int)&unk_80CF5C8;
          v51 = 0;
          v52 = 0;
          v53 = 0;
          v54 = 0;
          v55 = 0;
          v56 = 0;
          v57 = 0;
          v9 = dword_80CF674;
          v39 = dword_80CF674;
          *(int *)((char *)&v39 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
          std::basic_ios<char,std::char_traits<char>>::init((char *)&v39 + *(_DWORD *)(v39 - 12), 0);
          v39 = (int)&unk_80CF5DC;
          v50 = (int)&unk_80CF5F0;
          v40 = (int)&unk_80CF7F0;
          v41 = 0;
          v42 = 0;
          v43 = 0;
          v44 = 0;
          v45 = 0;
          v46 = 0;
          std::locale::locale((std::locale *)&v47);
          v40 = (int)&unk_80CF588;
          v48 = 16;
          v49 = (int)&unk_80CF83C;
          std::basic_ios<char,std::char_traits<char>>::init(&v50, &v40);
          v10 = std::__ostream_insert<char,std::char_traits<char>>(
                  &v39,
                  &unk_80CF83C,
                  std::string::_Rep::_S_empty_rep_storage);
          std::__ostream_insert<char,std::char_traits<char>>(v10, 134978863, 5);
          v11 = std::ostream::_M_insert<unsigned long>(v10, v8);
          std::__ostream_insert<char,std::char_traits<char>>(v11, ": failed to send checklist report", 33);
          v37 = (int)&unk_80CF83C;
          v12 = *(_DWORD *)(v11 + 24);
          if ( v12 )
          {
            v13 = *(_DWORD *)(v11 + 16);
            LOBYTE(v31) = 0;
            if ( v12 <= (unsigned int)v13 )
            {
              v32 = &v35;
              v38 = std::string::_S_construct<char *>((int)&v39, v2, (void *)v9, *(_DWORD *)(v11 + 20), v13, (int)&v35);
              std::string::swap((std::string *)&v37, (std::string *)&v38);
            }
            else
            {
              v32 = &v35;
              v38 = std::string::_S_construct<char *>((int)&v39, v2, (void *)v9, *(_DWORD *)(v11 + 20), v12, (int)&v35);
              std::string::swap((std::string *)&v37, (std::string *)&v38);
            }
            std::string::_Rep::_M_dispose(v38 - 12, &v34);
          }
          else
          {
            v32 = &v35;
            std::string::assign((std::string *)&v37, (const std::string *)(v11 + 40));
          }
          v39 = (int)&unk_80CF5DC;
          v50 = (int)&unk_80CF5F0;
          v40 = (int)&unk_80CF588;
          v14 = v49 - 12;
          if ( (_DWORD *)(v49 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v30 = _InterlockedExchangeAdd((volatile signed __int32 *)(v49 - 4), 0xFFFFFFFF);
            }
            else
            {
              v30 = *(_DWORD *)(v49 - 4);
              *(_DWORD *)(v49 - 4) = v30 - 1;
            }
            if ( v30 <= 0 )
              std::string::_Rep::_M_destroy(v14, &v38);
          }
          v40 = (int)&unk_80CF7F0;
          std::locale::~locale((std::locale *)&v47);
          v39 = v9;
          *(int *)((char *)&v39 + *(_DWORD *)(v9 - 12)) = dword_80CF678;
          v50 = (int)&unk_80CF5C8;
          std::ios_base::~ios_base((std::ios_base *)&v50);
          if ( byte_80CE64C )
          {
            v15 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v37, *(_DWORD *)(v37 - 12));
            v16 = (std::ostream *)v15;
            v17 = *(_DWORD *)(*(_DWORD *)v15 - 12);
            v18 = *(_DWORD *)((char *)v16 + v17 + 124);
            if ( !v18 )
            {
              v29 = std::__throw_bad_cast();
              std::string::_Rep::_M_dispose(v37 - 12, &v39);
              sub_8056F10(v36);
              Unwind_Resume(v29);
            }
            if ( *(_BYTE *)(v18 + 28) )
            {
              v19 = *(_BYTE *)(v18 + 39);
            }
            else
            {
              std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v16 + v17 + 124));
              v19 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v18 + 24))(v18, 10);
            }
            v20 = (std::ostream *)std::ostream::put(v16, v19);
            std::ostream::flush(v20);
          }
          syslog(3, "%s", v37, v31, v32);
          v21 = v37 - 12;
          if ( (_DWORD *)(v37 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v28 = _InterlockedExchangeAdd((volatile signed __int32 *)(v37 - 4), 0xFFFFFFFF);
            }
            else
            {
              v28 = *(_DWORD *)(v37 - 4);
              *(_DWORD *)(v37 - 4) = v28 - 1;
            }
            if ( v28 <= 0 )
              std::string::_Rep::_M_destroy(v21, &v39);
          }
        }
        sub_80B2040(a1, *(_DWORD *)(v36 + 8));
        if ( sub_8060F60((int)a1, *(_DWORD *)(v36 + 8)) )
        {
          v26 = v36;
          v27 = *(_DWORD *)(v36 + 44);
          std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v33);
          *(_DWORD *)(v26 + 60) = (signed int)((long double)(v33 - *(_QWORD *)(v26 + 48)) / 1000000000.0) + v27;
          std::string::string(&v38, "failed to send checklist report", &v35);
          std::string::string(&v37, "FAILED", &v34);
          sub_80940A0((int)&a1[14], (int)&v36, (int)&v37, (int)&v38);
          std::string::_Rep::_M_dispose(v37 - 12, &v39);
          std::string::_Rep::_M_dispose(v38 - 12, &v39);
        }
      }
    }
  }
  result = v36;
  v23 = v36 == 0;
  if ( v36 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v36 + 4));
    if ( v23 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08064980) --------------------------------------------------------
int __cdecl sub_8064980(pthread_mutex_t *a1, int a2)
{
  unsigned int v2; // ebp@0
  int v3; // edi@2
  int v4; // ST18_4@2
  int v5; // ebx@2
  int v6; // ebx@2
  int v7; // eax@2
  int v8; // edx@2
  int v9; // ecx@3
  int v10; // eax@5
  int v11; // edx@5
  int v12; // eax@7
  std::ostream *v13; // edi@7
  int v14; // eax@7
  int v15; // ebx@7
  char v16; // al@9
  std::ostream *v17; // eax@10
  int v18; // edx@11
  int v19; // esi@12
  int v20; // ebx@12
  int v21; // eax@12
  int v22; // eax@13
  int v23; // ebx@14
  int v24; // edi@14
  int v25; // eax@16
  int v26; // edx@18
  int v27; // edx@22
  int v28; // eax@25
  int v29; // eax@27
  int v30; // edi@27
  int v31; // eax@27
  bool v32; // zf@27
  int v34; // ebx@33
  int v35; // eax@33
  int v36; // esi@34
  int v37; // edx@35
  int v38; // edx@36
  int v39; // edx@38
  signed __int32 v40; // ebx@40
  int v41; // ebx@43
  int v42; // esi@43
  int v43; // eax@43
  int v44; // eax@44
  int v45; // edx@46
  int v46; // eax@55
  char v47; // bl@55
  int v48; // eax@61
  int v49; // ebx@61
  signed __int32 v50; // eax@70
  signed __int32 v51; // eax@75
  signed __int32 v52; // ecx@78
  signed __int32 v53; // ecx@80
  signed __int32 v54; // ebx@85
  int v55; // ebx@90
  signed __int32 v56; // ecx@95
  signed __int32 v57; // ecx@98
  int v58; // [sp+Ch] [bp-FCh]@0
  __int64 v59; // [sp+28h] [bp-E0h]@12
  char v60; // [sp+32h] [bp-D6h]@4
  char v61; // [sp+33h] [bp-D5h]@4
  int v62; // [sp+34h] [bp-D4h]@2
  int v63; // [sp+38h] [bp-D0h]@4
  int v64; // [sp+3Ch] [bp-CCh]@2
  int v65; // [sp+40h] [bp-C8h]@2
  int (__cdecl *v66)(void **, void **, signed int); // [sp+44h] [bp-C4h]@2
  pthread_mutex_t *(__cdecl *v67)(int, int); // [sp+48h] [bp-C0h]@2
  int v68; // [sp+4Ch] [bp-BCh]@2
  int v69; // [sp+50h] [bp-B8h]@2
  int v70; // [sp+54h] [bp-B4h]@2
  int v71; // [sp+58h] [bp-B0h]@2
  char v72; // [sp+5Ch] [bp-ACh]@2
  int v73; // [sp+60h] [bp-A8h]@2
  int v74; // [sp+64h] [bp-A4h]@2
  int v75; // [sp+68h] [bp-A0h]@2
  int v76; // [sp+D8h] [bp-30h]@2
  char v77; // [sp+DCh] [bp-2Ch]@2
  char v78; // [sp+DDh] [bp-2Bh]@2
  int v79; // [sp+E0h] [bp-28h]@2
  int v80; // [sp+E4h] [bp-24h]@2
  int v81; // [sp+E8h] [bp-20h]@2
  int v82; // [sp+ECh] [bp-1Ch]@2

  if ( log_level <= 3 )
  {
    v3 = *(_DWORD *)a2;
    v4 = *(_DWORD *)(*(_DWORD *)a2 + 8);
    std::ios_base::ios_base((std::ios_base *)&v75);
    v75 = (int)&unk_80CF5C8;
    v76 = 0;
    v77 = 0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v81 = 0;
    v82 = 0;
    v64 = dword_80CF674;
    *(int *)((char *)&v64 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v64 + *(_DWORD *)(v64 - 12), 0);
    v64 = (int)&unk_80CF5DC;
    v75 = (int)&unk_80CF5F0;
    v65 = (int)&unk_80CF7F0;
    v66 = 0;
    v67 = 0;
    v68 = 0;
    v69 = 0;
    v70 = 0;
    v71 = 0;
    std::locale::locale((std::locale *)&v72);
    v65 = (int)&unk_80CF588;
    v73 = 16;
    v74 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v75, &v65);
    v5 = std::__ostream_insert<char,std::char_traits<char>>(&v64, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v5, "starting task: ", 15);
    v6 = std::ostream::_M_insert<unsigned long>(v5, v4);
    std::__ostream_insert<char,std::char_traits<char>>(v6, " ", 1);
    v7 = std::__ostream_insert<char,std::char_traits<char>>(
           v6,
           *(_DWORD *)(v3 + 28),
           *(_DWORD *)(*(_DWORD *)(v3 + 28) - 12));
    v62 = (int)&unk_80CF83C;
    v8 = *(_DWORD *)(v7 + 24);
    if ( v8 )
    {
      v9 = *(_DWORD *)(v7 + 16);
      LOBYTE(v58) = 0;
      if ( v8 <= (unsigned int)v9 )
      {
        v63 = std::string::_S_construct<char *>(v6, v2, &v61, *(_DWORD *)(v7 + 20), v9, (int)&v61);
        std::string::swap((std::string *)&v62, (std::string *)&v63);
        v39 = v63 - 12;
        if ( (_DWORD *)(v63 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v63 - 4), 0xFFFFFFFF);
          }
          else
          {
            v40 = *(_DWORD *)(v63 - 4);
            *(_DWORD *)(v63 - 4) = v40 - 1;
          }
          if ( v40 <= 0 )
            std::string::_Rep::_M_destroy(v39, &v60);
        }
      }
      else
      {
        v63 = std::string::_S_construct<char *>(v6, v2, &v61, *(_DWORD *)(v7 + 20), v8, (int)&v61);
        std::string::swap((std::string *)&v62, (std::string *)&v63);
        std::string::_Rep::_M_dispose(v63 - 12, &v60);
      }
    }
    else
    {
      std::string::assign((std::string *)&v62, (const std::string *)(v7 + 40));
    }
    v64 = (int)&unk_80CF5DC;
    v75 = (int)&unk_80CF5F0;
    v65 = (int)&unk_80CF588;
    v10 = v74;
    v11 = v74 - 12;
    if ( (_DWORD *)(v74 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v54 = _InterlockedExchangeAdd((volatile signed __int32 *)(v74 - 4), 0xFFFFFFFF);
        goto LABEL_86;
      }
      goto LABEL_89;
    }
    while ( 1 )
    {
      v65 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v72);
      v64 = dword_80CF674;
      *(int *)((char *)&v64 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v75 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v75);
      if ( !byte_80CE64C )
        break;
      v12 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v62, *(_DWORD *)(v62 - 12));
      v13 = (std::ostream *)v12;
      v14 = *(_DWORD *)(*(_DWORD *)v12 - 12);
      v15 = *(_DWORD *)((char *)v13 + v14 + 124);
      if ( v15 )
      {
        if ( *(_BYTE *)(v15 + 28) )
        {
          v16 = *(_BYTE *)(v15 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v13 + v14 + 124));
          v16 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v15 + 24))(v15, 10);
        }
        v17 = (std::ostream *)std::ostream::put(v13, v16);
        std::ostream::flush(v17);
        break;
      }
      v10 = std::__throw_bad_cast();
LABEL_89:
      v54 = *(_DWORD *)(v10 - 4);
      *(_DWORD *)(v10 - 4) = v54 - 1;
LABEL_86:
      if ( v54 <= 0 )
        std::string::_Rep::_M_destroy(v11, &v63);
    }
    syslog(5, "%s", v62, v58);
    v18 = v62 - 12;
    if ( (_DWORD *)(v62 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v56 = _InterlockedExchangeAdd((volatile signed __int32 *)(v62 - 4), 0xFFFFFFFF);
      }
      else
      {
        v56 = *(_DWORD *)(v62 - 4);
        *(_DWORD *)(v62 - 4) = v56 - 1;
      }
      if ( v56 <= 0 )
        std::string::_Rep::_M_destroy(v18, &v64);
    }
  }
  v19 = *(_DWORD *)a2;
  v20 = *(_DWORD *)(*(_DWORD *)a2 + 44);
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v59);
  *(_DWORD *)(v19 + 56) = (signed int)((long double)(v59 - *(_QWORD *)(v19 + 48)) / 1000000000.0) + v20;
  v21 = *(_DWORD *)a2;
  if ( !*(_DWORD *)(*(_DWORD *)(*(_DWORD *)a2 + 28) - 12) )
  {
    v22 = *(_DWORD *)(v21 + 64);
    if ( v22 )
    {
      v23 = *(_DWORD *)v22;
      v24 = *(_DWORD *)(v22 + 4);
      if ( *(_DWORD *)v22 != v24 )
      {
        do
        {
          sub_80A6950((int)&v64, (int *)(v23 + 16));
          sub_80A6870(v23 + 20, (int)&v64);
          sub_80A6820(&v64);
          sub_80A6950((int)&v64, (int *)(v23 + 28));
          sub_80A6870(v23 + 32, (int)&v64);
          sub_80A6820(&v64);
          v23 += 36;
        }
        while ( v24 != v23 );
      }
    }
    v25 = a1[15].__lock;
    if ( v25 == a1[15].__count )
    {
      sub_8068630((int)&a1[14].__spins, a2);
    }
    else
    {
      if ( v25 )
      {
        v26 = *(_DWORD *)a2;
        *(_DWORD *)v25 = *(_DWORD *)a2;
        if ( v26 )
          _InterlockedIncrement((volatile signed __int32 *)(v26 + 4));
        v25 = a1[15].__lock;
      }
      a1[15].__lock = v25 + 4;
    }
    v66 = 0;
    std::string::string(&v63, "RUNNING", &v61);
    sub_8093CA0((int)&a1[14], a2, (int)&v63, (int)&v64);
    v27 = v63 - 12;
    if ( (_DWORD *)(v63 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v53 = _InterlockedExchangeAdd((volatile signed __int32 *)(v63 - 4), 0xFFFFFFFF);
      }
      else
      {
        v53 = *(_DWORD *)(v63 - 4);
        *(_DWORD *)(v63 - 4) = v53 - 1;
      }
      if ( v53 <= 0 )
        std::string::_Rep::_M_destroy(v27, &v62);
    }
    if ( v66 )
      v66((void **)&v64, (void **)&v64, 3);
    v28 = *(_DWORD *)a2;
    v64 = v28;
    if ( v28 )
      _InterlockedIncrement((volatile signed __int32 *)(v28 + 4));
    LOBYTE(v29) = sub_8062970(a1, (int)&v64);
    v30 = v29;
    v31 = v64;
    v32 = v64 == 0;
    if ( v64 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v64 + 4));
      if ( v32 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v31 + 4))(v31);
    }
    return v30;
  }
  if ( !std::string::compare((std::string *)(v21 + 28), "tunnel_on") )
  {
    v41 = *(_DWORD *)a2;
    v42 = atoi(*(const char **)(*(_DWORD *)a2 + 32));
    v43 = atoi(*(const char **)(v41 + 36));
    v30 = start_tunel((int)a1, a2, v42, v43);
    if ( (_BYTE)v30 )
    {
      v44 = a1[15].__lock;
      if ( v44 == a1[15].__count )
      {
        sub_8068630((int)&a1[14].__spins, a2);
      }
      else
      {
        if ( v44 )
        {
          v45 = *(_DWORD *)a2;
          *(_DWORD *)v44 = *(_DWORD *)a2;
          if ( v45 )
            _InterlockedIncrement((volatile signed __int32 *)(v45 + 4));
          v44 = a1[15].__lock;
        }
        a1[15].__lock = v44 + 4;
      }
      v66 = 0;
      std::string::string(&v63, "RUNNING", &v61);
      sub_8093CA0((int)&a1[14], a2, (int)&v63, (int)&v64);
      std::string::_Rep::_M_dispose(v63 - 12, &v62);
      if ( v66 )
        v66((void **)&v64, (void **)&v64, 3);
      return v30;
    }
LABEL_34:
    v36 = (int)&v64;
    goto LABEL_35;
  }
  if ( !std::string::compare((std::string *)(*(_DWORD *)a2 + 28), "traceroute") )
  {
    v34 = *(_DWORD *)a2;
    v35 = atoi(*(const char **)(*(_DWORD *)a2 + 36));
    v30 = start_trace((int)a1, a2, v34 + 32, v35);
    if ( (_BYTE)v30 )
    {
      sub_8068750((int)&a1[14].__spins, a2);
      v66 = 0;
      std::string::string(&v63, "RUNNING", &v61);
      sub_8093CA0((int)&a1[14], a2, (int)&v63, (int)&v64);
      std::string::_Rep::_M_dispose(v63 - 12, &v62);
      if ( v66 )
        v66((void **)&v64, (void **)&v64, 3);
      return v30;
    }
    goto LABEL_34;
  }
  if ( !std::string::compare((std::string *)(*(_DWORD *)a2 + 28), "restart") )
  {
    v55 = *(_DWORD *)a2;
    *(_DWORD *)(v55 + 60) = sub_8067CC0(*(_DWORD *)a2);
    v66 = 0;
    std::string::string(&v63, "FINISHED", &v61);
    sub_8093CA0((int)&a1[14], a2, (int)&v63, (int)&v64);
    std::string::_Rep::_M_dispose(v63 - 12, &v62);
    if ( v66 )
      v66((void **)&v64, (void **)&v64, 3);
    execl("/sbin/reboot", "reboot", 0, 0);
    sub_8060390((int)a1);
  }
  if ( !std::string::compare((std::string *)(*(_DWORD *)a2 + 28), "log1") )
  {
    v48 = atoi(*(const char **)(*(_DWORD *)a2 + 32));
    sub_809C930((std::string *)&v62, v48);
    sub_8094730((int)&a1[14], a2, (int)&v62);
    v49 = *(_DWORD *)a2;
    *(_DWORD *)(v49 + 60) = sub_8067CC0(*(_DWORD *)a2);
    v66 = 0;
    std::string::string(&v63, "FINISHED", &v60);
    sub_8093CA0((int)&a1[14], a2, (int)&v63, (int)&v64);
    std::string::_Rep::_M_dispose(v63 - 12, &v61);
    if ( v66 )
      v66((void **)&v64, (void **)&v64, 3);
    std::string::_Rep::_M_dispose(v62 - 12, &v64);
    return 1;
  }
  v66 = 0;
  v46 = operator new(4u);
  *(_DWORD *)v46 = a1;
  v64 = v46;
  v67 = sub_80604C0;
  v66 = sub_805FF20;
  v36 = (int)&v64;
  v47 = sub_80B3E80((int)a1, a2, (int)&v64);
  if ( v66 )
    v66((void **)&v64, (void **)&v64, 3);
  if ( v47 )
  {
    sub_8068750((int)&a1[14].__spins, a2);
    v66 = 0;
    std::string::string(&v63, "RUNNING", &v61);
    sub_8093CA0((int)&a1[14], a2, (int)&v63, (int)&v64);
    std::string::_Rep::_M_dispose(v63 - 12, &v62);
    if ( v66 )
      v66((void **)&v64, (void **)&v64, 3);
    return 1;
  }
LABEL_35:
  std::string::string(v36, "Unsupported command", &v61);
  std::string::string(&v63, "FAILED", &v60);
  sub_80940A0((int)&a1[14], a2, (int)&v63, v36);
  v37 = v63 - 12;
  if ( (_DWORD *)(v63 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v51 = _InterlockedExchangeAdd((volatile signed __int32 *)(v63 - 4), 0xFFFFFFFF);
    }
    else
    {
      v52 = *(_DWORD *)(v63 - 4);
      *(_DWORD *)(v63 - 4) = v52 - 1;
      v51 = v52;
    }
    if ( v51 <= 0 )
      std::string::_Rep::_M_destroy(v37, &v62);
  }
  v38 = v64 - 12;
  if ( (_DWORD *)(v64 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v50 = _InterlockedExchangeAdd((volatile signed __int32 *)(v64 - 4), 0xFFFFFFFF);
    }
    else
    {
      v57 = *(_DWORD *)(v64 - 4);
      *(_DWORD *)(v64 - 4) = v57 - 1;
      v50 = v57;
    }
    if ( v50 <= 0 )
      std::string::_Rep::_M_destroy(v38, &v63);
  }
  return 0;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08065A60) --------------------------------------------------------
void __cdecl sub_8065A60(pthread_mutex_t *a1)
{
  int v1; // ebx@1
  int v2; // eax@5
  bool v3; // zf@5
  int v4; // esi@14
  int v5; // ST24_4@14
  void *v6; // ebx@18
  int v7; // eax@19
  bool v8; // zf@19
  int v9; // eax@27
  int v10; // eax@29
  bool v11; // zf@29
  void *v12; // esi@2
  signed __int32 v13; // eax@38
  signed __int32 v14; // eax@42
  signed __int32 v15; // ecx@45
  signed __int32 v16; // ecx@46
  int v17; // [sp+1Ch] [bp-6Ch]@1
  int v18; // [sp+20h] [bp-68h]@14
  int v19; // [sp+20h] [bp-68h]@32
  void *v20; // [sp+24h] [bp-64h]@1
  __int64 v21; // [sp+38h] [bp-50h]@14
  char v22; // [sp+4Ah] [bp-3Eh]@32
  char v23; // [sp+4Bh] [bp-3Dh]@14
  int v24; // [sp+4Ch] [bp-3Ch]@32
  int v25; // [sp+50h] [bp-38h]@3
  void *v26; // [sp+54h] [bp-34h]@1
  void *v27; // [sp+58h] [bp-30h]@1
  int v28; // [sp+60h] [bp-28h]@14
  void (__cdecl *v29)(int *, int *, signed int); // [sp+68h] [bp-20h]@14

  v17 = (int)&a1[14].__lock;
  sub_8093670((int)&v26, (int)&a1[14], (int)&a1[14].__spins);
  v1 = (int)v26;
  v20 = v27;
  if ( v26 == v27 )
  {
    v12 = v26;
    goto LABEL_24;
  }
  do
  {
    while ( 1 )
    {
      if ( !std::string::compare((std::string *)(*(_DWORD *)v1 + 24), "CREATED")
        || !std::string::compare((std::string *)(*(_DWORD *)v1 + 24), "RUNNING") )
      {
        sub_8060100((int)&v25, (int)a1, *(_DWORD *)(*(_DWORD *)v1 + 8));
        if ( v25 )
        {
          if ( std::string::compare((std::string *)(*(_DWORD *)v1 + 24), "RUNNING") )
          {
            v29 = 0;
            std::string::string(&v24, "RUNNING", &v22);
            sub_8093CA0(v17, (int)&v25, (int)&v24, (int)&v28);
            v19 = v24 - 12;
            if ( (_DWORD *)(v24 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v14 = _InterlockedExchangeAdd((volatile signed __int32 *)(v24 - 4), 0xFFFFFFFF);
              }
              else
              {
                v16 = *(_DWORD *)(v24 - 4);
                *(_DWORD *)(v24 - 4) = v16 - 1;
                v14 = v16;
              }
              if ( v14 <= 0 )
                std::string::_Rep::_M_destroy(v19, &v23);
            }
            if ( v29 )
              v29(&v28, &v28, 3);
          }
        }
        else
        {
          v9 = *(_DWORD *)v1;
          v28 = v9;
          if ( v9 )
            _InterlockedIncrement((volatile signed __int32 *)(v9 + 4));
          sub_8064980(a1, (int)&v28);
          v10 = v28;
          v11 = v28 == 0;
          if ( v28 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v28 + 4));
            if ( v11 )
              (*(void (__cdecl **)(int))(*(_DWORD *)v10 + 4))(v10);
          }
        }
        v2 = v25;
        v3 = v25 == 0;
        if ( v25 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v25 + 4));
          if ( v3 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v2 + 4))(v2);
        }
        goto LABEL_8;
      }
      if ( !std::string::compare((std::string *)(*(_DWORD *)v1 + 24), "CANCEL") )
        break;
LABEL_8:
      v1 += 4;
      if ( v20 == (void *)v1 )
        goto LABEL_18;
    }
    if ( std::string::compare((std::string *)(*(_DWORD *)v1 + 28), "tunnel_on")
      && std::string::compare((std::string *)(*(_DWORD *)v1 + 28), "traceroute") )
      sub_80B2040(a1, *(_DWORD *)(*(_DWORD *)v1 + 8));
    else
      sub_80A1710((int)&a1[15].__owner, *(_DWORD *)(*(_DWORD *)v1 + 8));
    v4 = *(_DWORD *)(*(_DWORD *)v1 + 44);
    v5 = *(_DWORD *)v1;
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v21);
    *(_DWORD *)(v5 + 60) = (signed int)((long double)(v21 - *(_QWORD *)(v5 + 48)) / 1000000000.0) + v4;
    v29 = 0;
    std::string::string(&v25, "CANCELLED", &v23);
    sub_8093CA0(v17, v1, (int)&v25, (int)&v28);
    v18 = v25 - 12;
    if ( (_DWORD *)(v25 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v13 = _InterlockedExchangeAdd((volatile signed __int32 *)(v25 - 4), 0xFFFFFFFF);
      }
      else
      {
        v15 = *(_DWORD *)(v25 - 4);
        *(_DWORD *)(v25 - 4) = v15 - 1;
        v13 = v15;
      }
      if ( v13 <= 0 )
        std::string::_Rep::_M_destroy(v18, &v24);
    }
    if ( v29 )
      v29(&v28, &v28, 3);
    sub_8060F60((int)a1, *(_DWORD *)(*(_DWORD *)v1 + 8));
    v1 += 4;
  }
  while ( v20 != (void *)v1 );
LABEL_18:
  v12 = v27;
  v6 = v26;
  if ( v27 != v26 )
  {
    do
    {
      v7 = *(_DWORD *)v6;
      v8 = *(_DWORD *)v6 == 0;
      if ( *(_DWORD *)v6 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v7 + 4));
        if ( v8 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v7 + 4))(v7);
      }
      v6 = (char *)v6 + 4;
    }
    while ( v12 != v6 );
    v12 = v26;
  }
LABEL_24:
  if ( v12 )
    operator delete(v12);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08065EF0) --------------------------------------------------------
char __cdecl sub_8065EF0(pthread_mutex_t *a1)
{
  __int64 v1; // kr00_8@1
  char result; // al@2
  signed int v3; // ebx@3
  __int64 v4; // kr08_8@3
  signed int v5; // ebx@6
  int v6; // edi@6
  unsigned int v7; // esi@6
  signed int v8; // ebx@9
  int v9; // eax@13
  __int32 v10; // esi@14
  __time_t v11; // ebx@14
  int v12; // eax@15
  int v13; // eax@23
  int v14; // eax@26
  int v15; // eax@28
  int v16; // eax@31
  void *v17; // esi@34
  void *v18; // ebx@34
  int v19; // eax@36
  int v20; // edx@36
  void *v21; // esi@41
  void *v22; // ebx@41
  int v23; // eax@43
  int v24; // edx@43
  int v25; // eax@48
  int v26; // edx@48
  int v27; // eax@49
  int v28; // eax@54
  __int32 v29; // edi@56
  int v30; // eax@56
  int v31; // eax@59
  int v32; // eax@64
  int v33; // edx@64
  void *v34; // esi@69
  void *v35; // ebx@69
  int v36; // eax@71
  int v37; // edx@71
  int v38; // eax@76
  int v39; // edx@76
  int v40; // eax@77
  int v41; // eax@82
  bool v42; // zf@82
  __time_t v43; // ebx@89
  int v44; // eax@90
  int v45; // eax@95
  int v46; // eax@97
  bool v47; // zf@97
  int v48; // eax@104
  __int32 v49; // ebx@105
  __time_t v50; // esi@105
  int v51; // eax@106
  bool v52; // zf@106
  signed __int32 v53; // eax@118
  signed __int32 v54; // eax@122
  signed __int32 v55; // eax@126
  signed __int32 v56; // eax@130
  int v57; // eax@136
  int v58; // eax@136
  int v59; // ebx@145
  int v60; // ebx@149
  int v61; // eax@151
  signed __int32 v62; // ecx@152
  signed __int32 v63; // eax@154
  signed __int32 v64; // ebx@159
  signed __int32 v65; // ecx@163
  signed __int32 v66; // ebx@165
  signed __int32 v67; // ecx@168
  signed __int32 v68; // ebx@170
  signed __int32 v69; // ecx@175
  signed __int32 v70; // eax@177
  signed __int32 v71; // ebx@181
  int v72; // [sp-8h] [bp-170h]@6
  __int64 v73; // [sp+20h] [bp-148h]@1
  char *v74; // [sp+2Ch] [bp-13Ch]@1
  unsigned __int64 v75; // [sp+30h] [bp-138h]@1
  __int64 v76; // [sp+38h] [bp-130h]@1
  int v77; // [sp+40h] [bp-128h]@1
  void *v78; // [sp+44h] [bp-124h]@0
  __time_t v79; // [sp+48h] [bp-120h]@0
  __time_t v80; // [sp+4Ch] [bp-11Ch]@0
  __time_t v81; // [sp+50h] [bp-118h]@0
  int v82; // [sp+54h] [bp-114h]@0
  int v83; // [sp+58h] [bp-110h]@0
  int v84; // [sp+5Ch] [bp-10Ch]@0
  int v85; // [sp+60h] [bp-108h]@0
  void *v86; // [sp+64h] [bp-104h]@0
  int v87; // [sp+68h] [bp-100h]@0
  int v88; // [sp+6Ch] [bp-FCh]@0
  int v89; // [sp+70h] [bp-F8h]@0
  int v90; // [sp+74h] [bp-F4h]@0
  int v91; // [sp+78h] [bp-F0h]@0
  __int64 v92; // [sp+88h] [bp-E0h]@1
  int v93; // [sp+90h] [bp-D8h]@95
  pthread_mutex_t *mutex; // [sp+94h] [bp-D4h]@1
  char v95; // [sp+98h] [bp-D0h]@11
  struct timespec abstime; // [sp+9Ch] [bp-CCh]@1
  int v97; // [sp+A4h] [bp-C4h]@15

  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v92);
  v1 = v92;
  v73 = v92;
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v92);
  v76 = v92;
  sub_80A6280((int)&unk_80CF8A0);
  v77 = (int)&a1[14].__lock;
  sub_8093380((int)&abstime, (int)&a1[14]);
  std::string::_Rep::_M_dispose(abstime.tv_nsec - 12, &mutex);
  v74 = &a1[16].__size[8];
  v75 = 0LL;
  while ( 1 )
  {
    result = *v74;
    if ( !*v74 )
      return result;
    v3 = dword_80CE680;
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v92);
    v4 = v92;
    if ( !v76 || (long double)v3 <= (long double)(v92 - v76) / 1000000000.0 )
    {
      sub_80A6280((int)&unk_80CF8A0);
      sub_8094890(v77, (int)&unk_80CF8A0);
      v76 = v4;
    }
    v5 = dword_80CE684;
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v92);
    v6 = HIDWORD(v92);
    v7 = v92;
    if ( !v75 || (long double)v5 <= (long double)(signed __int64)(v92 - v75) / 1000000000.0 )
    {
      sub_8065A60(a1);
      v75 = __PAIR__(v6, v7);
    }
    v8 = terminate_timeout;
    if ( terminate_timeout > 0 && a1[15].__lock == a1[14].__spins )
    {
      std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v92);
      v6 = v1 | HIDWORD(v1);
      if ( !v1 || (long double)v8 <= (long double)(v92 - v73) / 1000000000.0 )
        break;
    }
    sub_80A1770((int)&a1[15].__owner);
    mutex = (pthread_mutex_t *)((char *)a1 + 396);
    v95 = 0;
    if ( a1 == (pthread_mutex_t *)-396 )
    {
      v9 = std::__throw_system_error(1);
LABEL_158:
      v25 = std::__throw_system_error(v9);
LABEL_159:
      v64 = *(_DWORD *)(v25 - 4);
      *(_DWORD *)(v25 - 4) = v64 - 1;
      v63 = v64;
LABEL_155:
      if ( v63 <= 0 )
        std::string::_Rep::_M_destroy(v26, &v93);
      while ( 1 )
      {
        v27 = *(_DWORD *)(v6 + v85);
        if ( (_DWORD *)(v27 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v68 = _InterlockedExchangeAdd((volatile signed __int32 *)(v27 - 4), 0xFFFFFFFF);
          }
          else
          {
            v68 = *(_DWORD *)(v27 - 4);
            *(_DWORD *)(v27 - 4) = v68 - 1;
          }
          if ( v68 <= 0 )
            std::string::_Rep::_M_destroy(v27 - 12, &v93);
        }
        v91 += 64;
        v88 += 64;
        v89 += 64;
        if ( v86 == (void *)v91 )
          break;
LABEL_28:
        v6 = v91 - v90;
        v15 = *(_DWORD *)(v91 - v90 + v82);
        if ( v15 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v15 + 4));
          if ( !v15 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v16 = *(_DWORD *)(v6 + v83);
        if ( v16 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v16 + 4));
          if ( !v16 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v17 = *(void **)v89;
        v18 = *(void **)(v89 - 4);
        if ( *(void **)v89 != v18 )
        {
          v87 = v91 - v90;
          do
          {
            v19 = *(_DWORD *)v18;
            v20 = *(_DWORD *)v18 - 12;
            if ( (_DWORD *)v20 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v54 = _InterlockedExchangeAdd((volatile signed __int32 *)(v19 - 4), 0xFFFFFFFF);
              }
              else
              {
                v67 = *(_DWORD *)(v19 - 4);
                *(_DWORD *)(v19 - 4) = v67 - 1;
                v54 = v67;
              }
              if ( v54 <= 0 )
                std::string::_Rep::_M_destroy(v20, &v93);
            }
            v18 = (char *)v18 + 4;
          }
          while ( v17 != v18 );
          v17 = *(void **)(v91 + 44);
        }
        if ( v17 )
          operator delete(v17);
        v21 = *(void **)v88;
        v22 = *(void **)(v88 - 4);
        if ( *(void **)v88 != v22 )
        {
          v87 = v91 - v90;
          do
          {
            v23 = *(_DWORD *)v22;
            v24 = *(_DWORD *)v22 - 12;
            if ( (_DWORD *)v24 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v56 = _InterlockedExchangeAdd((volatile signed __int32 *)(v23 - 4), 0xFFFFFFFF);
              }
              else
              {
                v62 = *(_DWORD *)(v23 - 4);
                *(_DWORD *)(v23 - 4) = v62 - 1;
                v56 = v62;
              }
              if ( v56 <= 0 )
                std::string::_Rep::_M_destroy(v24, &v93);
            }
            v22 = (char *)v22 + 4;
          }
          while ( v21 != v22 );
          v21 = *(void **)(v91 + 24);
        }
        if ( v21 )
          operator delete(v21);
        v25 = *(_DWORD *)(v6 + v84);
        v26 = v25 - 12;
        if ( (_DWORD *)(v25 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( !&_pthread_key_create )
            goto LABEL_159;
          v63 = _InterlockedExchangeAdd((volatile signed __int32 *)(v25 - 4), 0xFFFFFFFF);
          goto LABEL_155;
        }
      }
      v86 = *(void **)(v81 + 28);
      while ( 1 )
      {
        if ( v86 )
          operator delete(v86);
        v86 = *(void **)v79;
        v28 = *(_DWORD *)(v79 - 4);
        v90 = v28;
        if ( *(_DWORD *)v79 != v28 )
        {
          v88 = v28 + 28;
          v89 = v28 + 48;
          v91 = *(_DWORD *)(v79 - 4);
          v82 = v28 + 60;
          v83 = v28 + 56;
          v84 = v28 + 20;
          v85 = v28 + 8;
          goto LABEL_56;
        }
LABEL_80:
        if ( v86 )
          operator delete(v86);
        v41 = *(_DWORD *)v81;
        v42 = *(_DWORD *)v81 == 0;
        if ( *(_DWORD *)v81 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v41 + 4));
          if ( v42 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v41 + 4))(v41);
        }
        v81 += 44;
        v80 += 44;
        v79 += 44;
        if ( v78 == (void *)v81 )
          break;
LABEL_26:
        v86 = *(void **)v80;
        v14 = *(_DWORD *)(v80 - 4);
        v90 = v14;
        if ( *(_DWORD *)v80 != v14 )
        {
          v88 = v14 + 28;
          v89 = v14 + 48;
          v91 = *(_DWORD *)(v80 - 4);
          v82 = v14 + 60;
          v83 = v14 + 56;
          v84 = v14 + 20;
          v85 = v14 + 8;
          goto LABEL_28;
        }
      }
      v78 = (void *)abstime.tv_sec;
      goto LABEL_87;
    }
    if ( &_pthread_key_create )
    {
      v9 = pthread_mutex_lock((pthread_mutex_t *)((char *)a1 + 396));
      if ( v9 )
        goto LABEL_158;
    }
    v95 = 1;
    v10 = a1[20].__count;
    v11 = a1[20].__lock;
    if ( v10 == v11 )
      goto LABEL_89;
    a1[20].__lock = 0;
    abstime.tv_sec = v11;
    a1[20].__count = 0;
    abstime.tv_nsec = v10;
    v12 = a1[20].__owner;
    a1[20].__owner = 0;
    v97 = v12;
    if ( !mutex )
      goto LABEL_184;
    if ( &_pthread_key_create )
    {
      pthread_mutex_unlock(mutex);
      v11 = abstime.tv_sec;
      v10 = abstime.tv_nsec;
    }
    v95 = 0;
    if ( v11 != v10 )
    {
LABEL_184:
      do
      {
        sub_8064190(a1, v11);
        v11 += 44;
      }
      while ( v10 != v11 );
    }
    if ( !mutex )
    {
      v13 = std::__throw_system_error(1);
LABEL_162:
      v32 = std::__throw_system_error(v13);
LABEL_163:
      v65 = *(_DWORD *)(v32 - 4);
      *(_DWORD *)(v32 - 4) = v65 - 1;
      v55 = v65;
LABEL_127:
      if ( v55 <= 0 )
        std::string::_Rep::_M_destroy(v33, &v93);
      while ( 1 )
      {
        v11 += 4;
        if ( v10 == v11 )
          break;
LABEL_64:
        v32 = *(_DWORD *)v11;
        v33 = *(_DWORD *)v11 - 12;
        if ( (_DWORD *)v33 != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( !&_pthread_key_create )
            goto LABEL_163;
          v55 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
          goto LABEL_127;
        }
      }
      v29 = v87;
      v10 = *(_DWORD *)(v90 + v87 + 44);
      while ( 1 )
      {
        if ( v10 )
          operator delete((void *)v10);
        v34 = *(void **)v88;
        v35 = *(void **)(v88 - 4);
        if ( *(void **)v88 != v35 )
        {
          v87 = v29;
          do
          {
            v36 = *(_DWORD *)v35;
            v37 = *(_DWORD *)v35 - 12;
            if ( (_DWORD *)v37 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v53 = _InterlockedExchangeAdd((volatile signed __int32 *)(v36 - 4), 0xFFFFFFFF);
              }
              else
              {
                v69 = *(_DWORD *)(v36 - 4);
                *(_DWORD *)(v36 - 4) = v69 - 1;
                v53 = v69;
              }
              if ( v53 <= 0 )
                std::string::_Rep::_M_destroy(v37, &v93);
            }
            v35 = (char *)v35 + 4;
          }
          while ( v34 != v35 );
          v34 = *(void **)(v90 + v29 + 24);
        }
        if ( v34 )
          operator delete(v34);
        v38 = *(_DWORD *)(v29 + v84);
        v39 = v38 - 12;
        if ( (_DWORD *)(v38 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          break;
LABEL_77:
        v40 = *(_DWORD *)(v29 + v85);
        if ( (_DWORD *)(v40 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v66 = _InterlockedExchangeAdd((volatile signed __int32 *)(v40 - 4), 0xFFFFFFFF);
          }
          else
          {
            v66 = *(_DWORD *)(v40 - 4);
            *(_DWORD *)(v40 - 4) = v66 - 1;
          }
          if ( v66 <= 0 )
            std::string::_Rep::_M_destroy(v40 - 12, &v93);
        }
        v91 += 64;
        v88 += 64;
        v89 += 64;
        if ( v86 == (void *)v91 )
        {
          v86 = *(void **)(v81 + 16);
          goto LABEL_80;
        }
LABEL_56:
        v29 = v91 - v90;
        v30 = *(_DWORD *)(v91 - v90 + v82);
        if ( v30 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v30 + 4));
          if ( !v30 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v31 = *(_DWORD *)(v29 + v83);
        if ( v31 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v31 + 4));
          if ( !v31 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v10 = *(_DWORD *)v89;
        v11 = *(_DWORD *)(v89 - 4);
        if ( *(_DWORD *)v89 != v11 )
        {
          v87 = v91 - v90;
          goto LABEL_64;
        }
      }
      if ( &_pthread_key_create )
      {
        v70 = _InterlockedExchangeAdd((volatile signed __int32 *)(v38 - 4), 0xFFFFFFFF);
        goto LABEL_178;
      }
LABEL_181:
      v71 = *(_DWORD *)(v38 - 4);
      *(_DWORD *)(v38 - 4) = v71 - 1;
      v70 = v71;
LABEL_178:
      if ( v70 <= 0 )
        std::string::_Rep::_M_destroy(v39, &v93);
      goto LABEL_77;
    }
    if ( v95 )
    {
      v59 = std::__throw_system_error(35);
      sub_8067F60((int)&abstime);
      goto LABEL_146;
    }
    if ( &_pthread_key_create )
    {
      v13 = pthread_mutex_lock(mutex);
      if ( v13 )
        goto LABEL_162;
    }
    v95 = 1;
    v78 = (void *)abstime.tv_nsec;
    if ( abstime.tv_nsec != abstime.tv_sec )
    {
      v80 = abstime.tv_sec + 32;
      v79 = abstime.tv_sec + 20;
      v81 = abstime.tv_sec;
      goto LABEL_26;
    }
LABEL_87:
    if ( v78 )
      operator delete(v78);
LABEL_89:
    v29 = a1[19].__nusers;
    v43 = a1[19].__kind;
    if ( v29 != v43 )
    {
      a1[19].__kind = 0;
      abstime.tv_sec = v43;
      a1[19].__nusers = 0;
      abstime.tv_nsec = v29;
      v44 = a1[19].__spins;
      a1[19].__spins = 0;
      v97 = v44;
      if ( !v95 )
      {
        v38 = std::__throw_system_error(1);
        goto LABEL_181;
      }
      if ( !mutex )
        goto LABEL_185;
      if ( &_pthread_key_create )
      {
        pthread_mutex_unlock(mutex);
        v43 = abstime.tv_sec;
        v29 = abstime.tv_nsec;
      }
      v95 = 0;
      if ( v43 != v29 )
      {
LABEL_185:
        do
        {
          v45 = *(_DWORD *)v43;
          v93 = v45;
          if ( v45 )
            _InterlockedIncrement((volatile signed __int32 *)(v45 + 4));
          sub_8061500((int)a1, (int)&v93);
          v46 = v93;
          v47 = v93 == 0;
          if ( v93 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v93 + 4));
            if ( v47 )
              (*(void (__cdecl **)(int))(*(_DWORD *)v46 + 4))(v46);
          }
          v43 += 4;
        }
        while ( v29 != v43 );
      }
      if ( !mutex )
        goto LABEL_145;
      if ( v95 )
      {
        std::__throw_system_error(35);
LABEL_145:
        v59 = std::__throw_system_error(1);
        sub_8067F00(&abstime);
LABEL_146:
        if ( v95 )
          sub_80584A0((int)&mutex, v72);
        Unwind_Resume(v59);
      }
      if ( &_pthread_key_create )
      {
        v48 = pthread_mutex_lock(mutex);
        if ( v48 )
        {
          v60 = std::__throw_system_error(v48);
          std::string::_Rep::_M_dispose(&mutex[-1].__align + 3, &abstime);
          Unwind_Resume(v60);
        }
      }
      v95 = 1;
      v49 = abstime.tv_nsec;
      v50 = abstime.tv_sec;
      if ( abstime.tv_nsec != abstime.tv_sec )
      {
        do
        {
          v51 = *(_DWORD *)v50;
          v52 = *(_DWORD *)v50 == 0;
          if ( *(_DWORD *)v50 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v51 + 4));
            if ( v52 )
              (*(void (__cdecl **)(int))(*(_DWORD *)v51 + 4))(v51);
          }
          v50 += 4;
        }
        while ( v49 != v50 );
        v49 = abstime.tv_sec;
      }
      if ( v49 )
        operator delete((void *)v49);
    }
    std::chrono::_V2::system_clock::now((std::chrono::_V2::system_clock *)&v92);
    abstime.tv_sec = (v92 + 1000000000) / 1000000000;
    abstime.tv_nsec = (v92 + 1000000000) % 1000000000;
    pthread_cond_timedwait((pthread_cond_t *)(&a1[17].__align + 3), mutex, &abstime);
    std::chrono::_V2::system_clock::now((std::chrono::_V2::system_clock *)&v92);
    if ( v95 && mutex )
    {
      if ( &_pthread_key_create )
        pthread_mutex_unlock(mutex);
    }
  }
  if ( log_level <= 3 )
  {
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&abstime, 16);
    v57 = std::__ostream_insert<char,std::char_traits<char>>(
            &abstime,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    v58 = std::operator<<<std::char_traits<char>>(v57, "Terminate timeout expired");
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&mutex, v58 + 4);
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&abstime);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &abstime);
    if ( byte_80CE64C )
    {
      v61 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, mutex, mutex[-1].__kind);
      std::endl<char,std::char_traits<char>>(v61);
    }
    syslog(5, "%s", mutex);
    std::string::_Rep::_M_dispose(&mutex[-1].__align + 3, &abstime);
  }
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v92);
  if ( (long double)(v92 - v76) / 1000000000.0 > 10.0 )
  {
    sub_80A6280((int)&unk_80CF8A0);
    sub_8094890(v77, (int)&unk_80CF8A0);
  }
  if ( !graceful_terminate )
    sub_8060390((int)a1);
  return std::this_thread::__sleep_for(15, 0, 0, 0);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C890: using guessed type int __cdecl std::this_thread::__sleep_for(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C9B0: using guessed type int __cdecl std::operator<<<std::char_traits<char>>(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CE680: using guessed type int dword_80CE680;
// 80CE684: using guessed type int dword_80CE684;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF878: using guessed type char graceful_terminate;
// 80CF87C: using guessed type int terminate_timeout;

//----- (08067160) --------------------------------------------------------
int __cdecl sub_8067160(int a1)
{
  int v1; // eax@1
  void *v2; // eax@2
  int v3; // ebp@3
  int v4; // esi@4
  int v5; // eax@4
  void *v6; // edi@7
  void *v7; // ebx@7
  int v8; // eax@8
  int v9; // edx@8
  void *v10; // edi@13
  void *v11; // ebx@13
  int v12; // eax@14
  int v13; // edx@14
  int v14; // eax@19
  int v15; // edx@19
  int v16; // eax@20
  void *v17; // eax@25
  int v18; // ebp@26
  int v19; // esi@27
  int v20; // eax@27
  void *v21; // edi@30
  void *v22; // ebx@30
  int v23; // eax@31
  int v24; // edx@31
  void *v25; // edi@36
  void *v26; // ebx@36
  int v27; // eax@37
  int v28; // edx@37
  int v29; // eax@42
  int v30; // edx@42
  int v31; // eax@43
  void *v32; // esi@49
  void *v33; // ebx@49
  int v34; // eax@50
  int v35; // edx@50
  int result; // eax@55
  signed __int32 v37; // eax@57
  signed __int32 v38; // eax@61
  signed __int32 v39; // eax@65
  signed __int32 v40; // eax@69
  signed __int32 v41; // eax@73
  signed __int32 v42; // ebx@77
  signed __int32 v43; // ecx@80
  signed __int32 v44; // ebx@82
  signed __int32 v45; // eax@86
  signed __int32 v46; // ebx@90
  signed __int32 v47; // eax@92
  signed __int32 v48; // ecx@95
  signed __int32 v49; // ebx@96
  signed __int32 v50; // ecx@97
  signed __int32 v51; // ecx@98
  signed __int32 v52; // ecx@99
  void *v53; // [sp+Ch] [bp-50h]@3
  int v54; // [sp+Ch] [bp-50h]@26
  void *v55; // [sp+10h] [bp-4Ch]@2
  void *v56; // [sp+10h] [bp-4Ch]@25
  int v57; // [sp+14h] [bp-48h]@3
  int v58; // [sp+14h] [bp-48h]@26
  void *v59; // [sp+1Ch] [bp-40h]@2
  void *v60; // [sp+1Ch] [bp-40h]@25
  int v61; // [sp+20h] [bp-3Ch]@3
  int v62; // [sp+20h] [bp-3Ch]@26
  int v63; // [sp+24h] [bp-38h]@3
  int v64; // [sp+24h] [bp-38h]@26
  int v65; // [sp+28h] [bp-34h]@3
  int v66; // [sp+28h] [bp-34h]@26
  void *v67; // [sp+2Ch] [bp-30h]@1
  char v68; // [sp+3Fh] [bp-1Dh]@59

  *(_DWORD *)a1 = &off_80BA318;
  v1 = *(_DWORD *)(a1 + 40);
  v67 = (void *)v1;
  if ( v1 )
  {
    v59 = *(void **)(v1 + 40);
    v2 = *(void **)(v1 + 36);
    v55 = v2;
    if ( v59 != v2 )
    {
      v57 = (int)((char *)v2 + 28);
      v3 = (int)((char *)v2 + 48);
      v53 = v2;
      v65 = (int)((char *)v2 + 56);
      v63 = (int)((char *)v2 + 20);
      v61 = (int)((char *)v2 + 8);
      do
      {
        v4 = (_BYTE *)v53 - (_BYTE *)v55;
        v5 = *(_DWORD *)((_BYTE *)v53 - (_BYTE *)v55 + v65);
        if ( v5 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
          if ( !v5 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v6 = *(void **)v3;
        v7 = *(void **)(v3 - 4);
        if ( *(void **)v3 != v7 )
        {
          do
          {
            v8 = *(_DWORD *)v7;
            v9 = *(_DWORD *)v7 - 12;
            if ( (_DWORD *)v9 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v8 - 4), 0xFFFFFFFF);
              }
              else
              {
                v51 = *(_DWORD *)(v8 - 4);
                *(_DWORD *)(v8 - 4) = v51 - 1;
                v40 = v51;
              }
              if ( v40 <= 0 )
                std::string::_Rep::_M_destroy(v9, &v68);
            }
            v7 = (char *)v7 + 4;
          }
          while ( v6 != v7 );
          v6 = (void *)*((_DWORD *)v53 + 11);
        }
        if ( v6 )
          operator delete(v6);
        v10 = *(void **)v57;
        v11 = *(void **)(v57 - 4);
        if ( *(void **)v57 != v11 )
        {
          do
          {
            v12 = *(_DWORD *)v11;
            v13 = *(_DWORD *)v11 - 12;
            if ( (_DWORD *)v13 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v12 - 4), 0xFFFFFFFF);
              }
              else
              {
                v52 = *(_DWORD *)(v12 - 4);
                *(_DWORD *)(v12 - 4) = v52 - 1;
                v39 = v52;
              }
              if ( v39 <= 0 )
                std::string::_Rep::_M_destroy(v13, &v68);
            }
            v11 = (char *)v11 + 4;
          }
          while ( v10 != v11 );
          v10 = (void *)*((_DWORD *)v53 + 6);
        }
        if ( v10 )
          operator delete(v10);
        v14 = *(_DWORD *)(v4 + v63);
        v15 = v14 - 12;
        if ( (_DWORD *)(v14 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v45 = _InterlockedExchangeAdd((volatile signed __int32 *)(v14 - 4), 0xFFFFFFFF);
          }
          else
          {
            v46 = *(_DWORD *)(v14 - 4);
            *(_DWORD *)(v14 - 4) = v46 - 1;
            v45 = v46;
          }
          if ( v45 <= 0 )
            std::string::_Rep::_M_destroy(v15, &v68);
        }
        v16 = *(_DWORD *)(v4 + v61);
        if ( (_DWORD *)(v16 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v44 = _InterlockedExchangeAdd((volatile signed __int32 *)(v16 - 4), 0xFFFFFFFF);
          }
          else
          {
            v44 = *(_DWORD *)(v16 - 4);
            *(_DWORD *)(v16 - 4) = v44 - 1;
          }
          if ( v44 <= 0 )
            std::string::_Rep::_M_destroy(v16 - 12, &v68);
        }
        v53 = (char *)v53 + 60;
        v57 += 60;
        v3 += 60;
      }
      while ( v59 != v53 );
      v59 = (void *)*((_DWORD *)v67 + 9);
    }
    if ( v59 )
      operator delete(v59);
    v60 = (void *)*((_DWORD *)v67 + 7);
    v17 = (void *)*((_DWORD *)v67 + 6);
    v56 = v17;
    if ( v60 != v17 )
    {
      v58 = (int)((char *)v17 + 28);
      v18 = (int)((char *)v17 + 48);
      v54 = *((_DWORD *)v67 + 6);
      v62 = (int)((char *)v17 + 56);
      v66 = (int)((char *)v17 + 20);
      v64 = (int)((char *)v17 + 8);
      do
      {
        v19 = v54 - (_DWORD)v56;
        v20 = *(_DWORD *)(v54 - (_DWORD)v56 + v62);
        if ( v20 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v20 + 4));
          if ( !v20 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v21 = *(void **)v18;
        v22 = *(void **)(v18 - 4);
        if ( *(void **)v18 != v22 )
        {
          do
          {
            v23 = *(_DWORD *)v22;
            v24 = *(_DWORD *)v22 - 12;
            if ( (_DWORD *)v24 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v23 - 4), 0xFFFFFFFF);
              }
              else
              {
                v43 = *(_DWORD *)(v23 - 4);
                *(_DWORD *)(v23 - 4) = v43 - 1;
                v38 = v43;
              }
              if ( v38 <= 0 )
                std::string::_Rep::_M_destroy(v24, &v68);
            }
            v22 = (char *)v22 + 4;
          }
          while ( v21 != v22 );
          v21 = *(void **)(v54 + 44);
        }
        if ( v21 )
          operator delete(v21);
        v25 = *(void **)v58;
        v26 = *(void **)(v58 - 4);
        if ( *(void **)v58 != v26 )
        {
          do
          {
            v27 = *(_DWORD *)v26;
            v28 = *(_DWORD *)v26 - 12;
            if ( (_DWORD *)v28 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v27 - 4), 0xFFFFFFFF);
              }
              else
              {
                v50 = *(_DWORD *)(v27 - 4);
                *(_DWORD *)(v27 - 4) = v50 - 1;
                v37 = v50;
              }
              if ( v37 <= 0 )
                std::string::_Rep::_M_destroy(v28, &v68);
            }
            v26 = (char *)v26 + 4;
          }
          while ( v25 != v26 );
          v25 = *(void **)(v54 + 24);
        }
        if ( v25 )
          operator delete(v25);
        v29 = *(_DWORD *)(v19 + v66);
        v30 = v29 - 12;
        if ( (_DWORD *)(v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v47 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
          }
          else
          {
            v49 = *(_DWORD *)(v29 - 4);
            *(_DWORD *)(v29 - 4) = v49 - 1;
            v47 = v49;
          }
          if ( v47 <= 0 )
            std::string::_Rep::_M_destroy(v30, &v68);
        }
        v31 = *(_DWORD *)(v19 + v64);
        if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v42 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
          }
          else
          {
            v42 = *(_DWORD *)(v31 - 4);
            *(_DWORD *)(v31 - 4) = v42 - 1;
          }
          if ( v42 <= 0 )
            std::string::_Rep::_M_destroy(v31 - 12, &v68);
        }
        v54 += 60;
        v58 += 60;
        v18 += 60;
      }
      while ( v60 != (void *)v54 );
      v60 = (void *)*((_DWORD *)v67 + 6);
    }
    if ( v60 )
      operator delete(v60);
    operator delete(v67);
  }
  *(_DWORD *)(a1 + 40) = 0;
  sub_8056F10(*(_DWORD *)(a1 + 32));
  v32 = *(void **)(a1 + 24);
  v33 = *(void **)(a1 + 20);
  if ( v32 != v33 )
  {
    do
    {
      v34 = *(_DWORD *)v33;
      v35 = *(_DWORD *)v33 - 12;
      if ( (_DWORD *)v35 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v41 = _InterlockedExchangeAdd((volatile signed __int32 *)(v34 - 4), 0xFFFFFFFF);
        }
        else
        {
          v48 = *(_DWORD *)(v34 - 4);
          *(_DWORD *)(v34 - 4) = v48 - 1;
          v41 = v48;
        }
        if ( v41 <= 0 )
          std::string::_Rep::_M_destroy(v35, &v68);
      }
      v33 = (char *)v33 + 4;
    }
    while ( v32 != v33 );
    v32 = *(void **)(a1 + 20);
  }
  if ( v32 )
    operator delete(v32);
  sub_8056F10(*(_DWORD *)(a1 + 16));
  result = a1;
  *(_DWORD *)a1 = &off_80BA2E8;
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA318: using guessed type int (__cdecl *off_80BA318)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08067710) --------------------------------------------------------
void __cdecl sub_8067710(void *a1)
{
  int v1; // eax@1
  void *v2; // eax@2
  int v3; // ebp@3
  int v4; // esi@4
  int v5; // eax@4
  void *v6; // edi@7
  void *v7; // ebx@7
  int v8; // eax@8
  int v9; // edx@8
  void *v10; // edi@13
  void *v11; // ebx@13
  int v12; // eax@14
  int v13; // edx@14
  int v14; // eax@19
  int v15; // edx@19
  int v16; // eax@20
  void *v17; // eax@25
  int v18; // ebp@26
  int v19; // esi@27
  int v20; // eax@27
  void *v21; // edi@30
  void *v22; // ebx@30
  int v23; // eax@31
  int v24; // edx@31
  void *v25; // edi@36
  void *v26; // ebx@36
  int v27; // eax@37
  int v28; // edx@37
  int v29; // eax@42
  int v30; // edx@42
  int v31; // eax@43
  void *v32; // esi@49
  void *v33; // ebx@49
  int v34; // eax@50
  int v35; // edx@50
  signed __int32 v36; // eax@57
  signed __int32 v37; // eax@61
  signed __int32 v38; // eax@65
  signed __int32 v39; // eax@69
  signed __int32 v40; // eax@73
  signed __int32 v41; // ebx@77
  signed __int32 v42; // ecx@80
  signed __int32 v43; // ebx@82
  signed __int32 v44; // eax@86
  signed __int32 v45; // ebx@90
  signed __int32 v46; // eax@92
  signed __int32 v47; // ecx@95
  signed __int32 v48; // ebx@96
  signed __int32 v49; // ecx@97
  signed __int32 v50; // ecx@98
  signed __int32 v51; // ecx@99
  void *v52; // [sp+Ch] [bp-50h]@3
  int v53; // [sp+Ch] [bp-50h]@26
  void *v54; // [sp+10h] [bp-4Ch]@2
  void *v55; // [sp+10h] [bp-4Ch]@25
  int v56; // [sp+14h] [bp-48h]@3
  int v57; // [sp+14h] [bp-48h]@26
  void *v58; // [sp+1Ch] [bp-40h]@2
  void *v59; // [sp+1Ch] [bp-40h]@25
  int v60; // [sp+20h] [bp-3Ch]@3
  int v61; // [sp+20h] [bp-3Ch]@26
  int v62; // [sp+24h] [bp-38h]@3
  int v63; // [sp+24h] [bp-38h]@26
  int v64; // [sp+28h] [bp-34h]@3
  int v65; // [sp+28h] [bp-34h]@26
  void *v66; // [sp+2Ch] [bp-30h]@1
  char v67; // [sp+3Fh] [bp-1Dh]@59

  *(_DWORD *)a1 = &off_80BA318;
  v1 = *((_DWORD *)a1 + 10);
  v66 = (void *)v1;
  if ( v1 )
  {
    v58 = *(void **)(v1 + 40);
    v2 = *(void **)(v1 + 36);
    v54 = v2;
    if ( v58 != v2 )
    {
      v56 = (int)((char *)v2 + 28);
      v3 = (int)((char *)v2 + 48);
      v52 = v2;
      v64 = (int)((char *)v2 + 56);
      v62 = (int)((char *)v2 + 20);
      v60 = (int)((char *)v2 + 8);
      do
      {
        v4 = (_BYTE *)v52 - (_BYTE *)v54;
        v5 = *(_DWORD *)((_BYTE *)v52 - (_BYTE *)v54 + v64);
        if ( v5 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
          if ( !v5 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v6 = *(void **)v3;
        v7 = *(void **)(v3 - 4);
        if ( *(void **)v3 != v7 )
        {
          do
          {
            v8 = *(_DWORD *)v7;
            v9 = *(_DWORD *)v7 - 12;
            if ( (_DWORD *)v9 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v8 - 4), 0xFFFFFFFF);
              }
              else
              {
                v50 = *(_DWORD *)(v8 - 4);
                *(_DWORD *)(v8 - 4) = v50 - 1;
                v39 = v50;
              }
              if ( v39 <= 0 )
                std::string::_Rep::_M_destroy(v9, &v67);
            }
            v7 = (char *)v7 + 4;
          }
          while ( v6 != v7 );
          v6 = (void *)*((_DWORD *)v52 + 11);
        }
        if ( v6 )
          operator delete(v6);
        v10 = *(void **)v56;
        v11 = *(void **)(v56 - 4);
        if ( *(void **)v56 != v11 )
        {
          do
          {
            v12 = *(_DWORD *)v11;
            v13 = *(_DWORD *)v11 - 12;
            if ( (_DWORD *)v13 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v12 - 4), 0xFFFFFFFF);
              }
              else
              {
                v51 = *(_DWORD *)(v12 - 4);
                *(_DWORD *)(v12 - 4) = v51 - 1;
                v38 = v51;
              }
              if ( v38 <= 0 )
                std::string::_Rep::_M_destroy(v13, &v67);
            }
            v11 = (char *)v11 + 4;
          }
          while ( v10 != v11 );
          v10 = (void *)*((_DWORD *)v52 + 6);
        }
        if ( v10 )
          operator delete(v10);
        v14 = *(_DWORD *)(v4 + v62);
        v15 = v14 - 12;
        if ( (_DWORD *)(v14 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v44 = _InterlockedExchangeAdd((volatile signed __int32 *)(v14 - 4), 0xFFFFFFFF);
          }
          else
          {
            v45 = *(_DWORD *)(v14 - 4);
            *(_DWORD *)(v14 - 4) = v45 - 1;
            v44 = v45;
          }
          if ( v44 <= 0 )
            std::string::_Rep::_M_destroy(v15, &v67);
        }
        v16 = *(_DWORD *)(v4 + v60);
        if ( (_DWORD *)(v16 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v43 = _InterlockedExchangeAdd((volatile signed __int32 *)(v16 - 4), 0xFFFFFFFF);
          }
          else
          {
            v43 = *(_DWORD *)(v16 - 4);
            *(_DWORD *)(v16 - 4) = v43 - 1;
          }
          if ( v43 <= 0 )
            std::string::_Rep::_M_destroy(v16 - 12, &v67);
        }
        v52 = (char *)v52 + 60;
        v56 += 60;
        v3 += 60;
      }
      while ( v58 != v52 );
      v58 = (void *)*((_DWORD *)v66 + 9);
    }
    if ( v58 )
      operator delete(v58);
    v59 = (void *)*((_DWORD *)v66 + 7);
    v17 = (void *)*((_DWORD *)v66 + 6);
    v55 = v17;
    if ( v59 != v17 )
    {
      v57 = (int)((char *)v17 + 28);
      v18 = (int)((char *)v17 + 48);
      v53 = *((_DWORD *)v66 + 6);
      v61 = (int)((char *)v17 + 56);
      v65 = (int)((char *)v17 + 20);
      v63 = (int)((char *)v17 + 8);
      do
      {
        v19 = v53 - (_DWORD)v55;
        v20 = *(_DWORD *)(v53 - (_DWORD)v55 + v61);
        if ( v20 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v20 + 4));
          if ( !v20 )
            (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
        }
        v21 = *(void **)v18;
        v22 = *(void **)(v18 - 4);
        if ( *(void **)v18 != v22 )
        {
          do
          {
            v23 = *(_DWORD *)v22;
            v24 = *(_DWORD *)v22 - 12;
            if ( (_DWORD *)v24 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v23 - 4), 0xFFFFFFFF);
              }
              else
              {
                v42 = *(_DWORD *)(v23 - 4);
                *(_DWORD *)(v23 - 4) = v42 - 1;
                v37 = v42;
              }
              if ( v37 <= 0 )
                std::string::_Rep::_M_destroy(v24, &v67);
            }
            v22 = (char *)v22 + 4;
          }
          while ( v21 != v22 );
          v21 = *(void **)(v53 + 44);
        }
        if ( v21 )
          operator delete(v21);
        v25 = *(void **)v57;
        v26 = *(void **)(v57 - 4);
        if ( *(void **)v57 != v26 )
        {
          do
          {
            v27 = *(_DWORD *)v26;
            v28 = *(_DWORD *)v26 - 12;
            if ( (_DWORD *)v28 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v27 - 4), 0xFFFFFFFF);
              }
              else
              {
                v49 = *(_DWORD *)(v27 - 4);
                *(_DWORD *)(v27 - 4) = v49 - 1;
                v36 = v49;
              }
              if ( v36 <= 0 )
                std::string::_Rep::_M_destroy(v28, &v67);
            }
            v26 = (char *)v26 + 4;
          }
          while ( v25 != v26 );
          v25 = *(void **)(v53 + 24);
        }
        if ( v25 )
          operator delete(v25);
        v29 = *(_DWORD *)(v19 + v65);
        v30 = v29 - 12;
        if ( (_DWORD *)(v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
          }
          else
          {
            v48 = *(_DWORD *)(v29 - 4);
            *(_DWORD *)(v29 - 4) = v48 - 1;
            v46 = v48;
          }
          if ( v46 <= 0 )
            std::string::_Rep::_M_destroy(v30, &v67);
        }
        v31 = *(_DWORD *)(v19 + v63);
        if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v41 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
          }
          else
          {
            v41 = *(_DWORD *)(v31 - 4);
            *(_DWORD *)(v31 - 4) = v41 - 1;
          }
          if ( v41 <= 0 )
            std::string::_Rep::_M_destroy(v31 - 12, &v67);
        }
        v53 += 60;
        v57 += 60;
        v18 += 60;
      }
      while ( v59 != (void *)v53 );
      v59 = (void *)*((_DWORD *)v66 + 6);
    }
    if ( v59 )
      operator delete(v59);
    operator delete(v66);
  }
  *((_DWORD *)a1 + 10) = 0;
  sub_8056F10(*((_DWORD *)a1 + 8));
  v32 = (void *)*((_DWORD *)a1 + 6);
  v33 = (void *)*((_DWORD *)a1 + 5);
  if ( v32 != v33 )
  {
    do
    {
      v34 = *(_DWORD *)v33;
      v35 = *(_DWORD *)v33 - 12;
      if ( (_DWORD *)v35 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v34 - 4), 0xFFFFFFFF);
        }
        else
        {
          v47 = *(_DWORD *)(v34 - 4);
          *(_DWORD *)(v34 - 4) = v47 - 1;
          v40 = v47;
        }
        if ( v40 <= 0 )
          std::string::_Rep::_M_destroy(v35, &v67);
      }
      v33 = (char *)v33 + 4;
    }
    while ( v32 != v33 );
    v32 = (void *)*((_DWORD *)a1 + 5);
  }
  if ( v32 )
    operator delete(v32);
  sub_8056F10(*((_DWORD *)a1 + 4));
  *(_DWORD *)a1 = &off_80BA2E8;
  operator delete(a1);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA318: using guessed type int (__cdecl *off_80BA318)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08067CC0) --------------------------------------------------------
int __cdecl sub_8067CC0(int a1)
{
  int v1; // esi@1
  __int64 v3; // [sp+18h] [bp-10h]@1

  v1 = *(_DWORD *)(a1 + 44);
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v3);
  return v1 + (signed int)((long double)(v3 - *(_QWORD *)(a1 + 48)) / 1000000000.0);
}

//----- (08067D20) --------------------------------------------------------
int __cdecl sub_8067D20(int a1)
{
  int v1; // eax@1
  int v2; // edx@1
  int result; // eax@2
  int v4; // edx@2
  signed __int32 v5; // eax@5
  signed __int32 v6; // ecx@12
  int v7; // ecx@13
  char v8; // [sp+1Fh] [bp-Dh]@7

  v1 = *(_DWORD *)(a1 + 4);
  v2 = v1 - 12;
  if ( (_DWORD *)(v1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v5 = _InterlockedExchangeAdd((volatile signed __int32 *)(v1 - 4), 0xFFFFFFFF);
    }
    else
    {
      v6 = *(_DWORD *)(v1 - 4);
      *(_DWORD *)(v1 - 4) = v6 - 1;
      v5 = v6;
    }
    if ( v5 <= 0 )
      std::string::_Rep::_M_destroy(v2, &v8);
  }
  result = *(_DWORD *)a1;
  v4 = *(_DWORD *)a1 - 12;
  if ( (_DWORD *)v4 != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      result = _InterlockedExchangeAdd((volatile signed __int32 *)(result - 4), 0xFFFFFFFF);
    }
    else
    {
      v7 = *(_DWORD *)(result - 4);
      *(_DWORD *)(result - 4) = v7 - 1;
      result = v7;
    }
    if ( result <= 0 )
      result = std::string::_Rep::_M_destroy(v4, &v8);
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08067DC0) --------------------------------------------------------
int __userpurge sub_8067DC0@<eax>(int a1, std::string *a2)
{
  int v2; // eax@1
  int v3; // ebx@1

  v2 = operator new(0x2Cu);
  v3 = v2;
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)v2 = &off_80BA2F8;
  std::string::string((std::string *)(v2 + 8), a2);
  *(_DWORD *)(v3 + 12) = 0;
  *(_DWORD *)(v3 + 16) = 0;
  *(_DWORD *)(v3 + 20) = 0;
  *(_DWORD *)(v3 + 24) = 0;
  *(_DWORD *)(v3 + 28) = 0;
  *(_DWORD *)(v3 + 32) = 0;
  *(_DWORD *)(v3 + 36) = 0;
  *(_DWORD *)(v3 + 40) = 0;
  sub_808ABF0(v3, *(char **)(v3 + 8));
  *(_DWORD *)a1 = v3;
  _InterlockedIncrement((volatile signed __int32 *)(v3 + 4));
  return a1;
}
// 80BA2F8: using guessed type void *off_80BA2F8;

//----- (08067E80) --------------------------------------------------------
void __cdecl sub_8067E80(void *a1)
{
  int v1; // esi@3
  int v2; // ebx@3
  int v3; // eax@4
  bool v4; // zf@4
  int v5; // [sp+20h] [bp-8h]@0

  if ( *((_DWORD *)a1 + 2) )
  {
    (*(void (__cdecl **)(void *))((void (__cdecl **)(_DWORD))a1 + 3))(a1);
  }
  else
  {
    std::__throw_bad_function_call();
    v1 = *(_DWORD *)(v5 + 4);
    v2 = *(_DWORD *)v5;
    if ( v1 != *(_DWORD *)v5 )
    {
      do
      {
        v3 = *(_DWORD *)v2;
        v4 = *(_DWORD *)v2 == 0;
        if ( *(_DWORD *)v2 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
          if ( v4 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
        }
        v2 += 4;
      }
      while ( v1 != v2 );
      v1 = *(_DWORD *)v5;
    }
    if ( v1 )
      operator delete(a1);
  }
}

//----- (08067F00) --------------------------------------------------------
void __cdecl sub_8067F00(void *a1)
{
  void *v1; // esi@1
  void *v2; // ebx@1
  int v3; // eax@2
  bool v4; // zf@2

  v1 = (void *)*((_DWORD *)a1 + 1);
  v2 = *(void **)a1;
  if ( v1 != *(void **)a1 )
  {
    do
    {
      v3 = *(_DWORD *)v2;
      v4 = *(_DWORD *)v2 == 0;
      if ( *(_DWORD *)v2 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
        if ( v4 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
      }
      v2 = (char *)v2 + 4;
    }
    while ( v1 != v2 );
    v1 = *(void **)a1;
  }
  if ( v1 )
    operator delete(v1);
}

//----- (08067F60) --------------------------------------------------------
void __cdecl sub_8067F60(int a1)
{
  void *v1; // eax@1
  int v2; // eax@3
  int v3; // ebp@4
  int v4; // esi@5
  int v5; // eax@5
  int v6; // eax@8
  void *v7; // edi@11
  void *v8; // ebx@11
  int v9; // eax@12
  int v10; // edx@12
  void *v11; // edi@17
  void *v12; // ebx@17
  int v13; // eax@18
  int v14; // edx@18
  int v15; // eax@23
  int v16; // edx@23
  int v17; // eax@24
  int v18; // eax@29
  int v19; // ebp@30
  int v20; // esi@31
  int v21; // eax@31
  int v22; // eax@34
  void *v23; // edi@37
  void *v24; // ebx@37
  int v25; // eax@38
  int v26; // edx@38
  void *v27; // edi@43
  void *v28; // ebx@43
  int v29; // eax@44
  int v30; // edx@44
  int v31; // eax@49
  int v32; // edx@49
  int v33; // eax@50
  int v34; // eax@55
  bool v35; // zf@55
  signed __int32 v36; // eax@64
  signed __int32 v37; // eax@68
  signed __int32 v38; // eax@72
  signed __int32 v39; // eax@76
  signed __int32 v40; // ecx@79
  signed __int32 v41; // eax@81
  signed __int32 v42; // ebx@85
  signed __int32 v43; // eax@89
  signed __int32 v44; // ebx@92
  signed __int32 v45; // ebx@94
  signed __int32 v46; // ebx@96
  signed __int32 v47; // ecx@99
  signed __int32 v48; // ecx@101
  signed __int32 v49; // ecx@102
  int v50; // [sp+Ch] [bp-60h]@4
  int v51; // [sp+Ch] [bp-60h]@30
  int v52; // [sp+10h] [bp-5Ch]@3
  int v53; // [sp+10h] [bp-5Ch]@29
  int v54; // [sp+14h] [bp-58h]@4
  int v55; // [sp+14h] [bp-58h]@30
  void *v56; // [sp+1Ch] [bp-50h]@3
  void *v57; // [sp+1Ch] [bp-50h]@29
  int v58; // [sp+20h] [bp-4Ch]@4
  int v59; // [sp+20h] [bp-4Ch]@30
  int v60; // [sp+24h] [bp-48h]@4
  int v61; // [sp+24h] [bp-48h]@30
  int v62; // [sp+28h] [bp-44h]@4
  int v63; // [sp+28h] [bp-44h]@30
  int v64; // [sp+2Ch] [bp-40h]@4
  int v65; // [sp+2Ch] [bp-40h]@30
  void *v66; // [sp+30h] [bp-3Ch]@2
  int v67; // [sp+34h] [bp-38h]@2
  int v68; // [sp+38h] [bp-34h]@2
  void *v69; // [sp+3Ch] [bp-30h]@1
  char v70; // [sp+4Fh] [bp-1Dh]@66

  v69 = *(void **)(a1 + 4);
  v1 = *(void **)a1;
  if ( v69 != *(void **)a1 )
  {
    v67 = (int)((char *)v1 + 32);
    v68 = (int)((char *)v1 + 20);
    v66 = *(void **)a1;
    do
    {
      v56 = *(void **)v67;
      v2 = *(_DWORD *)(v67 - 4);
      v52 = v2;
      if ( *(_DWORD *)v67 != v2 )
      {
        v54 = v2 + 28;
        v3 = v2 + 48;
        v50 = *(_DWORD *)(v67 - 4);
        v64 = v2 + 60;
        v62 = v2 + 56;
        v60 = v2 + 20;
        v58 = v2 + 8;
        do
        {
          v4 = v50 - v52;
          v5 = *(_DWORD *)(v50 - v52 + v64);
          if ( v5 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
            if ( !v5 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
          }
          v6 = *(_DWORD *)(v4 + v62);
          if ( v6 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v6 + 4));
            if ( !v6 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
          }
          v7 = *(void **)v3;
          v8 = *(void **)(v3 - 4);
          if ( *(void **)v3 != v8 )
          {
            do
            {
              v9 = *(_DWORD *)v8;
              v10 = *(_DWORD *)v8 - 12;
              if ( (_DWORD *)v10 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v9 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v48 = *(_DWORD *)(v9 - 4);
                  *(_DWORD *)(v9 - 4) = v48 - 1;
                  v39 = v48;
                }
                if ( v39 <= 0 )
                  std::string::_Rep::_M_destroy(v10, &v70);
              }
              v8 = (char *)v8 + 4;
            }
            while ( v7 != v8 );
            v7 = *(void **)(v50 + 44);
          }
          if ( v7 )
            operator delete(v7);
          v11 = *(void **)v54;
          v12 = *(void **)(v54 - 4);
          if ( *(void **)v54 != v12 )
          {
            do
            {
              v13 = *(_DWORD *)v12;
              v14 = *(_DWORD *)v12 - 12;
              if ( (_DWORD *)v14 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v13 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v47 = *(_DWORD *)(v13 - 4);
                  *(_DWORD *)(v13 - 4) = v47 - 1;
                  v38 = v47;
                }
                if ( v38 <= 0 )
                  std::string::_Rep::_M_destroy(v14, &v70);
              }
              v12 = (char *)v12 + 4;
            }
            while ( v11 != v12 );
            v11 = *(void **)(v50 + 24);
          }
          if ( v11 )
            operator delete(v11);
          v15 = *(_DWORD *)(v4 + v60);
          v16 = v15 - 12;
          if ( (_DWORD *)(v15 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v41 = _InterlockedExchangeAdd((volatile signed __int32 *)(v15 - 4), 0xFFFFFFFF);
            }
            else
            {
              v44 = *(_DWORD *)(v15 - 4);
              *(_DWORD *)(v15 - 4) = v44 - 1;
              v41 = v44;
            }
            if ( v41 <= 0 )
              std::string::_Rep::_M_destroy(v16, &v70);
          }
          v17 = *(_DWORD *)(v4 + v58);
          if ( (_DWORD *)(v17 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v42 = _InterlockedExchangeAdd((volatile signed __int32 *)(v17 - 4), 0xFFFFFFFF);
            }
            else
            {
              v42 = *(_DWORD *)(v17 - 4);
              *(_DWORD *)(v17 - 4) = v42 - 1;
            }
            if ( v42 <= 0 )
              std::string::_Rep::_M_destroy(v17 - 12, &v70);
          }
          v50 += 64;
          v54 += 64;
          v3 += 64;
        }
        while ( v56 != (void *)v50 );
        v56 = (void *)*((_DWORD *)v66 + 7);
      }
      if ( v56 )
        operator delete(v56);
      v57 = *(void **)v68;
      v18 = *(_DWORD *)(v68 - 4);
      v53 = v18;
      if ( *(_DWORD *)v68 != v18 )
      {
        v55 = v18 + 28;
        v19 = v18 + 48;
        v51 = *(_DWORD *)(v68 - 4);
        v65 = v18 + 60;
        v63 = v18 + 56;
        v61 = v18 + 20;
        v59 = v18 + 8;
        do
        {
          v20 = v51 - v53;
          v21 = *(_DWORD *)(v51 - v53 + v65);
          if ( v21 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v21 + 4));
            if ( !v21 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
          }
          v22 = *(_DWORD *)(v20 + v63);
          if ( v22 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v22 + 4));
            if ( !v22 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
          }
          v23 = *(void **)v19;
          v24 = *(void **)(v19 - 4);
          if ( *(void **)v19 != v24 )
          {
            do
            {
              v25 = *(_DWORD *)v24;
              v26 = *(_DWORD *)v24 - 12;
              if ( (_DWORD *)v26 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v25 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v40 = *(_DWORD *)(v25 - 4);
                  *(_DWORD *)(v25 - 4) = v40 - 1;
                  v37 = v40;
                }
                if ( v37 <= 0 )
                  std::string::_Rep::_M_destroy(v26, &v70);
              }
              v24 = (char *)v24 + 4;
            }
            while ( v23 != v24 );
            v23 = *(void **)(v51 + 44);
          }
          if ( v23 )
            operator delete(v23);
          v27 = *(void **)v55;
          v28 = *(void **)(v55 - 4);
          if ( *(void **)v55 != v28 )
          {
            do
            {
              v29 = *(_DWORD *)v28;
              v30 = *(_DWORD *)v28 - 12;
              if ( (_DWORD *)v30 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v49 = *(_DWORD *)(v29 - 4);
                  *(_DWORD *)(v29 - 4) = v49 - 1;
                  v36 = v49;
                }
                if ( v36 <= 0 )
                  std::string::_Rep::_M_destroy(v30, &v70);
              }
              v28 = (char *)v28 + 4;
            }
            while ( v27 != v28 );
            v27 = *(void **)(v51 + 24);
          }
          if ( v27 )
            operator delete(v27);
          v31 = *(_DWORD *)(v20 + v61);
          v32 = v31 - 12;
          if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v43 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
            }
            else
            {
              v45 = *(_DWORD *)(v31 - 4);
              *(_DWORD *)(v31 - 4) = v45 - 1;
              v43 = v45;
            }
            if ( v43 <= 0 )
              std::string::_Rep::_M_destroy(v32, &v70);
          }
          v33 = *(_DWORD *)(v20 + v59);
          if ( (_DWORD *)(v33 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v33 - 4), 0xFFFFFFFF);
            }
            else
            {
              v46 = *(_DWORD *)(v33 - 4);
              *(_DWORD *)(v33 - 4) = v46 - 1;
            }
            if ( v46 <= 0 )
              std::string::_Rep::_M_destroy(v33 - 12, &v70);
          }
          v51 += 64;
          v55 += 64;
          v19 += 64;
        }
        while ( v57 != (void *)v51 );
        v57 = (void *)*((_DWORD *)v66 + 4);
      }
      if ( v57 )
        operator delete(v57);
      v34 = *(_DWORD *)v66;
      v35 = *(_DWORD *)v66 == 0;
      if ( *(_DWORD *)v66 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v34 + 4));
        if ( v35 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v34 + 4))(v34);
      }
      v66 = (char *)v66 + 44;
      v67 += 44;
      v68 += 44;
    }
    while ( v69 != v66 );
    v69 = *(void **)a1;
  }
  if ( v69 )
    operator delete(v69);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08068500) --------------------------------------------------------
int __userpurge sub_8068500@<eax>(int a1, int a2)
{
  int v2; // eax@1
  int v3; // ebx@1
  int v4; // edx@1
  int v5; // eax@1
  int v6; // ecx@1
  int v7; // eax@3

  v2 = operator new(0x18u);
  v3 = v2;
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)v2 = &off_80BA328;
  *(_DWORD *)(v2 + 8) = 0;
  *(_DWORD *)(v2 + 12) = 0;
  *(_DWORD *)(v2 + 16) = 0;
  v4 = operator new(0x48u);
  v5 = *(_DWORD *)a2;
  *(_DWORD *)(v4 + 4) = 0;
  *(_DWORD *)v4 = &off_80BA308;
  *(_DWORD *)(v4 + 8) = 0;
  v6 = *(_DWORD *)a2;
  *(_DWORD *)(v4 + 12) = *(_DWORD *)a2;
  if ( v6 )
    _InterlockedIncrement((volatile signed __int32 *)(v6 + 4));
  *(_DWORD *)(v4 + 16) = *(_DWORD *)(v5 + 64);
  v7 = *(_DWORD *)(v5 + 68);
  *(_DWORD *)(v4 + 20) = v7;
  if ( v7 )
  {
    if ( &_pthread_key_create )
      _InterlockedIncrement((volatile signed __int32 *)(v7 + 4));
    else
      ++*(_DWORD *)(v7 + 4);
  }
  *(_DWORD *)(v4 + 24) = 0;
  *(_DWORD *)(v4 + 28) = 0;
  *(_DWORD *)(v4 + 32) = 0;
  *(_DWORD *)(v4 + 64) = 0;
  *(_BYTE *)(v4 + 36) = 0;
  *(_BYTE *)(v4 + 37) = 1;
  *(_BYTE *)(v4 + 38) = 0;
  *(_BYTE *)(v4 + 39) = 0;
  *(_BYTE *)(v4 + 40) = 0;
  *(_BYTE *)(v4 + 41) = 0;
  *(_DWORD *)(v4 + 44) = 0;
  *(_DWORD *)(v4 + 48) = 0;
  *(_DWORD *)(v4 + 52) = 1;
  *(_BYTE *)(v4 + 56) = 1;
  *(_BYTE *)(v4 + 57) = 1;
  *(_BYTE *)(v4 + 58) = 0;
  *(_BYTE *)(v4 + 59) = 1;
  *(_BYTE *)(v4 + 60) = 0;
  *(_BYTE *)(v4 + 68) = 0;
  *(_DWORD *)(v3 + 20) = v4;
  _InterlockedIncrement((volatile signed __int32 *)(v4 + 4));
  *(_DWORD *)a1 = v3;
  _InterlockedIncrement((volatile signed __int32 *)(v3 + 4));
  return a1;
}
// 80BA308: using guessed type void *off_80BA308;
// 80BA328: using guessed type void *off_80BA328;

//----- (08068630) --------------------------------------------------------
int __cdecl sub_8068630(int a1, int a2)
{
  int v2; // edi@1
  unsigned __int8 v3; // cf@2
  int v4; // edi@2
  int v5; // eax@3
  int v6; // esi@4
  void *v7; // ecx@4
  unsigned int v8; // edx@4
  int v9; // eax@5
  void *v10; // edi@7
  int v11; // ebp@9
  int v12; // eax@11
  void *v13; // ebp@14
  int v14; // eax@15
  bool v15; // zf@15
  int result; // eax@22
  unsigned int v17; // [sp+8h] [bp-24h]@3
  int v18; // [sp+Ch] [bp-20h]@4

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFFF )
    {
      v17 = -4;
      v5 = operator new(0xFFFFFFFC);
    }
    else
    {
      v17 = 4 * v4;
      v5 = operator new(4 * v4);
    }
  }
  else
  {
    v17 = 4;
    v5 = operator new(4u);
  }
  v6 = v5;
  v7 = *(void **)a1;
  v18 = v5 + 4;
  v8 = v5 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFFC);
  if ( v8 )
  {
    v9 = *(_DWORD *)a2;
    *(_DWORD *)v8 = *(_DWORD *)a2;
    if ( v9 )
      _InterlockedIncrement((volatile signed __int32 *)(v9 + 4));
    v10 = *(void **)(a1 + 4);
    v7 = *(void **)a1;
  }
  else
  {
    v10 = *(void **)(a1 + 4);
  }
  if ( v10 != v7 )
  {
    v11 = v6;
    do
    {
      if ( v11 )
      {
        v12 = *(_DWORD *)v7;
        *(_DWORD *)v11 = *(_DWORD *)v7;
        if ( v12 )
          _InterlockedIncrement((volatile signed __int32 *)(v12 + 4));
      }
      v7 = (char *)v7 + 4;
      v11 += 4;
    }
    while ( v7 != v10 );
    v18 = v11 + 4;
    v10 = *(void **)(a1 + 4);
    v13 = *(void **)a1;
    if ( v10 != *(void **)a1 )
    {
      do
      {
        v14 = *(_DWORD *)v13;
        v15 = *(_DWORD *)v13 == 0;
        if ( *(_DWORD *)v13 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v14 + 4));
          if ( v15 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v14 + 4))(v14);
        }
        v13 = (char *)v13 + 4;
      }
      while ( v10 != v13 );
      v10 = *(void **)a1;
    }
  }
  if ( v10 )
    operator delete(v10);
  *(_DWORD *)a1 = v6;
  result = v18;
  *(_DWORD *)(a1 + 4) = v18;
  *(_DWORD *)(a1 + 8) = v17 + v6;
  return result;
}

//----- (08068750) --------------------------------------------------------
int __cdecl sub_8068750(int a1, int a2)
{
  int v2; // eax@1
  int v3; // ecx@3
  int result; // eax@6

  v2 = *(_DWORD *)(a1 + 4);
  if ( v2 == *(_DWORD *)(a1 + 8) )
  {
    result = sub_8068630(a1, a2);
  }
  else
  {
    if ( v2 )
    {
      v3 = *(_DWORD *)a2;
      *(_DWORD *)v2 = *(_DWORD *)a2;
      if ( v3 )
        _InterlockedIncrement((volatile signed __int32 *)(v3 + 4));
      v2 = *(_DWORD *)(a1 + 4);
    }
    result = v2 + 4;
    *(_DWORD *)(a1 + 4) = result;
  }
  return result;
}

//----- (08068790) --------------------------------------------------------
int __cdecl sub_8068790(int a1, int a2)
{
  int v2; // edi@1
  unsigned __int8 v3; // cf@2
  int v4; // edi@2
  int v5; // eax@3
  int v6; // esi@4
  void *v7; // ecx@4
  unsigned int v8; // edx@4
  int v9; // eax@5
  void *v10; // edi@7
  int v11; // ebp@9
  int v12; // eax@11
  void *v13; // ebp@14
  int v14; // eax@15
  bool v15; // zf@15
  int result; // eax@22
  unsigned int v17; // [sp+8h] [bp-24h]@3
  int v18; // [sp+Ch] [bp-20h]@4

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFFF )
    {
      v17 = -4;
      v5 = operator new(0xFFFFFFFC);
    }
    else
    {
      v17 = 4 * v4;
      v5 = operator new(4 * v4);
    }
  }
  else
  {
    v17 = 4;
    v5 = operator new(4u);
  }
  v6 = v5;
  v7 = *(void **)a1;
  v18 = v5 + 4;
  v8 = v5 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFFC);
  if ( v8 )
  {
    v9 = *(_DWORD *)a2;
    *(_DWORD *)v8 = *(_DWORD *)a2;
    if ( v9 )
      _InterlockedIncrement((volatile signed __int32 *)(v9 + 4));
    v10 = *(void **)(a1 + 4);
    v7 = *(void **)a1;
  }
  else
  {
    v10 = *(void **)(a1 + 4);
  }
  if ( v10 != v7 )
  {
    v11 = v6;
    do
    {
      if ( v11 )
      {
        v12 = *(_DWORD *)v7;
        *(_DWORD *)v11 = *(_DWORD *)v7;
        if ( v12 )
          _InterlockedIncrement((volatile signed __int32 *)(v12 + 4));
      }
      v7 = (char *)v7 + 4;
      v11 += 4;
    }
    while ( v7 != v10 );
    v18 = v11 + 4;
    v10 = *(void **)(a1 + 4);
    v13 = *(void **)a1;
    if ( v10 != *(void **)a1 )
    {
      do
      {
        v14 = *(_DWORD *)v13;
        v15 = *(_DWORD *)v13 == 0;
        if ( *(_DWORD *)v13 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v14 + 4));
          if ( v15 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v14 + 4))(v14);
        }
        v13 = (char *)v13 + 4;
      }
      while ( v10 != v13 );
      v10 = *(void **)a1;
    }
  }
  if ( v10 )
    operator delete(v10);
  *(_DWORD *)a1 = v6;
  result = v18;
  *(_DWORD *)(a1 + 4) = v18;
  *(_DWORD *)(a1 + 8) = v17 + v6;
  return result;
}

//----- (080688B0) --------------------------------------------------------
int __cdecl sub_80688B0(int a1, int a2)
{
  int v2; // edi@1
  unsigned __int8 v3; // cf@2
  int v4; // edi@2
  int v5; // eax@3
  int v6; // esi@4
  void *v7; // edx@4
  unsigned int v8; // eax@4
  void *v9; // edi@5
  int v10; // ebp@7
  int v11; // eax@9
  void *v12; // ebp@12
  int v13; // eax@13
  bool v14; // zf@13
  int result; // eax@20
  unsigned int v16; // [sp+8h] [bp-24h]@3
  int v17; // [sp+Ch] [bp-20h]@4

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFFF )
    {
      v16 = -4;
      v5 = operator new(0xFFFFFFFC);
    }
    else
    {
      v16 = 4 * v4;
      v5 = operator new(4 * v4);
    }
  }
  else
  {
    v16 = 4;
    v5 = operator new(4u);
  }
  v6 = v5;
  v7 = *(void **)a1;
  v17 = v5 + 4;
  v8 = v5 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFFC);
  if ( v8 )
  {
    *(_DWORD *)v8 = *(_DWORD *)a2;
    *(_DWORD *)a2 = 0;
    v9 = *(void **)(a1 + 4);
    v7 = *(void **)a1;
  }
  else
  {
    v9 = *(void **)(a1 + 4);
  }
  if ( v9 != v7 )
  {
    v10 = v6;
    do
    {
      if ( v10 )
      {
        v11 = *(_DWORD *)v7;
        *(_DWORD *)v10 = *(_DWORD *)v7;
        if ( v11 )
          _InterlockedIncrement((volatile signed __int32 *)(v11 + 4));
      }
      v7 = (char *)v7 + 4;
      v10 += 4;
    }
    while ( v7 != v9 );
    v17 = v10 + 4;
    v9 = *(void **)(a1 + 4);
    v12 = *(void **)a1;
    if ( v9 != *(void **)a1 )
    {
      do
      {
        v13 = *(_DWORD *)v12;
        v14 = *(_DWORD *)v12 == 0;
        if ( *(_DWORD *)v12 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v13 + 4));
          if ( v14 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v13 + 4))(v13);
        }
        v12 = (char *)v12 + 4;
      }
      while ( v9 != v12 );
      v9 = *(void **)a1;
    }
  }
  if ( v9 )
    operator delete(v9);
  *(_DWORD *)a1 = v6;
  result = v17;
  *(_DWORD *)(a1 + 4) = v17;
  *(_DWORD *)(a1 + 8) = v16 + v6;
  return result;
}

//----- (080689D0) --------------------------------------------------------
int __cdecl sub_80689D0(int a1, int a2)
{
  int v2; // eax@1
  int v3; // eax@3
  void *v4; // edi@4
  void *v5; // esi@4
  int v6; // eax@4
  int v7; // edx@5
  int v8; // edx@5
  int v9; // edx@5
  int v10; // edx@5
  void *v11; // eax@7
  int v12; // edx@7
  int v13; // ecx@9
  int v14; // ebp@9
  int v15; // ebp@9
  int v16; // ecx@9
  int v17; // ecx@9
  void *v18; // eax@11
  int v19; // eax@13
  int v20; // ebp@14
  int v21; // esi@15
  int v22; // eax@15
  int v23; // eax@18
  void *v24; // edi@21
  void *v25; // ebx@21
  int v26; // eax@22
  int v27; // edx@22
  void *v28; // edi@27
  void *v29; // ebx@27
  int v30; // eax@28
  int v31; // edx@28
  int v32; // eax@33
  int v33; // edx@33
  int v34; // eax@34
  int v35; // eax@39
  int v36; // ebp@40
  int v37; // esi@41
  int v38; // eax@41
  int v39; // eax@44
  void *v40; // edi@47
  void *v41; // ebx@47
  int v42; // eax@48
  int v43; // edx@48
  void *v44; // edi@53
  void *v45; // ebx@53
  int v46; // eax@54
  int v47; // edx@54
  int v48; // eax@59
  int v49; // edx@59
  int v50; // eax@60
  int v51; // eax@65
  bool v52; // zf@65
  int result; // eax@72
  signed __int32 v54; // eax@75
  signed __int32 v55; // eax@79
  signed __int32 v56; // eax@83
  signed __int32 v57; // eax@87
  signed __int32 v58; // eax@94
  signed __int32 v59; // eax@98
  signed __int32 v60; // ecx@101
  signed __int32 v61; // ecx@102
  signed __int32 v62; // ecx@103
  signed __int32 v63; // ebx@105
  signed __int32 v64; // ebx@108
  signed __int32 v65; // ebx@111
  signed __int32 v66; // ecx@115
  signed __int32 v67; // ebx@116
  int v68; // [sp+10h] [bp-6Ch]@14
  int v69; // [sp+10h] [bp-6Ch]@40
  int v70; // [sp+14h] [bp-68h]@13
  int v71; // [sp+14h] [bp-68h]@39
  int v72; // [sp+18h] [bp-64h]@14
  int v73; // [sp+18h] [bp-64h]@40
  void *v74; // [sp+20h] [bp-5Ch]@13
  void *v75; // [sp+20h] [bp-5Ch]@39
  int v76; // [sp+24h] [bp-58h]@14
  int v77; // [sp+24h] [bp-58h]@40
  int v78; // [sp+28h] [bp-54h]@14
  int v79; // [sp+28h] [bp-54h]@40
  int v80; // [sp+2Ch] [bp-50h]@14
  int v81; // [sp+2Ch] [bp-50h]@40
  int v82; // [sp+30h] [bp-4Ch]@14
  int v83; // [sp+30h] [bp-4Ch]@40
  void *v84; // [sp+34h] [bp-48h]@12
  int v85; // [sp+38h] [bp-44h]@12
  int v86; // [sp+3Ch] [bp-40h]@12
  void *v87; // [sp+40h] [bp-3Ch]@11
  unsigned int v88; // [sp+44h] [bp-38h]@3
  int v89; // [sp+48h] [bp-34h]@4
  int v90; // [sp+4Ch] [bp-30h]@4
  char v91; // [sp+5Fh] [bp-1Dh]@77

  v2 = -1171354717 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
  if ( v2 )
  {
    if ( __CFADD__(v2, v2) || (unsigned int)(1952257862 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2)) > 0x5D1745D )
    {
      v88 = -4;
      v3 = operator new(0xFFFFFFFC);
    }
    else
    {
      v88 = 8 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
      v3 = operator new(8 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2));
    }
  }
  else
  {
    v88 = 44;
    v3 = operator new(0x2Cu);
  }
  v89 = v3;
  v4 = *(void **)a1;
  v5 = *(void **)(a1 + 4);
  v90 = v3 + 44;
  v6 = v3 + 4 * ((signed int)((char *)v5 - *(_DWORD *)a1) >> 2);
  if ( v6 )
  {
    *(_DWORD *)v6 = *(_DWORD *)a2;
    *(_DWORD *)a2 = 0;
    *(_BYTE *)(v6 + 4) = *(_BYTE *)(a2 + 4);
    *(_BYTE *)(v6 + 5) = *(_BYTE *)(a2 + 5);
    *(_BYTE *)(v6 + 6) = *(_BYTE *)(a2 + 6);
    *(_DWORD *)(v6 + 8) = *(_DWORD *)(a2 + 8);
    *(_DWORD *)(v6 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(v6 + 16) = 0;
    *(_DWORD *)(v6 + 20) = 0;
    *(_DWORD *)(v6 + 24) = 0;
    *(_DWORD *)(v6 + 16) = *(_DWORD *)(a2 + 16);
    *(_DWORD *)(a2 + 16) = 0;
    v7 = *(_DWORD *)(v6 + 20);
    *(_DWORD *)(v6 + 20) = *(_DWORD *)(a2 + 20);
    *(_DWORD *)(a2 + 20) = v7;
    v8 = *(_DWORD *)(v6 + 24);
    *(_DWORD *)(v6 + 24) = *(_DWORD *)(a2 + 24);
    *(_DWORD *)(a2 + 24) = v8;
    *(_DWORD *)(v6 + 28) = 0;
    *(_DWORD *)(v6 + 32) = 0;
    *(_DWORD *)(v6 + 36) = 0;
    *(_DWORD *)(v6 + 28) = *(_DWORD *)(a2 + 28);
    *(_DWORD *)(a2 + 28) = 0;
    v9 = *(_DWORD *)(v6 + 32);
    *(_DWORD *)(v6 + 32) = *(_DWORD *)(a2 + 32);
    *(_DWORD *)(a2 + 32) = v9;
    v10 = *(_DWORD *)(v6 + 36);
    *(_DWORD *)(v6 + 36) = *(_DWORD *)(a2 + 36);
    *(_DWORD *)(a2 + 36) = v10;
    *(_DWORD *)(v6 + 40) = *(_DWORD *)(a2 + 40);
    v5 = *(void **)(a1 + 4);
    v4 = *(void **)a1;
  }
  if ( v4 == v5 )
  {
    v87 = v4;
  }
  else
  {
    v11 = v4;
    v12 = v89;
    do
    {
      if ( v12 )
      {
        *(_DWORD *)v12 = *(_DWORD *)v11;
        *(_DWORD *)v11 = 0;
        *(_BYTE *)(v12 + 4) = *((_BYTE *)v11 + 4);
        *(_BYTE *)(v12 + 5) = *((_BYTE *)v11 + 5);
        *(_BYTE *)(v12 + 6) = *((_BYTE *)v11 + 6);
        *(_DWORD *)(v12 + 8) = *((_DWORD *)v11 + 2);
        *(_DWORD *)(v12 + 12) = *((_DWORD *)v11 + 3);
        v13 = v12 - v89;
        *(_DWORD *)(v13 + v89 + 16) = 0;
        *(_DWORD *)(v13 + v89 + 20) = 0;
        *(_DWORD *)(v13 + v89 + 24) = 0;
        *(_DWORD *)(v12 + 16) = *((_DWORD *)v11 + 4);
        *((_DWORD *)v11 + 4) = 0;
        v14 = *(_DWORD *)(v12 + 20);
        *(_DWORD *)(v12 + 20) = *((_DWORD *)v11 + 5);
        *((_DWORD *)v11 + 5) = v14;
        v15 = *(_DWORD *)(v12 + 24);
        *(_DWORD *)(v12 + 24) = *((_DWORD *)v11 + 6);
        *((_DWORD *)v11 + 6) = v15;
        *(_DWORD *)(v13 + v89 + 28) = 0;
        *(_DWORD *)(v13 + v89 + 32) = 0;
        *(_DWORD *)(v13 + v89 + 36) = 0;
        *(_DWORD *)(v12 + 28) = *((_DWORD *)v11 + 7);
        *((_DWORD *)v11 + 7) = 0;
        v16 = *(_DWORD *)(v12 + 32);
        *(_DWORD *)(v12 + 32) = *((_DWORD *)v11 + 8);
        *((_DWORD *)v11 + 8) = v16;
        v17 = *(_DWORD *)(v12 + 36);
        *(_DWORD *)(v12 + 36) = *((_DWORD *)v11 + 9);
        *((_DWORD *)v11 + 9) = v17;
        *(_DWORD *)(v12 + 40) = *((_DWORD *)v11 + 10);
      }
      v11 = (char *)v11 + 44;
      v12 += 44;
    }
    while ( v11 != v5 );
    v90 = v89 + 44 * ((976128931 * ((unsigned int)((_BYTE *)v11 - ((_BYTE *)v4 + 44)) >> 2) & 0x3FFFFFFF) + 1) + 44;
    v87 = *(void **)(a1 + 4);
    v18 = *(void **)a1;
    if ( v87 != *(void **)a1 )
    {
      v85 = (int)((char *)v18 + 32);
      v86 = (int)((char *)v18 + 20);
      v84 = *(void **)a1;
      do
      {
        v74 = *(void **)v85;
        v19 = *(_DWORD *)(v85 - 4);
        v70 = v19;
        if ( *(_DWORD *)v85 != v19 )
        {
          v72 = v19 + 28;
          v20 = v19 + 48;
          v68 = *(_DWORD *)(v85 - 4);
          v78 = v19 + 60;
          v76 = v19 + 56;
          v82 = v19 + 20;
          v80 = v19 + 8;
          do
          {
            v21 = v68 - v70;
            v22 = *(_DWORD *)(v68 - v70 + v78);
            if ( v22 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v22 + 4));
              if ( !v22 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v23 = *(_DWORD *)(v21 + v76);
            if ( v23 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v23 + 4));
              if ( !v23 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v24 = *(void **)v20;
            v25 = *(void **)(v20 - 4);
            if ( *(void **)v20 != v25 )
            {
              do
              {
                v26 = *(_DWORD *)v25;
                v27 = *(_DWORD *)v25 - 12;
                if ( (_DWORD *)v27 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v57 = _InterlockedExchangeAdd((volatile signed __int32 *)(v26 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v62 = *(_DWORD *)(v26 - 4);
                    *(_DWORD *)(v26 - 4) = v62 - 1;
                    v57 = v62;
                  }
                  if ( v57 <= 0 )
                    std::string::_Rep::_M_destroy(v27, &v91);
                }
                v25 = (char *)v25 + 4;
              }
              while ( v24 != v25 );
              v24 = *(void **)(v68 + 44);
            }
            if ( v24 )
              operator delete(v24);
            v28 = *(void **)v72;
            v29 = *(void **)(v72 - 4);
            if ( *(void **)v72 != v29 )
            {
              do
              {
                v30 = *(_DWORD *)v29;
                v31 = *(_DWORD *)v29 - 12;
                if ( (_DWORD *)v31 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v56 = _InterlockedExchangeAdd((volatile signed __int32 *)(v30 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v61 = *(_DWORD *)(v30 - 4);
                    *(_DWORD *)(v30 - 4) = v61 - 1;
                    v56 = v61;
                  }
                  if ( v56 <= 0 )
                    std::string::_Rep::_M_destroy(v31, &v91);
                }
                v29 = (char *)v29 + 4;
              }
              while ( v28 != v29 );
              v28 = *(void **)(v68 + 24);
            }
            if ( v28 )
              operator delete(v28);
            v32 = *(_DWORD *)(v21 + v82);
            v33 = v32 - 12;
            if ( (_DWORD *)(v32 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v59 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
              }
              else
              {
                v67 = *(_DWORD *)(v32 - 4);
                *(_DWORD *)(v32 - 4) = v67 - 1;
                v59 = v67;
              }
              if ( v59 <= 0 )
                std::string::_Rep::_M_destroy(v33, &v91);
            }
            v34 = *(_DWORD *)(v21 + v80);
            if ( (_DWORD *)(v34 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v63 = _InterlockedExchangeAdd((volatile signed __int32 *)(v34 - 4), 0xFFFFFFFF);
              }
              else
              {
                v63 = *(_DWORD *)(v34 - 4);
                *(_DWORD *)(v34 - 4) = v63 - 1;
              }
              if ( v63 <= 0 )
                std::string::_Rep::_M_destroy(v34 - 12, &v91);
            }
            v68 += 64;
            v72 += 64;
            v20 += 64;
          }
          while ( v74 != (void *)v68 );
          v74 = (void *)*((_DWORD *)v84 + 7);
        }
        if ( v74 )
          operator delete(v74);
        v75 = *(void **)v86;
        v35 = *(_DWORD *)(v86 - 4);
        v71 = v35;
        if ( *(_DWORD *)v86 != v35 )
        {
          v73 = v35 + 28;
          v36 = v35 + 48;
          v69 = *(_DWORD *)(v86 - 4);
          v83 = v35 + 60;
          v81 = v35 + 56;
          v79 = v35 + 20;
          v77 = v35 + 8;
          do
          {
            v37 = v69 - v71;
            v38 = *(_DWORD *)(v69 - v71 + v83);
            if ( v38 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v38 + 4));
              if ( !v38 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v39 = *(_DWORD *)(v37 + v81);
            if ( v39 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v39 + 4));
              if ( !v39 )
                (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
            }
            v40 = *(void **)v36;
            v41 = *(void **)(v36 - 4);
            if ( *(void **)v36 != v41 )
            {
              do
              {
                v42 = *(_DWORD *)v41;
                v43 = *(_DWORD *)v41 - 12;
                if ( (_DWORD *)v43 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v55 = _InterlockedExchangeAdd((volatile signed __int32 *)(v42 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v66 = *(_DWORD *)(v42 - 4);
                    *(_DWORD *)(v42 - 4) = v66 - 1;
                    v55 = v66;
                  }
                  if ( v55 <= 0 )
                    std::string::_Rep::_M_destroy(v43, &v91);
                }
                v41 = (char *)v41 + 4;
              }
              while ( v40 != v41 );
              v40 = *(void **)(v69 + 44);
            }
            if ( v40 )
              operator delete(v40);
            v44 = *(void **)v73;
            v45 = *(void **)(v73 - 4);
            if ( *(void **)v73 != v45 )
            {
              do
              {
                v46 = *(_DWORD *)v45;
                v47 = *(_DWORD *)v45 - 12;
                if ( (_DWORD *)v47 != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v54 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
                  }
                  else
                  {
                    v60 = *(_DWORD *)(v46 - 4);
                    *(_DWORD *)(v46 - 4) = v60 - 1;
                    v54 = v60;
                  }
                  if ( v54 <= 0 )
                    std::string::_Rep::_M_destroy(v47, &v91);
                }
                v45 = (char *)v45 + 4;
              }
              while ( v44 != v45 );
              v44 = *(void **)(v69 + 24);
            }
            if ( v44 )
              operator delete(v44);
            v48 = *(_DWORD *)(v37 + v79);
            v49 = v48 - 12;
            if ( (_DWORD *)(v48 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v58 = _InterlockedExchangeAdd((volatile signed __int32 *)(v48 - 4), 0xFFFFFFFF);
              }
              else
              {
                v64 = *(_DWORD *)(v48 - 4);
                *(_DWORD *)(v48 - 4) = v64 - 1;
                v58 = v64;
              }
              if ( v58 <= 0 )
                std::string::_Rep::_M_destroy(v49, &v91);
            }
            v50 = *(_DWORD *)(v37 + v77);
            if ( (_DWORD *)(v50 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v65 = _InterlockedExchangeAdd((volatile signed __int32 *)(v50 - 4), 0xFFFFFFFF);
              }
              else
              {
                v65 = *(_DWORD *)(v50 - 4);
                *(_DWORD *)(v50 - 4) = v65 - 1;
              }
              if ( v65 <= 0 )
                std::string::_Rep::_M_destroy(v50 - 12, &v91);
            }
            v69 += 64;
            v73 += 64;
            v36 += 64;
          }
          while ( v75 != (void *)v69 );
          v75 = (void *)*((_DWORD *)v84 + 4);
        }
        if ( v75 )
          operator delete(v75);
        v51 = *(_DWORD *)v84;
        v52 = *(_DWORD *)v84 == 0;
        if ( *(_DWORD *)v84 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v51 + 4));
          if ( v52 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v51 + 4))(v51);
        }
        v84 = (char *)v84 + 44;
        v85 += 44;
        v86 += 44;
      }
      while ( v87 != v84 );
      v87 = *(void **)a1;
    }
  }
  if ( v87 )
    operator delete(v87);
  *(_DWORD *)a1 = v89;
  *(_DWORD *)(a1 + 4) = v90;
  result = v88 + v89;
  *(_DWORD *)(a1 + 8) = v88 + v89;
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08069240) --------------------------------------------------------
int __cdecl sub_8069240(int a1, int a2)
{
  int v2; // eax@1
  int v3; // ebx@3
  int v4; // ebx@3
  int v5; // ebx@3
  int v6; // ebx@3
  int result; // eax@4

  v2 = *(_DWORD *)(a1 + 4);
  if ( v2 == *(_DWORD *)(a1 + 8) )
  {
    result = sub_80689D0(a1, a2);
  }
  else
  {
    if ( v2 )
    {
      *(_DWORD *)v2 = *(_DWORD *)a2;
      *(_DWORD *)a2 = 0;
      *(_BYTE *)(v2 + 4) = *(_BYTE *)(a2 + 4);
      *(_BYTE *)(v2 + 5) = *(_BYTE *)(a2 + 5);
      *(_BYTE *)(v2 + 6) = *(_BYTE *)(a2 + 6);
      *(_DWORD *)(v2 + 8) = *(_DWORD *)(a2 + 8);
      *(_DWORD *)(v2 + 12) = *(_DWORD *)(a2 + 12);
      *(_DWORD *)(v2 + 16) = 0;
      *(_DWORD *)(v2 + 20) = 0;
      *(_DWORD *)(v2 + 24) = 0;
      *(_DWORD *)(v2 + 16) = *(_DWORD *)(a2 + 16);
      *(_DWORD *)(a2 + 16) = 0;
      v3 = *(_DWORD *)(v2 + 20);
      *(_DWORD *)(v2 + 20) = *(_DWORD *)(a2 + 20);
      *(_DWORD *)(a2 + 20) = v3;
      v4 = *(_DWORD *)(v2 + 24);
      *(_DWORD *)(v2 + 24) = *(_DWORD *)(a2 + 24);
      *(_DWORD *)(a2 + 24) = v4;
      *(_DWORD *)(v2 + 28) = 0;
      *(_DWORD *)(v2 + 32) = 0;
      *(_DWORD *)(v2 + 36) = 0;
      *(_DWORD *)(v2 + 28) = *(_DWORD *)(a2 + 28);
      *(_DWORD *)(a2 + 28) = 0;
      v5 = *(_DWORD *)(v2 + 32);
      *(_DWORD *)(v2 + 32) = *(_DWORD *)(a2 + 32);
      *(_DWORD *)(a2 + 32) = v5;
      v6 = *(_DWORD *)(v2 + 36);
      *(_DWORD *)(v2 + 36) = *(_DWORD *)(a2 + 36);
      *(_DWORD *)(a2 + 36) = v6;
      *(_DWORD *)(v2 + 40) = *(_DWORD *)(a2 + 40);
      v2 = *(_DWORD *)(a1 + 4);
    }
    result = v2 + 44;
    *(_DWORD *)(a1 + 4) = result;
  }
  return result;
}

//----- (08069320) --------------------------------------------------------
int __cdecl sub_8069320(void *a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  int result; // eax@3
  int v6; // esi@6
  int v7; // ebx@6
  int v8; // eax@6
  int v9; // edx@7
  int v10; // edx@9
  int v11; // edx@10
  int v12; // eax@12
  std::ostream *v13; // esi@12
  int v14; // eax@12
  int v15; // ebx@12
  char v16; // al@14
  std::ostream *v17; // eax@15
  int v18; // eax@16
  int v19; // edx@16
  signed __int32 v20; // eax@26
  signed __int32 v21; // ecx@30
  signed __int32 v22; // ecx@35
  signed __int32 v23; // ecx@38
  int v24; // [sp+Ch] [bp-100h]@3
  char v25; // [sp+2Eh] [bp-DEh]@37
  char v26; // [sp+2Fh] [bp-DDh]@8
  int v27; // [sp+30h] [bp-DCh]@2
  int v28; // [sp+34h] [bp-D8h]@6
  int v29; // [sp+38h] [bp-D4h]@8
  int v30; // [sp+3Ch] [bp-D0h]@6
  int v31; // [sp+40h] [bp-CCh]@6
  int v32; // [sp+44h] [bp-C8h]@6
  int v33; // [sp+48h] [bp-C4h]@6
  int v34; // [sp+4Ch] [bp-C0h]@6
  int v35; // [sp+50h] [bp-BCh]@6
  int v36; // [sp+54h] [bp-B8h]@6
  int v37; // [sp+58h] [bp-B4h]@6
  char v38; // [sp+5Ch] [bp-B0h]@6
  int v39; // [sp+60h] [bp-ACh]@6
  int v40; // [sp+64h] [bp-A8h]@6
  int v41; // [sp+68h] [bp-A4h]@6
  int v42; // [sp+D8h] [bp-34h]@6
  char v43; // [sp+DCh] [bp-30h]@6
  char v44; // [sp+DDh] [bp-2Fh]@6
  int v45; // [sp+E0h] [bp-2Ch]@6
  int v46; // [sp+E4h] [bp-28h]@6
  int v47; // [sp+E8h] [bp-24h]@6
  int v48; // [sp+ECh] [bp-20h]@6

  v4 = *((_DWORD *)a1 + 4);
  if ( !v4 )
  {
    sub_8067E80(a1);
    *((_DWORD *)a1 + 4) = v4;
  }
  v27 = a3;
  while ( 1 )
  {
    result = sub_808C480((int)((char *)a1 + 20), a2, (const void **)&v27, a4 + a3, (void **)v4, *(_DWORD *)(v4 + 4));
    if ( result != 4 )
      break;
    sub_8067E80(a1);
    *((_DWORD *)a1 + 4) = v4;
  }
  if ( result )
  {
    if ( log_level > 5 )
      goto LABEL_17;
    std::ios_base::ios_base((std::ios_base *)&v41);
    v41 = (int)&unk_80CF5C8;
    v42 = 0;
    v43 = 0;
    v44 = 0;
    v45 = 0;
    v46 = 0;
    v47 = 0;
    v48 = 0;
    v6 = dword_80CF674;
    v30 = dword_80CF674;
    *(int *)((char *)&v30 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v30 + *(_DWORD *)(v30 - 12), 0);
    v30 = (int)&unk_80CF5DC;
    v41 = (int)&unk_80CF5F0;
    v31 = (int)&unk_80CF7F0;
    v32 = 0;
    v33 = 0;
    v34 = 0;
    v35 = 0;
    v36 = 0;
    v37 = 0;
    std::locale::locale((std::locale *)&v38);
    v31 = (int)&unk_80CF588;
    v39 = 16;
    v40 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v41, &v31);
    v7 = std::__ostream_insert<char,std::char_traits<char>>(&v30, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v7, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v7, "res == JSTN_STATUS_SUCCESS", 26);
    std::__ostream_insert<char,std::char_traits<char>>(v7, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v7, "Could not write value", 21);
    v28 = (int)&unk_80CF83C;
    v8 = *(_DWORD *)(v7 + 24);
    if ( v8 )
    {
      v9 = *(_DWORD *)(v7 + 16);
      LOBYTE(v24) = 0;
      if ( v8 > (unsigned int)v9 )
      {
        v29 = std::string::_S_construct<char *>(v7, (unsigned int)&v38, &v41, *(_DWORD *)(v7 + 20), v8, (int)&v26);
        std::string::swap((std::string *)&v28, (std::string *)&v29);
      }
      else
      {
        v29 = std::string::_S_construct<char *>(v7, (unsigned int)&v38, &v41, *(_DWORD *)(v7 + 20), v9, (int)&v26);
        std::string::swap((std::string *)&v28, (std::string *)&v29);
      }
      v10 = v29 - 12;
      if ( (_DWORD *)(v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v22 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
        }
        else
        {
          v22 = *(_DWORD *)(v29 - 4);
          *(_DWORD *)(v29 - 4) = v22 - 1;
        }
        if ( v22 <= 0 )
          std::string::_Rep::_M_destroy(v10, &v25);
      }
    }
    else
    {
      std::string::assign((std::string *)&v28, (const std::string *)(v7 + 40));
    }
    v30 = (int)&unk_80CF5DC;
    v41 = (int)&unk_80CF5F0;
    v31 = (int)&unk_80CF588;
    v11 = v40 - 12;
    if ( (_DWORD *)(v40 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v21 = _InterlockedExchangeAdd((volatile signed __int32 *)(v40 - 4), 0xFFFFFFFF);
      }
      else
      {
        v21 = *(_DWORD *)(v40 - 4);
        *(_DWORD *)(v40 - 4) = v21 - 1;
      }
      if ( v21 <= 0 )
        std::string::_Rep::_M_destroy(v11, &v29);
    }
    v31 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v38);
    v30 = v6;
    *(int *)((char *)&v30 + *(_DWORD *)(v6 - 12)) = dword_80CF678;
    v41 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v41);
    if ( byte_80CE64C )
    {
      v12 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v28, *(_DWORD *)(v28 - 12));
      v13 = (std::ostream *)v12;
      v14 = *(_DWORD *)(*(_DWORD *)v12 - 12);
      v15 = *(_DWORD *)((char *)v13 + v14 + 124);
      if ( !v15 )
      {
        v18 = std::__throw_bad_cast();
LABEL_25:
        if ( &_pthread_key_create )
        {
          v20 = _InterlockedExchangeAdd((volatile signed __int32 *)(v18 - 4), 0xFFFFFFFF);
        }
        else
        {
          v23 = *(_DWORD *)(v18 - 4);
          *(_DWORD *)(v18 - 4) = v23 - 1;
          v20 = v23;
        }
        if ( v20 <= 0 )
          std::string::_Rep::_M_destroy(v19, &v30);
LABEL_17:
        abort();
      }
      if ( *(_BYTE *)(v15 + 28) )
      {
        v16 = *(_BYTE *)(v15 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v13 + v14 + 124));
        v16 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v15 + 24))(v15, 10);
      }
      v17 = (std::ostream *)std::ostream::put(v13, v16);
      std::ostream::flush(v17);
    }
    syslog(3, "%s", v28, v24);
    v18 = v28;
    v19 = v28 - 12;
    if ( (_DWORD *)(v28 - 12) == &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_17;
    goto LABEL_25;
  }
  return result;
}
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080698F0) --------------------------------------------------------
int __cdecl sub_80698F0(int a1, int a2)
{
  *(_DWORD *)(a2 + 32) = 0;
  return evdns_getaddrinfo_cancel(*(_DWORD *)(a2 + 36));
}
// 804CA20: using guessed type int __cdecl evdns_getaddrinfo_cancel(_DWORD);

//----- (08069910) --------------------------------------------------------
int __cdecl sub_8069910(int a1, int a2, int a3, unsigned int a4)
{
  int v4; // ebx@1
  int v5; // esi@1
  int v6; // eax@3
  int v7; // eax@4
  int v8; // eax@6
  int v9; // eax@11
  int v10; // edx@11
  int result; // eax@16
  bool v12; // zf@16
  int v13; // edi@20
  int v14; // esi@20
  int v15; // esi@20
  int v16; // eax@20
  int v17; // edx@20
  int v18; // ecx@21
  int v19; // edx@23
  int v20; // edx@24
  int v21; // eax@26
  std::ostream *v22; // edi@26
  int v23; // eax@26
  int v24; // esi@26
  char v25; // al@28
  std::ostream *v26; // eax@29
  int v27; // edx@30
  signed __int32 v28; // ecx@32
  int v29; // eax@38
  int v30; // edx@40
  int v31; // eax@41
  int v32; // edx@44
  int v33; // eax@46
  signed __int32 v34; // edi@53
  int v35; // ebx@59
  signed __int32 v36; // esi@63
  signed __int32 v37; // esi@67
  int v38; // [sp+Ch] [bp-F0h]@0
  int v39; // [sp+1Ch] [bp-E0h]@0
  char v40; // [sp+22h] [bp-DAh]@55
  char v41; // [sp+23h] [bp-D9h]@22
  int v42; // [sp+24h] [bp-D8h]@13
  int v43; // [sp+28h] [bp-D4h]@22
  int v44; // [sp+2Ch] [bp-D0h]@20
  int v45; // [sp+30h] [bp-CCh]@20
  int v46; // [sp+34h] [bp-C8h]@20
  int v47; // [sp+38h] [bp-C4h]@20
  int v48; // [sp+3Ch] [bp-C0h]@20
  int v49; // [sp+40h] [bp-BCh]@20
  int v50; // [sp+44h] [bp-B8h]@20
  int v51; // [sp+48h] [bp-B4h]@20
  char v52; // [sp+4Ch] [bp-B0h]@20
  int v53; // [sp+50h] [bp-ACh]@20
  int v54; // [sp+54h] [bp-A8h]@20
  int v55; // [sp+58h] [bp-A4h]@20
  int v56; // [sp+C8h] [bp-34h]@20
  char v57; // [sp+CCh] [bp-30h]@20
  char v58; // [sp+CDh] [bp-2Fh]@20
  int v59; // [sp+D0h] [bp-2Ch]@20
  int v60; // [sp+D4h] [bp-28h]@20
  int v61; // [sp+D8h] [bp-24h]@20
  int v62; // [sp+DCh] [bp-20h]@20

  v4 = a3;
  v5 = a1 + 12;
  if ( a1 == -12 )
  {
    v6 = std::__throw_system_error(1);
LABEL_57:
    v31 = std::__throw_system_error(v6);
    goto LABEL_58;
  }
  if ( &_pthread_key_create )
  {
    v6 = pthread_mutex_lock((pthread_mutex_t *)(a1 + 12));
    if ( v6 )
      goto LABEL_57;
  }
  v7 = *(_DWORD *)(a4 + 4);
  if ( v7 )
    *(_DWORD *)(v7 + 8) = *(_DWORD *)(a4 + 8);
  v8 = *(_DWORD *)(a4 + 8);
  if ( v8 )
    *(_DWORD *)(v8 + 4) = *(_DWORD *)(a4 + 4);
  *(_DWORD *)(a4 + 4) = 0;
  *(_DWORD *)(a4 + 8) = 0;
  if ( &_pthread_key_create )
    pthread_mutex_unlock((pthread_mutex_t *)v5);
  if ( log_level <= 1 )
  {
    v13 = *(_DWORD *)(a4 + 28);
    std::ios_base::ios_base((std::ios_base *)&v55);
    v55 = (int)&unk_80CF5C8;
    v56 = 0;
    v57 = 0;
    v58 = 0;
    v59 = 0;
    v60 = 0;
    v61 = 0;
    v62 = 0;
    v44 = dword_80CF674;
    *(int *)((char *)&v44 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v44 + *(_DWORD *)(v44 - 12), 0);
    v44 = (int)&unk_80CF5DC;
    v55 = (int)&unk_80CF5F0;
    v45 = (int)&unk_80CF7F0;
    v46 = 0;
    v47 = 0;
    v48 = 0;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    std::locale::locale((std::locale *)&v52);
    v45 = (int)&unk_80CF588;
    v53 = 16;
    v54 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v55, &v45);
    v14 = std::__ostream_insert<char,std::char_traits<char>>(
            &v44,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v14, "[DNS] done ", 11);
    v15 = std::__ostream_insert<char,std::char_traits<char>>(
            v14,
            *(_DWORD *)(v13 + 32),
            *(_DWORD *)(*(_DWORD *)(v13 + 32) - 12));
    std::__ostream_insert<char,std::char_traits<char>>(v15, ": ", 2);
    v16 = std::ostream::operator<<(v15, a2);
    v42 = (int)&unk_80CF83C;
    v17 = *(_DWORD *)(v16 + 24);
    if ( v17 )
    {
      v18 = *(_DWORD *)(v16 + 16);
      LOBYTE(v38) = 0;
      if ( v17 > (unsigned int)v18 )
      {
        v43 = std::string::_S_construct<char *>(a3, a4, (void *)v13, *(_DWORD *)(v16 + 20), v17, (int)&v41);
        std::string::swap((std::string *)&v42, (std::string *)&v43);
      }
      else
      {
        v43 = std::string::_S_construct<char *>(a3, a4, (void *)v13, *(_DWORD *)(v16 + 20), v18, (int)&v41);
        std::string::swap((std::string *)&v42, (std::string *)&v43);
      }
      v19 = v43 - 12;
      if ( (_DWORD *)(v43 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v43 - 4), 0xFFFFFFFF);
        }
        else
        {
          v37 = *(_DWORD *)(v43 - 4);
          *(_DWORD *)(v43 - 4) = v37 - 1;
        }
        if ( v37 <= 0 )
          std::string::_Rep::_M_destroy(v19, &v40);
      }
    }
    else
    {
      std::string::assign((std::string *)&v42, (const std::string *)(v16 + 40));
    }
    v44 = (int)&unk_80CF5DC;
    v55 = (int)&unk_80CF5F0;
    v45 = (int)&unk_80CF588;
    v20 = v54 - 12;
    if ( (_DWORD *)(v54 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v54 - 4), 0xFFFFFFFF);
      }
      else
      {
        v36 = *(_DWORD *)(v54 - 4);
        *(_DWORD *)(v54 - 4) = v36 - 1;
      }
      if ( v36 <= 0 )
        std::string::_Rep::_M_destroy(v20, &v43);
    }
    v45 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v52);
    v44 = dword_80CF674;
    *(int *)((char *)&v44 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v55 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v55);
    if ( byte_80CE64C )
    {
      v21 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v42, *(_DWORD *)(v42 - 12));
      v22 = (std::ostream *)v21;
      v23 = *(_DWORD *)(*(_DWORD *)v21 - 12);
      v24 = *(_DWORD *)((char *)v22 + v23 + 124);
      if ( !v24 )
      {
        v35 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v42 - 12, &v44);
        Unwind_Resume(v35);
      }
      if ( *(_BYTE *)(v24 + 28) )
      {
        v25 = *(_BYTE *)(v24 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v22 + v23 + 124));
        v25 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v24 + 24))(v24, 10);
      }
      v26 = (std::ostream *)std::ostream::put(v22, v25);
      std::ostream::flush(v26);
    }
    syslog(7, "%s", v42, v38);
    v27 = v42 - 12;
    if ( (_DWORD *)(v42 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v28 = _InterlockedExchangeAdd((volatile signed __int32 *)(v42 - 4), 0xFFFFFFFF);
      }
      else
      {
        v28 = *(_DWORD *)(v42 - 4);
        *(_DWORD *)(v42 - 4) = v28 - 1;
      }
      if ( v28 <= 0 )
        std::string::_Rep::_M_destroy(v27, &v44);
    }
  }
  v9 = operator new(0x1Cu);
  *(_DWORD *)(v9 + 4) = 0;
  *(_DWORD *)v9 = &off_80BA3F0;
  v10 = *(_DWORD *)(a4 + 28);
  *(_DWORD *)(v9 + 8) = v10;
  if ( v10 )
    _InterlockedIncrement((volatile signed __int32 *)(v10 + 4));
  *(_DWORD *)v9 = &off_80BA408;
  *(_DWORD *)(v9 + 12) = 0;
  *(_DWORD *)(v9 + 16) = 0;
  *(_DWORD *)(v9 + 20) = 0;
  *(_DWORD *)(v9 + 24) = 0;
  v42 = v9;
  _InterlockedIncrement((volatile signed __int32 *)(v9 + 4));
  v5 = v42;
  *(_DWORD *)(v42 + 12) = a2;
  if ( !a2 )
  {
    v39 = v5 + 16;
    if ( a3 )
    {
      while ( 1 )
      {
        v33 = *(_DWORD *)(v4 + 4);
        if ( v33 == 2 )
          break;
        if ( v33 == 10 )
        {
          v29 = evutil_inet_ntop(10, *(_DWORD *)(v4 + 20) + 8, &v44, 128);
LABEL_39:
          if ( v29 )
          {
            std::string::string(&v43, v29, &v41);
            v30 = *(_DWORD *)(v5 + 20);
            if ( v30 == *(_DWORD *)(v5 + 24) )
            {
              sub_8058720(v39, (int)&v43);
              v31 = v43;
            }
            else
            {
              v31 = v43;
              if ( v30 )
              {
                *(_DWORD *)v30 = v43;
                v43 = (int)&unk_80CF83C;
                v30 = *(_DWORD *)(v5 + 20);
                v31 = (int)&unk_80CF83C;
              }
              *(_DWORD *)(v5 + 20) = v30 + 4;
            }
            v32 = v31 - 12;
            if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v34 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
              }
              else
              {
LABEL_58:
                v34 = *(_DWORD *)(v31 - 4);
                *(_DWORD *)(v31 - 4) = v34 - 1;
              }
              if ( v34 <= 0 )
                std::string::_Rep::_M_destroy(v32, &v40);
            }
          }
        }
        v4 = *(_DWORD *)(v4 + 28);
        if ( !v4 )
          goto LABEL_14;
      }
      v29 = evutil_inet_ntop(2, *(_DWORD *)(v4 + 20) + 4, &v44, 128);
      goto LABEL_39;
    }
  }
LABEL_14:
  if ( *(_DWORD *)(a4 + 20) )
    (*(void (__cdecl **)(int, int *))(a4 + 24))(a4 + 12, &v42);
  result = v42;
  v12 = v42 == 0;
  if ( v42 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v42 + 4));
    if ( v12 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C480: using guessed type int __cdecl evutil_inet_ntop(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80BA3F0: using guessed type int (__cdecl *off_80BA3F0)(int);
// 80BA408: using guessed type int (__cdecl *off_80BA408)(int);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0806A110) --------------------------------------------------------
int __cdecl sub_806A110(int a1, int a2)
{
  const char *v2; // ebx@2
  size_t v3; // eax@2
  size_t v4; // edi@2
  int v5; // eax@5
  int result; // eax@8
  int v7; // esi@10
  unsigned int v8; // ebp@11
  int v9; // eax@12
  int v10; // ST24_4@17
  int v11; // ebp@18
  int v12; // ebx@18
  int v13; // esi@18
  int v14; // eax@18
  int v15; // edx@18
  int v16; // ecx@19
  int v17; // edx@21
  int v18; // eax@22
  int v19; // edx@22
  int v20; // eax@24
  std::ostream *v21; // esi@24
  int v22; // eax@24
  char v23; // al@26
  std::ostream *v24; // eax@27
  int v25; // edx@28
  signed __int32 v26; // eax@30
  int v27; // edi@34
  size_t v28; // eax@34
  int v29; // eax@34
  int v30; // edx@35
  int *v31; // ebp@36
  int v32; // esi@37
  int v33; // edx@38
  int v34; // eax@40
  std::ostream *v35; // edi@40
  int v36; // eax@40
  int v37; // esi@40
  char v38; // al@42
  std::ostream *v39; // eax@43
  int v40; // edx@44
  signed __int32 v41; // eax@46
  void *v42; // eax@50
  int v43; // edx@50
  void *v44; // edx@52
  int v45; // edi@52
  int v46; // eax@52
  unsigned int v47; // ecx@52
  int v48; // esi@54
  const char *v49; // eax@55
  int v50; // ecx@64
  int v51; // edx@67
  unsigned int v52; // ebp@77
  int v53; // esi@77
  size_t v54; // eax@77
  int *v55; // edx@77
  int v56; // ecx@78
  unsigned int v57; // eax@78
  int v58; // eax@81
  int v59; // edx@82
  int v60; // ebx@84
  int v61; // ebx@85
  int v62; // eax@87
  std::ostream *v63; // esi@87
  int v64; // eax@87
  int v65; // ebx@87
  char v66; // al@89
  std::ostream *v67; // eax@90
  int v68; // edx@91
  signed __int32 v69; // ecx@93
  int v70; // ebx@105
  signed __int32 v71; // ecx@110
  signed __int32 v72; // ecx@114
  int *v73; // eax@119
  signed __int32 v74; // ecx@122
  signed __int32 v75; // esi@125
  signed __int32 v76; // ecx@129
  signed __int32 v77; // esi@136
  signed __int32 v78; // esi@140
  signed __int32 v79; // ecx@145
  int v80; // [sp+Ch] [bp-240h]@0
  int v81; // [sp+Ch] [bp-240h]@13
  int *v82; // [sp+24h] [bp-228h]@0
  unsigned int v83; // [sp+24h] [bp-228h]@52
  int v84; // [sp+28h] [bp-224h]@2
  char v85; // [sp+37h] [bp-215h]@116
  int v86; // [sp+38h] [bp-214h]@13
  void *v87; // [sp+3Ch] [bp-210h]@10
  int v88; // [sp+40h] [bp-20Ch]@10
  char *v89; // [sp+44h] [bp-208h]@10
  int v90; // [sp+48h] [bp-204h]@15
  int v91; // [sp+4Ch] [bp-200h]@15
  int v92; // [sp+50h] [bp-1FCh]@15
  int v93; // [sp+54h] [bp-1F8h]@15
  int v94; // [sp+68h] [bp-1E4h]@20
  int v95; // [sp+6Ch] [bp-1E0h]@74
  int v96; // [sp+70h] [bp-1DCh]@74
  int v97; // [sp+74h] [bp-1D8h]@74
  int v98; // [sp+88h] [bp-1C4h]@13
  int v99; // [sp+C8h] [bp-184h]@20
  int v100; // [sp+CCh] [bp-180h]@34
  int v101; // [sp+D0h] [bp-17Ch]@34
  int v102; // [sp+D4h] [bp-178h]@34
  int v103; // [sp+D8h] [bp-174h]@34
  int v104; // [sp+DCh] [bp-170h]@34
  int v105; // [sp+E0h] [bp-16Ch]@34
  int v106; // [sp+E4h] [bp-168h]@34
  char v107; // [sp+E8h] [bp-164h]@34
  int v108; // [sp+ECh] [bp-160h]@34
  int v109; // [sp+F0h] [bp-15Ch]@34
  int v110; // [sp+F4h] [bp-158h]@34
  int v111; // [sp+164h] [bp-E8h]@34
  char v112; // [sp+168h] [bp-E4h]@34
  char v113; // [sp+169h] [bp-E3h]@34
  int v114; // [sp+16Ch] [bp-E0h]@34
  int v115; // [sp+170h] [bp-DCh]@34
  int v116; // [sp+174h] [bp-D8h]@34
  int v117; // [sp+178h] [bp-D4h]@34
  int v118; // [sp+17Ch] [bp-D0h]@8
  int v119; // [sp+180h] [bp-CCh]@8
  int v120; // [sp+184h] [bp-C8h]@8
  int v121; // [sp+188h] [bp-C4h]@8
  int v122; // [sp+18Ch] [bp-C0h]@18
  int v123; // [sp+190h] [bp-BCh]@18
  int v124; // [sp+194h] [bp-B8h]@18
  int v125; // [sp+198h] [bp-B4h]@18
  char v126; // [sp+19Ch] [bp-B0h]@18
  int v127; // [sp+1A0h] [bp-ACh]@18
  int v128; // [sp+1A4h] [bp-A8h]@18
  int v129; // [sp+1A8h] [bp-A4h]@18
  int v130; // [sp+218h] [bp-34h]@18
  char v131; // [sp+21Ch] [bp-30h]@18
  char v132; // [sp+21Dh] [bp-2Fh]@18
  int v133; // [sp+220h] [bp-2Ch]@18
  int v134; // [sp+224h] [bp-28h]@18
  int v135; // [sp+228h] [bp-24h]@18
  int v136; // [sp+22Ch] [bp-20h]@18

  if ( log_level <= 1 )
  {
    v11 = *(_DWORD *)(a2 + 28);
    v82 = &v118;
    std::ios_base::ios_base((std::ios_base *)&v129);
    v129 = (int)&unk_80CF5C8;
    v130 = 0;
    v131 = 0;
    v132 = 0;
    v133 = 0;
    v134 = 0;
    v135 = 0;
    v136 = 0;
    v12 = dword_80CF674;
    v118 = dword_80CF674;
    *(int *)((char *)&v118 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v118 + *(_DWORD *)(v118 - 12), 0);
    v118 = (int)&unk_80CF5DC;
    v129 = (int)&unk_80CF5F0;
    v119 = (int)&unk_80CF7F0;
    v120 = 0;
    v121 = 0;
    v122 = 0;
    v123 = 0;
    v124 = 0;
    v125 = 0;
    std::locale::locale((std::locale *)&v126);
    v119 = (int)&unk_80CF588;
    v127 = 16;
    v128 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v129, &v119);
    v13 = std::__ostream_insert<char,std::char_traits<char>>(
            &v118,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v13, "[DNS] request ", 14);
    v14 = std::__ostream_insert<char,std::char_traits<char>>(
            v13,
            *(_DWORD *)(v11 + 32),
            *(_DWORD *)(*(_DWORD *)(v11 + 32) - 12));
    v98 = (int)&unk_80CF83C;
    v15 = *(_DWORD *)(v14 + 24);
    if ( v15 )
    {
      v16 = *(_DWORD *)(v14 + 16);
      LOBYTE(v80) = 0;
      if ( v15 > (unsigned int)v16 )
      {
        v99 = std::string::_S_construct<char *>(v12, (unsigned int)&v94, &v129, *(_DWORD *)(v14 + 20), v15, (int)&v94);
        std::string::swap((std::string *)&v98, (std::string *)&v99);
      }
      else
      {
        v99 = std::string::_S_construct<char *>(v12, (unsigned int)&v94, &v129, *(_DWORD *)(v14 + 20), v16, (int)&v94);
        std::string::swap((std::string *)&v98, (std::string *)&v99);
      }
      v17 = v99 - 12;
      if ( (_DWORD *)(v99 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v78 = _InterlockedExchangeAdd((volatile signed __int32 *)(v99 - 4), 0xFFFFFFFF);
        }
        else
        {
          v78 = *(_DWORD *)(v99 - 4);
          *(_DWORD *)(v99 - 4) = v78 - 1;
        }
        if ( v78 <= 0 )
          std::string::_Rep::_M_destroy(v17, &v90);
      }
    }
    else
    {
      std::string::assign((std::string *)&v98, (const std::string *)(v14 + 40));
    }
    v118 = (int)&unk_80CF5DC;
    v129 = (int)&unk_80CF5F0;
    v119 = (int)&unk_80CF588;
    v18 = v128;
    v19 = v128 - 12;
    if ( (_DWORD *)(v128 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_135;
    while ( 1 )
    {
      v119 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v126);
      v118 = v12;
      *(int *)((char *)&v118 + *(_DWORD *)(v12 - 12)) = dword_80CF678;
      v129 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v129);
      if ( !byte_80CE64C )
        break;
      v20 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v98, *(_DWORD *)(v98 - 12));
      v21 = (std::ostream *)v20;
      v22 = *(_DWORD *)(*(_DWORD *)v20 - 12);
      v12 = *(_DWORD *)((char *)v21 + v22 + 124);
      if ( v12 )
      {
        if ( *(_BYTE *)(v12 + 28) )
        {
          v23 = *(_BYTE *)(v12 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v21 + v22 + 124));
          v23 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v12 + 24))(v12, 10);
        }
        v24 = (std::ostream *)std::ostream::put(v21, v23);
        std::ostream::flush(v24);
        break;
      }
      v18 = std::__throw_bad_cast();
LABEL_135:
      if ( &_pthread_key_create )
      {
        v77 = _InterlockedExchangeAdd((volatile signed __int32 *)(v18 - 4), 0xFFFFFFFF);
      }
      else
      {
        v77 = *(_DWORD *)(v18 - 4);
        *(_DWORD *)(v18 - 4) = v77 - 1;
      }
      if ( v77 <= 0 )
        std::string::_Rep::_M_destroy(v19, &v99);
    }
    syslog(7, "%s", v98, v80);
    v25 = v98 - 12;
    if ( (_DWORD *)(v98 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v98 - 4), 0xFFFFFFFF);
      }
      else
      {
        v79 = *(_DWORD *)(v98 - 4);
        *(_DWORD *)(v98 - 4) = v79 - 1;
        v26 = v79;
      }
      if ( v26 <= 0 )
        std::string::_Rep::_M_destroy(v25, &v118);
    }
  }
  v2 = *(const char **)(*(_DWORD *)(a2 + 28) + 32);
  v84 = *(_DWORD *)(a1 + 72);
  v3 = strlen(*(const char **)(*(_DWORD *)(a2 + 28) + 32));
  v4 = v3;
  if ( !v2 || (signed int)v3 <= 0 )
  {
LABEL_8:
    memset(&v118, 0, 0x20u);
    v119 = *(_DWORD *)v84;
    v118 = 2;
    v120 = 1;
    v121 = 6;
    result = evdns_getaddrinfo(*(_DWORD *)(v84 + 4), v2, 0, &v118, sub_806A0B0, a2);
    goto LABEL_9;
  }
  if ( *v2 >= 0 )
  {
    v5 = 0;
    do
    {
      ++v5;
      if ( v4 == v5 )
        goto LABEL_8;
    }
    while ( v2[v5] >= 0 );
  }
  v87 = 0;
  v88 = 0;
  v89 = 0;
  v7 = v4 + 1;
  if ( v4 == -1 )
  {
    v89 = 0;
    v88 = 0;
    v8 = 0;
    goto LABEL_12;
  }
  if ( (unsigned int)v7 > 0x3FFFFFFF )
  {
    v70 = std::__throw_bad_alloc();
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(v82);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v94);
    goto LABEL_106;
  }
  v42 = (void *)operator new(4 * v7);
  v87 = v42;
  v89 = (char *)v42 + 4 * v7;
  v43 = 0;
  do
    *((_DWORD *)v42 + v43++) = 0;
  while ( v43 != v7 );
  v8 = (unsigned int)v87;
  v44 = v87;
  v88 = (int)v89;
  v45 = (int)&v2[v4];
  v46 = (v89 - (_BYTE *)v87) >> 2;
  v47 = (unsigned int)((char *)v87 + 4 * v46);
  v83 = v47;
  if ( v47 <= (unsigned int)v87 || (unsigned int)v2 >= v45 )
  {
    v50 = 0;
    goto LABEL_68;
  }
  v48 = v45 - (_DWORD)v2;
  if ( v45 - (signed int)v2 <= 0 )
  {
    v50 = 0;
    goto LABEL_66;
  }
  v49 = v2;
  do
  {
    LOBYTE(v47) = *v49;
    if ( *v49 >= 0 )
    {
      *(_DWORD *)v44 = *v49;
      v47 = 1;
LABEL_57:
      v49 += v47;
      v44 = (char *)v44 + 4;
      if ( v83 <= (unsigned int)v44 )
        goto LABEL_64;
      goto LABEL_58;
    }
    if ( (unsigned __int8)v47 > 0xDFu )
    {
      if ( v48 <= 2 )
        break;
      *(_DWORD *)v44 = v49[2] & 0x3F | ((v49[1] & 0x3F) << 6) | (unsigned __int16)(((_WORD)v47 << 12) & 0xF000);
      v47 = 3;
      goto LABEL_57;
    }
    if ( v48 == 1 )
      break;
    *(_DWORD *)v44 = v49[1] & 0x3F | ((v47 & 0x1F) << 6);
    BYTE1(v47) = 0;
    v49 += 2;
    v44 = (char *)v44 + 4;
    if ( v83 <= (unsigned int)v44 )
    {
LABEL_64:
      v50 = (signed int)((char *)v44 - v8) >> 2;
      goto LABEL_67;
    }
LABEL_58:
    if ( v45 <= (unsigned int)v49 )
      goto LABEL_64;
    v48 = v45 - (_DWORD)v49;
  }
  while ( v45 - (signed int)v49 > 0 );
  v50 = (signed int)((char *)v44 - v8) >> 2;
LABEL_66:
  *(_DWORD *)v44 = 0;
LABEL_67:
  v8 = (unsigned int)v87;
  v51 = (v88 - (signed int)v87) >> 2;
  v46 = v51;
  if ( v51 >= (unsigned int)v50 )
  {
LABEL_68:
    if ( v50 < (unsigned int)v46 )
    {
      v9 = v8 + 4 * v50;
      v88 = v8 + 4 * v50;
      goto LABEL_13;
    }
LABEL_12:
    v9 = v88;
    goto LABEL_13;
  }
  sub_806B730((int)&v87, v50 - v51);
  v9 = v88;
  v8 = (unsigned int)v87;
LABEL_13:
  v86 = 64;
  if ( sub_80A71E0(v8, (signed int)(v9 - v8) >> 2, (int)&v98, (int)&v86) )
  {
    if ( log_level > 5 )
    {
      v31 = &v94;
    }
    else
    {
      std::ios_base::ios_base((std::ios_base *)&v110);
      v110 = (int)&unk_80CF5C8;
      v111 = 0;
      v112 = 0;
      v113 = 0;
      v114 = 0;
      v115 = 0;
      v116 = 0;
      v117 = 0;
      v99 = dword_80CF674;
      *(int *)((char *)&v99 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v99 + *(_DWORD *)(v99 - 12), 0);
      v99 = (int)&unk_80CF5DC;
      v110 = (int)&unk_80CF5F0;
      v100 = (int)&unk_80CF7F0;
      v101 = 0;
      v102 = 0;
      v103 = 0;
      v104 = 0;
      v105 = 0;
      v106 = 0;
      std::locale::locale((std::locale *)&v107);
      v100 = (int)&unk_80CF588;
      v108 = 16;
      v109 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v110, &v100);
      v27 = std::__ostream_insert<char,std::char_traits<char>>(
              &v99,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v27, "idna_encode failed for ", 23);
      v28 = strlen(v2);
      std::__ostream_insert<char,std::char_traits<char>>(v27, v2, v28);
      v94 = (int)&unk_80CF83C;
      v29 = *(_DWORD *)(v27 + 24);
      if ( v29 )
      {
        v30 = *(_DWORD *)(v27 + 16);
        LOBYTE(v81) = 0;
        if ( v29 <= (unsigned int)v30 )
        {
          v118 = std::string::_S_construct<char *>((int)v2, v8, (void *)v27, *(_DWORD *)(v27 + 20), v30, (int)&v90);
          v31 = &v94;
          std::string::swap((std::string *)&v94, (std::string *)&v118);
        }
        else
        {
          v118 = std::string::_S_construct<char *>((int)v2, v8, (void *)v27, *(_DWORD *)(v27 + 20), v29, (int)&v90);
          v31 = &v94;
          std::string::swap((std::string *)&v94, (std::string *)&v118);
        }
        v32 = v118 - 12;
        if ( (_DWORD *)(v118 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v76 = _InterlockedExchangeAdd((volatile signed __int32 *)(v118 - 4), 0xFFFFFFFF);
          }
          else
          {
            v76 = *(_DWORD *)(v118 - 4);
            *(_DWORD *)(v118 - 4) = v76 - 1;
          }
          if ( v76 <= 0 )
            std::string::_Rep::_M_destroy(v32, &v85);
        }
      }
      else
      {
        v31 = &v94;
        std::string::assign((std::string *)&v94, (const std::string *)(v27 + 40));
      }
      v99 = (int)&unk_80CF5DC;
      v110 = (int)&unk_80CF5F0;
      v100 = (int)&unk_80CF588;
      v33 = v109 - 12;
      if ( (_DWORD *)(v109 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v75 = _InterlockedExchangeAdd((volatile signed __int32 *)(v109 - 4), 0xFFFFFFFF);
        }
        else
        {
          v75 = *(_DWORD *)(v109 - 4);
          *(_DWORD *)(v109 - 4) = v75 - 1;
        }
        if ( v75 <= 0 )
          std::string::_Rep::_M_destroy(v33, &v118);
      }
      v100 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v107);
      v99 = dword_80CF674;
      *(int *)((char *)&v99 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v110 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v110);
      if ( byte_80CE64C )
      {
        v34 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v94, *(_DWORD *)(v94 - 12));
        v35 = (std::ostream *)v34;
        v36 = *(_DWORD *)(*(_DWORD *)v34 - 12);
        v37 = *(_DWORD *)((char *)v35 + v36 + 124);
        if ( !v37 )
        {
          v70 = std::__throw_bad_cast();
          v73 = &v118;
          goto LABEL_120;
        }
        if ( *(_BYTE *)(v37 + 28) )
        {
          v38 = *(_BYTE *)(v37 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v35 + v36 + 124));
          v38 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v37 + 24))(v37, 10);
        }
        v39 = (std::ostream *)std::ostream::put(v35, v38);
        std::ostream::flush(v39);
      }
      syslog(3, "%s", v94, v81);
      v40 = v94 - 12;
      if ( (_DWORD *)(v94 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v41 = _InterlockedExchangeAdd((volatile signed __int32 *)(v94 - 4), 0xFFFFFFFF);
        }
        else
        {
          v74 = *(_DWORD *)(v94 - 4);
          *(_DWORD *)(v94 - 4) = v74 - 1;
          v41 = v74;
        }
        if ( v41 <= 0 )
          std::string::_Rep::_M_destroy(v40, &v118);
      }
    }
    memset(v31, 0, 0x20u);
    v95 = *(_DWORD *)v84;
    v94 = 2;
    v96 = 1;
    v97 = 6;
    result = evdns_getaddrinfo(*(_DWORD *)(v84 + 4), v2, 0, v31, sub_806A0B0, a2);
  }
  else
  {
    *((_BYTE *)&v98 + v86) = 0;
    if ( log_level > 1 )
      goto LABEL_15;
    std::ios_base::ios_base((std::ios_base *)&v129);
    v129 = (int)&unk_80CF5C8;
    v130 = 0;
    v131 = 0;
    v132 = 0;
    v133 = 0;
    v134 = 0;
    v135 = 0;
    v136 = 0;
    v52 = dword_80CF674;
    v118 = dword_80CF674;
    *(int *)((char *)&v118 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v118 + *(_DWORD *)(v118 - 12), 0);
    v118 = (int)&unk_80CF5DC;
    v129 = (int)&unk_80CF5F0;
    v119 = (int)&unk_80CF7F0;
    v120 = 0;
    v121 = 0;
    v122 = 0;
    v123 = 0;
    v124 = 0;
    v125 = 0;
    std::locale::locale((std::locale *)&v126);
    v119 = (int)&unk_80CF588;
    v127 = 16;
    v128 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v129, &v119);
    v53 = std::__ostream_insert<char,std::char_traits<char>>(
            &v118,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v53, "dns ", 4);
    v54 = strlen(v2);
    std::__ostream_insert<char,std::char_traits<char>>(v53, v2, v54);
    std::__ostream_insert<char,std::char_traits<char>>(v53, " encoded as ", 12);
    v55 = &v98;
    do
    {
      v56 = *v55;
      ++v55;
      v57 = ~v56 & (v56 - 16843009) & 0x80808080;
    }
    while ( !v57 );
    if ( !(~v56 & (v56 - 16843009) & 0x8080) )
    {
      v57 >>= 16;
      v55 = (int *)((char *)v55 + 2);
    }
    std::__ostream_insert<char,std::char_traits<char>>(
      v53,
      &v98,
      (char *)v55 + -__CFADD__((_BYTE)v57, (_BYTE)v57) - 3 - (char *)&v98);
    v94 = (int)&unk_80CF83C;
    v58 = *(_DWORD *)(v53 + 24);
    if ( v58 )
    {
      v59 = *(_DWORD *)(v53 + 16);
      LOBYTE(v81) = 0;
      if ( v58 <= (unsigned int)v59 )
      {
        v99 = std::string::_S_construct<char *>((int)v2, v52, &v129, *(_DWORD *)(v53 + 20), v59, (int)&v90);
        std::string::swap((std::string *)&v94, (std::string *)&v99);
      }
      else
      {
        v99 = std::string::_S_construct<char *>((int)v2, v52, &v129, *(_DWORD *)(v53 + 20), v58, (int)&v90);
        std::string::swap((std::string *)&v94, (std::string *)&v99);
      }
      v60 = v99 - 12;
      if ( (_DWORD *)(v99 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v72 = _InterlockedExchangeAdd((volatile signed __int32 *)(v99 - 4), 0xFFFFFFFF);
        }
        else
        {
          v72 = *(_DWORD *)(v99 - 4);
          *(_DWORD *)(v99 - 4) = v72 - 1;
        }
        if ( v72 <= 0 )
          std::string::_Rep::_M_destroy(v60, &v85);
      }
    }
    else
    {
      std::string::assign((std::string *)&v94, (const std::string *)(v53 + 40));
    }
    v118 = (int)&unk_80CF5DC;
    v129 = (int)&unk_80CF5F0;
    v119 = (int)&unk_80CF588;
    v61 = v128 - 12;
    if ( (_DWORD *)(v128 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v71 = _InterlockedExchangeAdd((volatile signed __int32 *)(v128 - 4), 0xFFFFFFFF);
      }
      else
      {
        v71 = *(_DWORD *)(v128 - 4);
        *(_DWORD *)(v128 - 4) = v71 - 1;
      }
      if ( v71 <= 0 )
        std::string::_Rep::_M_destroy(v61, &v99);
    }
    v119 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v126);
    v118 = v52;
    *(int *)((char *)&v118 + *(_DWORD *)(v52 - 12)) = dword_80CF678;
    v129 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v129);
    if ( byte_80CE64C )
    {
      v62 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v94, *(_DWORD *)(v94 - 12));
      v63 = (std::ostream *)v62;
      v64 = *(_DWORD *)(*(_DWORD *)v62 - 12);
      v65 = *(_DWORD *)((char *)v63 + v64 + 124);
      if ( v65 )
      {
        if ( *(_BYTE *)(v65 + 28) )
        {
          v66 = *(_BYTE *)(v65 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v63 + v64 + 124));
          v66 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v65 + 24))(v65, 10);
        }
        v67 = (std::ostream *)std::ostream::put(v63, v66);
        std::ostream::flush(v67);
        goto LABEL_91;
      }
      v70 = std::__throw_bad_cast();
      v73 = &v118;
LABEL_120:
      std::string::_Rep::_M_dispose(v94 - 12, v73);
      if ( v87 )
        operator delete(v87);
LABEL_106:
      Unwind_Resume(v70);
    }
LABEL_91:
    syslog(7, "%s", v94, v81);
    v68 = v94 - 12;
    if ( (_DWORD *)(v94 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v69 = _InterlockedExchangeAdd((volatile signed __int32 *)(v94 - 4), 0xFFFFFFFF);
      }
      else
      {
        v69 = *(_DWORD *)(v94 - 4);
        *(_DWORD *)(v94 - 4) = v69 - 1;
      }
      if ( v69 <= 0 )
        std::string::_Rep::_M_destroy(v68, &v118);
    }
LABEL_15:
    memset(&v90, 0, 0x20u);
    v91 = *(_DWORD *)v84;
    v90 = 2;
    v92 = 1;
    v93 = 6;
    result = evdns_getaddrinfo(*(_DWORD *)(v84 + 4), &v98, 0, &v90, sub_806A0B0, a2);
  }
  if ( v87 )
  {
    v10 = result;
    operator delete(v87);
    result = v10;
  }
LABEL_9:
  *(_DWORD *)(a2 + 36) = result;
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C9F0: using guessed type int __cdecl evdns_getaddrinfo(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 806A0B0: using guessed type int sub_806A0B0();
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0806B560) --------------------------------------------------------
int __cdecl sub_806B560(int a1)
{
  int result; // eax@1

  *(_DWORD *)a1 = &off_80BA3F0;
  result = *(_DWORD *)(a1 + 8);
  if ( result )
  {
    _InterlockedDecrement((volatile signed __int32 *)(result + 4));
    if ( !result )
      result = (*(int (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BA2E8;
  return result;
}
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA3F0: using guessed type int (__cdecl *off_80BA3F0)(int);

//----- (0806B590) --------------------------------------------------------
void __cdecl sub_806B590(void *a1)
{
  int v1; // eax@1

  *(_DWORD *)a1 = &off_80BA3F0;
  v1 = *((_DWORD *)a1 + 2);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BA2E8;
  operator delete(a1);
}
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA3F0: using guessed type int (__cdecl *off_80BA3F0)(int);

//----- (0806B5D0) --------------------------------------------------------
int __cdecl sub_806B5D0(int a1)
{
  void *v1; // esi@1
  void *v2; // ebx@1
  int v3; // eax@2
  int v4; // edx@2
  int result; // eax@7
  signed __int32 v6; // ecx@12
  char v7; // [sp+1Fh] [bp-1Dh]@14

  *(_DWORD *)a1 = &off_80BA408;
  v1 = *(void **)(a1 + 20);
  v2 = *(void **)(a1 + 16);
  if ( v1 != v2 )
  {
    do
    {
      v3 = *(_DWORD *)v2;
      v4 = *(_DWORD *)v2 - 12;
      if ( (_DWORD *)v4 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v6 = _InterlockedExchangeAdd((volatile signed __int32 *)(v3 - 4), 0xFFFFFFFF);
        }
        else
        {
          v6 = *(_DWORD *)(v3 - 4);
          *(_DWORD *)(v3 - 4) = v6 - 1;
        }
        if ( v6 <= 0 )
          std::string::_Rep::_M_destroy(v4, &v7);
      }
      v2 = (char *)v2 + 4;
    }
    while ( v1 != v2 );
    v1 = *(void **)(a1 + 16);
  }
  if ( v1 )
    operator delete(v1);
  *(_DWORD *)a1 = &off_80BA3F0;
  result = *(_DWORD *)(a1 + 8);
  if ( result )
  {
    _InterlockedDecrement((volatile signed __int32 *)(result + 4));
    if ( !result )
      result = (*(int (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BA2E8;
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA3F0: using guessed type int (__cdecl *off_80BA3F0)(int);
// 80BA408: using guessed type int (__cdecl *off_80BA408)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0806B680) --------------------------------------------------------
void __cdecl sub_806B680(void *a1)
{
  void *v1; // esi@1
  void *v2; // ebx@1
  int v3; // eax@2
  int v4; // edx@2
  int v5; // eax@7
  signed __int32 v6; // ecx@12
  char v7; // [sp+1Fh] [bp-1Dh]@14

  *(_DWORD *)a1 = &off_80BA408;
  v1 = (void *)*((_DWORD *)a1 + 5);
  v2 = (void *)*((_DWORD *)a1 + 4);
  if ( v1 != v2 )
  {
    do
    {
      v3 = *(_DWORD *)v2;
      v4 = *(_DWORD *)v2 - 12;
      if ( (_DWORD *)v4 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v6 = _InterlockedExchangeAdd((volatile signed __int32 *)(v3 - 4), 0xFFFFFFFF);
        }
        else
        {
          v6 = *(_DWORD *)(v3 - 4);
          *(_DWORD *)(v3 - 4) = v6 - 1;
        }
        if ( v6 <= 0 )
          std::string::_Rep::_M_destroy(v4, &v7);
      }
      v2 = (char *)v2 + 4;
    }
    while ( v1 != v2 );
    v1 = (void *)*((_DWORD *)a1 + 4);
  }
  if ( v1 )
    operator delete(v1);
  *(_DWORD *)a1 = &off_80BA3F0;
  v5 = *((_DWORD *)a1 + 2);
  if ( v5 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
    if ( !v5 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BA2E8;
  operator delete(a1);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA3F0: using guessed type int (__cdecl *off_80BA3F0)(int);
// 80BA408: using guessed type int (__cdecl *off_80BA408)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0806B730) --------------------------------------------------------
void __cdecl sub_806B730(int a1, unsigned int a2)
{
  int v2; // eax@2
  unsigned int v3; // edx@3
  void *v4; // edx@7
  int v5; // eax@7
  int v6; // ecx@7
  int v7; // edi@7
  unsigned int v8; // edi@8
  unsigned __int8 v9; // cf@10
  unsigned int v10; // edi@11
  void *v11; // ebp@12
  size_t v12; // ecx@13
  size_t v13; // ST0C_4@14
  int v14; // eax@15
  unsigned int v15; // ecx@15
  int v16; // edx@15
  int v17; // ebx@17

  if ( !a2 )
    return;
  v2 = *(_DWORD *)(a1 + 4);
  if ( a2 <= (*(_DWORD *)(a1 + 8) - v2) >> 2 )
  {
    v3 = a2;
    do
    {
      *(_DWORD *)v2 = 0;
      v2 += 4;
      --v3;
    }
    while ( v3 );
    *(_DWORD *)(a1 + 4) += 4 * a2;
    return;
  }
  v4 = *(void **)a1;
  v5 = (v2 - *(_DWORD *)a1) >> 2;
  v6 = v5;
  v7 = 0x3FFFFFFF - v5;
  if ( a2 > 0x3FFFFFFF - v5 )
  {
    std::__throw_length_error("vector::_M_default_append");
LABEL_24:
    v10 = 4 * v7;
    goto LABEL_12;
  }
  v8 = v5;
  if ( v5 < a2 )
    v8 = a2;
  v9 = __CFADD__(v5, v8);
  v7 = v5 + v8;
  if ( !v9 && (unsigned int)v7 <= 0x3FFFFFFF )
  {
    if ( !v7 )
    {
      v10 = 0;
      v11 = 0;
      goto LABEL_13;
    }
    goto LABEL_24;
  }
  v10 = -4;
LABEL_12:
  v11 = (void *)operator new(v10);
  v4 = *(void **)a1;
  v5 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  v6 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
LABEL_13:
  v12 = 4 * v6;
  if ( v5 )
  {
    v13 = v12;
    memmove(v11, v4, v12);
    v12 = v13;
  }
  v14 = (int)((char *)v11 + v12);
  v15 = a2;
  v16 = v14;
  do
  {
    *(_DWORD *)v16 = 0;
    v16 += 4;
    --v15;
  }
  while ( v15 );
  v17 = v14 + 4 * a2;
  if ( *(_DWORD *)a1 )
    operator delete(*(void **)a1);
  *(_DWORD *)a1 = v11;
  *(_DWORD *)(a1 + 4) = v17;
  *(_DWORD *)(a1 + 8) = (char *)v11 + v10;
}

//----- (0806B850) --------------------------------------------------------
int __cdecl sub_806B850(int a1, void *a2)
{
  void *v2; // edi@1
  int v3; // eax@1
  int v4; // ebx@2
  signed int v5; // eax@3
  int v6; // ebx@6
  int v7; // esi@6
  int v8; // edi@6
  int v9; // eax@6
  int v10; // edx@7
  int v11; // edi@8
  int v12; // edx@9
  int v13; // edx@10
  int v14; // eax@12
  std::ostream *v15; // esi@12
  int v16; // eax@12
  int v17; // ebx@12
  char v18; // al@14
  std::ostream *v19; // eax@15
  int v20; // edx@17
  int v21; // eax@21
  signed int v22; // eax@22
  int v23; // ebx@25
  int v24; // eax@25
  int v25; // edx@26
  int v26; // ebx@28
  int v27; // edx@29
  int v28; // eax@31
  std::ostream *v29; // esi@31
  int v30; // eax@31
  int v31; // ebx@31
  char v32; // al@33
  std::ostream *v33; // eax@34
  int v34; // edi@40
  int v35; // edx@40
  int v36; // eax@40
  int v37; // edi@41
  signed int v38; // eax@42
  int v39; // ebx@45
  int v40; // eax@45
  int v41; // edx@46
  int v42; // edx@48
  int v43; // edx@49
  int v44; // eax@51
  std::ostream *v45; // esi@51
  int v46; // eax@51
  int v47; // ebx@51
  char v48; // al@53
  std::ostream *v49; // eax@54
  int v50; // eax@59
  int result; // eax@60
  int v52; // ebx@63
  int v53; // eax@63
  int v54; // edx@64
  int v55; // ebx@66
  int v56; // ebx@67
  int v57; // eax@69
  std::ostream *v58; // esi@69
  int v59; // eax@69
  int v60; // ebx@69
  char v61; // al@71
  std::ostream *v62; // eax@72
  int v63; // ecx@73
  signed __int32 v64; // eax@75
  int v65; // eax@80
  int v66; // ST2C_4@87
  int v67; // eax@90
  signed __int32 v68; // edx@95
  int v69; // eax@96
  int v70; // ebx@97
  int v71; // ebx@99
  signed __int32 v72; // ecx@102
  signed __int32 v73; // ecx@106
  signed __int32 v74; // ecx@112
  signed __int32 v75; // eax@117
  signed __int32 v76; // ecx@121
  signed __int32 v77; // ecx@124
  signed __int32 v78; // edx@128
  signed __int32 v79; // edx@132
  signed __int32 v80; // ecx@138
  signed __int32 v81; // ecx@142
  int v82; // [sp+Ch] [bp-110h]@3
  int v83; // [sp+Ch] [bp-110h]@22
  int v84; // [sp+Ch] [bp-110h]@42
  int v85; // [sp+Ch] [bp-110h]@60
  int *v86; // [sp+24h] [bp-F8h]@6
  int *v87; // [sp+24h] [bp-F8h]@39
  std::locale *v88; // [sp+28h] [bp-F4h]@38
  int *v89; // [sp+2Ch] [bp-F0h]@8
  char v90; // [sp+3Bh] [bp-E1h]@108
  char *v91; // [sp+3Ch] [bp-E0h]@2
  int v92; // [sp+40h] [bp-DCh]@8
  int v93; // [sp+44h] [bp-D8h]@6
  int v94; // [sp+48h] [bp-D4h]@8
  int v95; // [sp+4Ch] [bp-D0h]@6
  int v96; // [sp+50h] [bp-CCh]@6
  int v97; // [sp+54h] [bp-C8h]@6
  int v98; // [sp+58h] [bp-C4h]@6
  int v99; // [sp+5Ch] [bp-C0h]@6
  int v100; // [sp+60h] [bp-BCh]@6
  int v101; // [sp+64h] [bp-B8h]@6
  int v102; // [sp+68h] [bp-B4h]@6
  char v103; // [sp+6Ch] [bp-B0h]@6
  int v104; // [sp+70h] [bp-ACh]@6
  int v105; // [sp+74h] [bp-A8h]@6
  int v106; // [sp+78h] [bp-A4h]@6
  int v107; // [sp+E8h] [bp-34h]@6
  char v108; // [sp+ECh] [bp-30h]@6
  char v109; // [sp+EDh] [bp-2Fh]@6
  int v110; // [sp+F0h] [bp-2Ch]@6
  int v111; // [sp+F4h] [bp-28h]@6
  int v112; // [sp+F8h] [bp-24h]@6
  int v113; // [sp+FCh] [bp-20h]@6

  v2 = a2;
  v3 = *((_DWORD *)a2 + 4);
  if ( !v3 )
  {
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v3;
  }
  v91 = "ips";
  v4 = (int)((char *)a2 + 20);
  while ( 1 )
  {
    v5 = sub_808C480((int)((char *)a2 + 20), 3u, (const void **)&v91, (int)"", (void **)v3, *(_DWORD *)(v3 + 4));
    if ( v5 != 4 )
      break;
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v3;
  }
  if ( v5 )
  {
    if ( log_level > 5 )
      goto LABEL_18;
    v86 = &v95;
    std::ios_base::ios_base((std::ios_base *)&v106);
    v106 = (int)&unk_80CF5C8;
    v107 = 0;
    v108 = 0;
    v109 = 0;
    v110 = 0;
    v111 = 0;
    v112 = 0;
    v113 = 0;
    v6 = dword_80CF674;
    v95 = dword_80CF674;
    v7 = dword_80CF678;
    *(int *)((char *)&v95 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v95 + *(_DWORD *)(v95 - 12), 0);
    v95 = (int)&unk_80CF5DC;
    v106 = (int)&unk_80CF5F0;
    v96 = (int)&unk_80CF7F0;
    v97 = 0;
    v98 = 0;
    v99 = 0;
    v100 = 0;
    v101 = 0;
    v102 = 0;
    std::locale::locale((std::locale *)&v103);
    v96 = (int)&unk_80CF588;
    v104 = 16;
    v105 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v106, &v96);
    v8 = std::__ostream_insert<char,std::char_traits<char>>(&v95, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v8, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v8, "res == JSTN_STATUS_SUCCESS", 26);
    std::__ostream_insert<char,std::char_traits<char>>(v8, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v8, "Could not write value", 21);
    v93 = (int)&unk_80CF83C;
    v9 = *(_DWORD *)(v8 + 24);
    if ( v9 )
    {
      v10 = *(_DWORD *)(v8 + 16);
      LOBYTE(v82) = 0;
      if ( v9 > (unsigned int)v10 )
      {
        v89 = &v92;
        v94 = std::string::_S_construct<char *>(
                v6,
                (unsigned int)&v106,
                (void *)v8,
                *(_DWORD *)(v8 + 20),
                v9,
                (int)&v92);
        v11 = (int)&v94;
        std::string::swap((std::string *)&v93, (std::string *)&v94);
      }
      else
      {
        v89 = &v92;
        v94 = std::string::_S_construct<char *>(
                v6,
                (unsigned int)&v106,
                (void *)v8,
                *(_DWORD *)(v8 + 20),
                v10,
                (int)&v92);
        v11 = (int)&v94;
        std::string::swap((std::string *)&v93, (std::string *)&v94);
      }
      v12 = v94 - 12;
      if ( (_DWORD *)(v94 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        v11 = (int)&_pthread_key_create;
        if ( &_pthread_key_create )
        {
          v76 = _InterlockedExchangeAdd((volatile signed __int32 *)(v94 - 4), 0xFFFFFFFF);
        }
        else
        {
          v76 = *(_DWORD *)(v94 - 4);
          v11 = v76 - 1;
          *(_DWORD *)(v94 - 4) = v76 - 1;
        }
        if ( v76 <= 0 )
          std::string::_Rep::_M_destroy(v12, &v90);
      }
    }
    else
    {
      v11 = v8 + 40;
      v89 = &v92;
      std::string::assign((std::string *)&v93, (const std::string *)v11);
    }
    v95 = (int)&unk_80CF5DC;
    v106 = (int)&unk_80CF5F0;
    v96 = (int)&unk_80CF588;
    v13 = v105 - 12;
    if ( (_DWORD *)(v105 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      v11 = (int)&_pthread_key_create;
      if ( &_pthread_key_create )
      {
        v74 = _InterlockedExchangeAdd((volatile signed __int32 *)(v105 - 4), 0xFFFFFFFF);
      }
      else
      {
        v74 = *(_DWORD *)(v105 - 4);
        v11 = v74 - 1;
        *(_DWORD *)(v105 - 4) = v74 - 1;
      }
      if ( v74 <= 0 )
        std::string::_Rep::_M_destroy(v13, &v94);
    }
    v96 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v103);
    v95 = v6;
    *(int *)((char *)&v95 + *(_DWORD *)(v6 - 12)) = v7;
    v106 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v106);
    if ( byte_80CE64C )
    {
      v14 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v93, *(_DWORD *)(v93 - 12));
      v15 = (std::ostream *)v14;
      v16 = *(_DWORD *)(*(_DWORD *)v14 - 12);
      v17 = *(_DWORD *)((char *)v15 + v16 + 124);
      if ( !v17 )
      {
        v71 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v94 - 12, v15);
        std::string::_Rep::_M_dispose(v93 - 12, v11);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v95);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v89);
        Unwind_Resume(v71);
      }
      if ( *(_BYTE *)(v17 + 28) )
      {
        v18 = *(_BYTE *)(v17 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v15 + v16 + 124));
        v18 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v17 + 24))(v17, 10);
      }
      v19 = (std::ostream *)std::ostream::put(v15, v18);
      std::ostream::flush(v19);
    }
    syslog(3, "%s", v93, v82);
LABEL_17:
    v20 = v93 - 12;
    if ( (_DWORD *)(v93 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v75 = _InterlockedExchangeAdd((volatile signed __int32 *)(v93 - 4), 0xFFFFFFFF);
      }
      else
      {
        v77 = *(_DWORD *)(v93 - 4);
        *(_DWORD *)(v93 - 4) = v77 - 1;
        v75 = v77;
      }
      if ( v75 <= 0 )
        std::string::_Rep::_M_destroy(v20, v86);
    }
    goto LABEL_18;
  }
  v21 = *((_DWORD *)a2 + 4);
  if ( !v21 )
  {
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v21;
  }
  v22 = sub_808C370((int)((char *)a2 + 20), 6u, v21, *(_DWORD *)(v21 + 4));
  if ( v22 == 4 )
  {
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v65;
    v22 = sub_808C370((int)((char *)a2 + 20), 6u, v65, *(_DWORD *)(v65 + 4));
  }
  if ( v22 )
  {
    if ( log_level > 5 )
      goto LABEL_18;
    v86 = &v95;
    std::ios_base::ios_base((std::ios_base *)&v106);
    v106 = (int)&unk_80CF5C8;
    v107 = 0;
    v108 = 0;
    v109 = 0;
    v110 = 0;
    v111 = 0;
    v112 = 0;
    v113 = 0;
    v95 = dword_80CF674;
    *(int *)((char *)&v95 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v95 + *(_DWORD *)(v95 - 12), 0);
    v95 = (int)&unk_80CF5DC;
    v106 = (int)&unk_80CF5F0;
    v96 = (int)&unk_80CF7F0;
    v97 = 0;
    v98 = 0;
    v99 = 0;
    v100 = 0;
    v101 = 0;
    v102 = 0;
    std::locale::locale((std::locale *)&v103);
    v96 = (int)&unk_80CF588;
    v104 = 16;
    v105 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v106, &v96);
    v23 = std::__ostream_insert<char,std::char_traits<char>>(
            &v95,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v23, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v23, "res == JSTN_STATUS_SUCCESS", 26);
    std::__ostream_insert<char,std::char_traits<char>>(v23, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v23, "Could not write token", 21);
    v93 = (int)&unk_80CF83C;
    v24 = *(_DWORD *)(v23 + 24);
    if ( v24 )
    {
      v25 = *(_DWORD *)(v23 + 16);
      LOBYTE(v83) = 0;
      if ( v24 > (unsigned int)v25 )
      {
        v94 = std::string::_S_construct<char *>(v23, (unsigned int)&v106, &v96, *(_DWORD *)(v23 + 20), v24, (int)&v92);
        std::string::swap((std::string *)&v93, (std::string *)&v94);
      }
      else
      {
        v94 = std::string::_S_construct<char *>(v23, (unsigned int)&v106, &v96, *(_DWORD *)(v23 + 20), v25, (int)&v92);
        std::string::swap((std::string *)&v93, (std::string *)&v94);
      }
      v26 = v94 - 12;
      if ( (_DWORD *)(v94 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v81 = _InterlockedExchangeAdd((volatile signed __int32 *)(v94 - 4), 0xFFFFFFFF);
        }
        else
        {
          v81 = *(_DWORD *)(v94 - 4);
          *(_DWORD *)(v94 - 4) = v81 - 1;
        }
        if ( v81 <= 0 )
          std::string::_Rep::_M_destroy(v26, &v91);
      }
    }
    else
    {
      std::string::assign((std::string *)&v93, (const std::string *)(v23 + 40));
    }
    v95 = (int)&unk_80CF5DC;
    v106 = (int)&unk_80CF5F0;
    v96 = (int)&unk_80CF588;
    v27 = v105 - 12;
    if ( (_DWORD *)(v105 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v80 = _InterlockedExchangeAdd((volatile signed __int32 *)(v105 - 4), 0xFFFFFFFF);
      }
      else
      {
        v80 = *(_DWORD *)(v105 - 4);
        *(_DWORD *)(v105 - 4) = v80 - 1;
      }
      if ( v80 <= 0 )
        std::string::_Rep::_M_destroy(v27, &v94);
    }
    v96 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v103);
    v95 = dword_80CF674;
    *(int *)((char *)&v95 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v106 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v106);
    if ( byte_80CE64C )
    {
      v28 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v93, *(_DWORD *)(v93 - 12));
      v29 = (std::ostream *)v28;
      v30 = *(_DWORD *)(*(_DWORD *)v28 - 12);
      v31 = *(_DWORD *)((char *)v29 + v30 + 124);
      if ( !v31 )
      {
        v69 = std::__throw_bad_cast();
        goto LABEL_97;
      }
      if ( *(_BYTE *)(v31 + 28) )
      {
        v32 = *(_BYTE *)(v31 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v29 + v30 + 124));
        v32 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v31 + 24))(v31, 10);
      }
      v33 = (std::ostream *)std::ostream::put(v29, v32);
      std::ostream::flush(v33);
    }
    syslog(3, "%s", v93, v83);
    goto LABEL_17;
  }
  v88 = *(std::locale **)(a1 + 20);
  if ( *(std::locale **)(a1 + 16) == v88 )
    goto LABEL_59;
  v87 = *(int **)(a1 + 16);
  do
  {
    v34 = *v87;
    v35 = *(_DWORD *)(*v87 - 12);
    v36 = *((_DWORD *)a2 + 4);
    if ( !v36 )
    {
      v66 = *(_DWORD *)(*v87 - 12);
      sub_8067E80(a2);
      *((_DWORD *)a2 + 4) = v36;
      v35 = v66;
    }
    v92 = v34;
    v37 = v35 + v34;
    while ( 1 )
    {
      v38 = sub_808C480(v4, 2u, (const void **)&v92, v37, (void **)v36, *(_DWORD *)(v36 + 4));
      if ( v38 != 4 )
        break;
      sub_8067E80(a2);
      *((_DWORD *)a2 + 4) = v36;
    }
    if ( v38 )
    {
      if ( log_level > 5 )
        goto LABEL_18;
      v86 = &v95;
      std::ios_base::ios_base((std::ios_base *)&v106);
      v106 = (int)&unk_80CF5C8;
      v107 = 0;
      v108 = 0;
      v109 = 0;
      v110 = 0;
      v111 = 0;
      v112 = 0;
      v113 = 0;
      v95 = dword_80CF674;
      *(int *)((char *)&v95 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v95 + *(_DWORD *)(v95 - 12), 0);
      v95 = (int)&unk_80CF5DC;
      v106 = (int)&unk_80CF5F0;
      v96 = (int)&unk_80CF7F0;
      v97 = 0;
      v98 = 0;
      v99 = 0;
      v100 = 0;
      v101 = 0;
      v102 = 0;
      std::locale::locale((std::locale *)&v103);
      v96 = (int)&unk_80CF588;
      v104 = 16;
      v105 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v106, &v96);
      v39 = std::__ostream_insert<char,std::char_traits<char>>(
              &v95,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v39, "VERIFY failed (", 15);
      std::__ostream_insert<char,std::char_traits<char>>(v39, "res == JSTN_STATUS_SUCCESS", 26);
      std::__ostream_insert<char,std::char_traits<char>>(v39, "): ", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v39, "Could not write value", 21);
      v93 = (int)&unk_80CF83C;
      v40 = *(_DWORD *)(v39 + 24);
      if ( v40 )
      {
        v41 = *(_DWORD *)(v39 + 16);
        LOBYTE(v84) = 0;
        if ( v40 <= (unsigned int)v41 )
        {
          v94 = std::string::_S_construct<char *>(v39, (unsigned int)&v106, &v96, *(_DWORD *)(v39 + 20), v41, (int)&v91);
          std::string::swap((std::string *)&v93, (std::string *)&v94);
        }
        else
        {
          v94 = std::string::_S_construct<char *>(v39, (unsigned int)&v106, &v96, *(_DWORD *)(v39 + 20), v40, (int)&v91);
          std::string::swap((std::string *)&v93, (std::string *)&v94);
        }
        v42 = v94 - 12;
        if ( (_DWORD *)(v94 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v73 = _InterlockedExchangeAdd((volatile signed __int32 *)(v94 - 4), 0xFFFFFFFF);
          }
          else
          {
            v73 = *(_DWORD *)(v94 - 4);
            *(_DWORD *)(v94 - 4) = v73 - 1;
          }
          if ( v73 <= 0 )
            std::string::_Rep::_M_destroy(v42, &v90);
        }
      }
      else
      {
        std::string::assign((std::string *)&v93, (const std::string *)(v39 + 40));
      }
      v95 = (int)&unk_80CF5DC;
      v106 = (int)&unk_80CF5F0;
      v96 = (int)&unk_80CF588;
      v43 = v105 - 12;
      if ( (_DWORD *)(v105 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v72 = _InterlockedExchangeAdd((volatile signed __int32 *)(v105 - 4), 0xFFFFFFFF);
        }
        else
        {
          v72 = *(_DWORD *)(v105 - 4);
          *(_DWORD *)(v105 - 4) = v72 - 1;
        }
        if ( v72 <= 0 )
          std::string::_Rep::_M_destroy(v43, &v94);
      }
      v96 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v103);
      v95 = dword_80CF674;
      *(int *)((char *)&v95 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v106 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v106);
      if ( byte_80CE64C )
      {
        v44 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v93, *(_DWORD *)(v93 - 12));
        v45 = (std::ostream *)v44;
        v46 = *(_DWORD *)(*(_DWORD *)v44 - 12);
        v47 = *(_DWORD *)((char *)v45 + v46 + 124);
        if ( !v47 )
        {
          v69 = std::__throw_bad_cast();
          goto LABEL_97;
        }
        if ( *(_BYTE *)(v47 + 28) )
        {
          v48 = *(_BYTE *)(v47 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v45 + v46 + 124));
          v48 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v47 + 24))(v47, 10);
        }
        v49 = (std::ostream *)std::ostream::put(v45, v48);
        std::ostream::flush(v49);
      }
      syslog(3, "%s", v93, v84);
      goto LABEL_17;
    }
    ++v87;
  }
  while ( (int *)v88 != v87 );
  v2 = a2;
LABEL_59:
  v50 = *((_DWORD *)v2 + 4);
  if ( !v50 )
  {
    sub_8067E80(v2);
    *((_DWORD *)v2 + 4) = v50;
  }
  result = sub_808C370(v4, 7u, v50, *(_DWORD *)(v50 + 4));
  if ( result == 4 )
  {
    sub_8067E80(v2);
    *((_DWORD *)v2 + 4) = v67;
    result = sub_808C370(v4, 7u, v67, *(_DWORD *)(v67 + 4));
  }
  if ( result )
  {
    if ( log_level <= 5 )
    {
      v86 = &v95;
      std::ios_base::ios_base((std::ios_base *)&v106);
      v106 = (int)&unk_80CF5C8;
      v107 = 0;
      v108 = 0;
      v109 = 0;
      v110 = 0;
      v111 = 0;
      v112 = 0;
      v113 = 0;
      v95 = dword_80CF674;
      *(int *)((char *)&v95 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v95 + *(_DWORD *)(v95 - 12), 0);
      v95 = (int)&unk_80CF5DC;
      v106 = (int)&unk_80CF5F0;
      v96 = (int)&unk_80CF7F0;
      v97 = 0;
      v98 = 0;
      v99 = 0;
      v100 = 0;
      v101 = 0;
      v102 = 0;
      std::locale::locale((std::locale *)&v103);
      v96 = (int)&unk_80CF588;
      v104 = 16;
      v105 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v106, &v96);
      v52 = std::__ostream_insert<char,std::char_traits<char>>(
              &v95,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v52, "VERIFY failed (", 15);
      std::__ostream_insert<char,std::char_traits<char>>(v52, "res == JSTN_STATUS_SUCCESS", 26);
      std::__ostream_insert<char,std::char_traits<char>>(v52, "): ", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v52, "Could not write token", 21);
      v93 = (int)&unk_80CF83C;
      v53 = *(_DWORD *)(v52 + 24);
      if ( v53 )
      {
        v54 = *(_DWORD *)(v52 + 16);
        LOBYTE(v85) = 0;
        if ( v53 <= (unsigned int)v54 )
        {
          v94 = std::string::_S_construct<char *>(v52, (unsigned int)&v106, &v96, *(_DWORD *)(v52 + 20), v54, (int)&v92);
          std::string::swap((std::string *)&v93, (std::string *)&v94);
        }
        else
        {
          v94 = std::string::_S_construct<char *>(v52, (unsigned int)&v106, &v96, *(_DWORD *)(v52 + 20), v53, (int)&v92);
          std::string::swap((std::string *)&v93, (std::string *)&v94);
        }
        v55 = v94 - 12;
        if ( (_DWORD *)(v94 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v79 = _InterlockedExchangeAdd((volatile signed __int32 *)(v94 - 4), 0xFFFFFFFF);
          }
          else
          {
            v79 = *(_DWORD *)(v94 - 4);
            *(_DWORD *)(v94 - 4) = v79 - 1;
          }
          if ( v79 <= 0 )
            std::string::_Rep::_M_destroy(v55, &v91);
        }
      }
      else
      {
        std::string::assign((std::string *)&v93, (const std::string *)(v52 + 40));
      }
      v95 = (int)&unk_80CF5DC;
      v106 = (int)&unk_80CF5F0;
      v96 = (int)&unk_80CF588;
      v56 = v105 - 12;
      if ( (_DWORD *)(v105 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v78 = _InterlockedExchangeAdd((volatile signed __int32 *)(v105 - 4), 0xFFFFFFFF);
        }
        else
        {
          v78 = *(_DWORD *)(v105 - 4);
          *(_DWORD *)(v105 - 4) = v78 - 1;
        }
        if ( v78 <= 0 )
          std::string::_Rep::_M_destroy(v56, &v94);
      }
      v96 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v103);
      v95 = dword_80CF674;
      *(int *)((char *)&v95 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v106 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v106);
      if ( byte_80CE64C )
      {
        v57 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v93, *(_DWORD *)(v93 - 12));
        v58 = (std::ostream *)v57;
        v59 = *(_DWORD *)(*(_DWORD *)v57 - 12);
        v60 = *(_DWORD *)((char *)v58 + v59 + 124);
        if ( v60 )
        {
          if ( *(_BYTE *)(v60 + 28) )
          {
            v61 = *(_BYTE *)(v60 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v58 + v59 + 124));
            v61 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v60 + 24))(v60, 10);
          }
          v62 = (std::ostream *)std::ostream::put(v58, v61);
          std::ostream::flush(v62);
          goto LABEL_73;
        }
        v69 = std::__throw_bad_cast();
LABEL_97:
        v70 = v69;
        std::string::_Rep::_M_dispose(v93 - 12, v86);
        Unwind_Resume(v70);
      }
LABEL_73:
      syslog(3, "%s", v93, v85);
      v63 = v93 - 12;
      if ( (_DWORD *)(v93 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v64 = _InterlockedExchangeAdd((volatile signed __int32 *)(v93 - 4), 0xFFFFFFFF);
        }
        else
        {
          v68 = *(_DWORD *)(v93 - 4);
          *(_DWORD *)(v93 - 4) = v68 - 1;
          v64 = v68;
        }
        if ( v64 <= 0 )
          std::string::_Rep::_M_destroy(v63, &v95);
      }
    }
LABEL_18:
    abort();
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0806CCE0) --------------------------------------------------------
int __cdecl sub_806CCE0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BA528;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BA528: using guessed type void *off_80BA528;

//----- (0806CD80) --------------------------------------------------------
int __cdecl sub_806CD80(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BA530;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BA530: using guessed type void *off_80BA530;

//----- (0806CE20) --------------------------------------------------------
void __cdecl sub_806CE20(int a1, int a2)
{
  int v2; // edi@2
  int v3; // esi@2
  int v4; // eax@2
  signed int v5; // ebp@3
  size_t v6; // eax@4
  int v7; // eax@6
  int v8; // edx@7
  int v9; // edx@9
  int v10; // edx@10
  int v11; // eax@12
  std::ostream *v12; // edi@12
  int v13; // eax@12
  int v14; // esi@12
  char v15; // al@14
  std::ostream *v16; // eax@15
  int v17; // edx@16
  int v18; // esi@17
  int v19; // edi@17
  int v20; // ecx@17
  int v21; // edx@17
  int v22; // eax@17
  signed __int32 v23; // eax@26
  signed __int32 v24; // ecx@31
  signed __int32 v25; // ecx@35
  int v26; // ebx@38
  signed __int32 v27; // ecx@40
  int v28; // [sp+Ch] [bp-F0h]@0
  char v29; // [sp+16h] [bp-E6h]@37
  char v30; // [sp+17h] [bp-E5h]@8
  int v31; // [sp+18h] [bp-E4h]@6
  int v32; // [sp+1Ch] [bp-E0h]@8
  int v33; // [sp+20h] [bp-DCh]@17
  void (__cdecl *v34)(int *, int *, signed int); // [sp+24h] [bp-D8h]@17
  int v35; // [sp+28h] [bp-D4h]@17
  int v36; // [sp+2Ch] [bp-D0h]@2
  int v37; // [sp+30h] [bp-CCh]@2
  int v38; // [sp+34h] [bp-C8h]@2
  int v39; // [sp+38h] [bp-C4h]@2
  int v40; // [sp+3Ch] [bp-C0h]@2
  int v41; // [sp+40h] [bp-BCh]@2
  int v42; // [sp+44h] [bp-B8h]@2
  int v43; // [sp+48h] [bp-B4h]@2
  char v44; // [sp+4Ch] [bp-B0h]@2
  int v45; // [sp+50h] [bp-ACh]@2
  int v46; // [sp+54h] [bp-A8h]@2
  int v47; // [sp+58h] [bp-A4h]@2
  int v48; // [sp+C8h] [bp-34h]@2
  char v49; // [sp+CCh] [bp-30h]@2
  char v50; // [sp+CDh] [bp-2Fh]@2
  int v51; // [sp+D0h] [bp-2Ch]@2
  int v52; // [sp+D4h] [bp-28h]@2
  int v53; // [sp+D8h] [bp-24h]@2
  int v54; // [sp+DCh] [bp-20h]@2

  if ( log_level > 2 )
    goto LABEL_17;
  std::ios_base::ios_base((std::ios_base *)&v47);
  v47 = (int)&unk_80CF5C8;
  v48 = 0;
  v49 = 0;
  v50 = 0;
  v51 = 0;
  v52 = 0;
  v53 = 0;
  v54 = 0;
  v2 = dword_80CF674;
  v36 = dword_80CF674;
  *(int *)((char *)&v36 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v36 + *(_DWORD *)(v36 - 12), 0);
  v36 = (int)&unk_80CF5DC;
  v47 = (int)&unk_80CF5F0;
  v37 = (int)&unk_80CF7F0;
  v38 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  v42 = 0;
  v43 = 0;
  std::locale::locale((std::locale *)&v44);
  v37 = (int)&unk_80CF588;
  v45 = 16;
  v46 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v47, &v37);
  v3 = std::__ostream_insert<char,std::char_traits<char>>(&v36, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v3, "[HTTP DL] canceled ", 19);
  v4 = *(_DWORD *)(a2 + 36);
  if ( v4 )
  {
    v5 = *(_DWORD *)(v4 + 8);
    if ( !v5 )
    {
      std::basic_ios<char,std::char_traits<char>>::clear(
        v3 + *(_DWORD *)(*(_DWORD *)v3 - 12),
        *(_DWORD *)(v3 + *(_DWORD *)(*(_DWORD *)v3 - 12) + 20) | 1);
      goto LABEL_6;
    }
    v6 = strlen(*(const char **)(v4 + 8));
  }
  else
  {
    v6 = 0;
    v5 = 134986579;
  }
  std::__ostream_insert<char,std::char_traits<char>>(v3, v5, v6);
LABEL_6:
  v31 = (int)&unk_80CF83C;
  v7 = *(_DWORD *)(v3 + 24);
  if ( v7 )
  {
    v8 = *(_DWORD *)(v3 + 16);
    LOBYTE(v28) = 0;
    if ( v7 <= (unsigned int)v8 )
    {
      v32 = std::string::_S_construct<char *>(a2, (unsigned int)&v30, (void *)v2, *(_DWORD *)(v3 + 20), v8, (int)&v30);
      std::string::swap((std::string *)&v31, (std::string *)&v32);
    }
    else
    {
      v32 = std::string::_S_construct<char *>(a2, (unsigned int)&v30, (void *)v2, *(_DWORD *)(v3 + 20), v7, (int)&v30);
      std::string::swap((std::string *)&v31, (std::string *)&v32);
    }
    v9 = v32 - 12;
    if ( (_DWORD *)(v32 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
      }
      else
      {
        v25 = *(_DWORD *)(v32 - 4);
        *(_DWORD *)(v32 - 4) = v25 - 1;
      }
      if ( v25 <= 0 )
        std::string::_Rep::_M_destroy(v9, &v29);
    }
  }
  else
  {
    std::string::assign((std::string *)&v31, (const std::string *)(v3 + 40));
  }
  v36 = (int)&unk_80CF5DC;
  v47 = (int)&unk_80CF5F0;
  v37 = (int)&unk_80CF588;
  v10 = v46 - 12;
  if ( (_DWORD *)(v46 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
    }
    else
    {
      v24 = *(_DWORD *)(v46 - 4);
      *(_DWORD *)(v46 - 4) = v24 - 1;
    }
    if ( v24 <= 0 )
      std::string::_Rep::_M_destroy(v10, &v32);
  }
  v37 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v44);
  v36 = v2;
  *(int *)((char *)&v36 + *(_DWORD *)(v2 - 12)) = dword_80CF678;
  v47 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v47);
  if ( byte_80CE64C )
  {
    v11 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v31, *(_DWORD *)(v31 - 12));
    v12 = (std::ostream *)v11;
    v13 = *(_DWORD *)(*(_DWORD *)v11 - 12);
    v14 = *(_DWORD *)((char *)v12 + v13 + 124);
    if ( !v14 )
    {
      v26 = std::__throw_bad_cast();
      std::string::_Rep::_M_dispose(v31 - 12, &v36);
      Unwind_Resume(v26);
    }
    if ( *(_BYTE *)(v14 + 28) )
    {
      v15 = *(_BYTE *)(v14 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v12 + v13 + 124));
      v15 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v14 + 24))(v14, 10);
    }
    v16 = (std::ostream *)std::ostream::put(v12, v15);
    std::ostream::flush(v16);
  }
  syslog(6, "%s", v31, v28);
  v17 = v31 - 12;
  if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v23 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
    }
    else
    {
      v27 = *(_DWORD *)(v31 - 4);
      *(_DWORD *)(v31 - 4) = v27 - 1;
      v23 = v27;
    }
    if ( v23 <= 0 )
      std::string::_Rep::_M_destroy(v17, &v36);
  }
LABEL_17:
  v34 = 0;
  v18 = v32;
  v19 = v33;
  v32 = v36;
  v33 = v37;
  v20 = v35;
  v35 = v39;
  v21 = *(_DWORD *)(a2 + 16);
  v36 = *(_DWORD *)(a2 + 12);
  v37 = v21;
  *(_DWORD *)(a2 + 12) = v18;
  *(_DWORD *)(a2 + 16) = v19;
  v38 = *(_DWORD *)(a2 + 20);
  v22 = v38;
  *(_DWORD *)(a2 + 20) = 0;
  v39 = *(_DWORD *)(a2 + 24);
  *(_DWORD *)(a2 + 24) = v20;
  if ( v22 )
  {
    ((void (__cdecl *)(int *, int *, signed int))v22)(&v36, &v36, 3);
    if ( v34 )
      v34(&v32, &v32, 3);
  }
  sub_8079ED0(a2 + 44);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0806D3F0) --------------------------------------------------------
void __cdecl sub_806D3F0(int a1, int a2, int a3)
{
  int v3; // eax@4
  unsigned int v4; // eax@5
  int v5; // eax@9
  unsigned int v6; // ebp@13
  int v7; // edi@13
  int v8; // eax@13
  char *v9; // ST1C_4@15
  size_t v10; // eax@15
  char *v11; // edx@15
  int v12; // eax@17
  int v13; // edx@17
  int v14; // ecx@18
  int v15; // edx@20
  int v16; // edx@21
  int v17; // eax@23
  std::ostream *v18; // ebp@23
  int v19; // eax@23
  int v20; // edi@23
  char v21; // al@25
  std::ostream *v22; // eax@26
  int v23; // edx@27
  signed __int32 v24; // eax@29
  int v25; // eax@32
  signed __int32 v26; // edi@39
  int v27; // ebx@42
  signed __int32 v28; // edi@45
  signed __int32 v29; // ecx@48
  int v30; // [sp+Ch] [bp-F0h]@0
  int v31; // [sp+18h] [bp-E4h]@12
  char v32; // [sp+22h] [bp-DAh]@41
  char v33; // [sp+23h] [bp-D9h]@19
  int v34; // [sp+24h] [bp-D8h]@17
  int v35; // [sp+28h] [bp-D4h]@19
  unsigned int v36; // [sp+2Ch] [bp-D0h]@13
  int v37; // [sp+30h] [bp-CCh]@13
  int v38; // [sp+34h] [bp-C8h]@13
  int v39; // [sp+38h] [bp-C4h]@13
  int v40; // [sp+3Ch] [bp-C0h]@13
  int v41; // [sp+40h] [bp-BCh]@13
  int v42; // [sp+44h] [bp-B8h]@13
  int v43; // [sp+48h] [bp-B4h]@13
  char v44; // [sp+4Ch] [bp-B0h]@13
  int v45; // [sp+50h] [bp-ACh]@13
  int v46; // [sp+54h] [bp-A8h]@13
  int v47; // [sp+58h] [bp-A4h]@13
  int v48; // [sp+C8h] [bp-34h]@13
  char v49; // [sp+CCh] [bp-30h]@13
  char v50; // [sp+CDh] [bp-2Fh]@13
  int v51; // [sp+D0h] [bp-2Ch]@13
  int v52; // [sp+D4h] [bp-28h]@13
  int v53; // [sp+D8h] [bp-24h]@13
  int v54; // [sp+DCh] [bp-20h]@13

  if ( log_level > 1 )
    goto LABEL_2;
  if ( *(_DWORD *)a2 && !*(_BYTE *)(a2 + 4) )
  {
    v25 = evhttp_request_get_input_buffer(*(_DWORD *)a2);
    v31 = evbuffer_get_length(v25);
  }
  else
  {
    v31 = 0;
  }
  std::ios_base::ios_base((std::ios_base *)&v47);
  v47 = (int)&unk_80CF5C8;
  v48 = 0;
  v49 = 0;
  v50 = 0;
  v51 = 0;
  v52 = 0;
  v53 = 0;
  v54 = 0;
  v6 = dword_80CF674;
  v36 = dword_80CF674;
  *(unsigned int *)((char *)&v36 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v36 + *(_DWORD *)(v36 - 12), 0);
  v36 = (unsigned int)&unk_80CF5DC;
  v47 = (int)&unk_80CF5F0;
  v37 = (int)&unk_80CF7F0;
  v38 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  v42 = 0;
  v43 = 0;
  std::locale::locale((std::locale *)&v44);
  v37 = (int)&unk_80CF588;
  v45 = 16;
  v46 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v47, &v37);
  v7 = std::__ostream_insert<char,std::char_traits<char>>(&v36, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v7, "[HTTP DL] chunk ", 16);
  v8 = *(_DWORD *)(a3 + 36);
  if ( v8 )
  {
    if ( !*(_DWORD *)(v8 + 8) )
    {
      std::basic_ios<char,std::char_traits<char>>::clear(
        v7 + *(_DWORD *)(*(_DWORD *)v7 - 12),
        *(_DWORD *)(v7 + *(_DWORD *)(*(_DWORD *)v7 - 12) + 20) | 1);
      goto LABEL_17;
    }
    v9 = *(char **)(v8 + 8);
    v10 = strlen(*(const char **)(v8 + 8));
    v11 = v9;
  }
  else
  {
    v10 = 0;
    v11 = "";
  }
  std::__ostream_insert<char,std::char_traits<char>>(v7, v11, v10);
LABEL_17:
  std::__ostream_insert<char,std::char_traits<char>>(v7, ": ", 2);
  v12 = std::ostream::_M_insert<unsigned long>(v7, v31);
  v34 = (int)&unk_80CF83C;
  v13 = *(_DWORD *)(v12 + 24);
  if ( v13 )
  {
    v14 = *(_DWORD *)(v12 + 16);
    LOBYTE(v30) = 0;
    if ( v13 <= (unsigned int)v14 )
    {
      v35 = std::string::_S_construct<char *>(a3, v6, &v33, *(_DWORD *)(v12 + 20), v14, (int)&v33);
      std::string::swap((std::string *)&v34, (std::string *)&v35);
    }
    else
    {
      v35 = std::string::_S_construct<char *>(a3, v6, &v33, *(_DWORD *)(v12 + 20), v13, (int)&v33);
      std::string::swap((std::string *)&v34, (std::string *)&v35);
    }
    v15 = v35 - 12;
    if ( (_DWORD *)(v35 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v35 - 4), 0xFFFFFFFF);
      }
      else
      {
        v26 = *(_DWORD *)(v35 - 4);
        *(_DWORD *)(v35 - 4) = v26 - 1;
      }
      if ( v26 <= 0 )
        std::string::_Rep::_M_destroy(v15, &v32);
    }
  }
  else
  {
    std::string::assign((std::string *)&v34, (const std::string *)(v12 + 40));
  }
  v36 = (unsigned int)&unk_80CF5DC;
  v47 = (int)&unk_80CF5F0;
  v37 = (int)&unk_80CF588;
  v16 = v46 - 12;
  if ( (_DWORD *)(v46 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v28 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
    }
    else
    {
      v28 = *(_DWORD *)(v46 - 4);
      *(_DWORD *)(v46 - 4) = v28 - 1;
    }
    if ( v28 <= 0 )
      std::string::_Rep::_M_destroy(v16, &v35);
  }
  v37 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v44);
  v36 = v6;
  *(unsigned int *)((char *)&v36 + *(_DWORD *)(v6 - 12)) = dword_80CF678;
  v47 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v47);
  if ( byte_80CE64C )
  {
    v17 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v34, *(_DWORD *)(v34 - 12));
    v18 = (std::ostream *)v17;
    v19 = *(_DWORD *)(*(_DWORD *)v17 - 12);
    v20 = *(_DWORD *)((char *)v18 + v19 + 124);
    if ( !v20 )
    {
      v27 = std::__throw_bad_cast();
      std::string::_Rep::_M_dispose(v34 - 12, &v36);
      Unwind_Resume(v27);
    }
    if ( *(_BYTE *)(v20 + 28) )
    {
      v21 = *(_BYTE *)(v20 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v18 + v19 + 124));
      v21 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v20 + 24))(v20, 10);
    }
    v22 = (std::ostream *)std::ostream::put(v18, v21);
    std::ostream::flush(v22);
  }
  syslog(7, "%s", v34, v30);
  v23 = v34 - 12;
  if ( (_DWORD *)(v34 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v34 - 4), 0xFFFFFFFF);
    }
    else
    {
      v29 = *(_DWORD *)(v34 - 4);
      *(_DWORD *)(v34 - 4) = v29 - 1;
      v24 = v29;
    }
    if ( v24 <= 0 )
      std::string::_Rep::_M_destroy(v23, &v36);
  }
LABEL_2:
  if ( *(_DWORD *)a2 && !*(_BYTE *)(a2 + 4) )
  {
    v5 = evhttp_request_get_input_buffer(*(_DWORD *)a2);
    v3 = evbuffer_get_length(v5);
  }
  else
  {
    v3 = 0;
  }
  *(_DWORD *)(*(_DWORD *)(a3 + 32) + 16) += v3;
  v4 = *(_DWORD *)(a3 + 40);
  if ( v4 )
  {
    if ( v4 <= *(_DWORD *)(*(_DWORD *)(a3 + 32) + 16) )
      sub_8079ED0(a3 + 44);
  }
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1F0: using guessed type int __cdecl evhttp_request_get_input_buffer(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0806D9E0) --------------------------------------------------------
void __cdecl sub_806D9E0(int **a1, int a2)
{
  sub_806D3F0(**a1, a2, (*a1)[1]);
}

//----- (0806DA10) --------------------------------------------------------
int __cdecl sub_806DA10(int a1, int a2)
{
  unsigned int v2; // ebp@0
  int v3; // esi@2
  int v4; // eax@2
  char *v5; // ST18_4@4
  size_t v6; // eax@4
  char *v7; // edx@4
  int v8; // eax@6
  int v9; // edx@7
  int v10; // edx@9
  int v11; // edx@10
  std::ostream *v12; // esi@12
  char v13; // al@14
  std::ostream *v14; // eax@15
  int v15; // edx@16
  int v16; // edx@17
  int v17; // eax@17
  int v18; // eax@19
  int v19; // eax@21
  int v20; // eax@21
  int result; // eax@23
  signed __int32 v22; // ecx@32
  signed __int32 v23; // esi@37
  signed __int32 v24; // esi@41
  int v25; // ebx@44
  int v26; // [sp+Ch] [bp-FCh]@0
  int v27; // [sp+14h] [bp-F4h]@12
  int v28; // [sp+18h] [bp-F0h]@17
  int v29; // [sp+1Ch] [bp-ECh]@17
  char v30; // [sp+26h] [bp-E2h]@39
  char v31; // [sp+27h] [bp-E1h]@8
  int v32; // [sp+28h] [bp-E0h]@6
  int v33; // [sp+2Ch] [bp-DCh]@8
  int (__cdecl *v34)(void **, void **, signed int); // [sp+34h] [bp-D4h]@21
  int (__cdecl *v35)(int **, int); // [sp+38h] [bp-D0h]@21
  int v36; // [sp+3Ch] [bp-CCh]@2
  int v37; // [sp+40h] [bp-C8h]@2
  int (__cdecl *v38)(void **, void **, signed int); // [sp+44h] [bp-C4h]@2
  void (__cdecl *v39)(int **, int); // [sp+48h] [bp-C0h]@2
  int v40; // [sp+4Ch] [bp-BCh]@2
  int v41; // [sp+50h] [bp-B8h]@2
  int v42; // [sp+54h] [bp-B4h]@2
  int v43; // [sp+58h] [bp-B0h]@2
  char v44; // [sp+5Ch] [bp-ACh]@2
  int v45; // [sp+60h] [bp-A8h]@2
  int v46; // [sp+64h] [bp-A4h]@2
  int v47; // [sp+68h] [bp-A0h]@2
  int v48; // [sp+D8h] [bp-30h]@2
  char v49; // [sp+DCh] [bp-2Ch]@2
  char v50; // [sp+DDh] [bp-2Bh]@2
  int v51; // [sp+E0h] [bp-28h]@2
  int v52; // [sp+E4h] [bp-24h]@2
  int v53; // [sp+E8h] [bp-20h]@2
  int v54; // [sp+ECh] [bp-1Ch]@2

  if ( log_level > 2 )
    goto LABEL_17;
  std::ios_base::ios_base((std::ios_base *)&v47);
  v47 = (int)&unk_80CF5C8;
  v48 = 0;
  v49 = 0;
  v50 = 0;
  v51 = 0;
  v52 = 0;
  v53 = 0;
  v54 = 0;
  v36 = dword_80CF674;
  *(int *)((char *)&v36 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v36 + *(_DWORD *)(v36 - 12), 0);
  v36 = (int)&unk_80CF5DC;
  v47 = (int)&unk_80CF5F0;
  v37 = (int)&unk_80CF7F0;
  v38 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  v42 = 0;
  v43 = 0;
  std::locale::locale((std::locale *)&v44);
  v37 = (int)&unk_80CF588;
  v45 = 16;
  v46 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v47, &v37);
  v3 = std::__ostream_insert<char,std::char_traits<char>>(&v36, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v3, "[HTTP DL] started ", 18);
  v4 = *(_DWORD *)(a2 + 36);
  if ( v4 )
  {
    if ( !*(_DWORD *)(v4 + 8) )
    {
      std::basic_ios<char,std::char_traits<char>>::clear(
        v3 + *(_DWORD *)(*(_DWORD *)v3 - 12),
        *(_DWORD *)(v3 + *(_DWORD *)(*(_DWORD *)v3 - 12) + 20) | 1);
      goto LABEL_6;
    }
    v5 = *(char **)(v4 + 8);
    v6 = strlen(*(const char **)(v4 + 8));
    v7 = v5;
  }
  else
  {
    v6 = 0;
    v7 = "";
  }
  std::__ostream_insert<char,std::char_traits<char>>(v3, v7, v6);
LABEL_6:
  v32 = (int)&unk_80CF83C;
  v8 = *(_DWORD *)(v3 + 24);
  if ( v8 )
  {
    v9 = *(_DWORD *)(v3 + 16);
    LOBYTE(v26) = 0;
    if ( v8 <= (unsigned int)v9 )
    {
      v33 = std::string::_S_construct<char *>(a2, v2, &v36, *(_DWORD *)(v3 + 20), v9, (int)&v31);
      std::string::swap((std::string *)&v32, (std::string *)&v33);
    }
    else
    {
      v33 = std::string::_S_construct<char *>(a2, v2, &v36, *(_DWORD *)(v3 + 20), v8, (int)&v31);
      std::string::swap((std::string *)&v32, (std::string *)&v33);
    }
    v10 = v33 - 12;
    if ( (_DWORD *)(v33 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v23 = _InterlockedExchangeAdd((volatile signed __int32 *)(v33 - 4), 0xFFFFFFFF);
      }
      else
      {
        v23 = *(_DWORD *)(v33 - 4);
        *(_DWORD *)(v33 - 4) = v23 - 1;
      }
      if ( v23 <= 0 )
        std::string::_Rep::_M_destroy(v10, &v30);
    }
  }
  else
  {
    std::string::assign((std::string *)&v32, (const std::string *)(v3 + 40));
  }
  v36 = (int)&unk_80CF5DC;
  v47 = (int)&unk_80CF5F0;
  v37 = (int)&unk_80CF588;
  v11 = v46 - 12;
  if ( (_DWORD *)(v46 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
    }
    else
    {
      v24 = *(_DWORD *)(v46 - 4);
      *(_DWORD *)(v46 - 4) = v24 - 1;
    }
    if ( v24 <= 0 )
      std::string::_Rep::_M_destroy(v11, &v33);
  }
  v37 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v44);
  v36 = dword_80CF674;
  *(int *)((char *)&v36 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  v47 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v47);
  if ( byte_80CE64C )
  {
    v12 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v32, *(_DWORD *)(v32 - 12));
    v27 = *(_DWORD *)((char *)v12 + *(_DWORD *)(*(_DWORD *)v12 - 12) + 124);
    if ( !v27 )
    {
      v25 = std::__throw_bad_cast();
      std::string::_Rep::_M_dispose(v32 - 12, &v36);
      Unwind_Resume(v25);
    }
    if ( *(_BYTE *)(v27 + 28) )
    {
      v13 = *(_BYTE *)(v27 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(v27);
      v13 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v27 + 24))(v27, 10);
    }
    v14 = (std::ostream *)std::ostream::put(v12, v13);
    std::ostream::flush(v14);
  }
  syslog(6, "%s", v32, v26);
  v15 = v32 - 12;
  if ( (_DWORD *)(v32 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v22 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
    }
    else
    {
      v22 = *(_DWORD *)(v32 - 4);
      *(_DWORD *)(v32 - 4) = v22 - 1;
    }
    if ( v22 <= 0 )
      std::string::_Rep::_M_destroy(v15, &v36);
  }
LABEL_17:
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v28);
  v16 = v29;
  *(_DWORD *)(a2 + 172) = v28;
  *(_DWORD *)(a2 + 176) = v16;
  v17 = *(_DWORD *)(a2 + 48);
  if ( v17 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v17 + 4));
    if ( !v17 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v18 = *(_DWORD *)(a2 + 36);
  *(_DWORD *)(a2 + 48) = v18;
  if ( v18 )
    _InterlockedIncrement((volatile signed __int32 *)(v18 + 4));
  v38 = 0;
  v19 = operator new(8u);
  *(_DWORD *)v19 = a1;
  *(_DWORD *)(v19 + 4) = a2;
  v36 = v19;
  v39 = sub_806D9E0;
  v38 = sub_806CCE0;
  v34 = 0;
  v20 = operator new(8u);
  *(_DWORD *)v20 = a1;
  *(_DWORD *)(v20 + 4) = a2;
  v33 = v20;
  v35 = sub_806E980;
  v34 = sub_806CD80;
  sub_807A7C0(a2 + 44, *(_DWORD *)(a1 + 8), (int)&v33, (int)&v36);
  if ( v34 )
    v34((void **)&v33, (void **)&v33, 3);
  result = (int)v38;
  if ( v38 )
    result = v38((void **)&v36, (void **)&v36, 3);
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0806E1B0) --------------------------------------------------------
int __cdecl sub_806E1B0(int a1, int a2, int a3)
{
  unsigned int v3; // ebp@0
  int v4; // eax@4
  int v5; // esi@5
  int v6; // edi@6
  int v7; // esi@6
  int v8; // eax@6
  char *v9; // ST14_4@8
  size_t v10; // eax@8
  char *v11; // edx@8
  int v12; // esi@10
  int v13; // esi@10
  int v14; // esi@10
  int v15; // eax@10
  int v16; // edx@11
  int v17; // eax@13
  int v18; // edx@13
  int v19; // edx@14
  int v20; // eax@16
  std::ostream *v21; // edi@16
  int v22; // eax@16
  int v23; // esi@16
  char v24; // al@18
  std::ostream *v25; // eax@19
  int v26; // edx@20
  int v27; // eax@25
  int v28; // eax@26
  int v29; // eax@28
  int v31; // eax@33
  signed __int32 v32; // eax@38
  signed __int32 v33; // ecx@47
  signed __int32 v34; // ecx@51
  int v35; // ebx@54
  signed __int32 v36; // ecx@57
  int v37; // [sp+8h] [bp-100h]@0
  int v38; // [sp+14h] [bp-F4h]@6
  double v39; // [sp+18h] [bp-F0h]@6
  __int64 v40; // [sp+28h] [bp-E0h]@5
  char v41; // [sp+32h] [bp-D6h]@49
  char v42; // [sp+33h] [bp-D5h]@12
  int v43; // [sp+34h] [bp-D4h]@10
  int v44; // [sp+38h] [bp-D0h]@12
  int v45; // [sp+3Ch] [bp-CCh]@6
  int v46; // [sp+40h] [bp-C8h]@6
  int v47; // [sp+44h] [bp-C4h]@6
  int v48; // [sp+48h] [bp-C0h]@6
  int v49; // [sp+4Ch] [bp-BCh]@6
  int v50; // [sp+50h] [bp-B8h]@6
  int v51; // [sp+54h] [bp-B4h]@6
  int v52; // [sp+58h] [bp-B0h]@6
  char v53; // [sp+5Ch] [bp-ACh]@6
  int v54; // [sp+60h] [bp-A8h]@6
  int v55; // [sp+64h] [bp-A4h]@6
  int v56; // [sp+68h] [bp-A0h]@6
  int v57; // [sp+D8h] [bp-30h]@6
  char v58; // [sp+DCh] [bp-2Ch]@6
  char v59; // [sp+DDh] [bp-2Bh]@6
  int v60; // [sp+E0h] [bp-28h]@6
  int v61; // [sp+E4h] [bp-24h]@6
  int v62; // [sp+E8h] [bp-20h]@6
  int v63; // [sp+ECh] [bp-1Ch]@6

  if ( !*(_DWORD *)(a3 + 20) )
    goto LABEL_23;
  std::string::assign((std::string *)(*(_DWORD *)(a3 + 32) + 12), (const std::string *)(a3 + 56));
  if ( *(_DWORD *)a2 && !*(_BYTE *)(a2 + 4) )
  {
    v31 = evhttp_request_get_input_buffer(*(_DWORD *)a2);
    v4 = evbuffer_get_length(v31);
  }
  else
  {
    v4 = 0;
  }
  *(_DWORD *)(*(_DWORD *)(a3 + 32) + 16) += v4;
  v5 = *(_DWORD *)(a3 + 32);
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v40);
  *(double *)(v5 + 20) = (long double)(v40 - *(_QWORD *)(a3 + 172)) / 1000000000.0;
  if ( log_level > 2 )
    goto LABEL_21;
  v6 = *(_DWORD *)(a3 + 32);
  v39 = *(double *)(v6 + 20);
  v38 = *(_DWORD *)(v6 + 16);
  std::ios_base::ios_base((std::ios_base *)&v56);
  v56 = (int)&unk_80CF5C8;
  v57 = 0;
  v58 = 0;
  v59 = 0;
  v60 = 0;
  v61 = 0;
  v62 = 0;
  v63 = 0;
  v45 = dword_80CF674;
  *(int *)((char *)&v45 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v45 + *(_DWORD *)(v45 - 12), 0);
  v45 = (int)&unk_80CF5DC;
  v56 = (int)&unk_80CF5F0;
  v46 = (int)&unk_80CF7F0;
  v47 = 0;
  v48 = 0;
  v49 = 0;
  v50 = 0;
  v51 = 0;
  v52 = 0;
  std::locale::locale((std::locale *)&v53);
  v46 = (int)&unk_80CF588;
  v54 = 16;
  v55 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v56, &v46);
  v7 = std::__ostream_insert<char,std::char_traits<char>>(&v45, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v7, "[HTTP DL] done ", 15);
  v8 = *(_DWORD *)(a3 + 36);
  if ( !v8 )
  {
    v10 = 0;
    v11 = "";
    goto LABEL_9;
  }
  if ( *(_DWORD *)(v8 + 8) )
  {
    v9 = *(char **)(v8 + 8);
    v10 = strlen(*(const char **)(v8 + 8));
    v11 = v9;
LABEL_9:
    std::__ostream_insert<char,std::char_traits<char>>(v7, v11, v10);
    goto LABEL_10;
  }
  std::basic_ios<char,std::char_traits<char>>::clear(
    v7 + *(_DWORD *)(*(_DWORD *)v7 - 12),
    *(_DWORD *)(v7 + *(_DWORD *)(*(_DWORD *)v7 - 12) + 20) | 1);
LABEL_10:
  std::__ostream_insert<char,std::char_traits<char>>(v7, " from [", 7);
  v12 = std::__ostream_insert<char,std::char_traits<char>>(
          v7,
          *(_DWORD *)(v6 + 12),
          *(_DWORD *)(*(_DWORD *)(v6 + 12) - 12));
  std::__ostream_insert<char,std::char_traits<char>>(v12, "]", 1);
  std::__ostream_insert<char,std::char_traits<char>>(v12, " ", 1);
  v13 = std::ostream::_M_insert<unsigned long>(v12, v38);
  std::__ostream_insert<char,std::char_traits<char>>(v13, " bytes", 6);
  std::__ostream_insert<char,std::char_traits<char>>(v13, " in ", 4);
  v14 = std::ostream::_M_insert<double>(v13, LODWORD(v39), HIDWORD(v39));
  std::__ostream_insert<char,std::char_traits<char>>(v14, " sec", 4);
  v43 = (int)&unk_80CF83C;
  v15 = *(_DWORD *)(v14 + 24);
  if ( v15 )
  {
    v16 = *(_DWORD *)(v14 + 16);
    LOBYTE(v37) = 0;
    if ( v15 > (unsigned int)v16 )
    {
      v44 = std::string::_S_construct<char *>(a3, v3, &v42, *(_DWORD *)(v14 + 20), v15, (int)&v42);
      std::string::swap((std::string *)&v43, (std::string *)&v44);
    }
    else
    {
      v44 = std::string::_S_construct<char *>(a3, v3, &v42, *(_DWORD *)(v14 + 20), v16, (int)&v42);
      std::string::swap((std::string *)&v43, (std::string *)&v44);
    }
    v17 = v44;
    v18 = v44 - 12;
    if ( (_DWORD *)(v44 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_46;
  }
  else
  {
    std::string::assign((std::string *)&v43, (const std::string *)(v14 + 40));
  }
  while ( 1 )
  {
    v45 = (int)&unk_80CF5DC;
    v56 = (int)&unk_80CF5F0;
    v46 = (int)&unk_80CF588;
    v19 = v55 - 12;
    if ( (_DWORD *)(v55 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v34 = _InterlockedExchangeAdd((volatile signed __int32 *)(v55 - 4), 0xFFFFFFFF);
      }
      else
      {
        v34 = *(_DWORD *)(v55 - 4);
        *(_DWORD *)(v55 - 4) = v34 - 1;
      }
      if ( v34 <= 0 )
        std::string::_Rep::_M_destroy(v19, &v44);
    }
    v46 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v53);
    v45 = dword_80CF674;
    *(int *)((char *)&v45 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v56 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v56);
    if ( byte_80CE64C )
    {
      v20 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v43, *(_DWORD *)(v43 - 12));
      v21 = (std::ostream *)v20;
      v22 = *(_DWORD *)(*(_DWORD *)v20 - 12);
      v23 = *(_DWORD *)((char *)v21 + v22 + 124);
      if ( !v23 )
      {
        v35 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v43 - 12, &v45);
        Unwind_Resume(v35);
      }
      if ( *(_BYTE *)(v23 + 28) )
      {
        v24 = *(_BYTE *)(v23 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v21 + v22 + 124));
        v24 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v23 + 24))(v23, 10);
      }
      v25 = (std::ostream *)std::ostream::put(v21, v24);
      std::ostream::flush(v25);
    }
    syslog(6, "%s", v43, v37);
    v26 = v43 - 12;
    if ( (_DWORD *)(v43 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v32 = _InterlockedExchangeAdd((volatile signed __int32 *)(v43 - 4), 0xFFFFFFFF);
      }
      else
      {
        v36 = *(_DWORD *)(v43 - 4);
        *(_DWORD *)(v43 - 4) = v36 - 1;
        v32 = v36;
      }
      if ( v32 <= 0 )
        std::string::_Rep::_M_destroy(v26, &v45);
    }
LABEL_21:
    if ( *(_DWORD *)(a3 + 20) )
      break;
LABEL_45:
    v17 = std::__throw_bad_function_call();
LABEL_46:
    if ( &_pthread_key_create )
    {
      v33 = _InterlockedExchangeAdd((volatile signed __int32 *)(v17 - 4), 0xFFFFFFFF);
    }
    else
    {
      v33 = *(_DWORD *)(v17 - 4);
      *(_DWORD *)(v17 - 4) = v33 - 1;
    }
    if ( v33 <= 0 )
      std::string::_Rep::_M_destroy(v18, &v41);
  }
  (*(void (__cdecl **)(int, int))(a3 + 24))(a3 + 12, a3 + 32);
LABEL_23:
  if ( a1 == -12 )
  {
    v27 = std::__throw_system_error(1);
LABEL_44:
    std::__throw_system_error(v27);
    goto LABEL_45;
  }
  if ( &_pthread_key_create )
  {
    v27 = pthread_mutex_lock((pthread_mutex_t *)(a1 + 12));
    if ( v27 )
      goto LABEL_44;
  }
  v28 = *(_DWORD *)(a3 + 4);
  if ( v28 )
    *(_DWORD *)(v28 + 8) = *(_DWORD *)(a3 + 8);
  v29 = *(_DWORD *)(a3 + 8);
  if ( v29 )
    *(_DWORD *)(v29 + 4) = *(_DWORD *)(a3 + 4);
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  if ( &_pthread_key_create )
    pthread_mutex_unlock((pthread_mutex_t *)(a1 + 12));
  return (*(int (__cdecl **)(int))(*(_DWORD *)a3 + 4))(a3);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D140: using guessed type int __cdecl std::ostream::_M_insert<double>(_DWORD, _DWORD, _DWORD);
// 804D1F0: using guessed type int __cdecl evhttp_request_get_input_buffer(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0806E980) --------------------------------------------------------
int __cdecl sub_806E980(int **a1, int a2)
{
  return sub_806E1B0(**a1, a2, (*a1)[1]);
}

//----- (0806E9B0) --------------------------------------------------------
int __usercall sub_806E9B0@<eax>(int a1@<eax>)
{
  *(_BYTE *)(a1 + 8) = 0;
  return bufferevent_setcb(*(_DWORD *)a1, 0, 0, 0, 0);
}
// 804C6E0: using guessed type int __cdecl bufferevent_setcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0806E9F0) --------------------------------------------------------
int __usercall sub_806E9F0@<eax>(int a1@<eax>)
{
  *(_BYTE *)(a1 + 9) = 0;
  return bufferevent_setcb(*(_DWORD *)(a1 + 4), 0, 0, 0, 0);
}
// 804C6E0: using guessed type int __cdecl bufferevent_setcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0806EA30) --------------------------------------------------------
int __cdecl sub_806EA30(int a1, int a2, int a3, int a4)
{
  int v4; // edx@1
  signed int v5; // eax@3

  v4 = a2;
  *(_DWORD *)a1 = a2;
  *(_DWORD *)(a1 + 4) = a3;
  *(_BYTE *)(a1 + 8) = 1;
  *(_BYTE *)(a1 + 9) = 1;
  *(_DWORD *)(a1 + 16) = 0x10000;
  *(_DWORD *)(a1 + 28) = 0;
  if ( *(_DWORD *)(a4 + 8) )
  {
    *(_DWORD *)(a1 + 32) = *(_DWORD *)(a4 + 12);
    *(_DWORD *)(a1 + 28) = *(_DWORD *)(a4 + 8);
    (*(void (__cdecl **)(int, int, signed int))(a4 + 8))(a1 + 20, a4, 2);
    v4 = *(_DWORD *)a1;
  }
  *(_DWORD *)(a1 + 12) = bufferevent_getfd(v4);
  v5 = *(_DWORD *)(a1 + 16);
  if ( (unsigned int)v5 > 0x4098 )
    v5 = 16536;
  bufferevent_setwatermark(*(_DWORD *)a1, 4, v5, 0);
  bufferevent_setcb(*(_DWORD *)a1, sub_806EC60, sub_806F1B0, sub_8071250, a1);
  bufferevent_enable(*(struct bufferevent **)a1, 6);
  bufferevent_setcb(*(_DWORD *)(a1 + 4), sub_806F730, 0, sub_8071F80, a1);
  return bufferevent_enable(*(struct bufferevent **)(a1 + 4), 6);
}
// 804C6E0: using guessed type int __cdecl bufferevent_setcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804CC70: using guessed type int __cdecl bufferevent_getfd(_DWORD);
// 804CE70: using guessed type int __cdecl bufferevent_setwatermark(_DWORD, _DWORD, _DWORD, _DWORD);
// 806EC60: using guessed type int sub_806EC60();
// 806F1B0: using guessed type int sub_806F1B0();
// 806F730: using guessed type int sub_806F730();
// 8071250: using guessed type int sub_8071250();
// 8071F80: using guessed type int sub_8071F80();

//----- (0806EB90) --------------------------------------------------------
int __cdecl sub_806EB90(int a1)
{
  int result; // eax@3

  if ( *(_BYTE *)(a1 + 8) )
  {
    sub_806E9B0(a1);
    if ( !*(_BYTE *)(a1 + 9) )
      goto LABEL_3;
  }
  else if ( !*(_BYTE *)(a1 + 9) )
  {
    goto LABEL_3;
  }
  sub_806E9F0(a1);
LABEL_3:
  result = *(_DWORD *)(a1 + 28);
  if ( result )
    result = ((int (__cdecl *)(_DWORD, _DWORD, _DWORD))result)(a1 + 20, a1 + 20, 3);
  return result;
}

//----- (0806F740) --------------------------------------------------------
void __cdecl sub_806F740(int a1)
{
  int v1; // eax@9
  int v2; // eax@12
  int v3; // ST1C_4@19
  int v4; // esi@19
  int v5; // eax@19
  int v6; // edx@19
  int v7; // ecx@20
  int v8; // edx@22
  int v9; // edx@23
  int v10; // eax@25
  std::ostream *v11; // edi@25
  int v12; // eax@25
  int v13; // esi@25
  char v14; // al@27
  std::ostream *v15; // eax@28
  int v16; // edx@29
  signed __int32 v17; // eax@31
  int v18; // ST1C_4@34
  int v19; // esi@34
  int v20; // eax@34
  int v21; // edx@34
  int v22; // ecx@35
  int v23; // edx@37
  int v24; // edx@38
  int v25; // eax@40
  std::ostream *v26; // edi@40
  int v27; // eax@40
  int v28; // esi@40
  char v29; // al@42
  std::ostream *v30; // eax@43
  int v31; // edx@44
  signed __int32 v32; // eax@46
  int v33; // ST1C_4@49
  int v34; // esi@49
  int v35; // eax@49
  int v36; // edx@49
  int v37; // ecx@50
  int v38; // edx@52
  int v39; // edx@53
  int v40; // eax@55
  std::ostream *v41; // edi@55
  int v42; // eax@55
  int v43; // esi@55
  char v44; // al@57
  std::ostream *v45; // eax@58
  int v46; // edx@59
  signed __int32 v47; // eax@61
  signed __int32 v48; // esi@74
  signed __int32 v49; // esi@78
  signed __int32 v50; // esi@84
  signed __int32 v51; // esi@88
  int v52; // eax@93
  int v53; // ebx@94
  signed __int32 v54; // ecx@96
  signed __int32 v55; // esi@98
  signed __int32 v56; // esi@102
  signed __int32 v57; // ecx@109
  signed __int32 v58; // ecx@110
  int v59; // [sp+Ch] [bp-F0h]@0
  int *v60; // [sp+18h] [bp-E4h]@19
  char v61; // [sp+22h] [bp-DAh]@80
  char v62; // [sp+23h] [bp-D9h]@21
  int v63; // [sp+24h] [bp-D8h]@19
  int v64; // [sp+28h] [bp-D4h]@21
  int v65; // [sp+2Ch] [bp-D0h]@19
  int v66; // [sp+30h] [bp-CCh]@19
  int v67; // [sp+34h] [bp-C8h]@19
  int v68; // [sp+38h] [bp-C4h]@19
  int v69; // [sp+3Ch] [bp-C0h]@19
  int v70; // [sp+40h] [bp-BCh]@19
  int v71; // [sp+44h] [bp-B8h]@19
  int v72; // [sp+48h] [bp-B4h]@19
  char v73; // [sp+4Ch] [bp-B0h]@19
  int v74; // [sp+50h] [bp-ACh]@19
  int v75; // [sp+54h] [bp-A8h]@19
  int v76; // [sp+58h] [bp-A4h]@19
  int v77; // [sp+C8h] [bp-34h]@19
  char v78; // [sp+CCh] [bp-30h]@19
  char v79; // [sp+CDh] [bp-2Fh]@19
  int v80; // [sp+D0h] [bp-2Ch]@19
  int v81; // [sp+D4h] [bp-28h]@19
  int v82; // [sp+D8h] [bp-24h]@19
  int v83; // [sp+DCh] [bp-20h]@19

  if ( *(_BYTE *)(a1 + 8) )
  {
    bufferevent_disable(*(struct bufferevent **)a1, 2);
    v2 = bufferevent_get_output(*(_DWORD *)a1);
    if ( evbuffer_get_length(v2) )
    {
      if ( log_level <= 1 )
      {
        v18 = *(_DWORD *)(a1 + 12);
        v60 = &v65;
        std::ios_base::ios_base((std::ios_base *)&v76);
        v76 = (int)&unk_80CF5C8;
        v77 = 0;
        v78 = 0;
        v79 = 0;
        v80 = 0;
        v81 = 0;
        v82 = 0;
        v83 = 0;
        v65 = dword_80CF674;
        *(int *)((char *)&v65 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        std::basic_ios<char,std::char_traits<char>>::init((char *)&v65 + *(_DWORD *)(v65 - 12), 0);
        v65 = (int)&unk_80CF5DC;
        v76 = (int)&unk_80CF5F0;
        v66 = (int)&unk_80CF7F0;
        v67 = 0;
        v68 = 0;
        v69 = 0;
        v70 = 0;
        v71 = 0;
        v72 = 0;
        std::locale::locale((std::locale *)&v73);
        v66 = (int)&unk_80CF588;
        v74 = 16;
        v75 = (int)&unk_80CF83C;
        std::basic_ios<char,std::char_traits<char>>::init(&v76, &v66);
        v19 = std::__ostream_insert<char,std::char_traits<char>>(
                &v65,
                &unk_80CF83C,
                std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v19, "tunnel flushing client buffers ", 31);
        v20 = std::ostream::operator<<(v19, v18);
        v63 = (int)&unk_80CF83C;
        v21 = *(_DWORD *)(v20 + 24);
        if ( v21 )
        {
          v22 = *(_DWORD *)(v20 + 16);
          LOBYTE(v59) = 0;
          if ( v21 <= (unsigned int)v22 )
          {
            v64 = std::string::_S_construct<char *>(a1, (unsigned int)&v76, &v73, *(_DWORD *)(v20 + 20), v22, (int)&v62);
            std::string::swap((std::string *)&v63, (std::string *)&v64);
          }
          else
          {
            v64 = std::string::_S_construct<char *>(a1, (unsigned int)&v76, &v73, *(_DWORD *)(v20 + 20), v21, (int)&v62);
            std::string::swap((std::string *)&v63, (std::string *)&v64);
          }
          v23 = v64 - 12;
          if ( (_DWORD *)(v64 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v51 = _InterlockedExchangeAdd((volatile signed __int32 *)(v64 - 4), 0xFFFFFFFF);
            }
            else
            {
              v51 = *(_DWORD *)(v64 - 4);
              *(_DWORD *)(v64 - 4) = v51 - 1;
            }
            if ( v51 <= 0 )
              std::string::_Rep::_M_destroy(v23, &v61);
          }
        }
        else
        {
          std::string::assign((std::string *)&v63, (const std::string *)(v20 + 40));
        }
        v65 = (int)&unk_80CF5DC;
        v76 = (int)&unk_80CF5F0;
        v66 = (int)&unk_80CF588;
        v24 = v75 - 12;
        if ( (_DWORD *)(v75 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v50 = _InterlockedExchangeAdd((volatile signed __int32 *)(v75 - 4), 0xFFFFFFFF);
          }
          else
          {
            v50 = *(_DWORD *)(v75 - 4);
            *(_DWORD *)(v75 - 4) = v50 - 1;
          }
          if ( v50 <= 0 )
            std::string::_Rep::_M_destroy(v24, &v64);
        }
        v66 = (int)&unk_80CF7F0;
        std::locale::~locale((std::locale *)&v73);
        v65 = dword_80CF674;
        *(int *)((char *)&v65 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        v76 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v76);
        if ( byte_80CE64C )
        {
          v25 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v63, *(_DWORD *)(v63 - 12));
          v26 = (std::ostream *)v25;
          v27 = *(_DWORD *)(*(_DWORD *)v25 - 12);
          v28 = *(_DWORD *)((char *)v26 + v27 + 124);
          if ( !v28 )
          {
            v52 = std::__throw_bad_cast();
            goto LABEL_94;
          }
          if ( *(_BYTE *)(v28 + 28) )
          {
            v29 = *(_BYTE *)(v28 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v26 + v27 + 124));
            v29 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v28 + 24))(v28, 10);
          }
          v30 = (std::ostream *)std::ostream::put(v26, v29);
          std::ostream::flush(v30);
        }
        syslog(7, "%s", v63, v59);
        v31 = v63 - 12;
        if ( (_DWORD *)(v63 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v32 = _InterlockedExchangeAdd((volatile signed __int32 *)(v63 - 4), 0xFFFFFFFF);
          }
          else
          {
            v58 = *(_DWORD *)(v63 - 4);
            *(_DWORD *)(v63 - 4) = v58 - 1;
            v32 = v58;
          }
          if ( v32 <= 0 )
            std::string::_Rep::_M_destroy(v31, &v65);
        }
      }
      bufferevent_setcb(*(_DWORD *)a1, 0, sub_8071FC0, sub_8071270, a1);
    }
    else if ( *(_BYTE *)(a1 + 8) )
    {
      sub_806E9B0(a1);
    }
  }
  if ( *(_BYTE *)(a1 + 9) )
  {
    bufferevent_disable(*(struct bufferevent **)(a1 + 4), 2);
    v1 = bufferevent_get_output(*(_DWORD *)(a1 + 4));
    if ( evbuffer_get_length(v1) )
    {
      if ( log_level <= 1 )
      {
        v33 = *(_DWORD *)(a1 + 12);
        v60 = &v65;
        std::ios_base::ios_base((std::ios_base *)&v76);
        v76 = (int)&unk_80CF5C8;
        v77 = 0;
        v78 = 0;
        v79 = 0;
        v80 = 0;
        v81 = 0;
        v82 = 0;
        v83 = 0;
        v65 = dword_80CF674;
        *(int *)((char *)&v65 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        std::basic_ios<char,std::char_traits<char>>::init((char *)&v65 + *(_DWORD *)(v65 - 12), 0);
        v65 = (int)&unk_80CF5DC;
        v76 = (int)&unk_80CF5F0;
        v66 = (int)&unk_80CF7F0;
        v67 = 0;
        v68 = 0;
        v69 = 0;
        v70 = 0;
        v71 = 0;
        v72 = 0;
        std::locale::locale((std::locale *)&v73);
        v66 = (int)&unk_80CF588;
        v74 = 16;
        v75 = (int)&unk_80CF83C;
        std::basic_ios<char,std::char_traits<char>>::init(&v76, &v66);
        v34 = std::__ostream_insert<char,std::char_traits<char>>(
                &v65,
                &unk_80CF83C,
                std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v34, "tunnel flushing server buffers ", 31);
        v35 = std::ostream::operator<<(v34, v33);
        v63 = (int)&unk_80CF83C;
        v36 = *(_DWORD *)(v35 + 24);
        if ( v36 )
        {
          v37 = *(_DWORD *)(v35 + 16);
          LOBYTE(v59) = 0;
          if ( v36 <= (unsigned int)v37 )
          {
            v64 = std::string::_S_construct<char *>(a1, (unsigned int)&v76, &v73, *(_DWORD *)(v35 + 20), v37, (int)&v62);
            std::string::swap((std::string *)&v63, (std::string *)&v64);
          }
          else
          {
            v64 = std::string::_S_construct<char *>(a1, (unsigned int)&v76, &v73, *(_DWORD *)(v35 + 20), v36, (int)&v62);
            std::string::swap((std::string *)&v63, (std::string *)&v64);
          }
          v38 = v64 - 12;
          if ( (_DWORD *)(v64 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v49 = _InterlockedExchangeAdd((volatile signed __int32 *)(v64 - 4), 0xFFFFFFFF);
            }
            else
            {
              v49 = *(_DWORD *)(v64 - 4);
              *(_DWORD *)(v64 - 4) = v49 - 1;
            }
            if ( v49 <= 0 )
              std::string::_Rep::_M_destroy(v38, &v61);
          }
        }
        else
        {
          std::string::assign((std::string *)&v63, (const std::string *)(v35 + 40));
        }
        v65 = (int)&unk_80CF5DC;
        v76 = (int)&unk_80CF5F0;
        v66 = (int)&unk_80CF588;
        v39 = v75 - 12;
        if ( (_DWORD *)(v75 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v48 = _InterlockedExchangeAdd((volatile signed __int32 *)(v75 - 4), 0xFFFFFFFF);
          }
          else
          {
            v48 = *(_DWORD *)(v75 - 4);
            *(_DWORD *)(v75 - 4) = v48 - 1;
          }
          if ( v48 <= 0 )
            std::string::_Rep::_M_destroy(v39, &v64);
        }
        v66 = (int)&unk_80CF7F0;
        std::locale::~locale((std::locale *)&v73);
        v65 = dword_80CF674;
        *(int *)((char *)&v65 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        v76 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v76);
        if ( byte_80CE64C )
        {
          v40 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v63, *(_DWORD *)(v63 - 12));
          v41 = (std::ostream *)v40;
          v42 = *(_DWORD *)(*(_DWORD *)v40 - 12);
          v43 = *(_DWORD *)((char *)v41 + v42 + 124);
          if ( !v43 )
          {
            v52 = std::__throw_bad_cast();
            goto LABEL_94;
          }
          if ( *(_BYTE *)(v43 + 28) )
          {
            v44 = *(_BYTE *)(v43 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v41 + v42 + 124));
            v44 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v43 + 24))(v43, 10);
          }
          v45 = (std::ostream *)std::ostream::put(v41, v44);
          std::ostream::flush(v45);
        }
        syslog(7, "%s", v63, v59);
        v46 = v63 - 12;
        if ( (_DWORD *)(v63 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v47 = _InterlockedExchangeAdd((volatile signed __int32 *)(v63 - 4), 0xFFFFFFFF);
          }
          else
          {
            v54 = *(_DWORD *)(v63 - 4);
            *(_DWORD *)(v63 - 4) = v54 - 1;
            v47 = v54;
          }
          if ( v47 <= 0 )
            std::string::_Rep::_M_destroy(v46, &v65);
        }
      }
      bufferevent_setcb(*(_DWORD *)(a1 + 4), 0, sub_8071FD0, sub_8071FA0, a1);
    }
    else if ( *(_BYTE *)(a1 + 9) )
    {
      sub_806E9F0(a1);
    }
  }
  if ( !*(_BYTE *)(a1 + 8) && !*(_BYTE *)(a1 + 9) )
  {
    if ( log_level > 1 )
    {
LABEL_6:
      if ( *(_DWORD *)(a1 + 28) )
        (*(void (__cdecl **)(int, int))(a1 + 32))(a1 + 20, a1);
      return;
    }
    v3 = *(_DWORD *)(a1 + 12);
    v60 = &v65;
    std::ios_base::ios_base((std::ios_base *)&v76);
    v76 = (int)&unk_80CF5C8;
    v77 = 0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v81 = 0;
    v82 = 0;
    v83 = 0;
    v65 = dword_80CF674;
    *(int *)((char *)&v65 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v65 + *(_DWORD *)(v65 - 12), 0);
    v65 = (int)&unk_80CF5DC;
    v76 = (int)&unk_80CF5F0;
    v66 = (int)&unk_80CF7F0;
    v67 = 0;
    v68 = 0;
    v69 = 0;
    v70 = 0;
    v71 = 0;
    v72 = 0;
    std::locale::locale((std::locale *)&v73);
    v66 = (int)&unk_80CF588;
    v74 = 16;
    v75 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v76, &v66);
    v4 = std::__ostream_insert<char,std::char_traits<char>>(&v65, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v4, "tunnel closed ", 14);
    v5 = std::ostream::operator<<(v4, v3);
    v63 = (int)&unk_80CF83C;
    v6 = *(_DWORD *)(v5 + 24);
    if ( v6 )
    {
      v7 = *(_DWORD *)(v5 + 16);
      LOBYTE(v59) = 0;
      if ( v6 <= (unsigned int)v7 )
      {
        v64 = std::string::_S_construct<char *>(a1, (unsigned int)&v76, &v73, *(_DWORD *)(v5 + 20), v7, (int)&v62);
        std::string::swap((std::string *)&v63, (std::string *)&v64);
      }
      else
      {
        v64 = std::string::_S_construct<char *>(a1, (unsigned int)&v76, &v73, *(_DWORD *)(v5 + 20), v6, (int)&v62);
        std::string::swap((std::string *)&v63, (std::string *)&v64);
      }
      v8 = v64 - 12;
      if ( (_DWORD *)(v64 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v56 = _InterlockedExchangeAdd((volatile signed __int32 *)(v64 - 4), 0xFFFFFFFF);
        }
        else
        {
          v56 = *(_DWORD *)(v64 - 4);
          *(_DWORD *)(v64 - 4) = v56 - 1;
        }
        if ( v56 <= 0 )
          std::string::_Rep::_M_destroy(v8, &v61);
      }
    }
    else
    {
      std::string::assign((std::string *)&v63, (const std::string *)(v5 + 40));
    }
    v65 = (int)&unk_80CF5DC;
    v76 = (int)&unk_80CF5F0;
    v66 = (int)&unk_80CF588;
    v9 = v75 - 12;
    if ( (_DWORD *)(v75 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v55 = _InterlockedExchangeAdd((volatile signed __int32 *)(v75 - 4), 0xFFFFFFFF);
      }
      else
      {
        v55 = *(_DWORD *)(v75 - 4);
        *(_DWORD *)(v75 - 4) = v55 - 1;
      }
      if ( v55 <= 0 )
        std::string::_Rep::_M_destroy(v9, &v64);
    }
    v66 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v73);
    v65 = dword_80CF674;
    *(int *)((char *)&v65 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v76 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v76);
    if ( !byte_80CE64C )
    {
LABEL_29:
      syslog(7, "%s", v63, v59);
      v16 = v63 - 12;
      if ( (_DWORD *)(v63 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v17 = _InterlockedExchangeAdd((volatile signed __int32 *)(v63 - 4), 0xFFFFFFFF);
        }
        else
        {
          v57 = *(_DWORD *)(v63 - 4);
          *(_DWORD *)(v63 - 4) = v57 - 1;
          v17 = v57;
        }
        if ( v17 <= 0 )
          std::string::_Rep::_M_destroy(v16, &v65);
      }
      goto LABEL_6;
    }
    v10 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v63, *(_DWORD *)(v63 - 12));
    v11 = (std::ostream *)v10;
    v12 = *(_DWORD *)(*(_DWORD *)v10 - 12);
    v13 = *(_DWORD *)((char *)v11 + v12 + 124);
    if ( v13 )
    {
      if ( *(_BYTE *)(v13 + 28) )
      {
        v14 = *(_BYTE *)(v13 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v11 + v12 + 124));
        v14 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v13 + 24))(v13, 10);
      }
      v15 = (std::ostream *)std::ostream::put(v11, v14);
      std::ostream::flush(v15);
      goto LABEL_29;
    }
    v52 = std::__throw_bad_cast();
LABEL_94:
    v53 = v52;
    std::string::_Rep::_M_dispose(v63 - 12, v60);
    Unwind_Resume(v53);
  }
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C6E0: using guessed type int __cdecl bufferevent_setcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D320: using guessed type int __cdecl bufferevent_get_output(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 8071270: using guessed type int sub_8071270();
// 8071FA0: using guessed type int sub_8071FA0();
// 8071FC0: using guessed type int sub_8071FC0();
// 8071FD0: using guessed type int sub_8071FD0();
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08071FE0) --------------------------------------------------------
int __cdecl sub_8071FE0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BAAD4;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BAAD4: using guessed type void *off_80BAAD4;

//----- (08072080) --------------------------------------------------------
int __cdecl sub_8072080(int a1, int a2)
{
  _DWORD **v2; // esi@1
  int v3; // eax@3
  unsigned int v4; // ecx@6
  const char *v5; // edx@6
  _DWORD *v6; // ebx@7
  int result; // eax@7
  int v8; // eax@11
  int v9; // ebp@11
  int v10; // eax@13
  int v11; // edi@13
  int v12; // eax@13
  int v13; // eax@13

  v2 = *(_DWORD ***)a1;
  if ( *(_DWORD *)a2 && !*(_BYTE *)(a2 + 4) )
    v3 = *(_DWORD *)(*(_DWORD *)a2 + 64);
  else
    v3 = 0;
  ***(_DWORD ***)a1 = v3;
  if ( *(_DWORD *)a2 && !*(_BYTE *)(a2 + 4) )
  {
    v8 = evhttp_request_get_input_buffer(*(_DWORD *)a2);
    v9 = evbuffer_get_length(v8);
    if ( !*(_DWORD *)a2 || *(_BYTE *)(a2 + 4) )
    {
      v4 = v9;
      v5 = 0;
    }
    else
    {
      v10 = evhttp_request_get_input_buffer(*(_DWORD *)a2);
      v11 = evbuffer_get_length(v10);
      v12 = evhttp_request_get_input_buffer(*(_DWORD *)a2);
      v13 = evbuffer_pullup(v12, v11);
      v4 = v9;
      v5 = (const char *)v13;
    }
  }
  else
  {
    v4 = 0;
    v5 = 0;
  }
  std::string::assign((std::string *)(*v2 + 1), v5, v4);
  v6 = v2[1];
  result = v6[1];
  if ( result )
  {
    result = event_base_loopbreak(v6[1]);
    *(_BYTE *)v6 = 1;
  }
  return result;
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA60: using guessed type int __cdecl event_base_loopbreak(_DWORD);
// 804CDA0: using guessed type int __cdecl evbuffer_pullup(_DWORD, _DWORD);
// 804D1F0: using guessed type int __cdecl evhttp_request_get_input_buffer(_DWORD);
// 8072080: using guessed type int __cdecl sub_8072080(int, int);

//----- (08072160) --------------------------------------------------------
int sub_8072160()
{
  void *v0; // ebx@1
  int v1; // eax@2
  char v3; // [sp+1Fh] [bp-Dh]@2

  v0 = dword_80CF8E0;
  if ( dword_80CF8E0 )
  {
    std::string::_Rep::_M_dispose(*((_DWORD *)dword_80CF8E0 + 2) - 12, &v3);
    std::string::_Rep::_M_dispose(*((_DWORD *)v0 + 1) - 12, &v3);
    v1 = *(_DWORD *)v0;
    if ( *(_DWORD *)v0 && !_InterlockedDecrement((volatile signed __int32 *)(v1 + 4)) )
      (*(void (__cdecl **)(int))(*(_DWORD *)v1 + 4))(v1);
    operator delete(v0);
  }
  dword_80CF8E0 = 0;
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF8E4);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);

//----- (080721E0) --------------------------------------------------------
void *sub_80721E0()
{
  return dword_80CF8E0;
}

//----- (080721F0) --------------------------------------------------------
int __cdecl HttpClient::HttpClient(int a1)
{
  int result; // eax@1

  result = a1;
  *(_DWORD *)a1 = &HttpClient::vftable;
  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 8) = 1;
  *(_DWORD *)(a1 + 12) = &unk_80CF83C;
  *(_BYTE *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = (unsigned __int8)byte_80CF88C < 1u ? 2 : 0;
  *(_DWORD *)(a1 + 24) = 0;
  *(_DWORD *)(a1 + 28) = 300;
  *(_DWORD *)(a1 + 32) = 0;
  *(_BYTE *)(a1 + 36) = 0;
  *(_DWORD *)(a1 + 48) = 0;
  *(_DWORD *)(a1 + 64) = 0;
  *(_DWORD *)(a1 + 80) = 0;
  *(_DWORD *)(a1 + 92) = 0;
  *(_DWORD *)(a1 + 96) = 0;
  *(_DWORD *)(a1 + 100) = 0;
  *(_DWORD *)(a1 + 104) = 0;
  *(_DWORD *)(a1 + 108) = dword_80CF8E0;
  *(_DWORD *)(a1 + 112) = 0;
  *(_DWORD *)(a1 + 116) = 0;
  *(_DWORD *)(a1 + 120) = &unk_80CF83C;
  *(_DWORD *)(a1 + 124) = 0;
  return result;
}
// 80BAB30: using guessed type int (__cdecl *HttpClient::vftable)(int);
// 80CF88C: using guessed type char byte_80CF88C;

//----- (080722A0) --------------------------------------------------------
int __cdecl sub_80722A0(int a1)
{
  int result; // eax@2

  if ( *(_DWORD *)(a1 + 96) )
    result = evhttp_connection_get_bufferevent(*(_DWORD *)(a1 + 96));
  else
    result = 0;
  return result;
}
// 804C6D0: using guessed type int __cdecl evhttp_connection_get_bufferevent(_DWORD);

//----- (08072320) --------------------------------------------------------
void __cdecl sub_8072320(int a1, int a2)
{
  int v2; // [sp+18h] [bp-14h]@1
  char v3; // [sp+1Ch] [bp-10h]@1

  v2 = a1;
  v3 = 0;
  if ( *(_DWORD *)(a2 + 48) )
    sub_807B930(a2 + 40, &v2);
}

//----- (08072360) --------------------------------------------------------
void __cdecl sub_8072360(int a1)
{
  int v1; // eax@2
  int v2; // esi@2
  int v3; // eax@3
  struct bufferevent *v4; // esi@3
  int v5; // eax@8
  int v6; // esi@9
  int v7; // esi@13
  int i; // ebx@18
  int v9; // esi@19
  int v10; // [sp+4h] [bp-54h]@0
  int v11; // [sp+4h] [bp-54h]@13
  int v12; // [sp+8h] [bp-50h]@0
  int v13; // [sp+8h] [bp-50h]@13
  int v14; // [sp+14h] [bp-44h]@5
  char v15; // [sp+18h] [bp-40h]@5
  int v16; // [sp+24h] [bp-34h]@3
  char v17; // [sp+28h] [bp-30h]@5
  char v18; // [sp+2Ch] [bp-2Ch]@1
  void *v19; // [sp+30h] [bp-28h]@20
  char *v20; // [sp+34h] [bp-24h]@1
  char *v21; // [sp+38h] [bp-20h]@1
  int v22; // [sp+3Ch] [bp-1Ch]@1

  memset(&v18, 0, 0x10u);
  v22 = 0;
  v20 = &v18;
  v21 = &v18;
  if ( *(_DWORD *)(a1 + 96) )
  {
    v1 = evhttp_connection_get_bufferevent(*(_DWORD *)(a1 + 96));
    v2 = v1;
    if ( v1 && (v16 = bufferevent_getfd(v1), v3 = bufferevent_get_underlying(v2), (v4 = (struct bufferevent *)v3) != 0) )
    {
      v16 = bufferevent_getfd(v3);
      if ( v16 < 0 )
      {
        v14 = (int)&v17;
      }
      else
      {
        bufferevent_setfd(v4, -1);
        v14 = (int)&v17;
        sub_807B9B0((int)&v15, (int)&v17, (int)&v16);
      }
      bufferevent_free(v4);
    }
    else
    {
      v14 = (int)&v17;
    }
    evhttp_connection_free(*(_DWORD *)(a1 + 96), v10, v12);
    *(_DWORD *)(a1 + 96) = 0;
  }
  else
  {
    v14 = (int)&v17;
  }
  v5 = *(_DWORD *)(a1 + 92);
  if ( v5 )
  {
    v16 = -1;
    v6 = SSL_get_wbio(v5);
    if ( v6 )
      BIO_ctrl(v6, 105, 0, &v16);
    if ( v16 >= 0 )
    {
      BIO_int_ctrl(v6, 104, 0, -1);
      sub_807B9B0((int)&v15, v14, (int)&v16);
    }
    v16 = -1;
    v7 = SSL_get_rbio(*(_DWORD *)(a1 + 92), v10, v12);
    if ( v7 )
      BIO_ctrl(v7, 105, 0, &v16);
    if ( v16 >= 0 )
    {
      BIO_int_ctrl(v7, 104, 0, -1);
      sub_807B9B0((int)&v15, v14, (int)&v16);
    }
    SSL_clear(*(_DWORD *)(a1 + 92), v11, v13);
    SSL_free(*(_DWORD *)(a1 + 92));
    *(_DWORD *)(a1 + 92) = 0;
  }
  for ( i = (int)v20; (char *)i != &v18; i = std::_Rb_tree_increment(i) )
  {
    v9 = *(_DWORD *)(i + 16);
    evutil_socket_set_no_linger(*(_DWORD *)(i + 16));
    evutil_closesocket(v9);
  }
  sub_807B960(v14, v19);
}
// 804C410: using guessed type int __cdecl SSL_get_rbio(_DWORD, _DWORD, _DWORD);
// 804C430: using guessed type int __cdecl evutil_socket_set_no_linger(_DWORD);
// 804C4D0: using guessed type int __cdecl BIO_ctrl(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C620: using guessed type int __cdecl bufferevent_get_underlying(_DWORD);
// 804C6D0: using guessed type int __cdecl evhttp_connection_get_bufferevent(_DWORD);
// 804C930: using guessed type int __cdecl SSL_free(_DWORD);
// 804CBB0: using guessed type int __cdecl std::_Rb_tree_increment(_DWORD);
// 804CC70: using guessed type int __cdecl bufferevent_getfd(_DWORD);
// 804CD20: using guessed type int __cdecl SSL_get_wbio(_DWORD);
// 804CE10: using guessed type int __cdecl SSL_clear(_DWORD, _DWORD, _DWORD);
// 804D050: using guessed type int __cdecl evhttp_connection_free(_DWORD, _DWORD, _DWORD);
// 804D0C0: using guessed type int __cdecl evutil_closesocket(_DWORD);
// 804D2C0: using guessed type int __cdecl BIO_int_ctrl(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D3A0: using guessed type int __cdecl bufferevent_setfd(_DWORD, _DWORD);

//----- (080725E0) --------------------------------------------------------
int __cdecl sub_80725E0(int a1)
{
  int v1; // ebp@3
  void *v2; // edi@4
  void *v3; // ebx@4
  int v4; // eax@5
  int v5; // edx@5
  int v6; // eax@11
  int v7; // edx@11
  void (__cdecl *v8)(_DWORD, _DWORD, _DWORD); // eax@12
  void (__cdecl *v9)(_DWORD, _DWORD, _DWORD); // eax@14
  void (__cdecl *v10)(_DWORD, _DWORD, _DWORD); // eax@16
  int v11; // eax@18
  int v12; // edx@18
  int result; // eax@19
  signed __int32 v14; // eax@24
  signed __int32 v15; // eax@28
  signed __int32 v16; // eax@32
  signed __int32 v17; // ecx@35
  signed __int32 v18; // ecx@36
  signed __int32 v19; // ecx@37
  char v20; // [sp+2Fh] [bp-1Dh]@26

  *(_DWORD *)a1 = &HttpClient::vftable;
  if ( *(_DWORD *)(a1 + 32) )
  {
    event_remove_timer(*(_DWORD *)(a1 + 32));
    event_free(*(_DWORD *)(a1 + 32));
    *(_DWORD *)(a1 + 32) = 0;
  }
  sub_8072360(a1);
  v1 = *(_DWORD *)(a1 + 124);
  if ( v1 )
  {
    v2 = *(void **)(v1 + 20);
    v3 = *(void **)(v1 + 16);
    if ( v2 != v3 )
    {
      do
      {
        v4 = *(_DWORD *)v3;
        v5 = *(_DWORD *)v3 - 12;
        if ( (_DWORD *)v5 != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v14 = _InterlockedExchangeAdd((volatile signed __int32 *)(v4 - 4), 0xFFFFFFFF);
          }
          else
          {
            v17 = *(_DWORD *)(v4 - 4);
            *(_DWORD *)(v4 - 4) = v17 - 1;
            v14 = v17;
          }
          if ( v14 <= 0 )
            std::string::_Rep::_M_destroy(v5, &v20);
        }
        v3 = (char *)v3 + 4;
      }
      while ( v2 != v3 );
      v2 = *(void **)(v1 + 16);
    }
    if ( v2 )
      operator delete(v2);
    evdns_base_free(*(_DWORD *)(v1 + 8), 1);
    operator delete((void *)v1);
  }
  *(_DWORD *)(a1 + 124) = 0;
  v6 = *(_DWORD *)(a1 + 120);
  v7 = v6 - 12;
  if ( (_DWORD *)(v6 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v16 = _InterlockedExchangeAdd((volatile signed __int32 *)(v6 - 4), 0xFFFFFFFF);
    }
    else
    {
      v19 = *(_DWORD *)(v6 - 4);
      *(_DWORD *)(v6 - 4) = v19 - 1;
      v16 = v19;
    }
    if ( v16 <= 0 )
      std::string::_Rep::_M_destroy(v7, &v20);
  }
  v8 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 80);
  if ( v8 )
    v8(a1 + 72, a1 + 72, 3);
  v9 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 64);
  if ( v9 )
    v9(a1 + 56, a1 + 56, 3);
  v10 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 48);
  if ( v10 )
    v10(a1 + 40, a1 + 40, 3);
  v11 = *(_DWORD *)(a1 + 12);
  v12 = v11 - 12;
  if ( (_DWORD *)(v11 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v15 = _InterlockedExchangeAdd((volatile signed __int32 *)(v11 - 4), 0xFFFFFFFF);
    }
    else
    {
      v18 = *(_DWORD *)(v11 - 4);
      *(_DWORD *)(v11 - 4) = v18 - 1;
      v15 = v18;
    }
    if ( v15 <= 0 )
      std::string::_Rep::_M_destroy(v12, &v20);
  }
  result = *(_DWORD *)(a1 + 4);
  if ( result )
  {
    _InterlockedDecrement((volatile signed __int32 *)(result + 4));
    if ( !result )
      result = (*(int (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  return result;
}
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CB90: using guessed type int __cdecl event_remove_timer(_DWORD);
// 804CF30: using guessed type int __cdecl event_free(_DWORD);
// 80BAB30: using guessed type int (__cdecl *HttpClient::vftable)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08072800) --------------------------------------------------------
void __cdecl sub_8072800(void *a1)
{
  sub_80725E0((int)a1);
  operator delete(a1);
}

//----- (08072820) --------------------------------------------------------
void __cdecl sub_8072820(int a1, int a2)
{
  int v2; // esi@3
  int v3; // edi@3
  int v4; // edi@3
  int v5; // eax@3
  unsigned int v6; // ebp@4
  size_t v7; // eax@5
  int v8; // eax@7
  int v9; // edx@7
  int v10; // ecx@8
  int v11; // edx@10
  int v12; // edx@11
  int v13; // eax@13
  std::ostream *v14; // edi@13
  int v15; // eax@13
  int v16; // esi@13
  char v17; // al@15
  std::ostream *v18; // eax@16
  int v19; // eax@17
  int v20; // edx@17
  signed __int32 v21; // eax@19
  signed __int32 v22; // ecx@28
  signed __int32 v23; // ecx@32
  signed __int32 v24; // ecx@35
  int v25; // [sp+Ch] [bp-E0h]@0
  char v26; // [sp+12h] [bp-DAh]@37
  char v27; // [sp+13h] [bp-D9h]@9
  int v28; // [sp+14h] [bp-D8h]@7
  int v29; // [sp+18h] [bp-D4h]@9
  int v30; // [sp+1Ch] [bp-D0h]@3
  int v31; // [sp+20h] [bp-CCh]@3
  int v32; // [sp+24h] [bp-C8h]@3
  int v33; // [sp+28h] [bp-C4h]@3
  int v34; // [sp+2Ch] [bp-C0h]@3
  int v35; // [sp+30h] [bp-BCh]@3
  int v36; // [sp+34h] [bp-B8h]@3
  int v37; // [sp+38h] [bp-B4h]@3
  char v38; // [sp+3Ch] [bp-B0h]@3
  int v39; // [sp+40h] [bp-ACh]@3
  int v40; // [sp+44h] [bp-A8h]@3
  int v41; // [sp+48h] [bp-A4h]@3
  int v42; // [sp+B8h] [bp-34h]@3
  char v43; // [sp+BCh] [bp-30h]@3
  char v44; // [sp+BDh] [bp-2Fh]@3
  int v45; // [sp+C0h] [bp-2Ch]@3
  int v46; // [sp+C4h] [bp-28h]@3
  int v47; // [sp+C8h] [bp-24h]@3
  int v48; // [sp+CCh] [bp-20h]@3

  if ( log_level > 1 )
    goto LABEL_2;
  std::ios_base::ios_base((std::ios_base *)&v41);
  v41 = (int)&unk_80CF5C8;
  v42 = 0;
  v43 = 0;
  v44 = 0;
  v45 = 0;
  v46 = 0;
  v47 = 0;
  v48 = 0;
  v2 = dword_80CF674;
  v30 = dword_80CF674;
  *(int *)((char *)&v30 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v30 + *(_DWORD *)(v30 - 12), 0);
  v30 = (int)&unk_80CF5DC;
  v41 = (int)&unk_80CF5F0;
  v31 = (int)&unk_80CF7F0;
  v32 = 0;
  v33 = 0;
  v34 = 0;
  v35 = 0;
  v36 = 0;
  v37 = 0;
  std::locale::locale((std::locale *)&v38);
  v31 = (int)&unk_80CF588;
  v39 = 16;
  v40 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v41, &v31);
  v3 = std::__ostream_insert<char,std::char_traits<char>>(&v30, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v3, "request has failed: ", 20);
  std::__ostream_insert<char,std::char_traits<char>>(v3, 134995918, 1);
  v4 = std::__ostream_insert<char,std::char_traits<char>>(
         v3,
         *(_DWORD *)(a1 + 12),
         *(_DWORD *)(*(_DWORD *)(a1 + 12) - 12));
  std::__ostream_insert<char,std::char_traits<char>>(v4, "] ", 2);
  v5 = *(_DWORD *)(a1 + 4);
  if ( !v5 )
  {
    v7 = 0;
    v6 = 134986579;
    goto LABEL_6;
  }
  v6 = *(_DWORD *)(v5 + 8);
  if ( v6 )
  {
    v7 = strlen(*(const char **)(v5 + 8));
LABEL_6:
    std::__ostream_insert<char,std::char_traits<char>>(v4, v6, v7);
    goto LABEL_7;
  }
  std::basic_ios<char,std::char_traits<char>>::clear(
    v4 + *(_DWORD *)(*(_DWORD *)v4 - 12),
    *(_DWORD *)(v4 + *(_DWORD *)(*(_DWORD *)v4 - 12) + 20) | 1);
LABEL_7:
  std::__ostream_insert<char,std::char_traits<char>>(v4, ", err = ", 8);
  v8 = std::ostream::_M_insert<unsigned long>(v4, a2);
  v28 = (int)&unk_80CF83C;
  v9 = *(_DWORD *)(v8 + 24);
  if ( v9 )
  {
    v10 = *(_DWORD *)(v8 + 16);
    LOBYTE(v25) = 0;
    if ( v9 <= (unsigned int)v10 )
    {
      v29 = std::string::_S_construct<char *>(a1, v6, &v27, *(_DWORD *)(v8 + 20), v10, (int)&v27);
      std::string::swap((std::string *)&v28, (std::string *)&v29);
    }
    else
    {
      v29 = std::string::_S_construct<char *>(a1, v6, &v27, *(_DWORD *)(v8 + 20), v9, (int)&v27);
      std::string::swap((std::string *)&v28, (std::string *)&v29);
    }
    v11 = v29 - 12;
    if ( (_DWORD *)(v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
      }
      else
      {
        v24 = *(_DWORD *)(v29 - 4);
        *(_DWORD *)(v29 - 4) = v24 - 1;
      }
      if ( v24 <= 0 )
        std::string::_Rep::_M_destroy(v11, &v26);
    }
  }
  else
  {
    std::string::assign((std::string *)&v28, (const std::string *)(v8 + 40));
  }
  v30 = (int)&unk_80CF5DC;
  v41 = (int)&unk_80CF5F0;
  v31 = (int)&unk_80CF588;
  v12 = v40 - 12;
  if ( (_DWORD *)(v40 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v22 = _InterlockedExchangeAdd((volatile signed __int32 *)(v40 - 4), 0xFFFFFFFF);
    }
    else
    {
      v22 = *(_DWORD *)(v40 - 4);
      *(_DWORD *)(v40 - 4) = v22 - 1;
    }
    if ( v22 <= 0 )
      std::string::_Rep::_M_destroy(v12, &v29);
  }
  v31 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v38);
  v30 = v2;
  *(int *)((char *)&v30 + *(_DWORD *)(v2 - 12)) = dword_80CF678;
  v41 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v41);
  if ( byte_80CE64C )
  {
    v13 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v28, *(_DWORD *)(v28 - 12));
    v14 = (std::ostream *)v13;
    v15 = *(_DWORD *)(*(_DWORD *)v13 - 12);
    v16 = *(_DWORD *)((char *)v14 + v15 + 124);
    if ( !v16 )
    {
      v19 = std::__throw_bad_cast();
      goto LABEL_32;
    }
    if ( *(_BYTE *)(v16 + 28) )
    {
      v17 = *(_BYTE *)(v16 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v14 + v15 + 124));
      v17 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v16 + 24))(v16, 10);
    }
    v18 = (std::ostream *)std::ostream::put(v14, v17);
    std::ostream::flush(v18);
  }
  syslog(7, "%s", v28, v25);
  v19 = v28;
  v20 = v28 - 12;
  if ( (_DWORD *)(v28 - 12) == &std::string::_Rep::_S_empty_rep_storage )
    goto LABEL_2;
  if ( &_pthread_key_create )
  {
    v21 = _InterlockedExchangeAdd((volatile signed __int32 *)(v28 - 4), 0xFFFFFFFF);
    goto LABEL_20;
  }
LABEL_32:
  v23 = *(_DWORD *)(v19 - 4);
  *(_DWORD *)(v19 - 4) = v23 - 1;
  v21 = v23;
LABEL_20:
  if ( v21 <= 0 )
    std::string::_Rep::_M_destroy(v20, &v30);
LABEL_2:
  *(_DWORD *)(a1 + 112) = 0;
  *(_DWORD *)(a1 + 100) = 0;
}
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08072DC0) --------------------------------------------------------
void __cdecl sub_8072DC0(int a1, int a2)
{
  sub_8072820(a2, a1);
}

//----- (08072DE0) --------------------------------------------------------
void __cdecl sub_8072DE0(int a1, int a2)
{
  sub_8072820(a2, a1);
}

//----- (08072E00) --------------------------------------------------------
int __cdecl do_http_create_request(int a1)
{
  unsigned int v1; // ebp@0
  int v2; // ebx@1
  int v3; // eax@2
  int v4; // eax@4
  char *v5; // eax@6
  int v6; // eax@8
  char *cookie; // eax@11
  int v8; // eax@12
  char *v9; // edx@16
  char *v11; // esi@21
  int v12; // ebx@21
  int v13; // eax@21
  int v14; // edx@22
  int v15; // edx@24
  int v16; // edx@25
  int v17; // eax@27
  std::ostream *v18; // esi@27
  int v19; // eax@27
  int v20; // ebx@27
  char v21; // al@29
  std::ostream *v22; // eax@30
  int v23; // edx@31
  signed __int32 v24; // eax@37
  signed __int32 v25; // eax@42
  signed __int32 v26; // ecx@46
  signed __int32 v27; // ecx@50
  int v28; // ebx@53
  signed __int32 v29; // ecx@56
  signed __int32 v30; // ecx@57
  int v31; // [sp+Ch] [bp-ECh]@0
  int v32; // [sp+18h] [bp-E0h]@5
  int v33; // [sp+1Ch] [bp-DCh]@4
  char v34; // [sp+22h] [bp-D6h]@48
  char v35; // [sp+23h] [bp-D5h]@23
  int v36; // [sp+24h] [bp-D4h]@21
  int v37; // [sp+28h] [bp-D0h]@23
  char *host; // [sp+2Ch] [bp-CCh]@2
  int v39; // [sp+30h] [bp-C8h]@21
  int v40; // [sp+34h] [bp-C4h]@21
  int v41; // [sp+38h] [bp-C0h]@21
  int v42; // [sp+3Ch] [bp-BCh]@21
  int v43; // [sp+40h] [bp-B8h]@21
  int v44; // [sp+44h] [bp-B4h]@21
  int v45; // [sp+48h] [bp-B0h]@21
  char v46; // [sp+4Ch] [bp-ACh]@21
  int v47; // [sp+50h] [bp-A8h]@21
  int v48; // [sp+54h] [bp-A4h]@21
  int v49; // [sp+58h] [bp-A0h]@21
  int v50; // [sp+C8h] [bp-30h]@21
  char v51; // [sp+CCh] [bp-2Ch]@21
  char v52; // [sp+CDh] [bp-2Bh]@21
  int v53; // [sp+D0h] [bp-28h]@21
  int v54; // [sp+D4h] [bp-24h]@21
  int v55; // [sp+D8h] [bp-20h]@21
  int v56; // [sp+DCh] [bp-1Ch]@21

  v2 = evhttp_request_new(sub_8078940, a1);
  if ( !v2 )
  {
    if ( log_level <= 5 )
    {
      std::ios_base::ios_base((std::ios_base *)&v49);
      v49 = (int)&unk_80CF5C8;
      v50 = 0;
      v51 = 0;
      v52 = 0;
      v53 = 0;
      v54 = 0;
      v55 = 0;
      v56 = 0;
      v11 = (char *)dword_80CF674;
      host = (char *)dword_80CF674;
      (&host)[*(_DWORD *)(dword_80CF674 - 12)] = (char *)dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init(&(&host)[*((_DWORD *)host - 3)], 0);
      host = (char *)&unk_80CF5DC;
      v49 = (int)&unk_80CF5F0;
      v39 = (int)&unk_80CF7F0;
      v40 = 0;
      v41 = 0;
      v42 = 0;
      v43 = 0;
      v44 = 0;
      v45 = 0;
      std::locale::locale((std::locale *)&v46);
      v39 = (int)&unk_80CF588;
      v47 = 16;
      v48 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v49, &v39);
      v12 = std::__ostream_insert<char,std::char_traits<char>>(
              &host,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v12, "VERIFY failed (", 15);
      std::__ostream_insert<char,std::char_traits<char>>(v12, "req", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v12, "): ", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v12, "evhttp_request_new failed", 25);
      v36 = (int)&unk_80CF83C;
      v13 = *(_DWORD *)(v12 + 24);
      if ( v13 )
      {
        v14 = *(_DWORD *)(v12 + 16);
        LOBYTE(v31) = 0;
        if ( v13 > (unsigned int)v14 )
        {
          v37 = std::string::_S_construct<char *>(v12, v1, &host, *(_DWORD *)(v12 + 20), v13, (int)&v35);
          std::string::swap((std::string *)&v36, (std::string *)&v37);
        }
        else
        {
          v37 = std::string::_S_construct<char *>(v12, v1, &host, *(_DWORD *)(v12 + 20), v14, (int)&v35);
          std::string::swap((std::string *)&v36, (std::string *)&v37);
        }
        v15 = v37 - 12;
        if ( (_DWORD *)(v37 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v37 - 4), 0xFFFFFFFF);
          }
          else
          {
            v26 = *(_DWORD *)(v37 - 4);
            *(_DWORD *)(v37 - 4) = v26 - 1;
          }
          if ( v26 <= 0 )
            std::string::_Rep::_M_destroy(v15, &v34);
        }
      }
      else
      {
        std::string::assign((std::string *)&v36, (const std::string *)(v12 + 40));
      }
      host = (char *)&unk_80CF5DC;
      v49 = (int)&unk_80CF5F0;
      v39 = (int)&unk_80CF588;
      v16 = v48 - 12;
      if ( (_DWORD *)(v48 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v27 = _InterlockedExchangeAdd((volatile signed __int32 *)(v48 - 4), 0xFFFFFFFF);
        }
        else
        {
          v27 = *(_DWORD *)(v48 - 4);
          *(_DWORD *)(v48 - 4) = v27 - 1;
        }
        if ( v27 <= 0 )
          std::string::_Rep::_M_destroy(v16, &v37);
      }
      v39 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v46);
      host = v11;
      (&host)[*((_DWORD *)v11 - 3)] = (char *)dword_80CF678;
      v49 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v49);
      if ( byte_80CE64C )
      {
        v17 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v36, *(_DWORD *)(v36 - 12));
        v18 = (std::ostream *)v17;
        v19 = *(_DWORD *)(*(_DWORD *)v17 - 12);
        v20 = *(_DWORD *)((char *)v18 + v19 + 124);
        if ( !v20 )
        {
          v28 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v36 - 12, &host);
          Unwind_Resume(v28);
        }
        if ( *(_BYTE *)(v20 + 28) )
        {
          v21 = *(_BYTE *)(v20 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v18 + v19 + 124));
          v21 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v20 + 24))(v20, 10);
        }
        v22 = (std::ostream *)std::ostream::put(v18, v21);
        std::ostream::flush(v22);
      }
      syslog(3, "%s", v36, v31);
      v23 = v36 - 12;
      if ( (_DWORD *)(v36 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v36 - 4), 0xFFFFFFFF);
        }
        else
        {
          v30 = *(_DWORD *)(v36 - 4);
          *(_DWORD *)(v36 - 4) = v30 - 1;
          v24 = v30;
        }
        if ( v24 <= 0 )
          std::string::_Rep::_M_destroy(v23, &host);
      }
    }
    abort();
  }
  sub_808AF20((int)&host, a1 + 4);
  v3 = *(_DWORD *)(a1 + 4);
  if ( v3 && *(_DWORD *)(v3 + 36) )
  {
    v33 = *((_DWORD *)host - 3);
    std::string::resize((std::string *)&host, v33 + 11, 0);
    v4 = *(_DWORD *)(a1 + 4);
    if ( v4 )
      v32 = *(_DWORD *)(v4 + 36);
    else
      v32 = 0;
    v5 = host;
    if ( *((_DWORD *)host - 1) >= 0 )
    {
      std::string::_M_leak_hard((std::string *)&host);
      v5 = host;
    }
    v6 = snprintf(&v5[v33], 0xBu, ":%d", v32);
    std::string::resize((std::string *)&host, v33 + v6, 0);
  }
  evhttp_add_header(*(_DWORD *)(v2 + 20), "Host", host);
  evhttp_add_header(*(_DWORD *)(v2 + 20), "Connection", "close");
  if ( *(_DWORD *)(a1 + 116) )
    evhttp_add_header(*(_DWORD *)(v2 + 20), "User-Agent", *(char **)(a1 + 116));
  evhttp_add_header(*(_DWORD *)(v2 + 20), "Accept-Encoding", "identity;q=1.0, *;q=0");
  evhttp_add_header(*(_DWORD *)(v2 + 20), "Accept-Charset", "utf-8;q=1.0, *;q=0.1");
  cookie = *(char **)(a1 + 120);
  if ( !*((_DWORD *)cookie - 3) )
  {
    v8 = *(_DWORD *)(a1 + 104);
    if ( !v8 )
      goto LABEL_14;
    goto LABEL_13;
  }
  evhttp_add_header(*(_DWORD *)(v2 + 20), "Cookie", cookie);
  v8 = *(_DWORD *)(a1 + 104);
  if ( v8 )
LABEL_13:
    evbuffer_add_buffer_reference(*(_DWORD *)(v2 + 88), v8);
LABEL_14:
  if ( *(_DWORD *)(a1 + 48) )
    evhttp_request_set_chunked_cb(v2, sub_8072320);
  evhttp_request_set_error_cb(v2, sub_8072DE0);
  v9 = host - 12;
  if ( (_DWORD *)(host - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v25 = _InterlockedExchangeAdd((volatile signed __int32 *)host - 1, 0xFFFFFFFF);
    }
    else
    {
      v29 = *((_DWORD *)host - 1);
      *((_DWORD *)host - 1) = v29 - 1;
      v25 = v29;
    }
    if ( v25 <= 0 )
      std::string::_Rep::_M_destroy(v9, &v37);
  }
  return v2;
}
// 804C5D0: using guessed type int __cdecl evhttp_request_set_error_cb(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA40: using guessed type int __cdecl evhttp_request_set_chunked_cb(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CDC0: using guessed type int __cdecl evhttp_request_new(_DWORD, _DWORD);
// 804CEC0: using guessed type int __cdecl evbuffer_add_buffer_reference(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080735F0) --------------------------------------------------------
signed int __cdecl sub_80735F0(int a1, int a2)
{
  signed int result; // eax@2
  int v3; // ebx@4
  int v4; // edi@4
  int v5; // esi@4
  int v6; // eax@5
  const char *v7; // eax@5
  const char *v8; // ebx@5
  unsigned int v9; // eax@5
  int v10; // eax@6
  int v11; // ecx@8
  signed __int32 v12; // edx@10
  signed int v13; // ST1C_4@12
  int v14; // eax@13
  int v15; // edx@14
  int v16; // ebx@16
  int v17; // ebx@16
  std::ostream *v18; // ebx@16
  int v19; // eax@16
  int v20; // edi@16
  char v21; // al@18
  std::ostream *v22; // eax@19
  char **v23; // edx@19
  char *v24; // ecx@20
  unsigned int v25; // eax@20
  int v26; // eax@23
  int v27; // ebx@23
  char v28; // al@25
  std::ostream *v29; // eax@26
  int v30; // eax@26
  int v31; // edx@26
  int v32; // ecx@27
  int v33; // edx@29
  int v34; // edx@30
  int v35; // edx@31
  int v36; // eax@33
  std::ostream *v37; // esi@33
  int v38; // eax@33
  int v39; // ebx@33
  char v40; // al@35
  std::ostream *v41; // eax@36
  int v42; // edx@37
  signed __int32 v43; // eax@39
  int v44; // eax@42
  int v45; // edx@43
  char *v46; // eax@45
  int v47; // ebx@62
  char *v48; // ecx@62
  signed __int32 v49; // ecx@67
  signed __int32 v50; // ebx@70
  signed __int32 v51; // eax@73
  signed __int32 v52; // ecx@77
  signed __int32 v53; // ecx@80
  signed __int32 v54; // ecx@83
  int v55; // esi@88
  signed __int32 v56; // ecx@87
  int v57; // [sp+Ch] [bp-200h]@0
  char *v58; // [sp+1Ch] [bp-1F0h]@0
  char v59; // [sp+2Ah] [bp-1E2h]@62
  char v60; // [sp+2Bh] [bp-1E1h]@28
  int v61; // [sp+2Ch] [bp-1E0h]@4
  int v62; // [sp+30h] [bp-1DCh]@15
  int v63; // [sp+34h] [bp-1D8h]@15
  int v64; // [sp+38h] [bp-1D4h]@28
  int v65; // [sp+3Ch] [bp-1D0h]@16
  int v66; // [sp+40h] [bp-1CCh]@16
  int v67; // [sp+44h] [bp-1C8h]@16
  int v68; // [sp+48h] [bp-1C4h]@16
  int v69; // [sp+4Ch] [bp-1C0h]@16
  int v70; // [sp+50h] [bp-1BCh]@16
  int v71; // [sp+54h] [bp-1B8h]@16
  int v72; // [sp+58h] [bp-1B4h]@16
  char v73; // [sp+5Ch] [bp-1B0h]@16
  int v74; // [sp+60h] [bp-1ACh]@16
  int v75; // [sp+64h] [bp-1A8h]@16
  int v76; // [sp+68h] [bp-1A4h]@16
  int v77; // [sp+D8h] [bp-134h]@16
  char v78; // [sp+DCh] [bp-130h]@16
  char v79; // [sp+DDh] [bp-12Fh]@16
  int v80; // [sp+E0h] [bp-12Ch]@16
  int v81; // [sp+E4h] [bp-128h]@16
  int v82; // [sp+E8h] [bp-124h]@16
  int v83; // [sp+ECh] [bp-120h]@16
  char *v84; // [sp+F0h] [bp-11Ch]@4

  if ( *(_BYTE *)(a1 + 16) )
  {
    v3 = X509_verify_cert(a2);
    v4 = X509_STORE_CTX_get_current_cert(a2);
    v5 = (int)&v61;
    std::string::string(&v61, "X509_verify_cert failed: ", &v84);
    if ( v3 == 1 )
    {
      v44 = *(_DWORD *)(a1 + 4);
      if ( v44 && (v45 = *(_DWORD *)(v44 + 32)) != 0 )
        std::string::string(&v84, *(_DWORD *)(v44 + 28), v45, &v60);
      else
        std::string::string((std::string *)&v84, (const std::string *)&dword_80CF8FC);
      v27 = sub_80A7310(v84, v4);
      v46 = v84;
      v58 = v84 - 12;
      if ( (_DWORD *)(v84 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        goto LABEL_66;
      goto LABEL_46;
    }
    v6 = X509_STORE_CTX_get_error(a2);
    v7 = (const char *)X509_verify_cert_error_string(v6);
    v8 = v7;
    v9 = strlen(v7);
    std::string::append((std::string *)&v61, v8, v9);
    while ( 1 )
    {
      v10 = X509_get_subject_name(v4);
      X509_NAME_oneline(v10, &v84, 256);
      if ( log_level > 5 )
        goto LABEL_7;
      v14 = *(_DWORD *)(a1 + 4);
      if ( v14 && (v15 = *(_DWORD *)(v14 + 32)) != 0 )
        std::string::string(&v63, *(_DWORD *)(v14 + 28), v15, &v62);
      else
        std::string::string((std::string *)&v63, (const std::string *)&dword_80CF8FC);
      std::ios_base::ios_base((std::ios_base *)&v76);
      v76 = (int)&unk_80CF5C8;
      v77 = 0;
      v78 = 0;
      v79 = 0;
      v80 = 0;
      v81 = 0;
      v82 = 0;
      v83 = 0;
      v5 = dword_80CF674;
      v65 = dword_80CF674;
      *(int *)((char *)&v65 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v65 + *(_DWORD *)(v65 - 12), 0);
      v65 = (int)&unk_80CF5DC;
      v76 = (int)&unk_80CF5F0;
      v66 = (int)&unk_80CF7F0;
      v67 = 0;
      v68 = 0;
      v69 = 0;
      v70 = 0;
      v71 = 0;
      v72 = 0;
      std::locale::locale((std::locale *)&v73);
      v66 = (int)&unk_80CF588;
      v74 = 16;
      v75 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v76, &v66);
      v16 = std::__ostream_insert<char,std::char_traits<char>>(
              &v65,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v16, "Got '", 5);
      v17 = std::__ostream_insert<char,std::char_traits<char>>(v16, v61, *(_DWORD *)(v61 - 12));
      std::__ostream_insert<char,std::char_traits<char>>(v17, "' for hostname '", 16);
      v18 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(v17, v63, *(_DWORD *)(v63 - 12));
      std::__ostream_insert<char,std::char_traits<char>>(v18, "' and certificate: ", 19);
      v19 = *(_DWORD *)(*(_DWORD *)v18 - 12);
      v20 = *(_DWORD *)((char *)v18 + v19 + 124);
      if ( !v20 )
      {
        v55 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v64 - 12, &v59);
        std::string::_Rep::_M_dispose(v62 - 12, 0);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v65);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v18);
        std::string::_Rep::_M_dispose(v63 - 12, v18);
        v47 = v55;
        v48 = &v59;
        goto LABEL_63;
      }
      if ( *(_BYTE *)(v20 + 28) )
      {
        v21 = *(_BYTE *)(v20 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v18 + v19 + 124));
        v21 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v20 + 24))(v20, 10);
      }
      v22 = (std::ostream *)std::ostream::put(v18, v21);
      v4 = std::ostream::flush(v22);
      v23 = &v84;
      do
      {
        v24 = *v23;
        ++v23;
        v25 = ~(unsigned int)v24 & (unsigned int)(v24 - 16843009) & 0x80808080;
      }
      while ( !v25 );
      if ( !(~(unsigned int)v24 & (unsigned int)(v24 - 16843009) & 0x8080) )
      {
        v25 >>= 16;
        v23 = (char **)((char *)v23 + 2);
      }
      std::__ostream_insert<char,std::char_traits<char>>(
        v4,
        &v84,
        (char *)v23 + -__CFADD__((_BYTE)v25, (_BYTE)v25) - 3 - (char *)&v84);
      v26 = *(_DWORD *)(*(_DWORD *)v4 - 12);
      v27 = *(_DWORD *)(v4 + v26 + 124);
      if ( v27 )
        break;
      v46 = (char *)std::__throw_bad_cast();
LABEL_66:
      if ( &_pthread_key_create )
      {
        v49 = _InterlockedExchangeAdd((volatile signed __int32 *)v46 - 1, 0xFFFFFFFF);
      }
      else
      {
        v49 = *((_DWORD *)v46 - 1);
        *((_DWORD *)v46 - 1) = v49 - 1;
      }
      if ( v49 <= 0 )
        std::string::_Rep::_M_destroy(v58, &v65);
LABEL_46:
      switch ( v27 )
      {
        case 3:
          std::string::assign((std::string *)v5, "MalformedCertificate", 0x14u);
          break;
        case 2:
          std::string::assign((std::string *)v5, "NoSANPresent", 0xCu);
          break;
        case 1:
          std::string::assign((std::string *)v5, "MatchNotFound", 0xDu);
          break;
        case 0:
          std::string::assign((std::string *)v5, "MatchFound", 0xAu);
          break;
        case 4:
          std::string::assign((std::string *)v5, "Error", 5u);
          break;
        default:
          std::string::assign((std::string *)v5, "Unknown", 7u);
          break;
      }
      if ( !v27 )
      {
        result = 1;
        goto LABEL_8;
      }
    }
    if ( *(_BYTE *)(v27 + 28) )
    {
      v28 = *(_BYTE *)(v27 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)(v4 + v26 + 124));
      v28 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v27 + 24))(v27, 10);
    }
    v29 = (std::ostream *)std::ostream::put((std::ostream *)v4, v28);
    v30 = std::ostream::flush(v29);
    v62 = (int)&unk_80CF83C;
    v31 = *(_DWORD *)(v30 + 24);
    if ( v31 )
    {
      v32 = *(_DWORD *)(v30 + 16);
      LOBYTE(v57) = 0;
      if ( v31 <= (unsigned int)v32 )
      {
        v64 = std::string::_S_construct<char *>(
                (int)&v60,
                (unsigned int)&v84,
                (void *)v4,
                *(_DWORD *)(v30 + 20),
                v32,
                (int)&v60);
        std::string::swap((std::string *)&v62, (std::string *)&v64);
      }
      else
      {
        v64 = std::string::_S_construct<char *>(
                (int)&v60,
                (unsigned int)&v84,
                (void *)v4,
                *(_DWORD *)(v30 + 20),
                v31,
                (int)&v60);
        std::string::swap((std::string *)&v62, (std::string *)&v64);
      }
      v33 = v64 - 12;
      if ( (_DWORD *)(v64 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v54 = _InterlockedExchangeAdd((volatile signed __int32 *)(v64 - 4), 0xFFFFFFFF);
        }
        else
        {
          v54 = *(_DWORD *)(v64 - 4);
          *(_DWORD *)(v64 - 4) = v54 - 1;
        }
        if ( v54 <= 0 )
          std::string::_Rep::_M_destroy(v33, &v59);
      }
    }
    else
    {
      std::string::assign((std::string *)&v62, (const std::string *)(v30 + 40));
    }
    v65 = (int)&unk_80CF5DC;
    v76 = (int)&unk_80CF5F0;
    v66 = (int)&unk_80CF588;
    v34 = v75 - 12;
    if ( (_DWORD *)(v75 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v52 = _InterlockedExchangeAdd((volatile signed __int32 *)(v75 - 4), 0xFFFFFFFF);
      }
      else
      {
        v52 = *(_DWORD *)(v75 - 4);
        *(_DWORD *)(v75 - 4) = v52 - 1;
      }
      if ( v52 <= 0 )
        std::string::_Rep::_M_destroy(v34, &v64);
    }
    v66 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v73);
    v65 = v5;
    *(int *)((char *)&v65 + *(_DWORD *)(v5 - 12)) = dword_80CF678;
    v76 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v76);
    v35 = v63 - 12;
    if ( (_DWORD *)(v63 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v51 = _InterlockedExchangeAdd((volatile signed __int32 *)(v63 - 4), 0xFFFFFFFF);
      }
      else
      {
        v53 = *(_DWORD *)(v63 - 4);
        *(_DWORD *)(v63 - 4) = v53 - 1;
        v51 = v53;
      }
      if ( v51 <= 0 )
        std::string::_Rep::_M_destroy(v35, &v65);
    }
    if ( byte_80CE64C )
    {
      v36 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v62, *(_DWORD *)(v62 - 12));
      v37 = (std::ostream *)v36;
      v38 = *(_DWORD *)(*(_DWORD *)v36 - 12);
      v39 = *(_DWORD *)((char *)v37 + v38 + 124);
      if ( v39 )
      {
        if ( *(_BYTE *)(v39 + 28) )
        {
          v40 = *(_BYTE *)(v39 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v37 + v38 + 124));
          v40 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v39 + 24))(v39, 10);
        }
        v41 = (std::ostream *)std::ostream::put(v37, v40);
        std::ostream::flush(v41);
        goto LABEL_37;
      }
      v47 = std::__throw_bad_cast();
      std::string::_Rep::_M_dispose(v62 - 12, &v65);
      v48 = &v59;
LABEL_63:
      std::string::_Rep::_M_dispose(v61 - 12, v48);
      Unwind_Resume(v47);
    }
LABEL_37:
    syslog(3, "%s", v62, v57);
    v42 = v62 - 12;
    if ( (_DWORD *)(v62 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v43 = _InterlockedExchangeAdd((volatile signed __int32 *)(v62 - 4), 0xFFFFFFFF);
      }
      else
      {
        v56 = *(_DWORD *)(v62 - 4);
        *(_DWORD *)(v62 - 4) = v56 - 1;
        v43 = v56;
      }
      if ( v43 <= 0 )
        std::string::_Rep::_M_destroy(v42, &v65);
    }
LABEL_7:
    result = 0;
LABEL_8:
    v11 = v61 - 12;
    if ( (_DWORD *)(v61 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v12 = _InterlockedExchangeAdd((volatile signed __int32 *)(v61 - 4), 0xFFFFFFFF);
      }
      else
      {
        v50 = *(_DWORD *)(v61 - 4);
        *(_DWORD *)(v61 - 4) = v50 - 1;
        v12 = v50;
      }
      if ( v12 <= 0 )
      {
        v13 = result;
        std::string::_Rep::_M_destroy(v11, &v84);
        result = v13;
      }
    }
  }
  else
  {
    result = 1;
  }
  return result;
}
// 804C550: using guessed type int __cdecl X509_STORE_CTX_get_error(_DWORD);
// 804C5B0: using guessed type int __cdecl X509_NAME_oneline(_DWORD, _DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C910: using guessed type int __cdecl X509_get_subject_name(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CB30: using guessed type int __cdecl X509_verify_cert(_DWORD);
// 804CB80: using guessed type int __cdecl X509_verify_cert_error_string(_DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE50: using guessed type int __cdecl X509_STORE_CTX_get_current_cert(_DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (08073FC0) --------------------------------------------------------
signed int __cdecl sub_8073FC0(int a1, int a2)
{
  return sub_80735F0(a2, a1);
}

//----- (08073FE0) --------------------------------------------------------
signed int __cdecl sub_8073FE0(int a1, int a2)
{
  return sub_80735F0(a2, a1);
}

//----- (08074000) --------------------------------------------------------
void __cdecl sub_8074000(unsigned int a1, int a2)
{
  int v2; // eax@1
  int v3; // eax@3
  int v4; // edx@4
  std::string *v5; // edi@5
  int v6; // eax@5
  int v7; // ST1C_4@5
  unsigned int v8; // eax@5
  __int128 v9; // ST00_16@5
  unsigned int v10; // eax@5
  int v11; // eax@5
  int v12; // edx@5
  int v13; // edx@6
  char *v14; // edx@7
  int v15; // edx@9
  char *v16; // ebx@12
  struct event_base *v17; // eax@12
  int v18; // eax@13
  char *v19; // edx@24
  int v20; // esi@26
  int *v21; // edi@27
  int v22; // eax@28
  int v23; // edx@28
  int v24; // esi@34
  int v25; // eax@34
  int v26; // edx@35
  char *v27; // esi@37
  int v28; // edx@38
  char v29; // al@42
  std::ostream *v30; // eax@43
  int v31; // edx@44
  signed __int32 v32; // eax@46
  signed __int32 v33; // eax@54
  signed __int32 v34; // ecx@58
  signed __int32 v35; // ecx@60
  signed __int32 v36; // eax@65
  signed __int32 v37; // eax@69
  signed __int32 v38; // ecx@72
  signed __int32 v39; // ecx@73
  signed __int32 v40; // esi@75
  signed __int32 v41; // ecx@79
  std::runtime_error *v42; // esi@80
  signed __int32 v43; // eax@83
  std::runtime_error *v44; // ebx@86
  signed __int32 v45; // eax@89
  signed __int32 v46; // ecx@92
  signed __int32 v47; // ecx@93
  unsigned int v48; // [sp+Ch] [bp-130h]@0
  int v49; // [sp+1Ch] [bp-120h]@40
  char v50; // [sp+26h] [bp-116h]@5
  char v51; // [sp+28h] [bp-114h]@10
  int v52; // [sp+2Ch] [bp-110h]@5
  char *v53; // [sp+30h] [bp-10Ch]@10
  int v54; // [sp+34h] [bp-108h]@86
  int v55; // [sp+38h] [bp-104h]@34
  int v56; // [sp+3Ch] [bp-100h]@62
  int v57; // [sp+40h] [bp-FCh]@13
  int v58; // [sp+44h] [bp-F8h]@13
  int v59; // [sp+48h] [bp-F4h]@16
  std::string **v60; // [sp+4Ch] [bp-F0h]@16
  std::string *v61; // [sp+50h] [bp-ECh]@5
  std::string *v62; // [sp+54h] [bp-E8h]@16
  int v63; // [sp+58h] [bp-E4h]@16
  char v64; // [sp+5Ch] [bp-E0h]@12
  struct event_base *v65; // [sp+60h] [bp-DCh]@12
  int v66; // [sp+64h] [bp-D8h]@12
  int v67; // [sp+68h] [bp-D4h]@12
  int v68; // [sp+6Ch] [bp-D0h]@5
  int v69; // [sp+70h] [bp-CCh]@34
  int v70; // [sp+74h] [bp-C8h]@34
  int v71; // [sp+78h] [bp-C4h]@34
  int v72; // [sp+7Ch] [bp-C0h]@34
  int v73; // [sp+80h] [bp-BCh]@34
  int v74; // [sp+84h] [bp-B8h]@34
  int v75; // [sp+88h] [bp-B4h]@34
  char v76; // [sp+8Ch] [bp-B0h]@34
  int v77; // [sp+90h] [bp-ACh]@34
  int v78; // [sp+94h] [bp-A8h]@34
  int v79; // [sp+98h] [bp-A4h]@34
  int v80; // [sp+108h] [bp-34h]@34
  char v81; // [sp+10Ch] [bp-30h]@34
  char v82; // [sp+10Dh] [bp-2Fh]@34
  int v83; // [sp+110h] [bp-2Ch]@34
  int v84; // [sp+114h] [bp-28h]@34
  int v85; // [sp+118h] [bp-24h]@34
  int v86; // [sp+11Ch] [bp-20h]@34

  v2 = *(_DWORD *)a2;
  *(_DWORD *)a1 = *(_DWORD *)a2;
  if ( v2 )
    _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
  *(_DWORD *)(a1 + 4) = &unk_80CF83C;
  *(_DWORD *)(a1 + 8) = &unk_80CF83C;
  v3 = *(_DWORD *)a2;
  if ( !*(_DWORD *)a2 )
    goto LABEL_96;
  v4 = *(_DWORD *)(v3 + 24);
  if ( v4 )
  {
    std::string::string(&v61, *(_DWORD *)(v3 + 20), v4, &v50);
    v5 = v61;
    v6 = *((_DWORD *)v61 - 3);
    v52 = (int)&unk_80CF83C;
    v7 = v6;
    v8 = sub_80A6440(v6);
    std::string::resize((std::string *)&v52, v8, 0);
    DWORD3(v9) = *(_DWORD *)(v52 - 12);
    DWORD2(v9) = v52;
    *(_QWORD *)&v9 = __PAIR__(v7, (unsigned int)v5);
    v10 = sub_80A6460(v9);
    std::string::resize((std::string *)&v52, v10, 0);
    v11 = std::string::insert((std::string *)&v52, 0, "Basic ", 6u);
    v68 = *(_DWORD *)v11;
    *(_DWORD *)v11 = &unk_80CF83C;
    std::string::swap((std::string *)(a1 + 8), (std::string *)&v68);
    v12 = v68 - 12;
    if ( (_DWORD *)(v68 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v68 - 4), 0xFFFFFFFF);
      }
      else
      {
        v39 = *(_DWORD *)(v68 - 4);
        *(_DWORD *)(v68 - 4) = v39 - 1;
        v37 = v39;
      }
      if ( v37 <= 0 )
        std::string::_Rep::_M_destroy(v12, &v64);
    }
    v13 = v52 - 12;
    if ( (_DWORD *)(v52 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v52 - 4), 0xFFFFFFFF);
      }
      else
      {
        v38 = *(_DWORD *)(v52 - 4);
        *(_DWORD *)(v52 - 4) = v38 - 1;
        v36 = v38;
      }
      if ( v36 <= 0 )
        std::string::_Rep::_M_destroy(v13, &v68);
    }
    v14 = (char *)v61 - 12;
    if ( (_DWORD *)((char *)v61 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v43 = _InterlockedExchangeAdd((volatile signed __int32 *)v61 - 1, 0xFFFFFFFF);
      }
      else
      {
        v47 = *((_DWORD *)v61 - 1);
        *((_DWORD *)v61 - 1) = v47 - 1;
        v43 = v47;
      }
      if ( v43 <= 0 )
        std::string::_Rep::_M_destroy(v14, &v68);
    }
    v3 = *(_DWORD *)a2;
    if ( !*(_DWORD *)a2 )
      goto LABEL_96;
  }
  v15 = *(_DWORD *)(v3 + 32);
  if ( v15 )
    std::string::string(&v53, *(_DWORD *)(v3 + 28), v15, &v51);
  else
LABEL_96:
    std::string::string((std::string *)&v53, (const std::string *)&dword_80CF8FC);
  v16 = v53;
  v64 = 0;
  v17 = (struct event_base *)event_base_new();
  v65 = v17;
  v66 = 0;
  v67 = 0;
  if ( !v17 )
  {
    v44 = (std::runtime_error *)_cxa_allocate_exception(8);
    std::string::string(&v54, "Event dispatcher initialization failed", &v68);
    std::runtime_error::runtime_error(v44, (const std::string *)&v54);
    *(_DWORD *)v44 = &off_80BAB18;
    std::string::_Rep::_M_dispose(v54 - 12, &v61);
    _cxa_throw(v44, &off_80BAADC, sub_807B6C0);
  }
  v57 = 2;
  v18 = evdns_base_new(v17, 32769);
  v58 = v18;
  if ( !v18 )
  {
    v42 = (std::runtime_error *)_cxa_allocate_exception(8);
    std::string::string(&v56, "Event DNS initialization failed", &v68);
    std::runtime_error::runtime_error(v42, (const std::string *)&v56);
    *(_DWORD *)v42 = &off_80BAB18;
    std::string::_Rep::_M_dispose(v56 - 12, &v61);
    _cxa_throw(v42, &off_80BAADC, sub_807B6C0);
  }
  if ( evdns_base_set_option(v18, "randomize-case", "0") && log_level <= 5 )
  {
    v21 = &v68;
    std::ios_base::ios_base((std::ios_base *)&v79);
    v79 = (int)&unk_80CF5C8;
    v80 = 0;
    v81 = 0;
    v82 = 0;
    v83 = 0;
    v84 = 0;
    v85 = 0;
    v86 = 0;
    v68 = dword_80CF674;
    *(int *)((char *)&v68 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v68 + *(_DWORD *)(v68 - 12), 0);
    v68 = (int)&unk_80CF5DC;
    v79 = (int)&unk_80CF5F0;
    v69 = (int)&unk_80CF7F0;
    v70 = 0;
    v71 = 0;
    v72 = 0;
    v73 = 0;
    v74 = 0;
    v75 = 0;
    std::locale::locale((std::locale *)&v76);
    v69 = (int)&unk_80CF588;
    v77 = 16;
    v78 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v79, &v69);
    v24 = std::__ostream_insert<char,std::char_traits<char>>(
            &v68,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v24, "Event DNS failed to drop randomize-case option", 46);
    v55 = (int)&unk_80CF83C;
    v25 = *(_DWORD *)(v24 + 24);
    if ( v25 )
    {
      v26 = *(_DWORD *)(v24 + 16);
      LOBYTE(v48) = 0;
      if ( v25 > (unsigned int)v26 )
      {
        v61 = (std::string *)std::string::_S_construct<char *>(
                               (int)v16,
                               a1,
                               &v68,
                               *(_DWORD *)(v24 + 20),
                               v25,
                               (int)&v59);
        std::string::swap((std::string *)&v55, (std::string *)&v61);
      }
      else
      {
        v61 = (std::string *)std::string::_S_construct<char *>(
                               (int)v16,
                               a1,
                               &v68,
                               *(_DWORD *)(v24 + 20),
                               v26,
                               (int)&v59);
        std::string::swap((std::string *)&v55, (std::string *)&v61);
      }
      v27 = (char *)v61 - 12;
      if ( (_DWORD *)((char *)v61 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v35 = _InterlockedExchangeAdd((volatile signed __int32 *)v61 - 1, 0xFFFFFFFF);
        }
        else
        {
          v35 = *((_DWORD *)v61 - 1);
          *((_DWORD *)v61 - 1) = v35 - 1;
        }
        if ( v35 <= 0 )
          std::string::_Rep::_M_destroy(v27, &v56);
      }
    }
    else
    {
      std::string::assign((std::string *)&v55, (const std::string *)(v24 + 40));
    }
    v68 = (int)&unk_80CF5DC;
    v79 = (int)&unk_80CF5F0;
    v69 = (int)&unk_80CF588;
    v28 = v78 - 12;
    if ( (_DWORD *)(v78 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v78 - 4), 0xFFFFFFFF);
      }
      else
      {
        v40 = *(_DWORD *)(v78 - 4);
        *(_DWORD *)(v78 - 4) = v40 - 1;
      }
      if ( v40 <= 0 )
        std::string::_Rep::_M_destroy(v28, &v61);
    }
    v69 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v76);
    v68 = dword_80CF674;
    *(int *)((char *)&v68 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v79 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v79);
    if ( byte_80CE64C )
    {
      v20 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v55, *(_DWORD *)(v55 - 12));
      v49 = *(_DWORD *)(v20 + *(_DWORD *)(*(_DWORD *)v20 - 12) + 124);
      if ( !v49 )
      {
        v22 = std::__throw_bad_cast();
        goto LABEL_58;
      }
      if ( *(_BYTE *)(v49 + 28) )
      {
        v29 = *(_BYTE *)(v49 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(v49);
        v29 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v49 + 24))(v49, 10);
      }
      v30 = (std::ostream *)std::ostream::put((std::ostream *)v20, v29);
      std::ostream::flush(v30);
    }
    syslog(3, "%s", v55, v48);
    v31 = v55 - 12;
    if ( (_DWORD *)(v55 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v32 = _InterlockedExchangeAdd((volatile signed __int32 *)(v55 - 4), 0xFFFFFFFF);
      }
      else
      {
        v41 = *(_DWORD *)(v55 - 4);
        *(_DWORD *)(v55 - 4) = v41 - 1;
        v32 = v41;
      }
      if ( v32 <= 0 )
        std::string::_Rep::_M_destroy(v31, &v68);
    }
  }
  v61 = 0;
  v62 = 0;
  v63 = 0;
  v59 = (int)&v64;
  v60 = &v61;
  sub_807BE90((int)&v57, v16, (int)sub_807BAF0, (int)&v59);
  if ( v65 && !v64 )
    event_base_dispatch(v65);
  evdns_base_free(v58, 1);
  if ( v65 )
    event_base_free(v65);
  if ( v66 )
    SSL_CTX_free(v66);
  if ( v67 )
    SSL_CTX_free(v67);
  v19 = v53 - 12;
  if ( (_DWORD *)(v53 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v45 = _InterlockedExchangeAdd((volatile signed __int32 *)v53 - 1, 0xFFFFFFFF);
    }
    else
    {
      v46 = *((_DWORD *)v53 - 1);
      *((_DWORD *)v53 - 1) = v46 - 1;
      v45 = v46;
    }
    if ( v45 <= 0 )
      std::string::_Rep::_M_destroy(v19, &v68);
  }
  v16 = (char *)v61;
  if ( v62 != v61 )
  {
    std::string::assign((std::string *)(a1 + 4), v61);
    v20 = (int)v62;
    v16 = (char *)v61;
    if ( v61 != v62 )
    {
      v21 = (int *)&_pthread_key_create;
      do
      {
        v22 = *(_DWORD *)v16;
        v23 = *(_DWORD *)v16 - 12;
        if ( (_DWORD *)v23 != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( v21 )
          {
            v33 = _InterlockedExchangeAdd((volatile signed __int32 *)(v22 - 4), 0xFFFFFFFF);
          }
          else
          {
LABEL_58:
            v34 = *(_DWORD *)(v22 - 4);
            *(_DWORD *)(v22 - 4) = v34 - 1;
            v33 = v34;
          }
          if ( v33 <= 0 )
            std::string::_Rep::_M_destroy(v23, &v68);
        }
        v16 += 4;
      }
      while ( (char *)v20 != v16 );
      v16 = (char *)v61;
    }
  }
  if ( v16 )
    operator delete(v16);
}
// 804C450: using guessed type int __cdecl evdns_base_new(_DWORD, _DWORD);
// 804C510: using guessed type int __cdecl event_base_free(_DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CEF0: using guessed type int __cdecl _cxa_allocate_exception(_DWORD);
// 804D010: using guessed type int event_base_new(void);
// 804D090: using guessed type int __cdecl evdns_base_set_option(_DWORD, _DWORD, _DWORD);
// 804D0B0: using guessed type int __cdecl _cxa_throw(_DWORD, _DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D400: using guessed type int __cdecl SSL_CTX_free(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80BAADC: using guessed type void *off_80BAADC;
// 80BAB18: using guessed type void *off_80BAB18;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (08074BA0) --------------------------------------------------------
void __cdecl sub_8074BA0(int a1)
{
  unsigned int v1; // esi@4
  void *v2; // ebx@4
  int v3; // eax@5
  int v4; // edx@5
  int v5; // eax@6
  int v6; // edx@6
  int v7; // eax@7
  bool v8; // zf@7
  int v9; // ebx@14
  unsigned int v10; // ebp@15
  int v11; // eax@16
  int v12; // ebx@18
  int v13; // edi@18
  int v14; // edi@18
  int v15; // eax@18
  int v16; // edx@18
  int v17; // ecx@19
  int v18; // edx@21
  int v19; // edx@22
  int v20; // edx@23
  int v21; // eax@25
  std::ostream *v22; // esi@25
  int v23; // eax@25
  int v24; // ebx@25
  char v25; // al@27
  std::ostream *v26; // eax@28
  int v27; // edx@29
  signed __int32 v28; // eax@31
  signed __int32 v29; // eax@43
  signed __int32 v30; // eax@47
  signed __int32 v31; // edi@51
  signed __int32 v32; // eax@55
  signed __int32 v33; // edi@59
  int v34; // ebx@62
  signed __int32 v35; // ecx@65
  signed __int32 v36; // ecx@66
  signed __int32 v37; // ecx@67
  signed __int32 v38; // ecx@68
  int v39; // [sp+Ch] [bp-100h]@0
  int *v40; // [sp+1Ch] [bp-F0h]@17
  char v41; // [sp+2Eh] [bp-DEh]@53
  char v42; // [sp+2Fh] [bp-DDh]@20
  int v43; // [sp+30h] [bp-DCh]@18
  int v44; // [sp+34h] [bp-D8h]@17
  int v45; // [sp+38h] [bp-D4h]@20
  int v46; // [sp+3Ch] [bp-D0h]@17
  int v47; // [sp+40h] [bp-CCh]@18
  int v48; // [sp+44h] [bp-C8h]@18
  int v49; // [sp+48h] [bp-C4h]@18
  int v50; // [sp+4Ch] [bp-C0h]@18
  int v51; // [sp+50h] [bp-BCh]@18
  int v52; // [sp+54h] [bp-B8h]@18
  int v53; // [sp+58h] [bp-B4h]@18
  char v54; // [sp+5Ch] [bp-B0h]@18
  int v55; // [sp+60h] [bp-ACh]@18
  int v56; // [sp+64h] [bp-A8h]@18
  int v57; // [sp+68h] [bp-A4h]@18
  int v58; // [sp+D8h] [bp-34h]@18
  char v59; // [sp+DCh] [bp-30h]@18
  char v60; // [sp+DDh] [bp-2Fh]@18
  int v61; // [sp+E0h] [bp-2Ch]@18
  int v62; // [sp+E4h] [bp-28h]@18
  int v63; // [sp+E8h] [bp-24h]@18
  int v64; // [sp+ECh] [bp-20h]@18

  if ( log_level <= 3 )
  {
    v9 = *(_DWORD *)a1;
    if ( *(_DWORD *)a1 )
    {
      v10 = *(_DWORD *)(v9 + 36);
      if ( (signed int)v10 <= 0 )
      {
        if ( *(_DWORD *)(v9 + 16) == 5 )
          v10 = (unsigned int)memcmp(*(const void **)(v9 + 12), "https", 5u) < 1 ? 443 : 80;
        else
          v10 = 80;
      }
      v11 = *(_DWORD *)(v9 + 32);
      if ( v11 )
      {
        v40 = &v46;
        std::string::string(&v44, *(_DWORD *)(v9 + 28), v11, &v46);
      }
      else
      {
        std::string::string((std::string *)&v44, (const std::string *)&dword_80CF8FC);
        v40 = &v46;
      }
    }
    else
    {
      std::string::string((std::string *)&v44, (const std::string *)&dword_80CF8FC);
      v10 = 80;
      v40 = &v46;
    }
    std::ios_base::ios_base((std::ios_base *)&v57);
    v57 = (int)&unk_80CF5C8;
    v58 = 0;
    v59 = 0;
    v60 = 0;
    v61 = 0;
    v62 = 0;
    v63 = 0;
    v64 = 0;
    v12 = dword_80CF674;
    v46 = dword_80CF674;
    *(int *)((char *)&v46 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)v40 + *(_DWORD *)(v46 - 12), 0);
    v46 = (int)&unk_80CF5DC;
    v57 = (int)&unk_80CF5F0;
    v47 = (int)&unk_80CF7F0;
    v48 = 0;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    v52 = 0;
    v53 = 0;
    std::locale::locale((std::locale *)&v54);
    v47 = (int)&unk_80CF588;
    v55 = 16;
    v56 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v57, &v47);
    v13 = std::__ostream_insert<char,std::char_traits<char>>(v40, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v13, "using default proxy: ", 21);
    v14 = std::__ostream_insert<char,std::char_traits<char>>(v13, v44, *(_DWORD *)(v44 - 12));
    std::__ostream_insert<char,std::char_traits<char>>(v14, ":", 1);
    v15 = std::ostream::operator<<(v14, v10);
    v43 = (int)&unk_80CF83C;
    v16 = *(_DWORD *)(v15 + 24);
    if ( v16 )
    {
      v17 = *(_DWORD *)(v15 + 16);
      LOBYTE(v39) = 0;
      if ( v16 <= (unsigned int)v17 )
      {
        v45 = std::string::_S_construct<char *>(v12, v10, &v42, *(_DWORD *)(v15 + 20), v17, (int)&v42);
        std::string::swap((std::string *)&v43, (std::string *)&v45);
      }
      else
      {
        v45 = std::string::_S_construct<char *>(v12, v10, &v42, *(_DWORD *)(v15 + 20), v16, (int)&v42);
        std::string::swap((std::string *)&v43, (std::string *)&v45);
      }
      v18 = v45 - 12;
      if ( (_DWORD *)(v45 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v31 = _InterlockedExchangeAdd((volatile signed __int32 *)(v45 - 4), 0xFFFFFFFF);
        }
        else
        {
          v31 = *(_DWORD *)(v45 - 4);
          *(_DWORD *)(v45 - 4) = v31 - 1;
        }
        if ( v31 <= 0 )
          std::string::_Rep::_M_destroy(v18, &v41);
      }
    }
    else
    {
      std::string::assign((std::string *)&v43, (const std::string *)(v15 + 40));
    }
    v46 = (int)&unk_80CF5DC;
    v57 = (int)&unk_80CF5F0;
    v47 = (int)&unk_80CF588;
    v19 = v56 - 12;
    if ( (_DWORD *)(v56 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v33 = _InterlockedExchangeAdd((volatile signed __int32 *)(v56 - 4), 0xFFFFFFFF);
      }
      else
      {
        v33 = *(_DWORD *)(v56 - 4);
        *(_DWORD *)(v56 - 4) = v33 - 1;
      }
      if ( v33 <= 0 )
        std::string::_Rep::_M_destroy(v19, &v45);
    }
    v47 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v54);
    v46 = v12;
    *(int *)((char *)&v46 + *(_DWORD *)(v12 - 12)) = dword_80CF678;
    v57 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v57);
    v20 = v44 - 12;
    if ( (_DWORD *)(v44 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v32 = _InterlockedExchangeAdd((volatile signed __int32 *)(v44 - 4), 0xFFFFFFFF);
      }
      else
      {
        v36 = *(_DWORD *)(v44 - 4);
        *(_DWORD *)(v44 - 4) = v36 - 1;
        v32 = v36;
      }
      if ( v32 <= 0 )
        std::string::_Rep::_M_destroy(v20, v40);
    }
    if ( byte_80CE64C )
    {
      v21 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v43, *(_DWORD *)(v43 - 12));
      v22 = (std::ostream *)v21;
      v23 = *(_DWORD *)(*(_DWORD *)v21 - 12);
      v24 = *(_DWORD *)((char *)v22 + v23 + 124);
      if ( !v24 )
      {
        v34 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v43 - 12, v40);
        Unwind_Resume(v34);
      }
      if ( *(_BYTE *)(v24 + 28) )
      {
        v25 = *(_BYTE *)(v24 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v22 + v23 + 124));
        v25 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v24 + 24))(v24, 10);
      }
      v26 = (std::ostream *)std::ostream::put(v22, v25);
      std::ostream::flush(v26);
    }
    syslog(5, "%s", v43, v39);
    v27 = v43 - 12;
    if ( (_DWORD *)(v43 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v28 = _InterlockedExchangeAdd((volatile signed __int32 *)(v43 - 4), 0xFFFFFFFF);
      }
      else
      {
        v38 = *(_DWORD *)(v43 - 4);
        *(_DWORD *)(v43 - 4) = v38 - 1;
        v28 = v38;
      }
      if ( v28 <= 0 )
        std::string::_Rep::_M_destroy(v27, v40);
    }
  }
  if ( *(_DWORD *)a1 && *(_DWORD *)(*(_DWORD *)(*(_DWORD *)a1 + 8) - 12) )
  {
    v1 = operator new(0xCu);
    sub_8074000(v1, a1);
    v2 = dword_80CF8E0;
    dword_80CF8E0 = (void *)v1;
    if ( !v2 )
      return;
  }
  else
  {
    v2 = dword_80CF8E0;
    dword_80CF8E0 = 0;
    if ( !v2 )
      return;
  }
  v3 = *((_DWORD *)v2 + 2);
  v4 = v3 - 12;
  if ( (_DWORD *)(v3 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v29 = _InterlockedExchangeAdd((volatile signed __int32 *)(v3 - 4), 0xFFFFFFFF);
    }
    else
    {
      v37 = *(_DWORD *)(v3 - 4);
      *(_DWORD *)(v3 - 4) = v37 - 1;
      v29 = v37;
    }
    if ( v29 <= 0 )
      std::string::_Rep::_M_destroy(v4, &v46);
  }
  v5 = *((_DWORD *)v2 + 1);
  v6 = v5 - 12;
  if ( (_DWORD *)(v5 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v30 = _InterlockedExchangeAdd((volatile signed __int32 *)(v5 - 4), 0xFFFFFFFF);
    }
    else
    {
      v35 = *(_DWORD *)(v5 - 4);
      *(_DWORD *)(v5 - 4) = v35 - 1;
      v30 = v35;
    }
    if ( v30 <= 0 )
      std::string::_Rep::_M_destroy(v6, &v46);
  }
  v7 = *(_DWORD *)v2;
  v8 = *(_DWORD *)v2 == 0;
  if ( *(_DWORD *)v2 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v7 + 4));
    if ( v8 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v7 + 4))(v7);
  }
  operator delete(v2);
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (08075330) --------------------------------------------------------
int __cdecl sub_8075330(int a1)
{
  unsigned int v1; // ebp@0
  int v2; // ebx@1
  int v3; // eax@1
  int v4; // esi@3
  int v5; // edi@4
  int v6; // eax@5
  int v7; // edx@6
  signed int v8; // eax@7
  int v9; // eax@8
  int v10; // eax@14
  int v11; // eax@17
  int v12; // eax@18
  int v13; // edx@19
  char *v14; // edi@20
  int v15; // eax@20
  int v16; // edx@20
  int v17; // edx@21
  int v18; // eax@22
  int v19; // esi@24
  int v20; // eax@24
  int v21; // eax@26
  int v22; // eax@28
  int v23; // edx@29
  int result; // eax@30
  int v25; // ecx@30
  std::ios_base *v26; // esi@33
  int v27; // ebx@33
  int v28; // eax@33
  int v29; // edx@34
  int v30; // eax@36
  int v31; // edx@36
  int v32; // edx@37
  int v33; // eax@39
  int v34; // eax@39
  int v35; // ebx@39
  char v36; // al@41
  std::ostream *v37; // eax@42
  int v38; // edx@44
  int v39; // eax@49
  char *v40; // eax@50
  int v41; // esi@51
  int v42; // esi@52
  signed int v43; // edx@54
  int v44; // eax@55
  char *v45; // edi@56
  signed int v46; // edx@56
  int v47; // edx@57
  int v48; // ebx@60
  int v49; // edi@60
  int v50; // eax@60
  int v51; // edx@61
  int v52; // edx@64
  int v53; // eax@66
  std::ostream *v54; // esi@66
  int v55; // eax@66
  int v56; // ebx@66
  char v57; // al@68
  std::ostream *v58; // eax@69
  int v59; // edx@70
  signed __int32 v60; // eax@72
  char v61; // dl@77
  int v62; // esi@78
  int v63; // edx@79
  int v64; // eax@80
  int v65; // eax@83
  signed int v66; // eax@85
  int v67; // ebx@97
  int v68; // eax@97
  int v69; // edx@98
  int v70; // edx@101
  int v71; // eax@103
  std::ostream *v72; // esi@103
  int v73; // eax@103
  int v74; // ebx@103
  char v75; // al@105
  std::ostream *v76; // eax@106
  int v77; // eax@108
  int v78; // edx@109
  signed int v79; // eax@110
  std::ios_base *v80; // esi@113
  int v81; // ebx@113
  int v82; // eax@113
  int v83; // edx@114
  int v84; // eax@117
  int v85; // edx@117
  int v86; // eax@119
  int v87; // eax@119
  int v88; // ebx@119
  char v89; // al@121
  std::ostream *v90; // eax@122
  int v91; // ebx@125
  int v92; // eax@125
  int v93; // edx@126
  int v94; // edx@128
  int v95; // edx@129
  int v96; // eax@131
  std::ostream *v97; // esi@131
  int v98; // eax@131
  int v99; // ebx@131
  char v100; // al@133
  std::ostream *v101; // eax@134
  int v102; // ebx@139
  int v103; // eax@139
  int v104; // edx@140
  int v105; // edx@142
  int v106; // edx@143
  int v107; // eax@145
  std::ostream *v108; // esi@145
  int v109; // eax@145
  int v110; // ebx@145
  char v111; // al@147
  std::ostream *v112; // eax@148
  int v113; // ebx@158
  int v114; // ebx@160
  int v115; // eax@160
  int v116; // edx@161
  int v117; // edx@163
  int v118; // edx@164
  int v119; // eax@166
  std::ostream *v120; // esi@166
  int v121; // eax@166
  int v122; // ebx@166
  char v123; // al@168
  std::ostream *v124; // eax@169
  int v125; // eax@181
  int v126; // esi@181
  int v127; // edi@181
  int v128; // edi@183
  int v129; // esi@184
  int v130; // eax@186
  int v131; // eax@194
  int v132; // eax@194
  int v133; // eax@203
  int v134; // edx@204
  std::ostream *v135; // esi@208
  char v136; // al@210
  std::ostream *v137; // eax@211
  int v138; // edx@212
  signed __int32 v139; // eax@224
  signed __int32 v140; // ecx@228
  signed __int32 v141; // ebx@232
  signed __int32 v142; // ecx@236
  signed __int32 v143; // ecx@240
  signed __int32 v144; // edx@244
  int v145; // ST2C_4@246
  signed __int32 v146; // ecx@248
  int v147; // eax@253
  int v148; // ebx@254
  signed __int32 v149; // ecx@257
  signed __int32 v150; // ecx@261
  int v151; // ebx@290
  signed __int32 v152; // ecx@268
  signed __int32 v153; // ecx@274
  signed __int32 v154; // ebx@279
  signed __int32 v155; // ecx@285
  signed __int32 v156; // ecx@289
  signed __int32 v157; // ecx@292
  signed __int32 v158; // eax@297
  signed __int32 v159; // ecx@300
  signed __int32 v160; // ecx@302
  signed __int32 v161; // ecx@305
  signed __int32 v162; // ecx@308
  signed __int32 v163; // ebx@314
  signed __int32 v164; // ebx@322
  signed __int32 v165; // ecx@328
  signed __int32 v166; // ebx@334
  int v167; // [sp+Ch] [bp-10FCh]@0
  int v168; // [sp+Ch] [bp-10FCh]@8
  int v169; // [sp+Ch] [bp-10FCh]@30
  int v170; // [sp+Ch] [bp-10FCh]@58
  int v171; // [sp+Ch] [bp-10FCh]@80
  int v172; // [sp+Ch] [bp-10FCh]@158
  int v173; // [sp+1Ch] [bp-10ECh]@181
  int *v174; // [sp+20h] [bp-10E8h]@0
  std::string *v175; // [sp+24h] [bp-10E4h]@25
  std::string *v176; // [sp+24h] [bp-10E4h]@184
  std::string *v177; // [sp+24h] [bp-10E4h]@203
  std::string *v178; // [sp+24h] [bp-10E4h]@206
  std::string *v179; // [sp+24h] [bp-10E4h]@208
  std::string *v180; // [sp+28h] [bp-10E0h]@77
  int v181; // [sp+2Ch] [bp-10DCh]@1
  std::locale *v182; // [sp+2Ch] [bp-10DCh]@55
  char v183; // [sp+32h] [bp-10D6h]@63
  char v184; // [sp+33h] [bp-10D5h]@62
  int v185; // [sp+34h] [bp-10D4h]@35
  int v186; // [sp+38h] [bp-10D0h]@20
  int v187; // [sp+3Ch] [bp-10CCh]@20
  int v188; // [sp+40h] [bp-10C8h]@60
  int v189; // [sp+44h] [bp-10C4h]@60
  int v190; // [sp+48h] [bp-10C0h]@60
  int v191; // [sp+4Ch] [bp-10BCh]@60
  int v192; // [sp+50h] [bp-10B8h]@60
  int v193; // [sp+54h] [bp-10B4h]@60
  int v194; // [sp+58h] [bp-10B0h]@60
  char v195; // [sp+5Ch] [bp-10ACh]@60
  int v196; // [sp+60h] [bp-10A8h]@60
  int v197; // [sp+64h] [bp-10A4h]@60
  int v198; // [sp+68h] [bp-10A0h]@60
  int v199; // [sp+D8h] [bp-1030h]@60
  char v200; // [sp+DCh] [bp-102Ch]@60
  char v201; // [sp+DDh] [bp-102Bh]@60
  int v202; // [sp+E0h] [bp-1028h]@60
  int v203; // [sp+E4h] [bp-1024h]@60
  int v204; // [sp+E8h] [bp-1020h]@60
  int v205; // [sp+ECh] [bp-101Ch]@60
  char s[4]; // [sp+F0h] [bp-1018h]@20
  int v207; // [sp+F4h] [bp-1014h]@33
  int v208; // [sp+F8h] [bp-1010h]@33
  int v209; // [sp+FCh] [bp-100Ch]@33
  int v210; // [sp+100h] [bp-1008h]@33
  int v211; // [sp+104h] [bp-1004h]@33
  int v212; // [sp+108h] [bp-1000h]@33
  int v213; // [sp+10Ch] [bp-FFCh]@33
  char v214; // [sp+110h] [bp-FF8h]@33
  int v215; // [sp+114h] [bp-FF4h]@33
  int v216; // [sp+118h] [bp-FF0h]@33
  int v217; // [sp+11Ch] [bp-FECh]@33
  int v218; // [sp+18Ch] [bp-F7Ch]@33
  char v219; // [sp+190h] [bp-F78h]@33
  char v220; // [sp+191h] [bp-F77h]@33
  int v221; // [sp+194h] [bp-F74h]@33
  int v222; // [sp+198h] [bp-F70h]@33
  int v223; // [sp+19Ch] [bp-F6Ch]@33
  int v224; // [sp+1A0h] [bp-F68h]@33

  v2 = a1;
  v181 = a1 + 4;
  v3 = *(_DWORD *)(a1 + 4);
  if ( !v3 || *(_DWORD *)(v3 + 16) != 5 || memcmp(*(const void **)(v3 + 12), "https", 5u) || *(_DWORD *)(a1 + 108) )
  {
    v4 = bufferevent_socket_new(*(_DWORD *)(*(_DWORD *)(a1 + 88) + 4), -1, 5);
    if ( !v4 )
    {
      if ( log_level > 5 )
        goto LABEL_45;
      v14 = s;
      std::ios_base::ios_base((std::ios_base *)&v217);
      v217 = (int)&unk_80CF5C8;
      v218 = 0;
      v219 = 0;
      v220 = 0;
      v221 = 0;
      v222 = 0;
      v223 = 0;
      v224 = 0;
      *(_DWORD *)s = dword_80CF674;
      *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init(&s[*(_DWORD *)(*(_DWORD *)s - 12)], 0);
      *(_DWORD *)s = &unk_80CF5DC;
      v217 = (int)&unk_80CF5F0;
      v207 = (int)&unk_80CF7F0;
      v208 = 0;
      v209 = 0;
      v210 = 0;
      v211 = 0;
      v212 = 0;
      v213 = 0;
      std::locale::locale((std::locale *)&v214);
      v207 = (int)&unk_80CF588;
      v215 = 16;
      v216 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v217, &v207);
      v102 = std::__ostream_insert<char,std::char_traits<char>>(
               s,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v102, "VERIFY failed (", 15);
      std::__ostream_insert<char,std::char_traits<char>>(v102, "bev", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v102, "): ", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v102, "bufferevent_socket_new failed", 29);
      v186 = (int)&unk_80CF83C;
      v103 = *(_DWORD *)(v102 + 24);
      if ( v103 )
      {
        v104 = *(_DWORD *)(v102 + 16);
        LOBYTE(v167) = 0;
        if ( v103 > (unsigned int)v104 )
        {
          v187 = std::string::_S_construct<char *>(v102, v1, s, *(_DWORD *)(v102 + 20), v103, (int)&v185);
          std::string::swap((std::string *)&v186, (std::string *)&v187);
        }
        else
        {
          v187 = std::string::_S_construct<char *>(v102, v1, s, *(_DWORD *)(v102 + 20), v104, (int)&v185);
          std::string::swap((std::string *)&v186, (std::string *)&v187);
        }
        v105 = v187 - 12;
        if ( (_DWORD *)(v187 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v162 = _InterlockedExchangeAdd((volatile signed __int32 *)(v187 - 4), 0xFFFFFFFF);
          }
          else
          {
            v162 = *(_DWORD *)(v187 - 4);
            *(_DWORD *)(v187 - 4) = v162 - 1;
          }
          if ( v162 <= 0 )
            std::string::_Rep::_M_destroy(v105, &v184);
        }
      }
      else
      {
        std::string::assign((std::string *)&v186, (const std::string *)(v102 + 40));
      }
      *(_DWORD *)s = &unk_80CF5DC;
      v217 = (int)&unk_80CF5F0;
      v207 = (int)&unk_80CF588;
      v106 = v216 - 12;
      if ( (_DWORD *)(v216 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v152 = _InterlockedExchangeAdd((volatile signed __int32 *)(v216 - 4), 0xFFFFFFFF);
        }
        else
        {
          v152 = *(_DWORD *)(v216 - 4);
          *(_DWORD *)(v216 - 4) = v152 - 1;
        }
        if ( v152 <= 0 )
          std::string::_Rep::_M_destroy(v106, &v187);
      }
      v207 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v214);
      *(_DWORD *)s = dword_80CF674;
      *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
      v217 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v217);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, s);
      if ( byte_80CE64C )
      {
        v107 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v186, *(_DWORD *)(v186 - 12));
        v108 = (std::ostream *)v107;
        v109 = *(_DWORD *)(*(_DWORD *)v107 - 12);
        v110 = *(_DWORD *)((char *)v108 + v109 + 124);
        if ( !v110 )
        {
          v147 = std::__throw_bad_cast();
          goto LABEL_254;
        }
        if ( *(_BYTE *)(v110 + 28) )
        {
          v111 = *(_BYTE *)(v110 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v108 + v109 + 124));
          v111 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v110 + 24))(v110, 10);
        }
        v112 = (std::ostream *)std::ostream::put(v108, v111);
        std::ostream::flush(v112);
      }
      syslog(3, "%s", v186, v167);
      goto LABEL_136;
    }
    goto LABEL_4;
  }
  v61 = *(_BYTE *)(a1 + 16);
  v180 = *(std::string **)(a1 + 88);
  if ( v61 )
  {
    v62 = *((_DWORD *)v180 + 3);
    if ( !v62 )
    {
      v125 = SSLv23_method();
      v126 = SSL_CTX_new(v125);
      *((_DWORD *)v180 + 3) = v126;
      v127 = BIO_new_mem_buf(&unk_80CE6C0, dword_80CE6A0);
      v173 = v127;
      if ( v127 )
      {
        v174 = (int *)SSL_CTX_get_cert_store(v126);
        if ( v174 && (v128 = PEM_X509_INFO_read_bio(v127, 0, 0, 0)) != 0 )
        {
          v129 = 0;
          v176 = 0;
          while ( v129 < sk_num(v128) )
          {
            v130 = *(_DWORD *)sk_value(v128, v129);
            if ( v130 )
            {
              X509_STORE_add_cert(v174, v130);
              v176 = (std::string *)1;
            }
            ++v129;
          }
          v2 = a1;
          sk_pop_free(v128, (const char *)&X509_INFO_free);
          BIO_free(v173);
          if ( v176 == (std::string *)1 )
          {
            SSL_CTX_set_verify(*((_DWORD *)v180 + 3), 1, 0);
            v61 = *(_BYTE *)(a1 + 16);
            v62 = *((_DWORD *)v180 + 3);
            v14 = s;
LABEL_92:
            if ( v61 )
              SSL_CTX_set_cert_verify_callback(v62, sub_8073FC0, v2);
            goto LABEL_79;
          }
        }
        else
        {
          BIO_free(v173);
        }
      }
      if ( log_level <= 5 )
      {
        v14 = s;
        std::ios_base::ios_base((std::ios_base *)&v217);
        v217 = (int)&unk_80CF5C8;
        v218 = 0;
        v219 = 0;
        v220 = 0;
        v221 = 0;
        v222 = 0;
        v223 = 0;
        v224 = 0;
        *(_DWORD *)s = dword_80CF674;
        *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
        std::basic_ios<char,std::char_traits<char>>::init(&s[*(_DWORD *)(*(_DWORD *)s - 12)], 0);
        *(_DWORD *)s = &unk_80CF5DC;
        v217 = (int)&unk_80CF5F0;
        v207 = (int)&unk_80CF7F0;
        v208 = 0;
        v209 = 0;
        v210 = 0;
        v211 = 0;
        v212 = 0;
        v213 = 0;
        std::locale::locale((std::locale *)&v214);
        v207 = (int)&unk_80CF588;
        v215 = 16;
        v216 = (int)&unk_80CF83C;
        std::basic_ios<char,std::char_traits<char>>::init(&v217, &v207);
        v177 = (std::string *)std::__ostream_insert<char,std::char_traits<char>>(
                                s,
                                &unk_80CF83C,
                                std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v177, "_ssl_ctx_load_trusted() has failed", 34);
        v186 = (int)&unk_80CF83C;
        v133 = *((_DWORD *)v177 + 6);
        if ( v133 )
        {
          v134 = *((_DWORD *)v177 + 4);
          LOBYTE(v167) = 0;
          if ( v133 <= (unsigned int)v134 )
          {
            v174 = &v185;
            v187 = std::string::_S_construct<char *>(v2, v1, s, *((_DWORD *)v177 + 5), v134, (int)&v185);
            std::string::swap((std::string *)&v186, (std::string *)&v187);
          }
          else
          {
            v174 = &v185;
            v187 = std::string::_S_construct<char *>(v2, v1, s, *((_DWORD *)v177 + 5), v133, (int)&v185);
            std::string::swap((std::string *)&v186, (std::string *)&v187);
          }
          v178 = (std::string *)(v187 - 12);
          if ( (_DWORD *)(v187 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v153 = _InterlockedExchangeAdd((volatile signed __int32 *)(v187 - 4), 0xFFFFFFFF);
            }
            else
            {
              v153 = *(_DWORD *)(v187 - 4);
              *(_DWORD *)(v187 - 4) = v153 - 1;
            }
            if ( v153 <= 0 )
              std::string::_Rep::_M_destroy(v178, &v184);
          }
        }
        else
        {
          v174 = &v185;
          std::string::assign((std::string *)&v186, (std::string *)((char *)v177 + 40));
        }
        *(_DWORD *)s = &unk_80CF5DC;
        v217 = (int)&unk_80CF5F0;
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf((int)&v207);
        *(_DWORD *)s = dword_80CF674;
        *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
        v217 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v217);
        if ( byte_80CE64C )
        {
          v135 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(
                                   &std::cout,
                                   v186,
                                   *(_DWORD *)(v186 - 12));
          v179 = *(std::string **)((char *)v135 + *(_DWORD *)(*(_DWORD *)v135 - 12) + 124);
          if ( !v179 )
          {
            v147 = std::__throw_bad_cast();
            goto LABEL_254;
          }
          if ( *((_BYTE *)v179 + 28) )
          {
            v136 = *((_BYTE *)v179 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(v179);
            v136 = (*(int (__cdecl **)(std::string *, signed int))(*(_DWORD *)v179 + 24))(v179, 10);
          }
          v137 = (std::ostream *)std::ostream::put(v135, v136);
          std::ostream::flush(v137);
        }
        syslog(3, "%s", v186, v167);
        v138 = v186 - 12;
        if ( (_DWORD *)(v186 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v160 = _InterlockedExchangeAdd((volatile signed __int32 *)(v186 - 4), 0xFFFFFFFF);
          }
          else
          {
            v160 = *(_DWORD *)(v186 - 4);
            *(_DWORD *)(v186 - 4) = v160 - 1;
          }
          if ( v160 <= 0 )
            std::string::_Rep::_M_destroy(v138, s);
        }
        v61 = *(_BYTE *)(v2 + 16);
        v62 = *((_DWORD *)v180 + 3);
      }
      else
      {
        v61 = *(_BYTE *)(v2 + 16);
        v62 = *((_DWORD *)v180 + 3);
        v14 = s;
      }
      goto LABEL_92;
    }
LABEL_91:
    v14 = s;
    goto LABEL_92;
  }
  v62 = *((_DWORD *)v180 + 2);
  v14 = s;
  if ( !v62 )
  {
    v131 = SSLv23_method();
    v132 = SSL_CTX_new(v131);
    *((_DWORD *)v180 + 2) = v132;
    v61 = *(_BYTE *)(a1 + 16);
    v62 = v132;
    goto LABEL_91;
  }
LABEL_79:
  *(_DWORD *)(v2 + 92) = SSL_new(v62);
  sub_808AF20((int)v14, v181);
  SSL_ctrl(*(_DWORD *)(v2 + 92), 55, 0, *(_DWORD *)s);
  v63 = *(_DWORD *)s - 12;
  if ( (_DWORD *)(*(_DWORD *)s - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v140 = _InterlockedExchangeAdd((volatile signed __int32 *)(*(_DWORD *)s - 4), 0xFFFFFFFF);
    }
    else
    {
      v140 = *(_DWORD *)(*(_DWORD *)s - 4);
      *(_DWORD *)(*(_DWORD *)s - 4) = v140 - 1;
    }
    if ( v140 <= 0 )
      std::string::_Rep::_M_destroy(v63, &v187);
  }
  v64 = bufferevent_openssl_socket_new(*(_DWORD *)(*(_DWORD *)(v2 + 88) + 4), -1, *(_DWORD *)(v2 + 92), 1, 4);
  v4 = v64;
  if ( !v64 )
  {
    if ( log_level > 5 )
      goto LABEL_45;
    std::ios_base::ios_base((std::ios_base *)&v217);
    v217 = (int)&unk_80CF5C8;
    v218 = 0;
    v219 = 0;
    v220 = 0;
    v221 = 0;
    v222 = 0;
    v223 = 0;
    v224 = 0;
    *(_DWORD *)s = dword_80CF674;
    *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init(&v14[*(_DWORD *)(*(_DWORD *)s - 12)], 0);
    *(_DWORD *)s = &unk_80CF5DC;
    v217 = (int)&unk_80CF5F0;
    v207 = (int)&unk_80CF7F0;
    v208 = 0;
    v209 = 0;
    v210 = 0;
    v211 = 0;
    v212 = 0;
    v213 = 0;
    std::locale::locale((std::locale *)&v214);
    v207 = (int)&unk_80CF588;
    v215 = 16;
    v216 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v217, &v207);
    v67 = std::__ostream_insert<char,std::char_traits<char>>(v14, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v67, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v67, "bev", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v67, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v67, "bufferevent_openssl_socket_new failed", 37);
    v186 = (int)&unk_80CF83C;
    v68 = *(_DWORD *)(v67 + 24);
    if ( v68 )
    {
      v69 = *(_DWORD *)(v67 + 16);
      LOBYTE(v171) = 0;
      if ( v68 <= (unsigned int)v69 )
      {
        v187 = std::string::_S_construct<char *>(v67, v1, v14, *(_DWORD *)(v67 + 20), v69, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      else
      {
        v187 = std::string::_S_construct<char *>(v67, v1, v14, *(_DWORD *)(v67 + 20), v68, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      std::string::_Rep::_M_dispose(v187 - 12, &v184);
    }
    else
    {
      std::string::assign((std::string *)&v186, (const std::string *)(v67 + 40));
    }
    *(_DWORD *)s = &unk_80CF5DC;
    v217 = (int)&unk_80CF5F0;
    v207 = (int)&unk_80CF588;
    v70 = v216 - 12;
    if ( (_DWORD *)(v216 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v142 = _InterlockedExchangeAdd((volatile signed __int32 *)(v216 - 4), 0xFFFFFFFF);
      }
      else
      {
        v142 = *(_DWORD *)(v216 - 4);
        *(_DWORD *)(v216 - 4) = v142 - 1;
      }
      if ( v142 <= 0 )
        std::string::_Rep::_M_destroy(v70, &v187);
    }
    v207 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v214);
    *(_DWORD *)s = dword_80CF674;
    *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    v217 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v217);
    if ( byte_80CE64C )
    {
      v71 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v186, *(_DWORD *)(v186 - 12));
      v72 = (std::ostream *)v71;
      v73 = *(_DWORD *)(*(_DWORD *)v71 - 12);
      v74 = *(_DWORD *)((char *)v72 + v73 + 124);
      if ( !v74 )
      {
        v147 = std::__throw_bad_cast();
        goto LABEL_254;
      }
      if ( *(_BYTE *)(v74 + 28) )
      {
        v75 = *(_BYTE *)(v74 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v72 + v73 + 124));
        v75 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v74 + 24))(v74, 10);
      }
      v76 = (std::ostream *)std::ostream::put(v72, v75);
      std::ostream::flush(v76);
    }
    syslog(3, "%s", v186, v171);
LABEL_44:
    v38 = v186 - 12;
    if ( (_DWORD *)(v186 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v139 = _InterlockedExchangeAdd((volatile signed __int32 *)(v186 - 4), 0xFFFFFFFF);
      }
      else
      {
        v161 = *(_DWORD *)(v186 - 4);
        *(_DWORD *)(v186 - 4) = v161 - 1;
        v139 = v161;
      }
      if ( v139 <= 0 )
        std::string::_Rep::_M_destroy(v38, v14);
    }
    goto LABEL_45;
  }
  bufferevent_openssl_set_allow_dirty_shutdown(v64, 1);
LABEL_4:
  bufferevent_setwatermark(v4, 2, 0, 1024);
  v5 = *(_DWORD *)(v2 + 108);
  if ( v5 )
  {
    v6 = *(_DWORD *)v5;
    if ( *(_DWORD *)v5 )
    {
      v7 = *(_DWORD *)(v6 + 36);
      if ( v7 > 0 )
      {
        v8 = (unsigned __int16)v7;
LABEL_8:
        v9 = evhttp_connection_base_bufferevent_new(
               *(_DWORD *)(*(_DWORD *)(v2 + 88) + 4),
               0,
               v4,
               *(_DWORD *)(v5 + 4),
               v8);
        goto LABEL_9;
      }
      if ( *(_DWORD *)(v6 + 16) == 5 )
      {
        v8 = (unsigned int)memcmp(*(const void **)(v6 + 12), "https", 5u) < 1 ? 443 : 80;
        goto LABEL_8;
      }
    }
    v8 = 80;
    goto LABEL_8;
  }
  v77 = *(_DWORD *)(v2 + 4);
  if ( !v77 )
  {
LABEL_171:
    v79 = 80;
    goto LABEL_111;
  }
  v78 = *(_DWORD *)(v77 + 36);
  if ( v78 <= 0 )
  {
    if ( *(_DWORD *)(v77 + 16) == 5 )
    {
      v79 = (unsigned int)memcmp(*(const void **)(v77 + 12), "https", 5u) < 1 ? 443 : 80;
      goto LABEL_111;
    }
    goto LABEL_171;
  }
  v79 = (unsigned __int16)v78;
LABEL_111:
  v9 = evhttp_connection_base_bufferevent_new(*(_DWORD *)(*(_DWORD *)(v2 + 88) + 4), 0, v4, *(_DWORD *)(v2 + 12), v79);
LABEL_9:
  *(_DWORD *)(v2 + 96) = v9;
  if ( !v9 )
  {
    if ( log_level > 5 )
      goto LABEL_45;
    v14 = s;
    v80 = (std::ios_base *)&v217;
    std::ios_base::ios_base((std::ios_base *)&v217);
    v217 = (int)&unk_80CF5C8;
    v218 = 0;
    v219 = 0;
    v220 = 0;
    v221 = 0;
    v222 = 0;
    v223 = 0;
    v224 = 0;
    *(_DWORD *)s = dword_80CF674;
    *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init(&s[*(_DWORD *)(*(_DWORD *)s - 12)], 0);
    *(_DWORD *)s = &unk_80CF5DC;
    v217 = (int)&unk_80CF5F0;
    v207 = (int)&unk_80CF7F0;
    v208 = 0;
    v209 = 0;
    v210 = 0;
    v211 = 0;
    v212 = 0;
    v213 = 0;
    std::locale::locale((std::locale *)&v214);
    v207 = (int)&unk_80CF588;
    v215 = 16;
    v216 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v217, &v207);
    v81 = std::__ostream_insert<char,std::char_traits<char>>(s, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v81, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v81, "_connection", 11);
    std::__ostream_insert<char,std::char_traits<char>>(v81, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v81, "evhttp_connection_base_new failed", 33);
    v186 = (int)&unk_80CF83C;
    v82 = *(_DWORD *)(v81 + 24);
    if ( v82 )
    {
      v83 = *(_DWORD *)(v81 + 16);
      LOBYTE(v168) = 0;
      if ( v82 <= (unsigned int)v83 )
      {
        v187 = std::string::_S_construct<char *>(v81, v1, s, *(_DWORD *)(v81 + 20), v83, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      else
      {
        v187 = std::string::_S_construct<char *>(v81, v1, s, *(_DWORD *)(v81 + 20), v82, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      std::string::_Rep::_M_dispose(v187 - 12, &v184);
    }
    else
    {
      std::string::assign((std::string *)&v186, (const std::string *)(v81 + 40));
    }
    *(_DWORD *)s = &unk_80CF5DC;
    v217 = (int)&unk_80CF5F0;
    v207 = (int)&unk_80CF588;
    v84 = v216;
    v85 = v216 - 12;
    if ( (_DWORD *)(v216 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_284;
    while ( 1 )
    {
      v207 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v214);
      *(_DWORD *)s = dword_80CF674;
      *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
      v217 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base(v80);
      if ( !byte_80CE64C )
        goto LABEL_123;
      v86 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v186, *(_DWORD *)(v186 - 12));
      v80 = (std::ios_base *)v86;
      v87 = *(_DWORD *)(*(_DWORD *)v86 - 12);
      v88 = *(_DWORD *)((char *)v80 + v87 + 124);
      if ( v88 )
        break;
      v84 = std::__throw_bad_cast();
LABEL_284:
      if ( &_pthread_key_create )
      {
        v155 = _InterlockedExchangeAdd((volatile signed __int32 *)(v84 - 4), 0xFFFFFFFF);
      }
      else
      {
        v155 = *(_DWORD *)(v84 - 4);
        *(_DWORD *)(v84 - 4) = v155 - 1;
      }
      if ( v155 <= 0 )
        std::string::_Rep::_M_destroy(v85, &v187);
    }
    if ( *(_BYTE *)(v88 + 28) )
    {
      v89 = *(_BYTE *)(v88 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v80 + v87 + 124));
      v89 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v88 + 24))(v88, 10);
    }
    v90 = (std::ostream *)std::ostream::put(v80, v89);
    std::ostream::flush(v90);
LABEL_123:
    syslog(3, "%s", v186, v168);
    goto LABEL_44;
  }
  if ( *(_DWORD *)(v2 + 28) > 0 )
    evhttp_connection_set_timeout(v9, *(_DWORD *)(v2 + 28));
  if ( *(_BYTE *)(v2 + 36) )
    evhttp_connection_set_reset_on_close(*(_DWORD *)(v2 + 96), 1);
  if ( !*(_DWORD *)(v2 + 108) )
  {
    *(_DWORD *)(v2 + 100) = do_http_create_request(v2);
    v14 = s;
    sub_808AAB0((std::string *)s, v181);
    v113 = evhttp_make_request(*(_DWORD *)(v2 + 96), *(_DWORD *)(v2 + 100), *(_DWORD *)(v2 + 8), *(_DWORD *)s);
    result = std::string::_Rep::_M_dispose(*(_DWORD *)s - 12, &v187);
    if ( !v113 )
      return result;
    if ( log_level > 5 )
      goto LABEL_45;
    std::ios_base::ios_base((std::ios_base *)&v217);
    v217 = (int)&unk_80CF5C8;
    v218 = 0;
    v219 = 0;
    v220 = 0;
    v221 = 0;
    v222 = 0;
    v223 = 0;
    v224 = 0;
    *(_DWORD *)s = dword_80CF674;
    *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init(&s[*(_DWORD *)(*(_DWORD *)s - 12)], 0);
    *(_DWORD *)s = &unk_80CF5DC;
    v217 = (int)&unk_80CF5F0;
    v207 = (int)&unk_80CF7F0;
    v208 = 0;
    v209 = 0;
    v210 = 0;
    v211 = 0;
    v212 = 0;
    v213 = 0;
    std::locale::locale((std::locale *)&v214);
    v207 = (int)&unk_80CF588;
    v215 = 16;
    v216 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v217, &v207);
    v114 = std::__ostream_insert<char,std::char_traits<char>>(s, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v114, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v114, "req_res == 0", 12);
    std::__ostream_insert<char,std::char_traits<char>>(v114, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v114, "evhttp_make_request failed", 26);
    v186 = (int)&unk_80CF83C;
    v115 = *(_DWORD *)(v114 + 24);
    if ( v115 )
    {
      v116 = *(_DWORD *)(v114 + 16);
      LOBYTE(v172) = 0;
      if ( v115 <= (unsigned int)v116 )
      {
        v187 = std::string::_S_construct<char *>(v114, v1, s, *(_DWORD *)(v114 + 20), v116, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      else
      {
        v187 = std::string::_S_construct<char *>(v114, v1, s, *(_DWORD *)(v114 + 20), v115, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      v117 = v187 - 12;
      if ( (_DWORD *)(v187 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v163 = _InterlockedExchangeAdd((volatile signed __int32 *)(v187 - 4), 0xFFFFFFFF);
        }
        else
        {
          v163 = *(_DWORD *)(v187 - 4);
          *(_DWORD *)(v187 - 4) = v163 - 1;
        }
        if ( v163 <= 0 )
          std::string::_Rep::_M_destroy(v117, &v184);
      }
    }
    else
    {
      std::string::assign((std::string *)&v186, (const std::string *)(v114 + 40));
    }
    *(_DWORD *)s = &unk_80CF5DC;
    v217 = (int)&unk_80CF5F0;
    v207 = (int)&unk_80CF588;
    v118 = v216 - 12;
    if ( (_DWORD *)(v216 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v154 = _InterlockedExchangeAdd((volatile signed __int32 *)(v216 - 4), 0xFFFFFFFF);
      }
      else
      {
        v154 = *(_DWORD *)(v216 - 4);
        *(_DWORD *)(v216 - 4) = v154 - 1;
      }
      if ( v154 <= 0 )
        std::string::_Rep::_M_destroy(v118, &v187);
    }
    v207 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v214);
    *(_DWORD *)s = dword_80CF674;
    *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    v217 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v217);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, s);
    if ( byte_80CE64C )
    {
      v119 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v186, *(_DWORD *)(v186 - 12));
      v120 = (std::ostream *)v119;
      v121 = *(_DWORD *)(*(_DWORD *)v119 - 12);
      v122 = *(_DWORD *)((char *)v120 + v121 + 124);
      if ( !v122 )
      {
        v147 = std::__throw_bad_cast();
        goto LABEL_254;
      }
      if ( *(_BYTE *)(v122 + 28) )
      {
        v123 = *(_BYTE *)(v122 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v120 + v121 + 124));
        v123 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v122 + 24))(v122, 10);
      }
      v124 = (std::ostream *)std::ostream::put(v120, v123);
      std::ostream::flush(v124);
    }
    syslog(3, "%s", v186, v172);
    goto LABEL_136;
  }
  v10 = *(_DWORD *)(v2 + 4);
  if ( v10 && *(_DWORD *)(v10 + 16) == 5 && !memcmp(*(const void **)(v10 + 12), "https", 5u)
    || *(_DWORD *)(*(_DWORD *)(v2 + 12) - 12) )
  {
    v39 = evhttp_request_new(sub_8079EC0, v2);
    *(_DWORD *)(v2 + 112) = v39;
    if ( v39 )
    {
      evhttp_request_set_error_cb(v39, sub_8072DC0);
      evhttp_add_header(*(_DWORD *)(*(_DWORD *)(v2 + 112) + 20), "Connection", "keep-alive");
      evhttp_add_header(*(_DWORD *)(*(_DWORD *)(v2 + 112) + 20), "Proxy-Connection", "keep-alive");
      v40 = *(char **)(*(_DWORD *)(v2 + 108) + 8);
      if ( *((_DWORD *)v40 - 3) )
        evhttp_add_header(*(_DWORD *)(*(_DWORD *)(v2 + 112) + 20), "Proxy-Authorization", v40);
      v41 = *(_DWORD *)(v2 + 12);
      if ( !*(_DWORD *)(v41 - 12) )
      {
        v42 = *(_DWORD *)(v2 + 4);
        if ( v42 )
        {
          if ( *(_DWORD *)(v42 + 36) <= 0 )
          {
            if ( *(_DWORD *)(v42 + 16) == 5 )
              v43 = (unsigned int)memcmp(*(const void **)(v42 + 12), "https", 5u) < 1 ? 443 : 80;
            else
              v43 = 80;
          }
          else
          {
            v43 = *(_DWORD *)(v42 + 36);
          }
          v44 = *(_DWORD *)(v42 + 32);
          v182 = (std::locale *)v43;
          if ( v44 )
          {
            v45 = s;
            std::string::string(&v187, *(_DWORD *)(v42 + 28), v44, s);
            v46 = (signed int)v182;
          }
          else
          {
            std::string::string((std::string *)&v187, (const std::string *)&dword_80CF8FC);
            v45 = s;
            v46 = (signed int)v182;
          }
        }
        else
        {
          std::string::string((std::string *)&v187, (const std::string *)&dword_80CF8FC);
          v46 = 80;
          v45 = s;
        }
        snprintf(v45, 0x1000u, "%s:%d", v187, v46);
        v47 = v187 - 12;
        if ( (_DWORD *)(v187 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v158 = _InterlockedExchangeAdd((volatile signed __int32 *)(v187 - 4), 0xFFFFFFFF);
          }
          else
          {
            v159 = *(_DWORD *)(v187 - 4);
            *(_DWORD *)(v187 - 4) = v159 - 1;
            v158 = v159;
          }
          if ( v158 <= 0 )
            std::string::_Rep::_M_destroy(v47, &v186);
        }
LABEL_58:
        evhttp_add_header(*(_DWORD *)(*(_DWORD *)(v2 + 112) + 20), "Host", v45);
        result = evhttp_make_request(*(_DWORD *)(v2 + 96), *(_DWORD *)(v2 + 112), 128, v45);
        if ( result )
        {
          if ( log_level <= 5 )
          {
            std::ios_base::ios_base((std::ios_base *)&v198);
            v198 = (int)&unk_80CF5C8;
            v199 = 0;
            v200 = 0;
            v201 = 0;
            v202 = 0;
            v203 = 0;
            v204 = 0;
            v205 = 0;
            v48 = dword_80CF674;
            v187 = dword_80CF674;
            *(int *)((char *)&v187 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
            std::basic_ios<char,std::char_traits<char>>::init((char *)&v187 + *(_DWORD *)(v187 - 12), 0);
            v187 = (int)&unk_80CF5DC;
            v198 = (int)&unk_80CF5F0;
            v188 = (int)&unk_80CF7F0;
            v189 = 0;
            v190 = 0;
            v191 = 0;
            v192 = 0;
            v193 = 0;
            v194 = 0;
            std::locale::locale((std::locale *)&v195);
            v188 = (int)&unk_80CF588;
            v196 = 16;
            v197 = (int)&unk_80CF83C;
            std::basic_ios<char,std::char_traits<char>>::init(&v198, &v188);
            v49 = std::__ostream_insert<char,std::char_traits<char>>(
                    &v187,
                    &unk_80CF83C,
                    std::string::_Rep::_S_empty_rep_storage);
            std::__ostream_insert<char,std::char_traits<char>>(v49, "VERIFY failed (", 15);
            std::__ostream_insert<char,std::char_traits<char>>(v49, "req_res == 0", 12);
            std::__ostream_insert<char,std::char_traits<char>>(v49, "): ", 3);
            std::__ostream_insert<char,std::char_traits<char>>(v49, "evhttp_make_request failed proxy connect", 40);
            v185 = (int)&unk_80CF83C;
            v50 = *(_DWORD *)(v49 + 24);
            if ( v50 )
            {
              v51 = *(_DWORD *)(v49 + 16);
              LOBYTE(v170) = 0;
              if ( v50 <= (unsigned int)v51 )
              {
                v186 = std::string::_S_construct<char *>(v48, v1, (void *)v49, *(_DWORD *)(v49 + 20), v51, (int)&v184);
                std::string::swap((std::string *)&v185, (std::string *)&v186);
              }
              else
              {
                v186 = std::string::_S_construct<char *>(v48, v1, (void *)v49, *(_DWORD *)(v49 + 20), v50, (int)&v184);
                std::string::swap((std::string *)&v185, (std::string *)&v186);
              }
              std::string::_Rep::_M_dispose(v186 - 12, &v183);
            }
            else
            {
              v49 += 40;
              std::string::assign((std::string *)&v185, (const std::string *)v49);
            }
            v187 = (int)&unk_80CF5DC;
            v198 = (int)&unk_80CF5F0;
            v188 = (int)&unk_80CF588;
            v52 = v197 - 12;
            if ( (_DWORD *)(v197 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              v49 = (int)&_pthread_key_create;
              if ( &_pthread_key_create )
              {
                v157 = _InterlockedExchangeAdd((volatile signed __int32 *)(v197 - 4), 0xFFFFFFFF);
              }
              else
              {
                v157 = *(_DWORD *)(v197 - 4);
                v49 = v157 - 1;
                *(_DWORD *)(v197 - 4) = v157 - 1;
              }
              if ( v157 <= 0 )
                std::string::_Rep::_M_destroy(v52, &v186);
            }
            v188 = (int)&unk_80CF7F0;
            std::locale::~locale((std::locale *)&v195);
            v187 = v48;
            *(int *)((char *)&v187 + *(_DWORD *)(v48 - 12)) = dword_80CF678;
            v198 = (int)&unk_80CF5C8;
            std::ios_base::~ios_base((std::ios_base *)&v198);
            if ( byte_80CE64C )
            {
              v53 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v185, *(_DWORD *)(v185 - 12));
              v54 = (std::ostream *)v53;
              v55 = *(_DWORD *)(*(_DWORD *)v53 - 12);
              v56 = *(_DWORD *)((char *)v54 + v55 + 124);
              if ( !v56 )
              {
                v151 = std::__throw_bad_cast();
                std::string::_Rep::_M_dispose(v187 - 12, &v184);
                std::string::_Rep::_M_dispose(v186 - 12, &v187);
                std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(v49);
                std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v174);
                Unwind_Resume(v151);
              }
              if ( *(_BYTE *)(v56 + 28) )
              {
                v57 = *(_BYTE *)(v56 + 39);
              }
              else
              {
                std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v54 + v55 + 124));
                v57 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v56 + 24))(v56, 10);
              }
              v58 = (std::ostream *)std::ostream::put(v54, v57);
              std::ostream::flush(v58);
            }
            syslog(3, "%s", v185, v170);
            v59 = v185 - 12;
            if ( (_DWORD *)(v185 - 12) != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v60 = _InterlockedExchangeAdd((volatile signed __int32 *)(v185 - 4), 0xFFFFFFFF);
              }
              else
              {
                v156 = *(_DWORD *)(v185 - 4);
                *(_DWORD *)(v185 - 4) = v156 - 1;
                v60 = v156;
              }
              if ( v60 <= 0 )
                std::string::_Rep::_M_destroy(v59, &v187);
            }
          }
LABEL_45:
          abort();
        }
        return result;
      }
      v65 = *(_DWORD *)(v2 + 4);
      if ( v65 )
      {
        if ( *(_DWORD *)(v65 + 36) > 0 )
        {
          v66 = *(_DWORD *)(v65 + 36);
LABEL_86:
          v45 = s;
          snprintf(s, 0x1000u, "%s:%d", v41, v66);
          goto LABEL_58;
        }
        if ( *(_DWORD *)(v65 + 16) == 5 )
        {
          v66 = (unsigned int)memcmp(*(const void **)(v65 + 12), "https", 5u) < 1 ? 443 : 80;
          goto LABEL_86;
        }
      }
      v66 = 80;
      goto LABEL_86;
    }
    if ( log_level > 5 )
      goto LABEL_45;
    v14 = s;
    std::ios_base::ios_base((std::ios_base *)&v217);
    v217 = (int)&unk_80CF5C8;
    v218 = 0;
    v219 = 0;
    v220 = 0;
    v221 = 0;
    v222 = 0;
    v223 = 0;
    v224 = 0;
    *(_DWORD *)s = dword_80CF674;
    *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init(&s[*(_DWORD *)(*(_DWORD *)s - 12)], 0);
    *(_DWORD *)s = &unk_80CF5DC;
    v217 = (int)&unk_80CF5F0;
    v207 = (int)&unk_80CF7F0;
    v208 = 0;
    v209 = 0;
    v210 = 0;
    v211 = 0;
    v212 = 0;
    v213 = 0;
    std::locale::locale((std::locale *)&v214);
    v207 = (int)&unk_80CF588;
    v215 = 16;
    v216 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v217, &v207);
    v91 = std::__ostream_insert<char,std::char_traits<char>>(s, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v91, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v91, "_proxy_req", 10);
    std::__ostream_insert<char,std::char_traits<char>>(v91, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v91, "proxy evhttp_request_new failed", 31);
    v186 = (int)&unk_80CF83C;
    v92 = *(_DWORD *)(v91 + 24);
    if ( v92 )
    {
      v93 = *(_DWORD *)(v91 + 16);
      LOBYTE(v168) = 0;
      if ( v92 > (unsigned int)v93 )
      {
        v187 = std::string::_S_construct<char *>(v91, v1, s, *(_DWORD *)(v91 + 20), v92, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      else
      {
        v187 = std::string::_S_construct<char *>(v91, v1, s, *(_DWORD *)(v91 + 20), v93, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      v94 = v187 - 12;
      if ( (_DWORD *)(v187 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v150 = _InterlockedExchangeAdd((volatile signed __int32 *)(v187 - 4), 0xFFFFFFFF);
        }
        else
        {
          v150 = *(_DWORD *)(v187 - 4);
          *(_DWORD *)(v187 - 4) = v150 - 1;
        }
        if ( v150 <= 0 )
          std::string::_Rep::_M_destroy(v94, &v184);
      }
    }
    else
    {
      std::string::assign((std::string *)&v186, (const std::string *)(v91 + 40));
    }
    *(_DWORD *)s = &unk_80CF5DC;
    v217 = (int)&unk_80CF5F0;
    v207 = (int)&unk_80CF588;
    v95 = v216 - 12;
    if ( (_DWORD *)(v216 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v149 = _InterlockedExchangeAdd((volatile signed __int32 *)(v216 - 4), 0xFFFFFFFF);
      }
      else
      {
        v149 = *(_DWORD *)(v216 - 4);
        *(_DWORD *)(v216 - 4) = v149 - 1;
      }
      if ( v149 <= 0 )
        std::string::_Rep::_M_destroy(v95, &v187);
    }
    v207 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v214);
    *(_DWORD *)s = dword_80CF674;
    *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    v217 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v217);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, s);
    if ( !byte_80CE64C )
      goto LABEL_135;
    v96 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v186, *(_DWORD *)(v186 - 12));
    v97 = (std::ostream *)v96;
    v98 = *(_DWORD *)(*(_DWORD *)v96 - 12);
    v99 = *(_DWORD *)((char *)v97 + v98 + 124);
    if ( v99 )
    {
      if ( *(_BYTE *)(v99 + 28) )
      {
        v100 = *(_BYTE *)(v99 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v97 + v98 + 124));
        v100 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v99 + 24))(v99, 10);
      }
      v101 = (std::ostream *)std::ostream::put(v97, v100);
      std::ostream::flush(v101);
LABEL_135:
      syslog(3, "%s", v186, v168);
LABEL_136:
      std::string::_Rep::_M_dispose(v186 - 12, v14);
      goto LABEL_45;
    }
    v147 = std::__throw_bad_cast();
LABEL_254:
    v148 = v147;
    std::string::_Rep::_M_dispose(v186 - 12, v14);
    Unwind_Resume(v148);
  }
  v11 = do_http_create_request(v2);
  *(_DWORD *)(v2 + 100) = v11;
  if ( *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v2 + 108) + 8) - 12) )
  {
    evhttp_add_header(*(_DWORD *)(v11 + 20), "Proxy-Authorization", *(char **)(*(_DWORD *)(v2 + 108) + 8));
    v11 = *(_DWORD *)(v2 + 100);
  }
  evhttp_remove_header(*(_DWORD *)(v11 + 20), "Connection");
  evhttp_add_header(*(_DWORD *)(*(_DWORD *)(v2 + 100) + 20), "Connection", "keep-alive");
  evhttp_add_header(*(_DWORD *)(*(_DWORD *)(v2 + 100) + 20), "Proxy-Connection", "keep-alive");
  v12 = *(_DWORD *)(v2 + 4);
  if ( v12 && (v13 = *(_DWORD *)(v12 + 16)) != 0 )
  {
    v14 = s;
    std::string::string(s, *(_DWORD *)(v12 + 12), v13, &v187);
    v15 = std::string::append((std::string *)s, "://", 3u);
    v186 = *(_DWORD *)v15;
    *(_DWORD *)v15 = &unk_80CF83C;
    v16 = *(_DWORD *)s - 12;
    if ( (_DWORD *)(*(_DWORD *)s - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v165 = _InterlockedExchangeAdd((volatile signed __int32 *)(*(_DWORD *)s - 4), 0xFFFFFFFF);
      }
      else
      {
        v165 = *(_DWORD *)(*(_DWORD *)s - 4);
        *(_DWORD *)(*(_DWORD *)s - 4) = v165 - 1;
      }
      if ( v165 <= 0 )
        std::string::_Rep::_M_destroy(v16, &v187);
    }
  }
  else
  {
    v14 = s;
    std::string::string(&v186, "http://", s);
  }
  sub_808AF20((int)v14, v181);
  std::string::append((std::string *)&v186, (const std::string *)v14);
  v17 = *(_DWORD *)s - 12;
  if ( (_DWORD *)(*(_DWORD *)s - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v143 = _InterlockedExchangeAdd((volatile signed __int32 *)(*(_DWORD *)s - 4), 0xFFFFFFFF);
    }
    else
    {
      v143 = *(_DWORD *)(*(_DWORD *)s - 4);
      *(_DWORD *)(*(_DWORD *)s - 4) = v143 - 1;
    }
    if ( v143 <= 0 )
      std::string::_Rep::_M_destroy(v17, &v187);
  }
  v18 = *(_DWORD *)(v2 + 4);
  if ( v18 && *(_DWORD *)(v18 + 36) )
  {
    v19 = *(_DWORD *)(v186 - 12);
    std::string::resize((std::string *)&v186, v19 + 11, 0);
    v20 = *(_DWORD *)(v2 + 4);
    if ( v20 )
      v175 = *(std::string **)(v20 + 36);
    else
      v175 = 0;
    v21 = v186;
    if ( *(_DWORD *)(v186 - 4) >= 0 )
    {
      std::string::_M_leak_hard((std::string *)&v186);
      v21 = v186;
    }
    v22 = snprintf((char *)(v19 + v21), 0xBu, ":%d", v175);
    std::string::resize((std::string *)&v186, v22 + v19, 0);
  }
  sub_808AAB0((std::string *)&v187, v181);
  std::string::append((std::string *)&v186, (const std::string *)&v187);
  v23 = v187 - 12;
  if ( (_DWORD *)(v187 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v146 = _InterlockedExchangeAdd((volatile signed __int32 *)(v187 - 4), 0xFFFFFFFF);
    }
    else
    {
      v146 = *(_DWORD *)(v187 - 4);
      *(_DWORD *)(v187 - 4) = v146 - 1;
    }
    if ( v146 <= 0 )
      std::string::_Rep::_M_destroy(v23, v14);
  }
  result = evhttp_make_request(*(_DWORD *)(v2 + 96), *(_DWORD *)(v2 + 100), *(_DWORD *)(v2 + 8), v186);
  v25 = v186 - 12;
  if ( (_DWORD *)(v186 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v144 = _InterlockedExchangeAdd((volatile signed __int32 *)(v186 - 4), 0xFFFFFFFF);
    }
    else
    {
      v166 = *(_DWORD *)(v186 - 4);
      *(_DWORD *)(v186 - 4) = v166 - 1;
      v144 = v166;
    }
    if ( v144 <= 0 )
    {
      v145 = result;
      std::string::_Rep::_M_destroy(v25, v14);
      result = v145;
    }
  }
  if ( result )
  {
    if ( log_level > 5 )
      goto LABEL_45;
    v26 = (std::ios_base *)&v217;
    std::ios_base::ios_base((std::ios_base *)&v217);
    v217 = (int)&unk_80CF5C8;
    v218 = 0;
    v219 = 0;
    v220 = 0;
    v221 = 0;
    v222 = 0;
    v223 = 0;
    v224 = 0;
    *(_DWORD *)s = dword_80CF674;
    *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init(&v14[*(_DWORD *)(*(_DWORD *)s - 12)], 0);
    *(_DWORD *)s = &unk_80CF5DC;
    v217 = (int)&unk_80CF5F0;
    v207 = (int)&unk_80CF7F0;
    v208 = 0;
    v209 = 0;
    v210 = 0;
    v211 = 0;
    v212 = 0;
    v213 = 0;
    std::locale::locale((std::locale *)&v214);
    v207 = (int)&unk_80CF588;
    v215 = 16;
    v216 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v217, &v207);
    v27 = std::__ostream_insert<char,std::char_traits<char>>(v14, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v27, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v27, "req_res == 0", 12);
    std::__ostream_insert<char,std::char_traits<char>>(v27, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v27, "evhttp_make_request failed proxy", 32);
    v186 = (int)&unk_80CF83C;
    v28 = *(_DWORD *)(v27 + 24);
    if ( v28 )
    {
      v29 = *(_DWORD *)(v27 + 16);
      LOBYTE(v169) = 0;
      if ( v28 <= (unsigned int)v29 )
      {
        v187 = std::string::_S_construct<char *>(v27, v1, v14, *(_DWORD *)(v27 + 20), v29, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      else
      {
        v187 = std::string::_S_construct<char *>(v27, v1, v14, *(_DWORD *)(v27 + 20), v28, (int)&v185);
        std::string::swap((std::string *)&v186, (std::string *)&v187);
      }
      v30 = v187;
      v31 = v187 - 12;
      if ( (_DWORD *)(v187 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        goto LABEL_321;
    }
    else
    {
      std::string::assign((std::string *)&v186, (const std::string *)(v27 + 40));
    }
    while ( 1 )
    {
      *(_DWORD *)s = &unk_80CF5DC;
      v217 = (int)&unk_80CF5F0;
      v207 = (int)&unk_80CF588;
      v32 = v216 - 12;
      if ( (_DWORD *)(v216 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v141 = _InterlockedExchangeAdd((volatile signed __int32 *)(v216 - 4), 0xFFFFFFFF);
        }
        else
        {
          v141 = *(_DWORD *)(v216 - 4);
          *(_DWORD *)(v216 - 4) = v141 - 1;
        }
        if ( v141 <= 0 )
          std::string::_Rep::_M_destroy(v32, &v187);
      }
      v207 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v214);
      *(_DWORD *)s = dword_80CF674;
      *(_DWORD *)&s[*(_DWORD *)(dword_80CF674 - 12)] = dword_80CF678;
      v217 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base(v26);
      if ( !byte_80CE64C )
        goto LABEL_43;
      v33 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v186, *(_DWORD *)(v186 - 12));
      v26 = (std::ios_base *)v33;
      v34 = *(_DWORD *)(*(_DWORD *)v33 - 12);
      v35 = *(_DWORD *)((char *)v26 + v34 + 124);
      if ( v35 )
        break;
      v30 = std::__throw_bad_cast();
LABEL_321:
      if ( &_pthread_key_create )
      {
        v164 = _InterlockedExchangeAdd((volatile signed __int32 *)(v30 - 4), 0xFFFFFFFF);
      }
      else
      {
        v164 = *(_DWORD *)(v30 - 4);
        *(_DWORD *)(v30 - 4) = v164 - 1;
      }
      if ( v164 <= 0 )
        std::string::_Rep::_M_destroy(v31, &v184);
    }
    if ( *(_BYTE *)(v35 + 28) )
    {
      v36 = *(_BYTE *)(v35 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v26 + v34 + 124));
      v36 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v35 + 24))(v35, 10);
    }
    v37 = (std::ostream *)std::ostream::put(v26, v36);
    std::ostream::flush(v37);
LABEL_43:
    syslog(3, "%s", v186, v169);
    goto LABEL_44;
  }
  return result;
}
// 804C3F0: using guessed type int __cdecl BIO_new_mem_buf(_DWORD, _DWORD);
// 804C460: using guessed type int __cdecl BIO_free(_DWORD);
// 804C4A0: using guessed type int sk_pop_free(_DWORD, const char *, ...);
// 804C4B0: using guessed type int __cdecl evhttp_remove_header(_DWORD, _DWORD);
// 804C530: using guessed type int __cdecl bufferevent_openssl_socket_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804C560: using guessed type int __cdecl evhttp_connection_set_reset_on_close(_DWORD, _DWORD);
// 804C570: using guessed type int __cdecl evhttp_make_request(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C590: using guessed type int __cdecl SSL_CTX_set_cert_verify_callback(_DWORD, _DWORD, _DWORD);
// 804C5D0: using guessed type int __cdecl evhttp_request_set_error_cb(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C6B0: using guessed type int __cdecl SSL_CTX_set_verify(_DWORD, _DWORD, _DWORD);
// 804C720: using guessed type int __cdecl sk_value(_DWORD, _DWORD);
// 804C770: using guessed type int __cdecl bufferevent_socket_new(_DWORD, _DWORD, _DWORD);
// 804C780: using guessed type int __cdecl SSL_ctrl(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C7C0: using guessed type int __cdecl PEM_X509_INFO_read_bio(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C8A0: using guessed type int __cdecl evhttp_connection_base_bufferevent_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CAC0: using guessed type int __cdecl SSL_CTX_new(_DWORD);
// 804CB70: using guessed type int __cdecl bufferevent_openssl_set_allow_dirty_shutdown(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CCB0: using guessed type int __cdecl evhttp_connection_set_timeout(_DWORD, _DWORD);
// 804CD30: using guessed type int __cdecl sk_num(_DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CDC0: using guessed type int __cdecl evhttp_request_new(_DWORD, _DWORD);
// 804CE70: using guessed type int __cdecl bufferevent_setwatermark(_DWORD, _DWORD, _DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804CEA0: using guessed type int __cdecl SSL_new(_DWORD);
// 804CF10: using guessed type int __cdecl SSL_CTX_get_cert_store(_DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 804D480: using guessed type int __cdecl X509_STORE_add_cert(_DWORD, _DWORD);
// 804D4A0: using guessed type int SSLv23_method(void);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CE6A0: using guessed type int dword_80CE6A0;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (080785C0) --------------------------------------------------------
void __cdecl sub_80785C0(int a1, int a2)
{
  int v2; // esi@1
  void *v3; // ecx@3
  void *v4; // ebx@3
  int v5; // eax@4
  int v6; // edx@4
  int v7; // ebx@12
  int v8; // esi@12
  int v9; // eax@15
  struct bufferevent *v10; // ST20_4@16
  int v11; // eax@16
  int v12; // esi@22
  int v13; // esi@26
  int i; // ebx@31
  int v15; // esi@32
  signed __int32 v16; // eax@39
  void *v17; // ST1C_4@41
  void *v18; // ST1C_4@42
  signed __int32 v19; // ebx@42
  int v20; // [sp+4h] [bp-64h]@0
  int v21; // [sp+4h] [bp-64h]@26
  int v22; // [sp+8h] [bp-60h]@0
  int v23; // [sp+8h] [bp-60h]@26
  struct bufferevent *bufev; // [sp+20h] [bp-48h]@16
  int v25; // [sp+24h] [bp-44h]@3
  char v26; // [sp+28h] [bp-40h]@18
  int v27; // [sp+34h] [bp-34h]@16
  char v28; // [sp+38h] [bp-30h]@3
  char v29; // [sp+3Ch] [bp-2Ch]@14
  void *v30; // [sp+40h] [bp-28h]@33
  char *v31; // [sp+44h] [bp-24h]@14
  char *v32; // [sp+48h] [bp-20h]@14
  int v33; // [sp+4Ch] [bp-1Ch]@14

  v2 = *(_DWORD *)(a1 + 124);
  if ( v2 )
  {
    if ( !*(_DWORD *)a2 )
    {
      ++*(_DWORD *)(v2 + 28);
      v2 = *(_DWORD *)(a1 + 124);
      if ( *(_DWORD *)(v2 + 28) < (unsigned int)((*(_DWORD *)(v2 + 20) - *(_DWORD *)(v2 + 16)) >> 2) )
      {
        sub_8072360(a1);
        std::string::assign(
          (std::string *)(a1 + 12),
          (const std::string *)(*(_DWORD *)(*(_DWORD *)(a1 + 124) + 16) + 4 * *(_DWORD *)(*(_DWORD *)(a1 + 124) + 28)));
        sub_8075330(a1);
        return;
      }
    }
    *(_DWORD *)(a1 + 124) = 0;
    v3 = *(void **)(v2 + 20);
    v4 = *(void **)(v2 + 16);
    v25 = (int)&v28;
    if ( v3 != v4 )
    {
      do
      {
        v5 = *(_DWORD *)v4;
        v6 = *(_DWORD *)v4 - 12;
        if ( (_DWORD *)v6 != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v16 = _InterlockedExchangeAdd((volatile signed __int32 *)(v5 - 4), 0xFFFFFFFF);
          }
          else
          {
            v18 = v4;
            v19 = *(_DWORD *)(v5 - 4);
            *(_DWORD *)(v5 - 4) = v19 - 1;
            v16 = v19;
            v4 = v18;
          }
          if ( v16 <= 0 )
          {
            v17 = v3;
            std::string::_Rep::_M_destroy(v6, &v28);
            v3 = v17;
          }
        }
        v4 = (char *)v4 + 4;
      }
      while ( v3 != v4 );
      v3 = *(void **)(v2 + 16);
    }
    if ( v3 )
      operator delete(v3);
    evdns_base_free(*(_DWORD *)(v2 + 8), 1);
    operator delete((void *)v2);
  }
  else
  {
    v25 = (int)&v28;
  }
  if ( *(_DWORD *)(a1 + 32) )
  {
    event_remove_timer(*(_DWORD *)(a1 + 32));
    event_free(*(_DWORD *)(a1 + 32));
    *(_DWORD *)(a1 + 32) = 0;
  }
  v7 = *(_DWORD *)(a1 + 92);
  *(_DWORD *)(a1 + 92) = 0;
  v8 = *(_DWORD *)(a1 + 96);
  *(_DWORD *)(a1 + 96) = 0;
  if ( *(_DWORD *)(a1 + 64) )
    sub_807B930(a1 + 56, (void *)a2);
  memset(&v29, 0, 0x10u);
  v33 = 0;
  v31 = &v29;
  v32 = &v29;
  if ( v8 )
  {
    v9 = evhttp_connection_get_bufferevent(v8);
    if ( v9 )
    {
      v10 = (struct bufferevent *)v9;
      v27 = bufferevent_getfd(v9);
      v11 = bufferevent_get_underlying(v10);
      bufev = (struct bufferevent *)v11;
      if ( v11 )
      {
        v27 = bufferevent_getfd(v11);
        if ( v27 >= 0 )
        {
          bufferevent_setfd(bufev, -1);
          sub_807B9B0((int)&v26, v25, (int)&v27);
        }
        bufferevent_free(bufev);
      }
    }
    evhttp_connection_free(v8, v20, v22);
  }
  if ( v7 )
  {
    v27 = -1;
    v12 = SSL_get_wbio(v7);
    if ( v12 )
      BIO_ctrl(v12, 105, 0, &v27);
    if ( v27 >= 0 )
    {
      BIO_int_ctrl(v12, 104, 0, -1);
      sub_807B9B0((int)&v26, v25, (int)&v27);
    }
    v27 = -1;
    v13 = SSL_get_rbio(v7, v20, v22);
    if ( v13 )
      BIO_ctrl(v13, 105, 0, &v27);
    if ( v27 >= 0 )
    {
      BIO_int_ctrl(v13, 104, 0, -1);
      sub_807B9B0((int)&v26, v25, (int)&v27);
    }
    SSL_clear(v7, v21, v23);
    SSL_free(v7);
  }
  for ( i = (int)v31; (char *)i != &v29; i = std::_Rb_tree_increment(i) )
  {
    v15 = *(_DWORD *)(i + 16);
    evutil_socket_set_no_linger(*(_DWORD *)(i + 16));
    evutil_closesocket(v15);
  }
  sub_807B960(v25, v30);
}
// 804C410: using guessed type int __cdecl SSL_get_rbio(_DWORD, _DWORD, _DWORD);
// 804C430: using guessed type int __cdecl evutil_socket_set_no_linger(_DWORD);
// 804C4D0: using guessed type int __cdecl BIO_ctrl(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C620: using guessed type int __cdecl bufferevent_get_underlying(_DWORD);
// 804C6D0: using guessed type int __cdecl evhttp_connection_get_bufferevent(_DWORD);
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804C930: using guessed type int __cdecl SSL_free(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CB90: using guessed type int __cdecl event_remove_timer(_DWORD);
// 804CBB0: using guessed type int __cdecl std::_Rb_tree_increment(_DWORD);
// 804CC70: using guessed type int __cdecl bufferevent_getfd(_DWORD);
// 804CD20: using guessed type int __cdecl SSL_get_wbio(_DWORD);
// 804CE10: using guessed type int __cdecl SSL_clear(_DWORD, _DWORD, _DWORD);
// 804CF30: using guessed type int __cdecl event_free(_DWORD);
// 804D050: using guessed type int __cdecl evhttp_connection_free(_DWORD, _DWORD, _DWORD);
// 804D0C0: using guessed type int __cdecl evutil_closesocket(_DWORD);
// 804D2C0: using guessed type int __cdecl BIO_int_ctrl(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D3A0: using guessed type int __cdecl bufferevent_setfd(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08078940) --------------------------------------------------------
void __cdecl sub_8078940(int a1, int a2)
{
  int v2; // [sp+18h] [bp-14h]@1
  char v3; // [sp+1Ch] [bp-10h]@1

  v2 = a1;
  v3 = 0;
  sub_80785C0(a2, (int)&v2);
}

//----- (08078970) --------------------------------------------------------
void __cdecl sub_8078970(int a1)
{
  unsigned int v1; // ebp@0
  int v2; // ebx@1
  int v3; // eax@1
  std::string *v4; // edi@3
  int v5; // esi@6
  int v6; // eax@6
  int v7; // edx@7
  int v8; // edx@9
  int v9; // edx@10
  std::ostream *v10; // esi@12
  char v11; // al@14
  std::ostream *v12; // eax@15
  int v13; // edx@16
  signed __int32 v14; // eax@18
  int v15; // eax@24
  int v16; // eax@27
  int v17; // ecx@27
  int v18; // ebx@30
  int v19; // eax@30
  int v20; // edx@31
  int v21; // edx@33
  int v22; // edx@34
  int v23; // eax@36
  std::ostream *v24; // esi@36
  int v25; // eax@36
  int v26; // ebx@36
  char v27; // al@38
  std::ostream *v28; // eax@39
  int v29; // edx@41
  char v30; // dl@46
  int v31; // esi@47
  int v32; // eax@50
  int v33; // edx@51
  int v34; // edx@53
  int v35; // esi@54
  int v36; // eax@54
  int v37; // esi@54
  int v38; // eax@58
  int v39; // eax@58
  int v40; // ebx@61
  int v41; // eax@61
  int v42; // edx@62
  int v43; // edx@64
  int v44; // edx@65
  int v45; // eax@67
  std::ostream *v46; // esi@67
  int v47; // eax@67
  int v48; // ebx@67
  char v49; // al@69
  std::ostream *v50; // eax@70
  int v51; // eax@77
  int v52; // esi@77
  int v53; // edi@77
  int v54; // edi@79
  int v55; // esi@80
  int v56; // eax@82
  int v57; // eax@91
  int v58; // eax@91
  int v59; // eax@92
  signed __int32 v60; // esi@95
  signed __int32 v61; // esi@99
  int v62; // eax@102
  int v63; // ebx@103
  signed __int32 v64; // edx@107
  std::ios_base *v65; // ST30_4@109
  signed __int32 v66; // ebx@110
  signed __int32 v67; // ecx@113
  signed __int32 v68; // ecx@117
  signed __int32 v69; // eax@125
  signed __int32 v70; // ecx@128
  signed __int32 v71; // ecx@129
  signed __int32 v72; // ecx@131
  signed __int32 v73; // ecx@135
  signed __int32 v74; // ecx@141
  int v75; // [sp+Ch] [bp-10Ch]@0
  int v76; // [sp+Ch] [bp-10Ch]@27
  int v77; // [sp+Ch] [bp-10Ch]@54
  int v78; // [sp+1Ch] [bp-FCh]@78
  int v79; // [sp+20h] [bp-F8h]@77
  signed int v80; // [sp+24h] [bp-F4h]@80
  std::locale *v81; // [sp+28h] [bp-F0h]@46
  std::ios_base *v82; // [sp+2Ch] [bp-ECh]@12
  char v83; // [sp+32h] [bp-E6h]@137
  char v84; // [sp+33h] [bp-E5h]@63
  int v85; // [sp+34h] [bp-E4h]@54
  int v86; // [sp+38h] [bp-E0h]@54
  int v87; // [sp+3Ch] [bp-DCh]@54
  int v88; // [sp+40h] [bp-D8h]@8
  int v89; // [sp+44h] [bp-D4h]@6
  int v90; // [sp+48h] [bp-D0h]@8
  int v91; // [sp+4Ch] [bp-CCh]@3
  int v92; // [sp+50h] [bp-C8h]@4
  int v93; // [sp+54h] [bp-C4h]@6
  int v94; // [sp+58h] [bp-C0h]@6
  int v95; // [sp+5Ch] [bp-BCh]@6
  int v96; // [sp+60h] [bp-B8h]@6
  int v97; // [sp+64h] [bp-B4h]@6
  int v98; // [sp+68h] [bp-B0h]@6
  char v99; // [sp+6Ch] [bp-ACh]@6
  int v100; // [sp+70h] [bp-A8h]@6
  int v101; // [sp+74h] [bp-A4h]@6
  int v102; // [sp+78h] [bp-A0h]@6
  int v103; // [sp+E8h] [bp-30h]@6
  char v104; // [sp+ECh] [bp-2Ch]@6
  char v105; // [sp+EDh] [bp-2Bh]@6
  int v106; // [sp+F0h] [bp-28h]@6
  int v107; // [sp+F4h] [bp-24h]@6
  int v108; // [sp+F8h] [bp-20h]@6
  int v109; // [sp+FCh] [bp-1Ch]@6

  v2 = a1;
  v3 = *(_DWORD *)(a1 + 112);
  if ( !v3 || *(_DWORD *)(v3 + 64) != 200 )
  {
    v4 = (std::string *)&v91;
    if ( log_level > 1 )
    {
LABEL_4:
      v91 = 0;
      LOBYTE(v92) = 0;
      sub_80785C0(a1, (int)&v91);
      return;
    }
    std::ios_base::ios_base((std::ios_base *)&v102);
    v102 = (int)&unk_80CF5C8;
    v103 = 0;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v109 = 0;
    v91 = dword_80CF674;
    *(int *)((char *)&v91 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v91 + *(_DWORD *)(v91 - 12), 0);
    v91 = (int)&unk_80CF5DC;
    v102 = (int)&unk_80CF5F0;
    v92 = (int)&unk_80CF7F0;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    v98 = 0;
    std::locale::locale((std::locale *)&v99);
    v92 = (int)&unk_80CF588;
    v100 = 16;
    v101 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v102, &v92);
    v5 = std::__ostream_insert<char,std::char_traits<char>>(&v91, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v5, &byte_80BA86B, 28);
    v89 = (int)&unk_80CF83C;
    v6 = *(_DWORD *)(v5 + 24);
    if ( v6 )
    {
      v7 = *(_DWORD *)(v5 + 16);
      LOBYTE(v75) = 0;
      if ( v6 > (unsigned int)v7 )
      {
        v90 = std::string::_S_construct<char *>(a1, v1, &v91, *(_DWORD *)(v5 + 20), v6, (int)&v88);
        std::string::swap((std::string *)&v89, (std::string *)&v90);
      }
      else
      {
        v90 = std::string::_S_construct<char *>(a1, v1, &v91, *(_DWORD *)(v5 + 20), v7, (int)&v88);
        std::string::swap((std::string *)&v89, (std::string *)&v90);
      }
      v8 = v90 - 12;
      if ( (_DWORD *)(v90 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v60 = _InterlockedExchangeAdd((volatile signed __int32 *)(v90 - 4), 0xFFFFFFFF);
        }
        else
        {
          v60 = *(_DWORD *)(v90 - 4);
          *(_DWORD *)(v90 - 4) = v60 - 1;
        }
        if ( v60 <= 0 )
          std::string::_Rep::_M_destroy(v8, &v87);
      }
    }
    else
    {
      std::string::assign((std::string *)&v89, (const std::string *)(v5 + 40));
    }
    v91 = (int)&unk_80CF5DC;
    v102 = (int)&unk_80CF5F0;
    v92 = (int)&unk_80CF588;
    v9 = v101 - 12;
    if ( (_DWORD *)(v101 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v61 = _InterlockedExchangeAdd((volatile signed __int32 *)(v101 - 4), 0xFFFFFFFF);
      }
      else
      {
        v61 = *(_DWORD *)(v101 - 4);
        *(_DWORD *)(v101 - 4) = v61 - 1;
      }
      if ( v61 <= 0 )
        std::string::_Rep::_M_destroy(v9, &v90);
    }
    v92 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v99);
    v91 = dword_80CF674;
    *(int *)((char *)&v91 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v102 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v102);
    if ( !byte_80CE64C )
    {
LABEL_16:
      syslog(7, "%s", v89, v75);
      v13 = v89 - 12;
      if ( (_DWORD *)(v89 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v14 = _InterlockedExchangeAdd((volatile signed __int32 *)(v89 - 4), 0xFFFFFFFF);
        }
        else
        {
          v71 = *(_DWORD *)(v89 - 4);
          *(_DWORD *)(v89 - 4) = v71 - 1;
          v14 = v71;
        }
        if ( v14 <= 0 )
          std::string::_Rep::_M_destroy(v13, &v91);
      }
      goto LABEL_4;
    }
    v10 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v89, *(_DWORD *)(v89 - 12));
    v82 = *(std::ios_base **)((char *)v10 + *(_DWORD *)(*(_DWORD *)v10 - 12) + 124);
    if ( v82 )
    {
      if ( *((_BYTE *)v82 + 28) )
      {
        v11 = *((_BYTE *)v82 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(v82);
        v11 = (*(int (__cdecl **)(std::ios_base *, signed int))(*(_DWORD *)v82 + 24))(v82, 10);
      }
      v12 = (std::ostream *)std::ostream::put(v10, v11);
      std::ostream::flush(v12);
      goto LABEL_16;
    }
    v62 = std::__throw_bad_cast();
LABEL_103:
    v63 = v62;
    std::string::_Rep::_M_dispose(v89 - 12, v4);
    Unwind_Resume(v63);
  }
  *(_DWORD *)(a1 + 112) = 0;
  if ( *(_DWORD *)(a1 + 80) )
  {
    v91 = 0;
    LOBYTE(v92) = 0;
    sub_807B930(a1 + 72, &v91);
    return;
  }
  v15 = *(_DWORD *)(a1 + 4);
  if ( !v15 || *(_DWORD *)(v15 + 16) != 5 || memcmp(*(const void **)(v15 + 12), "https", 5u) )
  {
    v4 = (std::string *)&v91;
    goto LABEL_27;
  }
  v30 = *(_BYTE *)(a1 + 16);
  v81 = *(std::locale **)(a1 + 88);
  if ( v30 )
  {
    v31 = *((_DWORD *)v81 + 3);
    if ( !v31 )
    {
      v51 = SSLv23_method();
      v52 = SSL_CTX_new(v51);
      *((_DWORD *)v81 + 3) = v52;
      v53 = BIO_new_mem_buf(&unk_80CE6C0, dword_80CE6A0);
      v79 = v53;
      if ( v53 )
      {
        v78 = SSL_CTX_get_cert_store(v52);
        if ( v78 && (v54 = PEM_X509_INFO_read_bio(v53, 0, 0, 0)) != 0 )
        {
          v55 = 0;
          v80 = 0;
          while ( v55 < sk_num(v54) )
          {
            v56 = *(_DWORD *)sk_value(v54, v55);
            if ( v56 )
            {
              X509_STORE_add_cert(v78, v56);
              v80 = 1;
            }
            ++v55;
          }
          v2 = a1;
          sk_pop_free(v54, (const char *)&X509_INFO_free);
          BIO_free(v79);
          if ( v80 == 1 )
          {
            SSL_CTX_set_verify(*((_DWORD *)v81 + 3), 1, 0);
            v30 = *(_BYTE *)(a1 + 16);
            v31 = *((_DWORD *)v81 + 3);
            v4 = (std::string *)&v91;
LABEL_49:
            if ( v30 )
              SSL_CTX_set_cert_verify_callback(v31, sub_8073FE0, v2);
            goto LABEL_50;
          }
        }
        else
        {
          BIO_free(v79);
        }
      }
      if ( log_level <= 5 )
      {
        v4 = (std::string *)&v91;
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v91, 16);
        v57 = std::__ostream_insert<char,std::char_traits<char>>(
                &v91,
                &unk_80CF83C,
                std::string::_Rep::_S_empty_rep_storage);
        v58 = std::operator<<<std::char_traits<char>>(v57, "_ssl_ctx_load_trusted() has failed");
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v90, v58 + 4);
        v91 = (int)&unk_80CF5DC;
        v102 = (int)&unk_80CF5F0;
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf((int)&v92);
        v91 = dword_80CF674;
        *(int *)((char *)&v91 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        v102 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v102);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v91);
        if ( byte_80CE64C )
        {
          v59 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v90, *(_DWORD *)(v90 - 12));
          std::endl<char,std::char_traits<char>>(v59);
        }
        syslog(3, "%s", v90);
        std::string::_Rep::_M_dispose(v90 - 12, &v91);
        v30 = *(_BYTE *)(v2 + 16);
        v31 = *((_DWORD *)v81 + 3);
      }
      else
      {
        v30 = *(_BYTE *)(v2 + 16);
        v31 = *((_DWORD *)v81 + 3);
        v4 = (std::string *)&v91;
      }
      goto LABEL_49;
    }
LABEL_48:
    v4 = (std::string *)&v91;
    goto LABEL_49;
  }
  v31 = *((_DWORD *)v81 + 2);
  v4 = (std::string *)&v91;
  if ( !v31 )
  {
    v38 = SSLv23_method();
    v39 = SSL_CTX_new(v38);
    *((_DWORD *)v81 + 2) = v39;
    v30 = *(_BYTE *)(a1 + 16);
    v31 = v39;
    goto LABEL_48;
  }
LABEL_50:
  *(_DWORD *)(v2 + 92) = SSL_new(v31);
  v32 = *(_DWORD *)(v2 + 4);
  if ( v32 && (v33 = *(_DWORD *)(v32 + 32)) != 0 )
    std::string::string(v4, *(_DWORD *)(v32 + 28), v33, &v90);
  else
    std::string::string(v4, (const std::string *)&dword_80CF8FC);
  SSL_ctrl(*(_DWORD *)(v2 + 92), 55, 0, v91);
  v34 = v91 - 12;
  if ( (_DWORD *)(v91 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v74 = _InterlockedExchangeAdd((volatile signed __int32 *)(v91 - 4), 0xFFFFFFFF);
    }
    else
    {
      v74 = *(_DWORD *)(v91 - 4);
      *(_DWORD *)(v91 - 4) = v74 - 1;
    }
    if ( v74 <= 0 )
      std::string::_Rep::_M_destroy(v34, &v90);
  }
  v35 = evhttp_connection_get_bufferevent(*(_DWORD *)(v2 + 96));
  bufferevent_getcb(v35, &v85, &v86, &v87, &v88);
  bufferevent_setcb(v35, 0, 0, 0, 0);
  v36 = bufferevent_openssl_filter_new(*(_DWORD *)(*(_DWORD *)(v2 + 88) + 4), v35, *(_DWORD *)(v2 + 92), 1, 4);
  v37 = v36;
  if ( !v36 )
  {
    if ( log_level > 5 )
      goto LABEL_42;
    std::ios_base::ios_base((std::ios_base *)&v102);
    v102 = (int)&unk_80CF5C8;
    v103 = 0;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v109 = 0;
    v91 = dword_80CF674;
    *(int *)((char *)&v91 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)v4 + *(_DWORD *)(v91 - 12), 0);
    v91 = (int)&unk_80CF5DC;
    v102 = (int)&unk_80CF5F0;
    v92 = (int)&unk_80CF7F0;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    v98 = 0;
    std::locale::locale((std::locale *)&v99);
    v92 = (int)&unk_80CF588;
    v100 = 16;
    v101 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v102, &v92);
    v40 = std::__ostream_insert<char,std::char_traits<char>>(v4, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v40, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v40, "bev", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v40, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v40, "bufferevent_openssl_filter_new failed", 37);
    v89 = (int)&unk_80CF83C;
    v41 = *(_DWORD *)(v40 + 24);
    if ( v41 )
    {
      v42 = *(_DWORD *)(v40 + 16);
      LOBYTE(v77) = 0;
      if ( v41 <= (unsigned int)v42 )
      {
        v90 = std::string::_S_construct<char *>(v40, v1, (void *)v4, *(_DWORD *)(v40 + 20), v42, (int)&v84);
        std::string::swap((std::string *)&v89, (std::string *)&v90);
      }
      else
      {
        v90 = std::string::_S_construct<char *>(v40, v1, (void *)v4, *(_DWORD *)(v40 + 20), v41, (int)&v84);
        std::string::swap((std::string *)&v89, (std::string *)&v90);
      }
      v43 = v90 - 12;
      if ( (_DWORD *)(v90 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v73 = _InterlockedExchangeAdd((volatile signed __int32 *)(v90 - 4), 0xFFFFFFFF);
        }
        else
        {
          v73 = *(_DWORD *)(v90 - 4);
          *(_DWORD *)(v90 - 4) = v73 - 1;
        }
        if ( v73 <= 0 )
          std::string::_Rep::_M_destroy(v43, &v83);
      }
    }
    else
    {
      std::string::assign((std::string *)&v89, (const std::string *)(v40 + 40));
    }
    v91 = (int)&unk_80CF5DC;
    v102 = (int)&unk_80CF5F0;
    v92 = (int)&unk_80CF588;
    v44 = v101 - 12;
    if ( (_DWORD *)(v101 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v72 = _InterlockedExchangeAdd((volatile signed __int32 *)(v101 - 4), 0xFFFFFFFF);
      }
      else
      {
        v72 = *(_DWORD *)(v101 - 4);
        *(_DWORD *)(v101 - 4) = v72 - 1;
      }
      if ( v72 <= 0 )
        std::string::_Rep::_M_destroy(v44, &v90);
    }
    v92 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v99);
    v91 = dword_80CF674;
    *(int *)((char *)&v91 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v102 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v102);
    if ( byte_80CE64C )
    {
      v45 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v89, *(_DWORD *)(v89 - 12));
      v46 = (std::ostream *)v45;
      v47 = *(_DWORD *)(*(_DWORD *)v45 - 12);
      v48 = *(_DWORD *)((char *)v46 + v47 + 124);
      if ( !v48 )
      {
        v62 = std::__throw_bad_cast();
        goto LABEL_103;
      }
      if ( *(_BYTE *)(v48 + 28) )
      {
        v49 = *(_BYTE *)(v48 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v46 + v47 + 124));
        v49 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v48 + 24))(v48, 10);
      }
      v50 = (std::ostream *)std::ostream::put(v46, v49);
      std::ostream::flush(v50);
    }
    syslog(3, "%s", v89, v77);
LABEL_41:
    v29 = v89 - 12;
    if ( (_DWORD *)(v89 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v69 = _InterlockedExchangeAdd((volatile signed __int32 *)(v89 - 4), 0xFFFFFFFF);
      }
      else
      {
        v70 = *(_DWORD *)(v89 - 4);
        *(_DWORD *)(v89 - 4) = v70 - 1;
        v69 = v70;
      }
      if ( v69 <= 0 )
        std::string::_Rep::_M_destroy(v29, v4);
    }
LABEL_42:
    abort();
  }
  bufferevent_openssl_set_allow_dirty_shutdown(v36, 1);
  bufferevent_setwatermark(v37, 2, 0, 1024);
  bufferevent_setcb(v37, v85, v86, v87, v88);
  evhttp_connection_set_bufferevent(*(_DWORD *)(v2 + 96), v37);
LABEL_27:
  *(_DWORD *)(v2 + 100) = do_http_create_request(v2);
  sub_808AAB0(v4, a1 + 4);
  v16 = evhttp_make_request(*(_DWORD *)(v2 + 96), *(_DWORD *)(v2 + 100), *(_DWORD *)(v2 + 8), v91);
  v17 = v91 - 12;
  if ( (_DWORD *)(v91 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v64 = _InterlockedExchangeAdd((volatile signed __int32 *)(v91 - 4), 0xFFFFFFFF);
    }
    else
    {
      v66 = *(_DWORD *)(v91 - 4);
      *(_DWORD *)(v91 - 4) = v66 - 1;
      v64 = v66;
    }
    if ( v64 <= 0 )
    {
      v65 = (std::ios_base *)v16;
      std::string::_Rep::_M_destroy(v17, &v90);
      v16 = (int)v65;
    }
  }
  if ( v16 )
  {
    if ( log_level > 5 )
      goto LABEL_42;
    std::ios_base::ios_base((std::ios_base *)&v102);
    v102 = (int)&unk_80CF5C8;
    v103 = 0;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v109 = 0;
    v91 = dword_80CF674;
    *(int *)((char *)&v91 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)v4 + *(_DWORD *)(v91 - 12), 0);
    v91 = (int)&unk_80CF5DC;
    v102 = (int)&unk_80CF5F0;
    v92 = (int)&unk_80CF7F0;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    v98 = 0;
    std::locale::locale((std::locale *)&v99);
    v92 = (int)&unk_80CF588;
    v100 = 16;
    v101 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v102, &v92);
    v18 = std::__ostream_insert<char,std::char_traits<char>>(v4, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v18, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v18, "req_res == 0", 12);
    std::__ostream_insert<char,std::char_traits<char>>(v18, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v18, "proxy evhttp_make_request failed", 32);
    v89 = (int)&unk_80CF83C;
    v19 = *(_DWORD *)(v18 + 24);
    if ( v19 )
    {
      v20 = *(_DWORD *)(v18 + 16);
      LOBYTE(v76) = 0;
      if ( v19 <= (unsigned int)v20 )
      {
        v90 = std::string::_S_construct<char *>(v18, v1, (void *)v4, *(_DWORD *)(v18 + 20), v20, (int)&v88);
        std::string::swap((std::string *)&v89, (std::string *)&v90);
      }
      else
      {
        v90 = std::string::_S_construct<char *>(v18, v1, (void *)v4, *(_DWORD *)(v18 + 20), v19, (int)&v88);
        std::string::swap((std::string *)&v89, (std::string *)&v90);
      }
      v21 = v90 - 12;
      if ( (_DWORD *)(v90 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v68 = _InterlockedExchangeAdd((volatile signed __int32 *)(v90 - 4), 0xFFFFFFFF);
        }
        else
        {
          v68 = *(_DWORD *)(v90 - 4);
          *(_DWORD *)(v90 - 4) = v68 - 1;
        }
        if ( v68 <= 0 )
          std::string::_Rep::_M_destroy(v21, &v87);
      }
    }
    else
    {
      std::string::assign((std::string *)&v89, (const std::string *)(v18 + 40));
    }
    v91 = (int)&unk_80CF5DC;
    v102 = (int)&unk_80CF5F0;
    v92 = (int)&unk_80CF588;
    v22 = v101 - 12;
    if ( (_DWORD *)(v101 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v67 = _InterlockedExchangeAdd((volatile signed __int32 *)(v101 - 4), 0xFFFFFFFF);
      }
      else
      {
        v67 = *(_DWORD *)(v101 - 4);
        *(_DWORD *)(v101 - 4) = v67 - 1;
      }
      if ( v67 <= 0 )
        std::string::_Rep::_M_destroy(v22, &v90);
    }
    v92 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v99);
    v91 = dword_80CF674;
    *(int *)((char *)&v91 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v102 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v102);
    if ( byte_80CE64C )
    {
      v23 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v89, *(_DWORD *)(v89 - 12));
      v24 = (std::ostream *)v23;
      v25 = *(_DWORD *)(*(_DWORD *)v23 - 12);
      v26 = *(_DWORD *)((char *)v24 + v25 + 124);
      if ( !v26 )
      {
        v62 = std::__throw_bad_cast();
        goto LABEL_103;
      }
      if ( *(_BYTE *)(v26 + 28) )
      {
        v27 = *(_BYTE *)(v26 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v24 + v25 + 124));
        v27 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v26 + 24))(v26, 10);
      }
      v28 = (std::ostream *)std::ostream::put(v24, v27);
      std::ostream::flush(v28);
    }
    syslog(3, "%s", v89, v76);
    goto LABEL_41;
  }
}
// 804C3F0: using guessed type int __cdecl BIO_new_mem_buf(_DWORD, _DWORD);
// 804C460: using guessed type int __cdecl BIO_free(_DWORD);
// 804C4A0: using guessed type int sk_pop_free(_DWORD, const char *, ...);
// 804C570: using guessed type int __cdecl evhttp_make_request(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C590: using guessed type int __cdecl SSL_CTX_set_cert_verify_callback(_DWORD, _DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C6B0: using guessed type int __cdecl SSL_CTX_set_verify(_DWORD, _DWORD, _DWORD);
// 804C6D0: using guessed type int __cdecl evhttp_connection_get_bufferevent(_DWORD);
// 804C6E0: using guessed type int __cdecl bufferevent_setcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804C720: using guessed type int __cdecl sk_value(_DWORD, _DWORD);
// 804C780: using guessed type int __cdecl SSL_ctrl(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C7C0: using guessed type int __cdecl PEM_X509_INFO_read_bio(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C9B0: using guessed type int __cdecl std::operator<<<std::char_traits<char>>(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CAC0: using guessed type int __cdecl SSL_CTX_new(_DWORD);
// 804CB70: using guessed type int __cdecl bufferevent_openssl_set_allow_dirty_shutdown(_DWORD, _DWORD);
// 804CD30: using guessed type int __cdecl sk_num(_DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CDD0: using guessed type int __cdecl evhttp_connection_set_bufferevent(_DWORD, _DWORD);
// 804CE70: using guessed type int __cdecl bufferevent_setwatermark(_DWORD, _DWORD, _DWORD, _DWORD);
// 804CEA0: using guessed type int __cdecl SSL_new(_DWORD);
// 804CF10: using guessed type int __cdecl SSL_CTX_get_cert_store(_DWORD);
// 804CF20: using guessed type int __cdecl bufferevent_getcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804CFB0: using guessed type int __cdecl bufferevent_openssl_filter_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 804D480: using guessed type int __cdecl X509_STORE_add_cert(_DWORD, _DWORD);
// 804D4A0: using guessed type int SSLv23_method(void);
// 80BA86B: using guessed type char byte_80BA86B;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CE6A0: using guessed type int dword_80CE6A0;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (08079EC0) --------------------------------------------------------
void __cdecl sub_8079EC0(int a1, int a2)
{
  sub_8078970(a2);
}

//----- (08079ED0) --------------------------------------------------------
void __cdecl sub_8079ED0(int a1)
{
  int v1; // eax@3
  int v2; // ebp@5
  void *v3; // edi@6
  void *v4; // ebx@6
  int v5; // eax@7
  int v6; // edx@7
  unsigned int v7; // ebp@14
  int v8; // ebx@14
  int v9; // ebx@14
  int v10; // eax@14
  char *v11; // edi@15
  size_t v12; // eax@16
  int v13; // eax@18
  int v14; // edx@19
  int v15; // edx@21
  int v16; // edx@22
  int v17; // eax@24
  std::ostream *v18; // edi@24
  int v19; // eax@24
  int v20; // ebx@24
  char v21; // al@26
  std::ostream *v22; // eax@27
  int v23; // edx@28
  signed __int32 v24; // eax@30
  signed __int32 v25; // eax@39
  signed __int32 v26; // ecx@42
  signed __int32 v27; // ecx@43
  int v28; // ebx@44
  signed __int32 v29; // ebx@47
  signed __int32 v30; // ebx@51
  int v31; // [sp+Ch] [bp-F0h]@0
  int v32; // [sp+14h] [bp-E8h]@2
  char v33; // [sp+22h] [bp-DAh]@53
  char v34; // [sp+23h] [bp-D9h]@20
  int v35; // [sp+24h] [bp-D8h]@18
  int v36; // [sp+28h] [bp-D4h]@20
  unsigned int v37; // [sp+2Ch] [bp-D0h]@2
  int v38; // [sp+30h] [bp-CCh]@13
  int v39; // [sp+34h] [bp-C8h]@14
  int v40; // [sp+38h] [bp-C4h]@14
  int v41; // [sp+3Ch] [bp-C0h]@14
  int v42; // [sp+40h] [bp-BCh]@14
  int v43; // [sp+44h] [bp-B8h]@14
  int v44; // [sp+48h] [bp-B4h]@14
  char v45; // [sp+4Ch] [bp-B0h]@14
  int v46; // [sp+50h] [bp-ACh]@14
  int v47; // [sp+54h] [bp-A8h]@14
  int v48; // [sp+58h] [bp-A4h]@14
  int v49; // [sp+C8h] [bp-34h]@14
  char v50; // [sp+CCh] [bp-30h]@14
  char v51; // [sp+CDh] [bp-2Fh]@14
  int v52; // [sp+D0h] [bp-2Ch]@14
  int v53; // [sp+D4h] [bp-28h]@14
  int v54; // [sp+D8h] [bp-24h]@14
  int v55; // [sp+DCh] [bp-20h]@14

  if ( log_level > 1 )
  {
    v32 = (int)&v37;
    goto LABEL_3;
  }
  v32 = (int)&v37;
  std::ios_base::ios_base((std::ios_base *)&v48);
  v48 = (int)&unk_80CF5C8;
  v49 = 0;
  v50 = 0;
  v51 = 0;
  v52 = 0;
  v53 = 0;
  v54 = 0;
  v55 = 0;
  v7 = dword_80CF674;
  v37 = dword_80CF674;
  *(unsigned int *)((char *)&v37 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v37 + *(_DWORD *)(v37 - 12), 0);
  v37 = (unsigned int)&unk_80CF5DC;
  v48 = (int)&unk_80CF5F0;
  v38 = (int)&unk_80CF7F0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  v42 = 0;
  v43 = 0;
  v44 = 0;
  std::locale::locale((std::locale *)&v45);
  v38 = (int)&unk_80CF588;
  v46 = 16;
  v47 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v48, &v38);
  v8 = std::__ostream_insert<char,std::char_traits<char>>(&v37, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v8, "canceling request: ", 19);
  std::__ostream_insert<char,std::char_traits<char>>(v8, "[", 1);
  v9 = std::__ostream_insert<char,std::char_traits<char>>(
         v8,
         *(_DWORD *)(a1 + 12),
         *(_DWORD *)(*(_DWORD *)(a1 + 12) - 12));
  std::__ostream_insert<char,std::char_traits<char>>(v9, "] ", 2);
  v10 = *(_DWORD *)(a1 + 4);
  if ( v10 )
  {
    v11 = *(char **)(v10 + 8);
    if ( !v11 )
    {
      std::basic_ios<char,std::char_traits<char>>::clear(
        v9 + *(_DWORD *)(*(_DWORD *)v9 - 12),
        *(_DWORD *)(v9 + *(_DWORD *)(*(_DWORD *)v9 - 12) + 20) | 1);
      goto LABEL_18;
    }
    v12 = strlen(*(const char **)(v10 + 8));
  }
  else
  {
    v12 = 0;
    v11 = "";
  }
  std::__ostream_insert<char,std::char_traits<char>>(v9, v11, v12);
LABEL_18:
  v35 = (int)&unk_80CF83C;
  v13 = *(_DWORD *)(v9 + 24);
  if ( v13 )
  {
    v14 = *(_DWORD *)(v9 + 16);
    LOBYTE(v31) = 0;
    if ( v13 <= (unsigned int)v14 )
    {
      v36 = std::string::_S_construct<char *>(v9, v7, &v34, *(_DWORD *)(v9 + 20), v14, (int)&v34);
      std::string::swap((std::string *)&v35, (std::string *)&v36);
    }
    else
    {
      v36 = std::string::_S_construct<char *>(v9, v7, &v34, *(_DWORD *)(v9 + 20), v13, (int)&v34);
      std::string::swap((std::string *)&v35, (std::string *)&v36);
    }
    v15 = v36 - 12;
    if ( (_DWORD *)(v36 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v30 = _InterlockedExchangeAdd((volatile signed __int32 *)(v36 - 4), 0xFFFFFFFF);
      }
      else
      {
        v30 = *(_DWORD *)(v36 - 4);
        *(_DWORD *)(v36 - 4) = v30 - 1;
      }
      if ( v30 <= 0 )
        std::string::_Rep::_M_destroy(v15, &v33);
    }
  }
  else
  {
    std::string::assign((std::string *)&v35, (const std::string *)(v9 + 40));
  }
  v37 = (unsigned int)&unk_80CF5DC;
  v48 = (int)&unk_80CF5F0;
  v38 = (int)&unk_80CF588;
  v16 = v47 - 12;
  if ( (_DWORD *)(v47 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v29 = _InterlockedExchangeAdd((volatile signed __int32 *)(v47 - 4), 0xFFFFFFFF);
    }
    else
    {
      v29 = *(_DWORD *)(v47 - 4);
      *(_DWORD *)(v47 - 4) = v29 - 1;
    }
    if ( v29 <= 0 )
      std::string::_Rep::_M_destroy(v16, &v36);
  }
  v38 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v45);
  v37 = v7;
  *(unsigned int *)((char *)&v37 + *(_DWORD *)(v7 - 12)) = dword_80CF678;
  v48 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v48);
  if ( byte_80CE64C )
  {
    v17 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v35, *(_DWORD *)(v35 - 12));
    v18 = (std::ostream *)v17;
    v19 = *(_DWORD *)(*(_DWORD *)v17 - 12);
    v20 = *(_DWORD *)((char *)v18 + v19 + 124);
    if ( !v20 )
    {
      v28 = std::__throw_bad_cast();
      std::string::_Rep::_M_dispose(v35 - 12, &v37);
      Unwind_Resume(v28);
    }
    if ( *(_BYTE *)(v20 + 28) )
    {
      v21 = *(_BYTE *)(v20 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v18 + v19 + 124));
      v21 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v20 + 24))(v20, 10);
    }
    v22 = (std::ostream *)std::ostream::put(v18, v21);
    std::ostream::flush(v22);
  }
  syslog(7, "%s", v35, v31);
  v23 = v35 - 12;
  if ( (_DWORD *)(v35 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v35 - 4), 0xFFFFFFFF);
    }
    else
    {
      v27 = *(_DWORD *)(v35 - 4);
      *(_DWORD *)(v35 - 4) = v27 - 1;
      v24 = v27;
    }
    if ( v24 <= 0 )
      std::string::_Rep::_M_destroy(v23, &v37);
  }
LABEL_3:
  v1 = *(_DWORD *)(a1 + 124);
  if ( v1 )
  {
    if ( *(_DWORD *)(v1 + 12) )
    {
      *(_DWORD *)v1 = 0;
      evdns_getaddrinfo_cancel(*(_DWORD *)(*(_DWORD *)(a1 + 124) + 12));
      v2 = *(_DWORD *)(a1 + 124);
      *(_DWORD *)(a1 + 124) = 0;
      if ( v2 )
      {
        v3 = *(void **)(v2 + 20);
        v4 = *(void **)(v2 + 16);
        if ( v3 != v4 )
        {
          do
          {
            v5 = *(_DWORD *)v4;
            v6 = *(_DWORD *)v4 - 12;
            if ( (_DWORD *)v6 != &std::string::_Rep::_S_empty_rep_storage )
            {
              if ( &_pthread_key_create )
              {
                v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v5 - 4), 0xFFFFFFFF);
              }
              else
              {
                v26 = *(_DWORD *)(v5 - 4);
                *(_DWORD *)(v5 - 4) = v26 - 1;
                v25 = v26;
              }
              if ( v25 <= 0 )
                std::string::_Rep::_M_destroy(v6, v32);
            }
            v4 = (char *)v4 + 4;
          }
          while ( v3 != v4 );
          v3 = *(void **)(v2 + 16);
        }
        if ( v3 )
          operator delete(v3);
        evdns_base_free(*(_DWORD *)(v2 + 8), 1);
        operator delete((void *)v2);
      }
    }
  }
  v37 = *(_DWORD *)(a1 + 100);
  LOBYTE(v38) = 1;
  sub_80785C0(a1, v32);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804CA20: using guessed type int __cdecl evdns_getaddrinfo_cancel(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0807A530) --------------------------------------------------------
void __cdecl sub_807A530(int a1, int a2, int a3)
{
  sub_8079ED0(a3);
}

//----- (0807A540) --------------------------------------------------------
void __cdecl sub_807A540(int a1, int a2, int a3)
{
  int v3; // ebx@1
  int v4; // esi@1
  int v5; // eax@2
  int v6; // edx@2
  int v7; // eax@7
  int v8; // edx@9
  int v9; // eax@10
  int v10; // edx@13
  int v11; // eax@15
  signed __int32 v12; // eax@21
  signed __int32 v13; // ecx@24
  char v14; // [sp+2Ah] [bp-A2h]@23
  char v15; // [sp+2Bh] [bp-A1h]@9
  int v16; // [sp+2Ch] [bp-A0h]@9
  int v17; // [sp+30h] [bp-9Ch]@7
  char v18; // [sp+34h] [bp-98h]@19

  v3 = a3;
  v4 = *(_DWORD *)(a1 + 124);
  if ( a2 || !a3 )
    goto LABEL_2;
  do
  {
    v11 = *(_DWORD *)(v3 + 4);
    if ( v11 == 2 )
    {
      v7 = evutil_inet_ntop(2, *(_DWORD *)(v3 + 20) + 4, &v17, 128);
    }
    else
    {
      if ( v11 != 10 )
        goto LABEL_14;
      v7 = evutil_inet_ntop(10, *(_DWORD *)(v3 + 20) + 8, &v17, 128);
    }
    if ( v7 )
    {
      std::string::string(&v16, v7, &v15);
      v8 = *(_DWORD *)(v4 + 20);
      if ( v8 == *(_DWORD *)(v4 + 24) )
      {
        sub_8058720(v4 + 16, (int)&v16);
        v9 = v16;
      }
      else
      {
        v9 = v16;
        if ( v8 )
        {
          *(_DWORD *)v8 = v16;
          v16 = (int)&unk_80CF83C;
          v8 = *(_DWORD *)(v4 + 20);
          v9 = (int)&unk_80CF83C;
        }
        *(_DWORD *)(v4 + 20) = v8 + 4;
      }
      v10 = v9 - 12;
      if ( (_DWORD *)(v9 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v12 = _InterlockedExchangeAdd((volatile signed __int32 *)(v9 - 4), 0xFFFFFFFF);
        }
        else
        {
          v13 = *(_DWORD *)(v9 - 4);
          *(_DWORD *)(v9 - 4) = v13 - 1;
          v12 = v13;
        }
        if ( v12 <= 0 )
          std::string::_Rep::_M_destroy(v10, &v14);
      }
    }
LABEL_14:
    v3 = *(_DWORD *)(v3 + 28);
  }
  while ( v3 );
  v4 = *(_DWORD *)(a1 + 124);
LABEL_2:
  *(_DWORD *)(v4 + 28) = 0;
  v5 = *(_DWORD *)(a1 + 124);
  v6 = *(_DWORD *)(v5 + 16);
  if ( *(_DWORD *)(v5 + 20) == v6 )
  {
    v17 = 0;
    v18 = 0;
    sub_80785C0(a1, (int)&v17);
  }
  else
  {
    std::string::assign((std::string *)(a1 + 12), (const std::string *)(v6 + 4 * *(_DWORD *)(v5 + 28)));
    sub_8075330(a1);
  }
}
// 804C480: using guessed type int __cdecl evutil_inet_ntop(_DWORD, _DWORD, _DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0807A760) --------------------------------------------------------
void __cdecl sub_807A760(int a1, int a2, int a3)
{
  int v3; // ecx@0
  int v4; // edx@1

  v4 = a1;
  if ( a3 )
  {
    *(_DWORD *)(a3 + 12) = 0;
    if ( *(_DWORD *)a3 )
      sub_807A540(*(_DWORD *)a3, a1, a2);
  }
  if ( a2 )
    evutil_freeaddrinfo(v3, v4);
}
// 804C7E0: using guessed type int __fastcall evutil_freeaddrinfo(_DWORD, _DWORD);

//----- (0807A7C0) --------------------------------------------------------
int __cdecl sub_807A7C0(int a1, int a2, int a3, int a4)
{
  int v4; // ebx@1
  int v5; // ecx@1
  __time_t v6; // ST18_4@3
  __suseconds_t v7; // ST1C_4@3
  __suseconds_t v8; // edx@3
  int v9; // eax@3
  int v10; // edx@3
  int v11; // ecx@5
  __time_t v12; // eax@7
  __suseconds_t v13; // edx@7
  __suseconds_t v14; // ebp@7
  int v15; // eax@7
  int v16; // edx@7
  int result; // eax@12
  struct event *v18; // eax@14
  int v19; // eax@15
  int v20; // edi@15
  int v21; // eax@15
  void *v22; // ecx@18
  void *v23; // edi@19
  void *v24; // esi@19
  int v25; // eax@20
  int v26; // edx@20
  void *v27; // ST18_4@24
  void *v28; // ST18_4@25
  int v29; // esi@25
  int v30; // eax@26
  int v31; // edx@27
  __time_t v32; // ecx@29
  int v33; // esi@34
  int v34; // eax@34
  int v35; // edx@35
  int v36; // edx@37
  int v37; // edx@38
  std::ostream *v38; // esi@40
  char v39; // al@42
  std::ostream *v40; // eax@43
  int v41; // edx@44
  signed __int32 v42; // eax@46
  signed __int32 v43; // eax@53
  void *v44; // ST18_4@55
  std::runtime_error *v45; // ebx@56
  signed __int32 v46; // edx@60
  int v47; // ST18_4@62
  signed __int32 v48; // esi@63
  void *v49; // ST18_4@64
  signed __int32 v50; // esi@64
  signed __int32 v51; // ecx@65
  int v52; // ebx@66
  signed __int32 v53; // esi@68
  signed __int32 v54; // esi@72
  int v55; // [sp+Ch] [bp-F0h]@0
  void *v56; // [sp+18h] [bp-E4h]@40
  char v57; // [sp+21h] [bp-DBh]@66
  char v58; // [sp+22h] [bp-DAh]@74
  char v59; // [sp+23h] [bp-D9h]@36
  int v60; // [sp+24h] [bp-D8h]@34
  int v61; // [sp+28h] [bp-D4h]@28
  struct timeval v62; // [sp+2Ch] [bp-D0h]@2
  int v63; // [sp+34h] [bp-C8h]@2
  int v64; // [sp+38h] [bp-C4h]@2
  int v65; // [sp+3Ch] [bp-C0h]@34
  int v66; // [sp+40h] [bp-BCh]@34
  int v67; // [sp+44h] [bp-B8h]@34
  int v68; // [sp+48h] [bp-B4h]@34
  char v69; // [sp+4Ch] [bp-B0h]@34
  int v70; // [sp+50h] [bp-ACh]@34
  int v71; // [sp+54h] [bp-A8h]@34
  int v72; // [sp+58h] [bp-A4h]@34
  int v73; // [sp+C8h] [bp-34h]@34
  char v74; // [sp+CCh] [bp-30h]@34
  char v75; // [sp+CDh] [bp-2Fh]@34
  int v76; // [sp+D0h] [bp-2Ch]@34
  int v77; // [sp+D4h] [bp-28h]@34
  int v78; // [sp+D8h] [bp-24h]@34
  int v79; // [sp+DCh] [bp-20h]@34

  v4 = a1;
  *(_DWORD *)(a1 + 88) = a2;
  v5 = *(_DWORD *)(a3 + 8);
  if ( v5 )
  {
    v64 = *(_DWORD *)(a3 + 12);
    v63 = v5;
    ((void (__cdecl *)(struct timeval *, int, signed int))v5)(&v62, a3, 2);
    v5 = v63;
  }
  v6 = v62.tv_sec;
  v7 = v62.tv_usec;
  v8 = *(_DWORD *)(a1 + 60);
  v62.tv_sec = *(_DWORD *)(a1 + 56);
  v62.tv_usec = v8;
  *(_DWORD *)(a1 + 56) = v6;
  *(_DWORD *)(a1 + 60) = v7;
  v63 = *(_DWORD *)(a1 + 64);
  v9 = v63;
  *(_DWORD *)(a1 + 64) = v5;
  v10 = v64;
  v64 = *(_DWORD *)(a1 + 68);
  *(_DWORD *)(a1 + 68) = v10;
  if ( v9 )
    ((void (__cdecl *)(struct timeval *, struct timeval *, signed int))v9)(&v62, &v62, 3);
  v11 = *(_DWORD *)(a4 + 8);
  if ( v11 )
  {
    v64 = *(_DWORD *)(a4 + 12);
    v63 = v11;
    ((void (__cdecl *)(struct timeval *, int, signed int))v11)(&v62, a4, 2);
    v11 = v63;
  }
  v12 = v62.tv_sec;
  v13 = v62.tv_usec;
  v14 = *(_DWORD *)(a1 + 44);
  v62.tv_sec = *(_DWORD *)(a1 + 40);
  v62.tv_usec = v14;
  *(_DWORD *)(a1 + 40) = v12;
  *(_DWORD *)(a1 + 44) = v13;
  v63 = *(_DWORD *)(a1 + 48);
  v15 = v63;
  *(_DWORD *)(a1 + 48) = v11;
  v16 = v64;
  v64 = *(_DWORD *)(a1 + 52);
  *(_DWORD *)(a1 + 52) = v16;
  if ( v15 )
    ((void (__cdecl *)(struct timeval *, struct timeval *, signed int))v15)(&v62, &v62, 3);
  if ( *(_DWORD *)(a1 + 24) )
  {
    v18 = (struct event *)event_new(*(_DWORD *)(a2 + 4), -1, 1, sub_807A530, a1);
    *(_DWORD *)(a1 + 32) = v18;
    v62.tv_usec = 0;
    v62.tv_sec = *(_DWORD *)(a1 + 24);
    event_add(v18, &v62);
  }
  if ( *(_DWORD *)(*(_DWORD *)(a1 + 12) - 12) || *(_DWORD *)(a1 + 108) )
  {
    result = sub_8075330(a1);
  }
  else
  {
    v19 = operator new(0x20u);
    v20 = v19;
    *(_DWORD *)v19 = a1;
    *(_DWORD *)(v19 + 4) = *(_DWORD *)(a1 + 20);
    v21 = evdns_base_new(*(_DWORD *)(a2 + 4), 32769);
    *(_DWORD *)(v20 + 8) = v21;
    if ( !v21 )
    {
      v45 = (std::runtime_error *)_cxa_allocate_exception(8);
      std::string::string(&v61, "Event DNS initialization failed", &v62);
      std::runtime_error::runtime_error(v45, (const std::string *)&v61);
      *(_DWORD *)v45 = &off_80BAB18;
      std::string::_Rep::_M_dispose(v61 - 12, &v60);
      _cxa_throw(v45, &off_80BAADC, sub_807B6C0);
    }
    if ( evdns_base_set_option(v21, "randomize-case", 134981637) && log_level <= 5 )
    {
      std::ios_base::ios_base((std::ios_base *)&v72);
      v72 = (int)&unk_80CF5C8;
      v73 = 0;
      v74 = 0;
      v75 = 0;
      v76 = 0;
      v77 = 0;
      v78 = 0;
      v79 = 0;
      v62.tv_sec = dword_80CF674;
      *(__time_t *)((char *)&v62.tv_sec + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v62 + *(_DWORD *)(v62.tv_sec - 12), 0);
      v62.tv_sec = (__time_t)&unk_80CF5DC;
      v72 = (int)&unk_80CF5F0;
      v62.tv_usec = (__suseconds_t)&unk_80CF7F0;
      v63 = 0;
      v64 = 0;
      v65 = 0;
      v66 = 0;
      v67 = 0;
      v68 = 0;
      std::locale::locale((std::locale *)&v69);
      v62.tv_usec = (__suseconds_t)&unk_80CF588;
      v70 = 16;
      v71 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v72, &v62.tv_usec);
      v33 = std::__ostream_insert<char,std::char_traits<char>>(
              &v62,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v33, "Event DNS failed to drop randomize-case option", 46);
      v60 = (int)&unk_80CF83C;
      v34 = *(_DWORD *)(v33 + 24);
      if ( v34 )
      {
        v35 = *(_DWORD *)(v33 + 16);
        LOBYTE(v55) = 0;
        if ( v34 <= (unsigned int)v35 )
        {
          v61 = std::string::_S_construct<char *>(
                  a1,
                  (unsigned int)&v62,
                  (void *)v20,
                  *(_DWORD *)(v33 + 20),
                  v35,
                  (int)&v59);
          std::string::swap((std::string *)&v60, (std::string *)&v61);
        }
        else
        {
          v61 = std::string::_S_construct<char *>(
                  a1,
                  (unsigned int)&v62,
                  (void *)v20,
                  *(_DWORD *)(v33 + 20),
                  v34,
                  (int)&v59);
          std::string::swap((std::string *)&v60, (std::string *)&v61);
        }
        v36 = v61 - 12;
        if ( (_DWORD *)(v61 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v54 = _InterlockedExchangeAdd((volatile signed __int32 *)(v61 - 4), 0xFFFFFFFF);
          }
          else
          {
            v54 = *(_DWORD *)(v61 - 4);
            *(_DWORD *)(v61 - 4) = v54 - 1;
          }
          if ( v54 <= 0 )
            std::string::_Rep::_M_destroy(v36, &v58);
        }
      }
      else
      {
        std::string::assign((std::string *)&v60, (const std::string *)(v33 + 40));
      }
      v62.tv_sec = (__time_t)&unk_80CF5DC;
      v72 = (int)&unk_80CF5F0;
      v62.tv_usec = (__suseconds_t)&unk_80CF588;
      v37 = v71 - 12;
      if ( (_DWORD *)(v71 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v53 = _InterlockedExchangeAdd((volatile signed __int32 *)(v71 - 4), 0xFFFFFFFF);
        }
        else
        {
          v53 = *(_DWORD *)(v71 - 4);
          *(_DWORD *)(v71 - 4) = v53 - 1;
        }
        if ( v53 <= 0 )
          std::string::_Rep::_M_destroy(v37, &v61);
      }
      v62.tv_usec = (__suseconds_t)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v69);
      v62.tv_sec = dword_80CF674;
      *(__time_t *)((char *)&v62.tv_sec + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v72 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v72);
      if ( byte_80CE64C )
      {
        v38 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v60, *(_DWORD *)(v60 - 12));
        v56 = *(void **)((char *)v38 + *(_DWORD *)(*(_DWORD *)v38 - 12) + 124);
        if ( !v56 )
        {
          v52 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v60 - 12, &v57);
          operator delete((void *)v20);
          Unwind_Resume(v52);
        }
        if ( *((_BYTE *)v56 + 28) )
        {
          v39 = *((_BYTE *)v56 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(v56);
          v39 = (*(int (__cdecl **)(void *, signed int))(*(_DWORD *)v56 + 24))(v56, 10);
        }
        v40 = (std::ostream *)std::ostream::put(v38, v39);
        std::ostream::flush(v40);
      }
      syslog(3, "%s", v60, v55);
      v41 = v60 - 12;
      if ( (_DWORD *)(v60 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v42 = _InterlockedExchangeAdd((volatile signed __int32 *)(v60 - 4), 0xFFFFFFFF);
        }
        else
        {
          v51 = *(_DWORD *)(v60 - 4);
          *(_DWORD *)(v60 - 4) = v51 - 1;
          v42 = v51;
        }
        if ( v42 <= 0 )
          std::string::_Rep::_M_destroy(v41, &v62);
      }
    }
    *(_DWORD *)(v20 + 12) = 0;
    *(_DWORD *)(v20 + 16) = 0;
    *(_DWORD *)(v20 + 20) = 0;
    *(_DWORD *)(v20 + 24) = 0;
    *(_DWORD *)(v20 + 28) = 0;
    v22 = *(void **)(a1 + 124);
    *(_DWORD *)(a1 + 124) = v20;
    if ( v22 )
    {
      v23 = (void *)*((_DWORD *)v22 + 5);
      v24 = (void *)*((_DWORD *)v22 + 4);
      if ( v23 != v24 )
      {
        do
        {
          v25 = *(_DWORD *)v24;
          v26 = *(_DWORD *)v24 - 12;
          if ( (_DWORD *)v26 != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v43 = _InterlockedExchangeAdd((volatile signed __int32 *)(v25 - 4), 0xFFFFFFFF);
            }
            else
            {
              v49 = v24;
              v50 = *(_DWORD *)(v25 - 4);
              *(_DWORD *)(v25 - 4) = v50 - 1;
              v43 = v50;
              v24 = v49;
            }
            if ( v43 <= 0 )
            {
              v44 = v22;
              std::string::_Rep::_M_destroy(v26, &v62);
              v22 = v44;
            }
          }
          v24 = (char *)v24 + 4;
        }
        while ( v23 != v24 );
        v4 = a1;
        v23 = (void *)*((_DWORD *)v22 + 4);
      }
      if ( v23 )
      {
        v27 = v22;
        operator delete(v23);
        v22 = v27;
      }
      v28 = v22;
      evdns_base_free(*((_DWORD *)v22 + 2), 1);
      operator delete(v28);
      v29 = *(_DWORD *)(v4 + 124);
    }
    else
    {
      v29 = v20;
    }
    v30 = *(_DWORD *)(v4 + 4);
    if ( v30 && (v31 = *(_DWORD *)(v30 + 32)) != 0 )
      std::string::string(&v62, *(_DWORD *)(v30 + 28), v31, &v61);
    else
      std::string::string((std::string *)&v62, (const std::string *)&dword_80CF8FC);
    result = sub_807BE90(*(_DWORD *)(v4 + 124) + 4, (char *)v62.tv_sec, (int)sub_807A760, v29);
    v32 = v62.tv_sec - 12;
    if ( (_DWORD *)(v62.tv_sec - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v62.tv_sec - 4), 0xFFFFFFFF);
      }
      else
      {
        v48 = *(_DWORD *)(v62.tv_sec - 4);
        *(_DWORD *)(v62.tv_sec - 4) = v48 - 1;
        v46 = v48;
      }
      if ( v46 <= 0 )
      {
        v47 = result;
        std::string::_Rep::_M_destroy(v32, &v61);
        result = v47;
      }
    }
    if ( result )
      *(_DWORD *)(*(_DWORD *)(v4 + 124) + 12) = result;
  }
  return result;
}
// 804C450: using guessed type int __cdecl evdns_base_new(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CEF0: using guessed type int __cdecl _cxa_allocate_exception(_DWORD);
// 804D090: using guessed type int __cdecl evdns_base_set_option(_DWORD, _DWORD, _DWORD);
// 804D0B0: using guessed type int __cdecl _cxa_throw(_DWORD, _DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D2B0: using guessed type int __cdecl event_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80BAADC: using guessed type void *off_80BAADC;
// 80BAB18: using guessed type void *off_80BAB18;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (0807B190) --------------------------------------------------------
int __userpurge sub_807B190@<eax>(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int v7; // eax@2
  bool v8; // zf@2
  int v9; // eax@5
  bool v10; // zf@5
  int v11; // eax@9
  std::runtime_error *v13; // esi@23
  int v14; // [sp+28h] [bp-C0h]@2
  int v15; // [sp+2Ch] [bp-BCh]@2
  char v16; // [sp+30h] [bp-B8h]@1
  struct event_base *v17; // [sp+34h] [bp-B4h]@1
  int v18; // [sp+38h] [bp-B0h]@1
  int v19; // [sp+3Ch] [bp-ACh]@1
  int v20; // [sp+40h] [bp-A8h]@9
  int (__cdecl *v21)(void **, void **, signed int); // [sp+48h] [bp-A0h]@9
  int (__cdecl *v22)(int, int); // [sp+4Ch] [bp-9Ch]@9
  int v23; // [sp+50h] [bp-98h]@2
  int v24; // [sp+54h] [bp-94h]@2
  int v25; // [sp+58h] [bp-90h]@7
  int v26; // [sp+68h] [bp-80h]@7
  int v27; // [sp+B8h] [bp-30h]@7

  v16 = 0;
  v17 = (struct event_base *)event_base_new();
  v18 = 0;
  v19 = 0;
  if ( !v17 )
  {
    v13 = (std::runtime_error *)_cxa_allocate_exception(8);
    std::string::string(&v23, "Event dispatcher initialization failed", &v20);
    std::runtime_error::runtime_error(v13, (const std::string *)&v23);
    *(_DWORD *)v13 = &off_80BAB18;
    std::string::_Rep::_M_dispose(v23 - 12, &v15);
    _cxa_throw(v13, &off_80BAADC, sub_807B6C0);
  }
  HttpClient::HttpClient((int)&v23);
  v15 = *(_DWORD *)a3;
  sub_807B750((int)&v14, (int)&v15);
  v7 = v24;
  v8 = v24 == 0;
  if ( v24 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v24 + 4));
    if ( v8 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v7 + 4))(v7);
  }
  v24 = v14;
  if ( v14 )
  {
    _InterlockedIncrement((volatile signed __int32 *)(v14 + 4));
    v9 = v14;
    v10 = v14 == 0;
    if ( v14 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v14 + 4));
      if ( v10 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v9 + 4))(v9);
    }
  }
  v25 = a2;
  v27 = a5;
  v26 = a7;
  if ( *(_DWORD *)(a4 + 8) )
    (*(void (__cdecl **)(int, int *))(a4 + 12))(a4, &v23);
  *(_DWORD *)a1 = 0;
  *(_DWORD *)(a1 + 4) = &unk_80CF83C;
  v21 = 0;
  v11 = operator new(8u);
  *(_DWORD *)v11 = a1;
  *(_DWORD *)(v11 + 4) = &v16;
  v20 = v11;
  v22 = sub_8072080;
  v21 = sub_8071FE0;
  sub_807A7C0((int)&v23, (int)&v16, (int)&v20, a6);
  if ( v21 )
    v21((void **)&v20, (void **)&v20, 3);
  if ( v17 && !v16 )
    event_base_dispatch(v17);
  sub_80725E0((int)&v23);
  if ( v17 )
    event_base_free(v17);
  if ( v18 )
    SSL_CTX_free(v18);
  if ( v19 )
    SSL_CTX_free(v19);
  return a1;
}
// 804C510: using guessed type int __cdecl event_base_free(_DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CEF0: using guessed type int __cdecl _cxa_allocate_exception(_DWORD);
// 804D010: using guessed type int event_base_new(void);
// 804D0B0: using guessed type int __cdecl _cxa_throw(_DWORD, _DWORD, _DWORD);
// 804D400: using guessed type int __cdecl SSL_CTX_free(_DWORD);
// 8072080: using guessed type int __cdecl sub_8072080(int, int);
// 80BAADC: using guessed type void *off_80BAADC;
// 80BAB18: using guessed type void *off_80BAB18;

//----- (0807B550) --------------------------------------------------------
int __userpurge sub_807B550@<eax>(int a1, int a2, int a3, int a4, int a5, int a6)
{
  sub_807B190(a1, 2, a2, a3, a4, a5, a6);
  return a1;
}

//----- (0807B640) --------------------------------------------------------
int __cdecl sub_807B640(int a1, int a2, int a3)
{
  int result; // eax@1
  char v4; // [sp+10h] [bp-1Ch]@1
  int v5; // [sp+18h] [bp-14h]@1

  v5 = 0;
  sub_807A7C0(a1, a2, a3, (int)&v4);
  result = v5;
  if ( v5 )
    result = ((int (__cdecl *)(char *, char *, signed int))v5)(&v4, &v4, 3);
  return result;
}

//----- (0807B6C0) --------------------------------------------------------
int __cdecl sub_807B6C0(std::runtime_error *a1)
{
  *(_DWORD *)a1 = &off_80BAB18;
  return std::runtime_error::~runtime_error(a1);
}
// 80BAB18: using guessed type void *off_80BAB18;

//----- (0807B6D0) --------------------------------------------------------
void __cdecl sub_807B6D0(std::runtime_error *a1)
{
  *(_DWORD *)a1 = &off_80BAB18;
  std::runtime_error::~runtime_error(a1);
  operator delete((void *)a1);
}
// 80BAB18: using guessed type void *off_80BAB18;

//----- (0807B700) --------------------------------------------------------
int __cdecl sub_807B700(int a1)
{
  int result; // eax@5

  if ( *(_DWORD *)(a1 + 4) )
    event_base_free(*(_DWORD *)(a1 + 4));
  if ( *(_DWORD *)(a1 + 8) )
    SSL_CTX_free(*(_DWORD *)(a1 + 8));
  result = *(_DWORD *)(a1 + 12);
  if ( result )
    result = SSL_CTX_free(*(_DWORD *)(a1 + 12));
  return result;
}
// 804C510: using guessed type int __cdecl event_base_free(_DWORD);
// 804D400: using guessed type int __cdecl SSL_CTX_free(_DWORD);

//----- (0807B750) --------------------------------------------------------
int __userpurge sub_807B750@<eax>(int a1, int a2)
{
  int v2; // ebx@1
  int v3; // edx@1
  signed __int32 v5; // eax@4
  signed __int32 v6; // ecx@7
  char v7; // [sp+1Ah] [bp-12h]@1
  char v8; // [sp+1Bh] [bp-11h]@6
  int v9; // [sp+1Ch] [bp-10h]@1

  std::string::string(&v9, *(_DWORD *)a2, &v7);
  v2 = operator new(0x2Cu);
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)v2 = &off_80BA2F8;
  std::string::string((std::string *)(v2 + 8), (const std::string *)&v9);
  *(_DWORD *)(v2 + 12) = 0;
  *(_DWORD *)(v2 + 16) = 0;
  *(_DWORD *)(v2 + 20) = 0;
  *(_DWORD *)(v2 + 24) = 0;
  *(_DWORD *)(v2 + 28) = 0;
  *(_DWORD *)(v2 + 32) = 0;
  *(_DWORD *)(v2 + 36) = 0;
  *(_DWORD *)(v2 + 40) = 0;
  sub_808ABF0(v2, *(char **)(v2 + 8));
  *(_DWORD *)a1 = v2;
  _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
  v3 = v9 - 12;
  if ( (_DWORD *)(v9 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v5 = _InterlockedExchangeAdd((volatile signed __int32 *)(v9 - 4), 0xFFFFFFFF);
    }
    else
    {
      v6 = *(_DWORD *)(v9 - 4);
      *(_DWORD *)(v9 - 4) = v6 - 1;
      v5 = v6;
    }
    if ( v5 <= 0 )
      std::string::_Rep::_M_destroy(v3, &v8);
  }
  return a1;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80BA2F8: using guessed type void *off_80BA2F8;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0807B8A0) --------------------------------------------------------
void __cdecl sub_807B8A0(int a1)
{
  void *v1; // esi@1
  void *v2; // ebx@1
  int v3; // eax@2
  int v4; // edx@2
  signed __int32 v5; // ecx@9
  char v6; // [sp+1Fh] [bp-1Dh]@11

  v1 = *(void **)(a1 + 4);
  v2 = *(void **)a1;
  if ( v1 != *(void **)a1 )
  {
    do
    {
      v3 = *(_DWORD *)v2;
      v4 = *(_DWORD *)v2 - 12;
      if ( (_DWORD *)v4 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v5 = _InterlockedExchangeAdd((volatile signed __int32 *)(v3 - 4), 0xFFFFFFFF);
        }
        else
        {
          v5 = *(_DWORD *)(v3 - 4);
          *(_DWORD *)(v3 - 4) = v5 - 1;
        }
        if ( v5 <= 0 )
          std::string::_Rep::_M_destroy(v4, &v6);
      }
      v2 = (char *)v2 + 4;
    }
    while ( v1 != v2 );
    v1 = *(void **)a1;
  }
  if ( v1 )
    operator delete(v1);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0807B930) --------------------------------------------------------
void __cdecl sub_807B930(int a1, void *a2)
{
  if ( *(_DWORD *)(a1 + 8) )
  {
    (*(void (**)(void))(a1 + 12))();
  }
  else
  {
    std::__throw_bad_function_call();
    sub_807B960(a1, a2);
  }
}

//----- (0807B960) --------------------------------------------------------
void __cdecl sub_807B960(int a1, void *a2)
{
  void *v2; // ebx@1
  void *v3; // esi@4

  v2 = a2;
  if ( a2 )
  {
    while ( 1 )
    {
      sub_807B960(a1, *((void **)v2 + 3));
      v3 = (void *)*((_DWORD *)v2 + 2);
      operator delete(v2);
      if ( !v3 )
        break;
      v2 = v3;
    }
  }
}

//----- (0807B9B0) --------------------------------------------------------
int __userpurge sub_807B9B0@<eax>(int a1, int a2, int a3)
{
  int v3; // esi@1
  int v4; // ecx@2
  int v5; // eax@3
  char v6; // bp@3
  int v7; // edx@8
  int v9; // eax@12
  signed int v10; // ebp@16
  int v11; // esi@17
  int v12; // [sp+18h] [bp-24h]@1
  int v13; // [sp+1Ch] [bp-20h]@17

  v3 = *(_DWORD *)(a2 + 8);
  v12 = a2 + 4;
  if ( !v3 )
  {
    v3 = a2 + 4;
    goto LABEL_11;
  }
  v4 = *(_DWORD *)a3;
  while ( *(_DWORD *)(v3 + 16) > v4 )
  {
    v5 = *(_DWORD *)(v3 + 8);
    v6 = 1;
    if ( !v5 )
      goto LABEL_7;
LABEL_4:
    v3 = v5;
  }
  v5 = *(_DWORD *)(v3 + 12);
  v6 = 0;
  if ( v5 )
    goto LABEL_4;
LABEL_7:
  if ( !v6 )
  {
    v7 = v3;
    if ( *(_DWORD *)(v3 + 16) >= v4 )
      goto LABEL_9;
LABEL_13:
    if ( !v7 )
    {
      v3 = 0;
      goto LABEL_9;
    }
LABEL_15:
    if ( v12 == v7 )
      v10 = 1;
    else
      v10 = *(_DWORD *)a3 < *(_DWORD *)(v7 + 16);
    v13 = v7;
    v11 = operator new(0x14u);
    if ( v11 )
    {
      memset((void *)v11, 0, 0x10u);
      *(_DWORD *)(v11 + 16) = *(_DWORD *)a3;
    }
    std::_Rb_tree_insert_and_rebalance(v10, v11, v13, v12);
    ++*(_DWORD *)(a2 + 20);
    *(_DWORD *)a1 = v11;
    *(_BYTE *)(a1 + 4) = 1;
    return a1;
  }
LABEL_11:
  v7 = *(_DWORD *)(a2 + 12);
  if ( v7 == v3 )
    goto LABEL_15;
  v9 = std::_Rb_tree_decrement(v3);
  v7 = v3;
  v3 = v9;
  if ( *(_DWORD *)(v9 + 16) < *(_DWORD *)a3 )
    goto LABEL_13;
LABEL_9:
  *(_DWORD *)a1 = v3;
  *(_BYTE *)(a1 + 4) = 0;
  return a1;
}
// 804C820: using guessed type int __cdecl std::_Rb_tree_decrement(_DWORD);
// 804CE00: using guessed type int __cdecl std::_Rb_tree_insert_and_rebalance(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0807BAF0) --------------------------------------------------------
int __usercall sub_807BAF0@<eax>(int a1@<edx>, int a2, int a3, int a4)
{
  signed __int32 v4; // ecx@1
  int v5; // esi@1
  int result; // eax@2
  int v7; // ebx@5
  int v8; // eax@8
  int v9; // edx@10
  int v10; // eax@11
  int v11; // eax@16
  signed __int32 v12; // [sp+1Ch] [bp-B0h]@1
  char v13; // [sp+2Ah] [bp-A2h]@23
  char v14; // [sp+2Bh] [bp-A1h]@10
  int v15; // [sp+2Ch] [bp-A0h]@10
  char v16; // [sp+30h] [bp-9Ch]@8

  v4 = *(_DWORD *)a4;
  v12 = *(_DWORD *)a4;
  v5 = *(_DWORD *)(a4 + 4);
  if ( a2 )
    goto LABEL_2;
  v7 = a3;
  if ( a3 )
  {
    while ( 1 )
    {
      v11 = *(_DWORD *)(v7 + 4);
      if ( v11 == 2 )
        break;
      if ( v11 == 10 )
      {
        v8 = evutil_inet_ntop(10, *(_DWORD *)(v7 + 20) + 8, &v16, 128);
        goto LABEL_9;
      }
LABEL_15:
      v7 = *(_DWORD *)(v7 + 28);
      if ( !v7 )
        goto LABEL_18;
    }
    v8 = evutil_inet_ntop(2, *(_DWORD *)(v7 + 20) + 4, &v16, 128);
LABEL_9:
    if ( v8 )
    {
      std::string::string(&v15, v8, &v14);
      v9 = *(_DWORD *)(v5 + 4);
      if ( v9 == *(_DWORD *)(v5 + 8) )
      {
        sub_8058720(v5, (int)&v15);
        v10 = v15;
      }
      else
      {
        v10 = v15;
        if ( v9 )
        {
          *(_DWORD *)v9 = v15;
          v15 = (int)&unk_80CF83C;
          v9 = *(_DWORD *)(v5 + 4);
          v10 = (int)&unk_80CF83C;
        }
        *(_DWORD *)(v5 + 4) = v9 + 4;
      }
      a1 = v10 - 12;
      if ( (_DWORD *)(v10 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v4 = _InterlockedExchangeAdd((volatile signed __int32 *)(v10 - 4), 0xFFFFFFFF);
        }
        else
        {
          v4 = *(_DWORD *)(v10 - 4);
          *(_DWORD *)(v10 - 4) = v4 - 1;
        }
        if ( v4 <= 0 )
          std::string::_Rep::_M_destroy(a1, &v13);
      }
    }
    goto LABEL_15;
  }
LABEL_18:
  evutil_freeaddrinfo(v4, a1);
LABEL_2:
  result = *(_DWORD *)(v12 + 4);
  if ( result )
  {
    result = event_base_loopbreak(*(_DWORD *)(v12 + 4));
    *(_BYTE *)v12 = 1;
  }
  return result;
}
// 804C480: using guessed type int __cdecl evutil_inet_ntop(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C7E0: using guessed type int __fastcall evutil_freeaddrinfo(_DWORD, _DWORD);
// 804CA60: using guessed type int __cdecl event_base_loopbreak(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0807BE90) --------------------------------------------------------
int __cdecl sub_807BE90(int a1, char *a2, int a3, int a4)
{
  size_t v4; // eax@1
  size_t v5; // esi@2
  int v6; // eax@4
  int result; // eax@7
  int v8; // ebx@9
  int v9; // edi@10
  int v10; // eax@11
  int v11; // ST18_4@16
  int v12; // esi@18
  int v13; // ebx@18
  size_t v14; // eax@18
  int v15; // eax@18
  int v16; // edx@19
  int *v17; // ebx@20
  int v18; // eax@20
  int v19; // eax@23
  std::ostream *v20; // esi@23
  int v21; // eax@23
  int v22; // edi@23
  char v23; // al@25
  std::ostream *v24; // eax@26
  int v25; // edx@27
  signed __int32 v26; // eax@29
  void *v27; // eax@33
  int v28; // edx@33
  void *v29; // edx@35
  unsigned int v30; // esi@35
  int v31; // eax@35
  unsigned int v32; // ecx@35
  int v33; // ebx@37
  char *v34; // eax@38
  int v35; // ecx@47
  int v36; // edx@50
  int v37; // edi@60
  int v38; // esi@60
  size_t v39; // eax@60
  int v40; // edx@60
  int v41; // ecx@61
  unsigned int v42; // eax@61
  int v43; // eax@64
  int v44; // edx@65
  int v45; // esi@67
  int v46; // esi@68
  int v47; // eax@70
  std::ostream *v48; // edi@70
  int v49; // eax@70
  int v50; // esi@70
  char v51; // al@72
  std::ostream *v52; // eax@73
  int v53; // edx@74
  signed __int32 v54; // eax@76
  signed __int32 v55; // ecx@81
  char *fmt; // ST04_4@88
  int v57; // ebx@93
  int *v58; // eax@93
  signed __int32 v59; // ecx@96
  signed __int32 v60; // ecx@100
  signed __int32 v61; // eax@108
  signed __int32 v62; // ecx@111
  signed __int32 v63; // ecx@113
  signed __int32 v64; // esi@114
  int v65; // [sp+Ch] [bp-230h]@12
  unsigned int v66; // [sp+18h] [bp-224h]@35
  int v67; // [sp+1Ch] [bp-220h]@20
  int v68; // [sp+1Ch] [bp-220h]@21
  char v69; // [sp+27h] [bp-215h]@83
  int v70; // [sp+28h] [bp-214h]@12
  void *v71; // [sp+2Ch] [bp-210h]@9
  int v72; // [sp+30h] [bp-20Ch]@9
  char *v73; // [sp+34h] [bp-208h]@9
  int v74; // [sp+38h] [bp-204h]@14
  int v75; // [sp+3Ch] [bp-200h]@14
  int v76; // [sp+40h] [bp-1FCh]@14
  int v77; // [sp+44h] [bp-1F8h]@14
  int v78; // [sp+58h] [bp-1E4h]@18
  int v79; // [sp+5Ch] [bp-1E0h]@56
  int v80; // [sp+60h] [bp-1DCh]@56
  int v81; // [sp+64h] [bp-1D8h]@56
  char v82[64]; // [sp+78h] [bp-1C4h]@12
  int v83; // [sp+B8h] [bp-184h]@20
  int v84; // [sp+BCh] [bp-180h]@60
  int v85; // [sp+C0h] [bp-17Ch]@60
  int v86; // [sp+C4h] [bp-178h]@60
  int v87; // [sp+C8h] [bp-174h]@60
  int v88; // [sp+CCh] [bp-170h]@60
  int v89; // [sp+D0h] [bp-16Ch]@60
  int v90; // [sp+D4h] [bp-168h]@60
  char v91; // [sp+D8h] [bp-164h]@60
  int v92; // [sp+DCh] [bp-160h]@60
  int v93; // [sp+E0h] [bp-15Ch]@60
  int v94; // [sp+E4h] [bp-158h]@60
  int v95; // [sp+154h] [bp-E8h]@60
  char v96; // [sp+158h] [bp-E4h]@60
  char v97; // [sp+159h] [bp-E3h]@60
  int v98; // [sp+15Ch] [bp-E0h]@60
  int v99; // [sp+160h] [bp-DCh]@60
  int v100; // [sp+164h] [bp-D8h]@60
  int v101; // [sp+168h] [bp-D4h]@60
  int v102; // [sp+16Ch] [bp-D0h]@7
  int v103; // [sp+170h] [bp-CCh]@7
  int v104; // [sp+174h] [bp-C8h]@7
  int v105; // [sp+178h] [bp-C4h]@7
  int v106; // [sp+17Ch] [bp-C0h]@18
  int v107; // [sp+180h] [bp-BCh]@18
  int v108; // [sp+184h] [bp-B8h]@18
  int v109; // [sp+188h] [bp-B4h]@18
  char v110; // [sp+18Ch] [bp-B0h]@18
  int v111; // [sp+190h] [bp-ACh]@18
  int v112; // [sp+194h] [bp-A8h]@18
  int v113; // [sp+198h] [bp-A4h]@18
  int v114; // [sp+208h] [bp-34h]@18
  char v115; // [sp+20Ch] [bp-30h]@18
  char v116; // [sp+20Dh] [bp-2Fh]@18
  int v117; // [sp+210h] [bp-2Ch]@18
  int v118; // [sp+214h] [bp-28h]@18
  int v119; // [sp+218h] [bp-24h]@18
  int v120; // [sp+21Ch] [bp-20h]@18

  v4 = strlen(a2);
  if ( !a2 || (v5 = v4, (signed int)v4 <= 0) )
  {
LABEL_7:
    memset(&v102, 0, 0x20u);
    v103 = *(_DWORD *)a1;
    v102 = 2;
    v104 = 1;
    v105 = 6;
    return evdns_getaddrinfo(*(_DWORD *)(a1 + 4), a2, 0, &v102, a3, a4);
  }
  if ( *a2 >= 0 )
  {
    v6 = 0;
    do
    {
      ++v6;
      if ( v5 == v6 )
        goto LABEL_7;
    }
    while ( a2[v6] >= 0 );
  }
  v71 = 0;
  v72 = 0;
  v73 = 0;
  v8 = v5 + 1;
  if ( v5 == -1 )
  {
    v73 = 0;
    v72 = 0;
    v9 = 0;
LABEL_11:
    v10 = v72;
    goto LABEL_12;
  }
  if ( (unsigned int)v8 > 0x3FFFFFFF )
  {
    v57 = std::__throw_bad_alloc();
LABEL_90:
    if ( v71 )
      operator delete(v71);
    Unwind_Resume(v57);
  }
  v27 = (void *)operator new(4 * v8);
  v71 = v27;
  v73 = (char *)v27 + 4 * v8;
  v28 = 0;
  do
    *((_DWORD *)v27 + v28++) = 0;
  while ( v28 != v8 );
  v9 = (int)v71;
  v29 = v71;
  v72 = (int)v73;
  v30 = (unsigned int)&a2[v5];
  v31 = (v73 - (_BYTE *)v71) >> 2;
  v32 = (unsigned int)((char *)v71 + 4 * v31);
  v66 = v32;
  if ( v32 <= (unsigned int)v71 || (unsigned int)a2 >= v30 )
  {
    v35 = 0;
  }
  else
  {
    v33 = v30 - (_DWORD)a2;
    if ( (signed int)(v30 - (_DWORD)a2) > 0 )
    {
      v34 = a2;
      while ( 1 )
      {
        LOBYTE(v32) = *v34;
        if ( *v34 >= 0 )
          break;
        if ( (unsigned __int8)v32 > 0xDFu )
        {
          if ( v33 <= 2 )
          {
LABEL_48:
            v35 = (signed int)((char *)v29 - v9) >> 2;
            goto LABEL_49;
          }
          *(_DWORD *)v29 = v34[2] & 0x3F | ((v34[1] & 0x3F) << 6) | (unsigned __int16)(((_WORD)v32 << 12) & 0xF000);
          v32 = 3;
          goto LABEL_40;
        }
        if ( v33 == 1 )
          goto LABEL_48;
        *(_DWORD *)v29 = v34[1] & 0x3F | ((v32 & 0x1F) << 6);
        BYTE1(v32) = 0;
        v34 += 2;
        v29 = (char *)v29 + 4;
        if ( v66 <= (unsigned int)v29 )
        {
LABEL_47:
          v35 = (signed int)((char *)v29 - v9) >> 2;
          goto LABEL_50;
        }
LABEL_41:
        if ( v30 <= (unsigned int)v34 )
        {
          v35 = (signed int)((char *)v29 - v9) >> 2;
          goto LABEL_50;
        }
        v33 = v30 - (_DWORD)v34;
        if ( (signed int)(v30 - (_DWORD)v34) <= 0 )
          goto LABEL_48;
      }
      *(_DWORD *)v29 = (unsigned __int8)*v34;
      v32 = 1;
LABEL_40:
      v34 += v32;
      v29 = (char *)v29 + 4;
      if ( v66 <= (unsigned int)v29 )
        goto LABEL_47;
      goto LABEL_41;
    }
    v35 = 0;
LABEL_49:
    *(_DWORD *)v29 = 0;
LABEL_50:
    v9 = (int)v71;
    v36 = (v72 - (signed int)v71) >> 2;
    v31 = v36;
    if ( v36 < (unsigned int)v35 )
    {
      sub_806B730((int)&v71, v35 - v36);
      v10 = v72;
      v9 = (int)v71;
      goto LABEL_12;
    }
  }
  if ( v35 >= (unsigned int)v31 )
    goto LABEL_11;
  v10 = v9 + 4 * v35;
  v72 = v9 + 4 * v35;
LABEL_12:
  v70 = 64;
  if ( !sub_80A71E0(v9, (v10 - v9) >> 2, (int)v82, (int)&v70) )
  {
    v82[v70] = 0;
    if ( log_level > 1 )
    {
LABEL_14:
      memset(&v74, 0, 0x20u);
      v75 = *(_DWORD *)a1;
      v74 = 2;
      v76 = 1;
      v77 = 6;
      result = evdns_getaddrinfo(*(_DWORD *)(a1 + 4), v82, 0, &v74, a3, a4);
      goto LABEL_15;
    }
    std::ios_base::ios_base((std::ios_base *)&v94);
    v94 = (int)&unk_80CF5C8;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    v98 = 0;
    v99 = 0;
    v100 = 0;
    v101 = 0;
    v37 = dword_80CF674;
    v83 = dword_80CF674;
    *(int *)((char *)&v83 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v83 + *(_DWORD *)(v83 - 12), 0);
    v83 = (int)&unk_80CF5DC;
    v94 = (int)&unk_80CF5F0;
    v84 = (int)&unk_80CF7F0;
    v85 = 0;
    v86 = 0;
    v87 = 0;
    v88 = 0;
    v89 = 0;
    v90 = 0;
    std::locale::locale((std::locale *)&v91);
    v84 = (int)&unk_80CF588;
    v92 = 16;
    v93 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v94, &v84);
    v38 = std::__ostream_insert<char,std::char_traits<char>>(
            &v83,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v38, "dns ", 4);
    v39 = strlen(a2);
    std::__ostream_insert<char,std::char_traits<char>>(v38, a2, v39);
    std::__ostream_insert<char,std::char_traits<char>>(v38, " encoded as ", 12);
    v40 = (int)v82;
    do
    {
      v41 = *(_DWORD *)v40;
      v40 += 4;
      v42 = ~v41 & (v41 - 16843009) & 0x80808080;
    }
    while ( !v42 );
    if ( !(~v41 & (v41 - 16843009) & 0x8080) )
    {
      v42 >>= 16;
      v40 += 2;
    }
    std::__ostream_insert<char,std::char_traits<char>>(
      v38,
      v82,
      v40 - (__CFADD__((_BYTE)v42, (_BYTE)v42) + 3) - (_DWORD)v82);
    v78 = (int)&unk_80CF83C;
    v43 = *(_DWORD *)(v38 + 24);
    if ( v43 )
    {
      v44 = *(_DWORD *)(v38 + 16);
      LOBYTE(v65) = 0;
      if ( v43 <= (unsigned int)v44 )
      {
        v102 = std::string::_S_construct<char *>(
                 (int)v82,
                 (unsigned int)a2,
                 (void *)v37,
                 *(_DWORD *)(v38 + 20),
                 v44,
                 (int)&v74);
        std::string::swap((std::string *)&v78, (std::string *)&v102);
      }
      else
      {
        v102 = std::string::_S_construct<char *>(
                 (int)v82,
                 (unsigned int)a2,
                 (void *)v37,
                 *(_DWORD *)(v38 + 20),
                 v43,
                 (int)&v74);
        std::string::swap((std::string *)&v78, (std::string *)&v102);
      }
      v45 = v102 - 12;
      if ( (_DWORD *)(v102 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v60 = _InterlockedExchangeAdd((volatile signed __int32 *)(v102 - 4), 0xFFFFFFFF);
        }
        else
        {
          v60 = *(_DWORD *)(v102 - 4);
          *(_DWORD *)(v102 - 4) = v60 - 1;
        }
        if ( v60 <= 0 )
          std::string::_Rep::_M_destroy(v45, &v69);
      }
    }
    else
    {
      std::string::assign((std::string *)&v78, (const std::string *)(v38 + 40));
    }
    v83 = (int)&unk_80CF5DC;
    v94 = (int)&unk_80CF5F0;
    v84 = (int)&unk_80CF588;
    v46 = v93 - 12;
    if ( (_DWORD *)(v93 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v59 = _InterlockedExchangeAdd((volatile signed __int32 *)(v93 - 4), 0xFFFFFFFF);
      }
      else
      {
        v59 = *(_DWORD *)(v93 - 4);
        *(_DWORD *)(v93 - 4) = v59 - 1;
      }
      if ( v59 <= 0 )
        std::string::_Rep::_M_destroy(v46, &v102);
    }
    v84 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v91);
    v83 = v37;
    *(int *)((char *)&v83 + *(_DWORD *)(v37 - 12)) = dword_80CF678;
    v94 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v94);
    if ( !byte_80CE64C )
    {
LABEL_74:
      syslog(7, "%s", v78, v65);
      v53 = v78 - 12;
      if ( (_DWORD *)(v78 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v54 = _InterlockedExchangeAdd((volatile signed __int32 *)(v78 - 4), 0xFFFFFFFF);
        }
        else
        {
          v63 = *(_DWORD *)(v78 - 4);
          *(_DWORD *)(v78 - 4) = v63 - 1;
          v54 = v63;
        }
        if ( v54 <= 0 )
          std::string::_Rep::_M_destroy(v53, &v102);
      }
      goto LABEL_14;
    }
    v47 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v78, *(_DWORD *)(v78 - 12));
    v48 = (std::ostream *)v47;
    v49 = *(_DWORD *)(*(_DWORD *)v47 - 12);
    v50 = *(_DWORD *)((char *)v48 + v49 + 124);
    if ( v50 )
    {
      if ( *(_BYTE *)(v50 + 28) )
      {
        v51 = *(_BYTE *)(v50 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v48 + v49 + 124));
        v51 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v50 + 24))(v50, 10);
      }
      v52 = (std::ostream *)std::ostream::put(v48, v51);
      std::ostream::flush(v52);
      goto LABEL_74;
    }
    v57 = std::__throw_bad_cast();
    v58 = &v102;
    goto LABEL_94;
  }
  if ( log_level > 5 )
  {
    v17 = &v78;
    goto LABEL_56;
  }
  std::ios_base::ios_base((std::ios_base *)&v113);
  v113 = (int)&unk_80CF5C8;
  v114 = 0;
  v115 = 0;
  v116 = 0;
  v117 = 0;
  v118 = 0;
  v119 = 0;
  v120 = 0;
  v12 = dword_80CF674;
  v102 = dword_80CF674;
  *(int *)((char *)&v102 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v102 + *(_DWORD *)(v102 - 12), 0);
  v102 = (int)&unk_80CF5DC;
  v113 = (int)&unk_80CF5F0;
  v103 = (int)&unk_80CF7F0;
  v104 = 0;
  v105 = 0;
  v106 = 0;
  v107 = 0;
  v108 = 0;
  v109 = 0;
  std::locale::locale((std::locale *)&v110);
  v103 = (int)&unk_80CF588;
  v111 = 16;
  v112 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v113, &v103);
  v13 = std::__ostream_insert<char,std::char_traits<char>>(&v102, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v13, "idna_encode failed for ", 23);
  v14 = strlen(a2);
  std::__ostream_insert<char,std::char_traits<char>>(v13, a2, v14);
  v78 = (int)&unk_80CF83C;
  v15 = *(_DWORD *)(v13 + 24);
  if ( v15 )
  {
    v16 = *(_DWORD *)(v13 + 16);
    LOBYTE(v65) = 0;
    if ( v15 > (unsigned int)v16 )
    {
      v83 = std::string::_S_construct<char *>(v13, (unsigned int)a2, &v113, *(_DWORD *)(v13 + 20), v15, (int)&v74);
      v17 = &v78;
      std::string::swap((std::string *)&v78, (std::string *)&v83);
      v18 = v83;
      v67 = v83 - 12;
      if ( (_DWORD *)(v83 - 12) == &std::string::_Rep::_S_empty_rep_storage )
        goto LABEL_21;
LABEL_80:
      if ( &_pthread_key_create )
      {
        v55 = _InterlockedExchangeAdd((volatile signed __int32 *)(v18 - 4), 0xFFFFFFFF);
      }
      else
      {
        v55 = *(_DWORD *)(v18 - 4);
        *(_DWORD *)(v18 - 4) = v55 - 1;
      }
      if ( v55 <= 0 )
        std::string::_Rep::_M_destroy(v67, &v69);
      goto LABEL_21;
    }
    v83 = std::string::_S_construct<char *>(v13, (unsigned int)a2, &v113, *(_DWORD *)(v13 + 20), v16, (int)&v74);
    v17 = &v78;
    std::string::swap((std::string *)&v78, (std::string *)&v83);
    v18 = v83;
    v67 = v83 - 12;
    if ( (_DWORD *)(v83 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_80;
  }
  else
  {
    fmt = (char *)(v13 + 40);
    v17 = &v78;
    std::string::assign((std::string *)&v78, (const std::string *)fmt);
  }
LABEL_21:
  v102 = (int)&unk_80CF5DC;
  v113 = (int)&unk_80CF5F0;
  v103 = (int)&unk_80CF588;
  v68 = v112 - 12;
  if ( (_DWORD *)(v112 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v61 = _InterlockedExchangeAdd((volatile signed __int32 *)(v112 - 4), 0xFFFFFFFF);
    }
    else
    {
      v62 = *(_DWORD *)(v112 - 4);
      *(_DWORD *)(v112 - 4) = v62 - 1;
      v61 = v62;
    }
    if ( v61 <= 0 )
      std::string::_Rep::_M_destroy(v68, &v83);
  }
  v103 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v110);
  v102 = v12;
  *(int *)((char *)&v102 + *(_DWORD *)(v12 - 12)) = dword_80CF678;
  v113 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v113);
  if ( byte_80CE64C )
  {
    v19 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v78, *(_DWORD *)(v78 - 12));
    v20 = (std::ostream *)v19;
    v21 = *(_DWORD *)(*(_DWORD *)v19 - 12);
    v22 = *(_DWORD *)((char *)v20 + v21 + 124);
    if ( !v22 )
    {
      v57 = std::__throw_bad_cast();
      v58 = &v102;
LABEL_94:
      std::string::_Rep::_M_dispose(v78 - 12, v58);
      goto LABEL_90;
    }
    if ( *(_BYTE *)(v22 + 28) )
    {
      v23 = *(_BYTE *)(v22 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v20 + v21 + 124));
      v23 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v22 + 24))(v22, 10);
    }
    v24 = (std::ostream *)std::ostream::put(v20, v23);
    std::ostream::flush(v24);
  }
  syslog(3, "%s", v78, v65);
  v25 = v78 - 12;
  if ( (_DWORD *)(v78 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v78 - 4), 0xFFFFFFFF);
    }
    else
    {
      v64 = *(_DWORD *)(v78 - 4);
      *(_DWORD *)(v78 - 4) = v64 - 1;
      v26 = v64;
    }
    if ( v26 <= 0 )
      std::string::_Rep::_M_destroy(v25, &v102);
  }
LABEL_56:
  memset(v17, 0, 0x20u);
  v79 = *(_DWORD *)a1;
  v78 = 2;
  v80 = 1;
  v81 = 6;
  result = evdns_getaddrinfo(*(_DWORD *)(a1 + 4), a2, 0, v17, a3, a4);
LABEL_15:
  if ( v71 )
  {
    v11 = result;
    operator delete(v71);
    result = v11;
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C9F0: using guessed type int __cdecl evdns_getaddrinfo(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 807BE90: using guessed type char var_1C4[64];

//----- (0807CDD0) --------------------------------------------------------
void __cdecl sub_807CDD0(void ***a1)
{
  sub_807EE60(**a1);
}

//----- (0807CE10) --------------------------------------------------------
int __cdecl sub_807CE10(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BACD0;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BACD0: using guessed type void *off_80BACD0;

//----- (0807CEB0) --------------------------------------------------------
int __cdecl sub_807CEB0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BACC8;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BACC8: using guessed type void *off_80BACC8;

//----- (0807CF50) --------------------------------------------------------
int __cdecl sub_807CF50(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BACC0;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BACC0: using guessed type void *off_80BACC0;

//----- (0807CFF0) --------------------------------------------------------
int __cdecl sub_807CFF0(int a1, int a2, int a3, int a4)
{
  int result; // eax@1

  sub_807ED80(a1, a2);
  *(_DWORD *)a1 = &off_80BAD00;
  *(_DWORD *)(a1 + 52) = a3;
  HttpClient::HttpClient(a1 + 56);
  result = a4;
  *(_DWORD *)(a1 + 164) = a4;
  return result;
}
// 80BAD00: using guessed type int (__cdecl *off_80BAD00)(int);

//----- (0807D180) --------------------------------------------------------
char __cdecl sub_807D180(int a1, int a2, int a3, int a4, int a5)
{
  int (__cdecl *v5)(void **, void **, signed int); // ecx@1
  int v6; // esi@2
  int v7; // ST18_4@3
  int v8; // ST1C_4@3
  int v9; // edx@3
  int (__cdecl *v10)(void **, void **, signed int); // eax@3
  void (__cdecl *v11)(void ***); // edx@3
  int (__cdecl *v12)(void **, void **, signed int); // ecx@5
  int v13; // ST18_4@7
  int v14; // ST1C_4@7
  int v15; // edx@7
  int (__cdecl *v16)(void **, void **, signed int); // eax@7
  void (__cdecl *v17)(void ***); // edx@7
  int v18; // eax@9
  bool v19; // zf@9
  int v20; // edx@10
  int v21; // eax@17
  int v22; // edx@18
  int v23; // eax@22
  int v24; // ST18_4@22
  int v25; // ST1C_4@22
  int v26; // edx@22
  int (__cdecl *v27)(void **, void **, signed int); // edx@22
  int (__cdecl *v28)(void **, void **, signed int); // eax@22
  void (__cdecl *v29)(void ***); // edx@22
  int v30; // eax@26
  signed __int32 v32; // ecx@33
  signed __int32 v33; // ecx@37
  int v34; // [sp+18h] [bp-50h]@16
  int v35; // [sp+18h] [bp-50h]@21
  char v36; // [sp+2Eh] [bp-3Ah]@9
  int v37; // [sp+30h] [bp-38h]@9
  int (__cdecl *v38)(void **, void **, signed int); // [sp+38h] [bp-30h]@22
  int (*v39)(); // [sp+3Ch] [bp-2Ch]@22
  int v40; // [sp+40h] [bp-28h]@2
  int v41; // [sp+44h] [bp-24h]@3
  int (__cdecl *v42)(void **, void **, signed int); // [sp+48h] [bp-20h]@2
  void (__cdecl *v43)(void ***); // [sp+4Ch] [bp-1Ch]@2

  v5 = *(int (__cdecl **)(void **, void **, signed int))(a4 + 8);
  if ( v5 )
  {
    v43 = *(void (__cdecl **)(void ***))(a4 + 12);
    v42 = v5;
    v6 = (int)&v40;
    v5((void **)&v40, (void **)a4, 2);
    v5 = v42;
  }
  else
  {
    v6 = (int)&v40;
  }
  v7 = v40;
  v8 = v41;
  v9 = *(_DWORD *)(a1 + 24);
  v40 = *(_DWORD *)(a1 + 20);
  v41 = v9;
  *(_DWORD *)(a1 + 20) = v7;
  *(_DWORD *)(a1 + 24) = v8;
  v42 = *(int (__cdecl **)(void **, void **, signed int))(a1 + 28);
  v10 = v42;
  *(_DWORD *)(a1 + 28) = v5;
  v11 = v43;
  v43 = *(void (__cdecl **)(void ***))(a1 + 32);
  *(_DWORD *)(a1 + 32) = v11;
  if ( v10 )
    v10((void **)v6, (void **)v6, 3);
  v12 = *(int (__cdecl **)(void **, void **, signed int))(a5 + 8);
  if ( v12 )
  {
    v43 = *(void (__cdecl **)(void ***))(a5 + 12);
    v42 = v12;
    v12((void **)v6, (void **)a5, 2);
    v12 = v42;
  }
  v13 = v40;
  v14 = v41;
  v15 = *(_DWORD *)(a1 + 40);
  v40 = *(_DWORD *)(a1 + 36);
  v41 = v15;
  *(_DWORD *)(a1 + 36) = v13;
  *(_DWORD *)(a1 + 40) = v14;
  v42 = *(int (__cdecl **)(void **, void **, signed int))(a1 + 44);
  v16 = v42;
  *(_DWORD *)(a1 + 44) = v12;
  v17 = v43;
  v43 = *(void (__cdecl **)(void ***))(a1 + 48);
  *(_DWORD *)(a1 + 48) = v17;
  if ( v16 )
    v16((void **)v6, (void **)v6, 3);
  bufferevent_setcb(*(_DWORD *)(a1 + 4), 0, 0, sub_807E2E0, a1);
  *(_DWORD *)(a1 + 84) = 3600;
  std::string::string(&v37, a2, &v36);
  sub_8067DC0(v6, (std::string *)&v37);
  v18 = v40;
  *(_DWORD *)(v40 + 36) = a3;
  v19 = v6 == a1 + 60;
  if ( v6 == a1 + 60 )
    goto LABEL_44;
  v20 = *(_DWORD *)(a1 + 60);
  if ( v20 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v20 + 4));
    if ( !v20 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
    v18 = v40;
  }
  *(_DWORD *)(a1 + 60) = v18;
  if ( v18 )
  {
    _InterlockedIncrement((volatile signed __int32 *)(v18 + 4));
    v18 = v40;
    v19 = v40 == 0;
    if ( v40 )
    {
LABEL_44:
      _InterlockedDecrement((volatile signed __int32 *)(v18 + 4));
      if ( v19 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v18 + 4))(v18);
    }
  }
  v34 = v37 - 12;
  if ( (_DWORD *)(v37 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v32 = _InterlockedExchangeAdd((volatile signed __int32 *)(v37 - 4), 0xFFFFFFFF);
    }
    else
    {
      v32 = *(_DWORD *)(v37 - 4);
      *(_DWORD *)(v37 - 4) = v32 - 1;
    }
    if ( v32 <= 0 )
      std::string::_Rep::_M_destroy(v34, v6);
  }
  v21 = *(_DWORD *)(a1 + 60);
  if ( v21 && (v22 = *(_DWORD *)(v21 + 32)) != 0 )
    std::string::string(v6, *(_DWORD *)(v21 + 28), v22, &v37);
  else
    std::string::string((std::string *)v6, (const std::string *)&dword_80CF8FC);
  std::string::assign((std::string *)(a1 + 68), (const std::string *)v6);
  v35 = v40 - 12;
  if ( (_DWORD *)(v40 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v33 = _InterlockedExchangeAdd((volatile signed __int32 *)(v40 - 4), 0xFFFFFFFF);
    }
    else
    {
      v33 = *(_DWORD *)(v40 - 4);
      *(_DWORD *)(v40 - 4) = v33 - 1;
    }
    if ( v33 <= 0 )
      std::string::_Rep::_M_destroy(v35, &v37);
  }
  v38 = 0;
  v23 = operator new(4u);
  *(_DWORD *)v23 = a1;
  v37 = v23;
  v39 = sub_807D160;
  v38 = sub_807CE10;
  v43 = (void (__cdecl *)(void ***))sub_807D160;
  v42 = sub_807CE10;
  sub_807CE10((void **)v6, (void **)&v37, 2);
  v24 = v40;
  v25 = v41;
  v26 = *(_DWORD *)(a1 + 132);
  v40 = *(_DWORD *)(a1 + 128);
  v41 = v26;
  *(_DWORD *)(a1 + 128) = v24;
  *(_DWORD *)(a1 + 132) = v25;
  v27 = v42;
  v42 = *(int (__cdecl **)(void **, void **, signed int))(a1 + 136);
  v28 = v42;
  *(_DWORD *)(a1 + 136) = v27;
  v29 = v43;
  v43 = *(void (__cdecl **)(void ***))(a1 + 140);
  *(_DWORD *)(a1 + 140) = v29;
  if ( v28 )
    v28((void **)v6, (void **)v6, 3);
  if ( v38 )
    v38((void **)&v37, (void **)&v37, 3);
  v42 = 0;
  v30 = operator new(4u);
  *(_DWORD *)v30 = a1;
  v40 = v30;
  v43 = sub_807CDD0;
  v42 = sub_807CEB0;
  sub_807B640(a1 + 56, *(_DWORD *)(a1 + 52), v6);
  if ( v42 )
    v42((void **)v6, (void **)v6, 3);
  return 1;
}
// 804C6E0: using guessed type int __cdecl bufferevent_setcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 807D160: using guessed type int sub_807D160();
// 807E2E0: using guessed type int sub_807E2E0();
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (0807E300) --------------------------------------------------------
void __cdecl sub_807E300(int a1)
{
  int v1; // esi@1

  *(_DWORD *)a1 = &off_80BAD00;
  v1 = *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 16) = 0;
  if ( v1 )
  {
    sub_806EB90(v1);
    operator delete((void *)v1);
  }
  sub_80725E0(a1 + 56);
  sub_807ECE0(a1);
}
// 80BAD00: using guessed type int (__cdecl *off_80BAD00)(int);

//----- (0807E350) --------------------------------------------------------
void __cdecl sub_807E350(void *a1)
{
  sub_807E300((int)a1);
  operator delete(a1);
}

//----- (0807E370) --------------------------------------------------------
int __cdecl sub_807E370(int **a1)
{
  int result; // eax@1

  result = **a1;
  if ( result )
    result = (*(int (__cdecl **)(_DWORD))(*(_DWORD *)result + 4))(**a1);
  return result;
}

//----- (0807E3A0) --------------------------------------------------------
int __cdecl sub_807E3A0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BAD78;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BAD78: using guessed type void *off_80BAD78;

//----- (0807E440) --------------------------------------------------------
int __cdecl sub_807E440(std::string *a1, std::string *a2, int a3, std::string *a4, int a5, int a6)
{
  int result; // eax@1

  std::string::string(a1, a2);
  *((_DWORD *)a1 + 1) = a3;
  std::string::string((std::string *)((char *)a1 + 8), a4);
  *((_DWORD *)a1 + 3) = a5;
  result = a6;
  *((_DWORD *)a1 + 4) = a6;
  *((_DWORD *)a1 + 5) = 0;
  *((_DWORD *)a1 + 6) = 0;
  return result;
}

//----- (0807E4C0) --------------------------------------------------------
int __cdecl sub_807E4C0(int a1)
{
  int v1; // eax@3
  int v2; // edx@3
  int result; // eax@4
  int v4; // edx@4
  signed __int32 v5; // eax@7
  signed __int32 v6; // ecx@14
  int v7; // ecx@15
  char v8; // [sp+1Fh] [bp-Dh]@9

  if ( *(_DWORD *)(a1 + 24) )
    evconnlistener_free(*(_DWORD *)(a1 + 24));
  v1 = *(_DWORD *)(a1 + 8);
  v2 = v1 - 12;
  if ( (_DWORD *)(v1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v5 = _InterlockedExchangeAdd((volatile signed __int32 *)(v1 - 4), 0xFFFFFFFF);
    }
    else
    {
      v6 = *(_DWORD *)(v1 - 4);
      *(_DWORD *)(v1 - 4) = v6 - 1;
      v5 = v6;
    }
    if ( v5 <= 0 )
      std::string::_Rep::_M_destroy(v2, &v8);
  }
  result = *(_DWORD *)a1;
  v4 = *(_DWORD *)a1 - 12;
  if ( (_DWORD *)v4 != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      result = _InterlockedExchangeAdd((volatile signed __int32 *)(result - 4), 0xFFFFFFFF);
    }
    else
    {
      v7 = *(_DWORD *)(result - 4);
      *(_DWORD *)(result - 4) = v7 - 1;
      result = v7;
    }
    if ( result <= 0 )
      result = std::string::_Rep::_M_destroy(v4, &v8);
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CE20: using guessed type int __cdecl evconnlistener_free(_DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0807E570) --------------------------------------------------------
int __cdecl sub_807E570(int a1, int a2)
{
  int result; // eax@1
  int v3; // edi@1
  int v4; // esi@2
  void (__cdecl *v5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // ST1C_4@2
  int v6; // eax@2
  char v7; // [sp+20h] [bp-3Ch]@2
  void (__cdecl *v8)(char *, char *, signed int); // [sp+28h] [bp-34h]@2
  int v9; // [sp+30h] [bp-2Ch]@2
  int (__cdecl *v10)(void **, void **, signed int); // [sp+38h] [bp-24h]@2
  int (__cdecl *v11)(int **); // [sp+3Ch] [bp-20h]@2

  result = bufferevent_socket_new(*(_DWORD *)(*(_DWORD *)(a1 + 20) + 4), a2, 1);
  v3 = result;
  if ( result )
  {
    v4 = operator new(0xB8u);
    sub_807CFF0(v4, v3, *(_DWORD *)(a1 + 20), *(_DWORD *)(a1 + 16));
    v5 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))(*(_DWORD *)v4 + 8);
    v6 = operator new(4u);
    *(_DWORD *)v6 = v4;
    v9 = v6;
    v11 = sub_807E370;
    v10 = sub_807E3A0;
    v8 = 0;
    v5(v4, *(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12), &v7, &v9);
    if ( v8 )
      v8(&v7, &v7, 3);
    result = (int)v10;
    if ( v10 )
      result = v10((void **)&v9, (void **)&v9, 3);
  }
  return result;
}
// 804C770: using guessed type int __cdecl bufferevent_socket_new(_DWORD, _DWORD, _DWORD);

//----- (0807E6D0) --------------------------------------------------------
int __cdecl sub_807E6D0(int a1, int a2, int a3, int a4, int a5)
{
  return sub_807E570(a5, a2);
}

//----- (0807E6E0) --------------------------------------------------------
int __cdecl sub_807E6E0(int a1, int a2)
{
  int v2; // ST28_4@2
  int v3; // ST2C_4@2
  int *v4; // ebp@2
  int v5; // edi@2
  int v6; // esi@2
  int v7; // esi@2
  int v8; // esi@2
  int v9; // esi@2
  int v10; // eax@2
  int v11; // edx@2
  int v12; // ecx@3
  int v13; // edx@5
  int v14; // edx@6
  int v15; // eax@8
  std::ostream *v16; // edi@8
  int v17; // eax@8
  int v18; // esi@8
  char v19; // al@10
  std::ostream *v20; // eax@11
  int v21; // edx@12
  __int16 v22; // ax@15
  int result; // eax@15
  signed __int32 v24; // esi@20
  signed __int32 v25; // esi@24
  signed __int32 v26; // eax@28
  int v27; // ebx@31
  signed __int32 v28; // ecx@35
  int v29; // [sp+Ch] [bp-100h]@0
  char v30; // [sp+32h] [bp-DAh]@22
  char v31; // [sp+33h] [bp-D9h]@4
  int v32; // [sp+34h] [bp-D8h]@2
  int v33; // [sp+38h] [bp-D4h]@4
  int v34; // [sp+3Ch] [bp-D0h]@2
  int v35; // [sp+40h] [bp-CCh]@2
  int v36; // [sp+44h] [bp-C8h]@2
  int v37; // [sp+48h] [bp-C4h]@2
  int v38; // [sp+4Ch] [bp-C0h]@2
  int v39; // [sp+50h] [bp-BCh]@2
  int v40; // [sp+54h] [bp-B8h]@2
  int v41; // [sp+58h] [bp-B4h]@2
  char v42; // [sp+5Ch] [bp-B0h]@2
  int v43; // [sp+60h] [bp-ACh]@2
  int v44; // [sp+64h] [bp-A8h]@2
  int v45; // [sp+68h] [bp-A4h]@2
  int v46; // [sp+D8h] [bp-34h]@2
  char v47; // [sp+DCh] [bp-30h]@2
  char v48; // [sp+DDh] [bp-2Fh]@2
  int v49; // [sp+E0h] [bp-2Ch]@2
  int v50; // [sp+E4h] [bp-28h]@2
  int v51; // [sp+E8h] [bp-24h]@2
  int v52; // [sp+ECh] [bp-20h]@2

  if ( log_level > 3 )
  {
    *(_DWORD *)(a1 + 20) = a2;
    v4 = &v34;
  }
  else
  {
    v2 = *(_DWORD *)(a1 + 12);
    v3 = *(_DWORD *)(a1 + 4);
    v4 = &v34;
    std::ios_base::ios_base((std::ios_base *)&v45);
    v45 = (int)&unk_80CF5C8;
    v46 = 0;
    v47 = 0;
    v48 = 0;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    v52 = 0;
    v5 = dword_80CF674;
    v34 = dword_80CF674;
    *(int *)((char *)&v34 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v34 + *(_DWORD *)(v34 - 12), 0);
    v34 = (int)&unk_80CF5DC;
    v45 = (int)&unk_80CF5F0;
    v35 = (int)&unk_80CF7F0;
    v36 = 0;
    v37 = 0;
    v38 = 0;
    v39 = 0;
    v40 = 0;
    v41 = 0;
    std::locale::locale((std::locale *)&v42);
    v35 = (int)&unk_80CF588;
    v43 = 16;
    v44 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v45, &v35);
    v6 = std::__ostream_insert<char,std::char_traits<char>>(&v34, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v6, "starting http proxy tunnel ", 27);
    v7 = std::__ostream_insert<char,std::char_traits<char>>(v6, *(_DWORD *)a1, *(_DWORD *)(*(_DWORD *)a1 - 12));
    std::__ostream_insert<char,std::char_traits<char>>(v7, ":", 1);
    v8 = std::ostream::operator<<(v7, v3);
    std::__ostream_insert<char,std::char_traits<char>>(v8, " -> ", 4);
    v9 = std::__ostream_insert<char,std::char_traits<char>>(
           v8,
           *(_DWORD *)(a1 + 8),
           *(_DWORD *)(*(_DWORD *)(a1 + 8) - 12));
    std::__ostream_insert<char,std::char_traits<char>>(v9, ":", 1);
    v10 = std::ostream::operator<<(v9, v2);
    v32 = (int)&unk_80CF83C;
    v11 = *(_DWORD *)(v10 + 24);
    if ( v11 )
    {
      v12 = *(_DWORD *)(v10 + 16);
      LOBYTE(v29) = 0;
      if ( v11 <= (unsigned int)v12 )
      {
        v33 = std::string::_S_construct<char *>(
                a1,
                (unsigned int)&v34,
                (void *)v5,
                *(_DWORD *)(v10 + 20),
                v12,
                (int)&v31);
        std::string::swap((std::string *)&v32, (std::string *)&v33);
      }
      else
      {
        v33 = std::string::_S_construct<char *>(
                a1,
                (unsigned int)&v34,
                (void *)v5,
                *(_DWORD *)(v10 + 20),
                v11,
                (int)&v31);
        std::string::swap((std::string *)&v32, (std::string *)&v33);
      }
      v13 = v33 - 12;
      if ( (_DWORD *)(v33 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v33 - 4), 0xFFFFFFFF);
        }
        else
        {
          v24 = *(_DWORD *)(v33 - 4);
          *(_DWORD *)(v33 - 4) = v24 - 1;
        }
        if ( v24 <= 0 )
          std::string::_Rep::_M_destroy(v13, &v30);
      }
    }
    else
    {
      std::string::assign((std::string *)&v32, (const std::string *)(v10 + 40));
    }
    v34 = (int)&unk_80CF5DC;
    v45 = (int)&unk_80CF5F0;
    v35 = (int)&unk_80CF588;
    v14 = v44 - 12;
    if ( (_DWORD *)(v44 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v44 - 4), 0xFFFFFFFF);
      }
      else
      {
        v25 = *(_DWORD *)(v44 - 4);
        *(_DWORD *)(v44 - 4) = v25 - 1;
      }
      if ( v25 <= 0 )
        std::string::_Rep::_M_destroy(v14, &v33);
    }
    v35 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v42);
    v34 = v5;
    *(int *)((char *)&v34 + *(_DWORD *)(v5 - 12)) = dword_80CF678;
    v45 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v45);
    if ( byte_80CE64C )
    {
      v15 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v32, *(_DWORD *)(v32 - 12));
      v16 = (std::ostream *)v15;
      v17 = *(_DWORD *)(*(_DWORD *)v15 - 12);
      v18 = *(_DWORD *)((char *)v16 + v17 + 124);
      if ( !v18 )
      {
        v27 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v32 - 12, &v34);
        Unwind_Resume(v27);
      }
      if ( *(_BYTE *)(v18 + 28) )
      {
        v19 = *(_BYTE *)(v18 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v16 + v17 + 124));
        v19 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v18 + 24))(v18, 10);
      }
      v20 = (std::ostream *)std::ostream::put(v16, v19);
      std::ostream::flush(v20);
    }
    syslog(5, "%s", v32, v29);
    v21 = v32 - 12;
    if ( (_DWORD *)(v32 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
      }
      else
      {
        v28 = *(_DWORD *)(v32 - 4);
        *(_DWORD *)(v32 - 4) = v28 - 1;
        v26 = v28;
      }
      if ( v26 <= 0 )
        std::string::_Rep::_M_destroy(v21, &v34);
    }
    *(_DWORD *)(a1 + 20) = a2;
  }
  memset(v4, 0, 0x10u);
  LOWORD(v34) = 2;
  evutil_inet_pton(2, *(_DWORD *)a1, &v35);
  v22 = __ROR2__(*(_DWORD *)(a1 + 4), 8);
  HIWORD(v34) = v22;
  result = evconnlistener_new_bind(*(_DWORD *)(a2 + 4), sub_807E6D0, a1, 10, -1, v4, 16);
  *(_DWORD *)(a1 + 24) = result;
  return result;
}
// 804C3E0: using guessed type int __cdecl evutil_inet_pton(_DWORD, _DWORD, _DWORD);
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D2E0: using guessed type int __cdecl evconnlistener_new_bind(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0807ECE0) --------------------------------------------------------
void __cdecl sub_807ECE0(int a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@3
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@5
  void *v3; // esi@7

  *(_DWORD *)a1 = &off_80BADA0;
  if ( *(_DWORD *)(a1 + 4) )
    bufferevent_free(*(struct bufferevent **)(a1 + 4));
  v1 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 44);
  if ( v1 )
    v1(a1 + 36, a1 + 36, 3);
  v2 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 28);
  if ( v2 )
    v2(a1 + 20, a1 + 20, 3);
  v3 = *(void **)(a1 + 16);
  if ( v3 )
  {
    sub_806EB90(*(_DWORD *)(a1 + 16));
    operator delete(v3);
  }
  *(_DWORD *)(a1 + 16) = 0;
}
// 80BADA0: using guessed type int (__cdecl *off_80BADA0)(int);

//----- (0807ED60) --------------------------------------------------------
void __cdecl sub_807ED60(void *a1)
{
  sub_807ECE0((int)a1);
  operator delete(a1);
}

//----- (0807ED80) --------------------------------------------------------
int __cdecl sub_807ED80(int a1, int a2)
{
  int result; // eax@1

  *(_DWORD *)a1 = &off_80BADA0;
  *(_DWORD *)(a1 + 4) = a2;
  *(_DWORD *)(a1 + 8) = 0;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 28) = 0;
  *(_DWORD *)(a1 + 44) = 0;
  result = bufferevent_getfd(a2);
  *(_DWORD *)(a1 + 12) = result;
  return result;
}
// 804CC70: using guessed type int __cdecl bufferevent_getfd(_DWORD);
// 80BADA0: using guessed type int (__cdecl *off_80BADA0)(int);

//----- (0807EE30) --------------------------------------------------------
void __cdecl sub_807EE30(void *a1)
{
  if ( *((_DWORD *)a1 + 7) )
    sub_8057D90((char *)a1 + 20);
}

//----- (0807EE60) --------------------------------------------------------
void __cdecl sub_807EE60(void *a1)
{
  if ( *((_DWORD *)a1 + 11) )
    sub_8057D90((char *)a1 + 36);
}

//----- (0807EE90) --------------------------------------------------------
void __cdecl sub_807EE90(void *a1)
{
  sub_807EE60(**(void ***)a1);
}

//----- (0807EEB0) --------------------------------------------------------
int __cdecl sub_807EEB0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BAEBC;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BAEBC: using guessed type void *off_80BAEBC;

//----- (0807EF50) --------------------------------------------------------
bool __cdecl sub_807EF50(int a1, char *a2, int a3, int a4, int a5)
{
  int v5; // eax@1
  int v6; // eax@1
  unsigned int v7; // eax@2
  int v8; // ecx@2
  int v9; // ST18_4@4
  int v10; // ST1C_4@4
  int v11; // edx@4
  int v12; // eax@4
  int v13; // edx@4
  int v14; // ecx@6
  int v15; // eax@8
  int v16; // edx@8
  int v17; // ebp@8
  int v18; // eax@8
  int v19; // edx@8
  bool result; // al@10
  int v21; // [sp+20h] [bp-2Ch]@3
  int v22; // [sp+24h] [bp-28h]@4
  int v23; // [sp+28h] [bp-24h]@3
  int v24; // [sp+2Ch] [bp-20h]@3

  v5 = bufferevent_get_base(*(_DWORD *)(a1 + 4));
  v6 = bufferevent_socket_new(v5, -1, 1);
  *(_DWORD *)(a1 + 8) = v6;
  if ( v6 )
  {
    v7 = strlen(a2);
    std::string::assign((std::string *)(a1 + 56), a2, v7);
    *(_DWORD *)(a1 + 60) = a3;
    v8 = *(_DWORD *)(a4 + 8);
    if ( v8 )
    {
      v24 = *(_DWORD *)(a4 + 12);
      v23 = v8;
      ((void (__cdecl *)(int *, int, signed int))v8)(&v21, a4, 2);
      v8 = v23;
    }
    v9 = v21;
    v10 = v22;
    v11 = *(_DWORD *)(a1 + 24);
    v21 = *(_DWORD *)(a1 + 20);
    v22 = v11;
    *(_DWORD *)(a1 + 20) = v9;
    *(_DWORD *)(a1 + 24) = v10;
    v23 = *(_DWORD *)(a1 + 28);
    v12 = v23;
    *(_DWORD *)(a1 + 28) = v8;
    v13 = v24;
    v24 = *(_DWORD *)(a1 + 32);
    *(_DWORD *)(a1 + 32) = v13;
    if ( v12 )
      ((void (__cdecl *)(int *, int *, signed int))v12)(&v21, &v21, 3);
    v14 = *(_DWORD *)(a5 + 8);
    if ( v14 )
    {
      v24 = *(_DWORD *)(a5 + 12);
      v23 = v14;
      ((void (__cdecl *)(int *, int, signed int))v14)(&v21, a5, 2);
      v14 = v23;
    }
    v15 = v21;
    v16 = v22;
    v17 = *(_DWORD *)(a1 + 40);
    v21 = *(_DWORD *)(a1 + 36);
    v22 = v17;
    *(_DWORD *)(a1 + 36) = v15;
    *(_DWORD *)(a1 + 40) = v16;
    v23 = *(_DWORD *)(a1 + 44);
    v18 = v23;
    *(_DWORD *)(a1 + 44) = v14;
    v19 = v24;
    v24 = *(_DWORD *)(a1 + 48);
    *(_DWORD *)(a1 + 48) = v19;
    if ( v18 )
      ((void (__cdecl *)(int *, int *, signed int))v18)(&v21, &v21, 3);
    bufferevent_setcb(*(_DWORD *)(a1 + 4), 0, 0, sub_807FF00, a1);
    bufferevent_setcb(*(_DWORD *)(a1 + 8), 0, 0, sub_8081650, a1);
    result = bufferevent_socket_connect_hostname(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 52), 2, a2, a3) == 0;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 804C6E0: using guessed type int __cdecl bufferevent_setcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804C770: using guessed type int __cdecl bufferevent_socket_new(_DWORD, _DWORD, _DWORD);
// 804CD70: using guessed type int __cdecl bufferevent_socket_connect_hostname(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804CFC0: using guessed type int __cdecl bufferevent_get_base(_DWORD);
// 807FF00: using guessed type int sub_807FF00();
// 8081650: using guessed type int sub_8081650();

//----- (0807F190) --------------------------------------------------------
void __cdecl sub_807F190(int a1)
{
  int v1; // esi@1
  int v2; // eax@5
  int v3; // edx@5
  signed __int32 v4; // eax@8
  signed __int32 v5; // ecx@11
  char v6; // [sp+1Fh] [bp-Dh]@10

  *(_DWORD *)a1 = &off_80BAEE8;
  v1 = *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 16) = 0;
  if ( v1 )
  {
    sub_806EB90(v1);
    operator delete((void *)v1);
  }
  if ( *(_DWORD *)(a1 + 8) )
    bufferevent_free(*(struct bufferevent **)(a1 + 8));
  v2 = *(_DWORD *)(a1 + 56);
  v3 = v2 - 12;
  if ( (_DWORD *)(v2 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v4 = _InterlockedExchangeAdd((volatile signed __int32 *)(v2 - 4), 0xFFFFFFFF);
    }
    else
    {
      v5 = *(_DWORD *)(v2 - 4);
      *(_DWORD *)(v2 - 4) = v5 - 1;
      v4 = v5;
    }
    if ( v4 <= 0 )
      std::string::_Rep::_M_destroy(v3, &v6);
  }
  sub_807ECE0(a1);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80BAEE8: using guessed type int (__cdecl *off_80BAEE8)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0807F220) --------------------------------------------------------
void __cdecl sub_807F220(void *a1)
{
  sub_807F190((int)a1);
  operator delete(a1);
}

//----- (0807F240) --------------------------------------------------------
int __cdecl sub_807F240(int a1, int a2, int a3)
{
  int result; // eax@1

  sub_807ED80(a1, a2);
  *(_DWORD *)a1 = &off_80BAEE8;
  result = a3;
  *(_DWORD *)(a1 + 52) = a3;
  *(_DWORD *)(a1 + 56) = &unk_80CF83C;
  *(_DWORD *)(a1 + 64) = 1;
  return result;
}
// 80BAEE8: using guessed type int (__cdecl *off_80BAEE8)(int);

//----- (08081670) --------------------------------------------------------
int __cdecl sub_8081670(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BB47C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BB47C: using guessed type void *off_80BB47C;

//----- (08081710) --------------------------------------------------------
int __cdecl sub_8081710(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BB484;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BB484: using guessed type void *off_80BB484;

//----- (080817B0) --------------------------------------------------------
int __cdecl sub_80817B0(int a1, std::string *a2, int a3)
{
  int result; // eax@1

  *(_DWORD *)a1 = &unk_80CF83C;
  std::string::string((std::string *)(a1 + 4), a2);
  result = a3;
  *(_DWORD *)(a1 + 8) = a3;
  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 16) = 0;
  return result;
}

//----- (08081810) --------------------------------------------------------
int __cdecl sub_8081810(int a1)
{
  int v1; // eax@3
  int v2; // edx@3
  int result; // eax@4
  int v4; // edx@4
  signed __int32 v5; // eax@7
  signed __int32 v6; // ecx@14
  int v7; // ecx@15
  char v8; // [sp+1Fh] [bp-Dh]@9

  if ( *(_DWORD *)(a1 + 12) )
    evconnlistener_free(*(_DWORD *)(a1 + 12));
  v1 = *(_DWORD *)(a1 + 4);
  v2 = v1 - 12;
  if ( (_DWORD *)(v1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v5 = _InterlockedExchangeAdd((volatile signed __int32 *)(v1 - 4), 0xFFFFFFFF);
    }
    else
    {
      v6 = *(_DWORD *)(v1 - 4);
      *(_DWORD *)(v1 - 4) = v6 - 1;
      v5 = v6;
    }
    if ( v5 <= 0 )
      std::string::_Rep::_M_destroy(v2, &v8);
  }
  result = *(_DWORD *)a1;
  v4 = *(_DWORD *)a1 - 12;
  if ( (_DWORD *)v4 != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      result = _InterlockedExchangeAdd((volatile signed __int32 *)(result - 4), 0xFFFFFFFF);
    }
    else
    {
      v7 = *(_DWORD *)(result - 4);
      *(_DWORD *)(result - 4) = v7 - 1;
      result = v7;
    }
    if ( result <= 0 )
      result = std::string::_Rep::_M_destroy(v4, &v8);
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CE20: using guessed type int __cdecl evconnlistener_free(_DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08081910) --------------------------------------------------------
int __cdecl sub_8081910(int a1)
{
  int v1; // esi@1
  int v2; // eax@4
  int v3; // esi@6
  int v4; // eax@8
  int v5; // edx@8
  int result; // eax@9
  int v7; // edx@9
  signed __int32 v8; // eax@15
  signed __int32 v9; // ecx@22
  int v10; // ecx@23
  char v11; // [sp+1Fh] [bp-Dh]@17

  v1 = *(_DWORD *)(a1 + 32);
  *(_DWORD *)(a1 + 32) = 0;
  if ( v1 )
  {
    evdns_base_free(*(_DWORD *)(v1 + 4), 1);
    operator delete((void *)v1);
  }
  if ( *(_DWORD *)(a1 + 12) )
  {
    v2 = *(_DWORD *)(a1 + 16);
    if ( v2 )
    {
LABEL_5:
      (*(void (__cdecl **)(int))(*(_DWORD *)v2 + 4))(v2);
      goto LABEL_6;
    }
    bufferevent_free(*(struct bufferevent **)(a1 + 12));
  }
  v2 = *(_DWORD *)(a1 + 16);
  if ( v2 )
    goto LABEL_5;
LABEL_6:
  v3 = *(_DWORD *)(a1 + 32);
  if ( v3 )
  {
    evdns_base_free(*(_DWORD *)(v3 + 4), 1);
    operator delete((void *)v3);
  }
  *(_DWORD *)(a1 + 32) = 0;
  v4 = *(_DWORD *)(a1 + 28);
  v5 = v4 - 12;
  if ( (_DWORD *)(v4 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v8 = _InterlockedExchangeAdd((volatile signed __int32 *)(v4 - 4), 0xFFFFFFFF);
    }
    else
    {
      v9 = *(_DWORD *)(v4 - 4);
      *(_DWORD *)(v4 - 4) = v9 - 1;
      v8 = v9;
    }
    if ( v8 <= 0 )
      std::string::_Rep::_M_destroy(v5, &v11);
  }
  result = *(_DWORD *)(a1 + 24);
  v7 = result - 12;
  if ( (_DWORD *)(result - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      result = _InterlockedExchangeAdd((volatile signed __int32 *)(result - 4), 0xFFFFFFFF);
    }
    else
    {
      v10 = *(_DWORD *)(result - 4);
      *(_DWORD *)(result - 4) = v10 - 1;
      result = v10;
    }
    if ( result <= 0 )
      result = std::string::_Rep::_M_destroy(v7, &v11);
  }
  return result;
}
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08081A70) --------------------------------------------------------
void __cdecl sub_8081A70(void *a1)
{
  void *v1; // ebx@1

  v1 = (void *)**(_DWORD **)a1;
  if ( v1 )
  {
    sub_8081910(**(_DWORD **)a1);
    operator delete(v1);
  }
}

//----- (08083370) --------------------------------------------------------
signed int __cdecl sub_8083370(int a1)
{
  int v1; // edi@2
  int v2; // eax@2
  int v3; // esi@2
  int v4; // eax@2
  int v5; // edi@5
  int v6; // eax@9
  int v7; // esi@10
  int v8; // ebx@11
  void *v9; // edi@11
  int v10; // eax@11
  int v11; // edx@11
  int v12; // ecx@12
  int v13; // edx@14
  int v14; // edx@15
  int v15; // eax@17
  std::ostream *v16; // esi@17
  int v17; // eax@17
  int v18; // ebx@17
  char v19; // al@19
  std::ostream *v20; // eax@20
  int v21; // eax@21
  int v22; // edx@21
  int v24; // edi@23
  int v25; // eax@23
  int v26; // edx@24
  int v27; // edx@26
  int v28; // edx@27
  int v29; // eax@29
  std::ostream *v30; // ebp@29
  int v31; // eax@29
  int v32; // edi@29
  char v33; // al@31
  std::ostream *v34; // eax@32
  int v35; // edx@33
  signed __int32 v36; // eax@35
  int v37; // eax@38
  int v38; // esi@40
  void *v39; // edi@40
  int v40; // eax@40
  int v41; // edx@40
  int v42; // ecx@41
  int v43; // edx@43
  int v44; // edx@44
  int v45; // eax@46
  std::ostream *v46; // edi@46
  int v47; // eax@46
  int v48; // esi@46
  char v49; // al@48
  std::ostream *v50; // eax@49
  int v51; // edx@50
  signed __int32 v52; // eax@52
  signed __int32 v53; // eax@62
  int v54; // eax@68
  std::runtime_error *v55; // ebx@76
  signed __int32 v56; // edi@79
  signed __int32 v57; // edi@83
  signed __int32 v58; // ecx@87
  signed __int32 v59; // edi@91
  int v60; // ebx@94
  signed __int32 v61; // ecx@98
  signed __int32 v62; // ecx@104
  signed __int32 v63; // ecx@106
  signed __int32 v64; // ecx@108
  signed __int32 v65; // edi@110
  int v66; // [sp+Ch] [bp-110h]@0
  int v67; // [sp+Ch] [bp-110h]@7
  int *v68; // [sp+20h] [bp-FCh]@11
  int v69; // [sp+28h] [bp-F4h]@39
  char v70; // [sp+3Ah] [bp-E2h]@89
  char v71; // [sp+3Bh] [bp-E1h]@13
  int v72; // [sp+3Ch] [bp-E0h]@11
  int v73; // [sp+40h] [bp-DCh]@13
  int v74; // [sp+44h] [bp-D8h]@7
  int v75; // [sp+48h] [bp-D4h]@7
  int v76; // [sp+4Ch] [bp-D0h]@11
  int v77; // [sp+50h] [bp-CCh]@11
  int v78; // [sp+54h] [bp-C8h]@11
  int v79; // [sp+58h] [bp-C4h]@11
  int v80; // [sp+5Ch] [bp-C0h]@11
  int v81; // [sp+60h] [bp-BCh]@11
  int v82; // [sp+64h] [bp-B8h]@11
  int v83; // [sp+68h] [bp-B4h]@11
  char v84; // [sp+6Ch] [bp-B0h]@11
  int v85; // [sp+70h] [bp-ACh]@11
  int v86; // [sp+74h] [bp-A8h]@11
  int v87; // [sp+78h] [bp-A4h]@11
  int v88; // [sp+E8h] [bp-34h]@11
  char v89; // [sp+ECh] [bp-30h]@11
  char v90; // [sp+EDh] [bp-2Fh]@11
  int v91; // [sp+F0h] [bp-2Ch]@11
  int v92; // [sp+F4h] [bp-28h]@11
  int v93; // [sp+F8h] [bp-24h]@11
  int v94; // [sp+FCh] [bp-20h]@11

  if ( log_level <= 1 )
  {
    v37 = *(_DWORD *)(a1 + 16);
    if ( v37 )
    {
      v69 = *(_DWORD *)(v37 + 12);
    }
    else
    {
      if ( *(_DWORD *)(a1 + 12) )
        v54 = bufferevent_getfd(*(_DWORD *)(a1 + 12));
      else
        v54 = 0;
      v69 = v54;
    }
    std::ios_base::ios_base((std::ios_base *)&v87);
    v87 = (int)&unk_80CF5C8;
    v88 = 0;
    v89 = 0;
    v90 = 0;
    v91 = 0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v38 = dword_80CF674;
    v76 = dword_80CF674;
    *(int *)((char *)&v76 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v76 + *(_DWORD *)(v76 - 12), 0);
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF7F0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v81 = 0;
    v82 = 0;
    v83 = 0;
    std::locale::locale((std::locale *)&v84);
    v77 = (int)&unk_80CF588;
    v85 = 16;
    v86 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v87, &v77);
    v39 = (void *)std::__ostream_insert<char,std::char_traits<char>>(
                    &v76,
                    &unk_80CF83C,
                    std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v39, "socks connection ", 17);
    v40 = std::ostream::operator<<(v39, v69);
    v73 = (int)&unk_80CF83C;
    v41 = *(_DWORD *)(v40 + 24);
    if ( v41 )
    {
      v42 = *(_DWORD *)(v40 + 16);
      LOBYTE(v66) = 0;
      if ( v41 <= (unsigned int)v42 )
      {
        v74 = std::string::_S_construct<char *>(a1, (unsigned int)&v87, v39, *(_DWORD *)(v40 + 20), v42, (int)&v72);
        std::string::swap((std::string *)&v73, (std::string *)&v74);
      }
      else
      {
        v74 = std::string::_S_construct<char *>(a1, (unsigned int)&v87, v39, *(_DWORD *)(v40 + 20), v41, (int)&v72);
        std::string::swap((std::string *)&v73, (std::string *)&v74);
      }
      v43 = v74 - 12;
      if ( (_DWORD *)(v74 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v56 = _InterlockedExchangeAdd((volatile signed __int32 *)(v74 - 4), 0xFFFFFFFF);
        }
        else
        {
          v56 = *(_DWORD *)(v74 - 4);
          *(_DWORD *)(v74 - 4) = v56 - 1;
        }
        if ( v56 <= 0 )
          std::string::_Rep::_M_destroy(v43, &v71);
      }
    }
    else
    {
      std::string::assign((std::string *)&v73, (const std::string *)(v40 + 40));
    }
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF588;
    v44 = v86 - 12;
    if ( (_DWORD *)(v86 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v57 = _InterlockedExchangeAdd((volatile signed __int32 *)(v86 - 4), 0xFFFFFFFF);
      }
      else
      {
        v57 = *(_DWORD *)(v86 - 4);
        *(_DWORD *)(v86 - 4) = v57 - 1;
      }
      if ( v57 <= 0 )
        std::string::_Rep::_M_destroy(v44, &v74);
    }
    v77 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v84);
    v76 = v38;
    *(int *)((char *)&v76 + *(_DWORD *)(v38 - 12)) = dword_80CF678;
    v87 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v87);
    if ( byte_80CE64C )
    {
      v45 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v73, *(_DWORD *)(v73 - 12));
      v46 = (std::ostream *)v45;
      v47 = *(_DWORD *)(*(_DWORD *)v45 - 12);
      v48 = *(_DWORD *)((char *)v46 + v47 + 124);
      if ( !v48 )
      {
        v60 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v73 - 12, &v76);
        goto LABEL_95;
      }
      if ( *(_BYTE *)(v48 + 28) )
      {
        v49 = *(_BYTE *)(v48 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v46 + v47 + 124));
        v49 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v48 + 24))(v48, 10);
      }
      v50 = (std::ostream *)std::ostream::put(v46, v49);
      std::ostream::flush(v50);
    }
    syslog(7, "%s", v73, v66);
    v51 = v73 - 12;
    if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v52 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
      }
      else
      {
        v63 = *(_DWORD *)(v73 - 4);
        *(_DWORD *)(v73 - 4) = v63 - 1;
        v52 = v63;
      }
      if ( v52 <= 0 )
        std::string::_Rep::_M_destroy(v51, &v76);
    }
  }
  v1 = *(_DWORD *)(*(_DWORD *)(a1 + 8) + 16);
  v2 = operator new(8u);
  v3 = v2;
  *(_DWORD *)v2 = 0;
  v4 = evdns_base_new(*(_DWORD *)(v1 + 4), 32769);
  *(_DWORD *)(v3 + 4) = v4;
  if ( !v4 )
  {
    v55 = (std::runtime_error *)_cxa_allocate_exception(8);
    std::string::string(&v74, "Event DNS initialization failed", &v76);
    std::runtime_error::runtime_error(v55, (const std::string *)&v74);
    *(_DWORD *)v55 = &off_80BAB18;
    std::string::_Rep::_M_dispose(v74 - 12, &v73);
    _cxa_throw(v55, &off_80BAADC, sub_807B6C0);
  }
  if ( evdns_base_set_option(v4, "randomize-case", 134981637) && log_level <= 5 )
  {
    v68 = &v76;
    std::ios_base::ios_base((std::ios_base *)&v87);
    v87 = (int)&unk_80CF5C8;
    v88 = 0;
    v89 = 0;
    v90 = 0;
    v91 = 0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v76 = dword_80CF674;
    *(int *)((char *)&v76 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v76 + *(_DWORD *)(v76 - 12), 0);
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF7F0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v81 = 0;
    v82 = 0;
    v83 = 0;
    std::locale::locale((std::locale *)&v84);
    v77 = (int)&unk_80CF588;
    v85 = 16;
    v86 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v87, &v77);
    v24 = std::__ostream_insert<char,std::char_traits<char>>(
            &v76,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v24, "Event DNS failed to drop randomize-case option", 46);
    v73 = (int)&unk_80CF83C;
    v25 = *(_DWORD *)(v24 + 24);
    if ( v25 )
    {
      v26 = *(_DWORD *)(v24 + 16);
      LOBYTE(v66) = 0;
      if ( v25 > (unsigned int)v26 )
      {
        v74 = std::string::_S_construct<char *>(
                a1,
                (unsigned int)&v87,
                (void *)v24,
                *(_DWORD *)(v24 + 20),
                v25,
                (int)&v72);
        std::string::swap((std::string *)&v73, (std::string *)&v74);
      }
      else
      {
        v74 = std::string::_S_construct<char *>(
                a1,
                (unsigned int)&v87,
                (void *)v24,
                *(_DWORD *)(v24 + 20),
                v26,
                (int)&v72);
        std::string::swap((std::string *)&v73, (std::string *)&v74);
      }
      v27 = v74 - 12;
      if ( (_DWORD *)(v74 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v65 = _InterlockedExchangeAdd((volatile signed __int32 *)(v74 - 4), 0xFFFFFFFF);
        }
        else
        {
          v65 = *(_DWORD *)(v74 - 4);
          *(_DWORD *)(v74 - 4) = v65 - 1;
        }
        if ( v65 <= 0 )
          std::string::_Rep::_M_destroy(v27, &v71);
      }
    }
    else
    {
      std::string::assign((std::string *)&v73, (const std::string *)(v24 + 40));
    }
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF588;
    v28 = v86 - 12;
    if ( (_DWORD *)(v86 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v59 = _InterlockedExchangeAdd((volatile signed __int32 *)(v86 - 4), 0xFFFFFFFF);
      }
      else
      {
        v59 = *(_DWORD *)(v86 - 4);
        *(_DWORD *)(v86 - 4) = v59 - 1;
      }
      if ( v59 <= 0 )
        std::string::_Rep::_M_destroy(v28, &v74);
    }
    v77 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v84);
    v76 = dword_80CF674;
    *(int *)((char *)&v76 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v87 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v87);
    if ( byte_80CE64C )
    {
      v29 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v73, *(_DWORD *)(v73 - 12));
      v30 = (std::ostream *)v29;
      v31 = *(_DWORD *)(*(_DWORD *)v29 - 12);
      v32 = *(_DWORD *)((char *)v30 + v31 + 124);
      if ( !v32 )
      {
        v21 = std::__throw_bad_cast();
        goto LABEL_108;
      }
      if ( *(_BYTE *)(v32 + 28) )
      {
        v33 = *(_BYTE *)(v32 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v30 + v31 + 124));
        v33 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v32 + 24))(v32, 10);
      }
      v34 = (std::ostream *)std::ostream::put(v30, v33);
      std::ostream::flush(v34);
    }
    syslog(3, "%s", v73, v66);
    v35 = v73 - 12;
    if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
      }
      else
      {
        v62 = *(_DWORD *)(v73 - 4);
        *(_DWORD *)(v73 - 4) = v62 - 1;
        v36 = v62;
      }
      if ( v36 <= 0 )
        std::string::_Rep::_M_destroy(v35, &v76);
    }
  }
  v5 = *(_DWORD *)(a1 + 32);
  *(_DWORD *)(a1 + 32) = v3;
  if ( v5 )
  {
    evdns_base_free(*(_DWORD *)(v5 + 4), 1);
    operator delete((void *)v5);
  }
  bufferevent_setcb(*(_DWORD *)(a1 + 12), sub_808AA70, 0, sub_8083350, a1);
  v74 = 30;
  v75 = 0;
  bufferevent_set_timeouts(*(_DWORD *)(a1 + 12), &v74, 0);
  if ( bufferevent_enable(*(struct bufferevent **)(a1 + 12), 6) )
  {
    if ( log_level > 5 )
      return 0;
    v6 = *(_DWORD *)(a1 + 16);
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 12);
    }
    else if ( *(_DWORD *)(a1 + 12) )
    {
      v7 = bufferevent_getfd(*(_DWORD *)(a1 + 12));
    }
    else
    {
      v7 = 0;
    }
    v68 = &v76;
    std::ios_base::ios_base((std::ios_base *)&v87);
    v87 = (int)&unk_80CF5C8;
    v88 = 0;
    v89 = 0;
    v90 = 0;
    v91 = 0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v8 = dword_80CF674;
    v76 = dword_80CF674;
    *(int *)((char *)&v76 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v76 + *(_DWORD *)(v76 - 12), 0);
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF7F0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v81 = 0;
    v82 = 0;
    v83 = 0;
    std::locale::locale((std::locale *)&v84);
    v77 = (int)&unk_80CF588;
    v85 = 16;
    v86 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v87, &v77);
    v9 = (void *)std::__ostream_insert<char,std::char_traits<char>>(
                   &v76,
                   &unk_80CF83C,
                   std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v9, "socks failed to enable read/write on client", 43);
    v10 = std::ostream::operator<<(v9, v7);
    v72 = (int)&unk_80CF83C;
    v11 = *(_DWORD *)(v10 + 24);
    if ( v11 )
    {
      v12 = *(_DWORD *)(v10 + 16);
      LOBYTE(v67) = 0;
      if ( v11 > (unsigned int)v12 )
      {
        v73 = std::string::_S_construct<char *>(v8, (unsigned int)&v87, v9, *(_DWORD *)(v10 + 20), v11, (int)&v71);
        std::string::swap((std::string *)&v72, (std::string *)&v73);
      }
      else
      {
        v73 = std::string::_S_construct<char *>(v8, (unsigned int)&v87, v9, *(_DWORD *)(v10 + 20), v12, (int)&v71);
        std::string::swap((std::string *)&v72, (std::string *)&v73);
      }
      v13 = v73 - 12;
      if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v58 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
        }
        else
        {
          v58 = *(_DWORD *)(v73 - 4);
          *(_DWORD *)(v73 - 4) = v58 - 1;
        }
        if ( v58 <= 0 )
          std::string::_Rep::_M_destroy(v13, &v70);
      }
    }
    else
    {
      std::string::assign((std::string *)&v72, (const std::string *)(v10 + 40));
    }
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF588;
    v14 = v86 - 12;
    if ( (_DWORD *)(v86 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v61 = _InterlockedExchangeAdd((volatile signed __int32 *)(v86 - 4), 0xFFFFFFFF);
      }
      else
      {
        v61 = *(_DWORD *)(v86 - 4);
        *(_DWORD *)(v86 - 4) = v61 - 1;
      }
      if ( v61 <= 0 )
        std::string::_Rep::_M_destroy(v14, &v73);
    }
    v77 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v84);
    v76 = v8;
    *(int *)((char *)&v76 + *(_DWORD *)(v8 - 12)) = dword_80CF678;
    v87 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v87);
    if ( !byte_80CE64C )
    {
LABEL_21:
      syslog(3, "%s", v72, v67);
      v21 = v72;
      v22 = v72 - 12;
      if ( (_DWORD *)(v72 - 12) == &std::string::_Rep::_S_empty_rep_storage )
        return 0;
      if ( &_pthread_key_create )
      {
        v53 = _InterlockedExchangeAdd((volatile signed __int32 *)(v72 - 4), 0xFFFFFFFF);
        goto LABEL_63;
      }
LABEL_108:
      v64 = *(_DWORD *)(v21 - 4);
      *(_DWORD *)(v21 - 4) = v64 - 1;
      v53 = v64;
LABEL_63:
      if ( v53 <= 0 )
        std::string::_Rep::_M_destroy(v22, v68);
      return 0;
    }
    v15 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v72, *(_DWORD *)(v72 - 12));
    v16 = (std::ostream *)v15;
    v17 = *(_DWORD *)(*(_DWORD *)v15 - 12);
    v18 = *(_DWORD *)((char *)v16 + v17 + 124);
    if ( v18 )
    {
      if ( *(_BYTE *)(v18 + 28) )
      {
        v19 = *(_BYTE *)(v18 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v16 + v17 + 124));
        v19 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v18 + 24))(v18, 10);
      }
      v20 = (std::ostream *)std::ostream::put(v16, v19);
      std::ostream::flush(v20);
      goto LABEL_21;
    }
    v60 = std::__throw_bad_cast();
    std::string::_Rep::_M_dispose(v72 - 12, &v76);
LABEL_95:
    Unwind_Resume(v60);
  }
  return 1;
}
// 804C450: using guessed type int __cdecl evdns_base_new(_DWORD, _DWORD);
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C6E0: using guessed type int __cdecl bufferevent_setcb(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CC70: using guessed type int __cdecl bufferevent_getfd(_DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CEF0: using guessed type int __cdecl _cxa_allocate_exception(_DWORD);
// 804D000: using guessed type int __cdecl bufferevent_set_timeouts(_DWORD, _DWORD, _DWORD);
// 804D090: using guessed type int __cdecl evdns_base_set_option(_DWORD, _DWORD, _DWORD);
// 804D0B0: using guessed type int __cdecl _cxa_throw(_DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 8083350: using guessed type int sub_8083350();
// 808AA70: using guessed type int sub_808AA70();
// 80BAADC: using guessed type void *off_80BAADC;
// 80BAB18: using guessed type void *off_80BAB18;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08084980) --------------------------------------------------------
char __cdecl sub_8084980(int a1, int a2)
{
  void *v2; // edi@2
  int v3; // esi@2
  int v4; // esi@2
  int v5; // eax@2
  int v6; // edx@2
  int v7; // ecx@3
  int v8; // edx@5
  int v9; // edx@6
  int v10; // eax@8
  std::ostream *v11; // edi@8
  int v12; // eax@8
  int v13; // esi@8
  char v14; // al@10
  std::ostream *v15; // eax@11
  int v16; // edx@12
  __int16 v17; // ax@13
  int v18; // eax@13
  int v20; // ebx@20
  int v21; // edi@20
  int v22; // eax@20
  int v23; // edx@21
  int v24; // edx@23
  int v25; // edx@24
  int v26; // eax@26
  std::ostream *v27; // esi@26
  int v28; // eax@26
  int v29; // ebx@26
  char v30; // al@28
  std::ostream *v31; // eax@29
  int v32; // edx@30
  signed __int32 v33; // eax@32
  signed __int32 v34; // eax@38
  signed __int32 v35; // esi@44
  signed __int32 v36; // esi@48
  int v37; // ebx@51
  signed __int32 v38; // ecx@56
  signed __int32 v39; // ecx@60
  signed __int32 v40; // ecx@66
  signed __int32 v41; // ecx@67
  int v42; // [sp+Ch] [bp-110h]@0
  int v43; // [sp+Ch] [bp-110h]@13
  char v44; // [sp+32h] [bp-EAh]@62
  char v45; // [sp+33h] [bp-E9h]@22
  int v46; // [sp+34h] [bp-E8h]@4
  int v47; // [sp+38h] [bp-E4h]@2
  int v48; // [sp+3Ch] [bp-E0h]@4
  char v49; // [sp+40h] [bp-DCh]@13
  int v50; // [sp+4Ch] [bp-D0h]@2
  int v51; // [sp+50h] [bp-CCh]@2
  int v52; // [sp+54h] [bp-C8h]@2
  int v53; // [sp+58h] [bp-C4h]@2
  int v54; // [sp+5Ch] [bp-C0h]@2
  int v55; // [sp+60h] [bp-BCh]@2
  int v56; // [sp+64h] [bp-B8h]@2
  int v57; // [sp+68h] [bp-B4h]@2
  char v58; // [sp+6Ch] [bp-B0h]@2
  int v59; // [sp+70h] [bp-ACh]@2
  int v60; // [sp+74h] [bp-A8h]@2
  int v61; // [sp+78h] [bp-A4h]@2
  int v62; // [sp+E8h] [bp-34h]@2
  char v63; // [sp+ECh] [bp-30h]@2
  char v64; // [sp+EDh] [bp-2Fh]@2
  int v65; // [sp+F0h] [bp-2Ch]@2
  int v66; // [sp+F4h] [bp-28h]@2
  int v67; // [sp+F8h] [bp-24h]@2
  int v68; // [sp+FCh] [bp-20h]@2

  if ( log_level <= 3 )
  {
    v2 = *(void **)(a1 + 8);
    std::ios_base::ios_base((std::ios_base *)&v61);
    v61 = (int)&unk_80CF5C8;
    v62 = 0;
    v63 = 0;
    v64 = 0;
    v65 = 0;
    v66 = 0;
    v67 = 0;
    v68 = 0;
    v50 = dword_80CF674;
    *(int *)((char *)&v50 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v50 + *(_DWORD *)(v50 - 12), 0);
    v50 = (int)&unk_80CF5DC;
    v61 = (int)&unk_80CF5F0;
    v51 = (int)&unk_80CF7F0;
    v52 = 0;
    v53 = 0;
    v54 = 0;
    v55 = 0;
    v56 = 0;
    v57 = 0;
    std::locale::locale((std::locale *)&v58);
    v51 = (int)&unk_80CF588;
    v59 = 16;
    v60 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v61, &v51);
    v3 = std::__ostream_insert<char,std::char_traits<char>>(&v50, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v3, "starting socks server ", 22);
    v4 = std::__ostream_insert<char,std::char_traits<char>>(
           v3,
           *(_DWORD *)(a1 + 4),
           *(_DWORD *)(*(_DWORD *)(a1 + 4) - 12));
    std::__ostream_insert<char,std::char_traits<char>>(v4, ":", 1);
    v5 = std::ostream::operator<<(v4, v2);
    v47 = (int)&unk_80CF83C;
    v6 = *(_DWORD *)(v5 + 24);
    if ( v6 )
    {
      v7 = *(_DWORD *)(v5 + 16);
      LOBYTE(v42) = 0;
      if ( v6 <= (unsigned int)v7 )
      {
        v48 = std::string::_S_construct<char *>(a1, (unsigned int)&v61, &v46, *(_DWORD *)(v5 + 20), v7, (int)&v46);
        std::string::swap((std::string *)&v47, (std::string *)&v48);
      }
      else
      {
        v48 = std::string::_S_construct<char *>(a1, (unsigned int)&v61, v2, *(_DWORD *)(v5 + 20), v6, (int)&v46);
        std::string::swap((std::string *)&v47, (std::string *)&v48);
      }
      v8 = v48 - 12;
      if ( (_DWORD *)(v48 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v35 = _InterlockedExchangeAdd((volatile signed __int32 *)(v48 - 4), 0xFFFFFFFF);
        }
        else
        {
          v35 = *(_DWORD *)(v48 - 4);
          *(_DWORD *)(v48 - 4) = v35 - 1;
        }
        if ( v35 <= 0 )
          std::string::_Rep::_M_destroy(v8, &v45);
      }
    }
    else
    {
      std::string::assign((std::string *)&v47, (const std::string *)(v5 + 40));
    }
    v50 = (int)&unk_80CF5DC;
    v61 = (int)&unk_80CF5F0;
    v51 = (int)&unk_80CF588;
    v9 = v60 - 12;
    if ( (_DWORD *)(v60 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v60 - 4), 0xFFFFFFFF);
      }
      else
      {
        v36 = *(_DWORD *)(v60 - 4);
        *(_DWORD *)(v60 - 4) = v36 - 1;
      }
      if ( v36 <= 0 )
        std::string::_Rep::_M_destroy(v9, &v48);
    }
    v51 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v58);
    v50 = dword_80CF674;
    *(int *)((char *)&v50 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v61 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v61);
    if ( byte_80CE64C )
    {
      v10 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v47, *(_DWORD *)(v47 - 12));
      v11 = (std::ostream *)v10;
      v12 = *(_DWORD *)(*(_DWORD *)v10 - 12);
      v13 = *(_DWORD *)((char *)v11 + v12 + 124);
      if ( !v13 )
      {
        v37 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v47 - 12, &v50);
        goto LABEL_52;
      }
      if ( *(_BYTE *)(v13 + 28) )
      {
        v14 = *(_BYTE *)(v13 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v11 + v12 + 124));
        v14 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v13 + 24))(v13, 10);
      }
      v15 = (std::ostream *)std::ostream::put(v11, v14);
      std::ostream::flush(v15);
    }
    syslog(5, "%s", v47, v42);
    v16 = v47 - 12;
    if ( (_DWORD *)(v47 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v34 = _InterlockedExchangeAdd((volatile signed __int32 *)(v47 - 4), 0xFFFFFFFF);
      }
      else
      {
        v41 = *(_DWORD *)(v47 - 4);
        *(_DWORD *)(v47 - 4) = v41 - 1;
        v34 = v41;
      }
      if ( v34 <= 0 )
        std::string::_Rep::_M_destroy(v16, &v50);
    }
  }
  *(_DWORD *)(a1 + 16) = a2;
  memset(&v48, 0, 0x10u);
  LOWORD(v48) = 2;
  evutil_inet_pton(2, *(_DWORD *)(a1 + 4), &v49);
  v17 = __ROR2__(*(_DWORD *)(a1 + 8), 8);
  HIWORD(v48) = v17;
  v18 = evconnlistener_new_bind(*(_DWORD *)(a2 + 4), sub_8084970, a1, 10, -1, &v48, 16);
  *(_DWORD *)(a1 + 12) = v18;
  if ( v18 )
    return 1;
  if ( log_level > 5 )
    return 0;
  std::ios_base::ios_base((std::ios_base *)&v61);
  v61 = (int)&unk_80CF5C8;
  v62 = 0;
  v63 = 0;
  v64 = 0;
  v65 = 0;
  v66 = 0;
  v67 = 0;
  v68 = 0;
  v20 = dword_80CF674;
  v50 = dword_80CF674;
  *(int *)((char *)&v50 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v50 + *(_DWORD *)(v50 - 12), 0);
  v50 = (int)&unk_80CF5DC;
  v61 = (int)&unk_80CF5F0;
  v51 = (int)&unk_80CF7F0;
  v52 = 0;
  v53 = 0;
  v54 = 0;
  v55 = 0;
  v56 = 0;
  v57 = 0;
  std::locale::locale((std::locale *)&v58);
  v51 = (int)&unk_80CF588;
  v59 = 16;
  v60 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v61, &v51);
  v21 = std::__ostream_insert<char,std::char_traits<char>>(&v50, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v21, "couldn't create socks listener", 30);
  v46 = (int)&unk_80CF83C;
  v22 = *(_DWORD *)(v21 + 24);
  if ( v22 )
  {
    v23 = *(_DWORD *)(v21 + 16);
    LOBYTE(v43) = 0;
    if ( v22 > (unsigned int)v23 )
    {
      v47 = std::string::_S_construct<char *>(
              v20,
              (unsigned int)&v61,
              (void *)v21,
              *(_DWORD *)(v21 + 20),
              v22,
              (int)&v45);
      std::string::swap((std::string *)&v46, (std::string *)&v47);
    }
    else
    {
      v47 = std::string::_S_construct<char *>(
              v20,
              (unsigned int)&v61,
              (void *)v21,
              *(_DWORD *)(v21 + 20),
              v23,
              (int)&v45);
      std::string::swap((std::string *)&v46, (std::string *)&v47);
    }
    v24 = v47 - 12;
    if ( (_DWORD *)(v47 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v47 - 4), 0xFFFFFFFF);
      }
      else
      {
        v39 = *(_DWORD *)(v47 - 4);
        *(_DWORD *)(v47 - 4) = v39 - 1;
      }
      if ( v39 <= 0 )
        std::string::_Rep::_M_destroy(v24, &v44);
    }
  }
  else
  {
    std::string::assign((std::string *)&v46, (const std::string *)(v21 + 40));
  }
  v50 = (int)&unk_80CF5DC;
  v61 = (int)&unk_80CF5F0;
  v51 = (int)&unk_80CF588;
  v25 = v60 - 12;
  if ( (_DWORD *)(v60 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v60 - 4), 0xFFFFFFFF);
    }
    else
    {
      v38 = *(_DWORD *)(v60 - 4);
      *(_DWORD *)(v60 - 4) = v38 - 1;
    }
    if ( v38 <= 0 )
      std::string::_Rep::_M_destroy(v25, &v47);
  }
  v51 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v58);
  v50 = v20;
  *(int *)((char *)&v50 + *(_DWORD *)(v20 - 12)) = dword_80CF678;
  v61 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v61);
  if ( !byte_80CE64C )
    goto LABEL_30;
  v26 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v46, *(_DWORD *)(v46 - 12));
  v27 = (std::ostream *)v26;
  v28 = *(_DWORD *)(*(_DWORD *)v26 - 12);
  v29 = *(_DWORD *)((char *)v27 + v28 + 124);
  if ( !v29 )
  {
    v37 = std::__throw_bad_cast();
    std::string::_Rep::_M_dispose(v46 - 12, &v50);
LABEL_52:
    Unwind_Resume(v37);
  }
  if ( *(_BYTE *)(v29 + 28) )
  {
    v30 = *(_BYTE *)(v29 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v27 + v28 + 124));
    v30 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v29 + 24))(v29, 10);
  }
  v31 = (std::ostream *)std::ostream::put(v27, v30);
  std::ostream::flush(v31);
LABEL_30:
  syslog(3, "%s", v46, v43);
  v32 = v46 - 12;
  if ( (_DWORD *)(v46 - 12) == &std::string::_Rep::_S_empty_rep_storage )
    return 0;
  if ( &_pthread_key_create )
  {
    v33 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
  }
  else
  {
    v40 = *(_DWORD *)(v46 - 4);
    *(_DWORD *)(v46 - 4) = v40 - 1;
    v33 = v40;
  }
  if ( v33 > 0 )
    return 0;
  std::string::_Rep::_M_destroy(v32, &v50);
  return 0;
}
// 804C3E0: using guessed type int __cdecl evutil_inet_pton(_DWORD, _DWORD, _DWORD);
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D2E0: using guessed type int __cdecl evconnlistener_new_bind(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 8084970: using guessed type int sub_8084970();
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08085400) --------------------------------------------------------
signed int __cdecl sub_8085400(int a1)
{
  unsigned int v1; // ebp@0
  int v2; // edx@1
  int v3; // eax@4
  int v4; // ebx@6
  int v5; // esi@6
  int v6; // eax@6
  int v7; // edx@6
  int v8; // ecx@7
  int v9; // edx@9
  int v10; // edx@10
  int v11; // eax@12
  std::ostream *v12; // esi@12
  int v13; // eax@12
  int v14; // ebx@12
  char v15; // al@14
  std::ostream *v16; // eax@15
  int v17; // edx@16
  struct evbuffer *v19; // esi@21
  int v20; // edi@21
  int v21; // eax@25
  int v22; // eax@29
  int v23; // esi@30
  int v24; // edi@31
  int v25; // ebx@31
  int v26; // eax@31
  int v27; // edx@31
  int v28; // ecx@32
  int v29; // edx@34
  int v30; // edx@35
  int v31; // eax@37
  std::ostream *v32; // esi@37
  int v33; // eax@37
  int v34; // ebx@37
  char v35; // al@39
  std::ostream *v36; // eax@40
  int v37; // edx@41
  signed __int32 v38; // eax@43
  signed __int32 v39; // eax@48
  int v40; // edx@60
  int v41; // ebx@61
  int v42; // eax@62
  int v43; // eax@62
  int v44; // eax@62
  int v45; // eax@62
  int v46; // eax@62
  int v47; // eax@63
  int v48; // edx@73
  int v49; // ebx@74
  int v50; // eax@75
  int v51; // eax@75
  int v52; // eax@75
  int v53; // eax@76
  int v54; // edx@81
  int v55; // ebx@82
  int v56; // eax@83
  int v57; // eax@83
  int v58; // eax@83
  int v59; // eax@84
  int v60; // eax@86
  int v61; // edx@89
  int v62; // ebx@90
  int v63; // eax@91
  int v64; // eax@91
  int v65; // eax@91
  int v66; // eax@92
  unsigned __int16 v67; // di@96
  int v68; // edx@99
  int v69; // esi@100
  int v70; // eax@101
  int v71; // eax@101
  int v72; // eax@101
  int v73; // eax@101
  int v74; // eax@101
  int v75; // eax@102
  signed __int32 v76; // ecx@107
  signed __int32 v77; // ecx@111
  int v78; // ebx@116
  int *v79; // edi@118
  char *v80; // esi@118
  signed int v81; // eax@119
  __int16 v82; // ax@126
  _UNKNOWN *v83; // esi@131
  int v84; // edx@134
  int v85; // eax@136
  int v86; // eax@136
  int v87; // eax@136
  int v88; // eax@136
  int v89; // eax@136
  int v90; // eax@136
  int v91; // eax@136
  int v92; // eax@136
  int v93; // eax@136
  int v94; // eax@138
  int v95; // ST24_4@142
  int v96; // ST30_4@142
  int v97; // esi@142
  int (__cdecl *v98)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // ST28_4@145
  int v99; // eax@145
  int v100; // eax@145
  char v101; // di@145
  int v102; // edx@151
  int v103; // edi@152
  int v104; // eax@153
  int v105; // eax@153
  int v106; // eax@153
  int v107; // eax@154
  int v108; // ST30_4@159
  int v109; // eax@167
  int v110; // edx@171
  int v111; // esi@172
  int v112; // eax@173
  int v113; // eax@173
  int v114; // eax@173
  int v115; // eax@175
  int v116; // edx@178
  int v117; // esi@179
  int v118; // eax@180
  int v119; // eax@180
  int v120; // eax@180
  int v121; // eax@186
  signed __int32 v122; // ecx@189
  signed __int32 v123; // ecx@195
  signed __int32 v124; // ecx@198
  signed __int32 v125; // ecx@201
  int v126; // [sp+Ch] [bp-31Ch]@0
  int v127; // [sp+18h] [bp-310h]@135
  char *v128; // [sp+1Ch] [bp-30Ch]@132
  bool v129; // [sp+20h] [bp-308h]@96
  unsigned int v130; // [sp+24h] [bp-304h]@86
  char v131; // [sp+24h] [bp-304h]@97
  char v132; // [sp+24h] [bp-304h]@131
  char *s1; // [sp+28h] [bp-300h]@5
  char *s1a; // [sp+28h] [bp-300h]@62
  char *s1b; // [sp+28h] [bp-300h]@95
  std::string *v136; // [sp+2Ch] [bp-2FCh]@145
  char v137; // [sp+3Bh] [bp-2EDh]@167
  char v138; // [sp+3Ch] [bp-2ECh]@62
  char v139; // [sp+3Dh] [bp-2EBh]@101
  char data; // [sp+3Eh] [bp-2EAh]@27
  char v141; // [sp+3Fh] [bp-2E9h]@27
  int v142; // [sp+40h] [bp-2E8h]@33
  int v143; // [sp+44h] [bp-2E4h]@8
  int (__cdecl *v144)(void **, void **, signed int); // [sp+4Ch] [bp-2DCh]@145
  int (*v145)(); // [sp+50h] [bp-2D8h]@145
  int v146; // [sp+54h] [bp-2D4h]@6
  int (__cdecl *v147)(void **, void **, signed int); // [sp+5Ch] [bp-2CCh]@145
  void (__cdecl *v148)(void *); // [sp+60h] [bp-2C8h]@145
  int v149; // [sp+108h] [bp-220h]@8
  int v150; // [sp+10Ch] [bp-21Ch]@31
  int v151; // [sp+110h] [bp-218h]@31
  int v152; // [sp+114h] [bp-214h]@31
  int v153; // [sp+118h] [bp-210h]@31
  int v154; // [sp+11Ch] [bp-20Ch]@31
  int v155; // [sp+120h] [bp-208h]@31
  int v156; // [sp+124h] [bp-204h]@31
  char v157; // [sp+128h] [bp-200h]@31
  int v158; // [sp+12Ch] [bp-1FCh]@31
  int v159; // [sp+130h] [bp-1F8h]@31
  int v160; // [sp+134h] [bp-1F4h]@31
  int v161; // [sp+1A4h] [bp-184h]@31
  char v162; // [sp+1A8h] [bp-180h]@31
  char v163; // [sp+1A9h] [bp-17Fh]@31
  int v164; // [sp+1ACh] [bp-17Ch]@31
  int v165; // [sp+1B0h] [bp-178h]@31
  int v166; // [sp+1B4h] [bp-174h]@31
  int v167; // [sp+1B8h] [bp-170h]@31
  int v168; // [sp+208h] [bp-120h]@6
  int v169; // [sp+20Ch] [bp-11Ch]@6
  int v170; // [sp+210h] [bp-118h]@6
  int v171; // [sp+214h] [bp-114h]@6
  int v172; // [sp+218h] [bp-110h]@6
  int v173; // [sp+21Ch] [bp-10Ch]@6
  int v174; // [sp+220h] [bp-108h]@6
  int v175; // [sp+224h] [bp-104h]@6
  char v176; // [sp+228h] [bp-100h]@6
  int v177; // [sp+22Ch] [bp-FCh]@6
  int v178; // [sp+230h] [bp-F8h]@6
  int v179; // [sp+234h] [bp-F4h]@6
  int v180; // [sp+2A4h] [bp-84h]@6
  char v181; // [sp+2A8h] [bp-80h]@6
  char v182; // [sp+2A9h] [bp-7Fh]@6
  int v183; // [sp+2ACh] [bp-7Ch]@6
  int v184; // [sp+2B0h] [bp-78h]@6
  int v185; // [sp+2B4h] [bp-74h]@6
  int v186; // [sp+2B8h] [bp-70h]@6

  v2 = *(_DWORD *)(a1 + 12);
  if ( !v2 || *(_DWORD *)a1 != 3 )
  {
    if ( log_level <= 5 )
    {
      v3 = *(_DWORD *)(a1 + 16);
      if ( v3 )
      {
        s1 = *(char **)(v3 + 12);
      }
      else
      {
        if ( v2 )
          v21 = bufferevent_getfd(*(_DWORD *)(a1 + 12));
        else
          v21 = 0;
        s1 = (char *)v21;
      }
      std::ios_base::ios_base((std::ios_base *)&v179);
      v179 = (int)&unk_80CF5C8;
      v180 = 0;
      v181 = 0;
      v182 = 0;
      v183 = 0;
      v184 = 0;
      v185 = 0;
      v186 = 0;
      v4 = dword_80CF674;
      v168 = dword_80CF674;
      *(int *)((char *)&v168 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v168 + *(_DWORD *)(v168 - 12), 0);
      v168 = (int)&unk_80CF5DC;
      v179 = (int)&unk_80CF5F0;
      v169 = (int)&unk_80CF7F0;
      v170 = 0;
      v171 = 0;
      v172 = 0;
      v173 = 0;
      v174 = 0;
      v175 = 0;
      std::locale::locale((std::locale *)&v176);
      v169 = (int)&unk_80CF588;
      v177 = 16;
      v178 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v179, &v169);
      v5 = std::__ostream_insert<char,std::char_traits<char>>(
             &v168,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v5, "socks request invalid state ", 28);
      v6 = std::ostream::operator<<(v5, s1);
      v146 = (int)&unk_80CF83C;
      v7 = *(_DWORD *)(v6 + 24);
      if ( v7 )
      {
        v8 = *(_DWORD *)(v6 + 16);
        LOBYTE(v126) = 0;
        if ( v7 > (unsigned int)v8 )
        {
          v149 = std::string::_S_construct<char *>(v4, v1, &v179, *(_DWORD *)(v6 + 20), v7, (int)&v143);
          std::string::swap((std::string *)&v146, (std::string *)&v149);
        }
        else
        {
          v149 = std::string::_S_construct<char *>(v4, v1, &v179, *(_DWORD *)(v6 + 20), v8, (int)&v143);
          std::string::swap((std::string *)&v146, (std::string *)&v149);
        }
        v9 = v149 - 12;
        if ( (_DWORD *)(v149 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v76 = _InterlockedExchangeAdd((volatile signed __int32 *)(v149 - 4), 0xFFFFFFFF);
          }
          else
          {
            v76 = *(_DWORD *)(v149 - 4);
            *(_DWORD *)(v149 - 4) = v76 - 1;
          }
          if ( v76 <= 0 )
            std::string::_Rep::_M_destroy(v9, &v142);
        }
      }
      else
      {
        std::string::assign((std::string *)&v146, (const std::string *)(v6 + 40));
      }
      v168 = (int)&unk_80CF5DC;
      v179 = (int)&unk_80CF5F0;
      v169 = (int)&unk_80CF588;
      v10 = v178 - 12;
      if ( (_DWORD *)(v178 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v77 = _InterlockedExchangeAdd((volatile signed __int32 *)(v178 - 4), 0xFFFFFFFF);
        }
        else
        {
          v77 = *(_DWORD *)(v178 - 4);
          *(_DWORD *)(v178 - 4) = v77 - 1;
        }
        if ( v77 <= 0 )
          std::string::_Rep::_M_destroy(v10, &v149);
      }
      v169 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v176);
      v168 = v4;
      *(int *)((char *)&v168 + *(_DWORD *)(v4 - 12)) = dword_80CF678;
      v179 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v179);
      if ( !byte_80CE64C )
        goto LABEL_16;
      v11 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v146, *(_DWORD *)(v146 - 12));
      v12 = (std::ostream *)v11;
      v13 = *(_DWORD *)(*(_DWORD *)v11 - 12);
      v14 = *(_DWORD *)((char *)v12 + v13 + 124);
      if ( v14 )
      {
        if ( *(_BYTE *)(v14 + 28) )
        {
          v15 = *(_BYTE *)(v14 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v12 + v13 + 124));
          v15 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v14 + 24))(v14, 10);
        }
        v16 = (std::ostream *)std::ostream::put(v12, v15);
        std::ostream::flush(v16);
LABEL_16:
        syslog(3, "%s", v146, v126);
        v17 = v146 - 12;
        if ( (_DWORD *)(v146 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v146 - 4), 0xFFFFFFFF);
          }
          else
          {
            v125 = *(_DWORD *)(v146 - 4);
            *(_DWORD *)(v146 - 4) = v125 - 1;
            v39 = v125;
          }
          if ( v39 <= 0 )
            std::string::_Rep::_M_destroy(v17, &v168);
        }
        return -1;
      }
      v78 = std::__throw_bad_cast();
      std::string::_Rep::_M_dispose(v146 - 12, &v168);
LABEL_117:
      Unwind_Resume(v78);
    }
    return -1;
  }
  v19 = (struct evbuffer *)bufferevent_get_input(*(_DWORD *)(a1 + 12));
  v20 = evbuffer_get_length(v19);
  if ( !v20 )
    return 0;
  data = 5;
  v141 = 0;
  evbuffer_copyout(v19, &v168, 1);
  if ( (_BYTE)v168 != 5 )
  {
    if ( log_level <= 5 )
    {
      v22 = *(_DWORD *)(a1 + 16);
      if ( v22 )
      {
        v23 = *(_DWORD *)(v22 + 12);
      }
      else if ( *(_DWORD *)(a1 + 12) )
      {
        v23 = bufferevent_getfd(*(_DWORD *)(a1 + 12));
      }
      else
      {
        v23 = 0;
      }
      std::ios_base::ios_base((std::ios_base *)&v160);
      v160 = (int)&unk_80CF5C8;
      v161 = 0;
      v162 = 0;
      v163 = 0;
      v164 = 0;
      v165 = 0;
      v166 = 0;
      v167 = 0;
      v24 = dword_80CF674;
      v149 = dword_80CF674;
      *(int *)((char *)&v149 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v149 + *(_DWORD *)(v149 - 12), 0);
      v149 = (int)&unk_80CF5DC;
      v160 = (int)&unk_80CF5F0;
      v150 = (int)&unk_80CF7F0;
      v151 = 0;
      v152 = 0;
      v153 = 0;
      v154 = 0;
      v155 = 0;
      v156 = 0;
      std::locale::locale((std::locale *)&v157);
      v150 = (int)&unk_80CF588;
      v158 = 16;
      v159 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v160, &v150);
      v25 = std::__ostream_insert<char,std::char_traits<char>>(
              &v149,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v25, "socks request invalid version ", 30);
      v26 = std::ostream::operator<<(v25, v23);
      v143 = (int)&unk_80CF83C;
      v27 = *(_DWORD *)(v26 + 24);
      if ( v27 )
      {
        v28 = *(_DWORD *)(v26 + 16);
        LOBYTE(v126) = 0;
        if ( v27 <= (unsigned int)v28 )
        {
          v146 = std::string::_S_construct<char *>(v25, v1, (void *)v24, *(_DWORD *)(v26 + 20), v28, (int)&v142);
          std::string::swap((std::string *)&v143, (std::string *)&v146);
        }
        else
        {
          v146 = std::string::_S_construct<char *>(v25, v1, (void *)v24, *(_DWORD *)(v26 + 20), v27, (int)&v142);
          std::string::swap((std::string *)&v143, (std::string *)&v146);
        }
        v29 = v146 - 12;
        if ( (_DWORD *)(v146 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v122 = _InterlockedExchangeAdd((volatile signed __int32 *)(v146 - 4), 0xFFFFFFFF);
          }
          else
          {
            v122 = *(_DWORD *)(v146 - 4);
            *(_DWORD *)(v146 - 4) = v122 - 1;
          }
          if ( v122 <= 0 )
            std::string::_Rep::_M_destroy(v29, &v139);
        }
      }
      else
      {
        std::string::assign((std::string *)&v143, (const std::string *)(v26 + 40));
      }
      v149 = (int)&unk_80CF5DC;
      v160 = (int)&unk_80CF5F0;
      v150 = (int)&unk_80CF588;
      v30 = v159 - 12;
      if ( (_DWORD *)(v159 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v123 = _InterlockedExchangeAdd((volatile signed __int32 *)(v159 - 4), 0xFFFFFFFF);
        }
        else
        {
          v123 = *(_DWORD *)(v159 - 4);
          *(_DWORD *)(v159 - 4) = v123 - 1;
        }
        if ( v123 <= 0 )
          std::string::_Rep::_M_destroy(v30, &v146);
      }
      v150 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v157);
      v149 = v24;
      *(int *)((char *)&v149 + *(_DWORD *)(v24 - 12)) = dword_80CF678;
      v160 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v160);
      if ( byte_80CE64C )
      {
        v31 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v143, *(_DWORD *)(v143 - 12));
        v32 = (std::ostream *)v31;
        v33 = *(_DWORD *)(*(_DWORD *)v31 - 12);
        v34 = *(_DWORD *)((char *)v32 + v33 + 124);
        if ( !v34 )
        {
          v78 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v143 - 12, &v149);
          goto LABEL_117;
        }
        if ( *(_BYTE *)(v34 + 28) )
        {
          v35 = *(_BYTE *)(v34 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v32 + v33 + 124));
          v35 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v34 + 24))(v34, 10);
        }
        v36 = (std::ostream *)std::ostream::put(v32, v35);
        std::ostream::flush(v36);
      }
      syslog(3, "%s", v143, v126);
      v37 = v143 - 12;
      if ( (_DWORD *)(v143 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v143 - 4), 0xFFFFFFFF);
        }
        else
        {
          v124 = *(_DWORD *)(v143 - 4);
          *(_DWORD *)(v143 - 4) = v124 - 1;
          v38 = v124;
        }
        if ( v38 <= 0 )
          std::string::_Rep::_M_destroy(v37, &v149);
      }
    }
    return -1;
  }
  if ( (unsigned int)v20 <= 7 )
    return 0;
  evbuffer_copyout(v19, &v168, 8);
  if ( (unsigned __int8)(BYTE1(v168) - 1) > 2u
    || (*(_BYTE *)(a1 + 5) = BYTE1(v168), (unsigned __int8)(BYTE3(v168) - 1) > 3u)
    || BYTE3(v168) == 2 )
  {
LABEL_104:
    v141 = 7;
LABEL_105:
    bufferevent_write(*(struct bufferevent **)(a1 + 12), &data, 2u);
    return -1;
  }
  if ( BYTE3(v168) == 1 )
  {
    if ( (unsigned int)v20 <= 9 )
      return 0;
    if ( v20 != 10 )
    {
      if ( log_level > 5 )
        return -1;
      v48 = *(_DWORD *)(a1 + 16);
      if ( v48 )
        v49 = *(_DWORD *)(v48 + 12);
      else
        v49 = sub_804D5EC(*(_DWORD *)(a1 + 12));
      s1a = (char *)&v149;
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v149, 16);
      v50 = std::__ostream_insert<char,std::char_traits<char>>(
              &v149,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      v51 = std::operator<<<std::char_traits<char>>(v50, "socks request invalid ipv4 address length ");
      v52 = std::ostream::operator<<(v51, v49);
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v146, v52 + 4);
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v149);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v149);
      if ( byte_80CE64C )
      {
        v53 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v146, *(_DWORD *)(v146 - 12));
        std::endl<char,std::char_traits<char>>(v53);
      }
      syslog(3, "%s", v146);
      goto LABEL_65;
    }
    evbuffer_remove(v19, &v168, 0xAu);
    s1b = (char *)&v149;
    if ( !evutil_inet_ntop(2, &v169, &v149, 256) )
    {
      if ( log_level > 5 )
        goto LABEL_157;
      v116 = *(_DWORD *)(a1 + 16);
      if ( v116 )
        v117 = *(_DWORD *)(v116 + 12);
      else
        v117 = sub_804D5EC(*(_DWORD *)(a1 + 12));
      v136 = (std::string *)&v146;
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v146, 16);
      v118 = std::__ostream_insert<char,std::char_traits<char>>(
               &v146,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
      v119 = std::operator<<<std::char_traits<char>>(v118, "socks evutil_inet_ntop() failed while processing request ");
      v120 = std::ostream::operator<<(v119, v117);
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v143, v120 + 4);
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v146);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v146);
      if ( byte_80CE64C )
      {
        v121 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v143, *(_DWORD *)(v143 - 12));
        std::endl<char,std::char_traits<char>>(v121);
      }
      syslog(3, "%s", v143);
      goto LABEL_156;
    }
    v129 = (_BYTE)v169 == 127;
    v67 = __ROR2__(v170, 8);
  }
  else
  {
    if ( BYTE3(v168) != 4 )
    {
      if ( BYTE3(v168) != 3 )
      {
        if ( log_level > 5 )
          return -1;
        v40 = *(_DWORD *)(a1 + 16);
        if ( v40 )
          v41 = *(_DWORD *)(v40 + 12);
        else
          v41 = sub_804D5EC(*(_DWORD *)(a1 + 12));
        s1a = (char *)&v149;
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v149, 16);
        v42 = std::__ostream_insert<char,std::char_traits<char>>(
                &v149,
                &unk_80CF83C,
                std::string::_Rep::_S_empty_rep_storage);
        v43 = std::operator<<<std::char_traits<char>>(v42, "socks unsupported type: ");
        v138 = 2;
        v44 = std::__ostream_insert<char,std::char_traits<char>>(v43, &v138, 1);
        v45 = std::operator<<<std::char_traits<char>>(v44, " ");
        v46 = std::ostream::operator<<(v45, v41);
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v146, v46 + 4);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v149);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v149);
        if ( byte_80CE64C )
        {
          v47 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v146, *(_DWORD *)(v146 - 12));
          std::endl<char,std::char_traits<char>>(v47);
        }
        syslog(3, "%s", v146);
        goto LABEL_65;
      }
      v130 = (unsigned __int8)v169;
      v60 = (unsigned __int8)v169 + 7;
      if ( v20 >= (unsigned int)v60 )
      {
        if ( v20 > (unsigned int)v60 )
        {
          if ( log_level > 5 )
            return -1;
          v61 = *(_DWORD *)(a1 + 16);
          if ( v61 )
            v62 = *(_DWORD *)(v61 + 12);
          else
            v62 = sub_804D5EC(*(_DWORD *)(a1 + 12));
          s1a = (char *)&v149;
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v149, 16);
          v63 = std::__ostream_insert<char,std::char_traits<char>>(
                  &v149,
                  &unk_80CF83C,
                  std::string::_Rep::_S_empty_rep_storage);
          v64 = std::operator<<<std::char_traits<char>>(v63, "socks request invalid domain name length ");
          v65 = std::ostream::operator<<(v64, v62);
          std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v146, v65 + 4);
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v149);
          std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v149);
          if ( byte_80CE64C )
          {
            v66 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v146, *(_DWORD *)(v146 - 12));
            std::endl<char,std::char_traits<char>>(v66);
          }
          syslog(3, "%s", v146);
LABEL_65:
          std::string::_Rep::_M_dispose(v146 - 12, s1a);
          return -1;
        }
        evbuffer_remove(v19, &v168, (unsigned __int8)v169 + 7);
        s1b = (char *)&v149;
        v79 = &v149;
        v80 = (char *)&v169 + 1;
        if ( v130 >= 4 )
        {
          qmemcpy(&v149, (char *)&v169 + 1, 4 * (v130 >> 2));
          v80 = (char *)&v169 + 4 * (v130 >> 2) + 1;
          v79 = &v149 + (v130 >> 2);
        }
        v81 = 0;
        if ( v130 & 2 )
        {
          *(_WORD *)v79 = *(_WORD *)v80;
          v81 = 2;
        }
        if ( v130 & 1 )
          *((_BYTE *)v79 + v81) = v80[v81];
        *((_BYTE *)&v149 + v130) = 0;
        if ( !strcmp((const char *)&v149, "127.0.0.1") )
        {
          v82 = *(_WORD *)((char *)&v169 + v130 + 1);
          v129 = 1;
        }
        else
        {
          v129 = 1;
          if ( strcmp((const char *)&v149, "127.0.0.2") )
            v129 = strcmp((const char *)&v149, "localhost") == 0;
          v82 = *(_WORD *)((char *)&v169 + v130 + 1);
        }
        v67 = __ROR2__(v82, 8);
        goto LABEL_97;
      }
      return 0;
    }
    if ( (unsigned int)v20 <= 0x15 )
      return 0;
    if ( v20 != 22 )
    {
      if ( log_level > 5 )
        return -1;
      v54 = *(_DWORD *)(a1 + 16);
      if ( v54 )
        v55 = *(_DWORD *)(v54 + 12);
      else
        v55 = sub_804D5EC(*(_DWORD *)(a1 + 12));
      s1a = (char *)&v149;
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v149, 16);
      v56 = std::__ostream_insert<char,std::char_traits<char>>(
              &v149,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      v57 = std::operator<<<std::char_traits<char>>(v56, "socks request invlaid ipv6 address length ");
      v58 = std::ostream::operator<<(v57, v55);
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v146, v58 + 4);
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v149);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v149);
      if ( byte_80CE64C )
      {
        v59 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v146, *(_DWORD *)(v146 - 12));
        std::endl<char,std::char_traits<char>>(v59);
      }
      syslog(3, "%s", v146);
      goto LABEL_65;
    }
    evbuffer_remove(v19, &v168, 0x16u);
    s1b = (char *)&v149;
    if ( !evutil_inet_ntop(10, &v169, &v149, 256) )
    {
      if ( log_level > 5 )
        goto LABEL_157;
      v110 = *(_DWORD *)(a1 + 16);
      if ( v110 )
        v111 = *(_DWORD *)(v110 + 12);
      else
        v111 = sub_804D5EC(*(_DWORD *)(a1 + 12));
      v136 = (std::string *)&v146;
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v146, 16);
      v112 = std::__ostream_insert<char,std::char_traits<char>>(
               &v146,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
      v113 = std::operator<<<std::char_traits<char>>(v112, "socks evutil_inet_ntop() failed while processing request ");
      v114 = std::ostream::operator<<(v113, v111);
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v143, v114 + 4);
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v146);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v146);
      if ( byte_80CE64C )
      {
        v115 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v143, *(_DWORD *)(v143 - 12));
        std::endl<char,std::char_traits<char>>(v115);
      }
      syslog(3, "%s", v143);
      goto LABEL_156;
    }
    v67 = __ROR2__(v173, 8);
    v129 = 0;
  }
LABEL_97:
  v131 = *(_BYTE *)(a1 + 5);
  if ( v131 != 1 )
  {
    if ( log_level <= 4 )
    {
      v68 = *(_DWORD *)(a1 + 16);
      if ( v68 )
        v69 = *(_DWORD *)(v68 + 12);
      else
        v69 = sub_804D5EC(*(_DWORD *)(a1 + 12));
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v146, 16);
      v70 = std::__ostream_insert<char,std::char_traits<char>>(
              &v146,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      v71 = std::operator<<<std::char_traits<char>>(v70, "socks unsupported command requested ");
      v72 = std::ostream::operator<<(v71, v69);
      v73 = std::operator<<<std::char_traits<char>>(v72, ": ");
      v139 = v131;
      v74 = std::__ostream_insert<char,std::char_traits<char>>(v73, &v139, 1);
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v143, v74 + 4);
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v146);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v146);
      if ( byte_80CE64C )
      {
        v75 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v143, *(_DWORD *)(v143 - 12));
        std::endl<char,std::char_traits<char>>(v75);
      }
      syslog(4, "%s", v143);
      std::string::_Rep::_M_dispose(v143 - 12, &v146);
    }
    goto LABEL_104;
  }
  if ( !*(_DWORD *)(*(_DWORD *)(a1 + 24) - 12) || std::string::compare((std::string *)(a1 + 24), s1b) )
  {
    if ( log_level > 2 )
    {
      v132 = 0;
      goto LABEL_140;
    }
    v83 = &unk_80CF83C;
    v132 = 0;
  }
  else
  {
    if ( log_level > 2 )
    {
      v132 = 1;
      goto LABEL_140;
    }
    std::string::string(&v142, " replaced with ", &v137);
    v109 = std::string::append((std::string *)&v142, (const std::string *)(a1 + 28));
    v83 = *(_UNKNOWN **)v109;
    *(_DWORD *)v109 = &unk_80CF83C;
    v132 = 1;
  }
  v128 = "";
  if ( v129 )
    v128 = " (local)";
  v84 = *(_DWORD *)(a1 + 16);
  if ( v84 )
    v127 = *(_DWORD *)(v84 + 12);
  else
    v127 = sub_804D5EC(*(_DWORD *)(a1 + 12));
  std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v146, 16);
  v85 = std::__ostream_insert<char,std::char_traits<char>>(&v146, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  v86 = std::operator<<<std::char_traits<char>>(v85, "socks connection ");
  v87 = std::ostream::operator<<(v86, v127);
  v88 = std::operator<<<std::char_traits<char>>(v87, " to ");
  v89 = std::operator<<<std::char_traits<char>>(v88, s1b);
  v90 = std::operator<<<std::char_traits<char>>(v89, ":");
  v91 = std::ostream::_M_insert<unsigned long>(v90, v67);
  v92 = std::operator<<<std::char_traits<char>>(v91, v128);
  v93 = std::__ostream_insert<char,std::char_traits<char>>(v92, v83, *((_DWORD *)v83 - 3));
  std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v143, v93 + 4);
  std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v146);
  std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v146);
  std::string::_Rep::_M_dispose((char *)v83 - 12, &v146);
  if ( v132 )
    std::string::_Rep::_M_dispose(v142 - 12, &v146);
  if ( byte_80CE64C )
  {
    v94 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v143, *(_DWORD *)(v143 - 12));
    std::endl<char,std::char_traits<char>>(v94);
  }
  syslog(6, "%s", v143);
  std::string::_Rep::_M_dispose(v143 - 12, &v146);
LABEL_140:
  if ( !sub_80721E0() || v129 )
  {
    v108 = *(_DWORD *)(*(_DWORD *)(a1 + 32) + 4);
    v97 = operator new(0x44u);
    sub_807F240(v97, *(_DWORD *)(a1 + 12), v108);
  }
  else
  {
    v95 = *(_DWORD *)(*(_DWORD *)(a1 + 8) + 16);
    v96 = (int)sub_80721E0();
    v97 = operator new(0xB8u);
    sub_807CFF0(v97, *(_DWORD *)(a1 + 12), v95, v96);
  }
  *(_DWORD *)(a1 + 16) = v97;
  if ( v132 )
    s1b = *(char **)(a1 + 28);
  v98 = *(int (__cdecl **)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))(**(_DWORD **)(a1 + 16) + 8);
  v147 = 0;
  v99 = operator new(4u);
  *(_DWORD *)v99 = a1;
  v146 = v99;
  v148 = sub_8081A70;
  v147 = sub_8081670;
  v144 = 0;
  v100 = operator new(4u);
  *(_DWORD *)v100 = a1;
  v143 = v100;
  v145 = sub_8082610;
  v144 = sub_8081710;
  v136 = (std::string *)&v146;
  v101 = v98(*(_DWORD *)(a1 + 16), s1b, v67, &v143, &v146);
  if ( v144 )
    v144((void **)&v143, (void **)&v143, 3);
  if ( v147 )
    v147((void **)&v146, (void **)&v146, 3);
  if ( !v101 )
  {
    if ( log_level > 5 )
    {
LABEL_157:
      v141 = 1;
      goto LABEL_105;
    }
    v102 = *(_DWORD *)(a1 + 16);
    if ( v102 )
      v103 = *(_DWORD *)(v102 + 12);
    else
      v103 = sub_804D5EC(*(_DWORD *)(a1 + 12));
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v146, 16);
    v104 = std::__ostream_insert<char,std::char_traits<char>>(
             &v146,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
    v105 = std::operator<<<std::char_traits<char>>(v104, "socks failed creating dst bufferevent ");
    v106 = std::ostream::operator<<(v105, v103);
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v143, v106 + 4);
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v146);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v146);
    if ( byte_80CE64C )
    {
      v107 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v143, *(_DWORD *)(v143 - 12));
      std::endl<char,std::char_traits<char>>(v107);
    }
    syslog(3, "%s", v143);
LABEL_156:
    std::string::_Rep::_M_dispose(v143 - 12, v136);
    goto LABEL_157;
  }
  *(_DWORD *)a1 = 4;
  return 1;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C480: using guessed type int __cdecl evutil_inet_ntop(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C9B0: using guessed type int __cdecl std::operator<<<std::char_traits<char>>(_DWORD, _DWORD);
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CC70: using guessed type int __cdecl bufferevent_getfd(_DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D200: using guessed type int __cdecl evbuffer_copyout(_DWORD, _DWORD, _DWORD);
// 804D250: using guessed type int __cdecl bufferevent_get_input(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 8082610: using guessed type int sub_8082610();
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08087130) --------------------------------------------------------
signed int __cdecl sub_8087130(int a1)
{
  unsigned int v1; // ebp@0
  int v2; // ebx@4
  int v3; // esi@4
  int v4; // eax@4
  int v5; // edx@5
  int v6; // edx@7
  int v7; // edx@8
  int v8; // eax@10
  std::ostream *v9; // esi@10
  int v10; // eax@10
  int v11; // ebx@10
  char v12; // al@12
  std::ostream *v13; // eax@13
  int v14; // edx@15
  signed int result; // eax@16
  struct evbuffer *v16; // esi@19
  int v17; // ebx@19
  int v18; // ebx@23
  int v19; // esi@23
  int v20; // eax@23
  int v21; // edx@23
  int v22; // ecx@24
  int v23; // edx@26
  int v24; // edx@27
  int v25; // eax@29
  std::ostream *v26; // esi@29
  int v27; // eax@29
  int v28; // ebx@29
  char v29; // al@31
  std::ostream *v30; // eax@32
  signed __int32 v31; // eax@37
  int v32; // eax@42
  int v33; // esi@45
  int v34; // ebx@45
  int v35; // eax@45
  int v36; // edx@45
  int v37; // ecx@46
  int v38; // ebx@48
  int v39; // edx@49
  int v40; // eax@51
  std::ostream *v41; // esi@51
  int v42; // eax@51
  int v43; // ebx@51
  char v44; // al@53
  std::ostream *v45; // eax@54
  void *v46; // ebx@59
  char v47; // dl@60
  size_t v48; // eax@61
  char v49; // cl@65
  int v50; // eax@70
  int v51; // eax@70
  int v52; // eax@71
  char v53; // al@75
  int v54; // eax@79
  int v55; // eax@79
  int v56; // eax@80
  signed __int32 v57; // ecx@86
  signed __int32 v58; // ecx@90
  int v59; // eax@93
  int v60; // ebx@94
  signed __int32 v61; // ecx@98
  signed __int32 v62; // ecx@103
  signed __int32 v63; // ecx@109
  signed __int32 v64; // edx@113
  signed __int32 v65; // ecx@118
  int v66; // [sp+Ch] [bp-ECh]@0
  size_t size; // [sp+14h] [bp-E4h]@42
  int *v68; // [sp+1Ch] [bp-DCh]@4
  int *v69; // [sp+1Ch] [bp-DCh]@70
  char v70; // [sp+20h] [bp-D8h]@100
  char v71; // [sp+21h] [bp-D7h]@25
  unsigned __int8 v72; // [sp+22h] [bp-D6h]@6
  unsigned __int8 v73; // [sp+23h] [bp-D5h]@42
  int data; // [sp+24h] [bp-D4h]@4
  int v75; // [sp+28h] [bp-D0h]@6
  int v76; // [sp+2Ch] [bp-CCh]@4
  int v77; // [sp+30h] [bp-C8h]@4
  int v78; // [sp+34h] [bp-C4h]@4
  int v79; // [sp+38h] [bp-C0h]@4
  int v80; // [sp+3Ch] [bp-BCh]@4
  int v81; // [sp+40h] [bp-B8h]@4
  int v82; // [sp+44h] [bp-B4h]@4
  int v83; // [sp+48h] [bp-B0h]@4
  char v84; // [sp+4Ch] [bp-ACh]@4
  int v85; // [sp+50h] [bp-A8h]@4
  int v86; // [sp+54h] [bp-A4h]@4
  int v87; // [sp+58h] [bp-A0h]@4
  int v88; // [sp+C8h] [bp-30h]@4
  char v89; // [sp+CCh] [bp-2Ch]@4
  char v90; // [sp+CDh] [bp-2Bh]@4
  int v91; // [sp+D0h] [bp-28h]@4
  int v92; // [sp+D4h] [bp-24h]@4
  int v93; // [sp+D8h] [bp-20h]@4
  int v94; // [sp+DCh] [bp-1Ch]@4

  if ( !*(_DWORD *)(a1 + 12) || *(_DWORD *)a1 )
  {
    if ( log_level <= 5 )
    {
      v68 = &v76;
      std::ios_base::ios_base((std::ios_base *)&v87);
      v87 = (int)&unk_80CF5C8;
      v88 = 0;
      v89 = 0;
      v90 = 0;
      v91 = 0;
      v92 = 0;
      v93 = 0;
      v94 = 0;
      v2 = dword_80CF674;
      v76 = dword_80CF674;
      *(int *)((char *)&v76 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v76 + *(_DWORD *)(v76 - 12), 0);
      v76 = (int)&unk_80CF5DC;
      v87 = (int)&unk_80CF5F0;
      v77 = (int)&unk_80CF7F0;
      v78 = 0;
      v79 = 0;
      v80 = 0;
      v81 = 0;
      v82 = 0;
      v83 = 0;
      std::locale::locale((std::locale *)&v84);
      v77 = (int)&unk_80CF588;
      v85 = 16;
      v86 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v87, &v77);
      v3 = std::__ostream_insert<char,std::char_traits<char>>(
             &v76,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v3, "socks bad connection state", 26);
      data = (int)&unk_80CF83C;
      v4 = *(_DWORD *)(v3 + 24);
      if ( v4 )
      {
        v5 = *(_DWORD *)(v3 + 16);
        LOBYTE(v66) = 0;
        if ( v4 > (unsigned int)v5 )
        {
          v75 = std::string::_S_construct<char *>(v2, v1, &v87, *(_DWORD *)(v3 + 20), v4, (int)&v72);
          std::string::swap((std::string *)&data, (std::string *)&v75);
        }
        else
        {
          v75 = std::string::_S_construct<char *>(v2, v1, &v87, *(_DWORD *)(v3 + 20), v5, (int)&v72);
          std::string::swap((std::string *)&data, (std::string *)&v75);
        }
        v6 = v75 - 12;
        if ( (_DWORD *)(v75 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v58 = _InterlockedExchangeAdd((volatile signed __int32 *)(v75 - 4), 0xFFFFFFFF);
          }
          else
          {
            v58 = *(_DWORD *)(v75 - 4);
            *(_DWORD *)(v75 - 4) = v58 - 1;
          }
          if ( v58 <= 0 )
            std::string::_Rep::_M_destroy(v6, &v71);
        }
      }
      else
      {
        std::string::assign((std::string *)&data, (const std::string *)(v3 + 40));
      }
      v76 = (int)&unk_80CF5DC;
      v87 = (int)&unk_80CF5F0;
      v77 = (int)&unk_80CF588;
      v7 = v86 - 12;
      if ( (_DWORD *)(v86 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v57 = _InterlockedExchangeAdd((volatile signed __int32 *)(v86 - 4), 0xFFFFFFFF);
        }
        else
        {
          v57 = *(_DWORD *)(v86 - 4);
          *(_DWORD *)(v86 - 4) = v57 - 1;
        }
        if ( v57 <= 0 )
          std::string::_Rep::_M_destroy(v7, &v75);
      }
      v77 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v84);
      v76 = v2;
      *(int *)((char *)&v76 + *(_DWORD *)(v2 - 12)) = dword_80CF678;
      v87 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v87);
      if ( !byte_80CE64C )
        goto LABEL_14;
      v8 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, data, *(_DWORD *)(data - 12));
      v9 = (std::ostream *)v8;
      v10 = *(_DWORD *)(*(_DWORD *)v8 - 12);
      v11 = *(_DWORD *)((char *)v9 + v10 + 124);
      if ( v11 )
      {
        if ( *(_BYTE *)(v11 + 28) )
        {
          v12 = *(_BYTE *)(v11 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v9 + v10 + 124));
          v12 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v11 + 24))(v11, 10);
        }
        v13 = (std::ostream *)std::ostream::put(v9, v12);
        std::ostream::flush(v13);
LABEL_14:
        syslog(3, "%s", data, v66);
        goto LABEL_15;
      }
      v59 = std::__throw_bad_cast();
LABEL_94:
      v60 = v59;
      std::string::_Rep::_M_dispose(data - 12, v68);
      Unwind_Resume(v60);
    }
    return -1;
  }
  v16 = (struct evbuffer *)bufferevent_get_input(*(_DWORD *)(a1 + 12));
  v17 = evbuffer_get_length(v16);
  if ( !v17 )
    return 0;
  evbuffer_copyout(v16, &v72, 1);
  if ( v72 != 5 )
  {
    if ( log_level > 5 )
      return -1;
    v18 = v72;
    v68 = &v76;
    std::ios_base::ios_base((std::ios_base *)&v87);
    v87 = (int)&unk_80CF5C8;
    v88 = 0;
    v89 = 0;
    v90 = 0;
    v91 = 0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v76 = dword_80CF674;
    *(int *)((char *)&v76 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v76 + *(_DWORD *)(v76 - 12), 0);
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF7F0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v81 = 0;
    v82 = 0;
    v83 = 0;
    std::locale::locale((std::locale *)&v84);
    v77 = (int)&unk_80CF588;
    v85 = 16;
    v86 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v87, &v77);
    v19 = std::__ostream_insert<char,std::char_traits<char>>(
            &v76,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v19, "socks unsupported greeting version: ", 36);
    v20 = std::ostream::operator<<(v19, v18);
    data = (int)&unk_80CF83C;
    v21 = *(_DWORD *)(v20 + 24);
    if ( v21 )
    {
      v22 = *(_DWORD *)(v20 + 16);
      LOBYTE(v66) = 0;
      if ( v21 > (unsigned int)v22 )
      {
        v75 = std::string::_S_construct<char *>((int)&v71, v1, &v87, *(_DWORD *)(v20 + 20), v21, (int)&v71);
        std::string::swap((std::string *)&data, (std::string *)&v75);
      }
      else
      {
        v75 = std::string::_S_construct<char *>((int)&v71, v1, &v87, *(_DWORD *)(v20 + 20), v22, (int)&v71);
        std::string::swap((std::string *)&data, (std::string *)&v75);
      }
      v23 = v75 - 12;
      if ( (_DWORD *)(v75 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v61 = _InterlockedExchangeAdd((volatile signed __int32 *)(v75 - 4), 0xFFFFFFFF);
        }
        else
        {
          v61 = *(_DWORD *)(v75 - 4);
          *(_DWORD *)(v75 - 4) = v61 - 1;
        }
        if ( v61 <= 0 )
          std::string::_Rep::_M_destroy(v23, &v70);
      }
    }
    else
    {
      std::string::assign((std::string *)&data, (const std::string *)(v20 + 40));
    }
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF588;
    v24 = v86 - 12;
    if ( (_DWORD *)(v86 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v62 = _InterlockedExchangeAdd((volatile signed __int32 *)(v86 - 4), 0xFFFFFFFF);
      }
      else
      {
        v62 = *(_DWORD *)(v86 - 4);
        *(_DWORD *)(v86 - 4) = v62 - 1;
      }
      if ( v62 <= 0 )
        std::string::_Rep::_M_destroy(v24, &v75);
    }
    v77 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v84);
    v76 = dword_80CF674;
    *(int *)((char *)&v76 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v87 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v87);
    if ( byte_80CE64C )
    {
      v25 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, data, *(_DWORD *)(data - 12));
      v26 = (std::ostream *)v25;
      v27 = *(_DWORD *)(*(_DWORD *)v25 - 12);
      v28 = *(_DWORD *)((char *)v26 + v27 + 124);
      if ( !v28 )
      {
        v59 = std::__throw_bad_cast();
        goto LABEL_94;
      }
      if ( *(_BYTE *)(v28 + 28) )
      {
        v29 = *(_BYTE *)(v28 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v26 + v27 + 124));
        v29 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v28 + 24))(v28, 10);
      }
      v30 = (std::ostream *)std::ostream::put(v26, v29);
      std::ostream::flush(v30);
    }
    syslog(3, "%s", data, v66);
LABEL_15:
    v14 = data - 12;
    if ( (_DWORD *)(data - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v31 = _InterlockedExchangeAdd((volatile signed __int32 *)(data - 4), 0xFFFFFFFF);
      }
      else
      {
        v65 = *(_DWORD *)(data - 4);
        *(_DWORD *)(data - 4) = v65 - 1;
        v31 = v65;
      }
      if ( v31 <= 0 )
        std::string::_Rep::_M_destroy(v14, v68);
    }
    return -1;
  }
  if ( (unsigned int)v17 <= 1 )
    return 0;
  evbuffer_copyout(v16, &v72, 2);
  size = v73;
  v32 = v73 + 2;
  if ( v17 < (unsigned int)v32 )
    return 0;
  if ( v17 > (unsigned int)v32 )
  {
    if ( log_level > 5 )
      return -1;
    v68 = &v76;
    std::ios_base::ios_base((std::ios_base *)&v87);
    v87 = (int)&unk_80CF5C8;
    v88 = 0;
    v89 = 0;
    v90 = 0;
    v91 = 0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v76 = dword_80CF674;
    *(int *)((char *)&v76 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v76 + *(_DWORD *)(v76 - 12), 0);
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF7F0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v81 = 0;
    v82 = 0;
    v83 = 0;
    std::locale::locale((std::locale *)&v84);
    v77 = (int)&unk_80CF588;
    v85 = 16;
    v86 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v87, &v77);
    v33 = std::__ostream_insert<char,std::char_traits<char>>(
            &v76,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v33, "socks greeting bad methods:", 27);
    v34 = std::ostream::_M_insert<unsigned long>(v33, v17);
    std::__ostream_insert<char,std::char_traits<char>>(v34, " ", 1);
    v35 = std::ostream::_M_insert<unsigned long>(v34, size);
    data = (int)&unk_80CF83C;
    v36 = *(_DWORD *)(v35 + 24);
    if ( v36 )
    {
      v37 = *(_DWORD *)(v35 + 16);
      LOBYTE(v66) = 0;
      if ( v36 <= (unsigned int)v37 )
      {
        v75 = std::string::_S_construct<char *>((int)&v71, v1, &v87, *(_DWORD *)(v35 + 20), v37, (int)&v71);
        std::string::swap((std::string *)&data, (std::string *)&v75);
      }
      else
      {
        v75 = std::string::_S_construct<char *>((int)&v71, v1, &v87, *(_DWORD *)(v35 + 20), v36, (int)&v71);
        std::string::swap((std::string *)&data, (std::string *)&v75);
      }
      v38 = v75 - 12;
      if ( (_DWORD *)(v75 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v64 = _InterlockedExchangeAdd((volatile signed __int32 *)(v75 - 4), 0xFFFFFFFF);
        }
        else
        {
          v64 = *(_DWORD *)(v75 - 4);
          *(_DWORD *)(v75 - 4) = v64 - 1;
        }
        if ( v64 <= 0 )
          std::string::_Rep::_M_destroy(v38, &v70);
      }
    }
    else
    {
      std::string::assign((std::string *)&data, (const std::string *)(v35 + 40));
    }
    v76 = (int)&unk_80CF5DC;
    v87 = (int)&unk_80CF5F0;
    v77 = (int)&unk_80CF588;
    v39 = v86 - 12;
    if ( (_DWORD *)(v86 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v63 = _InterlockedExchangeAdd((volatile signed __int32 *)(v86 - 4), 0xFFFFFFFF);
      }
      else
      {
        v63 = *(_DWORD *)(v86 - 4);
        *(_DWORD *)(v86 - 4) = v63 - 1;
      }
      if ( v63 <= 0 )
        std::string::_Rep::_M_destroy(v39, &v75);
    }
    v77 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v84);
    v76 = dword_80CF674;
    *(int *)((char *)&v76 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v87 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v87);
    if ( byte_80CE64C )
    {
      v40 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, data, *(_DWORD *)(data - 12));
      v41 = (std::ostream *)v40;
      v42 = *(_DWORD *)(*(_DWORD *)v40 - 12);
      v43 = *(_DWORD *)((char *)v41 + v42 + 124);
      if ( !v43 )
      {
        v59 = std::__throw_bad_cast();
        goto LABEL_94;
      }
      if ( *(_BYTE *)(v43 + 28) )
      {
        v44 = *(_BYTE *)(v43 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v41 + v42 + 124));
        v44 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v43 + 24))(v43, 10);
      }
      v45 = (std::ostream *)std::ostream::put(v41, v44);
      std::ostream::flush(v45);
    }
    syslog(3, "%s", data, v66);
    goto LABEL_15;
  }
  v46 = malloc(v73);
  if ( !v46 )
  {
    if ( log_level > 5 )
      return -1;
    v69 = &v76;
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v76, 16);
    v54 = std::__ostream_insert<char,std::char_traits<char>>(
            &v76,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    v55 = std::operator<<<std::char_traits<char>>(v54, "socks greeting failed alloc methods");
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v75, v55 + 4);
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v76);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v76);
    if ( byte_80CE64C )
    {
      v56 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v75, *(_DWORD *)(v75 - 12));
      std::endl<char,std::char_traits<char>>(v56);
    }
    syslog(3, "%s", v75);
    goto LABEL_73;
  }
  evbuffer_drain(v16, 2u);
  evbuffer_remove(v16, v46, size);
  v47 = -1;
  if ( size )
  {
    v48 = 0;
    do
    {
      v49 = *((_BYTE *)v46 + v48);
      if ( v49 )
      {
        if ( v49 == 2 )
          v47 = 2;
      }
      else if ( v47 == -1 )
      {
        v47 = 0;
      }
      ++v48;
    }
    while ( size > v48 );
  }
  *(_BYTE *)(a1 + 4) = v47;
  free(v46);
  LOBYTE(data) = 5;
  BYTE1(data) = *(_BYTE *)(a1 + 4);
  if ( bufferevent_write(*(struct bufferevent **)(a1 + 12), &data, 2u) )
  {
    if ( log_level > 5 )
      return -1;
    v69 = &v76;
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v76, 16);
    v50 = std::__ostream_insert<char,std::char_traits<char>>(
            &v76,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    v51 = std::operator<<<std::char_traits<char>>(v50, "socks greeting failed write greeting reply");
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v75, v51 + 4);
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v76);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v76);
    if ( byte_80CE64C )
    {
      v52 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v75, *(_DWORD *)(v75 - 12));
      std::endl<char,std::char_traits<char>>(v52);
    }
    syslog(3, "%s", v75);
LABEL_73:
    std::string::_Rep::_M_dispose(v75 - 12, v69);
    return -1;
  }
  v53 = *(_BYTE *)(a1 + 4);
  if ( v53 )
  {
    if ( v53 == 2 )
    {
      *(_DWORD *)a1 = 2;
      result = 1;
    }
    else
    {
      *(_DWORD *)a1 = 1;
      result = 1;
    }
  }
  else
  {
    *(_DWORD *)a1 = 3;
    result = 1;
  }
  return result;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C9B0: using guessed type int __cdecl std::operator<<<std::char_traits<char>>(_DWORD, _DWORD);
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D200: using guessed type int __cdecl evbuffer_copyout(_DWORD, _DWORD, _DWORD);
// 804D250: using guessed type int __cdecl bufferevent_get_input(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08088330) --------------------------------------------------------
signed int __cdecl sub_8088330(int a1)
{
  int v1; // ebx@4
  int v2; // esi@4
  int v3; // eax@4
  int v4; // edx@5
  int v5; // edx@7
  int v6; // edx@8
  int v7; // eax@10
  std::ostream *v8; // esi@10
  int v9; // eax@10
  int v10; // ebx@10
  char v11; // al@12
  std::ostream *v12; // eax@13
  int v13; // edx@14
  int v15; // eax@19
  struct evbuffer *v16; // edi@19
  int v17; // eax@19
  signed int v18; // esi@19
  int v19; // eax@22
  int v20; // edx@22
  int v21; // ST2C_4@24
  int v22; // ST28_4@24
  const void *v23; // edx@24
  int v24; // eax@24
  unsigned int v25; // eax@26
  unsigned int v26; // ebp@26
  int v27; // eax@27
  int v28; // edx@29
  char *v29; // edx@30
  int v30; // edx@31
  int v31; // eax@35
  int v32; // ebx@37
  int v33; // edi@37
  int v34; // eax@37
  int v35; // edx@37
  int v36; // ecx@38
  int v37; // edx@40
  int v38; // edx@41
  int v39; // eax@43
  std::ostream *v40; // edi@43
  int v41; // eax@43
  int v42; // ebx@43
  char v43; // al@45
  std::ostream *v44; // eax@46
  char *v45; // edx@47
  signed __int32 v46; // eax@49
  signed __int32 v47; // eax@57
  int v48; // eax@63
  signed __int32 v49; // ecx@70
  signed __int32 v50; // ecx@74
  int v51; // ebx@77
  signed __int32 v52; // eax@82
  signed __int32 v53; // eax@86
  signed __int32 v54; // ecx@89
  signed __int32 v55; // ecx@90
  signed __int32 v56; // ecx@91
  signed __int32 v57; // ecx@93
  signed __int32 v58; // eax@95
  signed __int32 v59; // ecx@99
  signed __int32 v60; // ecx@103
  signed __int32 v61; // ecx@106
  signed __int32 v62; // edx@111
  unsigned int v63; // [sp+Ch] [bp-310h]@0
  int *v64; // [sp+1Ch] [bp-300h]@21
  void *v65; // [sp+1Ch] [bp-300h]@27
  void *v66; // [sp+1Ch] [bp-300h]@36
  int v67; // [sp+24h] [bp-2F8h]@23
  char data; // [sp+3Ah] [bp-2E2h]@30
  char v69; // [sp+3Bh] [bp-2E1h]@30
  int v70; // [sp+3Ch] [bp-2E0h]@24
  void *s1; // [sp+40h] [bp-2DCh]@6
  int v72; // [sp+44h] [bp-2D8h]@4
  int v73; // [sp+48h] [bp-2D4h]@6
  int v74; // [sp+4Ch] [bp-2D0h]@37
  int v75; // [sp+50h] [bp-2CCh]@37
  int v76; // [sp+54h] [bp-2C8h]@37
  int v77; // [sp+58h] [bp-2C4h]@37
  int v78; // [sp+5Ch] [bp-2C0h]@37
  int v79; // [sp+60h] [bp-2BCh]@37
  int v80; // [sp+64h] [bp-2B8h]@37
  char v81; // [sp+68h] [bp-2B4h]@37
  int v82; // [sp+6Ch] [bp-2B0h]@37
  int v83; // [sp+70h] [bp-2ACh]@37
  int v84; // [sp+74h] [bp-2A8h]@37
  int v85; // [sp+E4h] [bp-238h]@37
  char v86; // [sp+E8h] [bp-234h]@37
  char v87; // [sp+E9h] [bp-233h]@37
  int v88; // [sp+ECh] [bp-230h]@37
  int v89; // [sp+F0h] [bp-22Ch]@37
  int v90; // [sp+F4h] [bp-228h]@37
  int v91; // [sp+F8h] [bp-224h]@37
  int v92; // [sp+FCh] [bp-220h]@4
  int v93; // [sp+100h] [bp-21Ch]@4
  int v94; // [sp+104h] [bp-218h]@4
  int v95; // [sp+108h] [bp-214h]@4
  int v96; // [sp+10Ch] [bp-210h]@4
  int v97; // [sp+110h] [bp-20Ch]@4
  int v98; // [sp+114h] [bp-208h]@4
  int v99; // [sp+118h] [bp-204h]@4
  char v100; // [sp+11Ch] [bp-200h]@4
  int v101; // [sp+120h] [bp-1FCh]@4
  int v102; // [sp+124h] [bp-1F8h]@4
  int v103; // [sp+128h] [bp-1F4h]@4
  int v104; // [sp+198h] [bp-184h]@4
  char v105; // [sp+19Ch] [bp-180h]@4
  char v106; // [sp+19Dh] [bp-17Fh]@4
  int v107; // [sp+1A0h] [bp-17Ch]@4
  int v108; // [sp+1A4h] [bp-178h]@4
  int v109; // [sp+1A8h] [bp-174h]@4
  int v110; // [sp+1ACh] [bp-170h]@4

  if ( !*(_DWORD *)(a1 + 12) || *(_DWORD *)a1 != 2 )
  {
    if ( log_level <= 5 )
    {
      std::ios_base::ios_base((std::ios_base *)&v103);
      v103 = (int)&unk_80CF5C8;
      v104 = 0;
      v105 = 0;
      v106 = 0;
      v107 = 0;
      v108 = 0;
      v109 = 0;
      v110 = 0;
      v1 = dword_80CF674;
      v92 = dword_80CF674;
      *(int *)((char *)&v92 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v92 + *(_DWORD *)(v92 - 12), 0);
      v92 = (int)&unk_80CF5DC;
      v103 = (int)&unk_80CF5F0;
      v93 = (int)&unk_80CF7F0;
      v94 = 0;
      v95 = 0;
      v96 = 0;
      v97 = 0;
      v98 = 0;
      v99 = 0;
      std::locale::locale((std::locale *)&v100);
      v93 = (int)&unk_80CF588;
      v101 = 16;
      v102 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v103, &v93);
      v2 = std::__ostream_insert<char,std::char_traits<char>>(
             &v92,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v2, "socks credentials invalid state", 31);
      v72 = (int)&unk_80CF83C;
      v3 = *(_DWORD *)(v2 + 24);
      if ( v3 )
      {
        v4 = *(_DWORD *)(v2 + 16);
        LOBYTE(v63) = 0;
        if ( v3 > (unsigned int)v4 )
        {
          v73 = std::string::_S_construct<char *>(v1, (unsigned int)&v100, &v103, *(_DWORD *)(v2 + 20), v3, (int)&s1);
          std::string::swap((std::string *)&v72, (std::string *)&v73);
        }
        else
        {
          v73 = std::string::_S_construct<char *>(v1, (unsigned int)&v100, &v103, *(_DWORD *)(v2 + 20), v4, (int)&s1);
          std::string::swap((std::string *)&v72, (std::string *)&v73);
        }
        v5 = v73 - 12;
        if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v50 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
          }
          else
          {
            v50 = *(_DWORD *)(v73 - 4);
            *(_DWORD *)(v73 - 4) = v50 - 1;
          }
          if ( v50 <= 0 )
            std::string::_Rep::_M_destroy(v5, &v70);
        }
      }
      else
      {
        std::string::assign((std::string *)&v72, (const std::string *)(v2 + 40));
      }
      v92 = (int)&unk_80CF5DC;
      v103 = (int)&unk_80CF5F0;
      v93 = (int)&unk_80CF588;
      v6 = v102 - 12;
      if ( (_DWORD *)(v102 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v49 = _InterlockedExchangeAdd((volatile signed __int32 *)(v102 - 4), 0xFFFFFFFF);
        }
        else
        {
          v49 = *(_DWORD *)(v102 - 4);
          *(_DWORD *)(v102 - 4) = v49 - 1;
        }
        if ( v49 <= 0 )
          std::string::_Rep::_M_destroy(v6, &v73);
      }
      v93 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v100);
      v92 = v1;
      *(int *)((char *)&v92 + *(_DWORD *)(v1 - 12)) = dword_80CF678;
      v103 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v103);
      if ( !byte_80CE64C )
        goto LABEL_14;
      v7 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v72, *(_DWORD *)(v72 - 12));
      v8 = (std::ostream *)v7;
      v9 = *(_DWORD *)(*(_DWORD *)v7 - 12);
      v10 = *(_DWORD *)((char *)v8 + v9 + 124);
      if ( v10 )
      {
        if ( *(_BYTE *)(v10 + 28) )
        {
          v11 = *(_BYTE *)(v10 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v8 + v9 + 124));
          v11 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v10 + 24))(v10, 10);
        }
        v12 = (std::ostream *)std::ostream::put(v8, v11);
        std::ostream::flush(v12);
LABEL_14:
        syslog(3, "%s", v72, v63);
        v13 = v72 - 12;
        if ( (_DWORD *)(v72 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v47 = _InterlockedExchangeAdd((volatile signed __int32 *)(v72 - 4), 0xFFFFFFFF);
          }
          else
          {
            v57 = *(_DWORD *)(v72 - 4);
            *(_DWORD *)(v72 - 4) = v57 - 1;
            v47 = v57;
          }
          if ( v47 <= 0 )
            std::string::_Rep::_M_destroy(v13, &v92);
        }
        return -1;
      }
      v51 = std::__throw_bad_cast();
      std::string::_Rep::_M_dispose(v72 - 12, &v92);
LABEL_78:
      Unwind_Resume(v51);
    }
    return -1;
  }
  v15 = bufferevent_get_input(*(_DWORD *)(a1 + 12));
  v16 = (struct evbuffer *)v15;
  v17 = evbuffer_get_length(v15);
  v18 = v17;
  if ( !v17 )
    return 0;
  if ( (unsigned int)v17 > 0x201 )
  {
    v64 = &v92;
    evbuffer_copyout(v16, &v92, 513);
    if ( (_BYTE)v92 == 1 )
    {
      v19 = BYTE1(v92);
      v20 = BYTE1(v92) + 3;
      v18 = 513;
      goto LABEL_23;
    }
LABEL_34:
    if ( log_level <= 5 )
    {
      v31 = *(_DWORD *)(a1 + 16);
      if ( v31 )
      {
        v66 = *(void **)(v31 + 12);
      }
      else
      {
        if ( *(_DWORD *)(a1 + 12) )
          v48 = bufferevent_getfd(*(_DWORD *)(a1 + 12));
        else
          v48 = 0;
        v66 = (void *)v48;
      }
      std::ios_base::ios_base((std::ios_base *)&v84);
      v84 = (int)&unk_80CF5C8;
      v85 = 0;
      v86 = 0;
      v87 = 0;
      v88 = 0;
      v89 = 0;
      v90 = 0;
      v91 = 0;
      v32 = dword_80CF674;
      v73 = dword_80CF674;
      *(int *)((char *)&v73 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v73 + *(_DWORD *)(v73 - 12), 0);
      v73 = (int)&unk_80CF5DC;
      v84 = (int)&unk_80CF5F0;
      v74 = (int)&unk_80CF7F0;
      v75 = 0;
      v76 = 0;
      v77 = 0;
      v78 = 0;
      v79 = 0;
      v80 = 0;
      std::locale::locale((std::locale *)&v81);
      v74 = (int)&unk_80CF588;
      v82 = 16;
      v83 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v84, &v74);
      v33 = std::__ostream_insert<char,std::char_traits<char>>(
              &v73,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v33, "socks invalid auth version ", 27);
      v34 = std::ostream::operator<<(v33, v66);
      s1 = &unk_80CF83C;
      v35 = *(_DWORD *)(v34 + 24);
      if ( v35 )
      {
        v36 = *(_DWORD *)(v34 + 16);
        LOBYTE(v63) = 0;
        if ( v35 <= (unsigned int)v36 )
        {
          v72 = std::string::_S_construct<char *>(v32, (unsigned int)&v84, &v70, *(_DWORD *)(v34 + 20), v36, (int)&v70);
          std::string::swap((std::string *)&s1, (std::string *)&v72);
        }
        else
        {
          v72 = std::string::_S_construct<char *>(v32, (unsigned int)&v84, &v70, *(_DWORD *)(v34 + 20), v35, (int)&v70);
          std::string::swap((std::string *)&s1, (std::string *)&v72);
        }
        v37 = v72 - 12;
        if ( (_DWORD *)(v72 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v60 = _InterlockedExchangeAdd((volatile signed __int32 *)(v72 - 4), 0xFFFFFFFF);
          }
          else
          {
            v60 = *(_DWORD *)(v72 - 4);
            *(_DWORD *)(v72 - 4) = v60 - 1;
          }
          if ( v60 <= 0 )
            std::string::_Rep::_M_destroy(v37, &data);
        }
      }
      else
      {
        std::string::assign((std::string *)&s1, (const std::string *)(v34 + 40));
      }
      v73 = (int)&unk_80CF5DC;
      v84 = (int)&unk_80CF5F0;
      v74 = (int)&unk_80CF588;
      v38 = v83 - 12;
      if ( (_DWORD *)(v83 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v59 = _InterlockedExchangeAdd((volatile signed __int32 *)(v83 - 4), 0xFFFFFFFF);
        }
        else
        {
          v59 = *(_DWORD *)(v83 - 4);
          *(_DWORD *)(v83 - 4) = v59 - 1;
        }
        if ( v59 <= 0 )
          std::string::_Rep::_M_destroy(v38, &v72);
      }
      v74 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v81);
      v73 = v32;
      *(int *)((char *)&v73 + *(_DWORD *)(v32 - 12)) = dword_80CF678;
      v84 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v84);
      if ( byte_80CE64C )
      {
        v39 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, s1, *((_DWORD *)s1 - 3));
        v40 = (std::ostream *)v39;
        v41 = *(_DWORD *)(*(_DWORD *)v39 - 12);
        v42 = *(_DWORD *)((char *)v40 + v41 + 124);
        if ( !v42 )
        {
          v51 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose((char *)s1 - 12, &v73);
          goto LABEL_78;
        }
        if ( *(_BYTE *)(v42 + 28) )
        {
          v43 = *(_BYTE *)(v42 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v40 + v41 + 124));
          v43 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v42 + 24))(v42, 10);
        }
        v44 = (std::ostream *)std::ostream::put(v40, v43);
        std::ostream::flush(v44);
      }
      syslog(3, "%s", s1, v63);
      v45 = (char *)s1 - 12;
      if ( (_DWORD *)((char *)s1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v46 = _InterlockedExchangeAdd((volatile signed __int32 *)s1 - 1, 0xFFFFFFFF);
        }
        else
        {
          v56 = *((_DWORD *)s1 - 1);
          *((_DWORD *)s1 - 1) = v56 - 1;
          v46 = v56;
        }
        if ( v46 <= 0 )
          std::string::_Rep::_M_destroy(v45, &v73);
      }
    }
    return -1;
  }
  v64 = &v92;
  evbuffer_copyout(v16, &v92, v17);
  if ( (_BYTE)v92 != 1 )
    goto LABEL_34;
  if ( v18 == 1 )
    return 0;
  v19 = BYTE1(v92);
  v20 = BYTE1(v92) + 3;
  if ( v18 < (unsigned int)v20 )
    return 0;
LABEL_23:
  v67 = *((_BYTE *)&v92 + v19 + 2) + v20;
  if ( v67 > (unsigned int)v18 )
    return 0;
  v21 = *((_BYTE *)&v92 + v19 + 2);
  v22 = v20;
  std::string::string(&v70, (char *)&v92 + 2, v19, &v73);
  std::string::string(&s1, (char *)v64 + v22, v21, &v73);
  evbuffer_remove(v16, v64, v67);
  *(_DWORD *)a1 = 3;
  v23 = (const void *)**(_DWORD **)(a1 + 8);
  v24 = *((_DWORD *)v23 - 3);
  if ( !v24 || v24 == *((_DWORD *)s1 - 3) && !memcmp(s1, v23, *((_DWORD *)v23 - 3)) )
    *(_BYTE *)(a1 + 20) = 1;
  v25 = std::string::find((std::string *)&v70, 35, 0);
  v26 = v25;
  if ( v25 != -1 )
  {
    std::string::string((std::string *)&v72, (const std::string *)&v70, 0, v25);
    std::string::swap((std::string *)(a1 + 24), (std::string *)&v72);
    v27 = v72;
    v65 = (void *)(v72 - 12);
    if ( (_DWORD *)(v72 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_110;
    while ( v26 + 1 > *(_DWORD *)(v70 - 12) )
    {
      v27 = std::__throw_out_of_range("basic_string::substr");
LABEL_110:
      if ( &_pthread_key_create )
      {
        v62 = _InterlockedExchangeAdd((volatile signed __int32 *)(v27 - 4), 0xFFFFFFFF);
      }
      else
      {
        v62 = *(_DWORD *)(v27 - 4);
        *(_DWORD *)(v27 - 4) = v62 - 1;
      }
      if ( v62 <= 0 )
        std::string::_Rep::_M_destroy(v65, &v73);
    }
    std::string::string((std::string *)&v73, (const std::string *)&v70, v26 + 1, 0xFFFFFFFF);
    std::string::swap((std::string *)(a1 + 28), (std::string *)&v73);
    v28 = v73 - 12;
    if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v58 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
      }
      else
      {
        v61 = *(_DWORD *)(v73 - 4);
        *(_DWORD *)(v73 - 4) = v61 - 1;
        v58 = v61;
      }
      if ( v58 <= 0 )
        std::string::_Rep::_M_destroy(v28, &v72);
    }
  }
  data = 1;
  v69 = 0;
  bufferevent_write(*(struct bufferevent **)(a1 + 12), &data, 2u);
  v29 = (char *)s1 - 12;
  if ( (_DWORD *)((char *)s1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v53 = _InterlockedExchangeAdd((volatile signed __int32 *)s1 - 1, 0xFFFFFFFF);
    }
    else
    {
      v55 = *((_DWORD *)s1 - 1);
      *((_DWORD *)s1 - 1) = v55 - 1;
      v53 = v55;
    }
    if ( v53 <= 0 )
      std::string::_Rep::_M_destroy(v29, &v73);
  }
  v30 = v70 - 12;
  if ( (_DWORD *)(v70 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v52 = _InterlockedExchangeAdd((volatile signed __int32 *)(v70 - 4), 0xFFFFFFFF);
    }
    else
    {
      v54 = *(_DWORD *)(v70 - 4);
      *(_DWORD *)(v70 - 4) = v54 - 1;
      v52 = v54;
    }
    if ( v52 <= 0 )
      std::string::_Rep::_M_destroy(v30, &v73);
  }
  return 1;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CC70: using guessed type int __cdecl bufferevent_getfd(_DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D200: using guessed type int __cdecl evbuffer_copyout(_DWORD, _DWORD, _DWORD);
// 804D250: using guessed type int __cdecl bufferevent_get_input(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0808AA80) --------------------------------------------------------
int sub_808AA80()
{
  char v1; // [sp+1Fh] [bp-Dh]@1

  std::string::_Rep::_M_dispose(dword_80CF8FC - 12, &v1);
  return std::ios_base::Init::~Init((std::ios_base::Init *)&unk_80CF900);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (0808AAB0) --------------------------------------------------------
std::string *__stdcall sub_808AAB0(std::string *a1, int a2)
{
  int v2; // esi@2
  size_t v3; // eax@3
  int v4; // ebx@3
  int v5; // eax@5
  int v6; // edx@5
  int v7; // ebp@5
  int v8; // eax@8
  const char v9; // bl@10
  int v10; // eax@12
  int v12; // [sp+1Ch] [bp-30h]@3
  char v13; // [sp+2Ch] [bp-20h]@12

  if ( !*(_DWORD *)a2 || (v2 = *(_DWORD *)(*(_DWORD *)a2 + 40) + *(_DWORD *)(*(_DWORD *)a2 + 8), !*(_BYTE *)v2) )
    v2 = 134981720;
  *(_DWORD *)a1 = &unk_80CF83C;
  v3 = strlen((const char *)v2);
  v4 = v2 + v3;
  v12 = v2 + v3;
  std::string::reserve(a1, v3 + 1);
  if ( v2 < (unsigned int)v4 )
  {
    while ( 1 )
    {
      v9 = *(_BYTE *)v2;
      if ( *(_BYTE *)v2 == 35 )
        return a1;
      if ( byte_80BB500[(unsigned __int8)v9] )
        break;
      v10 = snprintf(&v13, 4u, "%%%02X", (unsigned __int8)v9);
      if ( v10 <= 0 )
      {
LABEL_9:
        ++v2;
        if ( v2 == v12 )
          return a1;
      }
      else
      {
        std::string::append(a1, &v13, v10);
        ++v2;
        if ( v2 == v12 )
          return a1;
      }
    }
    v5 = *(_DWORD *)a1;
    v6 = *(_DWORD *)(*(_DWORD *)a1 - 12);
    v7 = v6 + 1;
    if ( (unsigned int)(v6 + 1) > *(_DWORD *)(*(_DWORD *)a1 - 8) || *(_DWORD *)(v5 - 4) > 0 )
    {
      std::string::reserve(a1, v6 + 1);
      v5 = *(_DWORD *)a1;
      v6 = *(_DWORD *)(*(_DWORD *)a1 - 12);
    }
    *(_BYTE *)(v5 + v6) = v9;
    v8 = *(_DWORD *)a1;
    if ( *(_UNKNOWN **)a1 != &unk_80CF83C )
    {
      *(_DWORD *)(v8 - 4) = 0;
      *(_DWORD *)(v8 - 12) = v7;
      *(_BYTE *)(v8 + v7) = 0;
    }
    goto LABEL_9;
  }
  return a1;
}

//----- (0808ABF0) --------------------------------------------------------
int __cdecl sub_808ABF0(int a1, char *a2)
{
  char *v2; // ebp@1
  char *v3; // eax@1
  char *v4; // edx@3
  char v5; // bl@5
  char v6; // al@9
  char *v7; // ecx@9
  const char v8; // al@12
  unsigned int v9; // ebx@15
  char v10; // al@18
  char *v11; // eax@20
  int v12; // edx@23
  char v13; // al@24
  int v14; // esi@31
  int v15; // eax@32
  int result; // eax@37
  unsigned __int8 v17; // [sp+14h] [bp-28h]@30
  unsigned int v18; // [sp+18h] [bp-24h]@19

  v2 = a2;
  v3 = strchr(a2, 58);
  if ( v3 && a2 < v3 )
  {
    v4 = a2;
    if ( (1 << (*a2 & 0x1F)) & dword_80BB4E0[(unsigned __int8)*a2 >> 5] )
    {
      while ( 1 )
      {
        ++v4;
        if ( v4 == v3 )
          break;
        v5 = *v4;
        if ( !((1 << (*v4 & 0x1F)) & dword_80BB4C0[(unsigned __int8)*v4 >> 5])
          && v5 != 43
          && (unsigned __int8)(v5 - 45) > 1u )
        {
          v4 = a2;
          goto LABEL_9;
        }
      }
      *(_DWORD *)(a1 + 12) = a2;
      *(_DWORD *)(a1 + 16) = v4 - a2;
      v7 = v4 + 1;
      v6 = v4[1];
      v4 = a2;
    }
    else
    {
LABEL_9:
      v6 = *a2;
      v7 = a2;
    }
    if ( v6 != 47 )
      goto LABEL_11;
  }
  else
  {
    v4 = a2;
    v7 = a2;
    if ( *a2 != 47 )
    {
LABEL_11:
      *(_DWORD *)(a1 + 12) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      goto LABEL_12;
    }
  }
  if ( v7[1] != 47 )
  {
    result = a1;
    *(_DWORD *)(a1 + 40) = v7 - a2;
    return result;
  }
  v2 = v7 + 2;
LABEL_12:
  v8 = *v2;
  if ( *v2 && v8 != 35 && (v8 & 0xEF) != 47 )
  {
    v9 = (unsigned int)v2;
    do
    {
      ++v9;
      v10 = *(_BYTE *)v9;
    }
    while ( *(_BYTE *)v9 && v10 != 35 && (v10 & 0xEF) != 47 );
    v18 = v9;
  }
  else
  {
    v18 = (unsigned int)v2;
    v9 = (unsigned int)v2;
  }
  *(_DWORD *)(a1 + 40) = v18 - (_DWORD)v4;
  v11 = strchr(v2, 64);
  if ( v11 && (unsigned int)v11 < v9 )
  {
    *(_DWORD *)(a1 + 20) = v2;
    *(_DWORD *)(a1 + 24) = v11 - v2;
    v2 = v11 + 1;
  }
  v12 = v9 - 1;
  if ( (unsigned int)v2 <= v9 - 1 )
  {
    v13 = *(_BYTE *)(v9 - 1);
    if ( (1 << (*(_BYTE *)(v9 - 1) & 0x1F)) & dword_80BB4A0[(unsigned __int8)(*(_BYTE *)(v9 - 1) >> 5)] )
    {
      while ( 1 )
      {
        --v12;
        if ( (char *)v12 == v2 - 1 )
          break;
        v13 = *(_BYTE *)v12;
        if ( !((1 << (*(_BYTE *)v12 & 0x1F)) & dword_80BB4A0[(unsigned __int8)(*(_BYTE *)v12 >> 5)]) )
          goto LABEL_27;
      }
    }
    else
    {
LABEL_27:
      if ( v13 == 58 )
      {
        if ( v12 + 1 == v9 )
        {
          *(_DWORD *)(a1 + 36) = -1;
          v18 = v12;
        }
        else
        {
          if ( v12 + 1 >= v9 )
          {
            v14 = 0;
          }
          else
          {
            v17 = *(_BYTE *)(v12 + 1);
            if ( (1 << (v17 & 0x1F)) & dword_80BB4A0[v17 >> 5] && (v14 = (char)v17 - 48, (unsigned int)v14 <= 0xFFFF) )
            {
              v15 = v12 + 1;
              while ( 1 )
              {
                ++v15;
                if ( v15 == v9 )
                  break;
                if ( (1 << (*(_BYTE *)v15 & 0x1F)) & dword_80BB4A0[(unsigned __int8)(*(_BYTE *)v15 >> 5)] )
                {
                  v14 = 10 * v14 + *(_BYTE *)v15 - 48;
                  if ( (unsigned int)v14 <= 0xFFFF )
                    continue;
                }
                goto LABEL_45;
              }
            }
            else
            {
LABEL_45:
              v14 = -1;
            }
          }
          *(_DWORD *)(a1 + 36) = v14;
          v18 = v12;
        }
      }
    }
  }
  *(_DWORD *)(a1 + 28) = v2;
  result = v18 - (_DWORD)v2;
  *(_DWORD *)(a1 + 32) = v18 - (_DWORD)v2;
  return result;
}
// 80BB4A0: using guessed type int dword_80BB4A0[];
// 80BB4C0: using guessed type int dword_80BB4C0[];
// 80BB4E0: using guessed type int dword_80BB4E0[];

//----- (0808AF20) --------------------------------------------------------
int __userpurge sub_808AF20@<eax>(int a1, int a2)
{
  int v2; // eax@1
  int v3; // esi@2
  int v4; // ecx@3
  int v5; // eax@6
  int v6; // esi@10
  int v7; // edi@11
  int v8; // eax@12
  void *v10; // eax@19
  int v11; // edx@19
  void *v12; // edx@21
  int v13; // esi@21
  unsigned int v14; // eax@21
  int v15; // esi@21
  int v16; // ecx@21
  char *v17; // ebp@21
  int v18; // ebx@23
  int v19; // edx@35
  int v20; // eax@24
  int v21; // ebx@45
  char v22; // [sp+1Fh] [bp-6Dh]@41
  int v23; // [sp+20h] [bp-6Ch]@13
  void *v24; // [sp+24h] [bp-68h]@10
  void *v25; // [sp+28h] [bp-64h]@10
  char *v26; // [sp+2Ch] [bp-60h]@10
  char v27; // [sp+30h] [bp-5Ch]@9

  v2 = *(_DWORD *)a2;
  if ( !*(_DWORD *)a2 || (v3 = *(_DWORD *)(v2 + 32)) == 0 )
  {
LABEL_16:
    *(_DWORD *)a1 = &unk_80CF83C;
    return a1;
  }
  v4 = *(_DWORD *)(v2 + 28);
  if ( !v4 || v3 <= 0 )
  {
LABEL_9:
    std::string::string(a1, v4, v3, &v27);
    return a1;
  }
  if ( *(_BYTE *)v4 >= 0 )
  {
    v5 = v4 + 1;
    while ( v5 != v4 + v3 )
    {
      ++v5;
      if ( *(_BYTE *)(v5 - 1) < 0 )
        goto LABEL_10;
    }
    goto LABEL_9;
  }
LABEL_10:
  v24 = 0;
  v25 = 0;
  v26 = 0;
  v6 = v3 + 1;
  if ( !v6 )
  {
    v26 = 0;
    v25 = 0;
    v7 = 0;
LABEL_12:
    v8 = (int)v25;
    goto LABEL_13;
  }
  if ( (unsigned int)v6 > 0x3FFFFFFF )
  {
    v21 = std::__throw_bad_alloc();
    if ( v24 )
      operator delete(v24);
    Unwind_Resume(v21);
  }
  v10 = (void *)operator new(4 * v6);
  v24 = v10;
  v25 = v10;
  v26 = (char *)v10 + 4 * v6;
  v11 = 0;
  do
    *((_DWORD *)v10 + v11++) = 0;
  while ( v11 != v6 );
  v7 = (int)v24;
  v12 = v24;
  v13 = *(_DWORD *)(*(_DWORD *)a2 + 32);
  v14 = *(_DWORD *)(*(_DWORD *)a2 + 28);
  v25 = v26;
  v15 = v14 + v13;
  v16 = (v26 - (_BYTE *)v24) >> 2;
  v17 = (char *)v24 + 4 * v16;
  if ( v17 <= v24 || v15 <= v14 )
  {
    v20 = 0;
  }
  else
  {
    v18 = v15 - v14;
    if ( (signed int)(v15 - v14) > 0 )
    {
      while ( 1 )
      {
        LOBYTE(v16) = *(_BYTE *)v14;
        if ( *(_BYTE *)v14 >= 0 )
        {
          *(_DWORD *)v12 = *(_BYTE *)v14;
          v16 = 1;
        }
        else if ( (unsigned __int8)v16 > 0xDFu )
        {
          if ( v18 <= 2 )
          {
LABEL_33:
            v20 = (signed int)((char *)v12 - v7) >> 2;
            goto LABEL_34;
          }
          *(_DWORD *)v12 = *(_BYTE *)(v14 + 2) & 0x3F | ((*(_BYTE *)(v14 + 1) & 0x3F) << 6) | (unsigned __int16)(((_WORD)v16 << 12) & 0xF000);
          v16 = 3;
        }
        else
        {
          if ( v18 == 1 )
            goto LABEL_33;
          *(_DWORD *)v12 = *(_BYTE *)(v14 + 1) & 0x3F | ((v16 & 0x1F) << 6);
          v16 = 2;
        }
        v14 += v16;
        v12 = (char *)v12 + 4;
        if ( v17 <= v12 || v15 <= v14 )
          break;
        v18 = v15 - v14;
        if ( (signed int)(v15 - v14) <= 0 )
          goto LABEL_33;
      }
      v20 = (signed int)((char *)v12 - v7) >> 2;
    }
    else
    {
      v20 = 0;
LABEL_34:
      *(_DWORD *)v12 = 0;
    }
    v7 = (int)v24;
    v19 = ((_BYTE *)v25 - (_BYTE *)v24) >> 2;
    v16 = v19;
    if ( v19 < (unsigned int)v20 )
    {
      sub_806B730((int)&v24, v20 - v19);
      v8 = (int)v25;
      v7 = (int)v24;
      goto LABEL_13;
    }
  }
  if ( v20 >= (unsigned int)v16 )
    goto LABEL_12;
  v8 = v7 + 4 * v20;
  v25 = (void *)v8;
LABEL_13:
  v23 = 64;
  if ( sub_80A71E0(v7, (v8 - v7) >> 2, (int)&v27, (int)&v23) )
  {
    if ( v24 )
      operator delete(v24);
    goto LABEL_16;
  }
  std::string::string(a1, &v27, v23, &v22);
  if ( v24 )
    operator delete(v24);
  return a1;
}
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);

//----- (0808B220) --------------------------------------------------------
int __cdecl sub_808B220(int a1, int a2, int a3, std::string *a4)
{
  int v4; // eax@2
  int v5; // eax@4
  int v6; // edx@6
  int result; // eax@6
  int v8; // edi@6
  int i; // esi@6
  int v10; // eax@9
  int v11; // [sp+1Ch] [bp-1Ch]@11

  HttpClient::HttpClient(a1);
  *(_DWORD *)(a1 + 132) = 0;
  *(_DWORD *)(a1 + 136) = 0;
  *(_DWORD *)(a1 + 144) = 0;
  *(_DWORD *)(a1 + 148) = 0;
  *(_DWORD *)a1 = &off_80BB6C8;
  *(_DWORD *)(a1 + 128) = &off_80BB6D8;
  *(_DWORD *)(a1 + 140) = &off_80BB6E8;
  *(_DWORD *)(a1 + 152) = 0;
  *(_DWORD *)(a1 + 156) = 0;
  *(_DWORD *)(a1 + 160) = 0;
  *(_DWORD *)(a1 + 164) = 0;
  *(_DWORD *)(a1 + 168) = 0;
  *(_DWORD *)(a1 + 172) = 0;
  *(_DWORD *)(a1 + 180) = a2;
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)(a1 + 184));
  if ( a2 + 28 != a1 + 4 )
  {
    v4 = *(_DWORD *)(a1 + 4);
    if ( v4 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v4 + 4));
      if ( !v4 )
        (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
    }
    v5 = *(_DWORD *)(a2 + 28);
    *(_DWORD *)(a1 + 4) = v5;
    if ( v5 )
      _InterlockedIncrement((volatile signed __int32 *)(v5 + 4));
  }
  *(_DWORD *)(a1 + 8) = a3;
  std::string::assign((std::string *)(a1 + 12), a4);
  *(_BYTE *)(a1 + 36) = 1;
  v6 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a2 + 24) + 32) + 16);
  sub_808B720(a1 + 164, 954437177 * ((*(_DWORD *)(v6 + 4) - *(_DWORD *)v6) >> 2));
  result = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a2 + 24) + 32) + 16);
  v8 = *(_DWORD *)(result + 4);
  for ( i = *(_DWORD *)result; v8 != i; i += 36 )
  {
    while ( 1 )
    {
      v11 = i;
      v10 = *(_DWORD *)(a1 + 168);
      if ( v10 != *(_DWORD *)(a1 + 172) )
        break;
      result = sub_808B830(a1 + 164, &v11);
      i += 36;
      if ( v8 == i )
        goto LABEL_13;
    }
    if ( v10 )
    {
      sub_80A5FD0(v10, i);
      v10 = *(_DWORD *)(a1 + 168);
    }
    result = v10 + 16;
    *(_DWORD *)(a1 + 168) = result;
  }
LABEL_13:
  *(_BYTE *)(a1 + 176) = 0;
  return result;
}
// 80BB6C8: using guessed type int (__cdecl *off_80BB6C8)(int);
// 80BB6D8: using guessed type void *off_80BB6D8;
// 80BB6E8: using guessed type void *off_80BB6E8;

//----- (0808B430) --------------------------------------------------------
int __cdecl sub_808B430(int a1)
{
  int result; // eax@1
  int v2; // edx@1
  int v3; // edx@2

  result = a1;
  *(_DWORD *)a1 = &off_80BB6A0;
  v2 = *(_DWORD *)(a1 + 4);
  if ( v2 )
  {
    *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 8);
    v3 = *(_DWORD *)(a1 + 8);
    if ( !v3 )
    {
LABEL_4:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_3:
    *(_DWORD *)(v3 + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_4;
  }
  v3 = *(_DWORD *)(a1 + 8);
  if ( v3 )
    goto LABEL_3;
  return result;
}
// 80BB6A0: using guessed type int (__cdecl *off_80BB6A0)(int);

//----- (0808B480) --------------------------------------------------------
void __cdecl sub_808B480(void *a1)
{
  int v1; // edx@1
  int v2; // edx@2

  *(_DWORD *)a1 = &off_80BB6A0;
  v1 = *((_DWORD *)a1 + 1);
  if ( !v1 )
  {
    v2 = *((_DWORD *)a1 + 2);
    if ( !v2 )
      goto LABEL_5;
    goto LABEL_3;
  }
  *(_DWORD *)(v1 + 8) = *((_DWORD *)a1 + 2);
  v2 = *((_DWORD *)a1 + 2);
  if ( v2 )
LABEL_3:
    *(_DWORD *)(v2 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_5:
  operator delete(a1);
}
// 80BB6A0: using guessed type int (__cdecl *off_80BB6A0)(int);

//----- (0808B4D0) --------------------------------------------------------
int __cdecl sub_808B4D0(int a1)
{
  int v1; // eax@5
  int v2; // eax@6
  int v3; // eax@9
  int v4; // eax@10

  *(_DWORD *)a1 = &off_80BB6C8;
  *(_DWORD *)(a1 + 128) = &off_80BB6D8;
  *(_DWORD *)(a1 + 140) = &off_80BB6E8;
  if ( *(_DWORD *)(a1 + 164) )
    operator delete(*(void **)(a1 + 164));
  if ( *(_DWORD *)(a1 + 152) )
    operator delete(*(void **)(a1 + 152));
  *(_DWORD *)(a1 + 140) = &off_80BB6A0;
  v1 = *(_DWORD *)(a1 + 144);
  if ( v1 )
  {
    *(_DWORD *)(v1 + 8) = *(_DWORD *)(a1 + 148);
    v2 = *(_DWORD *)(a1 + 148);
    if ( !v2 )
    {
LABEL_8:
      *(_DWORD *)(a1 + 144) = 0;
      *(_DWORD *)(a1 + 148) = 0;
      goto LABEL_9;
    }
LABEL_7:
    *(_DWORD *)(v2 + 4) = *(_DWORD *)(a1 + 144);
    goto LABEL_8;
  }
  v2 = *(_DWORD *)(a1 + 148);
  if ( v2 )
    goto LABEL_7;
LABEL_9:
  *(_DWORD *)(a1 + 128) = &off_80B94F0;
  v3 = *(_DWORD *)(a1 + 132);
  if ( !v3 )
  {
    v4 = *(_DWORD *)(a1 + 136);
    if ( !v4 )
      return sub_80725E0(a1);
    goto LABEL_11;
  }
  *(_DWORD *)(v3 + 8) = *(_DWORD *)(a1 + 136);
  v4 = *(_DWORD *)(a1 + 136);
  if ( v4 )
LABEL_11:
    *(_DWORD *)(v4 + 4) = *(_DWORD *)(a1 + 132);
  *(_DWORD *)(a1 + 132) = 0;
  *(_DWORD *)(a1 + 136) = 0;
  return sub_80725E0(a1);
}
// 80B94F0: using guessed type int (__cdecl *off_80B94F0)(int);
// 80BB6A0: using guessed type int (__cdecl *off_80BB6A0)(int);
// 80BB6C8: using guessed type int (__cdecl *off_80BB6C8)(int);
// 80BB6D8: using guessed type void *off_80BB6D8;
// 80BB6E8: using guessed type void *off_80BB6E8;

//----- (0808B5F0) --------------------------------------------------------
void __cdecl sub_808B5F0(void *a1)
{
  int v1; // eax@5
  int v2; // eax@6
  int v3; // eax@9
  int v4; // eax@10

  *(_DWORD *)a1 = &off_80BB6C8;
  *((_DWORD *)a1 + 32) = &off_80BB6D8;
  *((_DWORD *)a1 + 35) = &off_80BB6E8;
  if ( *((_DWORD *)a1 + 41) )
    operator delete(*((void **)a1 + 41));
  if ( *((_DWORD *)a1 + 38) )
    operator delete(*((void **)a1 + 38));
  *((_DWORD *)a1 + 35) = &off_80BB6A0;
  v1 = *((_DWORD *)a1 + 36);
  if ( v1 )
  {
    *(_DWORD *)(v1 + 8) = *((_DWORD *)a1 + 37);
    v2 = *((_DWORD *)a1 + 37);
    if ( !v2 )
    {
LABEL_8:
      *((_DWORD *)a1 + 36) = 0;
      *((_DWORD *)a1 + 37) = 0;
      goto LABEL_9;
    }
LABEL_7:
    *(_DWORD *)(v2 + 4) = *((_DWORD *)a1 + 36);
    goto LABEL_8;
  }
  v2 = *((_DWORD *)a1 + 37);
  if ( v2 )
    goto LABEL_7;
LABEL_9:
  *((_DWORD *)a1 + 32) = &off_80B94F0;
  v3 = *((_DWORD *)a1 + 33);
  if ( !v3 )
  {
    v4 = *((_DWORD *)a1 + 34);
    if ( !v4 )
      goto LABEL_13;
    goto LABEL_11;
  }
  *(_DWORD *)(v3 + 8) = *((_DWORD *)a1 + 34);
  v4 = *((_DWORD *)a1 + 34);
  if ( v4 )
LABEL_11:
    *(_DWORD *)(v4 + 4) = *((_DWORD *)a1 + 33);
  *((_DWORD *)a1 + 33) = 0;
  *((_DWORD *)a1 + 34) = 0;
LABEL_13:
  sub_80725E0((int)a1);
  operator delete(a1);
}
// 80B94F0: using guessed type int (__cdecl *off_80B94F0)(int);
// 80BB6A0: using guessed type int (__cdecl *off_80BB6A0)(int);
// 80BB6C8: using guessed type int (__cdecl *off_80BB6C8)(int);
// 80BB6D8: using guessed type void *off_80BB6D8;
// 80BB6E8: using guessed type void *off_80BB6E8;

//----- (0808B700) --------------------------------------------------------
void __cdecl sub_808B700(int a1)
{
  sub_808B5F0((void *)(a1 - 128));
}

//----- (0808B710) --------------------------------------------------------
void __cdecl sub_808B710(int a1)
{
  sub_808B5F0((void *)(a1 - 140));
}

//----- (0808B720) --------------------------------------------------------
int __cdecl sub_808B720(int a1, unsigned int a2)
{
  void *v2; // ebp@2
  int result; // eax@2
  void *v4; // esi@3
  int v5; // ebx@4
  void *v6; // ecx@6
  int v7; // edx@6
  int v8; // eax@8
  int v9; // [sp+8h] [bp-24h]@3
  unsigned int v10; // [sp+Ch] [bp-20h]@4

  if ( a2 > 0xFFFFFFF )
  {
    std::__throw_length_error("vector::reserve");
    result = sub_808B830(a1, (int *)a2);
  }
  else
  {
    v2 = *(void **)a1;
    result = (*(_DWORD *)(a1 + 8) - *(_DWORD *)a1) >> 4;
    if ( a2 > result )
    {
      v4 = *(void **)(a1 + 4);
      v9 = (*(_DWORD *)(a1 + 4) - (signed int)v2) >> 4;
      if ( a2 )
      {
        v10 = 16 * a2;
        v5 = operator new(16 * a2);
      }
      else
      {
        v10 = 0;
        v5 = 0;
      }
      if ( v2 != v4 )
      {
        v6 = v2;
        v7 = v5;
        do
        {
          if ( v7 )
          {
            *(_DWORD *)v7 = *(_DWORD *)v6;
            v8 = v7 - v5;
            *(_DWORD *)(v5 + v8 + 4) = *((_DWORD *)v6 + 1);
            *(_BYTE *)(v8 + v5 + 8) = 0;
            *(_DWORD *)(v7 + 12) = 0;
            if ( *((_BYTE *)v6 + 8) )
            {
              *(_DWORD *)(v7 + 12) = *((_DWORD *)v6 + 3);
              *(_BYTE *)(v7 + 8) = 1;
            }
          }
          v6 = (char *)v6 + 16;
          v7 += 16;
        }
        while ( v4 != v6 );
      }
      if ( *(_DWORD *)a1 )
        operator delete(*(void **)a1);
      *(_DWORD *)a1 = v5;
      result = v5 + 16 * v9;
      *(_DWORD *)(a1 + 4) = result;
      *(_DWORD *)(a1 + 8) = v10 + v5;
    }
  }
  return result;
}

//----- (0808B830) --------------------------------------------------------
int __cdecl sub_808B830(int a1, int *a2)
{
  int v2; // eax@1
  unsigned __int8 v3; // cf@2
  int v4; // eax@2
  unsigned int v5; // edx@3
  unsigned int v6; // eax@4
  unsigned int v7; // ebx@4
  void *v8; // ebp@4
  int v9; // eax@4
  void *v10; // edx@6
  unsigned int v11; // ecx@7
  int v12; // eax@9
  unsigned int v13; // edi@12
  void *v14; // eax@12
  int v15; // edi@13
  int result; // eax@15
  void *v17; // [sp+8h] [bp-24h]@5
  signed int v18; // [sp+Ch] [bp-20h]@3

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 4;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0xFFFFFFF )
    {
      v5 = -16;
      v18 = 0xFFFFFFF;
      goto LABEL_4;
    }
  }
  else
  {
    v4 = 1;
  }
  v5 = 16 * v4;
  v18 = v4;
LABEL_4:
  v6 = operator new(v5);
  v7 = v6;
  v8 = *(void **)(a1 + 4);
  v9 = v6 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFF0);
  if ( v9 )
  {
    sub_80A5FD0(v9, *a2);
    v8 = *(void **)(a1 + 4);
    v17 = *(void **)a1;
  }
  else
  {
    v17 = *(void **)a1;
  }
  v10 = v17;
  if ( v17 == v8 )
  {
    v14 = v17;
    v13 = v7;
  }
  else
  {
    v11 = v7;
    do
    {
      if ( v11 )
      {
        *(_DWORD *)v11 = *(_DWORD *)v10;
        v12 = v11 - v7;
        *(_DWORD *)(v7 + v12 + 4) = *((_DWORD *)v10 + 1);
        *(_BYTE *)(v12 + v7 + 8) = 0;
        *(_DWORD *)(v11 + 12) = 0;
        if ( *((_BYTE *)v10 + 8) )
        {
          *(_DWORD *)(v11 + 12) = *((_DWORD *)v10 + 3);
          *(_BYTE *)(v11 + 8) = 1;
        }
      }
      v10 = (char *)v10 + 16;
      v11 += 16;
    }
    while ( v10 != v8 );
    v13 = v7 + (((_BYTE *)v10 - ((_BYTE *)v17 + 16)) & 0xFFFFFFF0) + 16;
    v14 = *(void **)a1;
  }
  v15 = v13 + 16;
  if ( v14 )
    operator delete(v14);
  *(_DWORD *)a1 = v7;
  *(_DWORD *)(a1 + 4) = v15;
  result = 16 * v18;
  *(_DWORD *)(a1 + 8) = 16 * v18 + v7;
  return result;
}

//----- (0808B990) --------------------------------------------------------
signed int __usercall sub_808B990@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>)
{
  unsigned int v3; // ebx@1
  unsigned int v4; // ecx@1
  const void *v6; // esi@3
  void *v7; // edi@3
  unsigned int v8; // ebp@6
  void *v9; // edi@6
  const void *v10; // esi@6
  signed int v11; // ecx@7
  unsigned int v12; // ebp@18
  signed int v13; // ecx@19

  v3 = a3;
  v4 = *(_DWORD *)(a1 + 16);
  if ( v3 + v4 >= *(_DWORD *)(a1 + 4) )
    return 2;
  v6 = *(const void **)(a1 + 12);
  v7 = *(void **)a1;
  if ( v6 != *(const void **)a1 )
  {
    if ( v4 )
    {
      v12 = *(_DWORD *)(a1 + 16);
      if ( v4 >= 4 )
      {
        if ( (unsigned __int8)v7 & 1 )
        {
          *(_BYTE *)v7 = *(_BYTE *)v6;
          v7 = (char *)v7 + 1;
          v6 = (char *)v6 + 1;
          v12 = v4 - 1;
        }
        if ( (unsigned __int8)v7 & 2 )
        {
          *(_WORD *)v7 = *(_WORD *)v6;
          v7 = (char *)v7 + 2;
          v6 = (char *)v6 + 2;
          v12 -= 2;
        }
        qmemcpy(v7, v6, 4 * (v12 >> 2));
        v6 = (char *)v6 + 4 * (v12 >> 2);
        v7 = (char *)v7 + 4 * (v12 >> 2);
      }
      v13 = 0;
      if ( v12 & 2 )
      {
        *(_WORD *)v7 = *(_WORD *)v6;
        v13 = 2;
      }
      if ( v12 & 1 )
        *((_BYTE *)v7 + v13) = *((_BYTE *)v6 + v13);
      v7 = *(void **)a1;
      v4 = *(_DWORD *)(a1 + 16);
    }
    *(_DWORD *)(a1 + 12) = v7;
  }
  v8 = v3;
  v9 = (char *)v7 + v4;
  v10 = (const void *)a2;
  if ( v3 < 4 )
  {
    v11 = 0;
    if ( !(v3 & 2) )
      goto LABEL_8;
LABEL_12:
    *(_WORD *)v9 = *(_WORD *)v10;
    v11 = 2;
    if ( !(v8 & 1) )
      goto LABEL_9;
    goto LABEL_11;
  }
  if ( (unsigned __int8)v9 & 1 )
  {
    *(_BYTE *)v9 = *(_BYTE *)a2;
    v9 = (char *)v9 + 1;
    v10 = (const void *)(a2 + 1);
    v8 = v3 - 1;
  }
  if ( (unsigned __int8)v9 & 2 )
  {
    *(_WORD *)v9 = *(_WORD *)v10;
    v9 = (char *)v9 + 2;
    v10 = (char *)v10 + 2;
    v8 -= 2;
  }
  qmemcpy(v9, v10, 4 * (v8 >> 2));
  v10 = (char *)v10 + 4 * (v8 >> 2);
  v9 = (char *)v9 + 4 * (v8 >> 2);
  v11 = 0;
  if ( v8 & 2 )
    goto LABEL_12;
LABEL_8:
  if ( !(v8 & 1) )
  {
LABEL_9:
    *(_DWORD *)(a1 + 16) += v3;
    return 0;
  }
LABEL_11:
  *((_BYTE *)v9 + v11) = *((_BYTE *)v10 + v11);
  *(_DWORD *)(a1 + 16) += v3;
  return 0;
}

//----- (0808BB10) --------------------------------------------------------
signed int __usercall sub_808BB10@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // ebx@1
  int v4; // esi@1
  signed int result; // eax@1

  v3 = a2;
  v4 = a3;
  result = sub_808B990(a1, a2, *(_DWORD *)a3 - a2);
  if ( result )
    *(_DWORD *)v4 = v3;
  return result;
}

//----- (0808BB30) --------------------------------------------------------
signed int __usercall sub_808BB30@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // esi@1
  int v4; // ebx@1
  int v5; // edi@1
  signed int result; // eax@1

  v3 = a1;
  v4 = a2;
  v5 = a3;
  result = sub_808B990(a1, a2, *(_DWORD *)a3 - a2);
  if ( result )
  {
    if ( *(_DWORD *)(v3 + 16) )
    {
      *(_DWORD *)v5 = v4;
      result = 2;
    }
    else
    {
      *(_DWORD *)(v3 + 12) = v4;
      *(_DWORD *)(v3 + 16) = *(_DWORD *)v5 - v4;
      result = 2;
    }
  }
  return result;
}

//----- (0808BB80) --------------------------------------------------------
signed int __usercall sub_808BB80@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // edi@1
  int v4; // eax@1
  int v5; // esi@1
  char v6; // bl@8
  signed int result; // eax@15

  v3 = a1;
  v4 = *(_DWORD *)a2;
  v5 = *(_DWORD *)a2;
  if ( *(_DWORD *)a2 != a3 )
  {
    do
    {
      v6 = *(_BYTE *)v5;
      if ( *(_BYTE *)v5 == 32 )
        break;
      if ( *(_BYTE *)v5 <= 32 )
      {
        if ( v6 >= 9 && (v6 <= 10 || v6 == 13) )
          break;
      }
      else if ( v6 == 93 || v6 == 125 || v6 == 44 )
      {
        break;
      }
      if ( (unsigned __int8)(v6 - 32) > 0x5Eu )
        return 3;
      ++v5;
      *(_DWORD *)a2 = v5;
    }
    while ( a3 != v5 );
    if ( *(_DWORD *)(v3 + 16) )
    {
      result = sub_808BB10(v3, v4, a2);
      if ( result )
        return result;
    }
    else
    {
      *(_DWORD *)(v3 + 12) = v4;
      *(_DWORD *)(v3 + 16) = *(_DWORD *)a2 - v4;
    }
    *(_DWORD *)(v3 + 20) = 0;
    return 0;
  }
  result = sub_808BB30(v3, v4, a2);
  if ( !result )
    result = 4;
  return result;
}

//----- (0808BC30) --------------------------------------------------------
signed int __usercall sub_808BC30@<eax>(int a1@<eax>, int *a2@<edx>, int a3@<ecx>)
{
  int v3; // ebx@1
  int v4; // esi@1
  int v5; // edi@1
  int v6; // eax@1
  int v7; // ebp@1
  int v8; // edx@2
  int v9; // edx@3
  int v10; // ecx@3
  int v11; // ecx@6
  int v12; // edx@9
  int v13; // edx@10
  int v14; // eax@13
  unsigned int v15; // ecx@15
  signed int result; // eax@16
  bool v17; // zf@32
  char v18; // al@40
  int v19; // edx@75
  char v20; // [sp+1Fh] [bp-1Dh]@3

  v3 = a1;
  v4 = (int)a2;
  v5 = a3;
  v6 = *a2;
  v7 = *a2;
  if ( *a2 != a3 )
  {
    v8 = *a2;
    while ( 1 )
    {
      v9 = *(_BYTE *)v8;
      v20 = v9;
      v10 = *(_DWORD *)(v3 + 20);
      switch ( v10 )
      {
        case 6:
          if ( (unsigned __int8)(v9 - 9) <= 0x31u )
          {
            switch ( (unsigned __int8)(v9 - 9) )
            {
              case 0u:
              case 1u:
              case 4u:
              case 0x17u:
                goto LABEL_12;
              case 2u:
              case 3u:
              case 5u:
              case 6u:
              case 7u:
              case 8u:
              case 9u:
              case 0xAu:
              case 0xBu:
              case 0xCu:
              case 0xDu:
              case 0xEu:
              case 0xFu:
              case 0x10u:
              case 0x11u:
              case 0x12u:
              case 0x13u:
              case 0x14u:
              case 0x15u:
              case 0x16u:
              case 0x18u:
              case 0x19u:
              case 0x1Au:
              case 0x1Bu:
              case 0x1Cu:
              case 0x1Du:
              case 0x1Eu:
              case 0x1Fu:
              case 0x20u:
              case 0x21u:
              case 0x22u:
              case 0x23u:
              case 0x24u:
              case 0x25u:
              case 0x26u:
              case 0x27u:
              case 0x28u:
              case 0x29u:
              case 0x2Au:
              case 0x2Bu:
              case 0x2Cu:
              case 0x2Du:
              case 0x2Eu:
              case 0x2Fu:
              case 0x30u:
                goto LABEL_34;
              case 0x31u:
                *(_DWORD *)(v3 + 8) = 3;
                break;
            }
          }
          goto LABEL_34;
        case 4:
        case 8:
          v11 = *(_DWORD *)(v3 + 28);
          if ( v11 > 0 )
          {
            if ( (unsigned __int8)(v9 - 48) <= 9u )
            {
              v12 = v9 - 48;
            }
            else if ( (unsigned __int8)(v9 - 97) > 5u )
            {
              if ( (unsigned __int8)(v9 - 65) > 5u )
                return 3;
              v12 = v9 - 55;
            }
            else
            {
              v12 = v9 - 87;
            }
            *(_DWORD *)(v3 + 28) = v11 - 1;
            v13 = *(_DWORD *)(v3 + 32) | (v12 << 4 * (v11 - 1));
            *(_DWORD *)(v3 + 32) = v13;
            if ( v11 != 1 )
            {
              v6 = *(_DWORD *)v4;
              goto LABEL_12;
            }
            if ( v13 >= 0 )
            {
              if ( v13 <= 127 )
              {
                *(_BYTE *)(v3 + 33) = v13;
                v18 = 1;
                goto LABEL_41;
              }
              if ( v13 <= 2047 )
              {
                *(_BYTE *)(v3 + 33) = (v13 >> 6) | 0xC0;
                *(_BYTE *)(v3 + 34) = v13 & 0x3F | 0x80;
                v18 = 2;
LABEL_41:
                *(_BYTE *)(v3 + 32) = v18;
LABEL_42:
                result = sub_808B990(v3, v3 + 33, *(_BYTE *)(v3 + 32));
                if ( result )
                  return result;
                v7 = *(_DWORD *)v4 + 1;
                v17 = *(_DWORD *)(v3 + 20) == 4;
                goto LABEL_44;
              }
              if ( v13 <= 0xFFFF )
              {
                *(_BYTE *)(v3 + 33) = (v13 >> 12) | 0xE0;
                *(_BYTE *)(v3 + 34) = (v13 >> 6) & 0x3F | 0x80;
                *(_BYTE *)(v3 + 35) = v13 & 0x3F | 0x80;
                v18 = 3;
                goto LABEL_41;
              }
            }
            v18 = -1;
            goto LABEL_41;
          }
          if ( !v11 )
            goto LABEL_42;
          v8 = v6 + 1;
          v6 = v8;
          *(_DWORD *)v4 = v8;
          if ( v5 == v8 )
            goto LABEL_13;
          break;
        default:
          goto LABEL_12;
        case 2:
        case 5:
          if ( (_BYTE)v9 == 34 )
          {
            if ( *(_DWORD *)(v3 + 16) )
            {
              result = sub_808BB10(v3, v7, v4);
              if ( result )
                return result;
              v10 = *(_DWORD *)(v3 + 20);
            }
            else
            {
              *(_DWORD *)(v3 + 12) = v7;
              *(_DWORD *)(v3 + 16) = *(_DWORD *)v4 - v7;
            }
            if ( v10 != 5 )
            {
LABEL_34:
              *(_DWORD *)(v3 + 20) = 0;
              return 0;
            }
            *(_DWORD *)(v3 + 20) = 6;
            v8 = *(_DWORD *)v4 + 1;
            v6 = v8;
            *(_DWORD *)v4 = v8;
            if ( v5 == v8 )
              goto LABEL_13;
          }
          else if ( (_BYTE)v9 == 92 )
          {
            if ( *(_DWORD *)(v3 + 16) )
            {
              result = sub_808BB10(v3, v7, v4);
              if ( result )
                return result;
              v10 = *(_DWORD *)(v3 + 20);
            }
            else
            {
              *(_DWORD *)(v3 + 12) = v7;
              *(_DWORD *)(v3 + 16) = *(_DWORD *)v4 - v7;
            }
            *(_DWORD *)(v3 + 20) = 4 * (v10 != 2) + 3;
            v8 = *(_DWORD *)v4 + 1;
            v6 = v8;
            *(_DWORD *)v4 = v8;
            if ( v5 == v8 )
              goto LABEL_13;
          }
          else
          {
LABEL_12:
            v8 = v6 + 1;
            v6 = v8;
            *(_DWORD *)v4 = v8;
            if ( v5 == v8 )
              goto LABEL_13;
          }
          continue;
        case 3:
        case 7:
          if ( (_BYTE)v9 == 117 )
          {
            *(_DWORD *)(v3 + 20) = 4 * (v10 != 3) + 4;
            *(_DWORD *)(v3 + 28) = 4;
            *(_DWORD *)(v3 + 32) = 0;
            v8 = *(_DWORD *)v4 + 1;
            v6 = v8;
            *(_DWORD *)v4 = v8;
            if ( v5 == v8 )
              goto LABEL_13;
            continue;
          }
          if ( (_BYTE)v9 == 98 )
          {
            v20 = 8;
          }
          else if ( (char)v9 <= 98 )
          {
            if ( (_BYTE)v9 != 47 && (_BYTE)v9 != 92 && (_BYTE)v9 != 34 )
              return 3;
          }
          else if ( (_BYTE)v9 == 110 )
          {
            v20 = 10;
          }
          else if ( (char)v9 <= 110 )
          {
            if ( (_BYTE)v9 != 102 )
              return 3;
            v20 = 12;
          }
          else if ( (_BYTE)v9 == 114 )
          {
            v20 = 13;
          }
          else
          {
            if ( (_BYTE)v9 != 116 )
              return 3;
            v20 = 9;
          }
          result = sub_808B990(v3, (int)&v20, 1u);
          if ( result )
            return result;
          v7 = *(_DWORD *)v4 + 1;
          v17 = *(_DWORD *)(v3 + 20) == 3;
LABEL_44:
          *(_DWORD *)(v3 + 20) = 3 * !v17 + 2;
          v6 = *(_DWORD *)v4;
          goto LABEL_12;
      }
    }
  }
LABEL_13:
  v14 = *(_DWORD *)(v3 + 20);
  if ( v14 != 2 && v14 != 5 )
  {
    v15 = *(_DWORD *)(v3 + 16);
    if ( v15 )
    {
      v19 = *(_DWORD *)(v3 + 12);
      if ( v19 != *(_DWORD *)v3 )
      {
        *(_DWORD *)(v3 + 16) = 0;
        if ( sub_808B990(v3, v19, v15) )
          abort();
      }
    }
    goto LABEL_16;
  }
  result = sub_808BB30(v3, v7, v4);
  if ( !result )
LABEL_16:
    result = 4;
  return result;
}

//----- (0808C080) --------------------------------------------------------
int __cdecl sub_808C080(int a1, int a2, int a3)
{
  int result; // eax@1

  result = a1;
  *(_DWORD *)a1 = a2;
  *(_DWORD *)(a1 + 4) = a3;
  *(_DWORD *)(a1 + 20) = 0;
  *(_DWORD *)(a1 + 24) = 0;
  *(_DWORD *)(a1 + 8) = 1;
  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 16) = 0;
  return result;
}

//----- (0808C0E0) --------------------------------------------------------
BOOL __cdecl sub_808C0E0(int a1)
{
  return (*(_DWORD *)(a1 + 8) & 0xFFFFFFFD) != 4;
}

//----- (0808C100) --------------------------------------------------------
signed int __cdecl sub_808C100(int a1, int a2)
{
  signed int result; // eax@3

  if ( a2 == 1 )
  {
    result = 1;
  }
  else if ( a2 == 4 )
  {
    result = (*(_DWORD *)(a1 + 8) & 0xFFFFFFFD) != 4;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0808C150) --------------------------------------------------------
signed int __cdecl sub_808C150(int a1, int *a2, int a3)
{
  unsigned int v3; // eax@2
  signed int result; // eax@5
  int v5; // edx@8
  char v6; // al@9
  int v7; // edx@20

  if ( *(_DWORD *)(a1 + 24) == 2 )
    *(_DWORD *)(a1 + 16) = 0;
  v3 = *(_DWORD *)(a1 + 20);
  if ( v3 == 1 )
  {
LABEL_17:
    result = sub_808BB80(a1, (int)a2, a3);
    if ( result )
    {
LABEL_6:
      if ( result == 1 )
        goto LABEL_30;
      goto LABEL_7;
    }
LABEL_18:
    if ( (*(_DWORD *)(a1 + 8) & 0xFFFFFFFD) != 1 )
    {
      if ( *(_DWORD *)(a1 + 8) != 2 )
      {
LABEL_20:
        v7 = *a2;
LABEL_21:
        *a2 = v7 + 1;
        result = 0;
        *(_DWORD *)(a1 + 24) = 0;
        return result;
      }
      v7 = *a2;
      if ( *(_BYTE *)*a2 != 93 )
        goto LABEL_21;
    }
LABEL_7:
    *(_DWORD *)(a1 + 24) = result;
    return result;
  }
  if ( v3 >= 1 && v3 <= 8 )
  {
LABEL_5:
    result = sub_808BC30(a1, a2, a3);
    if ( result )
      goto LABEL_6;
    goto LABEL_18;
  }
  *(_DWORD *)(a1 + 16) = 0;
  v5 = *a2;
  if ( a3 == *a2 )
  {
LABEL_37:
    result = 4;
    goto LABEL_7;
  }
  while ( 1 )
  {
    v6 = *(_BYTE *)v5;
    if ( *(_BYTE *)v5 == 34 )
    {
      *a2 = v5 + 1;
      *(_DWORD *)(a1 + 20) = 3 * (*(_DWORD *)(a1 + 8) != 3) + 2;
      *(_DWORD *)(a1 + 8) = 2;
      goto LABEL_5;
    }
    if ( *(_BYTE *)v5 <= 34 )
      break;
    if ( v6 == 91 )
    {
      *(_DWORD *)(a1 + 8) = 6;
      goto LABEL_20;
    }
    if ( v6 > 91 )
    {
      if ( v6 == 123 )
      {
        *(_DWORD *)(a1 + 8) = 4;
        goto LABEL_20;
      }
      if ( v6 == 125 )
      {
        *(_DWORD *)(a1 + 8) = 5;
        goto LABEL_20;
      }
      if ( v6 == 93 )
      {
        *(_DWORD *)(a1 + 8) = 7;
        goto LABEL_20;
      }
LABEL_16:
      *(_DWORD *)(a1 + 20) = 1;
      *(_DWORD *)(a1 + 8) = 1;
      goto LABEL_17;
    }
    if ( v6 != 44 && v6 != 58 )
      goto LABEL_16;
LABEL_36:
    ++v5;
    *a2 = v5;
    if ( a3 == v5 )
      goto LABEL_37;
  }
  if ( v6 > 10 )
  {
    if ( v6 != 13 && v6 != 32 )
      goto LABEL_16;
    goto LABEL_36;
  }
  if ( v6 >= 9 )
    goto LABEL_36;
  if ( v6 )
    goto LABEL_16;
  if ( (*(_DWORD *)(a1 + 8) & 0xFFFFFFFD) == 4 )
  {
    result = 3;
    goto LABEL_7;
  }
  result = 1;
LABEL_30:
  ++*a2;
  *(_DWORD *)(a1 + 24) = result;
  return result;
}

//----- (0808C350) --------------------------------------------------------
int __cdecl sub_808C350(int a1)
{
  int result; // eax@1

  result = a1;
  *(_DWORD *)a1 = 0;
  *(_DWORD *)(a1 + 4) = 0;
  return result;
}

//----- (0808C370) --------------------------------------------------------
signed int __cdecl sub_808C370(int a1, unsigned int a2, int a3, unsigned int a4)
{
  int v4; // ebx@4
  int v5; // ebx@12
  int v7; // ebx@16
  int v8; // ebx@19
  int v9; // ebx@22
  int v10; // ebx@24

  if ( *(_DWORD *)(a1 + 4) != a2 )
  {
    if ( a2 == 5 || a2 == 7 )
      goto LABEL_7;
    v4 = *(_DWORD *)a1;
    if ( *(_DWORD *)a1 != 5 )
    {
      if ( *(_DWORD *)a1 <= 5u )
      {
        if ( (unsigned int)(v4 - 1) > 1 )
          goto LABEL_7;
      }
      else if ( v4 != 7 )
      {
LABEL_7:
        *(_DWORD *)(a1 + 4) = a2;
        goto LABEL_8;
      }
    }
    v8 = *(_DWORD *)a3;
    if ( *(_DWORD *)a3 >= a4 )
      return 4;
    *(_DWORD *)a3 = v8 + 1;
    *(_BYTE *)v8 = 44;
    *(_DWORD *)(a1 + 4) = a2;
  }
LABEL_8:
  if ( a2 == 5 )
  {
    v10 = *(_DWORD *)a3;
    if ( a4 > *(_DWORD *)a3 )
    {
      *(_DWORD *)a3 = v10 + 1;
      *(_BYTE *)v10 = 125;
      goto LABEL_14;
    }
    return 4;
  }
  if ( a2 <= 5 )
  {
    if ( a2 == 4 )
    {
      v7 = *(_DWORD *)a3;
      if ( a4 > *(_DWORD *)a3 )
      {
        *(_DWORD *)a3 = v7 + 1;
        *(_BYTE *)v7 = 123;
        goto LABEL_14;
      }
      return 4;
    }
    return 3;
  }
  if ( a2 == 6 )
  {
    v9 = *(_DWORD *)a3;
    if ( a4 > *(_DWORD *)a3 )
    {
      *(_DWORD *)a3 = v9 + 1;
      *(_BYTE *)v9 = 91;
      goto LABEL_14;
    }
    return 4;
  }
  if ( a2 == 7 )
  {
    v5 = *(_DWORD *)a3;
    if ( a4 > *(_DWORD *)a3 )
    {
      *(_DWORD *)a3 = v5 + 1;
      *(_BYTE *)v5 = 93;
LABEL_14:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)a1 = a2;
      return 0;
    }
    return 4;
  }
  return 3;
}

//----- (0808C480) --------------------------------------------------------
signed int __cdecl sub_808C480(int a1, unsigned int a2, const void **a3, int a4, void **a5, unsigned int a6)
{
  unsigned int v6; // ecx@1
  unsigned int v7; // eax@4
  signed int v8; // esi@7
  void *v9; // edx@8
  void *v11; // eax@13
  int v12; // edi@18
  char *v13; // esi@19
  char v14; // al@21
  void *v15; // eax@30
  char v16; // dl@35
  void *v17; // eax@37
  int v18; // eax@39
  int v19; // eax@41
  signed int v20; // edi@41
  unsigned int v21; // ST2C_4@49
  const void *v22; // esi@53
  int v23; // edx@53
  void *v24; // edi@53
  int v25; // eax@53
  unsigned int v26; // edx@54
  signed int v27; // ecx@55
  signed int v28; // eax@65
  unsigned int v29; // [sp+10h] [bp-3Ch]@0
  unsigned int v30; // [sp+10h] [bp-3Ch]@64

  v6 = a6;
  if ( *(_DWORD *)(a1 + 4) == a2 )
    goto LABEL_15;
  if ( a2 == 5 || a2 == 7 )
    goto LABEL_7;
  v7 = *(_DWORD *)a1;
  if ( *(_DWORD *)a1 == 5 )
    goto LABEL_63;
  if ( v7 <= 5 )
  {
    if ( v7 - 1 > 1 )
      goto LABEL_7;
LABEL_63:
    v8 = 1;
    goto LABEL_8;
  }
  if ( v7 == 7 )
    goto LABEL_63;
LABEL_7:
  v8 = 0;
LABEL_8:
  v9 = *a5;
  if ( a6 < (unsigned int)((char *)*a5 + (a2 - 2 < 2) + v8) )
    return 4;
  if ( v8 )
  {
    *a5 = (char *)v9 + 1;
    *(_BYTE *)v9 = 44;
  }
  if ( a2 - 2 <= 1 )
  {
    v11 = *a5;
    *a5 = (char *)*a5 + 1;
    *(_BYTE *)v11 = 34;
  }
  *(_DWORD *)(a1 + 4) = a2;
LABEL_15:
  if ( a2 == 1 )
  {
    v22 = *a3;
    v23 = a4 - (_DWORD)*a3;
    v24 = *a5;
    v25 = a6 - (_DWORD)*a5;
    if ( v23 > (unsigned int)v25 )
    {
      v26 = a6 - (_DWORD)*a5;
      if ( (unsigned int)v25 >= 4 )
      {
        if ( (unsigned __int8)v24 & 1 )
        {
          *(_BYTE *)v24 = *(_BYTE *)v22;
          v24 = (char *)v24 + 1;
          v22 = (char *)v22 + 1;
          v26 = v25 - 1;
        }
        if ( (unsigned __int8)v24 & 2 )
        {
          *(_WORD *)v24 = *(_WORD *)v22;
          v24 = (char *)v24 + 2;
          v22 = (char *)v22 + 2;
          v26 -= 2;
        }
        qmemcpy(v24, v22, 4 * (v26 >> 2));
        v22 = (char *)v22 + 4 * (v26 >> 2);
        v24 = (char *)v24 + 4 * (v26 >> 2);
      }
      v27 = 0;
      if ( v26 & 2 )
      {
        *(_WORD *)v24 = *(_WORD *)v22;
        v27 = 2;
      }
      if ( v26 & 1 )
        *((_BYTE *)v24 + v27) = *((_BYTE *)v22 + v27);
      *a3 = (char *)*a3 + v25;
      *a5 = (char *)*a5 + v25;
      return 4;
    }
    v30 = a4 - (_DWORD)*a3;
    if ( (unsigned int)v23 >= 4 )
    {
      if ( (unsigned __int8)v24 & 1 )
      {
        *(_BYTE *)v24 = *(_BYTE *)v22;
        v24 = (char *)v24 + 1;
        v22 = (char *)v22 + 1;
        v30 = v23 - 1;
      }
      if ( (unsigned __int8)v24 & 2 )
      {
        *(_WORD *)v24 = *(_WORD *)v22;
        v24 = (char *)v24 + 2;
        v22 = (char *)v22 + 2;
        v30 -= 2;
      }
      qmemcpy(v24, v22, 4 * (v30 >> 2));
      v22 = (char *)v22 + 4 * (v30 >> 2);
      v24 = (char *)v24 + 4 * (v30 >> 2);
    }
    v28 = 0;
    if ( v30 & 2 )
    {
      *(_WORD *)v24 = *(_WORD *)v22;
      v28 = 2;
    }
    if ( v30 & 1 )
      *((_BYTE *)v24 + v28) = *((_BYTE *)v22 + v28);
    *a3 = (char *)*a3 + v23;
    *a5 = (char *)*a5 + v23;
  }
  else
  {
    if ( a2 < 1 || a2 > 3 )
      return 3;
    v12 = (int)*a3;
LABEL_19:
    while ( 1 )
    {
      v13 = (char *)*a5;
      if ( a4 == v12 )
        break;
      while ( 1 )
      {
        if ( (char *)v6 == v13 )
          goto LABEL_28;
        v14 = *(_BYTE *)v12;
        LOBYTE(v29) = *(_BYTE *)v12;
        if ( *(_BYTE *)v12 == 12 )
        {
          v16 = 102;
LABEL_36:
          if ( v6 <= (unsigned int)(v13 + 1) )
            return 4;
          *a5 = v13 + 1;
          *v13 = 92;
          v17 = *a5;
          *a5 = (char *)*a5 + 1;
          *(_BYTE *)v17 = v16;
          v12 = (int)((char *)*a3 + 1);
          *a3 = (const void *)v12;
          goto LABEL_19;
        }
        if ( v14 > 12 )
        {
          if ( (_BYTE)v29 == 34 )
          {
            v16 = 34;
            goto LABEL_36;
          }
          if ( (_BYTE)v29 == 92 )
          {
            v16 = 92;
            goto LABEL_36;
          }
          if ( (_BYTE)v29 == 13 )
          {
            v16 = 114;
            goto LABEL_36;
          }
        }
        else
        {
          if ( v14 == 9 )
          {
            v16 = 116;
            goto LABEL_36;
          }
          if ( v14 == 10 )
          {
            v16 = 110;
            goto LABEL_36;
          }
          if ( v14 == 8 )
          {
            v16 = 98;
            goto LABEL_36;
          }
        }
        if ( (char)v29 <= 31 )
          break;
        *a5 = v13 + 1;
        *v13 = v29;
        v12 = (int)((char *)*a3 + 1);
        *a3 = (const void *)v12;
        v13 = (char *)*a5;
        if ( a4 == v12 )
          goto LABEL_28;
      }
      if ( v6 <= (unsigned int)(v13 + 6) )
        return 4;
      v18 = a4 - v12;
      if ( a4 - v12 > 0 )
      {
        if ( (v29 & 0x80u) == 0 )
        {
          v19 = (unsigned __int8)v29;
          v20 = 1;
LABEL_42:
          v29 = v6;
          *a5 = &v13[sprintf(v13, "\\u%.4x", v19)];
          v12 = (int)((char *)*a3 + v20);
          *a3 = (const void *)v12;
          v6 = v29;
          continue;
        }
        if ( (unsigned __int8)v29 > 0xDFu )
        {
          if ( v18 > 2 )
          {
            v19 = (unsigned __int16)(((_WORD)v29 << 12) & 0xF000) | *(_BYTE *)(v12 + 2) & 0x3F | ((*(_BYTE *)(v12 + 1) & 0x3F) << 6);
            v20 = 3;
            goto LABEL_42;
          }
        }
        else if ( v18 != 1 )
        {
          v19 = *(_BYTE *)(v12 + 1) & 0x3F | ((v29 & 0x1F) << 6);
          v20 = 2;
          goto LABEL_42;
        }
      }
      v21 = v6;
      *a5 = &v13[sprintf(v13, "%%%02X", (unsigned __int8)v29)];
      v12 = (int)((char *)*a3 + 1);
      *a3 = (const void *)v12;
      v6 = v21;
    }
LABEL_28:
    if ( a2 == 3 )
    {
      if ( v6 <= (unsigned int)(v13 + 1) )
        return 4;
      *a5 = v13 + 1;
      *v13 = 34;
      v15 = *a5;
      *a5 = (char *)*a5 + 1;
      *(_BYTE *)v15 = 58;
    }
    else
    {
      if ( v6 <= (unsigned int)v13 )
        return 4;
      *a5 = v13 + 1;
      *v13 = 34;
    }
  }
  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)a1 = a2;
  return 0;
}

//----- (0808CA10) --------------------------------------------------------
int __cdecl sub_808CA10(int a1, std::string *a2)
{
  int v2; // ebx@1
  int result; // eax@1

  v2 = *(_DWORD *)a1;
  result = std::string::compare(a2, "meta");
  if ( !result )
  {
    result = **(_DWORD **)v2;
    *(_BYTE *)(result + 88) = 1;
  }
  return result;
}

//----- (0808CC30) --------------------------------------------------------
int __cdecl sub_808CC30(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  const void *v4; // esi@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC88;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(0x10u);
    qmemcpy(v5, v4, 0x10u);
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCC88: using guessed type void *off_80BCC88;

//----- (0808CEB0) --------------------------------------------------------
int __cdecl sub_808CEB0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC98;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCC98: using guessed type void *off_80BCC98;

//----- (0808CF50) --------------------------------------------------------
int __cdecl sub_808CF50(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC90;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCC90: using guessed type void *off_80BCC90;

//----- (0808CFF0) --------------------------------------------------------
int __cdecl sub_808CFF0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC70;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCC70: using guessed type void *off_80BCC70;

//----- (0808D090) --------------------------------------------------------
int __cdecl sub_808D090(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC50;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCC50: using guessed type void *off_80BCC50;

//----- (0808D130) --------------------------------------------------------
int __cdecl sub_808D130(void **a1, void **a2, signed int a3)
{
  int result; // eax@6

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC40;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    *a1 = (void *)operator new(1u);
    result = 0;
  }
  return result;
}
// 80BCC40: using guessed type void *off_80BCC40;

//----- (0808D1C0) --------------------------------------------------------
int __cdecl sub_808D1C0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC48;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCC48: using guessed type void *off_80BCC48;

//----- (0808D260) --------------------------------------------------------
int __cdecl sub_808D260(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC38;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCC38: using guessed type void *off_80BCC38;

//----- (0808D300) --------------------------------------------------------
int __cdecl sub_808D300(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBE8;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCBE8: using guessed type void *off_80BCBE8;

//----- (0808D3A0) --------------------------------------------------------
int __cdecl sub_808D3A0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBF0;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCBF0: using guessed type void *off_80BCBF0;

//----- (0808D440) --------------------------------------------------------
int __cdecl sub_808D440(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBF8;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCBF8: using guessed type void *off_80BCBF8;

//----- (0808D4E0) --------------------------------------------------------
int __cdecl sub_808D4E0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC30;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCC30: using guessed type void *off_80BCC30;

//----- (0808D580) --------------------------------------------------------
int __cdecl sub_808D580(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC20;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCC20: using guessed type void *off_80BCC20;

//----- (0808D620) --------------------------------------------------------
int __cdecl sub_808D620(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC28;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCC28: using guessed type void *off_80BCC28;

//----- (0808D6C0) --------------------------------------------------------
int __cdecl sub_808D6C0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC00;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCC00: using guessed type void *off_80BCC00;

//----- (0808D760) --------------------------------------------------------
int __cdecl sub_808D760(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC18;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCC18: using guessed type void *off_80BCC18;

//----- (0808D800) --------------------------------------------------------
int __cdecl sub_808D800(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC10;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCC10: using guessed type void *off_80BCC10;

//----- (0808D8A0) --------------------------------------------------------
int __cdecl sub_808D8A0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCC08;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCC08: using guessed type void *off_80BCC08;

//----- (0808D940) --------------------------------------------------------
int __cdecl sub_808D940(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBE0;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCBE0: using guessed type void *off_80BCBE0;

//----- (0808D9E0) --------------------------------------------------------
int __cdecl sub_808D9E0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBD8;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCBD8: using guessed type void *off_80BCBD8;

//----- (0808DA80) --------------------------------------------------------
int __cdecl sub_808DA80(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBD0;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCBD0: using guessed type void *off_80BCBD0;

//----- (0808DB20) --------------------------------------------------------
int __cdecl sub_808DB20(void **a1, void **a2, signed int a3)
{
  int result; // eax@6

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBC8;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    *a1 = (void *)operator new(1u);
    result = 0;
  }
  return result;
}
// 80BCBC8: using guessed type void *off_80BCBC8;

//----- (0808DBB0) --------------------------------------------------------
int __cdecl sub_808DBB0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBC0;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCBC0: using guessed type void *off_80BCBC0;

//----- (0808DC50) --------------------------------------------------------
int __cdecl sub_808DC50(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBB8;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BCBB8: using guessed type void *off_80BCBB8;

//----- (0808DCF0) --------------------------------------------------------
int __cdecl sub_808DCF0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCBB0;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCBB0: using guessed type void *off_80BCBB0;

//----- (0808DD90) --------------------------------------------------------
int __cdecl sub_808DD90(std::string *a1, std::string *a2, std::string *a3)
{
  int result; // eax@1

  std::string::string(a1, a2);
  result = std::string::string((std::string *)((char *)a1 + 4), a3);
  *((_DWORD *)a1 + 2) = -1;
  *((_BYTE *)a1 + 12) = 0;
  *((_BYTE *)a1 + 13) = 0;
  return result;
}

//----- (0808DDF0) --------------------------------------------------------
FILE *__cdecl sub_808DDF0(FILE *stream, int a2)
{
  FILE *result; // eax@1
  FILE *v3; // esi@2

  result = (FILE *)a2;
  if ( LOBYTE(stream->_IO_read_base) != (_BYTE)a2 )
  {
    LOBYTE(stream->_IO_read_base) = a2;
    result = fopen("/sys/class/leds/tp-link:green:wlan/brightness", "w");
    v3 = result;
    if ( result )
    {
      fprintf(result, "%d", LOBYTE(stream->_IO_read_base));
      result = (FILE *)fclose(v3);
    }
  }
  return result;
}

//----- (0808DE60) --------------------------------------------------------
int __cdecl sub_808DE60(int a1, std::string *a2)
{
  int v2; // ebx@1
  int v3; // ebx@1
  int v4; // eax@2
  int result; // eax@4
  bool v6; // zf@7
  int v7; // [sp+1Ch] [bp-Ch]@1

  v2 = *(_DWORD *)a1;
  sub_8067DC0((int)&v7, a2);
  v3 = **(_DWORD **)v2;
  if ( &v7 == (int *)(v3 + 16) )
  {
    result = v7;
    v6 = v7 == 0;
    if ( v7 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v7 + 4));
      if ( v6 )
        result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
    }
  }
  else
  {
    v4 = *(_DWORD *)(v3 + 16);
    if ( v4 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v4 + 4));
      if ( !v4 )
        (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
    }
    result = v7;
    *(_DWORD *)(v3 + 16) = v7;
  }
  return result;
}

//----- (0808DF40) --------------------------------------------------------
int __cdecl sub_808DF40(int a1, void *a2)
{
  int v2; // esi@1
  int v3; // edi@1
  int v4; // edi@1
  int v5; // eax@1
  int *v6; // ebp@1
  int v7; // esi@1
  char v9; // [sp+10h] [bp-3Ch]@1

  v2 = *(_DWORD *)a1;
  v3 = ***(_DWORD ***)a1;
  sub_8069320(a2, 3, (int)"id_creator", 10);
  sub_8069320(a2, 2, *(_DWORD *)(v3 + 12), *(_DWORD *)(*(_DWORD *)(v3 + 12) - 12));
  v4 = **(_DWORD **)v2;
  sub_8069320(a2, 3, (int)"id_task", 7);
  v5 = snprintf(&v9, 0x1Fu, "%u", *(_DWORD *)(v4 + 8));
  sub_8069320(a2, 1, (int)&v9, v5);
  v6 = *(int **)(v2 + 4);
  sub_8069320(a2, 3, (int)"info", 4);
  v7 = *v6;
  *v6 = (int)&unk_80CF83C;
  sub_8069320(a2, 2, v7, *(_DWORD *)(v7 - 12));
  return std::string::_Rep::_M_dispose(v7 - 12, &v9);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);

//----- (0808E190) --------------------------------------------------------
int __cdecl sub_808E190(int a1, void *a2)
{
  int v2; // ebp@1
  int v3; // eax@1
  int v4; // edi@1
  int v5; // esi@2
  int v6; // eax@3
  int v7; // eax@3
  int v8; // eax@3
  char v10; // [sp+10h] [bp-3Ch]@3

  v2 = *(_DWORD *)(*(_DWORD *)a1 + 4);
  v3 = **(_DWORD **)a1;
  v4 = *(_DWORD *)v3;
  if ( *(_BYTE *)(*(_DWORD *)v3 + 88) )
    v5 = *(_DWORD *)(v4 + 84);
  else
    v5 = *(_DWORD *)(v4 + 8);
  sub_8069320(a2, 3, (int)"info_type", 9);
  sub_8069320(a2, 2, 134978887, 9);
  sub_8069320(a2, 3, (int)"id_creator", 10);
  sub_8069320(a2, 2, *(_DWORD *)(v4 + 12), *(_DWORD *)(*(_DWORD *)(v4 + 12) - 12));
  sub_8069320(a2, 3, (int)"id_task", 7);
  v6 = snprintf(&v10, 0x1Fu, "%d", v5);
  sub_8069320(a2, 1, (int)&v10, v6);
  sub_8069320(a2, 3, (int)"id_task_nm", 10);
  v7 = snprintf(&v10, 0x1Fu, "%u", *(_DWORD *)(v4 + 8));
  sub_8069320(a2, 1, (int)&v10, v7);
  sub_8069320(a2, 3, (int)"id_item", 7);
  v8 = snprintf(&v10, 0x1Fu, "%d", *(_DWORD *)v2);
  return sub_8069320(a2, 1, (int)&v10, v8);
}

//----- (0808E360) --------------------------------------------------------
int __cdecl sub_808E360(int a1, void *a2)
{
  int v2; // ebp@1
  int v3; // eax@1
  int v4; // edi@1
  int v5; // esi@2
  int v6; // eax@3
  int v7; // eax@3
  int v8; // eax@3
  char v10; // [sp+10h] [bp-3Ch]@3

  v2 = *(_DWORD *)(*(_DWORD *)a1 + 4);
  v3 = **(_DWORD **)a1;
  v4 = *(_DWORD *)v3;
  if ( *(_BYTE *)(*(_DWORD *)v3 + 88) )
    v5 = *(_DWORD *)(v4 + 84);
  else
    v5 = *(_DWORD *)(v4 + 8);
  sub_8069320(a2, 3, (int)"info_type", 9);
  sub_8069320(a2, 2, 134978887, 9);
  sub_8069320(a2, 3, (int)"id_creator", 10);
  sub_8069320(a2, 2, *(_DWORD *)(v4 + 12), *(_DWORD *)(*(_DWORD *)(v4 + 12) - 12));
  sub_8069320(a2, 3, (int)"id_task", 7);
  v6 = snprintf(&v10, 0x1Fu, "%d", v5);
  sub_8069320(a2, 1, (int)&v10, v6);
  sub_8069320(a2, 3, (int)"id_task_nm", 10);
  v7 = snprintf(&v10, 0x1Fu, "%u", *(_DWORD *)(v4 + 8));
  sub_8069320(a2, 1, (int)&v10, v7);
  sub_8069320(a2, 3, (int)"id_item", 7);
  v8 = snprintf(&v10, 0x1Fu, "%d", *(_DWORD *)v2);
  return sub_8069320(a2, 1, (int)&v10, v8);
}

//----- (0808E530) --------------------------------------------------------
__int16 __cdecl sub_808E530(int a1, void *a2)
{
  int v2; // esi@1
  int v3; // esi@1
  __int16 v4; // fps@1
  long double v5; // fst6@1
  bool v6; // c0@1
  char v7; // c2@1
  bool v8; // c3@1
  __int16 result; // ax@1
  int v10; // ST18_4@2
  int v11; // eax@2
  int v12; // ebp@2
  int v13; // ebp@3
  int v14; // esi@3
  int v15; // eax@4
  int v16; // ST14_4@6
  int v17; // eax@6
  char v18; // [sp+20h] [bp-3Ch]@2

  v2 = *(_DWORD *)a1;
  sub_8069320(a2, 3, (int)"version", 7);
  sub_8069320(a2, 2, (int)"WRT-1.3.0.38254", 15);
  v3 = *(_DWORD *)v2;
  v5 = *(double *)(v3 + 8);
  v6 = v5 < 0.0;
  v7 = 0;
  v8 = v5 == 0.0;
  result = __PAIR__(HIBYTE(v4), (unsigned __int8)v4) & 0x45FF;
  if ( (HIBYTE(v4) & 0x45) != 64 )
  {
    sub_8069320(a2, 3, (int)"traf", 4);
    sub_8098450(a2, 4);
    v10 = (signed int)(*(double *)(v3 + 8) + 0.5);
    sub_8069320(a2, 3, (int)"duration", 8);
    v11 = snprintf(&v18, 0x1Fu, "%d", v10);
    sub_8069320(a2, 1, (int)&v18, v11);
    v12 = *(_DWORD *)(v3 + 28);
    if ( *(_QWORD *)(v3 + 24) )
    {
      v16 = *(_DWORD *)(v3 + 24);
      sub_8069320(a2, 3, (int)"bytes_in", 8);
      v17 = snprintf(&v18, 0x1Fu, "%llu", v16, v12);
      sub_8069320(a2, 1, (int)&v18, v17);
    }
    v13 = *(_DWORD *)(v3 + 40);
    v14 = *(_DWORD *)(v3 + 44);
    if ( v13 | v14 )
    {
      sub_8069320(a2, 3, (int)"bytes_out", 9);
      v15 = snprintf(&v18, 0x1Fu, "%llu", v13, v14);
      sub_8069320(a2, 1, (int)&v18, v15);
    }
    result = sub_8098450(a2, 5);
  }
  return result;
}

//----- (0808E750) --------------------------------------------------------
int __cdecl sub_808E750(int a1, void *a2)
{
  int v2; // ebx@1
  int v3; // esi@1
  int v4; // eax@1
  int v5; // esi@1
  int v6; // eax@1
  int v7; // ebx@1
  int i; // esi@1
  int v9; // eax@2
  int v10; // esi@4
  int v11; // eax@5
  int v12; // edx@5
  int v13; // edx@5
  int v14; // edx@7
  int v15; // edx@7
  int v16; // ebx@7
  int v17; // edi@7
  unsigned int v18; // eax@7
  __int128 v19; // ST00_16@7
  unsigned int v20; // eax@7
  int v21; // eax@8
  int v22; // ebx@11
  signed int v23; // eax@12
  int v24; // eax@13
  void *v25; // edi@15
  int v26; // eax@17
  int v27; // eax@21
  int v28; // eax@26
  int *j; // ebx@29
  int v30; // edi@32
  int *k; // ebx@32
  int v32; // eax@36
  int v33; // esi@37
  int v34; // eax@38
  int v35; // edx@38
  int v36; // edx@38
  int v37; // edx@40
  int v38; // edx@40
  int v39; // ebx@40
  int v40; // edi@40
  unsigned int v41; // eax@40
  __int128 v42; // ST00_16@40
  unsigned int v43; // eax@40
  int v44; // eax@41
  int v45; // ebx@44
  signed int v46; // eax@45
  int v47; // eax@46
  void *v48; // edi@48
  int v49; // eax@50
  int v50; // eax@54
  int v51; // eax@59
  int *l; // ebx@62
  int v53; // edi@66
  int *m; // ebx@66
  int v56; // eax@77
  int v57; // eax@78
  char *v58; // [sp+18h] [bp-B4h]@8
  int v59; // [sp+18h] [bp-B4h]@29
  char *v60; // [sp+18h] [bp-B4h]@41
  int v61; // [sp+18h] [bp-B4h]@62
  char *v62; // [sp+1Ch] [bp-B0h]@10
  char *v63; // [sp+1Ch] [bp-B0h]@43
  char *v64; // [sp+20h] [bp-ACh]@15
  char *v65; // [sp+20h] [bp-ACh]@48
  int v66; // [sp+24h] [bp-A8h]@3
  int v67; // [sp+24h] [bp-A8h]@36
  int v68; // [sp+28h] [bp-A4h]@3
  int v69; // [sp+28h] [bp-A4h]@36
  int v70; // [sp+2Ch] [bp-A0h]@4
  int v71; // [sp+2Ch] [bp-A0h]@37
  int v72; // [sp+30h] [bp-9Ch]@4
  int v73; // [sp+30h] [bp-9Ch]@37
  int v74; // [sp+34h] [bp-98h]@4
  int v75; // [sp+34h] [bp-98h]@37
  int v76; // [sp+38h] [bp-94h]@4
  int v77; // [sp+38h] [bp-94h]@37
  int v78; // [sp+3Ch] [bp-90h]@1
  int v79; // [sp+4Ch] [bp-80h]@7
  char v80; // [sp+50h] [bp-7Ch]@31
  char v81[4]; // [sp+70h] [bp-5Ch]@1
  int v82; // [sp+74h] [bp-58h]@5
  int v83; // [sp+78h] [bp-54h]@5
  int v84; // [sp+7Ch] [bp-50h]@5
  int v85; // [sp+80h] [bp-4Ch]@5
  int v86; // [sp+84h] [bp-48h]@5
  int *v87; // [sp+88h] [bp-44h]@5
  int v88; // [sp+8Ch] [bp-40h]@5
  int v89; // [sp+90h] [bp-3Ch]@5
  char v90; // [sp+94h] [bp-38h]@5
  int v91; // [sp+98h] [bp-34h]@5
  int *v92; // [sp+9Ch] [bp-30h]@7
  int v93; // [sp+A0h] [bp-2Ch]@7
  int v94; // [sp+A4h] [bp-28h]@7
  int v95; // [sp+A8h] [bp-24h]@7
  int v96; // [sp+ACh] [bp-20h]@7

  v2 = *(_DWORD *)a1;
  sub_8098E10(a2, "id_creator", (int *)(*(_DWORD *)(***(_DWORD ***)a1 + 12) + 12));
  v3 = *(_DWORD *)(**(_DWORD **)v2 + 12);
  sub_8069320(a2, 3, (int)"id_task", 7);
  v4 = snprintf(v81, 0x1Fu, "%u", *(_DWORD *)(v3 + 8));
  sub_8069320(a2, 1, (int)v81, v4);
  sub_8098E70(a2, "id_item", **(_DWORD **)v2 + 8);
  *(_DWORD *)v81 = *(_BYTE *)(*(_DWORD *)v2 + 4);
  sub_8098E70(a2, "merge", (int)v81);
  v5 = *(_DWORD *)v2;
  v78 = *(_DWORD *)v2;
  sub_8069320(a2, 3, (int)"info", 4);
  sub_8098450(a2, 4);
  sub_8098E70(a2, "pass", v5 + 8);
  sub_8098E70(a2, "fail", v5 + 12);
  sub_8069320(a2, 3, (int)"rules", 5);
  sub_8098450(a2, 6);
  v6 = *(_DWORD *)(*(_DWORD *)v5 + 16);
  v7 = *(_DWORD *)(v6 + 4);
  for ( i = *(_DWORD *)v6; v7 != i; i += 36 )
  {
    v9 = snprintf(v81, 0x1Fu, "%d", *(_DWORD *)i);
    sub_8069320(a2, 1, (int)v81, v9);
  }
  sub_8098450(a2, 7);
  sub_8069320(a2, 3, (int)"report", 6);
  sub_8098450(a2, 6);
  v66 = *(_DWORD *)(v78 + 28);
  v68 = *(_DWORD *)(v78 + 32);
  if ( v66 != v68 )
  {
    v10 = *(_DWORD *)(v78 + 28);
    v70 = v66 + 8;
    v72 = v66 + 20;
    v74 = v66 + 56;
    v76 = v66 + 60;
    do
    {
      *(_DWORD *)v81 = *(_DWORD *)v10;
      v82 = *(_DWORD *)(v10 + 4);
      v11 = v10 - v66;
      v83 = *(_DWORD *)(v10 - v66 + v70);
      *(_DWORD *)(v11 + v70) = &unk_80CF83C;
      v84 = *(_DWORD *)(v10 + 12);
      v85 = *(_DWORD *)(v10 + 16);
      v86 = *(_DWORD *)(v10 - v66 + v72);
      *(_DWORD *)(v11 + v72) = &unk_80CF83C;
      v87 = 0;
      v88 = 0;
      v89 = 0;
      v87 = *(int **)(v10 + 24);
      *(_DWORD *)(v10 + 24) = 0;
      v12 = v88;
      v88 = *(_DWORD *)(v10 + 28);
      *(_DWORD *)(v10 + 28) = v12;
      v13 = v89;
      v89 = *(_DWORD *)(v10 + 32);
      *(_DWORD *)(v10 + 32) = v13;
      v90 = 0;
      v91 = 0;
      if ( *(_BYTE *)(v10 + 36) )
      {
        v91 = *(_DWORD *)(v10 + 40);
        v90 = 1;
      }
      v92 = 0;
      v93 = 0;
      v94 = 0;
      v92 = *(int **)(v10 + 44);
      *(_DWORD *)(v10 + 44) = 0;
      v14 = v93;
      v93 = *(_DWORD *)(v10 + 48);
      *(_DWORD *)(v10 + 48) = v14;
      v15 = v94;
      v94 = *(_DWORD *)(v10 + 52);
      *(_DWORD *)(v10 + 52) = v15;
      v95 = *(_DWORD *)(v11 + v74);
      *(_DWORD *)(v11 + v74) = 0;
      v96 = *(_DWORD *)(v11 + v76);
      *(_DWORD *)(v11 + v76) = 0;
      sub_8098450(a2, 4);
      v16 = v86;
      v17 = *(_DWORD *)(v86 - 12);
      v79 = (int)&unk_80CF83C;
      v18 = sub_80A6440(v17);
      std::string::resize((std::string *)&v79, v18, 0);
      DWORD3(v19) = *(_DWORD *)(v79 - 12);
      DWORD2(v19) = v79;
      *(_QWORD *)&v19 = __PAIR__(v17, v16);
      v20 = sub_80A6460(v19);
      std::string::resize((std::string *)&v79, v20, 0);
      if ( (unsigned int)(*(_DWORD *)v81 - 2) > 5 )
      {
        v58 = "CONTENT_RECEIVED";
        v21 = v84;
        if ( v84 != 1 )
        {
LABEL_9:
          if ( v21 == 2 )
            v62 = "POST";
          else
            v62 = ") " + 2;
          goto LABEL_11;
        }
      }
      else
      {
        v58 = (char *)*(&off_80BBC2C + *(_DWORD *)v81 - 2);
        v21 = v84;
        if ( v84 != 1 )
          goto LABEL_9;
      }
      v62 = "GET";
LABEL_11:
      v22 = v96;
      if ( !v95 || (v23 = *(_DWORD *)(v95 + 8), !*(_DWORD *)(v23 - 12)) )
      {
        v24 = *(_DWORD *)(v96 + 16);
        if ( v24 )
          v23 = *(_DWORD *)(v24 + 8);
        else
          v23 = 134986579;
      }
      v64 = (char *)v23;
      v25 = sub_8098E70(a2, "confId", v96 + 8);
      if ( *(_DWORD *)(v22 + 12) )
        sub_8098E70(v25, "id0", v22 + 12);
      sub_8069320(v25, 3, 134976870, 3);
      v26 = strlen(v64);
      sub_8069320(v25, 2, (int)v64, v26);
      if ( v82 )
      {
        sub_8069320(v25, 3, (int)"ts", 2);
        v56 = snprintf(&v80, 0x1Fu, "%ld", v82);
        sub_8069320(v25, 1, (int)&v80, v56);
      }
      if ( *(_DWORD *)(v83 - 12) )
        sub_8098E10(v25, &byte_80BB8CF, &v83);
      if ( *v62 )
      {
        sub_8069320(v25, 3, (int)"method", 6);
        v27 = strlen(v62);
        sub_8069320(v25, 2, (int)v62, v27);
      }
      if ( v85 )
        sub_8098E70(v25, "statusCode", (int)&v85);
      if ( v58 && *v58 )
      {
        sub_8069320(v25, 3, (int)"result", 6);
        v28 = strlen(v58);
        sub_8069320(v25, 2, (int)v58, v28);
      }
      if ( *(_DWORD *)(v79 - 12) )
        sub_8098E10(v25, "content", &v79);
      sub_8069320(v25, 3, (int)"headers", 7);
      sub_8098450(v25, 6);
      v59 = v88;
      for ( j = v87; (int *)v59 != j; ++j )
        sub_8069320(v25, 2, *j, *(_DWORD *)(*j - 12));
      sub_8098450(v25, 7);
      std::string::_Rep::_M_dispose(v79 - 12, &v80);
      if ( (int *)v93 != v92 )
      {
        sub_8069320(a2, 3, (int)"reds", 4);
        sub_8098450(a2, 6);
        v30 = v93;
        for ( k = v92; (int *)v30 != k; ++k )
          sub_8069320(a2, 2, *k, *(_DWORD *)(*k - 12));
        sub_8098450(a2, 7);
      }
      sub_8098450(a2, 5);
      sub_8056F10(v96);
      sub_8057050((int)v81);
      v10 += 64;
    }
    while ( v68 != v10 );
  }
  sub_8098450(a2, 7);
  sub_8069320(a2, 3, (int)"passed", 6);
  sub_8098450(a2, 6);
  v32 = *(_DWORD *)(v78 + 16);
  v67 = v32;
  v69 = *(_DWORD *)(v78 + 20);
  if ( v32 != v69 )
  {
    v33 = *(_DWORD *)(v78 + 16);
    v73 = v32 + 8;
    v75 = v32 + 20;
    v77 = v32 + 56;
    v71 = v32 + 60;
    do
    {
      *(_DWORD *)v81 = *(_DWORD *)v33;
      v82 = *(_DWORD *)(v33 + 4);
      v34 = v33 - v67;
      v83 = *(_DWORD *)(v33 - v67 + v73);
      *(_DWORD *)(v34 + v73) = &unk_80CF83C;
      v84 = *(_DWORD *)(v33 + 12);
      v85 = *(_DWORD *)(v33 + 16);
      v86 = *(_DWORD *)(v33 - v67 + v75);
      *(_DWORD *)(v34 + v75) = &unk_80CF83C;
      v87 = 0;
      v88 = 0;
      v89 = 0;
      v87 = *(int **)(v33 + 24);
      *(_DWORD *)(v33 + 24) = 0;
      v35 = v88;
      v88 = *(_DWORD *)(v33 + 28);
      *(_DWORD *)(v33 + 28) = v35;
      v36 = v89;
      v89 = *(_DWORD *)(v33 + 32);
      *(_DWORD *)(v33 + 32) = v36;
      v90 = 0;
      v91 = 0;
      if ( *(_BYTE *)(v33 + 36) )
      {
        v91 = *(_DWORD *)(v33 + 40);
        v90 = 1;
      }
      v92 = 0;
      v93 = 0;
      v94 = 0;
      v92 = *(int **)(v33 + 44);
      *(_DWORD *)(v33 + 44) = 0;
      v37 = v93;
      v93 = *(_DWORD *)(v33 + 48);
      *(_DWORD *)(v33 + 48) = v37;
      v38 = v94;
      v94 = *(_DWORD *)(v33 + 52);
      *(_DWORD *)(v33 + 52) = v38;
      v95 = *(_DWORD *)(v34 + v77);
      *(_DWORD *)(v34 + v77) = 0;
      v96 = *(_DWORD *)(v34 + v71);
      *(_DWORD *)(v34 + v71) = 0;
      sub_8098450(a2, 4);
      v39 = v86;
      v40 = *(_DWORD *)(v86 - 12);
      v79 = (int)&unk_80CF83C;
      v41 = sub_80A6440(v40);
      std::string::resize((std::string *)&v79, v41, 0);
      DWORD3(v42) = *(_DWORD *)(v79 - 12);
      DWORD2(v42) = v79;
      *(_QWORD *)&v42 = __PAIR__(v40, v39);
      v43 = sub_80A6460(v42);
      std::string::resize((std::string *)&v79, v43, 0);
      if ( (unsigned int)(*(_DWORD *)v81 - 2) > 5 )
      {
        v60 = "CONTENT_RECEIVED";
        v44 = v84;
        if ( v84 != 1 )
        {
LABEL_42:
          if ( v44 == 2 )
            v63 = "POST";
          else
            v63 = ") " + 2;
          goto LABEL_44;
        }
      }
      else
      {
        v60 = (char *)*(&off_80BBC2C + *(_DWORD *)v81 - 2);
        v44 = v84;
        if ( v84 != 1 )
          goto LABEL_42;
      }
      v63 = "GET";
LABEL_44:
      v45 = v96;
      if ( !v95 || (v46 = *(_DWORD *)(v95 + 8), !*(_DWORD *)(v46 - 12)) )
      {
        v47 = *(_DWORD *)(v96 + 16);
        if ( v47 )
          v46 = *(_DWORD *)(v47 + 8);
        else
          v46 = 134986579;
      }
      v65 = (char *)v46;
      v48 = sub_8098E70(a2, "confId", v96 + 8);
      if ( *(_DWORD *)(v45 + 12) )
        sub_8098E70(v48, "id0", v45 + 12);
      sub_8069320(v48, 3, 134976870, 3);
      v49 = strlen(v65);
      sub_8069320(v48, 2, (int)v65, v49);
      if ( v82 )
      {
        sub_8069320(v48, 3, (int)"ts", 2);
        v57 = snprintf(&v80, 0x1Fu, "%ld", v82);
        sub_8069320(v48, 1, (int)&v80, v57);
      }
      if ( *(_DWORD *)(v83 - 12) )
        sub_8098E10(v48, &byte_80BB8CF, &v83);
      if ( *v63 )
      {
        sub_8069320(v48, 3, (int)"method", 6);
        v50 = strlen(v63);
        sub_8069320(v48, 2, (int)v63, v50);
      }
      if ( v85 )
        sub_8098E70(v48, "statusCode", (int)&v85);
      if ( v60 && *v60 )
      {
        sub_8069320(v48, 3, (int)"result", 6);
        v51 = strlen(v60);
        sub_8069320(v48, 2, (int)v60, v51);
      }
      if ( *(_DWORD *)(v79 - 12) )
        sub_8098E10(v48, "content", &v79);
      sub_8069320(v48, 3, (int)"headers", 7);
      sub_8098450(v48, 6);
      v61 = v88;
      for ( l = v87; (int *)v61 != l; ++l )
        sub_8069320(v48, 2, *l, *(_DWORD *)(*l - 12));
      sub_8098450(v48, 7);
      std::string::_Rep::_M_dispose(v79 - 12, &v80);
      if ( v90 )
        sub_8098E70(a2, "rule", (int)&v91);
      if ( (int *)v93 != v92 )
      {
        sub_8069320(a2, 3, (int)"reds", 4);
        sub_8098450(a2, 6);
        v53 = v93;
        for ( m = v92; (int *)v53 != m; ++m )
          sub_8069320(a2, 2, *m, *(_DWORD *)(*m - 12));
        sub_8098450(a2, 7);
      }
      sub_8098450(a2, 5);
      sub_8056F10(v96);
      sub_8057050((int)v81);
      v33 += 64;
    }
    while ( v69 != v33 );
  }
  sub_8098450(a2, 7);
  return sub_8098450(a2, 5);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 80BB8CF: using guessed type char byte_80BB8CF;

//----- (0808F6A0) --------------------------------------------------------
int __cdecl sub_808F6A0(int a1, void *a2)
{
  int v2; // ebp@1
  int v3; // eax@1
  int v4; // eax@2
  int v5; // esi@3
  int v6; // eax@3
  void *v7; // ST14_4@6
  int v8; // eax@6
  int v10; // eax@12
  int v11; // eax@13
  int v12; // [sp+10h] [bp-5Ch]@1
  int *v13; // [sp+14h] [bp-58h]@1
  int v14; // [sp+18h] [bp-54h]@1
  int v15; // [sp+1Ch] [bp-50h]@3
  int v16; // [sp+2Ch] [bp-40h]@3
  int v17[15]; // [sp+30h] [bp-3Ch]@3

  v2 = **(_DWORD **)a1;
  v14 = *(_DWORD *)(*(_DWORD *)a1 + 4);
  v13 = *(int **)(*(_DWORD *)a1 + 8);
  v12 = *(_DWORD *)(*(_DWORD *)a1 + 12);
  sub_8069320(a2, 3, (int)"tasks", 5);
  sub_8098450(a2, 6);
  sub_8098450(a2, 4);
  v3 = *(_DWORD *)(*(_DWORD *)v2 + 72);
  if ( v3 <= 0 )
    v4 = 0;
  else
    v4 = v3 - 1;
  v16 = v4;
  v5 = *(_DWORD *)v2;
  v15 = *(_DWORD *)v2 + 76;
  sub_8069320(a2, 3, (int)"id_task", 7);
  v6 = snprintf((char *)v17, 0x1Fu, "%u", *(_DWORD *)(v5 + 8));
  sub_8069320(a2, 1, (int)v17, v6);
  sub_8069320(a2, 3, (int)"id_creator", 10);
  sub_8069320(a2, 2, *(_DWORD *)(v5 + 12), *(_DWORD *)(*(_DWORD *)(v5 + 12) - 12));
  sub_8069320(a2, 3, (int)"id_lens", 7);
  sub_8069320(a2, 2, *(_DWORD *)(v14 + 4), *(_DWORD *)(*(_DWORD *)(v14 + 4) - 12));
  if ( *(_DWORD *)(*v13 - 12) )
    sub_8098E10(a2, "status", v13);
  if ( *(_DWORD *)(v5 + 56) )
  {
    sub_8069320(a2, 3, (int)"ts_start", 8);
    v11 = snprintf((char *)v17, 0x1Fu, "%ld", *(_DWORD *)(v5 + 56));
    sub_8069320(a2, 1, (int)v17, v11);
  }
  if ( *(_DWORD *)(v5 + 60) )
  {
    sub_8069320(a2, 3, (int)"ts_stop", 7);
    v10 = snprintf((char *)v17, 0x1Fu, "%ld", *(_DWORD *)(v5 + 60));
    sub_8069320(a2, 1, (int)v17, v10);
  }
  v7 = sub_8098E70(a2, "pass", v15);
  sub_8069320(v7, 3, (int)"fail", 4);
  v8 = snprintf((char *)v17, 0x1Fu, "%d", *(_DWORD *)(v5 + 80));
  sub_8069320(v7, 1, (int)v17, v8);
  sub_8098E70(v7, "completion", (int)&v16);
  if ( *(_DWORD *)(v12 + 8) || !*(_DWORD *)(*(_DWORD *)(*(_DWORD *)v2 + 28) - 12) )
  {
    sub_8069320(a2, 3, (int)"result", 6);
    sub_8098450(a2, 4);
    if ( !*(_DWORD *)(*(_DWORD *)(*(_DWORD *)v2 + 28) - 12) )
    {
      sub_8069320(a2, 3, (int)"params", 6);
      sub_8098450(a2, 4);
      v17[0] = dword_80CF860;
      sub_8098E70(a2, "DnsThreadsMax", (int)v17);
      v17[0] = dword_80CF85C;
      sub_8098E70(a2, "maxTotalConnections", (int)v17);
      v17[0] = dword_80CF858;
      sub_8098E70(a2, "maxHttpsConnections", (int)v17);
      v17[0] = 1000 * dword_80CF854;
      sub_8098E70(a2, "connectTimeout", (int)v17);
      v17[0] = dword_80CF850;
      sub_8098E70(a2, "maxContentSize", (int)v17);
      v17[0] = dword_80CF84C;
      sub_8098E70(a2, "maxReportSize", (int)v17);
      sub_8098450(a2, 5);
    }
    if ( *(_DWORD *)(v12 + 8) )
      sub_8098EF0(v12, (int)a2);
    sub_8098450(a2, 5);
  }
  sub_8098450(a2, 5);
  return sub_8098450(a2, 7);
}
// 80CF84C: using guessed type int dword_80CF84C;
// 80CF850: using guessed type int dword_80CF850;
// 80CF854: using guessed type int dword_80CF854;
// 80CF858: using guessed type int dword_80CF858;
// 80CF85C: using guessed type int dword_80CF85C;
// 80CF860: using guessed type int dword_80CF860;

//----- (0808FB70) --------------------------------------------------------
int __cdecl sub_808FB70(int a1, std::string *a2)
{
  int v2; // ebx@1
  std::string *v3; // eax@1
  int result; // eax@4

  v2 = ***(_DWORD ***)a1;
  v3 = *(std::string **)(v2 + 24);
  if ( v3 == *(std::string **)(v2 + 28) )
  {
    result = sub_8099450(v2 + 20, a2);
  }
  else
  {
    if ( v3 )
    {
      std::string::string(v3, a2);
      v3 = *(std::string **)(v2 + 24);
    }
    result = (int)((char *)v3 + 4);
    *(_DWORD *)(v2 + 24) = result;
  }
  return result;
}

//----- (0808FBD0) --------------------------------------------------------
int __cdecl sub_808FBD0(int a1)
{
  _BYTE **v1; // ebx@1
  int v2; // eax@1
  _BYTE *v3; // edi@1
  int v4; // esi@2
  _BYTE *v5; // edx@2
  int v6; // eax@2
  int v7; // ecx@2
  int v8; // eax@4
  int v9; // edx@6
  int v10; // eax@7
  int v11; // edx@7
  int v12; // edi@10
  int *v13; // ebx@11
  int result; // eax@12
  bool v15; // zf@16
  int v16; // ST10_4@19
  int v17; // esi@19
  int v18; // eax@20
  int v19; // [sp+18h] [bp-D0h]@19
  int v20; // [sp+1Ch] [bp-CCh]@10

  v1 = *(_BYTE ***)a1;
  ***(_BYTE ***)a1 = 1;
  v2 = std::string::compare((std::string *)(*(_DWORD *)v1[1] + 24), "RUNNING");
  v3 = v1[1];
  if ( v2
    || (v4 = *(_DWORD *)(*(_DWORD *)v3 + 8),
        v5 = v1[2],
        v6 = *(_DWORD *)v5,
        v7 = *((_DWORD *)v5 + 1),
        *(_DWORD *)v5 == v7) )
  {
LABEL_7:
    v10 = (int)v1[3];
    v11 = *(_DWORD *)(v10 + 4);
    if ( v11 != *(_DWORD *)(v10 + 8) )
    {
      if ( v11 )
      {
        *(_DWORD *)v11 = *(_DWORD *)v3;
        *(_DWORD *)v3 = 0;
        v11 = *(_DWORD *)(v10 + 4);
      }
      *(_DWORD *)(v10 + 4) = v11 + 4;
      v12 = (int)&v20;
      goto LABEL_11;
    }
    sub_8099610(v10, (int)v1[1]);
LABEL_15:
    sub_8098D10((int)&v20);
    v13 = (int *)v1[1];
    if ( v13 != &v20 )
      goto LABEL_12;
    goto LABEL_16;
  }
  if ( v4 != *(_DWORD *)(*(_DWORD *)v6 + 8) )
  {
    v8 = v6 + 4;
    do
    {
      v9 = v8;
      if ( v7 == v8 )
        goto LABEL_7;
      v8 += 4;
    }
    while ( v4 != *(_DWORD *)(*(_DWORD *)v9 + 8) );
  }
  if ( log_level > 1 )
    goto LABEL_15;
  v12 = (int)&v20;
  std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v20, 16);
  v16 = std::__ostream_insert<char,std::char_traits<char>>(&v20, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v16, 134978863, 5);
  v17 = std::ostream::_M_insert<unsigned long>(v16, v4);
  std::__ostream_insert<char,std::char_traits<char>>(v17, ": already running", 17);
  std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v19, v17 + 4);
  std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v20);
  std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v20);
  if ( byte_80CE64C )
  {
    v18 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v19, *(_DWORD *)(v19 - 12));
    std::endl<char,std::char_traits<char>>(v18);
  }
  syslog(7, "%s", v19);
  std::string::_Rep::_M_dispose(v19 - 12, &v20);
LABEL_11:
  sub_8098D10(v12);
  v13 = (int *)v1[1];
  if ( v13 != (int *)v12 )
  {
LABEL_12:
    sub_8056F10(*v13);
    result = v20;
    *v13 = v20;
    return result;
  }
LABEL_16:
  result = v20;
  v15 = v20 == 0;
  if ( v20 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v20 + 4));
    if ( v15 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0808FE50) --------------------------------------------------------
int __cdecl sub_808FE50(int a1, std::string *a2)
{
  int v2; // esi@1
  int v3; // ecx@1
  int v4; // eax@1
  int v5; // edx@2
  int result; // eax@4
  int v7; // [sp+1Ch] [bp-Ch]@1

  v2 = *(_DWORD *)a1;
  sub_8067DC0((int)&v7, a2);
  v3 = *(_DWORD *)(**(_DWORD **)v2 + 20);
  v4 = *(_DWORD *)(v3 + 28);
  if ( v4 == *(_DWORD *)(v3 + 32) )
  {
    result = sub_8099730(v3 + 24, (int)&v7);
    v5 = v7;
  }
  else
  {
    v5 = v7;
    if ( v4 )
    {
      *(_DWORD *)v4 = v7;
      v7 = 0;
      v4 = *(_DWORD *)(v3 + 28);
      v5 = 0;
    }
    result = v4 + 4;
    *(_DWORD *)(v3 + 28) = result;
  }
  if ( v5 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
    if ( !v5 )
      result = (*(int (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  return result;
}

//----- (0808FEF0) --------------------------------------------------------
int __cdecl sub_808FEF0(int a1)
{
  int v1; // ebx@1
  int v2; // esi@2
  int v3; // ecx@3
  int v4; // edx@3
  int v5; // eax@3
  int v6; // ebx@7
  int v7; // eax@8
  bool v8; // zf@8
  int result; // eax@10
  int v10; // ST0C_4@13
  int v11; // edi@13
  int v12; // eax@13
  char *v13; // ST0C_4@15
  size_t v14; // eax@15
  char *v15; // edx@15
  int v16; // edx@17
  int v17; // eax@19
  bool v18; // zf@21
  signed __int32 v19; // eax@28
  signed __int32 v20; // ecx@31
  char v21; // [sp+17h] [bp-D1h]@30
  int v22; // [sp+18h] [bp-D0h]@17
  int v23; // [sp+1Ch] [bp-CCh]@2
  int v24; // [sp+20h] [bp-C8h]@17
  char v25; // [sp+3Ch] [bp-ACh]@18
  int v26; // [sp+44h] [bp-A4h]@17
  int v27; // [sp+48h] [bp-A0h]@17

  v1 = *(_DWORD *)a1;
  if ( log_level > 1 )
  {
    v2 = (int)&v23;
    goto LABEL_3;
  }
  v10 = **(_DWORD **)v1;
  v2 = (int)&v23;
  std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v23, 16);
  v11 = std::__ostream_insert<char,std::char_traits<char>>(&v23, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v11, "checklist item: ", 16);
  v12 = *(_DWORD *)(v10 + 16);
  if ( !v12 )
  {
    v14 = 0;
    v15 = "";
    goto LABEL_16;
  }
  if ( *(_DWORD *)(v12 + 8) )
  {
    v13 = *(char **)(v12 + 8);
    v14 = strlen(*(const char **)(v12 + 8));
    v15 = v13;
LABEL_16:
    std::__ostream_insert<char,std::char_traits<char>>(v11, v15, v14);
    goto LABEL_17;
  }
  std::basic_ios<char,std::char_traits<char>>::clear(
    v11 + *(_DWORD *)(*(_DWORD *)v11 - 12),
    *(_DWORD *)(v11 + *(_DWORD *)(*(_DWORD *)v11 - 12) + 20) | 1);
LABEL_17:
  std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v22, v11 + 4);
  v23 = (int)&unk_80CF5DC;
  v27 = (int)&unk_80CF5F0;
  v24 = (int)&unk_80CF588;
  v16 = v26 - 12;
  if ( (_DWORD *)(v26 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v19 = _InterlockedExchangeAdd((volatile signed __int32 *)(v26 - 4), 0xFFFFFFFF);
    }
    else
    {
      v20 = *(_DWORD *)(v26 - 4);
      *(_DWORD *)(v26 - 4) = v20 - 1;
      v19 = v20;
    }
    if ( v19 <= 0 )
      std::string::_Rep::_M_destroy(v16, &v21);
  }
  v24 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v25);
  v23 = dword_80CF674;
  *(int *)((char *)&v23 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  v27 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v27);
  std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v23);
  if ( byte_80CE64C )
  {
    v17 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v22, *(_DWORD *)(v22 - 12));
    std::endl<char,std::char_traits<char>>(v17);
  }
  syslog(7, "%s", v22);
  std::string::_Rep::_M_dispose(v22 - 12, &v23);
LABEL_3:
  v3 = *(_DWORD *)v1;
  v4 = **(_DWORD **)(v1 + 4);
  v5 = *(_DWORD *)(v4 + 12);
  if ( v5 == *(_DWORD *)(v4 + 16) )
  {
    sub_80688B0(v4 + 8, *(_DWORD *)v1);
  }
  else
  {
    if ( v5 )
    {
      *(_DWORD *)v5 = *(_DWORD *)v3;
      *(_DWORD *)v3 = 0;
      v5 = *(_DWORD *)(v4 + 12);
    }
    *(_DWORD *)(v4 + 12) = v5 + 4;
  }
  sub_8098F20(v2, **(_DWORD **)(v1 + 4) + 20);
  v6 = *(_DWORD *)v1;
  if ( v6 == v2 )
  {
    result = v23;
    v18 = v23 == 0;
    if ( v23 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v23 + 4));
      if ( v18 )
        result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
    }
  }
  else
  {
    v7 = *(_DWORD *)v6;
    v8 = *(_DWORD *)v6 == 0;
    if ( *(_DWORD *)v6 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v7 + 4));
      if ( v8 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v7 + 4))(v7);
    }
    result = v23;
    *(_DWORD *)v6 = v23;
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08090870) --------------------------------------------------------
int __cdecl sub_8090870(int **a1, int a2)
{
  int *v2; // ebx@1
  int result; // eax@1

  v2 = *a1;
  sub_805F840(a2, (int)"code", **a1);
  result = *(_DWORD *)*v2;
  if ( result <= 0 )
  {
    if ( result )
    {
      *(_DWORD *)v2[1] = result;
    }
    else
    {
      result = v2[1];
      *(_DWORD *)result = -1;
    }
  }
  else
  {
    result *= 10000;
    *(_DWORD *)v2[1] = result;
  }
  return result;
}

//----- (08090BF0) --------------------------------------------------------
int __cdecl sub_8090BF0(int a1, int a2)
{
  _DWORD **v2; // esi@1
  int v3; // edi@1
  int v4; // eax@1
  _DWORD *v5; // ebp@3
  int v6; // eax@3
  int v7; // ebp@5
  int v8; // eax@5
  _DWORD *v9; // ebp@7
  int v10; // eax@7
  _DWORD *v11; // ebp@9
  _DWORD *v12; // ST10_4@9
  _DWORD *v13; // ST1C_4@9
  _DWORD *v14; // esi@9
  int v15; // eax@9
  int v16; // ST10_4@9
  int v17; // ST14_4@9
  int v18; // edx@9
  int (__cdecl *v19)(void **, void **, signed int); // edx@9
  int (__cdecl *v20)(void **, void **, signed int); // eax@9
  void *v21; // edx@9
  int result; // eax@11
  int v23; // [sp+20h] [bp-3Ch]@9
  int (__cdecl *v24)(void **, void **, signed int); // [sp+28h] [bp-34h]@9
  int (__cdecl *v25)(int); // [sp+2Ch] [bp-30h]@9
  int v26; // [sp+30h] [bp-2Ch]@1
  int v27; // [sp+34h] [bp-28h]@9
  int (__cdecl *v28)(void **, void **, signed int); // [sp+38h] [bp-24h]@1
  void *v29; // [sp+3Ch] [bp-20h]@1

  v2 = *(_DWORD ***)a1;
  v3 = ***(_DWORD ***)a1 + 8;
  v4 = operator new(4u);
  *(_DWORD *)v4 = v3;
  v26 = v4;
  v29 = sub_8095130;
  v28 = sub_8095370;
  sub_805F4A0(a2, (int)"id_task", (int)&v26);
  if ( v28 )
    v28((void **)&v26, (void **)&v26, 3);
  sub_805F840(a2, (int)"id_task_meta", **v2 + 84);
  sub_8099AC0(a2, (int)"id_creator", **v2 + 12);
  sub_805F840(a2, (int)"priority", **v2 + 16);
  v5 = *v2;
  v28 = 0;
  v6 = operator new(4u);
  *(_DWORD *)v6 = v5;
  v26 = v6;
  v29 = sub_808CA10;
  v28 = sub_808CEB0;
  sub_805F4A0(a2, 134978887, (int)&v26);
  if ( v28 )
    v28((void **)&v26, (void **)&v26, 3);
  sub_805F840(a2, (int)"checklist_count", **v2 + 20);
  v7 = **v2 + 24;
  v28 = 0;
  v8 = operator new(4u);
  *(_DWORD *)v8 = v7;
  v26 = v8;
  v29 = sub_8095110;
  v28 = sub_80952D0;
  sub_805F4A0(a2, (int)"status", (int)&v26);
  if ( v28 )
    v28((void **)&v26, (void **)&v26, 3);
  sub_805F840(a2, (int)"completion", **v2 + 72);
  sub_805F840(a2, (int)"pass", **v2 + 76);
  sub_805F840(a2, (int)"fail", **v2 + 80);
  sub_8099B80(a2, (int)"ts_start", **v2 + 56);
  sub_8099B80(a2, (int)"ts_stop", **v2 + 60);
  v9 = *v2;
  v28 = 0;
  v10 = operator new(8u);
  *(_DWORD *)v10 = v9;
  *(_DWORD *)(v10 + 4) = a2;
  v26 = v10;
  v29 = sub_80905C0;
  v28 = sub_808CF50;
  sub_8099850(a2, (int)"params", (int)&v26);
  if ( v28 )
    v28((void **)&v26, (void **)&v26, 3);
  v11 = v2[1];
  v12 = *v2;
  v13 = v2[2];
  v14 = v2[3];
  v15 = operator new(0x10u);
  *(_DWORD *)v15 = v11;
  *(_DWORD *)(v15 + 4) = v12;
  *(_DWORD *)(v15 + 8) = v13;
  *(_DWORD *)(v15 + 12) = v14;
  v23 = v15;
  v25 = sub_808FBD0;
  v24 = sub_808CC30;
  v29 = sub_808FBD0;
  v28 = sub_808CC30;
  sub_808CC30((void **)&v26, (void **)&v23, 2);
  v16 = v26;
  v17 = v27;
  v18 = *(_DWORD *)(a2 + 4);
  v26 = *(_DWORD *)a2;
  v27 = v18;
  *(_DWORD *)a2 = v16;
  *(_DWORD *)(a2 + 4) = v17;
  v19 = v28;
  v28 = *(int (__cdecl **)(void **, void **, signed int))(a2 + 8);
  v20 = v28;
  *(_DWORD *)(a2 + 8) = v19;
  v21 = v29;
  v29 = *(void **)(a2 + 12);
  *(_DWORD *)(a2 + 12) = v21;
  if ( v20 )
    v20((void **)&v26, (void **)&v26, 3);
  result = (int)v24;
  if ( v24 )
    result = v24((void **)&v23, (void **)&v23, 3);
  return result;
}
// 80905C0: using guessed type int sub_80905C0();
// 8095110: using guessed type int sub_8095110();

//----- (080910D0) --------------------------------------------------------
int __cdecl sub_80910D0(int a1, int a2)
{
  int v2; // ebp@1
  int v3; // ST10_4@1
  int v4; // edi@1
  int v5; // esi@1
  int v6; // ebx@1
  int v7; // eax@1
  int v8; // ebx@3
  int v9; // ST10_4@3
  int v10; // ST14_4@3
  int v11; // ST18_4@3
  int v12; // ST1C_4@3
  int v13; // edi@3
  int v14; // eax@3
  int v15; // ebx@5
  int v16; // eax@5
  int v17; // edi@8
  int v18; // ST10_4@8
  int v19; // ebx@8
  int v20; // ebp@8
  int v21; // eax@8
  int result; // eax@8
  int v23; // [sp+20h] [bp-2Ch]@1
  int (__cdecl *v24)(void **, void **, signed int); // [sp+28h] [bp-24h]@1
  void *v25; // [sp+2Ch] [bp-20h]@1

  v2 = *(_DWORD *)a1;
  v3 = **(_DWORD **)a1;
  v4 = *(_DWORD *)(*(_DWORD *)a1 + 4);
  v5 = *(_DWORD *)(*(_DWORD *)a1 + 8);
  v6 = *(_DWORD *)(*(_DWORD *)a1 + 12);
  v7 = operator new(0x10u);
  *(_DWORD *)v7 = v3;
  *(_DWORD *)(v7 + 4) = v4;
  *(_DWORD *)(v7 + 8) = v5;
  *(_DWORD *)(v7 + 12) = v6;
  v23 = v7;
  v25 = sub_8090BF0;
  v24 = (int (__cdecl *)(void **, void **, signed int))sub_808CB90;
  sub_8099D00(a2, (int)"tasks", (int)&v23);
  if ( v24 )
    v24((void **)&v23, (void **)&v23, 3);
  v8 = *(_DWORD *)(v2 + 16);
  v9 = *(_DWORD *)(v2 + 20);
  v10 = *(_DWORD *)(v2 + 24);
  v11 = *(_DWORD *)(v2 + 28);
  v12 = *(_DWORD *)(v2 + 32);
  v13 = *(_DWORD *)(v2 + 36);
  v24 = 0;
  v14 = operator new(0x18u);
  *(_DWORD *)v14 = v8;
  *(_DWORD *)(v14 + 4) = v9;
  *(_DWORD *)(v14 + 8) = v10;
  *(_DWORD *)(v14 + 12) = v11;
  *(_DWORD *)(v14 + 16) = v12;
  *(_DWORD *)(v14 + 20) = v13;
  v23 = v14;
  v25 = sub_80905D0;
  v24 = (int (__cdecl *)(void **, void **, signed int))sub_808CCD0;
  sub_8099E30(a2, (int)"params", (int)&v23, 0);
  if ( v24 )
    v24((void **)&v23, (void **)&v23, 3);
  v15 = *(_DWORD *)(v2 + 40);
  v24 = 0;
  v16 = operator new(4u);
  *(_DWORD *)v16 = v15;
  v23 = v16;
  v25 = sub_8095160;
  v24 = sub_8095230;
  sub_805F4A0(a2, (int)"ts", (int)&v23);
  if ( v24 )
    v24((void **)&v23, (void **)&v23, 3);
  if ( byte_80CE66C )
    sub_8099C40(a2, (int)"zip", *(_DWORD *)(v2 + 44) + 13);
  v17 = *(_DWORD *)(v2 + 4);
  v18 = *(_DWORD *)(v2 + 12);
  v19 = *(_DWORD *)(v2 + 48);
  v20 = *(_DWORD *)(v2 + 52);
  v24 = 0;
  v21 = operator new(0x10u);
  *(_DWORD *)v21 = v17;
  *(_DWORD *)(v21 + 4) = v18;
  *(_DWORD *)(v21 + 8) = v19;
  *(_DWORD *)(v21 + 12) = v20;
  v23 = v21;
  v25 = sub_8090670;
  v24 = (int (__cdecl *)(void **, void **, signed int))sub_808CD70;
  sub_8099D00(a2, (int)"tests", (int)&v23);
  result = (int)v24;
  if ( v24 )
    result = v24((void **)&v23, (void **)&v23, 3);
  return result;
}
// 808CB90: using guessed type int sub_808CB90();
// 808CCD0: using guessed type int sub_808CCD0();
// 808CD70: using guessed type int sub_808CD70();
// 80905D0: using guessed type int sub_80905D0();
// 8090670: using guessed type int sub_8090670();
// 80CE66C: using guessed type char byte_80CE66C;

//----- (08091A40) --------------------------------------------------------
int __cdecl sub_8091A40(int ***a1, int a2)
{
  int **v2; // edi@1
  int *v3; // ebx@1
  int *v4; // ebx@3
  int v5; // eax@3
  int result; // eax@3
  int v7; // eax@6
  bool v8; // zf@6
  int v9; // [sp+10h] [bp-28h]@1
  int (__cdecl *v10)(void **, void **, signed int); // [sp+18h] [bp-20h]@3
  int (*v11)(); // [sp+1Ch] [bp-1Ch]@3

  v2 = *a1;
  sub_8068500((int)&v9, (int)(*a1)[1]);
  v3 = *v2;
  if ( *v2 == &v9 )
  {
    v7 = v9;
    v8 = v9 == 0;
    if ( v9 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v9 + 4));
      if ( v8 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v7 + 4))(v7);
      v3 = *v2;
    }
  }
  else
  {
    sub_8056F10(*v3);
    *v3 = v9;
    v3 = *v2;
  }
  sub_805F840(a2, (int)"id_item", *(_DWORD *)(*v3 + 20) + 8);
  v4 = *v2;
  v10 = 0;
  v5 = operator new(8u);
  *(_DWORD *)v5 = v4;
  *(_DWORD *)(v5 + 4) = a2;
  v9 = v5;
  v11 = sub_8091A30;
  v10 = sub_808D440;
  sub_8099850(a2, (int)"info", (int)&v9);
  result = (int)v10;
  if ( v10 )
    result = v10((void **)&v9, (void **)&v9, 3);
  return result;
}
// 8091A30: using guessed type int sub_8091A30();

//----- (08091B60) --------------------------------------------------------
int __cdecl sub_8091B60(int a1, int a2)
{
  _DWORD **v2; // esi@1
  _DWORD *v3; // edi@1
  int v4; // eax@1
  _DWORD *v5; // edi@3
  int v6; // eax@3
  int v7; // edi@3
  _DWORD *v8; // ST18_4@9
  _DWORD *v9; // esi@9
  int v10; // eax@9
  int v11; // ST18_4@9
  int v12; // ST1C_4@9
  int v13; // edx@9
  int (__cdecl *v14)(void **, void **, signed int); // edx@9
  int (__cdecl *v15)(void **, void **, signed int); // eax@9
  void *v16; // edx@9
  int result; // eax@11
  int v18; // [sp+2Ch] [bp-50h]@3
  int (__cdecl *v19)(void **, void **, signed int); // [sp+34h] [bp-48h]@3
  int (__cdecl *v20)(int, std::string *); // [sp+38h] [bp-44h]@3
  int v21; // [sp+3Ch] [bp-40h]@3
  int (__cdecl *v22)(void **, void **, signed int); // [sp+44h] [bp-38h]@3
  int (__cdecl *v23)(int); // [sp+48h] [bp-34h]@3
  int v24; // [sp+4Ch] [bp-30h]@1
  int v25; // [sp+50h] [bp-2Ch]@3
  int (__cdecl *v26)(void **, void **, signed int); // [sp+54h] [bp-28h]@1
  void *v27; // [sp+58h] [bp-24h]@1

  v2 = *(_DWORD ***)a1;
  sub_805F840(a2, (int)"id", ***(_DWORD ***)a1 + 8);
  sub_805F840(a2, (int)"id0", **v2 + 12);
  v3 = *v2;
  v4 = operator new(4u);
  *(_DWORD *)v4 = v3;
  v24 = v4;
  v27 = sub_808DE60;
  v26 = sub_808D760;
  sub_805F4A0(a2, 134976870, (int)&v24);
  if ( v26 )
    v26((void **)&v24, (void **)&v24, 3);
  v5 = *v2;
  v6 = operator new(4u);
  *(_DWORD *)v6 = v5;
  v18 = v6;
  v20 = sub_808FB70;
  v19 = sub_808D800;
  v24 = a2;
  sub_805EDA0((int)&v25, (int)&v18);
  v22 = 0;
  v7 = operator new(0x14u);
  *(_DWORD *)v7 = v24;
  sub_805EDA0(v7 + 4, (int)&v25);
  v21 = v7;
  v23 = sub_80989B0;
  v22 = (int (__cdecl *)(void **, void **, signed int))sub_8098C20;
  sub_8099850(a2, (int)"ip_list", (int)&v21);
  if ( v22 )
    v22((void **)&v21, (void **)&v21, 3);
  if ( v27 )
    ((void (__cdecl *)(int *, int *, signed int))v27)(&v25, &v25, 3);
  if ( v19 )
    v19((void **)&v18, (void **)&v18, 3);
  v8 = *v2;
  v9 = v2[1];
  v22 = 0;
  v10 = operator new(8u);
  *(_DWORD *)v10 = v8;
  *(_DWORD *)(v10 + 4) = v9;
  v21 = v10;
  v23 = sub_808FEF0;
  v22 = sub_808D8A0;
  v27 = sub_808FEF0;
  v26 = sub_808D8A0;
  sub_808D8A0((void **)&v24, (void **)&v21, 2);
  v11 = v24;
  v12 = v25;
  v13 = *(_DWORD *)(a2 + 4);
  v24 = *(_DWORD *)a2;
  v25 = v13;
  *(_DWORD *)a2 = v11;
  *(_DWORD *)(a2 + 4) = v12;
  v14 = v26;
  v26 = *(int (__cdecl **)(void **, void **, signed int))(a2 + 8);
  v15 = v26;
  *(_DWORD *)(a2 + 8) = v14;
  v16 = v27;
  v27 = *(void **)(a2 + 12);
  *(_DWORD *)(a2 + 12) = v16;
  if ( v15 )
    v15((void **)&v24, (void **)&v24, 3);
  result = (int)v22;
  if ( v22 )
    result = v22((void **)&v21, (void **)&v21, 3);
  return result;
}
// 8098C20: using guessed type int sub_8098C20();

//----- (08091F30) --------------------------------------------------------
int __userpurge sub_8091F30@<eax>(int a1, int stream, int *a3, int a4, int a5, char a6)
{
  void (__cdecl *v6)(_DWORD, _DWORD); // esi@3
  int v7; // ebx@3
  void (__cdecl *v8)(_DWORD, _DWORD, _DWORD); // eax@10
  int v9; // ST20_4@12
  int v10; // edi@12
  int v11; // ebx@12
  int v12; // ebx@12
  int v13; // ebx@12
  int v14; // eax@13
  int v15; // ebx@19
  int v16; // eax@19
  int v17; // ebx@23
  int v18; // eax@28
  int v20; // eax@31
  int v21; // eax@32
  int v22; // eax@34
  int v23; // esi@41
  int v24; // ebx@41
  int v25; // ebx@41
  int v26; // ebx@41
  int v27; // eax@41
  int v28; // eax@42
  int v29; // ST20_4@46
  int v30; // edi@46
  int v31; // esi@46
  int v32; // esi@46
  int v33; // esi@46
  int v34; // eax@46
  int v35; // eax@47
  int v36; // esi@49
  int v37; // ebx@49
  int v38; // ebx@49
  int v39; // ebx@49
  int v40; // eax@50
  int v41; // eax@59
  int v42; // eax@59
  int v43; // eax@59
  int v44; // eax@60
  int v45; // eax@62
  int v46; // eax@62
  int v47; // eax@62
  int v48; // eax@63
  int v49; // [sp+4h] [bp-4E4h]@40
  signed int v50; // [sp+8h] [bp-4E0h]@40
  int v51; // [sp+20h] [bp-4C8h]@2
  int v52; // [sp+24h] [bp-4C4h]@10
  int i; // [sp+2Ch] [bp-4BCh]@10
  char v54; // [sp+37h] [bp-4B1h]@40
  int v55; // [sp+38h] [bp-4B0h]@3
  int v56; // [sp+3Ch] [bp-4ACh]@10
  int v57; // [sp+40h] [bp-4A8h]@40
  int v58; // [sp+44h] [bp-4A4h]@45
  int v59; // [sp+48h] [bp-4A0h]@19
  int (__cdecl *v60)(void **, void **, signed int); // [sp+50h] [bp-498h]@19
  int v61; // [sp+54h] [bp-494h]@19
  int v62; // [sp+58h] [bp-490h]@32
  int (__cdecl *v63)(void **, void **, signed int); // [sp+60h] [bp-488h]@32
  int (__cdecl *v64)(int **, int); // [sp+64h] [bp-484h]@32
  int v65; // [sp+68h] [bp-480h]@34
  int (__cdecl *v66)(void **, void **, signed int); // [sp+70h] [bp-478h]@34
  int (*v67)(); // [sp+74h] [bp-474h]@34
  char v68; // [sp+78h] [bp-470h]@4
  void (__cdecl *v69)(char *, char *, signed int); // [sp+80h] [bp-468h]@6
  char v70; // [sp+88h] [bp-460h]@4
  void (__cdecl *v71)(char *, char *, signed int); // [sp+90h] [bp-458h]@4
  int v72; // [sp+98h] [bp-450h]@19
  int v73; // [sp+9Ch] [bp-44Ch]@15
  char v74; // [sp+14Ch] [bp-39Ch]@46
  char v75; // [sp+200h] [bp-2E8h]@12
  char v76; // [sp+2B4h] [bp-234h]@59
  int v77; // [sp+368h] [bp-180h]@3
  int v78; // [sp+41Ch] [bp-CCh]@3
  int v79; // [sp+424h] [bp-C4h]@32
  char v80; // [sp+430h] [bp-B8h]@32
  char *v81; // [sp+438h] [bp-B0h]@32
  char *v82; // [sp+43Ch] [bp-ACh]@32
  int v83; // [sp+440h] [bp-A8h]@32
  int v84; // [sp+444h] [bp-A4h]@32

  if ( *(_BYTE *)(stream + 13) )
  {
    v51 = operator new(0x416Cu);
    sub_8095E80(v51);
    *(_DWORD *)v51 = &off_80BD3E8;
    sub_8096130(v51 + 32);
    *(_DWORD *)(v51 + 16732) = 0;
    *(_DWORD *)(v51 + 16736) = 0;
    *(_BYTE *)(v51 + 16740) = 0;
    sub_8096930(v51 + 16744);
  }
  else
  {
    v51 = operator new(0x6Cu);
    sub_8095E80(v51);
    *(_DWORD *)v51 = &off_80BD428;
    sub_8095FB0(v51 + 32);
    *(_DWORD *)(v51 + 92) = 0;
    *(_DWORD *)(v51 + 96) = 0;
    *(_BYTE *)(v51 + 100) = 0;
    sub_8096930(v51 + 104);
  }
  v6 = *(void (__cdecl **)(_DWORD, _DWORD))(*(_DWORD *)v51 + 28);
  std::string::string(&v55, "ERB2mcSsRRjrqPcRpwDI", &v77);
  v6(v51, &v55);
  std::string::_Rep::_M_dispose(v55 - 12, &v78);
  v7 = v51 + 4;
  sub_8098450((void *)(v51 + 4), 4);
  sub_8098E10((void *)(v51 + 4), "method", a3);
  if ( *(_DWORD *)(a4 + 8) )
  {
    sub_8098FA0((int)&v68, a4);
    sub_8069320((void *)v7, 3, (int)"params", 6);
    sub_8098FA0((int)&v70, (int)&v68);
    sub_8098450((void *)v7, 4);
    sub_8098EF0((int)&v70, v7);
    sub_8098450((void *)v7, 5);
    if ( v71 )
      v71(&v70, &v70, 3);
    if ( v69 )
      v69(&v68, &v68, 3);
  }
  else
  {
    sub_8069320((void *)v7, 3, (int)"params", 6);
    sub_8069320((void *)v7, 2, 134986579, 0);
  }
  sub_8098E10((void *)v7, "id", (int *)(stream + 4));
  if ( *(_DWORD *)(stream + 8) >= 0 )
    sub_8098E70((void *)v7, "session_id", stream + 8);
  sub_8098450((void *)v7, 5);
  (*(void (__cdecl **)(int))(*(_DWORD *)v51 + 32))(v51);
  v8 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(*(_DWORD *)v51 + 40);
  v78 = (int)&unk_80CF83C;
  v8(&v56, v51, &v78);
  std::string::_Rep::_M_dispose(v78 - 12, &v77);
  v52 = (*(int (__cdecl **)(int))(*(_DWORD *)v51 + 12))(v51);
  for ( i = 0; ; ++i )
  {
    if ( log_level <= 1 )
    {
      if ( (unsigned __int8)(*(int (__cdecl **)(int))(*(_DWORD *)v51 + 24))(v51) )
      {
        std::string::string(&v57, "<deflated>", &v54);
      }
      else
      {
        v50 = 0x2000;
        v49 = v51;
        (*(void (__stdcall **)(int *))(*(_DWORD *)v51 + 20))(&v57);
      }
      v23 = (*(int (__cdecl **)(int, int, signed int))(*(_DWORD *)v51 + 16))(v51, v49, v50);
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v72, 16);
      v24 = std::__ostream_insert<char,std::char_traits<char>>(
              &v72,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v24, "LENS REQ [", 10);
      v25 = std::ostream::_M_insert<unsigned long>(v24, v23);
      std::__ostream_insert<char,std::char_traits<char>>(v25, "]: digest=", 10);
      v26 = std::__ostream_insert<char,std::char_traits<char>>(v25, v56, *(_DWORD *)(v56 - 12));
      std::__ostream_insert<char,std::char_traits<char>>(v26, 134976096, 2);
      v27 = std::__ostream_insert<char,std::char_traits<char>>(v26, v57, *(_DWORD *)(v57 - 12));
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v78, v27 + 4);
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v72);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v77);
      std::string::_Rep::_M_dispose(v57 - 12, &v77);
      if ( byte_80CE64C )
      {
        v28 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v78, *(_DWORD *)(v78 - 12));
        std::endl<char,std::char_traits<char>>(v28);
      }
      syslog(7, "%s", v78);
      std::string::_Rep::_M_dispose(v78 - 12, &v77);
    }
    v15 = dword_80CE670;
    v60 = 0;
    v16 = operator new(4u);
    *(_DWORD *)v16 = &v56;
    v59 = v16;
    v61 = (int)"WVS t$4D$0";
    v60 = sub_808DBB0;
    sub_807B550((int)&v72, stream, (int)&v59, v52, a5, v15);
    if ( v60 )
      v60((void **)&v59, (void **)&v59, 3);
    if ( log_level <= 1 )
    {
      if ( *(_DWORD *)(v73 - 12) > 0xFFFu )
        std::string::string((std::string *)&v58, (const std::string *)&v73, 0, 0x1000u);
      else
        std::string::string((std::string *)&v58, (const std::string *)&v73);
      v29 = v72;
      v30 = *(_DWORD *)(v73 - 12);
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v74, 16);
      v31 = std::__ostream_insert<char,std::char_traits<char>>(
              &v74,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v31, "LENS RES [", 10);
      v32 = std::ostream::_M_insert<unsigned long>(v31, v30);
      std::__ostream_insert<char,std::char_traits<char>>(v32, "]: (", 4);
      v33 = std::ostream::operator<<(v32, v29);
      std::__ostream_insert<char,std::char_traits<char>>(v33, ") ", 2);
      v34 = std::__ostream_insert<char,std::char_traits<char>>(v33, v58, *(_DWORD *)(v58 - 12));
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v78, v34 + 4);
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v74);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v77);
      std::string::_Rep::_M_dispose(v58 - 12, &v77);
      if ( byte_80CE64C )
      {
        v35 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v78, *(_DWORD *)(v78 - 12));
        std::endl<char,std::char_traits<char>>(v35);
      }
      syslog(7, "%s", v78);
      std::string::_Rep::_M_dispose(v78 - 12, &v77);
    }
    if ( a6 )
    {
      sub_808DDF0((FILE *)stream, v72 != 0);
      v17 = v72;
      if ( v72 != 200 )
        goto LABEL_24;
    }
    else
    {
      v17 = v72;
      if ( v72 != 200 )
        goto LABEL_24;
    }
    v20 = v73;
    if ( !*(_DWORD *)(v73 - 12) )
    {
      *(_DWORD *)a1 = 200;
      *(_DWORD *)(a1 + 4) = v20;
      v73 = (int)&unk_80CF83C;
      v18 = (int)&unk_80CF83C;
      goto LABEL_29;
    }
    v77 = -1;
    v79 = 0;
    memset(&v80, 0, 0x10u);
    v83 = 0;
    v81 = &v80;
    v82 = &v80;
    v84 = 0;
    v63 = 0;
    v21 = operator new(8u);
    *(_DWORD *)v21 = &v77;
    *(_DWORD *)(v21 + 4) = &v72;
    v62 = v21;
    v64 = sub_8090870;
    v63 = sub_808DC50;
    sub_8099E30((int)&v78, (int)"error", (int)&v62, 1);
    if ( v63 )
      v63((void **)&v62, (void **)&v62, 3);
    v66 = 0;
    v22 = operator new(4u);
    *(_DWORD *)v22 = &v77;
    v65 = v22;
    v67 = sub_808C9F0;
    v66 = sub_808DCF0;
    sub_8099850((int)&v78, (int)"result", (int)&v65);
    if ( v66 )
      v66((void **)&v65, (void **)&v65, 3);
    sub_80981A0(&v78, v73, *(_DWORD *)(v73 - 12));
    if ( v77 <= 0 )
      break;
    v72 = v77 + 10000;
LABEL_38:
    sub_8099090((int)&v78);
    v17 = v72;
LABEL_24:
    if ( v17 )
    {
      if ( log_level <= 2 )
      {
        v9 = dword_80CE678;
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v75, 16);
        v10 = std::__ostream_insert<char,std::char_traits<char>>(
                &v75,
                &unk_80CF83C,
                std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v10, "LENS server error: ", 19);
        v11 = std::ostream::operator<<(v10, v17);
        std::__ostream_insert<char,std::char_traits<char>>(v11, ", retries (", 11);
        v12 = std::ostream::operator<<(v11, i);
        std::__ostream_insert<char,std::char_traits<char>>(v12, 134981720, 1);
        v13 = std::ostream::operator<<(v12, v9);
        std::__ostream_insert<char,std::char_traits<char>>(v13, 134976047, 1);
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v78, v13 + 4);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v75);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v77);
        if ( byte_80CE64C )
        {
          v14 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v78, *(_DWORD *)(v78 - 12));
          std::endl<char,std::char_traits<char>>(v14);
        }
        syslog(6, "%s", v78);
        std::string::_Rep::_M_dispose(v78 - 12, &v77);
      }
      std::string::_M_mutate((std::string *)&v73, 0, *(_DWORD *)(v73 - 12), 0);
      if ( i >= dword_80CE678 )
      {
        if ( log_level <= 4 )
        {
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v76, 16);
          v41 = std::__ostream_insert<char,std::char_traits<char>>(
                  &v76,
                  &unk_80CF83C,
                  std::string::_Rep::_S_empty_rep_storage);
          v42 = std::operator<<<std::char_traits<char>>(v41, "LENS server retry count reached limit ");
          v43 = std::ostream::operator<<(v42, i);
          std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v78, v43 + 4);
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v76);
          std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v77);
          if ( byte_80CE64C )
          {
            v44 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v78, *(_DWORD *)(v78 - 12));
            std::endl<char,std::char_traits<char>>(v44);
          }
          syslog(4, "%s", v78);
          std::string::_Rep::_M_dispose(v78 - 12, &v77);
        }
        goto LABEL_28;
      }
    }
    else
    {
      if ( log_level <= 2 )
      {
        v36 = dword_80CE674;
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v77, 16);
        v37 = std::__ostream_insert<char,std::char_traits<char>>(
                &v77,
                &unk_80CF83C,
                std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v37, "LENS server connection failed, retries (", 40);
        v38 = std::ostream::operator<<(v37, i);
        std::__ostream_insert<char,std::char_traits<char>>(v38, 134981720, 1);
        v39 = std::ostream::operator<<(v38, v36);
        std::__ostream_insert<char,std::char_traits<char>>(v39, 134976047, 1);
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v78, v39 + 4);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v77);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v77);
        if ( byte_80CE64C )
        {
          v40 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v78, *(_DWORD *)(v78 - 12));
          std::endl<char,std::char_traits<char>>(v40);
        }
        syslog(6, "%s", v78);
        std::string::_Rep::_M_dispose(v78 - 12, &v77);
      }
      if ( i >= dword_80CE674 )
      {
        if ( log_level <= 4 )
        {
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v78, 16);
          v45 = std::__ostream_insert<char,std::char_traits<char>>(
                  &v78,
                  &unk_80CF83C,
                  std::string::_Rep::_S_empty_rep_storage);
          v46 = std::operator<<<std::char_traits<char>>(v45, "LENS server connection retry count reached limit ");
          v47 = std::ostream::operator<<(v46, i);
          std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v77, v47 + 4);
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v78);
          std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v78);
          if ( byte_80CE64C )
          {
            v48 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v77, *(_DWORD *)(v77 - 12));
            std::endl<char,std::char_traits<char>>(v48);
          }
          syslog(4, "%s", v77);
          std::string::_Rep::_M_dispose(v77 - 12, &v78);
        }
LABEL_28:
        *(_DWORD *)a1 = v72;
        *(_DWORD *)(a1 + 4) = v73;
        v73 = (int)&unk_80CF83C;
        v18 = (int)&unk_80CF83C;
        goto LABEL_29;
      }
    }
    if ( !a6 )
    {
      *(_DWORD *)a1 = v72;
      *(_DWORD *)(a1 + 4) = v73;
      v73 = (int)&unk_80CF83C;
      v18 = (int)&unk_80CF83C;
      goto LABEL_29;
    }
    sleep(seconds);
    std::string::_Rep::_M_dispose(v73 - 12, &v78);
  }
  if ( v77 )
  {
    v72 = v77;
    goto LABEL_38;
  }
  *(_DWORD *)a1 = v72;
  *(_DWORD *)(a1 + 4) = v73;
  v73 = (int)&unk_80CF83C;
  sub_8099090((int)&v78);
  v18 = v73;
LABEL_29:
  std::string::_Rep::_M_dispose(v18 - 12, &v78);
  std::string::_Rep::_M_dispose(v56 - 12, &v78);
  (*(void (__cdecl **)(int))(*(_DWORD *)v51 + 4))(v51);
  return a1;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C9B0: using guessed type int __cdecl std::operator<<<std::char_traits<char>>(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 808C9F0: using guessed type int sub_808C9F0();
// 80BD3E8: using guessed type int (__cdecl *off_80BD3E8)(int);
// 80BD428: using guessed type int (__cdecl *off_80BD428)(int);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CE670: using guessed type int dword_80CE670;
// 80CE674: using guessed type int dword_80CE674;
// 80CE678: using guessed type int dword_80CE678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08093380) --------------------------------------------------------
int __userpurge sub_8093380@<eax>(int a1, int a2)
{
  char v3; // [sp+2Ah] [bp-3Eh]@3
  char v4; // [sp+2Bh] [bp-3Dh]@3
  int v5; // [sp+2Ch] [bp-3Ch]@3
  int v6; // [sp+30h] [bp-38h]@3
  int (__cdecl *v7)(void **, void **, signed int); // [sp+38h] [bp-30h]@3
  int (*v8)(); // [sp+3Ch] [bp-2Ch]@3
  char v9; // [sp+40h] [bp-28h]@3
  void (__cdecl *v10)(char *, char *, signed int); // [sp+48h] [bp-20h]@3

  if ( byte_80CF868 )
    *(_DWORD *)(a2 + 8) = g_time;
  else
    *(_DWORD *)(a2 + 8) = -1;
  v10 = 0;
  v6 = operator new(1u);
  v8 = sub_808E070;
  v7 = sub_808DB20;
  std::string::string(&v5, "SetMyParams", &v3);
  sub_8091F30(a1, a2, &v5, (int)&v6, (int)&v9, 1);
  std::string::_Rep::_M_dispose(v5 - 12, &v4);
  if ( v7 )
    v7((void **)&v6, (void **)&v6, 3);
  if ( v10 )
    v10(&v9, &v9, 3);
  if ( *(_DWORD *)a1 == 200 )
    *(_DWORD *)(a2 + 8) = g_time;
  return a1;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 808E070: using guessed type int sub_808E070();
// 80CF868: using guessed type char byte_80CF868;
// 80CF86C: using guessed type int g_time;

//----- (08093510) --------------------------------------------------------
int __userpurge sub_8093510@<eax>(int a1, int a2, int *a3, int a4, int a5, char a6)
{
  int v6; // eax@1
  int v7; // esi@2
  int v8; // edx@3
  char v10; // [sp+2Fh] [bp-29h]@9
  int v11; // [sp+30h] [bp-28h]@2
  int v12; // [sp+34h] [bp-24h]@9
  int v13; // [sp+38h] [bp-20h]@3
  int v14; // [sp+3Ch] [bp-1Ch]@4

  v6 = a5;
  if ( *(_DWORD *)(a2 + 8) < 0 )
  {
    v7 = (int)&v11;
    sub_8093380((int)&v11, a2);
    if ( v11 != 200 )
    {
      *(_DWORD *)a1 = v11;
      *(_DWORD *)(a1 + 4) = v12;
      v12 = (int)&unk_80CF83C;
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v10);
      return a1;
    }
    std::string::_Rep::_M_dispose(v12 - 12, &v10);
    v6 = a5;
  }
  else
  {
    v7 = (int)&v11;
  }
  v13 = 0;
  v8 = *(_DWORD *)(v6 + 8);
  if ( v8 )
  {
    v14 = *(_DWORD *)(v6 + 12);
    v13 = v8;
    ((void (__cdecl *)(int, int, signed int))v8)(v7, v6, 2);
  }
  sub_8091F30(a1, a2, a3, a4, v7, a6);
  if ( v13 )
    ((void (__cdecl *)(int, int, signed int))v13)(v7, v7, 3);
  return a1;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08093670) --------------------------------------------------------
int __userpurge sub_8093670@<eax>(int a1, int a2, int a3)
{
  int v3; // ebx@1
  int v5; // eax@7
  int v6; // esi@10
  char v7; // cl@10
  int v8; // ebx@11
  int v9; // edi@13
  int v10; // eax@14
  int v11; // ecx@14
  int v12; // ST1C_4@19
  int v13; // edx@23
  int v14; // esi@23
  time_t v15; // edi@24
  char v16; // ST1C_1@32
  char v17; // [sp+2Ah] [bp-AEh]@7
  int v18; // [sp+2Ch] [bp-ACh]@1
  time_t v19; // [sp+30h] [bp-A8h]@7
  int v20; // [sp+34h] [bp-A4h]@7
  signed __int32 v21; // [sp+38h] [bp-A0h]@7
  signed __int32 v22; // [sp+3Ch] [bp-9Ch]@7
  signed __int32 v23; // [sp+40h] [bp-98h]@7
  int v24; // [sp+44h] [bp-94h]@7
  signed __int32 v25; // [sp+48h] [bp-90h]@7
  signed __int32 v26; // [sp+4Ch] [bp-8Ch]@7
  int v27; // [sp+50h] [bp-88h]@1
  int v28; // [sp+54h] [bp-84h]@6
  int v29; // [sp+58h] [bp-80h]@1
  int v30; // [sp+5Ch] [bp-7Ch]@7
  int v31; // [sp+60h] [bp-78h]@1
  int (*v32)(); // [sp+68h] [bp-70h]@7
  int (__cdecl *v33)(int, int); // [sp+6Ch] [bp-6Ch]@7
  int v34; // [sp+70h] [bp-68h]@1
  int v35; // [sp+74h] [bp-64h]@7
  void (__cdecl *v36)(int *, int *, signed int); // [sp+78h] [bp-60h]@1
  int v37; // [sp+7Ch] [bp-5Ch]@7
  int v38; // [sp+80h] [bp-58h]@7
  char v39; // [sp+84h] [bp-54h]@7
  int v40; // [sp+88h] [bp-50h]@7
  int v41; // [sp+8Ch] [bp-4Ch]@7
  char v42; // [sp+90h] [bp-48h]@7
  char v43; // [sp+94h] [bp-44h]@1
  void (__cdecl *v44)(char *, char *, signed int); // [sp+9Ch] [bp-3Ch]@1
  int v45; // [sp+A4h] [bp-34h]@27
  char v46; // [sp+A8h] [bp-30h]@7
  void *v47; // [sp+ACh] [bp-2Ch]@27
  char *v48; // [sp+B0h] [bp-28h]@7
  char *v49; // [sp+B4h] [bp-24h]@7
  int v50; // [sp+B8h] [bp-20h]@7
  int v51; // [sp+BCh] [bp-1Ch]@7

  v3 = a1;
  *(_DWORD *)a1 = 0;
  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 8) = 0;
  v44 = 0;
  v36 = 0;
  std::string::string(&v18, "GetMyTasks", &v29);
  sub_8093510((int)&v27, a2, &v18, (int)&v34, (int)&v43, 1);
  std::string::_Rep::_M_dispose(v18 - 12, &v31);
  if ( v36 )
    v36(&v34, &v34, 3);
  if ( v44 )
    v44(&v43, &v43, 3);
  if ( v27 != 200 )
    goto LABEL_6;
  v19 = 0;
  v34 = 0;
  v35 = 0;
  v36 = 0;
  v37 = (int)&unk_80CF83C;
  v38 = (int)&unk_80CF83C;
  sub_80A6810((int)&v39);
  v40 = (int)&unk_80CF83C;
  v41 = (int)&unk_80CF83C;
  sub_80A6810((int)&v42);
  v29 = 0;
  v30 = 0;
  v17 = 0;
  sub_8098D10((int)&v20);
  v21 = dword_80CF860;
  v22 = dword_80CF85C;
  v23 = dword_80CF858;
  v24 = 1000 * dword_80CF854;
  v25 = dword_80CF850;
  v26 = dword_80CF84C;
  v44 = 0;
  memset(&v46, 0, 0x10u);
  v50 = 0;
  v48 = &v46;
  v49 = &v46;
  v51 = 0;
  v32 = 0;
  v5 = operator new(0x38u);
  *(_DWORD *)v5 = &v20;
  *(_DWORD *)(v5 + 4) = &v17;
  *(_DWORD *)(v5 + 8) = a3;
  *(_DWORD *)(v5 + 12) = a1;
  *(_DWORD *)(v5 + 16) = &v21;
  *(_DWORD *)(v5 + 20) = &v22;
  *(_DWORD *)(v5 + 24) = &v23;
  *(_DWORD *)(v5 + 28) = &v24;
  *(_DWORD *)(v5 + 32) = &v25;
  *(_DWORD *)(v5 + 36) = &v26;
  *(_DWORD *)(v5 + 40) = &v19;
  *(_DWORD *)(v5 + 44) = a2;
  *(_DWORD *)(v5 + 48) = &v34;
  *(_DWORD *)(v5 + 52) = &v29;
  v31 = v5;
  v33 = sub_80910D0;
  v32 = sub_808CAF0;
  sub_8099E30((int)&v43, (int)"result", (int)&v31, 0);
  if ( v32 )
    ((void (__cdecl *)(int *, int *, signed int))v32)(&v31, &v31, 3);
  sub_80981A0(&v43, v28, *(_DWORD *)(v28 - 12));
  if ( v29 )
  {
    v6 = *(_DWORD *)a1;
    v7 = 0;
    if ( *(_DWORD *)a1 == *(_DWORD *)(a1 + 4) )
      goto LABEL_22;
    v8 = *(_DWORD *)(a1 + 4);
    while ( 1 )
    {
      while ( 1 )
      {
        v9 = *(_DWORD *)v6;
        if ( !*(_DWORD *)(*(_DWORD *)(*(_DWORD *)v6 + 28) - 12) )
          break;
LABEL_12:
        v6 += 4;
        if ( v8 == v6 )
          goto LABEL_21;
      }
      *(_DWORD *)(v9 + 64) = v29;
      v10 = v30;
      v11 = *(_DWORD *)(v9 + 68);
      if ( v30 == v11 )
      {
        v7 = 1;
        goto LABEL_12;
      }
      if ( v30 )
      {
        if ( &_pthread_key_create )
        {
          _InterlockedIncrement((volatile signed __int32 *)(v30 + 4));
          v11 = *(_DWORD *)(v9 + 68);
        }
        else
        {
          ++*(_DWORD *)(v30 + 4);
          v11 = *(_DWORD *)(v9 + 68);
        }
      }
      if ( v11 )
      {
        v12 = v10;
        sub_8099010(v11);
        v10 = v12;
      }
      *(_DWORD *)(v9 + 68) = v10;
      v7 = 1;
      v6 += 4;
      if ( v8 == v6 )
      {
LABEL_21:
        v3 = a1;
        goto LABEL_22;
      }
    }
  }
  v7 = 0;
LABEL_22:
  if ( !v19 )
  {
    v16 = v7;
    v19 = time(0);
    v7 = v16;
  }
  v13 = *(_DWORD *)v3;
  v14 = *(_DWORD *)(v3 + 4);
  if ( *(_DWORD *)v3 != v14 )
  {
    v15 = v19;
    do
    {
      *(_DWORD *)(*(_DWORD *)v13 + 44) = v15;
      v13 += 4;
    }
    while ( v14 != v13 );
  }
  if ( v7 )
  {
    _InterlockedExchange((volatile signed __int32 *)&dword_80CF860, v21);
    _InterlockedExchange((volatile signed __int32 *)&dword_80CF85C, v22);
    _InterlockedExchange((volatile signed __int32 *)&dword_80CF858, v23);
    _InterlockedExchange((volatile signed __int32 *)&dword_80CF854, v24 / 1000);
    _InterlockedExchange((volatile signed __int32 *)&dword_80CF850, v25);
    _InterlockedExchange((volatile signed __int32 *)&dword_80CF84C, v26);
  }
  sub_805EF00((int)&v45, v47);
  if ( v44 )
    v44(&v43, &v43, 3);
  sub_8056F10(v20);
  if ( v30 )
    sub_8099010(v30);
  sub_8097BE0((int)&v34);
LABEL_6:
  std::string::_Rep::_M_dispose(v28 - 12, &v31);
  return v3;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 808CAF0: using guessed type int sub_808CAF0();
// 80CF84C: using guessed type int dword_80CF84C;
// 80CF850: using guessed type int dword_80CF850;
// 80CF854: using guessed type int dword_80CF854;
// 80CF858: using guessed type int dword_80CF858;
// 80CF85C: using guessed type int dword_80CF85C;
// 80CF860: using guessed type int dword_80CF860;

//----- (08093CA0) --------------------------------------------------------
int __cdecl sub_8093CA0(int a1, int a2, int a3, int a4)
{
  int v4; // ST1C_4@2
  int v5; // ebx@2
  int v6; // ebx@2
  int v7; // eax@2
  int v8; // edx@2
  int v9; // eax@5
  int result; // eax@7
  int v11; // eax@10
  signed __int32 v12; // ecx@12
  char v13; // [sp+2Eh] [bp-EAh]@5
  char v14; // [sp+2Fh] [bp-E9h]@5
  int v15; // [sp+30h] [bp-E8h]@5
  char v16; // [sp+34h] [bp-E4h]@5
  int v17; // [sp+38h] [bp-E0h]@5
  int v18; // [sp+3Ch] [bp-DCh]@2
  int (*v19)(); // [sp+44h] [bp-D4h]@5
  int (__cdecl *v20)(int, void *); // [sp+48h] [bp-D0h]@5
  int v21; // [sp+4Ch] [bp-CCh]@2
  int v22; // [sp+50h] [bp-C8h]@2
  int v23; // [sp+54h] [bp-C4h]@5
  char v24; // [sp+6Ch] [bp-ACh]@3
  int v25; // [sp+74h] [bp-A4h]@2
  int v26; // [sp+78h] [bp-A0h]@2

  if ( log_level <= 2 )
  {
    v4 = *(_DWORD *)(*(_DWORD *)a2 + 8);
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v21, 16);
    v5 = std::__ostream_insert<char,std::char_traits<char>>(&v21, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v5, 134978863, 5);
    v6 = std::ostream::_M_insert<unsigned long>(v5, v4);
    std::__ostream_insert<char,std::char_traits<char>>(v6, " status ", 8);
    v7 = std::__ostream_insert<char,std::char_traits<char>>(v6, *(_DWORD *)a3, *(_DWORD *)(*(_DWORD *)a3 - 12));
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v18, v7 + 4);
    v21 = (int)&unk_80CF5DC;
    v26 = (int)&unk_80CF5F0;
    v22 = (int)&unk_80CF588;
    v8 = v25 - 12;
    if ( (_DWORD *)(v25 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v12 = _InterlockedExchangeAdd((volatile signed __int32 *)(v25 - 4), 0xFFFFFFFF);
      }
      else
      {
        v12 = *(_DWORD *)(v25 - 4);
        *(_DWORD *)(v25 - 4) = v12 - 1;
      }
      if ( v12 <= 0 )
        std::string::_Rep::_M_destroy(v8, &v16);
    }
    v22 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v24);
    v21 = dword_80CF674;
    *(int *)((char *)&v21 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v26 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v26);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v21);
    if ( byte_80CE64C )
    {
      v11 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v18, *(_DWORD *)(v18 - 12));
      std::endl<char,std::char_traits<char>>(v11);
    }
    syslog(6, "%s", v18);
    std::string::_Rep::_M_dispose(v18 - 12, &v21);
  }
  v23 = 0;
  v19 = 0;
  v9 = operator new(0x10u);
  *(_DWORD *)v9 = a2;
  *(_DWORD *)(v9 + 4) = a1;
  *(_DWORD *)(v9 + 8) = a3;
  *(_DWORD *)(v9 + 12) = a4;
  v18 = v9;
  v20 = sub_808F6A0;
  v19 = sub_808CE10;
  std::string::string(&v15, "SendTasks", &v13);
  sub_8093510((int)&v16, a1, &v15, (int)&v18, (int)&v21, 1);
  std::string::_Rep::_M_dispose(v17 - 12, &v14);
  std::string::_Rep::_M_dispose(v15 - 12, &v16);
  if ( v19 )
    ((void (__cdecl *)(int *, int *, signed int))v19)(&v18, &v18, 3);
  result = v23;
  if ( v23 )
    result = ((int (__cdecl *)(int *, int *, signed int))v23)(&v21, &v21, 3);
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 808CE10: using guessed type int sub_808CE10();
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080940A0) --------------------------------------------------------
int __cdecl sub_80940A0(int a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  int result; // eax@1
  int v6; // [sp+10h] [bp-1Ch]@1
  int (__cdecl *v7)(void **, void **, signed int); // [sp+18h] [bp-14h]@1
  int (*v8)(); // [sp+1Ch] [bp-10h]@1

  v4 = operator new(4u);
  *(_DWORD *)v4 = a4;
  v6 = v4;
  v8 = sub_808DEE0;
  v7 = sub_808D090;
  sub_8093CA0(a1, a2, a3, (int)&v6);
  result = (int)v7;
  if ( v7 )
    result = v7((void **)&v6, (void **)&v6, 3);
  return result;
}
// 808DEE0: using guessed type int sub_808DEE0();

//----- (08094160) --------------------------------------------------------
int __cdecl sub_8094160(int a1, int a2, char a3)
{
  int v3; // eax@1
  int result; // eax@3
  char v5; // [sp+22h] [bp-46h]@1
  char v6; // [sp+23h] [bp-45h]@1
  int v7; // [sp+24h] [bp-44h]@1
  char v8; // [sp+28h] [bp-40h]@1
  int v9; // [sp+2Ch] [bp-3Ch]@1
  int v10; // [sp+30h] [bp-38h]@1
  int (__cdecl *v11)(void **, void **, signed int); // [sp+38h] [bp-30h]@1
  int (__cdecl *v12)(int, void *); // [sp+3Ch] [bp-2Ch]@1
  int v13; // [sp+40h] [bp-28h]@1
  int (__cdecl *v14)(void **, void **, signed int); // [sp+48h] [bp-20h]@1
  int (*v15)(); // [sp+4Ch] [bp-1Ch]@1

  v13 = operator new(1u);
  v15 = nullsub_1;
  v14 = sub_808D130;
  v3 = operator new(8u);
  *(_DWORD *)v3 = a2;
  *(_DWORD *)(v3 + 4) = &a3;
  v10 = v3;
  v12 = sub_808E190;
  v11 = sub_808D1C0;
  std::string::string(&v7, "Get", &v5);
  sub_8093510((int)&v8, a1, &v7, (int)&v10, (int)&v13, 0);
  std::string::_Rep::_M_dispose(v9 - 12, &v6);
  std::string::_Rep::_M_dispose(v7 - 12, &v8);
  if ( v11 )
    v11((void **)&v10, (void **)&v10, 3);
  result = (int)v14;
  if ( v14 )
    result = v14((void **)&v13, (void **)&v13, 3);
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 808C9E0: using guessed type int nullsub_1();

//----- (08094300) --------------------------------------------------------
int __userpurge sub_8094300@<eax>(int a1, int a2, int a3, char a4)
{
  int v4; // eax@1
  int v6; // eax@7
  char v7; // [sp+27h] [bp-71h]@1
  int v8; // [sp+28h] [bp-70h]@1
  int v9; // [sp+2Ch] [bp-6Ch]@1
  int v10; // [sp+30h] [bp-68h]@6
  int v11; // [sp+34h] [bp-64h]@1
  int (__cdecl *v12)(void **, void **, signed int); // [sp+3Ch] [bp-5Ch]@1
  int (__cdecl *v13)(int, void *); // [sp+40h] [bp-58h]@1
  int v14; // [sp+44h] [bp-54h]@1
  int (__cdecl *v15)(void **, void **, signed int); // [sp+4Ch] [bp-4Ch]@7
  int (*v16)(); // [sp+50h] [bp-48h]@7
  char v17; // [sp+54h] [bp-44h]@1
  void (__cdecl *v18)(char *, char *, signed int); // [sp+5Ch] [bp-3Ch]@1
  int v19; // [sp+64h] [bp-34h]@9
  char v20; // [sp+68h] [bp-30h]@7
  void *v21; // [sp+6Ch] [bp-2Ch]@9
  char *v22; // [sp+70h] [bp-28h]@7
  char *v23; // [sp+74h] [bp-24h]@7
  int v24; // [sp+78h] [bp-20h]@7
  int v25; // [sp+7Ch] [bp-1Ch]@7

  *(_DWORD *)a1 = 0;
  v18 = 0;
  v4 = operator new(8u);
  *(_DWORD *)v4 = a3;
  *(_DWORD *)(v4 + 4) = &a4;
  v11 = v4;
  v13 = sub_808E360;
  v12 = sub_808D260;
  std::string::string(&v8, "Get", &v7);
  sub_8093510((int)&v9, a2, &v8, (int)&v11, (int)&v17, 1);
  std::string::_Rep::_M_dispose(v8 - 12, &v14);
  if ( v12 )
    v12((void **)&v11, (void **)&v11, 3);
  if ( v18 )
    v18(&v17, &v17, 3);
  if ( v9 == 200 )
  {
    v18 = 0;
    memset(&v20, 0, 0x10u);
    v24 = 0;
    v22 = &v20;
    v23 = &v20;
    v25 = 0;
    v15 = 0;
    v6 = operator new(8u);
    *(_DWORD *)v6 = a1;
    *(_DWORD *)(v6 + 4) = a3;
    v14 = v6;
    v16 = sub_8091420;
    v15 = sub_808D300;
    sub_8099E30((int)&v17, (int)"result", (int)&v14, 0);
    if ( v15 )
      v15((void **)&v14, (void **)&v14, 3);
    sub_80981A0(&v17, v10, *(_DWORD *)(v10 - 12));
    sub_805EF00((int)&v19, v21);
    if ( v18 )
      v18(&v17, &v17, 3);
  }
  std::string::_Rep::_M_dispose(v10 - 12, &v14);
  return a1;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 8091420: using guessed type int sub_8091420();

//----- (080945C0) --------------------------------------------------------
int __cdecl sub_80945C0(int a1, int a2)
{
  int v2; // eax@1
  int v3; // eax@3
  int v4; // ST1C_4@5
  char v6; // [sp+22h] [bp-46h]@1
  char v7; // [sp+23h] [bp-45h]@1
  int v8; // [sp+24h] [bp-44h]@1
  int v9; // [sp+28h] [bp-40h]@1
  int v10; // [sp+2Ch] [bp-3Ch]@5
  int v11; // [sp+30h] [bp-38h]@1
  int (__cdecl *v12)(void **, void **, signed int); // [sp+38h] [bp-30h]@1
  int (__cdecl *v13)(int, void *); // [sp+3Ch] [bp-2Ch]@1
  char v14; // [sp+40h] [bp-28h]@1
  int v15; // [sp+48h] [bp-20h]@1

  v15 = 0;
  v2 = operator new(4u);
  *(_DWORD *)v2 = a2;
  v11 = v2;
  v13 = sub_808E750;
  v12 = sub_808D940;
  std::string::string(&v8, "SendReport", &v6);
  sub_8093510((int)&v9, a1, &v8, (int)&v11, (int)&v14, 1);
  std::string::_Rep::_M_dispose(v8 - 12, &v7);
  if ( v12 )
    v12((void **)&v11, (void **)&v11, 3);
  v3 = v15;
  if ( v15 )
    v3 = ((int (__cdecl *)(char *, char *, signed int))v15)(&v14, &v14, 3);
  LOBYTE(v3) = v9 == 200;
  v4 = v3;
  std::string::_Rep::_M_dispose(v10 - 12, &v14);
  return v4;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);

//----- (08094730) --------------------------------------------------------
int __cdecl sub_8094730(int a1, int a2, int a3)
{
  int v3; // eax@1
  int result; // eax@3
  char v5; // [sp+22h] [bp-46h]@1
  char v6; // [sp+23h] [bp-45h]@1
  int v7; // [sp+24h] [bp-44h]@1
  char v8; // [sp+28h] [bp-40h]@1
  int v9; // [sp+2Ch] [bp-3Ch]@1
  int v10; // [sp+30h] [bp-38h]@1
  int (__cdecl *v11)(void **, void **, signed int); // [sp+38h] [bp-30h]@1
  int (__cdecl *v12)(int, void *); // [sp+3Ch] [bp-2Ch]@1
  char v13; // [sp+40h] [bp-28h]@1
  int v14; // [sp+48h] [bp-20h]@1

  v14 = 0;
  v3 = operator new(8u);
  *(_DWORD *)v3 = a2;
  *(_DWORD *)(v3 + 4) = a3;
  v10 = v3;
  v12 = sub_808DF40;
  v11 = sub_808D9E0;
  std::string::string(&v7, "SendLog1", &v5);
  sub_8093510((int)&v8, a1, &v7, (int)&v10, (int)&v13, 1);
  std::string::_Rep::_M_dispose(v9 - 12, &v6);
  std::string::_Rep::_M_dispose(v7 - 12, &v8);
  if ( v11 )
    v11((void **)&v10, (void **)&v10, 3);
  result = v14;
  if ( v14 )
    result = ((int (__cdecl *)(char *, char *, signed int))v14)(&v13, &v13, 3);
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);

//----- (08094890) --------------------------------------------------------
int __cdecl sub_8094890(int a1, int a2)
{
  int v2; // eax@1
  int result; // eax@3
  char v4; // [sp+22h] [bp-46h]@1
  char v5; // [sp+23h] [bp-45h]@1
  int v6; // [sp+24h] [bp-44h]@1
  char v7; // [sp+28h] [bp-40h]@1
  int v8; // [sp+2Ch] [bp-3Ch]@1
  int v9; // [sp+30h] [bp-38h]@1
  int (__cdecl *v10)(void **, void **, signed int); // [sp+38h] [bp-30h]@1
  __int16 (__cdecl *v11)(int, void *); // [sp+3Ch] [bp-2Ch]@1
  char v12; // [sp+40h] [bp-28h]@1
  int v13; // [sp+48h] [bp-20h]@1

  v13 = 0;
  v2 = operator new(4u);
  *(_DWORD *)v2 = a2;
  v9 = v2;
  v11 = sub_808E530;
  v10 = sub_808DA80;
  std::string::string(&v6, "SetMyParams", &v4);
  sub_8093510((int)&v7, a1, &v6, (int)&v9, (int)&v12, 1);
  std::string::_Rep::_M_dispose(v8 - 12, &v5);
  std::string::_Rep::_M_dispose(v6 - 12, &v7);
  if ( v10 )
    v10((void **)&v9, (void **)&v9, 3);
  result = v13;
  if ( v13 )
    result = ((int (__cdecl *)(char *, char *, signed int))v13)(&v12, &v12, 3);
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);

//----- (080949F0) --------------------------------------------------------
int __cdecl sub_80949F0(int ***a1)
{
  int **v1; // ebp@1
  int v2; // edi@1
  int *v3; // esi@2
  int v4; // ebx@2
  int *v5; // ebx@6
  int v7; // eax@7
  int v8; // ebx@7
  int v9; // eax@8
  int *v10; // edx@9
  int v11; // eax@9
  char v12; // [sp+1Bh] [bp-41h]@6
  int v13; // [sp+1Ch] [bp-40h]@6
  int v14; // [sp+20h] [bp-3Ch]@6
  int v15; // [sp+24h] [bp-38h]@6
  int v16; // [sp+28h] [bp-34h]@6
  int v17; // [sp+2Ch] [bp-30h]@6
  char v18; // [sp+30h] [bp-2Ch]@6
  int v19; // [sp+34h] [bp-28h]@6
  int v20; // [sp+38h] [bp-24h]@6
  char v21; // [sp+3Ch] [bp-20h]@6

  v1 = *a1;
  v2 = ***a1;
  if ( !v2 )
  {
    v7 = operator new(0x1Cu);
    v8 = v7;
    if ( v7 )
    {
      *(_DWORD *)(v7 + 4) = 1;
      *(_DWORD *)(v7 + 8) = 1;
      *(_DWORD *)v7 = &off_80BD460;
      *(_DWORD *)(v7 + 12) = v7 + 16;
      *(_DWORD *)(v7 + 16) = 0;
      *(_DWORD *)(v7 + 20) = 0;
      *(_DWORD *)(v7 + 24) = 0;
      v9 = sub_80954B0(v7, (int)&off_80BD238);
    }
    else
    {
      v9 = 0;
    }
    v10 = *v1;
    *v10 = v9;
    v11 = v10[1];
    v10[1] = v8;
    if ( v11 )
      sub_8099010(v11);
    v2 = **v1;
  }
  v3 = v1[1];
  v4 = *(_DWORD *)(v2 + 4);
  if ( v4 == *(_DWORD *)(v2 + 8) )
  {
    sub_809A2E0(v2, (int)v1[1]);
  }
  else
  {
    if ( v4 )
    {
      *(_DWORD *)v4 = *v3;
      *(_DWORD *)(v4 + 4) = v3[1];
      *(_DWORD *)(v4 + 8) = v3[2];
      *(_DWORD *)(v4 + 12) = v3[3];
      v3[3] = (int)&unk_80CF83C;
      *(_DWORD *)(v4 + 16) = v3[4];
      v3[4] = (int)&unk_80CF83C;
      sub_80A6850(v4 + 20, (int)(v3 + 5));
      *(_DWORD *)(v4 + 24) = v3[6];
      v3[6] = (int)&unk_80CF83C;
      *(_DWORD *)(v4 + 28) = v3[7];
      v3[7] = (int)&unk_80CF83C;
      sub_80A6850(v4 + 32, (int)(v3 + 8));
      v4 = *(_DWORD *)(v2 + 4);
    }
    *(_DWORD *)(v2 + 4) = v4 + 36;
  }
  v13 = 0;
  v14 = 0;
  v15 = 0;
  v16 = (int)&unk_80CF83C;
  v17 = (int)&unk_80CF83C;
  sub_80A6810((int)&v18);
  v19 = (int)&unk_80CF83C;
  v20 = (int)&unk_80CF83C;
  sub_80A6810((int)&v21);
  v5 = v1[1];
  *v5 = 0;
  v5[1] = v14;
  v5[2] = v15;
  std::string::swap((std::string *)(v5 + 3), (std::string *)&v16);
  std::string::swap((std::string *)(v5 + 4), (std::string *)&v17);
  sub_80A6870((int)(v5 + 5), (int)&v18);
  std::string::swap((std::string *)(v5 + 6), (std::string *)&v19);
  std::string::swap((std::string *)(v5 + 7), (std::string *)&v20);
  sub_80A6870((int)(v5 + 8), (int)&v21);
  sub_80A6820((int *)&v21);
  std::string::_Rep::_M_dispose(v20 - 12, &v12);
  std::string::_Rep::_M_dispose(v19 - 12, &v12);
  sub_80A6820((int *)&v18);
  std::string::_Rep::_M_dispose(v17 - 12, &v12);
  return std::string::_Rep::_M_dispose(v16 - 12, &v12);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 80BD238: using guessed type void *off_80BD238;
// 80BD460: using guessed type void *off_80BD460;

//----- (08094D60) --------------------------------------------------------
int sub_8094D60()
{
  return 0;
}

//----- (08094DA0) --------------------------------------------------------
int __stdcall sub_8094DA0(int a1)
{
  int result; // eax@1

  result = a1;
  *(_DWORD *)a1 = &unk_80CF83C;
  return result;
}

//----- (08094DB0) --------------------------------------------------------
int __cdecl sub_8094DB0(int a1)
{
  int result; // eax@1
  int (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // edx@1

  result = a1;
  *(_DWORD *)a1 = &off_80BD328;
  v2 = *(int (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 12);
  if ( v2 )
    result = v2(a1 + 4, a1 + 4, 3);
  return result;
}
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);

//----- (08094DE0) --------------------------------------------------------
bool __cdecl sub_8094DE0(int a1)
{
  return *(_DWORD *)(a1 + 16696) != 0;
}

//----- (08094E10) --------------------------------------------------------
int __cdecl sub_8094E10(int a1)
{
  int result; // eax@1

  result = a1;
  if ( a1 )
    result = (*(int (**)(void))(*(_DWORD *)a1 + 4))();
  return result;
}

//----- (08094E50) --------------------------------------------------------
int sub_8094E50()
{
  return 0;
}

//----- (08094E60) --------------------------------------------------------
int __cdecl sub_8094E60(int a1)
{
  int result; // eax@1
  int v2; // edx@1

  result = a1;
  *(_BYTE *)(a1 + 100) = 1;
  v2 = *(_DWORD *)(a1 + 96);
  if ( v2 )
    *(_DWORD *)(a1 + 92) = *(_DWORD *)v2;
  return result;
}

//----- (08094E80) --------------------------------------------------------
bool __cdecl sub_8094E80(int a1)
{
  return *(_DWORD *)(a1 + 16728) != 0;
}

//----- (08094E90) --------------------------------------------------------
int __cdecl sub_8094E90(int a1)
{
  int result; // eax@1
  int v2; // edx@1

  result = a1;
  *(_BYTE *)(a1 + 16740) = 1;
  v2 = *(_DWORD *)(a1 + 16736);
  if ( v2 )
    *(_DWORD *)(a1 + 16732) = *(_DWORD *)v2;
  return result;
}

//----- (08094EC0) --------------------------------------------------------
void __cdecl sub_8094EC0(void *a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@1

  *(_DWORD *)a1 = &off_80BD328;
  v1 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 3);
  if ( v1 )
    v1((char *)a1 + 4, (char *)a1 + 4, 3);
  operator delete(a1);
}
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);

//----- (08094F00) --------------------------------------------------------
void __cdecl sub_8094F00(void *a1)
{
  *(_DWORD *)a1 = &off_80BD2F0;
  operator delete(a1);
}
// 80BD2F0: using guessed type void *off_80BD2F0;

//----- (08094F10) --------------------------------------------------------
void __cdecl sub_8094F10(void *a1)
{
  *(_DWORD *)a1 = &off_80BD2F0;
  operator delete(a1);
}
// 80BD2F0: using guessed type void *off_80BD2F0;

//----- (08094F20) --------------------------------------------------------
int __cdecl sub_8094F20(int a1)
{
  int result; // eax@1

  *(_DWORD *)a1 = &off_80BD368;
  evbuffer_free(*(struct evbuffer **)(a1 + 32));
  evbuffer_free(*(struct evbuffer **)(a1 + 36));
  *(_DWORD *)a1 = &off_80BD328;
  result = *(_DWORD *)(a1 + 12);
  if ( result )
    result = ((int (__cdecl *)(int, int, signed int))result)(a1 + 4, a1 + 4, 3);
  return result;
}
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);

//----- (08094F70) --------------------------------------------------------
int __cdecl sub_8094F70(int a1)
{
  unsigned int v1; // eax@1
  int v2; // eax@4

  (*(void (__cdecl **)(int))(*(_DWORD *)a1 + 12))(a1);
  v1 = *(_DWORD *)(a1 + 56);
  if ( v1 )
  {
    if ( v1 <= 0xFFFF )
    {
      v1 *= 2;
      *(_DWORD *)(a1 + 56) = v1;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 56) = 0x2000;
    LOWORD(v1) = 0x2000;
  }
  evbuffer_reserve_space(*(_DWORD *)(a1 + 36), v1, a1 + 40, 1);
  v2 = *(_DWORD *)(a1 + 40);
  *(_DWORD *)(a1 + 48) = v2;
  *(_DWORD *)(a1 + 52) = *(_DWORD *)(a1 + 44) + v2;
  return a1 + 48;
}
// 804CC30: using guessed type int __cdecl evbuffer_reserve_space(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (08094FE0) --------------------------------------------------------
int __cdecl sub_8094FE0(int a1)
{
  if ( *(_DWORD *)(a1 + 44) )
  {
    *(_DWORD *)(a1 + 44) = *(_DWORD *)(a1 + 48) - *(_DWORD *)(a1 + 40);
    evbuffer_commit_space(*(_DWORD *)(a1 + 36), a1 + 40, 1);
    evbuffer_add_buffer(*(struct evbuffer **)(a1 + 32), *(struct evbuffer **)(a1 + 36));
    *(_DWORD *)(a1 + 44) = 0;
  }
  return *(_DWORD *)(a1 + 32);
}
// 804CAE0: using guessed type int __cdecl evbuffer_commit_space(_DWORD, _DWORD, _DWORD);

//----- (08095040) --------------------------------------------------------
int __cdecl sub_8095040(int a1)
{
  int v1; // eax@1

  v1 = (*(int (__cdecl **)(int))(*(_DWORD *)a1 + 12))(a1);
  return evbuffer_get_length(v1);
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);

//----- (08095060) --------------------------------------------------------
std::string *__stdcall sub_8095060(std::string *a1, int a2, unsigned int a3)
{
  int v3; // esi@1
  unsigned int v4; // eax@1
  unsigned int v5; // eax@3

  v3 = (*(int (__cdecl **)(int))(*(_DWORD *)a2 + 12))(a2);
  *(_DWORD *)a1 = &unk_80CF83C;
  v4 = evbuffer_get_length(v3);
  if ( a3 && v4 > a3 )
    v4 = a3;
  std::string::resize(a1, v4, 0);
  v5 = evbuffer_copyout(v3, *(_DWORD *)a1, *(_DWORD *)(*(_DWORD *)a1 - 12));
  std::string::resize(a1, v5, 0);
  return a1;
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804D200: using guessed type int __cdecl evbuffer_copyout(_DWORD, _DWORD, _DWORD);

//----- (08095130) --------------------------------------------------------
__int64 __cdecl sub_8095130(int a1, int a2)
{
  int v2; // ebx@1
  __int64 result; // rax@1

  v2 = **(_DWORD **)a1;
  result = atoll((const char *)*(_DWORD *)a2);
  *(_DWORD *)v2 = result;
  return result;
}

//----- (08095160) --------------------------------------------------------
__int32 __cdecl sub_8095160(int a1, const char **a2)
{
  int v2; // ebx@1
  __int32 result; // eax@1

  v2 = **(_DWORD **)a1;
  result = atol(*a2);
  *(_DWORD *)v2 = result;
  return result;
}

//----- (08095190) --------------------------------------------------------
int __cdecl sub_8095190(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  const void *v4; // esi@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BCFE8;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(0xCu);
    qmemcpy(v5, v4, 0xCu);
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BCFE8: using guessed type void *off_80BCFE8;

//----- (08095230) --------------------------------------------------------
int __cdecl sub_8095230(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BD144;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BD144: using guessed type void *off_80BD144;

//----- (080952D0) --------------------------------------------------------
int __cdecl sub_80952D0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BD18C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BD18C: using guessed type void *off_80BD18C;

//----- (08095370) --------------------------------------------------------
int __cdecl sub_8095370(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BD1D0;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BD1D0: using guessed type void *off_80BD1D0;

//----- (08095410) --------------------------------------------------------
int __cdecl sub_8095410(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BD210;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BD210: using guessed type void *off_80BD210;

//----- (080954B0) --------------------------------------------------------
int __cdecl sub_80954B0(int a1, int a2)
{
  char *v2; // esi@1
  bool v3; // zf@2
  int v4; // edi@3
  signed int v5; // ecx@3
  int result; // eax@7

  v2 = *(char **)(a2 + 4);
  if ( v2 == "St19_Sp_make_shared_tag" )
    goto LABEL_11;
  v3 = *v2 == 42;
  if ( *v2 == 42 )
    goto LABEL_12;
  v4 = (int)"St19_Sp_make_shared_tag";
  v5 = 24;
  do
  {
    if ( !v5 )
      break;
    v3 = *v2++ == *(_BYTE *)v4++;
    --v5;
  }
  while ( v3 );
  if ( v3 )
LABEL_11:
    result = a1 + 16;
  else
LABEL_12:
    result = 0;
  return result;
}

//----- (080954F0) --------------------------------------------------------
int __cdecl sub_80954F0(int a1)
{
  int v1; // eax@2
  int result; // eax@2

  if ( *(_DWORD *)(a1 + 16696) )
  {
    v1 = (*(int (__cdecl **)(int))(*(_DWORD *)(a1 + 16636) + 12))(a1 + 16636);
    result = evbuffer_get_length(v1);
  }
  else
  {
    result = *(_DWORD *)(a1 + 16624) - (a1 + 88);
  }
  return result;
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);

//----- (08095530) --------------------------------------------------------
void __cdecl sub_8095530(void *a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@1

  *(_DWORD *)a1 = &off_80BD368;
  evbuffer_free(*((struct evbuffer **)a1 + 8));
  evbuffer_free(*((struct evbuffer **)a1 + 9));
  *(_DWORD *)a1 = &off_80BD328;
  v1 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 3);
  if ( v1 )
    v1((char *)a1 + 4, (char *)a1 + 4, 3);
  operator delete(a1);
}
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);

//----- (08095590) --------------------------------------------------------
int __cdecl sub_8095590(int a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@3
  int result; // eax@5

  *(_DWORD *)a1 = &off_80BD428;
  if ( *(_DWORD *)(a1 + 104) )
    EVP_MD_CTX_destroy(*(_DWORD *)(a1 + 104));
  *(_DWORD *)(a1 + 32) = &off_80BD368;
  evbuffer_free(*(struct evbuffer **)(a1 + 64));
  evbuffer_free(*(struct evbuffer **)(a1 + 68));
  *(_DWORD *)(a1 + 32) = &off_80BD328;
  v1 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 44);
  if ( v1 )
    v1(a1 + 36, a1 + 36, 3);
  *(_DWORD *)a1 = &off_80BD328;
  result = *(_DWORD *)(a1 + 12);
  if ( result )
    result = ((int (__cdecl *)(int, int, signed int))result)(a1 + 4, a1 + 4, 3);
  return result;
}
// 804CCF0: using guessed type int __cdecl EVP_MD_CTX_destroy(_DWORD);
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);
// 80BD428: using guessed type int (__cdecl *off_80BD428)(int);

//----- (08095620) --------------------------------------------------------
void __cdecl sub_8095620(void *a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@3
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@5

  *(_DWORD *)a1 = &off_80BD428;
  if ( *((_DWORD *)a1 + 26) )
    EVP_MD_CTX_destroy(*((_DWORD *)a1 + 26));
  *((_DWORD *)a1 + 8) = &off_80BD368;
  evbuffer_free(*((struct evbuffer **)a1 + 16));
  evbuffer_free(*((struct evbuffer **)a1 + 17));
  *((_DWORD *)a1 + 8) = &off_80BD328;
  v1 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 11);
  if ( v1 )
    v1((char *)a1 + 36, (char *)a1 + 36, 3);
  *(_DWORD *)a1 = &off_80BD328;
  v2 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 3);
  if ( v2 )
    v2((char *)a1 + 4, (char *)a1 + 4, 3);
  operator delete(a1);
}
// 804CCF0: using guessed type int __cdecl EVP_MD_CTX_destroy(_DWORD);
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);
// 80BD428: using guessed type int (__cdecl *off_80BD428)(int);

//----- (080956B0) --------------------------------------------------------
int __cdecl sub_80956B0(int a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@5
  int result; // eax@7

  *(_DWORD *)a1 = &off_80BD3A8;
  if ( *(_DWORD *)(a1 + 16696) )
    deflateEnd((z_streamp)(a1 + 32));
  if ( *(_DWORD *)(a1 + 16632) )
    evbuffer_free(*(struct evbuffer **)(a1 + 16632));
  *(_DWORD *)(a1 + 16636) = &off_80BD368;
  evbuffer_free(*(struct evbuffer **)(a1 + 16668));
  evbuffer_free(*(struct evbuffer **)(a1 + 16672));
  *(_DWORD *)(a1 + 16636) = &off_80BD328;
  v1 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 16648);
  if ( v1 )
    v1(a1 + 16640, a1 + 16640, 3);
  *(_DWORD *)a1 = &off_80BD328;
  result = *(_DWORD *)(a1 + 12);
  if ( result )
    result = ((int (__cdecl *)(int, int, signed int))result)(a1 + 4, a1 + 4, 3);
  return result;
}
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);
// 80BD3A8: using guessed type int (__cdecl *off_80BD3A8)(int);

//----- (08095760) --------------------------------------------------------
void __cdecl sub_8095760(int a1)
{
  int v1; // eax@1
  void *v2; // eax@1
  void *v3; // ebx@2
  int v4; // ebp@2
  void *v5; // [sp+18h] [bp-44h]@1
  void *v6; // [sp+1Ch] [bp-40h]@1
  int v7; // [sp+20h] [bp-3Ch]@2
  int v8; // [sp+24h] [bp-38h]@2
  int v9; // [sp+28h] [bp-34h]@2
  void **v10; // [sp+2Ch] [bp-30h]@1
  char v11; // [sp+3Fh] [bp-1Dh]@3

  v1 = *(_DWORD *)(a1 + 12);
  v10 = (void **)v1;
  v5 = *(void **)(v1 + 4);
  v2 = *(void **)v1;
  v6 = v2;
  if ( v5 != v2 )
  {
    v3 = v2;
    v4 = (int)((char *)v2 + 28);
    v9 = (int)((char *)v2 + 24);
    v8 = (int)((char *)v2 + 16);
    v7 = (int)((char *)v2 + 12);
    do
    {
      sub_80A6820((int *)v3 + 8);
      std::string::_Rep::_M_dispose(*(_DWORD *)((_BYTE *)v3 - (_BYTE *)v6 + v4) - 12, &v11);
      std::string::_Rep::_M_dispose(*(_DWORD *)((_BYTE *)v3 - (_BYTE *)v6 + v9) - 12, &v11);
      sub_80A6820((int *)v3 + 5);
      std::string::_Rep::_M_dispose(*(_DWORD *)((_BYTE *)v3 - (_BYTE *)v6 + v8) - 12, &v11);
      std::string::_Rep::_M_dispose(*(_DWORD *)((_BYTE *)v3 - (_BYTE *)v6 + v7) - 12, &v11);
      v3 = (char *)v3 + 36;
    }
    while ( v5 != v3 );
    v5 = *v10;
  }
  if ( v5 )
    operator delete(v5);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);

//----- (08095860) --------------------------------------------------------
void __cdecl sub_8095860(void *a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@5
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@7

  *(_DWORD *)a1 = &off_80BD3A8;
  if ( *((_DWORD *)a1 + 4174) )
    deflateEnd((z_streamp)((char *)a1 + 32));
  if ( *((_DWORD *)a1 + 4158) )
    evbuffer_free(*((struct evbuffer **)a1 + 4158));
  *((_DWORD *)a1 + 4159) = &off_80BD368;
  evbuffer_free(*((struct evbuffer **)a1 + 4167));
  evbuffer_free(*((struct evbuffer **)a1 + 4168));
  *((_DWORD *)a1 + 4159) = &off_80BD328;
  v1 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 4162);
  if ( v1 )
    v1((char *)a1 + 16640, (char *)a1 + 16640, 3);
  *(_DWORD *)a1 = &off_80BD328;
  v2 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 3);
  if ( v2 )
    v2((char *)a1 + 4, (char *)a1 + 4, 3);
  operator delete(a1);
}
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);
// 80BD3A8: using guessed type int (__cdecl *off_80BD3A8)(int);

//----- (08095920) --------------------------------------------------------
int __cdecl sub_8095920(int a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@7
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@9
  int result; // eax@11

  *(_DWORD *)a1 = &off_80BD3E8;
  if ( *(_DWORD *)(a1 + 16744) )
    EVP_MD_CTX_destroy(*(_DWORD *)(a1 + 16744));
  *(_DWORD *)(a1 + 32) = &off_80BD3A8;
  if ( *(_DWORD *)(a1 + 16728) )
    deflateEnd((z_streamp)(a1 + 64));
  if ( *(_DWORD *)(a1 + 16664) )
    evbuffer_free(*(struct evbuffer **)(a1 + 16664));
  *(_DWORD *)(a1 + 16668) = &off_80BD368;
  evbuffer_free(*(struct evbuffer **)(a1 + 16700));
  evbuffer_free(*(struct evbuffer **)(a1 + 16704));
  *(_DWORD *)(a1 + 16668) = &off_80BD328;
  v1 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 16680);
  if ( v1 )
    v1(a1 + 16672, a1 + 16672, 3);
  *(_DWORD *)(a1 + 32) = &off_80BD328;
  v2 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 44);
  if ( v2 )
    v2(a1 + 36, a1 + 36, 3);
  *(_DWORD *)a1 = &off_80BD328;
  result = *(_DWORD *)(a1 + 12);
  if ( result )
    result = ((int (__cdecl *)(int, int, signed int))result)(a1 + 4, a1 + 4, 3);
  return result;
}
// 804CCF0: using guessed type int __cdecl EVP_MD_CTX_destroy(_DWORD);
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);
// 80BD3A8: using guessed type int (__cdecl *off_80BD3A8)(int);
// 80BD3E8: using guessed type int (__cdecl *off_80BD3E8)(int);

//----- (08095A10) --------------------------------------------------------
void __cdecl sub_8095A10(void *a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, _DWORD); // eax@7
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@9
  void (__cdecl *v3)(_DWORD, _DWORD, _DWORD); // eax@11

  *(_DWORD *)a1 = &off_80BD3E8;
  if ( *((_DWORD *)a1 + 4186) )
    EVP_MD_CTX_destroy(*((_DWORD *)a1 + 4186));
  *((_DWORD *)a1 + 8) = &off_80BD3A8;
  if ( *((_DWORD *)a1 + 4182) )
    deflateEnd((z_streamp)((char *)a1 + 64));
  if ( *((_DWORD *)a1 + 4166) )
    evbuffer_free(*((struct evbuffer **)a1 + 4166));
  *((_DWORD *)a1 + 4167) = &off_80BD368;
  evbuffer_free(*((struct evbuffer **)a1 + 4175));
  evbuffer_free(*((struct evbuffer **)a1 + 4176));
  *((_DWORD *)a1 + 4167) = &off_80BD328;
  v1 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 4170);
  if ( v1 )
    v1((char *)a1 + 16672, (char *)a1 + 16672, 3);
  *((_DWORD *)a1 + 8) = &off_80BD328;
  v2 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 11);
  if ( v2 )
    v2((char *)a1 + 36, (char *)a1 + 36, 3);
  *(_DWORD *)a1 = &off_80BD328;
  v3 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 3);
  if ( v3 )
    v3((char *)a1 + 4, (char *)a1 + 4, 3);
  operator delete(a1);
}
// 804CCF0: using guessed type int __cdecl EVP_MD_CTX_destroy(_DWORD);
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);
// 80BD3A8: using guessed type int (__cdecl *off_80BD3A8)(int);
// 80BD3E8: using guessed type int (__cdecl *off_80BD3E8)(int);

//----- (08095D20) --------------------------------------------------------
int __cdecl sub_8095D20(int a1, int a2)
{
  int v2; // ebp@1
  int result; // eax@2
  int v4; // ebx@4
  int i; // eax@4
  int v6; // eax@6
  signed int v7; // eax@8
  int v8; // eax@11

  v2 = *(_DWORD *)a1;
  if ( *(_BYTE *)(*(_DWORD *)a1 + 8) )
  {
LABEL_2:
    result = 0;
  }
  else
  {
    v4 = *(_DWORD *)(v2 + 4);
    for ( i = *(_DWORD *)(v4 + 568); ; *(_DWORD *)(v4 + 568) = i )
    {
      v7 = sub_808C150(v4 + 528, (int *)(v4 + 564), i);
      if ( v7 != 4 )
        break;
      if ( !*(_DWORD *)(v4 + 8) )
      {
        std::__throw_bad_function_call();
        return sub_8095E00(a1);
      }
      v6 = (*(int (__cdecl **)(int, int))(v4 + 12))(v4, v4 + 564);
      if ( !v6 )
      {
        sub_808C0E0(v4 + 528);
        goto LABEL_14;
      }
      i = *(_DWORD *)(v4 + 564) + v6;
    }
    if ( v7 )
    {
      if ( v7 != 2 )
      {
LABEL_14:
        *(_BYTE *)(v2 + 8) = 1;
        goto LABEL_2;
      }
    }
    else
    {
      *(_BYTE *)(v2 + 8) = 1;
    }
    v8 = *(_DWORD *)(v2 + 4);
    if ( *(_DWORD *)(v8 + 536) != 2 )
      goto LABEL_2;
    *(_DWORD *)a2 = *(_DWORD *)(v8 + 540);
    result = *(_DWORD *)(*(_DWORD *)(v2 + 4) + 544);
  }
  return result;
}

//----- (08095E00) --------------------------------------------------------
int __cdecl sub_8095E00(int a1)
{
  int v1; // eax@1
  int *v2; // esi@1
  int v3; // edi@1
  int v4; // eax@3
  int result; // eax@5
  unsigned int v6; // eax@7

  v1 = *(_DWORD *)(a1 + 568);
  v2 = (int *)(a1 + 564);
  v3 = a1 + 528;
  while ( 1 )
  {
    result = sub_808C150(v3, v2, v1);
    if ( result != 4 )
      break;
    if ( !*(_DWORD *)(a1 + 8) )
    {
      std::__throw_bad_function_call();
      return sub_8095E80(a1);
    }
    v4 = (*(int (__cdecl **)(int, int *))(a1 + 12))(a1, v2);
    if ( !v4 )
    {
      LOBYTE(v6) = sub_808C0E0(v3);
      return v6 < 1 ? 3 : 1;
    }
    v1 = *(_DWORD *)(a1 + 564) + v4;
    *(_DWORD *)(a1 + 568) = v1;
  }
  return result;
}

//----- (08095E80) --------------------------------------------------------
int __cdecl sub_8095E80(int a1)
{
  int v1; // eax@1
  int result; // eax@3
  int v3; // [sp+10h] [bp-1Ch]@1
  int (__cdecl *v4)(void **, void **, signed int); // [sp+18h] [bp-14h]@1
  int (*v5)(); // [sp+1Ch] [bp-10h]@1

  v1 = operator new(4u);
  *(_DWORD *)v1 = a1;
  v3 = v1;
  v5 = sub_8094DF0;
  v4 = sub_8095410;
  *(_DWORD *)(a1 + 12) = 0;
  if ( sub_8095410 )
  {
    *(_DWORD *)(a1 + 16) = sub_8094DF0;
    *(_DWORD *)(a1 + 12) = sub_8095410;
    sub_8095410((void **)(a1 + 4), (void **)&v3, 2);
  }
  *(_DWORD *)(a1 + 20) = 0;
  sub_808C350(a1 + 24);
  result = (int)v4;
  if ( v4 )
    result = v4((void **)&v3, (void **)&v3, 3);
  *(_DWORD *)a1 = &off_80BD328;
  return result;
}
// 8094DF0: using guessed type int sub_8094DF0();
// 80BD328: using guessed type int (__cdecl *off_80BD328)(int);

//----- (08095FB0) --------------------------------------------------------
struct evbuffer *__cdecl sub_8095FB0(int a1)
{
  int v1; // eax@1
  struct evbuffer *result; // eax@5
  int v3; // [sp+10h] [bp-1Ch]@1
  int (__cdecl *v4)(void **, void **, signed int); // [sp+18h] [bp-14h]@1
  int (*v5)(); // [sp+1Ch] [bp-10h]@1

  v1 = operator new(4u);
  *(_DWORD *)v1 = a1;
  v3 = v1;
  v5 = sub_8094DF0;
  v4 = sub_8095410;
  *(_DWORD *)(a1 + 12) = 0;
  if ( sub_8095410 )
  {
    *(_DWORD *)(a1 + 16) = sub_8094DF0;
    *(_DWORD *)(a1 + 12) = sub_8095410;
    sub_8095410((void **)(a1 + 4), (void **)&v3, 2);
  }
  *(_DWORD *)(a1 + 20) = 0;
  sub_808C350(a1 + 24);
  if ( v4 )
    v4((void **)&v3, (void **)&v3, 3);
  *(_DWORD *)a1 = &off_80BD368;
  *(_DWORD *)(a1 + 32) = evbuffer_new();
  result = evbuffer_new();
  *(_DWORD *)(a1 + 36) = result;
  *(_DWORD *)(a1 + 56) = 0;
  *(_DWORD *)(a1 + 44) = 0;
  return result;
}
// 8094DF0: using guessed type int sub_8094DF0();
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);

//----- (08096130) --------------------------------------------------------
int __cdecl sub_8096130(int a1)
{
  int v1; // eax@1
  int v2; // eax@5
  int result; // eax@9
  int v4; // [sp+10h] [bp-1Ch]@1
  int (__cdecl *v5)(void **, void **, signed int); // [sp+18h] [bp-14h]@1
  int (*v6)(); // [sp+1Ch] [bp-10h]@1

  v1 = operator new(4u);
  *(_DWORD *)v1 = a1;
  v4 = v1;
  v6 = sub_8094DF0;
  v5 = sub_8095410;
  *(_DWORD *)(a1 + 12) = 0;
  if ( sub_8095410 )
  {
    *(_DWORD *)(a1 + 16) = sub_8094DF0;
    *(_DWORD *)(a1 + 12) = sub_8095410;
    sub_8095410((void **)(a1 + 4), (void **)&v4, 2);
  }
  *(_DWORD *)(a1 + 20) = 0;
  sub_808C350(a1 + 24);
  if ( v5 )
    v5((void **)&v4, (void **)&v4, 3);
  *(_DWORD *)a1 = &off_80BD3A8;
  *(_DWORD *)(a1 + 16632) = 0;
  v5 = 0;
  v2 = operator new(4u);
  *(_DWORD *)v2 = a1 + 16636;
  v4 = v2;
  v6 = sub_8094DF0;
  v5 = sub_8095410;
  *(_DWORD *)(a1 + 16648) = 0;
  if ( sub_8095410 )
  {
    *(_DWORD *)(a1 + 16652) = sub_8094DF0;
    *(_DWORD *)(a1 + 16648) = sub_8095410;
    sub_8095410((void **)(a1 + 16640), (void **)&v4, 2);
  }
  *(_DWORD *)(a1 + 16656) = 0;
  sub_808C350(a1 + 16660);
  if ( v5 )
    v5((void **)&v4, (void **)&v4, 3);
  *(_DWORD *)(a1 + 16636) = &off_80BD368;
  *(_DWORD *)(a1 + 16668) = evbuffer_new();
  *(_DWORD *)(a1 + 16672) = evbuffer_new();
  *(_DWORD *)(a1 + 16692) = 0;
  *(_DWORD *)(a1 + 16680) = 0;
  *(_DWORD *)(a1 + 16696) = 0;
  *(_DWORD *)(a1 + 16624) = a1 + 88;
  result = a1 + 16624;
  *(_DWORD *)(a1 + 16628) = a1 + 16624;
  return result;
}
// 8094DF0: using guessed type int sub_8094DF0();
// 80BD368: using guessed type int (__cdecl *off_80BD368)(int);
// 80BD3A8: using guessed type int (__cdecl *off_80BD3A8)(int);

//----- (08096450) --------------------------------------------------------
int __cdecl sub_8096450(int a1, unsigned __int8 a2)
{
  int v2; // ecx@1
  int result; // eax@1
  int v4; // ecx@2
  z_stream *v5; // edi@3
  int v6; // esi@7
  unsigned int v7; // eax@9
  int v8; // edi@16
  int v9; // eax@16
  int v10; // eax@19
  int v11; // eax@22
  int v12; // eax@22
  int v13; // [sp+38h] [bp-D0h]@16
  char v14; // [sp+3Ch] [bp-CCh]@16

  v2 = *(_DWORD *)(a1 + 16624);
  result = a1 + 88;
  if ( v2 != a1 + 88 || a2 )
  {
    *(_DWORD *)(a1 + 32) = result;
    *(_DWORD *)(a1 + 36) = v2 - result;
    v4 = *(_DWORD *)(a1 + 16696);
    if ( v4 )
    {
      v5 = (z_stream *)(a1 + 32);
    }
    else
    {
      v11 = sub_8094F70(a1 + 16636);
      *(_DWORD *)(a1 + 16696) = v11;
      v12 = *(_DWORD *)v11;
      *(_DWORD *)v12 = 559903;
      *(_DWORD *)(v12 + 4) = 0;
      **(_DWORD **)(a1 + 16696) += 8;
      *(_DWORD *)(a1 + 64) = 0;
      *(_DWORD *)(a1 + 68) = 0;
      *(_DWORD *)(a1 + 72) = 0;
      v5 = (z_stream *)(a1 + 32);
      deflateInit2_((z_streamp)(a1 + 32), 1, 8, 15, 8, 0, "1.2.8", 56);
      v4 = *(_DWORD *)(a1 + 16696);
    }
    result = *(_DWORD *)v4;
    while ( 1 )
    {
      *(_DWORD *)(a1 + 44) = result;
      *(_DWORD *)(a1 + 48) = *(_DWORD *)(v4 + 4) - *(_DWORD *)v4;
      result = deflate(v5, a2 >= 1u ? 4 : 0);
      **(_DWORD **)(a1 + 16696) = *(_DWORD *)(*(_DWORD *)(a1 + 16696) + 4) - *(_DWORD *)(a1 + 48);
      if ( *(_DWORD *)(a1 + 48) )
      {
        if ( result != -5 )
          break;
      }
      (*(void (__cdecl **)(int))(*(_DWORD *)(a1 + 16636) + 12))(a1 + 16636);
      v7 = *(_DWORD *)(a1 + 16692);
      if ( v7 )
      {
        if ( v7 <= 0xFFFF )
        {
          v7 *= 2;
          *(_DWORD *)(a1 + 16692) = v7;
        }
      }
      else
      {
        *(_DWORD *)(a1 + 16692) = 0x2000;
        LOWORD(v7) = 0x2000;
      }
      evbuffer_reserve_space(*(_DWORD *)(a1 + 16672), v7, a1 + 16676, 1);
      result = *(_DWORD *)(a1 + 16676);
      *(_DWORD *)(a1 + 16684) = result;
      *(_DWORD *)(a1 + 16688) = result + *(_DWORD *)(a1 + 16680);
      v4 = a1 + 16684;
      *(_DWORD *)(a1 + 16696) = a1 + 16684;
      if ( *(_DWORD *)(a1 + 48) )
        return result;
    }
    v6 = result;
    if ( (unsigned int)result > 1 )
    {
      if ( log_level <= 5 )
      {
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v14, 16);
        v8 = std::__ostream_insert<char,std::char_traits<char>>(
               &v14,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v8, "VERIFY failed (", 15);
        std::__ostream_insert<char,std::char_traits<char>>(v8, "res == Z_OK || res == Z_STREAM_END", 34);
        std::__ostream_insert<char,std::char_traits<char>>(v8, "): ", 3);
        std::__ostream_insert<char,std::char_traits<char>>(v8, "compression error: ", 19);
        v9 = std::ostream::operator<<(v8, v6);
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v13, v9 + 4);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v14);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v14);
        if ( byte_80CE64C )
        {
          v10 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v13, *(_DWORD *)(v13 - 12));
          std::endl<char,std::char_traits<char>>(v10);
        }
        syslog(3, "%s", v13);
        std::string::_Rep::_M_dispose(v13 - 12, &v14);
      }
      abort();
    }
  }
  return result;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CC30: using guessed type int __cdecl evbuffer_reserve_space(_DWORD, _DWORD, _DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080967F0) --------------------------------------------------------
int __cdecl sub_80967F0(int a1)
{
  int v1; // ebx@1
  int result; // eax@1

  v1 = a1;
  sub_8096450(a1, 0);
  *(_DWORD *)(v1 + 16624) = v1 + 88;
  result = a1 + 16624;
  *(_DWORD *)(v1 + 16628) = v1 + 16624;
  return result;
}

//----- (08096830) --------------------------------------------------------
int __cdecl sub_8096830(int a1)
{
  int result; // eax@3
  struct evbuffer *v2; // eax@7

  if ( *(_DWORD *)(a1 + 16696) )
  {
    sub_8096450(a1, 1u);
    if ( *(_DWORD *)(a1 + 16680) )
    {
      *(_DWORD *)(a1 + 16680) = *(_DWORD *)(a1 + 16684) - *(_DWORD *)(a1 + 16676);
      evbuffer_commit_space(*(_DWORD *)(a1 + 16672), a1 + 16676, 1);
      evbuffer_add_buffer(*(struct evbuffer **)(a1 + 16668), *(struct evbuffer **)(a1 + 16672));
      *(_DWORD *)(a1 + 16680) = 0;
    }
    result = *(_DWORD *)(a1 + 16668);
  }
  else
  {
    if ( *(_DWORD *)(a1 + 16632) )
      evbuffer_free(*(struct evbuffer **)(a1 + 16632));
    v2 = evbuffer_new();
    *(_DWORD *)(a1 + 16632) = v2;
    evbuffer_add_reference(v2, a1 + 88, *(_DWORD *)(a1 + 16624) - (a1 + 88), 0, 0);
    result = *(_DWORD *)(a1 + 16632);
  }
  return result;
}
// 804CAE0: using guessed type int __cdecl evbuffer_commit_space(_DWORD, _DWORD, _DWORD);
// 804CD80: using guessed type int __cdecl evbuffer_add_reference(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (08096930) --------------------------------------------------------
int __cdecl sub_8096930(int a1)
{
  int result; // eax@1
  int v2; // eax@2
  int v3; // edi@4
  int v4; // edx@4
  int v5; // eax@6
  int v6; // ebx@11
  int v7; // eax@12
  signed __int32 v8; // eax@15
  signed __int32 v9; // ecx@18
  char v10; // [sp+17h] [bp-D1h]@17
  int v11; // [sp+18h] [bp-D0h]@4
  int v12; // [sp+1Ch] [bp-CCh]@4
  int v13; // [sp+20h] [bp-C8h]@4
  char v14; // [sp+3Ch] [bp-ACh]@5
  int v15; // [sp+44h] [bp-A4h]@4
  int v16; // [sp+48h] [bp-A0h]@4

  *(_DWORD *)a1 = 0;
  result = EVP_MD_CTX_create();
  *(_DWORD *)a1 = result;
  if ( result )
  {
    v2 = EVP_sha1();
    result = EVP_DigestInit_ex(*(_DWORD *)a1, v2, 0) - 1;
    if ( result )
    {
      if ( log_level <= 5 )
      {
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v12, 16);
        v3 = std::__ostream_insert<char,std::char_traits<char>>(
               &v12,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v3, "Failed to initialize openssl EVP context.", 41);
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v11, v3 + 4);
        v12 = (int)&unk_80CF5DC;
        v16 = (int)&unk_80CF5F0;
        v13 = (int)&unk_80CF588;
        v4 = v15 - 12;
        if ( (_DWORD *)(v15 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v8 = _InterlockedExchangeAdd((volatile signed __int32 *)(v15 - 4), 0xFFFFFFFF);
          }
          else
          {
            v9 = *(_DWORD *)(v15 - 4);
            *(_DWORD *)(v15 - 4) = v9 - 1;
            v8 = v9;
          }
          if ( v8 <= 0 )
            std::string::_Rep::_M_destroy(v4, &v10);
        }
        v13 = (int)&unk_80CF7F0;
        std::locale::~locale((std::locale *)&v14);
        v12 = dword_80CF674;
        *(int *)((char *)&v12 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        v16 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v16);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v12);
        if ( byte_80CE64C )
        {
          v5 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v11, *(_DWORD *)(v11 - 12));
          std::endl<char,std::char_traits<char>>(v5);
        }
        syslog(3, "%s", v11);
        std::string::_Rep::_M_dispose(v11 - 12, &v12);
      }
      result = EVP_MD_CTX_destroy(*(_DWORD *)a1);
    }
  }
  else if ( log_level <= 5 )
  {
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v12, 16);
    v6 = std::__ostream_insert<char,std::char_traits<char>>(&v12, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v6, "Failed to create openssl EVP context.", 37);
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v11, v6 + 4);
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v12);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v12);
    if ( byte_80CE64C )
    {
      v7 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v11, *(_DWORD *)(v11 - 12));
      std::endl<char,std::char_traits<char>>(v7);
    }
    syslog(3, "%s", v11);
    result = std::string::_Rep::_M_dispose(v11 - 12, &v12);
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C7F0: using guessed type int EVP_MD_CTX_create(void);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CCF0: using guessed type int __cdecl EVP_MD_CTX_destroy(_DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D1C0: using guessed type int __cdecl EVP_DigestInit_ex(_DWORD, _DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D3D0: using guessed type int EVP_sha1(void);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08096C70) --------------------------------------------------------
int __cdecl sub_8096C70(int *a1, int a2, int a3)
{
  int result; // eax@1
  int v4; // esi@5
  int v5; // eax@6
  char v6; // [sp+17h] [bp-C1h]@5
  int v7; // [sp+18h] [bp-C0h]@5
  int v8; // [sp+1Ch] [bp-BCh]@5
  int v9; // [sp+20h] [bp-B8h]@5
  char v10; // [sp+3Ch] [bp-9Ch]@5
  int v11; // [sp+44h] [bp-94h]@5
  int v12; // [sp+48h] [bp-90h]@5

  result = *a1;
  if ( *a1 )
  {
    result = EVP_DigestUpdate(result, a2, a3) - 1;
    if ( result )
    {
      if ( log_level <= 5 )
      {
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v8, 16);
        v4 = std::__ostream_insert<char,std::char_traits<char>>(
               &v8,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v4, "Failed to update openssl EVP digest.", 36);
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v7, v4 + 4);
        v8 = (int)&unk_80CF5DC;
        v12 = (int)&unk_80CF5F0;
        v9 = (int)&unk_80CF588;
        std::string::_Rep::_M_dispose(v11 - 12, &v6);
        v9 = (int)&unk_80CF7F0;
        std::locale::~locale((std::locale *)&v10);
        v8 = dword_80CF674;
        *(int *)((char *)&v8 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        v12 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v12);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v8);
        if ( byte_80CE64C )
        {
          v5 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v7, *(_DWORD *)(v7 - 12));
          std::endl<char,std::char_traits<char>>(v5);
        }
        syslog(3, "%s", v7);
        result = std::string::_Rep::_M_dispose(v7 - 12, &v8);
      }
    }
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 804D450: using guessed type int __cdecl EVP_DigestUpdate(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08096E60) --------------------------------------------------------
int __cdecl sub_8096E60(int a1, int *a2)
{
  int result; // eax@1

  sub_8096C70((int *)(a1 + 104), *a2, *(_DWORD *)(*a2 - 12));
  *(_BYTE *)(a1 + 100) = 1;
  result = *(_DWORD *)(a1 + 96);
  if ( result )
  {
    result = *(_DWORD *)result;
    *(_DWORD *)(a1 + 92) = result;
  }
  return result;
}

//----- (08096EA0) --------------------------------------------------------
int __cdecl sub_8096EA0(int a1, int *a2)
{
  int result; // eax@1

  sub_8096C70((int *)(a1 + 16744), *a2, *(_DWORD *)(*a2 - 12));
  *(_BYTE *)(a1 + 16740) = 1;
  result = *(_DWORD *)(a1 + 16736);
  if ( result )
  {
    result = *(_DWORD *)result;
    *(_DWORD *)(a1 + 16732) = result;
  }
  return result;
}

//----- (08096EF0) --------------------------------------------------------
int __cdecl sub_8096EF0(int a1)
{
  int v1; // eax@2
  int v3; // eax@3

  if ( *(_BYTE *)(a1 + 100) )
  {
    v3 = *(_DWORD *)(a1 + 96);
    if ( v3 )
    {
      sub_8096C70((int *)(a1 + 104), *(_DWORD *)(a1 + 92), *(_DWORD *)v3 - *(_DWORD *)(a1 + 92));
      *(_DWORD *)(a1 + 92) = **(_DWORD **)(a1 + 96);
    }
  }
  v1 = (*(int (__cdecl **)(int))(*(_DWORD *)(a1 + 32) + 12))(a1 + 32);
  return evbuffer_get_length(v1);
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);

//----- (08096F50) --------------------------------------------------------
void __cdecl sub_8096F50(int a1)
{
  int v1; // eax@3

  if ( *(_BYTE *)(a1 + 100) && (v1 = *(_DWORD *)(a1 + 96)) != 0 )
  {
    sub_8096C70((int *)(a1 + 104), *(_DWORD *)(a1 + 92), *(_DWORD *)v1 - *(_DWORD *)(a1 + 92));
    *(_DWORD *)(a1 + 92) = **(_DWORD **)(a1 + 96);
    *(_BYTE *)(a1 + 100) = 0;
  }
  else
  {
    *(_BYTE *)(a1 + 100) = 0;
  }
}

//----- (08096FB0) --------------------------------------------------------
void __cdecl sub_8096FB0(int a1)
{
  int v1; // eax@3

  if ( *(_BYTE *)(a1 + 16740) && (v1 = *(_DWORD *)(a1 + 16736)) != 0 )
  {
    sub_8096C70((int *)(a1 + 16744), *(_DWORD *)(a1 + 16732), *(_DWORD *)v1 - *(_DWORD *)(a1 + 16732));
    *(_DWORD *)(a1 + 16732) = **(_DWORD **)(a1 + 16736);
    *(_BYTE *)(a1 + 16740) = 0;
  }
  else
  {
    *(_BYTE *)(a1 + 16740) = 0;
  }
}

//----- (08097020) --------------------------------------------------------
std::string *__stdcall sub_8097020(std::string *a1, int a2, unsigned int a3)
{
  int v3; // esi@2
  unsigned int v4; // eax@2
  unsigned int v5; // eax@4
  int v7; // eax@6

  if ( *(_BYTE *)(a2 + 100) )
  {
    v7 = *(_DWORD *)(a2 + 96);
    if ( v7 )
    {
      sub_8096C70((int *)(a2 + 104), *(_DWORD *)(a2 + 92), *(_DWORD *)v7 - *(_DWORD *)(a2 + 92));
      *(_DWORD *)(a2 + 92) = **(_DWORD **)(a2 + 96);
    }
  }
  v3 = (*(int (__cdecl **)(int))(*(_DWORD *)(a2 + 32) + 12))(a2 + 32);
  *(_DWORD *)a1 = &unk_80CF83C;
  v4 = evbuffer_get_length(v3);
  if ( a3 && v4 > a3 )
    v4 = a3;
  std::string::resize(a1, v4, 0);
  v5 = evbuffer_copyout(v3, *(_DWORD *)a1, *(_DWORD *)(*(_DWORD *)a1 - 12));
  std::string::resize(a1, v5, 0);
  return a1;
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804D200: using guessed type int __cdecl evbuffer_copyout(_DWORD, _DWORD, _DWORD);

//----- (08097120) --------------------------------------------------------
int __cdecl sub_8097120(int a1)
{
  int v2; // eax@5

  if ( *(_BYTE *)(a1 + 100) )
  {
    v2 = *(_DWORD *)(a1 + 96);
    if ( v2 )
    {
      sub_8096C70((int *)(a1 + 104), *(_DWORD *)(a1 + 92), *(_DWORD *)v2 - *(_DWORD *)(a1 + 92));
      *(_DWORD *)(a1 + 92) = **(_DWORD **)(a1 + 96);
    }
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    *(_DWORD *)(a1 + 76) = *(_DWORD *)(a1 + 80) - *(_DWORD *)(a1 + 72);
    evbuffer_commit_space(*(_DWORD *)(a1 + 68), a1 + 72, 1);
    evbuffer_add_buffer(*(struct evbuffer **)(a1 + 64), *(struct evbuffer **)(a1 + 68));
    *(_DWORD *)(a1 + 76) = 0;
  }
  return *(_DWORD *)(a1 + 64);
}
// 804CAE0: using guessed type int __cdecl evbuffer_commit_space(_DWORD, _DWORD, _DWORD);

//----- (080971B0) --------------------------------------------------------
int __cdecl sub_80971B0(int a1)
{
  unsigned int v1; // eax@2
  int v2; // edx@5
  int result; // eax@5
  int v4; // eax@7

  if ( *(_BYTE *)(a1 + 100) )
  {
    v4 = *(_DWORD *)(a1 + 96);
    if ( v4 )
    {
      sub_8096C70((int *)(a1 + 104), *(_DWORD *)(a1 + 92), *(_DWORD *)v4 - *(_DWORD *)(a1 + 92));
      *(_DWORD *)(a1 + 92) = **(_DWORD **)(a1 + 96);
    }
  }
  (*(void (__cdecl **)(int))(*(_DWORD *)(a1 + 32) + 12))(a1 + 32);
  v1 = *(_DWORD *)(a1 + 88);
  if ( v1 )
  {
    if ( v1 <= 0xFFFF )
    {
      v1 *= 2;
      *(_DWORD *)(a1 + 88) = v1;
    }
  }
  else
  {
    *(_DWORD *)(a1 + 88) = 0x2000;
    LOWORD(v1) = 0x2000;
  }
  evbuffer_reserve_space(*(_DWORD *)(a1 + 68), v1, a1 + 72, 1);
  v2 = *(_DWORD *)(a1 + 72);
  *(_DWORD *)(a1 + 80) = v2;
  *(_DWORD *)(a1 + 84) = v2 + *(_DWORD *)(a1 + 76);
  result = a1 + 80;
  *(_DWORD *)(a1 + 96) = a1 + 80;
  *(_DWORD *)(a1 + 92) = v2;
  return result;
}
// 804CC30: using guessed type int __cdecl evbuffer_reserve_space(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (08097260) --------------------------------------------------------
int __cdecl sub_8097260(int a1)
{
  int result; // eax@2
  int v2; // eax@3

  if ( *(_BYTE *)(a1 + 16740) )
  {
    v2 = *(_DWORD *)(a1 + 16736);
    if ( v2 )
    {
      sub_8096C70((int *)(a1 + 16744), *(_DWORD *)(a1 + 16732), *(_DWORD *)v2 - *(_DWORD *)(a1 + 16732));
      *(_DWORD *)(a1 + 16732) = **(_DWORD **)(a1 + 16736);
    }
  }
  sub_8096450(a1 + 32, 0);
  *(_DWORD *)(a1 + 16656) = a1 + 120;
  result = a1 + 16656;
  *(_DWORD *)(a1 + 16660) = a1 + 16656;
  *(_DWORD *)(a1 + 16736) = a1 + 16656;
  *(_DWORD *)(a1 + 16732) = a1 + 120;
  return result;
}

//----- (080972F0) --------------------------------------------------------
int __cdecl sub_80972F0(int a1)
{
  int result; // eax@4
  struct evbuffer *v2; // eax@8
  int v3; // eax@9

  if ( *(_BYTE *)(a1 + 16740) )
  {
    v3 = *(_DWORD *)(a1 + 16736);
    if ( v3 )
    {
      sub_8096C70((int *)(a1 + 16744), *(_DWORD *)(a1 + 16732), *(_DWORD *)v3 - *(_DWORD *)(a1 + 16732));
      *(_DWORD *)(a1 + 16732) = **(_DWORD **)(a1 + 16736);
    }
  }
  if ( *(_DWORD *)(a1 + 16728) )
  {
    sub_8096450(a1 + 32, 1u);
    if ( *(_DWORD *)(a1 + 16712) )
    {
      *(_DWORD *)(a1 + 16712) = *(_DWORD *)(a1 + 16716) - *(_DWORD *)(a1 + 16708);
      evbuffer_commit_space(*(_DWORD *)(a1 + 16704), a1 + 16708, 1);
      evbuffer_add_buffer(*(struct evbuffer **)(a1 + 16700), *(struct evbuffer **)(a1 + 16704));
      *(_DWORD *)(a1 + 16712) = 0;
    }
    result = *(_DWORD *)(a1 + 16700);
  }
  else
  {
    if ( *(_DWORD *)(a1 + 16664) )
      evbuffer_free(*(struct evbuffer **)(a1 + 16664));
    v2 = evbuffer_new();
    *(_DWORD *)(a1 + 16664) = v2;
    evbuffer_add_reference(v2, a1 + 120, *(_DWORD *)(a1 + 16656) - (a1 + 120), 0, 0);
    result = *(_DWORD *)(a1 + 16664);
  }
  return result;
}
// 804CAE0: using guessed type int __cdecl evbuffer_commit_space(_DWORD, _DWORD, _DWORD);
// 804CD80: using guessed type int __cdecl evbuffer_add_reference(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (08097450) --------------------------------------------------------
int __cdecl sub_8097450(int a1)
{
  int v1; // eax@3
  int result; // eax@3
  int v3; // eax@5

  if ( *(_BYTE *)(a1 + 16740) )
  {
    v3 = *(_DWORD *)(a1 + 16736);
    if ( v3 )
    {
      sub_8096C70((int *)(a1 + 16744), *(_DWORD *)(a1 + 16732), *(_DWORD *)v3 - *(_DWORD *)(a1 + 16732));
      *(_DWORD *)(a1 + 16732) = **(_DWORD **)(a1 + 16736);
    }
  }
  if ( *(_DWORD *)(a1 + 16728) )
  {
    v1 = (*(int (__cdecl **)(int))(*(_DWORD *)(a1 + 16668) + 12))(a1 + 16668);
    result = evbuffer_get_length(v1);
  }
  else
  {
    result = *(_DWORD *)(a1 + 16656) - (a1 + 120);
  }
  return result;
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);

//----- (080974E0) --------------------------------------------------------
std::string *__stdcall sub_80974E0(std::string *a1, int a2)
{
  int v2; // eax@1
  std::string *result; // eax@4
  int v4; // esi@5
  int v5; // eax@6
  int v6; // edx@8
  char *v7; // edi@8
  char v8; // al@11
  unsigned int v9; // edi@13
  int v10; // eax@14
  int v11; // esi@18
  int v12; // [sp+18h] [bp-130h]@9
  char v13; // [sp+2Bh] [bp-11Dh]@15
  unsigned int v14; // [sp+2Ch] [bp-11Ch]@2
  int v15; // [sp+30h] [bp-118h]@5
  char v16[64]; // [sp+34h] [bp-114h]@2
  int v17; // [sp+74h] [bp-D4h]@5
  int v18; // [sp+78h] [bp-D0h]@8
  int v19; // [sp+7Ch] [bp-CCh]@8
  int v20; // [sp+80h] [bp-C8h]@8
  int v21; // [sp+84h] [bp-C4h]@8
  int v22; // [sp+88h] [bp-C0h]@8
  int v23; // [sp+8Ch] [bp-BCh]@8
  int v24; // [sp+90h] [bp-B8h]@8
  int v25; // [sp+94h] [bp-B4h]@8
  int v26; // [sp+98h] [bp-B0h]@8
  char v27; // [sp+9Ch] [bp-ACh]@8
  int v28; // [sp+A0h] [bp-A8h]@8
  int v29; // [sp+A4h] [bp-A4h]@8
  int v30; // [sp+A8h] [bp-A0h]@8
  int v31; // [sp+118h] [bp-30h]@8
  char v32; // [sp+11Ch] [bp-2Ch]@8
  char v33; // [sp+11Dh] [bp-2Bh]@8
  int v34; // [sp+120h] [bp-28h]@8
  int v35; // [sp+124h] [bp-24h]@8
  int v36; // [sp+128h] [bp-20h]@8
  int v37; // [sp+12Ch] [bp-1Ch]@8

  *(_DWORD *)a1 = &unk_80CF83C;
  v2 = *(_DWORD *)a2;
  if ( !*(_DWORD *)a2 )
    return a1;
  v14 = 64;
  if ( EVP_DigestFinal_ex(v2, v16, &v14) == 1 )
  {
    std::ios_base::ios_base((std::ios_base *)&v30);
    v30 = (int)&unk_80CF5C8;
    v31 = 0;
    v32 = 0;
    v33 = 0;
    v34 = 0;
    v35 = 0;
    v36 = 0;
    v37 = 0;
    v17 = dword_80CF610;
    *(int *)((char *)&v17 + *(_DWORD *)(dword_80CF610 - 12)) = dword_80CF614;
    v18 = 0;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v17 + *(_DWORD *)(v17 - 12), 0);
    v19 = dword_80CF618;
    *(int *)((char *)&v19 + *(_DWORD *)(dword_80CF618 - 12)) = dword_80CF61C;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v19 + *(_DWORD *)(v19 - 12), 0);
    v17 = dword_80CF60C;
    *(int *)((char *)&v17 + *(_DWORD *)(dword_80CF60C - 12)) = dword_80CF620;
    v17 = (int)&unk_80CF54C;
    v30 = (int)&unk_80CF574;
    v19 = (int)&unk_80CF560;
    v20 = (int)&unk_80CF7F0;
    v21 = 0;
    v22 = 0;
    v23 = 0;
    v24 = 0;
    v25 = 0;
    v26 = 0;
    std::locale::locale((std::locale *)&v27);
    v20 = (int)&unk_80CF588;
    v28 = 24;
    v29 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v30, &v20);
    v6 = v19;
    *(int *)((char *)&v19 + *(_DWORD *)(v19 - 12) + 12) = *(int *)((char *)&v19 + *(_DWORD *)(v19 - 12) + 12) & 0xFFFFFFB5 | 8;
    v7 = (char *)&v19 + *(_DWORD *)(v6 - 12);
    if ( !v7[117] )
    {
      v12 = *((_DWORD *)v7 + 31);
      if ( !v12 )
      {
        v11 = std::__throw_bad_cast();
        std::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_stringstream(&v17);
        std::string::_Rep::_M_dispose(*(_DWORD *)a1 - 12, v16);
        Unwind_Resume(v11);
      }
      if ( *(_BYTE *)(v12 + 28) )
      {
        v8 = *(_BYTE *)(v12 + 61);
      }
      else
      {
        std::ctype<char>::_M_widen_init(v12);
        v8 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v12 + 24))(v12, 32);
      }
      v7[116] = v8;
      v7[117] = 1;
    }
    v7[116] = 48;
    v9 = 0;
    if ( v14 )
    {
      do
      {
        v10 = (unsigned __int8)v16[v9];
        *(int *)((char *)&v21 + *(_DWORD *)(v19 - 12)) = 2;
        std::ostream::_M_insert<unsigned long>(&v19, v10);
        ++v9;
      }
      while ( v14 > v9 );
    }
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v15, &v20);
    std::string::swap(a1, (std::string *)&v15);
    std::string::_Rep::_M_dispose(v15 - 12, &v13);
    v17 = (int)&unk_80CF54C;
    v30 = (int)&unk_80CF574;
    v19 = (int)&unk_80CF560;
    v20 = (int)&unk_80CF588;
    std::string::_Rep::_M_dispose(v29 - 12, &v15);
    v20 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v27);
    v17 = dword_80CF60C;
    *(int *)((char *)&v17 + *(_DWORD *)(dword_80CF60C - 12)) = dword_80CF620;
    v19 = dword_80CF618;
    *(int *)((char *)&v19 + *(_DWORD *)(dword_80CF618 - 12)) = dword_80CF61C;
    v17 = dword_80CF610;
    *(int *)((char *)&v17 + *(_DWORD *)(dword_80CF610 - 12)) = dword_80CF614;
    v18 = 0;
    v30 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v30);
    result = a1;
  }
  else
  {
    if ( log_level > 5 )
      return a1;
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v17, 16);
    v4 = std::__ostream_insert<char,std::char_traits<char>>(&v17, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v4, "Failed to retrieve openssl EVP digest.", 38);
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v15, v4 + 4);
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v17);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v17);
    if ( byte_80CE64C )
    {
      v5 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v15, *(_DWORD *)(v15 - 12));
      std::endl<char,std::char_traits<char>>(v5);
    }
    syslog(3, "%s", v15);
    std::string::_Rep::_M_dispose(v15 - 12, &v17);
    result = a1;
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1D0: using guessed type int __cdecl EVP_DigestFinal_ex(_DWORD, _DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D240: using guessed type int __cdecl std::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_stringstream(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF60C: using guessed type int dword_80CF60C;
// 80CF610: using guessed type int dword_80CF610;
// 80CF614: using guessed type int dword_80CF614;
// 80CF618: using guessed type int dword_80CF618;
// 80CF61C: using guessed type int dword_80CF61C;
// 80CF620: using guessed type int dword_80CF620;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80974E0: using guessed type char var_114[64];

//----- (08097AD0) --------------------------------------------------------
std::string *__stdcall sub_8097AD0(std::string *a1, int a2, int *a3)
{
  int v3; // esi@2
  int v5; // eax@4

  if ( *(_BYTE *)(a2 + 100) && (v5 = *(_DWORD *)(a2 + 96)) != 0 )
  {
    v3 = a2 + 104;
    sub_8096C70((int *)(a2 + 104), *(_DWORD *)(a2 + 92), *(_DWORD *)v5 - *(_DWORD *)(a2 + 92));
    *(_DWORD *)(a2 + 92) = **(_DWORD **)(a2 + 96);
  }
  else
  {
    v3 = a2 + 104;
  }
  sub_8096C70((int *)v3, *a3, *(_DWORD *)(*a3 - 12));
  sub_80974E0(a1, v3);
  return a1;
}

//----- (08097B50) --------------------------------------------------------
std::string *__stdcall sub_8097B50(std::string *a1, int a2, int *a3)
{
  int v3; // esi@2
  int v5; // eax@4

  if ( *(_BYTE *)(a2 + 16740) && (v5 = *(_DWORD *)(a2 + 16736)) != 0 )
  {
    v3 = a2 + 16744;
    sub_8096C70((int *)(a2 + 16744), *(_DWORD *)(a2 + 16732), *(_DWORD *)v5 - *(_DWORD *)(a2 + 16732));
    *(_DWORD *)(a2 + 16732) = **(_DWORD **)(a2 + 16736);
  }
  else
  {
    v3 = a2 + 16744;
  }
  sub_8096C70((int *)v3, *a3, *(_DWORD *)(*a3 - 12));
  sub_80974E0(a1, v3);
  return a1;
}

//----- (08097BE0) --------------------------------------------------------
int __cdecl sub_8097BE0(int a1)
{
  char v2; // [sp+1Fh] [bp-Dh]@1

  sub_80A6820((int *)(a1 + 32));
  std::string::_Rep::_M_dispose(*(_DWORD *)(a1 + 28) - 12, &v2);
  std::string::_Rep::_M_dispose(*(_DWORD *)(a1 + 24) - 12, &v2);
  sub_80A6820((int *)(a1 + 20));
  std::string::_Rep::_M_dispose(*(_DWORD *)(a1 + 16) - 12, &v2);
  return std::string::_Rep::_M_dispose(*(_DWORD *)(a1 + 12) - 12, &v2);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);

//----- (08097C60) --------------------------------------------------------
int __cdecl sub_8097C60(void *a1, int a2, char a3)
{
  int v3; // ebx@1
  int *v4; // edi@1
  int i; // eax@2
  int v6; // eax@4
  signed int v7; // eax@6
  signed int v8; // esi@6
  int v9; // edi@13
  int v10; // eax@13
  int v11; // eax@13
  int v12; // eax@13
  int v13; // eax@13
  int v14; // eax@14
  int v15; // eax@20
  size_t v16; // esi@21
  int v17; // ebx@21
  const void *v18; // eax@23
  size_t v19; // edi@23
  size_t v20; // ecx@23
  int v21; // eax@25
  unsigned int v22; // eax@37
  signed int v23; // eax@40
  signed int v24; // ST40_4@41
  int v26; // eax@47
  int *v27; // [sp+1Ch] [bp-FCh]@21
  unsigned int v28; // [sp+24h] [bp-F4h]@21
  char *v29; // [sp+2Ch] [bp-ECh]@21
  const void *s2; // [sp+30h] [bp-E8h]@21
  int v31; // [sp+34h] [bp-E4h]@1
  signed int v32; // [sp+38h] [bp-E0h]@7
  int v33; // [sp+3Ch] [bp-DCh]@1
  int v34; // [sp+3Ch] [bp-DCh]@48
  int v35; // [sp+44h] [bp-D4h]@1
  int v36; // [sp+48h] [bp-D0h]@13
  char v37; // [sp+4Ch] [bp-CCh]@13
  int v38; // [sp+124h] [bp+Ch]@21

  v3 = a2;
  *((_DWORD *)a1 + 10) = a2;
  v35 = (int)&unk_80CF83C;
  v4 = (int *)(a2 + 564);
  v33 = a2 + 528;
  v31 = 0;
  while ( 2 )
  {
    for ( i = *(_DWORD *)(v3 + 568); ; *(_DWORD *)(v3 + 568) = i )
    {
      v7 = sub_808C150(v33, v4, i);
      v8 = v7;
      if ( v7 != 4 )
        break;
      if ( !*(_DWORD *)(v3 + 8) )
      {
        v26 = std::__throw_bad_function_call();
LABEL_48:
        v34 = v26;
        std::string::_Rep::_M_dispose(v35 - 12, &v36);
        Unwind_Resume(v34);
      }
      v6 = (*(int (__cdecl **)(int, int *))(v3 + 12))(v3, v4);
      if ( !v6 )
      {
        LOBYTE(v22) = sub_808C0E0(v33);
        v32 = v22 < 1 ? 3 : 1;
        goto LABEL_11;
      }
      i = *(_DWORD *)(v3 + 564) + v6;
    }
    v32 = v7;
    if ( v7 && v7 != 2 )
    {
LABEL_11:
      *((_DWORD *)a1 + 10) = 0;
      if ( !sub_808C100(v33, v32) )
      {
        if ( log_level <= 5 )
        {
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v37, 16);
          v9 = std::__ostream_insert<char,std::char_traits<char>>(
                 &v37,
                 &unk_80CF83C,
                 std::string::_Rep::_S_empty_rep_storage);
          std::__ostream_insert<char,std::char_traits<char>>(v9, "VERIFY failed (", 15);
          v10 = std::operator<<<std::char_traits<char>>(v9, "parser->done(res)");
          v11 = std::operator<<<std::char_traits<char>>(v10, "): ");
          v12 = std::operator<<<std::char_traits<char>>(v11, "Parse error: ");
          v13 = std::ostream::operator<<(v12, v32);
          std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v36, v13 + 4);
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v37);
          std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v37);
          if ( byte_80CE64C )
          {
            v14 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v36, *(_DWORD *)(v36 - 12));
            std::endl<char,std::char_traits<char>>(v14);
          }
          syslog(3, "%s", v36);
          std::string::_Rep::_M_dispose(v36 - 12, &v37);
        }
        abort();
      }
      if ( *((_DWORD *)a1 + 2) )
        sub_8057D90(a1);
      v23 = v32;
      goto LABEL_41;
    }
    switch ( *(_DWORD *)(v3 + 536) )
    {
      case 4:
      case 6:
        ++v31;
        goto LABEL_10;
      case 3:
        if ( v31 && !a3 )
          goto LABEL_10;
        std::string::append((std::string *)&v35, *(const char **)(v3 + 540), *(_DWORD *)(v3 + 544));
        if ( v8 )
          continue;
        v15 = v35;
        if ( !*((_DWORD *)a1 + 6) )
          goto LABEL_33;
        s2 = (const void *)v35;
        v28 = *(_DWORD *)(v35 - 12);
        v29 = (char *)a1 + 20;
        v27 = v4;
        v16 = *(_DWORD *)(v35 - 12);
        v38 = v3;
        v17 = *((_DWORD *)a1 + 6);
        do
        {
          while ( 1 )
          {
            v18 = *(const void **)(v17 + 16);
            v19 = *((_DWORD *)v18 - 3);
            v20 = v19;
            if ( v19 > v16 )
              v20 = v16;
            v21 = memcmp(v18, s2, v20);
            if ( !v21 )
              v21 = v19 - v16;
            if ( v21 < 0 )
              break;
            v29 = (char *)v17;
            v17 = *(_DWORD *)(v17 + 8);
            if ( !v17 )
              goto LABEL_29;
          }
          v17 = *(_DWORD *)(v17 + 12);
        }
        while ( v17 );
LABEL_29:
        v4 = v27;
        v3 = v38;
        if ( v29 == (char *)a1 + 20 || std::string::compare((std::string *)&v35, (const std::string *)(v29 + 16)) < 0 )
          goto LABEL_34;
        if ( !*((_DWORD *)v29 + 8) )
        {
          v26 = std::__throw_bad_function_call();
          goto LABEL_48;
        }
        v32 = (*((int (__cdecl **)(int))v29 + 9))(v29 + 24);
        v15 = v35;
LABEL_33:
        v28 = *(_DWORD *)(v15 - 12);
LABEL_34:
        std::string::_M_mutate((std::string *)&v35, 0, v28, 0);
        goto LABEL_10;
      case 5:
      case 7:
        if ( v31 )
        {
          --v31;
LABEL_10:
          if ( v32 )
            goto LABEL_11;
          continue;
        }
        if ( *((_DWORD *)a1 + 2) )
          sub_8057D90(a1);
        v23 = 0;
LABEL_41:
        v24 = v23;
        std::string::_Rep::_M_dispose(v35 - 12, &v37);
        return v24;
      default:
        continue;
    }
  }
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C9B0: using guessed type int __cdecl std::operator<<<std::char_traits<char>>(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080981A0) --------------------------------------------------------
int __cdecl sub_80981A0(void *a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // eax@3
  int v5; // eax@7
  signed int v6; // eax@9
  int v7; // ebx@13
  unsigned int v9; // eax@17
  int v10; // ebx@22
  int v11; // [sp+14h] [bp-258h]@1
  int (__cdecl *v12)(void **, void **, signed int); // [sp+1Ch] [bp-250h]@1
  int (*v13)(); // [sp+20h] [bp-24Ch]@1
  int v14; // [sp+24h] [bp-248h]@2
  int (__cdecl *v15)(void **, void **, signed int); // [sp+2Ch] [bp-240h]@1
  int (*v16)(); // [sp+30h] [bp-23Ch]@2
  char v17; // [sp+34h] [bp-238h]@3
  char v18; // [sp+234h] [bp-38h]@3
  int v19; // [sp+23Ch] [bp-30h]@11
  void *v20; // [sp+240h] [bp-2Ch]@19
  int v21; // [sp+244h] [bp-28h]@18
  int v22; // [sp+258h] [bp-14h]@3
  int v23; // [sp+25Ch] [bp-10h]@3

  v3 = operator new(0xCu);
  *(_DWORD *)v3 = a2;
  *(_DWORD *)(v3 + 4) = a3;
  *(_BYTE *)(v3 + 8) = 0;
  v11 = v3;
  v13 = sub_805E7E0;
  v12 = sub_805E8C0;
  v15 = 0;
  if ( sub_805E8C0 )
  {
    v16 = sub_805E7E0;
    v15 = sub_805E8C0;
    sub_805E8C0((void **)&v14, (void **)&v11, 2);
  }
  sub_808C080((int)&v18, (int)&v17, 512);
  v23 = 0;
  v22 = 0;
  v4 = (int)v12;
  if ( v12 )
  {
    v12((void **)&v11, (void **)&v11, 3);
    v4 = v23;
  }
  while ( 1 )
  {
    v6 = sub_808C150((int)&v18, &v22, v4);
    if ( v6 != 4 )
      break;
    if ( !v15 )
    {
      v10 = std::__throw_bad_function_call();
      if ( v15 )
        v15((void **)&v14, (void **)&v14, 3);
      Unwind_Resume(v10);
    }
    v5 = ((int (__cdecl *)(int *, int *))v16)(&v14, &v22);
    if ( !v5 )
    {
      LOBYTE(v9) = sub_808C0E0((int)&v18);
      v7 = v9 < 1 ? 3 : 1;
      goto LABEL_14;
    }
    v4 = v22 + v5;
    v23 = v4;
  }
  if ( !v6 )
  {
    if ( v19 != 4 )
    {
      if ( v19 != 1 || v21 != 4 )
        v7 = 3;
      else
        v7 = (unsigned int)memcmp(v20, "null", 4u) >= 1 ? 3 : 0;
      goto LABEL_14;
    }
    v6 = sub_8097C60(a1, (int)&v14, 0);
  }
  v7 = v6;
LABEL_14:
  if ( v15 )
    v15((void **)&v14, (void **)&v14, 3);
  return v7;
}
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 805E7E0: using guessed type int sub_805E7E0();

//----- (08098450) --------------------------------------------------------
int __cdecl sub_8098450(void *a1, int a2)
{
  int v2; // eax@1
  int result; // eax@2
  int v4; // ebx@5
  int v5; // eax@9
  int v6; // eax@10
  char v7; // [sp+17h] [bp-D1h]@5
  int v8; // [sp+18h] [bp-D0h]@5
  int v9; // [sp+1Ch] [bp-CCh]@5
  int v10; // [sp+20h] [bp-C8h]@5
  char v11; // [sp+3Ch] [bp-ACh]@5
  int v12; // [sp+44h] [bp-A4h]@5
  int v13; // [sp+48h] [bp-A0h]@5

  v2 = *((_DWORD *)a1 + 4);
  if ( !v2 )
  {
    sub_8067E80(a1);
    *((_DWORD *)a1 + 4) = v2;
  }
  result = sub_808C370((int)((char *)a1 + 20), a2, v2, *(_DWORD *)(v2 + 4));
  if ( result == 4 )
  {
    sub_8067E80(a1);
    *((_DWORD *)a1 + 4) = v6;
    result = sub_808C370((int)((char *)a1 + 20), a2, v6, *(_DWORD *)(v6 + 4));
  }
  if ( result )
  {
    if ( log_level <= 5 )
    {
      std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v9, 16);
      v4 = std::__ostream_insert<char,std::char_traits<char>>(
             &v9,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v4, "VERIFY failed (", 15);
      std::__ostream_insert<char,std::char_traits<char>>(v4, "res == JSTN_STATUS_SUCCESS", 26);
      std::__ostream_insert<char,std::char_traits<char>>(v4, "): ", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v4, "Could not write token", 21);
      std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v8, v4 + 4);
      v9 = (int)&unk_80CF5DC;
      v13 = (int)&unk_80CF5F0;
      v10 = (int)&unk_80CF588;
      std::string::_Rep::_M_dispose(v12 - 12, &v7);
      v10 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v11);
      v9 = dword_80CF674;
      *(int *)((char *)&v9 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v13 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v13);
      std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v9);
      if ( byte_80CE64C )
      {
        v5 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v8, *(_DWORD *)(v8 - 12));
        std::endl<char,std::char_traits<char>>(v5);
      }
      syslog(3, "%s", v8);
      std::string::_Rep::_M_dispose(v8 - 12, &v9);
    }
    abort();
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (08098700) --------------------------------------------------------
int __cdecl sub_8098700(int a1, int a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a1 + 8) )
  {
    result = (*(int (**)(void))(a1 + 12))();
  }
  else
  {
    std::__throw_bad_function_call();
    result = sub_8098730(a1, a2);
  }
  return result;
}

//----- (08098730) --------------------------------------------------------
int __cdecl sub_8098730(int a1, int a2)
{
  int result; // eax@1

  result = a2;
  *(_DWORD *)(a1 + 8) = 0;
  if ( *(_DWORD *)(a2 + 8) )
  {
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
    result = (*(int (__cdecl **)(int, int, signed int))(a2 + 8))(a1, a2, 2);
  }
  return result;
}

//----- (08098980) --------------------------------------------------------
int __cdecl sub_8098980(int a1, int a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a1 + 8) )
  {
    result = (*(int (**)(void))(a1 + 12))();
  }
  else
  {
    std::__throw_bad_function_call();
    result = sub_80989B0(a1);
  }
  return result;
}

//----- (080989B0) --------------------------------------------------------
int __cdecl sub_80989B0(int a1)
{
  int v1; // ebp@1
  int result; // eax@1
  int v3; // edx@2
  int v4; // eax@2
  int v5; // ebx@6
  int i; // eax@7
  int v7; // eax@9
  signed int v8; // eax@11
  unsigned int v9; // eax@14
  signed int v10; // ST1C_4@15
  int v11; // ebx@18
  signed int v12; // eax@21
  unsigned int v13; // edx@26
  const char *v14; // eax@28
  const char *v15; // esi@30
  char v16; // [sp+2Bh] [bp-21h]@15
  int v17; // [sp+2Ch] [bp-20h]@6

  v1 = *(_DWORD *)a1;
  result = sub_8095E00(*(_DWORD *)(**(_DWORD **)a1 + 40));
  if ( result )
    return result;
  v3 = *(_DWORD *)(*(_DWORD *)v1 + 40);
  v4 = *(_DWORD *)(v3 + 536);
  if ( v4 == 6 )
  {
    v17 = (int)&unk_80CF83C;
    v5 = *(_DWORD *)(*(_DWORD *)v1 + 40);
    while ( 1 )
    {
      for ( i = *(_DWORD *)(v5 + 568); ; *(_DWORD *)(v5 + 568) = i )
      {
        v8 = sub_808C150(v5 + 528, (int *)(v5 + 564), i);
        if ( v8 != 4 )
          break;
        if ( !*(_DWORD *)(v5 + 8) )
        {
          v11 = std::__throw_bad_function_call();
          std::string::_Rep::_M_dispose(v17 - 12, &v16);
          Unwind_Resume(v11);
        }
        v7 = (*(int (__cdecl **)(int, int))(v5 + 12))(v5, v5 + 564);
        if ( !v7 )
        {
          LOBYTE(v9) = sub_808C0E0(v5 + 528);
          v8 = v9 < 1 ? 3 : 1;
          goto LABEL_15;
        }
        i = *(_DWORD *)(v5 + 564) + v7;
      }
      if ( v8 == 2 )
      {
        std::string::append(
          (std::string *)&v17,
          *(const char **)(*(_DWORD *)(*(_DWORD *)v1 + 40) + 540),
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)v1 + 40) + 544));
        v5 = *(_DWORD *)(*(_DWORD *)v1 + 40);
        continue;
      }
      if ( v8 )
      {
LABEL_15:
        v10 = v8;
        std::string::_Rep::_M_dispose(v17 - 12, &v16);
        return v10;
      }
      v5 = *(_DWORD *)(*(_DWORD *)v1 + 40);
      v12 = *(_DWORD *)(v5 + 536);
      if ( v12 < 1 )
        goto LABEL_25;
      if ( v12 > 2 )
      {
        if ( v12 == 7 )
        {
          v8 = 0;
          goto LABEL_15;
        }
LABEL_25:
        v8 = 3;
        goto LABEL_15;
      }
      v13 = *(_DWORD *)(v5 + 544);
      if ( v12 == 2 || v13 != 4 )
        break;
      v15 = *(const char **)(v5 + 540);
      if ( memcmp(*(const void **)(v5 + 540), "null", 4u) )
      {
        v14 = v15;
        v13 = 4;
LABEL_29:
        std::string::append((std::string *)&v17, v14, v13);
        sub_8098980(v1 + 4, (int)&v17);
        std::string::_M_mutate((std::string *)&v17, 0, *(_DWORD *)(v17 - 12), 0);
        v5 = *(_DWORD *)(*(_DWORD *)v1 + 40);
      }
    }
    v14 = *(const char **)(v5 + 540);
    goto LABEL_29;
  }
  if ( v4 != 1 || *(_DWORD *)(v3 + 544) != 4 )
    result = 3;
  else
    result = (unsigned int)memcmp(*(const void **)(v3 + 540), "null", 4u) >= 1 ? 3 : 0;
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);

//----- (08098D10) --------------------------------------------------------
int __stdcall sub_8098D10(int a1)
{
  int v1; // eax@1
  int v2; // esi@1
  int v3; // edx@1
  int v5; // [sp+8h] [bp-10h]@1
  int v6; // [sp+Ch] [bp-Ch]@1

  v1 = operator new(0x68u);
  v2 = v1;
  *(_DWORD *)(v1 + 4) = 0;
  *(_DWORD *)v1 = &off_80BD310;
  *(_DWORD *)(v1 + 8) = 0;
  *(_DWORD *)(v1 + 12) = &unk_80CF83C;
  *(_DWORD *)(v1 + 16) = 0;
  *(_DWORD *)(v1 + 20) = 0;
  *(_DWORD *)(v1 + 24) = &unk_80CF83C;
  *(_DWORD *)(v1 + 28) = &unk_80CF83C;
  *(_DWORD *)(v1 + 32) = &unk_80CF83C;
  *(_DWORD *)(v1 + 36) = &unk_80CF83C;
  *(_DWORD *)(v1 + 40) = &unk_80CF83C;
  *(_DWORD *)(v1 + 44) = 0;
  *(_DWORD *)(v1 + 48) = 0;
  *(_DWORD *)(v1 + 52) = 0;
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v5);
  v3 = v6;
  *(_DWORD *)(v2 + 48) = v5;
  *(_DWORD *)(v2 + 52) = v3;
  *(_DWORD *)(v2 + 56) = 0;
  *(_DWORD *)(v2 + 60) = 0;
  *(_DWORD *)(v2 + 64) = 0;
  *(_DWORD *)(v2 + 68) = 0;
  *(_DWORD *)(v2 + 72) = 0;
  *(_DWORD *)(v2 + 76) = 0;
  *(_DWORD *)(v2 + 80) = 0;
  *(_DWORD *)(v2 + 84) = 0;
  *(_BYTE *)(v2 + 88) = 0;
  *(_DWORD *)(v2 + 92) = 0;
  *(_DWORD *)(v2 + 96) = 0;
  *(_DWORD *)(v2 + 100) = 0;
  *(_DWORD *)a1 = v2;
  _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
  return a1;
}
// 80BD310: using guessed type void *off_80BD310;

//----- (08098E10) --------------------------------------------------------
void *__cdecl sub_8098E10(void *a1, char *a2, int *a3)
{
  int v3; // eax@1

  v3 = strlen(a2);
  sub_8069320(a1, 3, (int)a2, v3);
  sub_8069320(a1, 2, *a3, *(_DWORD *)(*a3 - 12));
  return a1;
}

//----- (08098E70) --------------------------------------------------------
void *__cdecl sub_8098E70(void *a1, char *a2, int a3)
{
  int v3; // eax@1
  int v4; // eax@1
  char v6; // [sp+10h] [bp-2Ch]@1

  v3 = strlen(a2);
  sub_8069320(a1, 3, (int)a2, v3);
  v4 = snprintf(&v6, 0x1Fu, "%d", *(_DWORD *)a3);
  sub_8069320(a1, 1, (int)&v6, v4);
  return a1;
}

//----- (08098EF0) --------------------------------------------------------
int __cdecl sub_8098EF0(int a1, int a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a1 + 8) )
  {
    result = (*(int (**)(void))(a1 + 12))();
  }
  else
  {
    std::__throw_bad_function_call();
    result = sub_8098F20(a1, a2);
  }
  return result;
}

//----- (08098F20) --------------------------------------------------------
int __userpurge sub_8098F20@<eax>(int a1, int a2)
{
  int v2; // eax@1
  int v3; // ecx@1

  v2 = operator new(0x2Cu);
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)v2 = &off_80BA318;
  *(_DWORD *)(v2 + 8) = 0;
  *(_DWORD *)(v2 + 12) = 0;
  *(_DWORD *)(v2 + 16) = 0;
  *(_DWORD *)(v2 + 20) = 0;
  *(_DWORD *)(v2 + 24) = 0;
  *(_DWORD *)(v2 + 28) = 0;
  v3 = *(_DWORD *)a2;
  *(_DWORD *)(v2 + 32) = *(_DWORD *)a2;
  if ( v3 )
    _InterlockedIncrement((volatile signed __int32 *)(v3 + 4));
  *(_DWORD *)(v2 + 36) = 0;
  *(_DWORD *)(v2 + 40) = 0;
  *(_DWORD *)a1 = v2;
  _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
  return a1;
}
// 80BA318: using guessed type int (__cdecl *off_80BA318)(int);

//----- (08098FA0) --------------------------------------------------------
int __cdecl sub_8098FA0(int a1, int a2)
{
  int result; // eax@1

  result = a2;
  *(_DWORD *)(a1 + 8) = 0;
  if ( *(_DWORD *)(a2 + 8) )
  {
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
    result = (*(int (__cdecl **)(int, int, signed int))(a2 + 8))(a1, a2, 2);
  }
  return result;
}

//----- (08099010) --------------------------------------------------------
int __cdecl sub_8099010(int a1)
{
  signed __int32 v1; // eax@2
  int result; // eax@3
  signed __int32 v3; // eax@6

  if ( &_pthread_key_create )
  {
    v1 = _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 4), 0xFFFFFFFF);
  }
  else
  {
    v1 = *(_DWORD *)(a1 + 4);
    *(_DWORD *)(a1 + 4) = v1 - 1;
  }
  result = v1 - 1;
  if ( !result )
  {
    (*(void (__cdecl **)(int))(*(_DWORD *)a1 + 8))(a1);
    if ( &_pthread_key_create )
    {
      v3 = _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 8), 0xFFFFFFFF);
    }
    else
    {
      v3 = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(a1 + 8) = v3 - 1;
    }
    result = v3 - 1;
    if ( !result )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)a1 + 12))(a1);
  }
  return result;
}

//----- (08099090) --------------------------------------------------------
int __cdecl sub_8099090(int a1)
{
  int result; // eax@1

  sub_805EF00(a1 + 16, *(void **)(a1 + 24));
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    result = ((int (__cdecl *)(int, int, signed int))result)(a1, a1, 3);
  return result;
}

//----- (080990D0) --------------------------------------------------------
signed int __cdecl sub_80990D0(int a1)
{
  int v1; // ebp@1
  int v2; // ebx@1
  int v3; // esi@1
  int i; // eax@1
  int v5; // eax@3
  signed int result; // eax@5
  int v7; // edx@7
  int v8; // eax@7
  unsigned int v9; // eax@11
  int v10; // ecx@14
  int v11; // eax@17
  int v12; // ST0C_4@24
  char v13; // [sp+14h] [bp-48h]@12
  void (__cdecl *v14)(char *, char *, signed int); // [sp+1Ch] [bp-40h]@17
  int v15; // [sp+24h] [bp-38h]@18
  char v16; // [sp+28h] [bp-34h]@17
  void *v17; // [sp+2Ch] [bp-30h]@18
  char *v18; // [sp+30h] [bp-2Ch]@17
  char *v19; // [sp+34h] [bp-28h]@17
  int v20; // [sp+38h] [bp-24h]@17
  int v21; // [sp+3Ch] [bp-20h]@17

  v1 = *(_DWORD *)a1;
  v2 = *(_DWORD *)(**(_DWORD **)a1 + 40);
  v3 = v2 + 564;
  for ( i = *(_DWORD *)(v2 + 568); ; *(_DWORD *)(v2 + 568) = i )
  {
    result = sub_808C150(v2 + 528, (int *)(v2 + 564), i);
    if ( result != 4 )
      break;
    if ( !*(_DWORD *)(v2 + 8) )
    {
      v11 = std::__throw_bad_function_call();
LABEL_24:
      v12 = v11;
      sub_8099090(v3);
      return v12;
    }
    v5 = (*(int (__cdecl **)(int, int))(v2 + 12))(v2, v2 + 564);
    if ( !v5 )
    {
      LOBYTE(v9) = sub_808C0E0(v2 + 528);
      return v9 < 1 ? 3 : 1;
    }
    i = *(_DWORD *)(v2 + 564) + v5;
  }
  if ( !result )
  {
    v7 = *(_DWORD *)(*(_DWORD *)v1 + 40);
    v8 = *(_DWORD *)(v7 + 536);
    if ( v8 == 6 )
    {
      v3 = (int)&v13;
      while ( 1 )
      {
        result = sub_8095E00(v7);
        if ( result )
          break;
        v7 = *(_DWORD *)(*(_DWORD *)v1 + 40);
        v10 = *(_DWORD *)(v7 + 536);
        if ( v10 == 4 )
        {
          v14 = 0;
          memset(&v16, 0, 0x10u);
          v20 = 0;
          v18 = &v16;
          v19 = &v16;
          v21 = 0;
          sub_8098700(v1 + 4, (int)&v13);
          v11 = sub_8097C60(&v13, *(_DWORD *)(*(_DWORD *)v1 + 40), 0);
          if ( v11 )
            goto LABEL_24;
          sub_805EF00((int)&v15, v17);
          if ( v14 )
            v14(&v13, &v13, 3);
          v7 = *(_DWORD *)(*(_DWORD *)v1 + 40);
        }
        else if ( v10 == 7 )
        {
          return 0;
        }
      }
    }
    else if ( v8 != 1 || *(_DWORD *)(v7 + 544) != 4 )
    {
      result = 3;
    }
    else
    {
      result = (unsigned int)memcmp(*(const void **)(v7 + 540), "null", 4u) >= 1 ? 3 : 0;
    }
  }
  return result;
}

//----- (080992C0) --------------------------------------------------------
signed int __cdecl sub_80992C0(int a1)
{
  int v1; // ebp@1
  int v2; // ebx@1
  int i; // eax@1
  int v4; // eax@3
  signed int result; // eax@5
  int v6; // edx@7
  int v7; // ecx@7
  unsigned int v8; // eax@11
  int v9; // esi@14
  int v10; // esi@19
  char v11; // [sp+14h] [bp-48h]@14
  void (__cdecl *v12)(char *, char *, signed int); // [sp+1Ch] [bp-40h]@14
  int v13; // [sp+24h] [bp-38h]@15
  char v14; // [sp+28h] [bp-34h]@14
  void *v15; // [sp+2Ch] [bp-30h]@15
  char *v16; // [sp+30h] [bp-2Ch]@14
  char *v17; // [sp+34h] [bp-28h]@14
  int v18; // [sp+38h] [bp-24h]@14
  int v19; // [sp+3Ch] [bp-20h]@14

  v1 = *(_DWORD *)a1;
  v2 = *(_DWORD *)(**(_DWORD **)a1 + 40);
  for ( i = *(_DWORD *)(v2 + 568); ; *(_DWORD *)(v2 + 568) = i )
  {
    result = sub_808C150(v2 + 528, (int *)(v2 + 564), i);
    if ( result != 4 )
      break;
    if ( !*(_DWORD *)(v2 + 8) )
    {
      v10 = std::__throw_bad_function_call();
      sub_8099090(v2);
      Unwind_Resume(v10);
    }
    v4 = (*(int (__cdecl **)(int, int))(v2 + 12))(v2, v2 + 564);
    if ( !v4 )
    {
      LOBYTE(v8) = sub_808C0E0(v2 + 528);
      return v8 < 1 ? 3 : 1;
    }
    i = *(_DWORD *)(v2 + 564) + v4;
  }
  if ( !result )
  {
    v6 = *(_DWORD *)(*(_DWORD *)v1 + 40);
    v7 = *(_DWORD *)(v6 + 536);
    if ( v7 == 4 )
    {
      v12 = 0;
      memset(&v14, 0, 0x10u);
      v18 = 0;
      v16 = &v14;
      v17 = &v14;
      v19 = 0;
      sub_8098700(v1 + 4, (int)&v11);
      v9 = sub_8097C60(&v11, *(_DWORD *)(*(_DWORD *)v1 + 40), 0);
      if ( !v9 )
        v9 = *(_DWORD *)(v1 + 20);
      sub_805EF00((int)&v13, v15);
      if ( v12 )
        v12(&v11, &v11, 3);
      result = v9;
    }
    else if ( v7 != 1 || *(_DWORD *)(v6 + 544) != 4 )
    {
      result = 3;
    }
    else
    {
      result = (unsigned int)memcmp(*(const void **)(v6 + 540), "null", 4u) >= 1 ? 3 : 0;
    }
  }
  return result;
}
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);

//----- (08099450) --------------------------------------------------------
int __cdecl sub_8099450(int a1, std::string *a2)
{
  int v2; // eax@1
  unsigned __int8 v3; // cf@2
  int v4; // eax@2
  unsigned int v5; // edx@3
  int v6; // eax@4
  int v7; // ebp@4
  void *v8; // ecx@4
  void *v9; // esi@4
  std::string *v10; // eax@4
  void *v11; // eax@7
  int v12; // edx@7
  void *v13; // ebx@11
  int v14; // eax@12
  int v15; // edx@12
  int result; // eax@17
  signed __int32 v17; // eax@22
  signed __int32 v18; // ecx@27
  int v19; // [sp+10h] [bp-3Ch]@11
  signed int v20; // [sp+14h] [bp-38h]@3
  char v21; // [sp+2Fh] [bp-1Dh]@24

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFFF )
    {
      v5 = -4;
      v20 = 0x3FFFFFFF;
      goto LABEL_4;
    }
  }
  else
  {
    v4 = 1;
  }
  v5 = 4 * v4;
  v20 = v4;
LABEL_4:
  v6 = operator new(v5);
  v7 = v6;
  v8 = *(void **)a1;
  v9 = *(void **)(a1 + 4);
  v10 = (std::string *)(v6 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFFC));
  if ( v10 )
  {
    std::string::string(v10, a2);
    v9 = *(void **)(a1 + 4);
    v8 = *(void **)a1;
  }
  if ( v9 == v8 )
  {
    v19 = v7 + 4;
  }
  else
  {
    v11 = v8;
    v12 = v7;
    do
    {
      if ( v12 )
      {
        *(_DWORD *)v12 = *(_DWORD *)v11;
        *(_DWORD *)v11 = &unk_80CF83C;
      }
      v11 = (char *)v11 + 4;
      v12 += 4;
    }
    while ( v11 != v9 );
    v19 = v7 + 4 * ((unsigned int)((_BYTE *)v9 - ((_BYTE *)v8 + 4)) >> 2) + 8;
    v9 = *(void **)(a1 + 4);
    v13 = *(void **)a1;
    if ( v9 != *(void **)a1 )
    {
      do
      {
        v14 = *(_DWORD *)v13;
        v15 = *(_DWORD *)v13 - 12;
        if ( (_DWORD *)v15 != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v17 = _InterlockedExchangeAdd((volatile signed __int32 *)(v14 - 4), 0xFFFFFFFF);
          }
          else
          {
            v18 = *(_DWORD *)(v14 - 4);
            *(_DWORD *)(v14 - 4) = v18 - 1;
            v17 = v18;
          }
          if ( v17 <= 0 )
            std::string::_Rep::_M_destroy(v15, &v21);
        }
        v13 = (char *)v13 + 4;
      }
      while ( v9 != v13 );
      v9 = *(void **)a1;
    }
  }
  if ( v9 )
    operator delete(v9);
  *(_DWORD *)a1 = v7;
  *(_DWORD *)(a1 + 4) = v19;
  result = v7 + 4 * v20;
  *(_DWORD *)(a1 + 8) = result;
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (08099610) --------------------------------------------------------
int __cdecl sub_8099610(int a1, int a2)
{
  int v2; // edi@1
  unsigned __int8 v3; // cf@2
  int v4; // edi@2
  int v5; // eax@3
  int v6; // esi@4
  void *v7; // edx@4
  unsigned int v8; // eax@4
  void *v9; // edi@5
  int v10; // ebp@7
  int v11; // eax@9
  void *v12; // ebp@12
  int v13; // eax@13
  bool v14; // zf@13
  int result; // eax@20
  unsigned int v16; // [sp+8h] [bp-24h]@3
  int v17; // [sp+Ch] [bp-20h]@4

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFFF )
    {
      v16 = -4;
      v5 = operator new(0xFFFFFFFC);
    }
    else
    {
      v16 = 4 * v4;
      v5 = operator new(4 * v4);
    }
  }
  else
  {
    v16 = 4;
    v5 = operator new(4u);
  }
  v6 = v5;
  v7 = *(void **)a1;
  v17 = v5 + 4;
  v8 = v5 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFFC);
  if ( v8 )
  {
    *(_DWORD *)v8 = *(_DWORD *)a2;
    *(_DWORD *)a2 = 0;
    v9 = *(void **)(a1 + 4);
    v7 = *(void **)a1;
  }
  else
  {
    v9 = *(void **)(a1 + 4);
  }
  if ( v9 != v7 )
  {
    v10 = v6;
    do
    {
      if ( v10 )
      {
        v11 = *(_DWORD *)v7;
        *(_DWORD *)v10 = *(_DWORD *)v7;
        if ( v11 )
          _InterlockedIncrement((volatile signed __int32 *)(v11 + 4));
      }
      v7 = (char *)v7 + 4;
      v10 += 4;
    }
    while ( v7 != v9 );
    v17 = v10 + 4;
    v9 = *(void **)(a1 + 4);
    v12 = *(void **)a1;
    if ( v9 != *(void **)a1 )
    {
      do
      {
        v13 = *(_DWORD *)v12;
        v14 = *(_DWORD *)v12 == 0;
        if ( *(_DWORD *)v12 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v13 + 4));
          if ( v14 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v13 + 4))(v13);
        }
        v12 = (char *)v12 + 4;
      }
      while ( v9 != v12 );
      v9 = *(void **)a1;
    }
  }
  if ( v9 )
    operator delete(v9);
  *(_DWORD *)a1 = v6;
  result = v17;
  *(_DWORD *)(a1 + 4) = v17;
  *(_DWORD *)(a1 + 8) = v16 + v6;
  return result;
}

//----- (08099730) --------------------------------------------------------
int __cdecl sub_8099730(int a1, int a2)
{
  int v2; // edi@1
  unsigned __int8 v3; // cf@2
  int v4; // edi@2
  int v5; // eax@3
  int v6; // esi@4
  void *v7; // edx@4
  unsigned int v8; // eax@4
  void *v9; // edi@5
  int v10; // ebp@7
  int v11; // eax@9
  void *v12; // ebp@12
  int v13; // eax@13
  bool v14; // zf@13
  int result; // eax@20
  unsigned int v16; // [sp+8h] [bp-24h]@3
  int v17; // [sp+Ch] [bp-20h]@4

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 2 * v2;
    if ( v3 || (unsigned int)v4 > 0x3FFFFFFF )
    {
      v16 = -4;
      v5 = operator new(0xFFFFFFFC);
    }
    else
    {
      v16 = 4 * v4;
      v5 = operator new(4 * v4);
    }
  }
  else
  {
    v16 = 4;
    v5 = operator new(4u);
  }
  v6 = v5;
  v7 = *(void **)a1;
  v17 = v5 + 4;
  v8 = v5 + ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) & 0xFFFFFFFC);
  if ( v8 )
  {
    *(_DWORD *)v8 = *(_DWORD *)a2;
    *(_DWORD *)a2 = 0;
    v9 = *(void **)(a1 + 4);
    v7 = *(void **)a1;
  }
  else
  {
    v9 = *(void **)(a1 + 4);
  }
  if ( v9 != v7 )
  {
    v10 = v6;
    do
    {
      if ( v10 )
      {
        v11 = *(_DWORD *)v7;
        *(_DWORD *)v10 = *(_DWORD *)v7;
        if ( v11 )
          _InterlockedIncrement((volatile signed __int32 *)(v11 + 4));
      }
      v7 = (char *)v7 + 4;
      v10 += 4;
    }
    while ( v7 != v9 );
    v17 = v10 + 4;
    v9 = *(void **)(a1 + 4);
    v12 = *(void **)a1;
    if ( v9 != *(void **)a1 )
    {
      do
      {
        v13 = *(_DWORD *)v12;
        v14 = *(_DWORD *)v12 == 0;
        if ( *(_DWORD *)v12 )
        {
          _InterlockedDecrement((volatile signed __int32 *)(v13 + 4));
          if ( v14 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v13 + 4))(v13);
        }
        v12 = (char *)v12 + 4;
      }
      while ( v9 != v12 );
      v9 = *(void **)a1;
    }
  }
  if ( v9 )
    operator delete(v9);
  *(_DWORD *)a1 = v6;
  result = v17;
  *(_DWORD *)(a1 + 4) = v17;
  *(_DWORD *)(a1 + 8) = v16 + v6;
  return result;
}

//----- (08099850) --------------------------------------------------------
int __cdecl sub_8099850(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // ebx@3
  size_t v5; // esi@4
  const void *v6; // eax@6
  size_t v7; // edi@6
  size_t v8; // ecx@6
  int v9; // eax@8
  const void *v10; // eax@13
  size_t v11; // ebx@13
  size_t v12; // edx@13
  int v13; // eax@14
  int v14; // ecx@17
  int *v15; // ebx@17
  int *v16; // eax@18
  int v17; // edx@18
  int v18; // ST24_4@18
  int v19; // edi@18
  int v20; // esi@18
  int v21; // edx@18
  int v22; // eax@18
  const void *s2; // [sp+20h] [bp-58h]@4
  int v25; // [sp+28h] [bp-50h]@4
  int v26; // [sp+2Ch] [bp-4Ch]@25
  char v27; // [sp+35h] [bp-43h]@3
  const void *v28; // [sp+38h] [bp-40h]@3
  int *v29; // [sp+3Ch] [bp-3Ch]@17
  int v30; // [sp+40h] [bp-38h]@18
  int v31; // [sp+44h] [bp-34h]@18
  int v32; // [sp+48h] [bp-30h]@18
  int v33; // [sp+4Ch] [bp-2Ch]@1
  int *v34; // [sp+50h] [bp-28h]@2
  int v35; // [sp+54h] [bp-24h]@18
  int v36; // [sp+58h] [bp-20h]@1
  int v37; // [sp+5Ch] [bp-1Ch]@2

  v33 = 1;
  v36 = 0;
  v3 = *(_DWORD *)(a3 + 8);
  if ( v3 )
  {
    v37 = *(_DWORD *)(a3 + 12);
    v36 = v3;
    ((void (__cdecl *)(int **, int, signed int))v3)(&v34, a3, 2);
  }
  std::string::string(&v28, a2, &v27);
  v4 = *(_DWORD *)(a1 + 24);
  if ( v4 )
  {
    s2 = v28;
    v5 = *((_DWORD *)v28 - 3);
    v25 = a1 + 20;
    do
    {
      while ( 1 )
      {
        v6 = *(const void **)(v4 + 16);
        v7 = *((_DWORD *)v6 - 3);
        v8 = v5;
        if ( v5 > v7 )
          v8 = *((_DWORD *)v6 - 3);
        v9 = memcmp(v6, s2, v8);
        if ( !v9 )
          v9 = v7 - v5;
        if ( v9 < 0 )
          break;
        v25 = v4;
        v4 = *(_DWORD *)(v4 + 8);
        if ( !v4 )
          goto LABEL_12;
      }
      v4 = *(_DWORD *)(v4 + 12);
    }
    while ( v4 );
LABEL_12:
    if ( a1 + 20 != v25 )
    {
      v10 = *(const void **)(v25 + 16);
      v11 = *((_DWORD *)v10 - 3);
      v12 = v5;
      if ( v5 > v11 )
        v12 = *((_DWORD *)v10 - 3);
      v13 = memcmp(s2, v10, v12);
      if ( !v13 )
        v13 = v5 - v11;
      if ( v13 >= 0 )
      {
        v14 = v25;
        v15 = (int *)&v29;
        goto LABEL_18;
      }
    }
  }
  else
  {
    v25 = a1 + 20;
  }
  v29 = (int *)&v28;
  v15 = (int *)&v29;
  sub_805F0F0((int)&v26, a1 + 16, v25, (int)&dword_80BCCA0, (int)&v29);
  v14 = v26;
LABEL_18:
  *(_DWORD *)(v14 + 20) = v33;
  v16 = v34;
  v17 = v35;
  v34 = v29;
  v35 = v30;
  v18 = v17;
  v29 = v16;
  v30 = v17;
  v19 = v36;
  v36 = 0;
  v20 = v37;
  v37 = v32;
  v21 = *(_DWORD *)(v14 + 28);
  v29 = *(int **)(v14 + 24);
  v30 = v21;
  *(_DWORD *)(v14 + 24) = v16;
  *(_DWORD *)(v14 + 28) = v18;
  v31 = *(_DWORD *)(v14 + 32);
  v22 = v31;
  *(_DWORD *)(v14 + 32) = v19;
  v32 = *(_DWORD *)(v14 + 36);
  *(_DWORD *)(v14 + 36) = v20;
  if ( v22 )
    ((void (__cdecl *)(int *, int *, signed int))v22)(v15, v15, 3);
  std::string::_Rep::_M_dispose((char *)v28 - 12, v15);
  if ( v36 )
    ((void (__cdecl *)(int **, int **, signed int))v36)(&v34, &v34, 3);
  return a1;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80BCCA0: using guessed type int;

//----- (08099AC0) --------------------------------------------------------
int __cdecl sub_8099AC0(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // esi@1
  int v6; // [sp+10h] [bp-1Ch]@1
  int (__cdecl *v7)(void **, void **, signed int); // [sp+18h] [bp-14h]@1
  int (*v8)(); // [sp+1Ch] [bp-10h]@1

  v3 = operator new(4u);
  *(_DWORD *)v3 = a3;
  v6 = v3;
  v8 = sub_805E810;
  v7 = sub_805E960;
  v4 = sub_805F4A0(a1, a2, (int)&v6);
  if ( v7 )
    v7((void **)&v6, (void **)&v6, 3);
  return v4;
}
// 805E810: using guessed type int sub_805E810();

//----- (08099B80) --------------------------------------------------------
int __cdecl sub_8099B80(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // esi@1
  int v6; // [sp+10h] [bp-1Ch]@1
  int (__cdecl *v7)(void **, void **, signed int); // [sp+18h] [bp-14h]@1
  __int32 (__cdecl *v8)(int, const char **); // [sp+1Ch] [bp-10h]@1

  v3 = operator new(4u);
  *(_DWORD *)v3 = a3;
  v6 = v3;
  v8 = sub_8095160;
  v7 = sub_8095230;
  v4 = sub_805F4A0(a1, a2, (int)&v6);
  if ( v7 )
    v7((void **)&v6, (void **)&v6, 3);
  return v4;
}

//----- (08099C40) --------------------------------------------------------
int __cdecl sub_8099C40(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // esi@1
  int v6; // [sp+10h] [bp-1Ch]@1
  int (__cdecl *v7)(void **, void **, signed int); // [sp+18h] [bp-14h]@1
  int (*v8)(); // [sp+1Ch] [bp-10h]@1

  v3 = operator new(4u);
  *(_DWORD *)v3 = a3;
  v6 = v3;
  v8 = sub_805E830;
  v7 = sub_805EAA0;
  v4 = sub_805F4A0(a1, a2, (int)&v6);
  if ( v7 )
    v7((void **)&v6, (void **)&v6, 3);
  return v4;
}
// 805E830: using guessed type int sub_805E830();

//----- (08099D00) --------------------------------------------------------
int __cdecl sub_8099D00(int a1, int a2, int a3)
{
  int v3; // esi@1
  int v4; // edi@1
  int v6; // [sp+1Ch] [bp-30h]@1
  int (*v7)(); // [sp+24h] [bp-28h]@1
  signed int (__cdecl *v8)(int); // [sp+28h] [bp-24h]@1
  int v9; // [sp+2Ch] [bp-20h]@1
  char v10; // [sp+30h] [bp-1Ch]@1
  void (__cdecl *v11)(char *, char *, signed int); // [sp+38h] [bp-14h]@3

  v9 = a1;
  sub_8098730((int)&v10, a3);
  v3 = operator new(0x14u);
  *(_DWORD *)v3 = a1;
  sub_8098730(v3 + 4, (int)&v10);
  v6 = v3;
  v8 = sub_80990D0;
  v7 = sub_8098890;
  v4 = sub_8099850(a1, a2, (int)&v6);
  if ( v7 )
    ((void (__cdecl *)(int *, int *, signed int))v7)(&v6, &v6, 3);
  if ( v11 )
    v11(&v10, &v10, 3);
  return v4;
}
// 8098890: using guessed type int sub_8098890();

//----- (08099E30) --------------------------------------------------------
int __cdecl sub_8099E30(int a1, int a2, int a3, int a4)
{
  int v4; // ebx@1
  int v5; // edi@1
  int v7; // [sp+18h] [bp-34h]@1
  int (*v8)(); // [sp+20h] [bp-2Ch]@1
  signed int (__cdecl *v9)(int); // [sp+24h] [bp-28h]@1
  int v10; // [sp+28h] [bp-24h]@1
  char v11; // [sp+2Ch] [bp-20h]@1
  void (__cdecl *v12)(char *, char *, signed int); // [sp+34h] [bp-18h]@3
  int v13; // [sp+3Ch] [bp-10h]@1

  v10 = a1;
  sub_8098730((int)&v11, a3);
  v13 = a4;
  v4 = operator new(0x18u);
  *(_DWORD *)v4 = a1;
  sub_8098730(v4 + 4, (int)&v11);
  *(_DWORD *)(v4 + 20) = v13;
  v7 = v4;
  v9 = sub_80992C0;
  v8 = sub_80987A0;
  v5 = sub_8099850(a1, a2, (int)&v7);
  if ( v8 )
    ((void (__cdecl *)(int *, int *, signed int))v8)(&v7, &v7, 3);
  if ( v12 )
    v12(&v11, &v11, 3);
  return v5;
}
// 80987A0: using guessed type int sub_80987A0();

//----- (08099F70) --------------------------------------------------------
std::string *__userpurge sub_8099F70@<eax>(unsigned int a1@<ebp>, void *a2@<edi>, std::string *a3, int a4, int a5)
{
  int v5; // edi@2
  unsigned int v6; // eax@2
  unsigned int v7; // eax@3
  std::string *result; // eax@3
  int v9; // edx@6
  char v10; // [sp+1Fh] [bp-Dh]@8

  if ( *(_DWORD *)(a4 + 16696) )
  {
    v5 = (*(int (__cdecl **)(int))(*(_DWORD *)(a4 + 16636) + 12))(a4 + 16636);
    *(_DWORD *)a3 = &unk_80CF83C;
    v6 = evbuffer_get_length(v5);
    if ( a5 )
    {
      if ( v6 > a5 )
        v6 = a5;
    }
    std::string::resize(a3, v6, 0);
    v7 = evbuffer_copyout(v5, *(_DWORD *)a3, *(_DWORD *)(*(_DWORD *)a3 - 12));
    std::string::resize(a3, v7, 0);
    result = a3;
  }
  else
  {
    v9 = *(_DWORD *)(a4 + 16624) - (a4 + 88);
    if ( a5 && v9 > (unsigned int)a5 )
      v9 = a5;
    *(_DWORD *)a3 = std::string::_S_construct<char *>((int)a3, a1, a2, a4 + 88, a4 + v9 + 88, (int)&v10);
    result = a3;
  }
  return result;
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804D200: using guessed type int __cdecl evbuffer_copyout(_DWORD, _DWORD, _DWORD);

//----- (0809A080) --------------------------------------------------------
std::string *__userpurge sub_809A080@<eax>(unsigned int a1@<ebp>, std::string *a2, int a3, void *a4)
{
  int v4; // ebx@3
  unsigned int v5; // eax@3
  unsigned int v6; // eax@4
  std::string *result; // eax@4
  int v8; // eax@7
  int v9; // eax@10
  char v10; // [sp+1Fh] [bp-Dh]@9

  if ( *(_BYTE *)(a3 + 16740) )
  {
    v9 = *(_DWORD *)(a3 + 16736);
    if ( v9 )
    {
      sub_8096C70((int *)(a3 + 16744), *(_DWORD *)(a3 + 16732), *(_DWORD *)v9 - *(_DWORD *)(a3 + 16732));
      *(_DWORD *)(a3 + 16732) = **(_DWORD **)(a3 + 16736);
    }
  }
  if ( *(_DWORD *)(a3 + 16728) )
  {
    v4 = (*(int (__cdecl **)(int))(*(_DWORD *)(a3 + 16668) + 12))(a3 + 16668);
    *(_DWORD *)a2 = &unk_80CF83C;
    v5 = evbuffer_get_length(v4);
    if ( a4 )
    {
      if ( v5 > (unsigned int)a4 )
        v5 = (unsigned int)a4;
    }
    std::string::resize(a2, v5, 0);
    v6 = evbuffer_copyout(v4, *(_DWORD *)a2, *(_DWORD *)(*(_DWORD *)a2 - 12));
    std::string::resize(a2, v6, 0);
    result = a2;
  }
  else
  {
    v8 = *(_DWORD *)(a3 + 16656) - (a3 + 120);
    if ( a4 && v8 > (unsigned int)a4 )
      v8 = (int)a4;
    *(_DWORD *)a2 = std::string::_S_construct<char *>(a3, a1, a4, a3 + 120, a3 + v8 + 120, (int)&v10);
    result = a2;
  }
  return result;
}
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804D200: using guessed type int __cdecl evbuffer_copyout(_DWORD, _DWORD, _DWORD);

//----- (0809A1F0) --------------------------------------------------------
int __cdecl sub_809A1F0(int a1, int a2)
{
  *(_DWORD *)a1 = *(_DWORD *)a2;
  *(_DWORD *)(a1 + 4) = *(_DWORD *)(a2 + 4);
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
  *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
  *(_DWORD *)(a2 + 12) = &unk_80CF83C;
  *(_DWORD *)(a1 + 16) = *(_DWORD *)(a2 + 16);
  *(_DWORD *)(a2 + 16) = &unk_80CF83C;
  sub_80A6850(a1 + 20, a2 + 20);
  *(_DWORD *)(a1 + 24) = *(_DWORD *)(a2 + 24);
  *(_DWORD *)(a2 + 24) = &unk_80CF83C;
  *(_DWORD *)(a1 + 28) = *(_DWORD *)(a2 + 28);
  *(_DWORD *)(a2 + 28) = &unk_80CF83C;
  return sub_80A6850(a1 + 32, a2 + 32);
}

//----- (0809A2E0) --------------------------------------------------------
int __cdecl sub_809A2E0(int a1, int a2)
{
  int v2; // eax@1
  unsigned __int8 v3; // cf@2
  int v4; // eax@2
  unsigned int v5; // edx@3
  int v6; // edx@4
  void *v7; // esi@7
  void *v8; // ebx@7
  int v9; // edi@9
  int v10; // ecx@9
  int v11; // ST14_4@9
  void *v12; // ebx@12
  int result; // eax@17
  void *v14; // [sp+Ch] [bp-50h]@5
  void *v15; // [sp+10h] [bp-4Ch]@5
  void *v16; // [sp+14h] [bp-48h]@11
  void *v17; // [sp+18h] [bp-44h]@4
  int v18; // [sp+28h] [bp-34h]@11
  signed int v19; // [sp+2Ch] [bp-30h]@3
  char v20; // [sp+3Fh] [bp-1Dh]@13

  v2 = 954437177 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
  if ( v2 )
  {
    v3 = __CFADD__(v2, v2);
    v4 = 1908874354 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
    if ( v3 || (unsigned int)v4 > 0x71C71C7 )
    {
      v5 = -4;
      v19 = 119304647;
      goto LABEL_4;
    }
  }
  else
  {
    v4 = 1;
  }
  v5 = 36 * v4;
  v19 = v4;
LABEL_4:
  v17 = (void *)operator new(v5);
  v6 = (int)((char *)v17 + 4 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2));
  if ( v6 )
  {
    sub_809A1F0(v6, a2);
    v15 = *(void **)(a1 + 4);
    v14 = *(void **)a1;
  }
  else
  {
    v14 = *(void **)a1;
    v15 = *(void **)(a1 + 4);
  }
  if ( v15 == v14 )
  {
    v18 = (int)((char *)v17 + 36);
  }
  else
  {
    v7 = v14;
    v8 = v17;
    do
    {
      if ( v8 )
      {
        *(_DWORD *)v8 = *(_DWORD *)v7;
        *((_DWORD *)v8 + 1) = *((_DWORD *)v7 + 1);
        *((_DWORD *)v8 + 2) = *((_DWORD *)v7 + 2);
        v9 = (_BYTE *)v7 - (_BYTE *)v14;
        v10 = (_BYTE *)v8 - (_BYTE *)v17;
        *(_DWORD *)((char *)v17 + v10 + 12) = *((_DWORD *)v7 + 3);
        *(_DWORD *)((char *)v14 + v9 + 12) = &unk_80CF83C;
        v11 = (_BYTE *)v8 - (_BYTE *)v17;
        *(_DWORD *)((char *)v17 + v10 + 16) = *((_DWORD *)v7 + 4);
        *(_DWORD *)((char *)v14 + v9 + 16) = &unk_80CF83C;
        sub_80A6850((int)((char *)v8 + 20), (int)((char *)v7 + 20));
        *(_DWORD *)((char *)v17 + v11 + 24) = *((_DWORD *)v7 + 6);
        *(_DWORD *)((char *)v14 + v9 + 24) = &unk_80CF83C;
        *(_DWORD *)((char *)v17 + v11 + 28) = *((_DWORD *)v7 + 7);
        *(_DWORD *)((char *)v14 + v9 + 28) = &unk_80CF83C;
        sub_80A6850((int)((char *)v8 + 32), (int)((char *)v7 + 32));
      }
      v8 = (char *)v8 + 36;
      v7 = (char *)v7 + 36;
    }
    while ( v15 != v7 );
    v18 = (int)((char *)v8 + 36);
    v15 = *(void **)(a1 + 4);
    v16 = *(void **)a1;
    if ( v15 != *(void **)a1 )
    {
      v12 = *(void **)a1;
      do
      {
        sub_80A6820((int *)v12 + 8);
        std::string::_Rep::_M_dispose(*(_DWORD *)((char *)v16 + (_BYTE *)v12 - (_BYTE *)v16 + 28) - 12, &v20);
        std::string::_Rep::_M_dispose(*(_DWORD *)((char *)v16 + (_BYTE *)v12 - (_BYTE *)v16 + 24) - 12, &v20);
        sub_80A6820((int *)v12 + 5);
        std::string::_Rep::_M_dispose(*(_DWORD *)((char *)v16 + (_BYTE *)v12 - (_BYTE *)v16 + 16) - 12, &v20);
        std::string::_Rep::_M_dispose(*(_DWORD *)((char *)v16 + (_BYTE *)v12 - (_BYTE *)v16 + 12) - 12, &v20);
        v12 = (char *)v12 + 36;
      }
      while ( v15 != v12 );
      v15 = *(void **)a1;
    }
  }
  if ( v15 )
    operator delete(v15);
  *(_DWORD *)a1 = v17;
  *(_DWORD *)(a1 + 4) = v18;
  result = (int)((char *)v17 + 36 * v19);
  *(_DWORD *)(a1 + 8) = result;
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);

//----- (0809A6F0) --------------------------------------------------------
__pid_t __cdecl sub_809A6F0(__pid_t pid, int *stat_loc)
{
  return waitpid(stat_loc[3], 0, 1);
}

//----- (0809A710) --------------------------------------------------------
void __cdecl __noreturn handler(int a1)
{
  int v1; // eax@2
  int v2; // eax@2
  int v3; // eax@2
  int v4; // eax@5
  int v5; // [sp+18h] [bp-C0h]@2
  char v6; // [sp+1Ch] [bp-BCh]@2

  if ( log_level <= 5 )
  {
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(&v6, 16);
    v1 = std::__ostream_insert<char,std::char_traits<char>>(&v6, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    v2 = std::operator<<<std::char_traits<char>>(v1, dword_80BD478);
    v3 = std::ostream::operator<<(v2, a1);
    std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(&v5, v3 + 4);
    std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v6);
    std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v6);
    if ( byte_80CE64C )
    {
      v4 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v5, *(_DWORD *)(v5 - 12));
      std::endl<char,std::char_traits<char>>(v4);
    }
    syslog(3, "%s", v5);
    std::string::_Rep::_M_dispose(v5 - 12, &v6);
  }
  exit(1);
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C9B0: using guessed type int __cdecl std::operator<<<std::char_traits<char>>(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0D0: using guessed type int __cdecl std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::str(_DWORD, _DWORD);
// 804D1E0: using guessed type int __cdecl std::endl<char,std::char_traits<char>>(_DWORD);
// 804D300: using guessed type int __cdecl std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::basic_ostringstream(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80BD478: using guessed type int dword_80BD478[3];
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0809A860) --------------------------------------------------------
int sub_809A860()
{
  int v0; // eax@2
  bool v1; // zf@2
  int v2; // eax@7
  int v3; // edi@9
  int v4; // eax@9
  int v5; // eax@12
  void *v6; // esi@15
  void *v7; // ebx@15
  int v8; // eax@16
  int v9; // edx@16
  void *v10; // esi@21
  void *v11; // ebx@21
  int v12; // eax@22
  int v13; // edx@22
  int v14; // eax@27
  int v15; // edx@27
  int v16; // eax@28
  int v17; // eax@33
  int v18; // edi@35
  int v19; // eax@35
  int v20; // eax@38
  void *v21; // esi@41
  void *v22; // ebx@41
  int v23; // eax@42
  int v24; // edx@42
  void *v25; // esi@47
  void *v26; // ebx@47
  int v27; // eax@48
  int v28; // edx@48
  int v29; // eax@53
  int v30; // edx@53
  int v31; // eax@54
  int v32; // eax@59
  bool v33; // zf@59
  void *v34; // esi@66
  void *v35; // ebx@66
  int v36; // eax@67
  bool v37; // zf@67
  void *v38; // esi@74
  void *v39; // ebx@74
  int v40; // eax@75
  bool v41; // zf@75
  int v42; // ecx@82
  int v43; // ecx@83
  signed __int32 v45; // eax@87
  signed __int32 v46; // eax@91
  signed __int32 v47; // eax@95
  signed __int32 v48; // eax@99
  signed __int32 v49; // ecx@102
  signed __int32 v50; // eax@104
  signed __int32 v51; // ebx@108
  signed __int32 v52; // ebx@111
  signed __int32 v53; // eax@114
  signed __int32 v54; // ebx@118
  signed __int32 v55; // ebx@121
  signed __int32 v56; // edx@124
  signed __int32 v57; // edx@128
  signed __int32 v58; // ecx@133
  signed __int32 v59; // ecx@134
  signed __int32 v60; // ecx@135
  int v61; // [sp+10h] [bp-258h]@5
  pthread_mutex_t *v62; // [sp+14h] [bp-254h]@2
  int v63; // [sp+18h] [bp-250h]@5
  int v64; // [sp+1Ch] [bp-24Ch]@6
  int v65; // [sp+20h] [bp-248h]@6
  int v66; // [sp+24h] [bp-244h]@6
  int v67; // [sp+28h] [bp-240h]@8
  int v68; // [sp+28h] [bp-240h]@34
  int v69; // [sp+2Ch] [bp-23Ch]@8
  int v70; // [sp+2Ch] [bp-23Ch]@34
  int v71; // [sp+30h] [bp-238h]@8
  int v72; // [sp+30h] [bp-238h]@34
  int v73; // [sp+34h] [bp-234h]@8
  int v74; // [sp+34h] [bp-234h]@34
  void *v75; // [sp+38h] [bp-230h]@7
  void *v76; // [sp+38h] [bp-230h]@33
  int v77; // [sp+40h] [bp-228h]@8
  int v78; // [sp+40h] [bp-228h]@34
  int v79; // [sp+44h] [bp-224h]@8
  int v80; // [sp+44h] [bp-224h]@34
  int v81; // [sp+48h] [bp-220h]@7
  int v82; // [sp+48h] [bp-220h]@33
  int v83; // [sp+4Ch] [bp-21Ch]@8
  int v84; // [sp+4Ch] [bp-21Ch]@34
  char v85; // [sp+5Bh] [bp-20Dh]@89
  char v86; // [sp+5Ch] [bp-20Ch]@5
  int v87; // [sp+64h] [bp-204h]@2
  int v88; // [sp+1B4h] [bp-B4h]@83
  int v89; // [sp+1B8h] [bp-B0h]@82
  int v90; // [sp+1BCh] [bp-ACh]@5
  void *v91; // [sp+1C8h] [bp-A0h]@74
  void *v92; // [sp+1CCh] [bp-9Ch]@74
  char v93; // [sp+1D4h] [bp-94h]@74
  char v94; // [sp+208h] [bp-60h]@74
  void *v95; // [sp+238h] [bp-30h]@66
  void *v96; // [sp+23Ch] [bp-2Ch]@66
  int v97; // [sp+244h] [bp-24h]@5
  int v98; // [sp+248h] [bp-20h]@5

  if ( *(_DWORD *)(dword_80CF890 - 12) )
  {
    v62 = (pthread_mutex_t *)&v87;
    sub_8067DC0((int)&v87, (std::string *)&dword_80CF890);
    sub_8074BA0((int)&v87);
    v0 = v87;
    v1 = v87 == 0;
    if ( v87 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v87 + 4));
      if ( v1 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v0 + 4))(v0);
    }
  }
  else
  {
    v62 = (pthread_mutex_t *)&v87;
  }
  sub_80A4820((int)&v86);
  sub_80603C0((int)v62, (std::string *)&dword_80CF894, (std::string *)&dword_80CF898);
  sub_8065EF0(v62);
  v61 = v90 <= 0;
  v63 = v98;
  if ( v98 != v97 )
  {
    v65 = v97 + 32;
    v64 = v97 + 20;
    v66 = v97;
    do
    {
      v75 = *(void **)v65;
      v2 = *(_DWORD *)(v65 - 4);
      v81 = v2;
      if ( *(_DWORD *)v65 != v2 )
      {
        v79 = v2 + 28;
        v77 = v2 + 48;
        v83 = *(_DWORD *)(v65 - 4);
        v67 = v2 + 60;
        v69 = v2 + 56;
        v71 = v2 + 20;
        v73 = v2 + 8;
        do
        {
          v3 = v83 - v81;
          v4 = *(_DWORD *)(v83 - v81 + v67);
          if ( v4 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v4 + 4));
            if ( !v4 )
              (*(void (__cdecl **)(_DWORD))(::v0 + 4))(0);
          }
          v5 = *(_DWORD *)(v3 + v69);
          if ( v5 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
            if ( !v5 )
              (*(void (__cdecl **)(_DWORD))(::v0 + 4))(0);
          }
          v6 = *(void **)v77;
          v7 = *(void **)(v77 - 4);
          if ( *(void **)v77 != v7 )
          {
            do
            {
              v8 = *(_DWORD *)v7;
              v9 = *(_DWORD *)v7 - 12;
              if ( (_DWORD *)v9 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v48 = _InterlockedExchangeAdd((volatile signed __int32 *)(v8 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v60 = *(_DWORD *)(v8 - 4);
                  *(_DWORD *)(v8 - 4) = v60 - 1;
                  v48 = v60;
                }
                if ( v48 <= 0 )
                  std::string::_Rep::_M_destroy(v9, &v85);
              }
              v7 = (char *)v7 + 4;
            }
            while ( v6 != v7 );
            v6 = *(void **)(v83 + 44);
          }
          if ( v6 )
            operator delete(v6);
          v10 = *(void **)v79;
          v11 = *(void **)(v79 - 4);
          if ( *(void **)v79 != v11 )
          {
            do
            {
              v12 = *(_DWORD *)v11;
              v13 = *(_DWORD *)v11 - 12;
              if ( (_DWORD *)v13 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v47 = _InterlockedExchangeAdd((volatile signed __int32 *)(v12 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v59 = *(_DWORD *)(v12 - 4);
                  *(_DWORD *)(v12 - 4) = v59 - 1;
                  v47 = v59;
                }
                if ( v47 <= 0 )
                  std::string::_Rep::_M_destroy(v13, &v85);
              }
              v11 = (char *)v11 + 4;
            }
            while ( v10 != v11 );
            v10 = *(void **)(v83 + 24);
          }
          if ( v10 )
            operator delete(v10);
          v14 = *(_DWORD *)(v3 + v71);
          v15 = v14 - 12;
          if ( (_DWORD *)(v14 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v50 = _InterlockedExchangeAdd((volatile signed __int32 *)(v14 - 4), 0xFFFFFFFF);
            }
            else
            {
              v52 = *(_DWORD *)(v14 - 4);
              *(_DWORD *)(v14 - 4) = v52 - 1;
              v50 = v52;
            }
            if ( v50 <= 0 )
              std::string::_Rep::_M_destroy(v15, &v85);
          }
          v16 = *(_DWORD *)(v3 + v73);
          if ( (_DWORD *)(v16 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v51 = _InterlockedExchangeAdd((volatile signed __int32 *)(v16 - 4), 0xFFFFFFFF);
            }
            else
            {
              v51 = *(_DWORD *)(v16 - 4);
              *(_DWORD *)(v16 - 4) = v51 - 1;
            }
            if ( v51 <= 0 )
              std::string::_Rep::_M_destroy(v16 - 12, &v85);
          }
          v83 += 64;
          v79 += 64;
          v77 += 64;
        }
        while ( v75 != (void *)v83 );
        v75 = *(void **)(v66 + 28);
      }
      if ( v75 )
        operator delete(v75);
      v76 = *(void **)v64;
      v17 = *(_DWORD *)(v64 - 4);
      v82 = v17;
      if ( *(_DWORD *)v64 != v17 )
      {
        v80 = v17 + 28;
        v78 = v17 + 48;
        v84 = *(_DWORD *)(v64 - 4);
        v68 = v17 + 60;
        v70 = v17 + 56;
        v72 = v17 + 20;
        v74 = v17 + 8;
        do
        {
          v18 = v84 - v82;
          v19 = *(_DWORD *)(v84 - v82 + v68);
          if ( v19 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v19 + 4));
            if ( !v19 )
              (*(void (__cdecl **)(_DWORD))(::v0 + 4))(0);
          }
          v20 = *(_DWORD *)(v18 + v70);
          if ( v20 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v20 + 4));
            if ( !v20 )
              (*(void (__cdecl **)(_DWORD))(::v0 + 4))(0);
          }
          v21 = *(void **)v78;
          v22 = *(void **)(v78 - 4);
          if ( *(void **)v78 != v22 )
          {
            do
            {
              v23 = *(_DWORD *)v22;
              v24 = *(_DWORD *)v22 - 12;
              if ( (_DWORD *)v24 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v23 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v58 = *(_DWORD *)(v23 - 4);
                  *(_DWORD *)(v23 - 4) = v58 - 1;
                  v46 = v58;
                }
                if ( v46 <= 0 )
                  std::string::_Rep::_M_destroy(v24, &v85);
              }
              v22 = (char *)v22 + 4;
            }
            while ( v21 != v22 );
            v21 = *(void **)(v84 + 44);
          }
          if ( v21 )
            operator delete(v21);
          v25 = *(void **)v80;
          v26 = *(void **)(v80 - 4);
          if ( *(void **)v80 != v26 )
          {
            do
            {
              v27 = *(_DWORD *)v26;
              v28 = *(_DWORD *)v26 - 12;
              if ( (_DWORD *)v28 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v45 = _InterlockedExchangeAdd((volatile signed __int32 *)(v27 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v49 = *(_DWORD *)(v27 - 4);
                  *(_DWORD *)(v27 - 4) = v49 - 1;
                  v45 = v49;
                }
                if ( v45 <= 0 )
                  std::string::_Rep::_M_destroy(v28, &v85);
              }
              v26 = (char *)v26 + 4;
            }
            while ( v25 != v26 );
            v25 = *(void **)(v84 + 24);
          }
          if ( v25 )
            operator delete(v25);
          v29 = *(_DWORD *)(v18 + v72);
          v30 = v29 - 12;
          if ( (_DWORD *)(v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v53 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
            }
            else
            {
              v55 = *(_DWORD *)(v29 - 4);
              *(_DWORD *)(v29 - 4) = v55 - 1;
              v53 = v55;
            }
            if ( v53 <= 0 )
              std::string::_Rep::_M_destroy(v30, &v85);
          }
          v31 = *(_DWORD *)(v18 + v74);
          if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v54 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
            }
            else
            {
              v54 = *(_DWORD *)(v31 - 4);
              *(_DWORD *)(v31 - 4) = v54 - 1;
            }
            if ( v54 <= 0 )
              std::string::_Rep::_M_destroy(v31 - 12, &v85);
          }
          v84 += 64;
          v80 += 64;
          v78 += 64;
        }
        while ( v76 != (void *)v84 );
        v76 = *(void **)(v66 + 16);
      }
      if ( v76 )
        operator delete(v76);
      v32 = *(_DWORD *)v66;
      v33 = *(_DWORD *)v66 == 0;
      if ( *(_DWORD *)v66 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v32 + 4));
        if ( v33 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v32 + 4))(v32);
      }
      v66 += 44;
      v65 += 44;
      v64 += 44;
    }
    while ( v63 != v66 );
    v63 = v97;
  }
  if ( v63 )
    operator delete((void *)v63);
  v34 = v96;
  v35 = v95;
  if ( v96 != v95 )
  {
    do
    {
      v36 = *(_DWORD *)v35;
      v37 = *(_DWORD *)v35 == 0;
      if ( *(_DWORD *)v35 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v36 + 4));
        if ( v37 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v36 + 4))(v36);
      }
      v35 = (char *)v35 + 4;
    }
    while ( v34 != v35 );
    v34 = v95;
  }
  if ( v34 )
    operator delete(v34);
  std::condition_variable::~condition_variable((std::condition_variable *)&v94);
  sub_80A0F70(&v93);
  v38 = v92;
  v39 = v91;
  if ( v92 != v91 )
  {
    do
    {
      v40 = *(_DWORD *)v39;
      v41 = *(_DWORD *)v39 == 0;
      if ( *(_DWORD *)v39 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v40 + 4));
        if ( v41 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v40 + 4))(v40);
      }
      v39 = (char *)v39 + 4;
    }
    while ( v38 != v39 );
    v38 = v91;
  }
  if ( v38 )
    operator delete(v38);
  v42 = v89 - 12;
  if ( (_DWORD *)(v89 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v56 = _InterlockedExchangeAdd((volatile signed __int32 *)(v89 - 4), 0xFFFFFFFF);
    }
    else
    {
      v56 = *(_DWORD *)(v89 - 4);
      *(_DWORD *)(v89 - 4) = v56 - 1;
    }
    if ( v56 <= 0 )
      std::string::_Rep::_M_destroy(v42, &v85);
  }
  v43 = v88 - 12;
  if ( (_DWORD *)(v88 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v57 = _InterlockedExchangeAdd((volatile signed __int32 *)(v88 - 4), 0xFFFFFFFF);
    }
    else
    {
      v57 = *(_DWORD *)(v88 - 4);
      *(_DWORD *)(v88 - 4) = v57 - 1;
    }
    if ( v57 <= 0 )
      std::string::_Rep::_M_destroy(v43, &v85);
  }
  sub_80B18C0((int)v62);
  sub_80A4940((int)&v86);
  return v61;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 809A860: using guessed type int sub_809A860(void);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF894: using guessed type int dword_80CF894;
// 80CF898: using guessed type int dword_80CF898;

//----- (0809B0F0) --------------------------------------------------------
int __usercall sub_809B0F0@<eax>(const char *a1@<eax>, std::ios_base *a2@<ebp>, int a3@<edi>)
{
  const char *v3; // ebx@1
  int v4; // eax@3
  int v5; // ebx@3
  char v6; // al@5
  std::ostream *v7; // eax@6
  std::ostream *v8; // ebx@6
  int v9; // eax@6
  int v10; // esi@6
  char v11; // al@8
  std::ostream *v12; // eax@9
  int v14; // esi@12
  size_t v15; // eax@12
  int v16; // eax@12
  int v17; // edx@13
  int v18; // eax@15
  int v19; // edx@15
  int v20; // edx@16
  int v21; // eax@17
  int v22; // eax@18
  std::ostream *v23; // esi@18
  int v24; // eax@18
  int v25; // ebx@18
  char v26; // al@20
  std::ostream *v27; // eax@21
  int v28; // edx@22
  signed __int32 v29; // eax@24
  signed __int32 v30; // ecx@32
  signed __int32 v31; // ecx@36
  int v32; // ebx@39
  signed __int32 v33; // ecx@42
  int v34; // [sp+Ch] [bp-E0h]@0
  char v35; // [sp+12h] [bp-DAh]@34
  char v36; // [sp+13h] [bp-D9h]@14
  int v37; // [sp+14h] [bp-D8h]@12
  int v38; // [sp+18h] [bp-D4h]@14
  int v39; // [sp+1Ch] [bp-D0h]@12
  int v40; // [sp+20h] [bp-CCh]@12
  int v41; // [sp+24h] [bp-C8h]@12
  int v42; // [sp+28h] [bp-C4h]@12
  int v43; // [sp+2Ch] [bp-C0h]@12
  int v44; // [sp+30h] [bp-BCh]@12
  int v45; // [sp+34h] [bp-B8h]@12
  int v46; // [sp+38h] [bp-B4h]@12
  char v47; // [sp+3Ch] [bp-B0h]@12
  int v48; // [sp+40h] [bp-ACh]@12
  int v49; // [sp+44h] [bp-A8h]@12
  int v50; // [sp+48h] [bp-A4h]@12
  int v51; // [sp+B8h] [bp-34h]@12
  char v52; // [sp+BCh] [bp-30h]@12
  char v53; // [sp+BDh] [bp-2Fh]@12
  int v54; // [sp+C0h] [bp-2Ch]@12
  int v55; // [sp+C4h] [bp-28h]@12
  int v56; // [sp+C8h] [bp-24h]@12
  int v57; // [sp+CCh] [bp-20h]@12

  v3 = a1;
  if ( a1 && log_level <= 5 )
  {
    a2 = (std::ios_base *)&v50;
    std::ios_base::ios_base((std::ios_base *)&v50);
    v50 = (int)&unk_80CF5C8;
    v51 = 0;
    v52 = 0;
    v53 = 0;
    v54 = 0;
    v55 = 0;
    v56 = 0;
    v57 = 0;
    a3 = dword_80CF674;
    v39 = dword_80CF674;
    *(int *)((char *)&v39 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v39 + *(_DWORD *)(v39 - 12), 0);
    v39 = (int)&unk_80CF5DC;
    v50 = (int)&unk_80CF5F0;
    v40 = (int)&unk_80CF7F0;
    v41 = 0;
    v42 = 0;
    v43 = 0;
    v44 = 0;
    v45 = 0;
    v46 = 0;
    std::locale::locale((std::locale *)&v47);
    v40 = (int)&unk_80CF588;
    v48 = 16;
    v49 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v50, &v40);
    v14 = std::__ostream_insert<char,std::char_traits<char>>(
            &v39,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v14, "Ivalid command line option: ", 28);
    v15 = strlen(v3);
    std::__ostream_insert<char,std::char_traits<char>>(v14, v3, v15);
    v37 = (int)&unk_80CF83C;
    v16 = *(_DWORD *)(v14 + 24);
    if ( v16 )
    {
      v17 = *(_DWORD *)(v14 + 16);
      LOBYTE(v34) = 0;
      if ( v16 > (unsigned int)v17 )
      {
        v38 = std::string::_S_construct<char *>(
                (int)&v36,
                (unsigned int)&v50,
                (void *)a3,
                *(_DWORD *)(v14 + 20),
                v16,
                (int)&v36);
        std::string::swap((std::string *)&v37, (std::string *)&v38);
      }
      else
      {
        v38 = std::string::_S_construct<char *>(
                (int)&v36,
                (unsigned int)&v50,
                (void *)a3,
                *(_DWORD *)(v14 + 20),
                v17,
                (int)&v36);
        std::string::swap((std::string *)&v37, (std::string *)&v38);
      }
      v18 = v38;
      v19 = v38 - 12;
      if ( (_DWORD *)(v38 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        goto LABEL_31;
    }
    else
    {
      std::string::assign((std::string *)&v37, (const std::string *)(v14 + 40));
    }
    goto LABEL_16;
  }
  while ( 1 )
  {
    std::__ostream_insert<char,std::char_traits<char>>(
      &std::cout,
      "Usage: urlcheck [--config <cfg_path>] [--node-id <id>] [--session-id <session>] [--continue-session] [--log-level <level>] [--service]",
      134);
    std::__ostream_insert<char,std::char_traits<char>>(&std::cout, " [--attach-parent]", 18);
    std::__ostream_insert<char,std::char_traits<char>>(&std::cout, " [--help]", 9);
    v4 = *(_DWORD *)(std::cout - 12);
    v5 = *(int *)((char *)&dword_80CF764 + v4);
    if ( v5 )
    {
      if ( *(_BYTE *)(v5 + 28) )
      {
        v6 = *(_BYTE *)(v5 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(int *)((char *)&dword_80CF764 + v4));
        v6 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v5 + 24))(v5, 10);
      }
      v7 = (std::ostream *)std::ostream::put((std::ostream *)&std::cout, v6);
      v8 = (std::ostream *)std::ostream::flush(v7);
      std::__ostream_insert<char,std::char_traits<char>>(v8, "  default config path: ", 23);
      std::__ostream_insert<char,std::char_traits<char>>(v8, "urlcheck.conf", 13);
      v9 = *(_DWORD *)(*(_DWORD *)v8 - 12);
      v10 = *(_DWORD *)((char *)v8 + v9 + 124);
      if ( v10 )
        break;
    }
    v18 = std::__throw_bad_cast();
LABEL_31:
    if ( &_pthread_key_create )
    {
      v30 = _InterlockedExchangeAdd((volatile signed __int32 *)(v18 - 4), 0xFFFFFFFF);
    }
    else
    {
      v30 = *(_DWORD *)(v18 - 4);
      *(_DWORD *)(v18 - 4) = v30 - 1;
    }
    if ( v30 <= 0 )
      std::string::_Rep::_M_destroy(v19, &v35);
LABEL_16:
    v39 = (int)&unk_80CF5DC;
    v50 = (int)&unk_80CF5F0;
    v40 = (int)&unk_80CF588;
    v20 = v49 - 12;
    if ( (_DWORD *)(v49 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v31 = _InterlockedExchangeAdd((volatile signed __int32 *)(v49 - 4), 0xFFFFFFFF);
      }
      else
      {
        v31 = *(_DWORD *)(v49 - 4);
        *(_DWORD *)(v49 - 4) = v31 - 1;
      }
      if ( v31 <= 0 )
        std::string::_Rep::_M_destroy(v20, &v38);
    }
    v40 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v47);
    v39 = a3;
    v21 = *(_DWORD *)(a3 - 12);
    a3 = dword_80CF678;
    *(int *)((char *)&v39 + v21) = dword_80CF678;
    v50 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base(a2);
    if ( byte_80CE64C )
    {
      v22 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v37, *(_DWORD *)(v37 - 12));
      v23 = (std::ostream *)v22;
      v24 = *(_DWORD *)(*(_DWORD *)v22 - 12);
      v25 = *(_DWORD *)((char *)v23 + v24 + 124);
      if ( !v25 )
      {
        v32 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v37 - 12, &v39);
        Unwind_Resume(v32);
      }
      if ( *(_BYTE *)(v25 + 28) )
      {
        v26 = *(_BYTE *)(v25 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v23 + v24 + 124));
        v26 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v25 + 24))(v25, 10);
      }
      v27 = (std::ostream *)std::ostream::put(v23, v26);
      std::ostream::flush(v27);
    }
    syslog(3, "%s", v37, v34);
    v28 = v37 - 12;
    if ( (_DWORD *)(v37 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v29 = _InterlockedExchangeAdd((volatile signed __int32 *)(v37 - 4), 0xFFFFFFFF);
      }
      else
      {
        v33 = *(_DWORD *)(v37 - 4);
        *(_DWORD *)(v37 - 4) = v33 - 1;
        v29 = v33;
      }
      if ( v29 <= 0 )
        std::string::_Rep::_M_destroy(v28, &v39);
    }
  }
  if ( *(_BYTE *)(v10 + 28) )
  {
    v11 = *(_BYTE *)(v10 + 39);
  }
  else
  {
    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v8 + v9 + 124));
    v11 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v10 + 24))(v10, 10);
  }
  v12 = (std::ostream *)std::ostream::put(v8, v11);
  return std::ostream::flush(v12);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF764: using guessed type int dword_80CF764;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0809B700) --------------------------------------------------------
int __cdecl parse_config(signed int a1, int a2)
{
  unsigned int v2; // ebp@0
  bool v3; // zf@2
  signed int v4; // edx@2
  int v5; // eax@3
  int v6; // esi@3
  int v7; // edi@3
  signed int v8; // ecx@3
  signed int v9; // ecx@7
  int v10; // esi@7
  signed int v11; // ecx@11
  int v12; // esi@11
  int v13; // edi@11
  signed int v14; // ebx@18
  bool v15; // zf@18
  int v16; // eax@21
  int v17; // esi@21
  signed int v18; // ecx@21
  int v19; // edi@21
  int v20; // edi@25
  signed int v21; // ecx@25
  int v22; // esi@25
  int v23; // edi@29
  signed int v24; // ecx@29
  int v25; // esi@29
  int result; // eax@34
  int v27; // edi@38
  signed int v28; // ecx@38
  int v29; // esi@38
  int v30; // edi@43
  signed int v31; // ecx@43
  int v32; // esi@43
  int v33; // edi@48
  signed int v34; // ecx@48
  int v35; // esi@48
  int v36; // edi@53
  signed int v37; // ecx@53
  int v38; // esi@53
  int v39; // edi@60
  signed int v40; // ecx@60
  int v41; // esi@60
  char *v42; // edi@65
  signed int v43; // ecx@65
  int v44; // esi@65
  int v45; // edi@70
  signed int v46; // ecx@70
  int v47; // esi@70
  int v48; // edi@75
  signed int v49; // ecx@75
  int v50; // esi@75
  const char *v51; // esi@80
  unsigned int v52; // eax@80
  const char *v53; // esi@81
  unsigned int v54; // eax@81
  int v55; // edx@82
  signed __int32 v56; // eax@84
  int v57; // ebx@88
  int v58; // esi@88
  int v59; // eax@88
  int v60; // edx@88
  int v61; // ecx@89
  int v62; // edx@91
  int v63; // edx@92
  int v64; // edx@93
  int v65; // eax@95
  std::ostream *v66; // esi@95
  int v67; // eax@95
  int v68; // ebx@95
  char v69; // al@97
  std::ostream *v70; // eax@98
  int v71; // edx@99
  char *v72; // eax@105
  int v73; // eax@105
  const char *v74; // esi@106
  unsigned int v75; // eax@106
  signed __int32 v76; // ecx@115
  int v77; // ecx@117
  signed __int32 v78; // eax@119
  signed __int32 v79; // eax@123
  signed __int32 v80; // eax@127
  signed __int32 v81; // ecx@130
  signed __int32 v82; // ecx@131
  signed __int32 v83; // ecx@132
  int v84; // [sp+Ch] [bp-FCh]@0
  char *s; // [sp+14h] [bp-F4h]@2
  int v86; // [sp+18h] [bp-F0h]@18
  char v87; // [sp+2Eh] [bp-DAh]@129
  char v88; // [sp+2Fh] [bp-D9h]@90
  int v89; // [sp+30h] [bp-D8h]@88
  int v90; // [sp+34h] [bp-D4h]@82
  int v91; // [sp+38h] [bp-D0h]@86
  int v92; // [sp+3Ch] [bp-CCh]@82
  int v93; // [sp+40h] [bp-C8h]@88
  int v94; // [sp+44h] [bp-C4h]@88
  int v95; // [sp+48h] [bp-C0h]@88
  int v96; // [sp+4Ch] [bp-BCh]@88
  int v97; // [sp+50h] [bp-B8h]@88
  int v98; // [sp+54h] [bp-B4h]@88
  int v99; // [sp+58h] [bp-B0h]@88
  char v100; // [sp+5Ch] [bp-ACh]@88
  int v101; // [sp+60h] [bp-A8h]@88
  int v102; // [sp+64h] [bp-A4h]@88
  int v103; // [sp+68h] [bp-A0h]@88
  int v104; // [sp+D8h] [bp-30h]@88
  char v105; // [sp+DCh] [bp-2Ch]@88
  char v106; // [sp+DDh] [bp-2Bh]@88
  int v107; // [sp+E0h] [bp-28h]@88
  int v108; // [sp+E4h] [bp-24h]@88
  int v109; // [sp+E8h] [bp-20h]@88
  int v110; // [sp+ECh] [bp-1Ch]@88

  if ( a1 > 1 )
  {
    s = "urlcheck.conf";
    v3 = a1 == 1;
    v4 = 1;
    do
    {
      v5 = 4 * v4;
      v6 = *(_DWORD *)(a2 + 4 * v4);
      v7 = (int)"-h";
      v8 = 3;
      do
      {
        if ( !v8 )
          break;
        v3 = *(_BYTE *)v6++ == *(_BYTE *)v7++;
        --v8;
      }
      while ( v3 );
      if ( v3 )
        goto LABEL_135;
      v7 = (int)"--help";
      v9 = 7;
      v10 = *(_DWORD *)(a2 + 4 * v4);
      do
      {
        if ( !v9 )
          break;
        v3 = *(_BYTE *)v10++ == *(_BYTE *)v7++;
        --v9;
      }
      while ( v3 );
      if ( v3 )
      {
LABEL_135:
        sub_809B0F0(0, (std::ios_base *)v2, v7);
        exit(2);
      }
      v11 = 9;
      v12 = *(_DWORD *)(a2 + 4 * v4);
      v13 = (int)"--config";
      do
      {
        if ( !v11 )
          break;
        v3 = *(_BYTE *)v12++ == *(_BYTE *)v13++;
        --v11;
      }
      while ( v3 );
      if ( v3 && a1 - 1 > v4 )
      {
        ++v4;
        s = *(char **)(a2 + v5 + 4);
      }
      ++v4;
      v3 = a1 == v4;
    }
    while ( a1 > v4 );
    sub_805A050("/etc/urlcheck.conf");
    sub_805A050(s);
    v14 = 1;
    v15 = a1 == 1;
    v86 = a1 - 1;
    while ( 1 )
    {
      while ( 1 )
      {
        v16 = 4 * v14;
        v17 = *(_DWORD *)(a2 + 4 * v14);
        v18 = 9;
        v19 = (int)"--config";
        do
        {
          if ( !v18 )
            break;
          v15 = *(_BYTE *)v17++ == *(_BYTE *)v19++;
          --v18;
        }
        while ( v15 );
        if ( !v15 )
          break;
        ++v14;
LABEL_20:
        ++v14;
        v15 = a1 == v14;
        if ( a1 <= v14 )
          goto LABEL_34;
      }
      v20 = (int)"--attach-parent";
      v21 = 16;
      v22 = *(_DWORD *)(a2 + 4 * v14);
      do
      {
        if ( !v21 )
          break;
        v15 = *(_BYTE *)v22++ == *(_BYTE *)v20++;
        --v21;
      }
      while ( v15 );
      if ( v15 )
      {
        prctl(1, 1);
        goto LABEL_20;
      }
      v23 = (int)"--service";
      v24 = 10;
      v25 = *(_DWORD *)(a2 + 4 * v14);
      do
      {
        if ( !v24 )
          break;
        v15 = *(_BYTE *)v25++ == *(_BYTE *)v23++;
        --v24;
      }
      while ( v15 );
      if ( !v15 )
      {
        v27 = (int)"--node-id";
        v28 = 10;
        v29 = *(_DWORD *)(a2 + 4 * v14);
        do
        {
          if ( !v28 )
            break;
          v15 = *(_BYTE *)v29++ == *(_BYTE *)v27++;
          --v28;
        }
        while ( v15 );
        if ( v15 && (v15 = v86 == v14, v86 > v14) )
        {
          ++v14;
          v51 = *(const char **)(a2 + v16 + 4);
          v52 = strlen(*(const char **)(a2 + v16 + 4));
          std::string::assign((std::string *)&dword_80CF898, v51, v52);
        }
        else
        {
          v30 = (int)byte_80BD510;
          v31 = 8;
          v32 = *(_DWORD *)(a2 + 4 * v14);
          do
          {
            if ( !v31 )
              break;
            v15 = *(_BYTE *)v32++ == *(_BYTE *)v30++;
            --v31;
          }
          while ( v15 );
          if ( v15 && (v15 = v86 == v14, v86 > v14) )
          {
            ++v14;
            v53 = *(const char **)(a2 + v16 + 4);
            v54 = strlen(*(const char **)(a2 + v16 + 4));
            std::string::assign((std::string *)&dword_80CF890, v53, v54);
          }
          else
          {
            v33 = (int)"--log-level";
            v34 = 12;
            v35 = *(_DWORD *)(a2 + 4 * v14);
            do
            {
              if ( !v34 )
                break;
              v15 = *(_BYTE *)v35++ == *(_BYTE *)v33++;
              --v34;
            }
            while ( v15 );
            if ( v15 && (v15 = v86 == v14, v86 > v14) )
            {
              ++v14;
              std::string::string(&v92, *(_DWORD *)(a2 + v16 + 4), &v90);
              init_loglevel((std::string *)&v92);
              v55 = v92 - 12;
              if ( (_DWORD *)(v92 - 12) != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v56 = _InterlockedExchangeAdd((volatile signed __int32 *)(v92 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v76 = *(_DWORD *)(v92 - 4);
                  *(_DWORD *)(v92 - 4) = v76 - 1;
                  v56 = v76;
                }
                if ( v56 <= 0 )
                  std::string::_Rep::_M_destroy(v55, &v91);
              }
            }
            else
            {
              v36 = (int)"--terminate-after";
              v37 = 18;
              v38 = *(_DWORD *)(a2 + 4 * v14);
              do
              {
                if ( !v37 )
                  break;
                v15 = *(_BYTE *)v38++ == *(_BYTE *)v36++;
                --v37;
              }
              while ( v15 );
              if ( v15 && (v15 = v86 == v14, v86 > v14) )
              {
                ++v14;
                terminate_timeout = atoi(*(const char **)(a2 + v16 + 4));
              }
              else
              {
                v39 = (int)"--graceful-terminate";
                v40 = 21;
                v41 = *(_DWORD *)(a2 + 4 * v14);
                do
                {
                  if ( !v40 )
                    break;
                  v15 = *(_BYTE *)v41++ == *(_BYTE *)v39++;
                  --v40;
                }
                while ( v15 );
                if ( v15 )
                {
                  graceful_terminate = 1;
                }
                else
                {
                  v42 = &byte_80BD54B;
                  v43 = 19;
                  v44 = *(_DWORD *)(a2 + 4 * v14);
                  do
                  {
                    if ( !v43 )
                      break;
                    v15 = *(_BYTE *)v44++ == *v42++;
                    --v43;
                  }
                  while ( v15 );
                  if ( v15 && (v15 = v86 == v14, v86 > v14) )
                  {
                    ++v14;
                    v74 = *(const char **)(a2 + v16 + 4);
                    v75 = strlen(*(const char **)(a2 + v16 + 4));
                    std::string::assign((std::string *)&dword_80CF870, v74, v75);
                  }
                  else
                  {
                    v45 = (int)"--session-id";
                    v46 = 13;
                    v47 = *(_DWORD *)(a2 + 4 * v14);
                    do
                    {
                      if ( !v46 )
                        break;
                      v15 = *(_BYTE *)v47++ == *(_BYTE *)v45++;
                      --v46;
                    }
                    while ( v15 );
                    if ( v15 && (v15 = v86 == v14, v86 > v14) )
                    {
                      ++v14;
                      LOWORD(g_time) = atoi(*(const char **)(a2 + v16 + 4));
                      g_time = (unsigned __int16)g_time;
                    }
                    else
                    {
                      v48 = (int)"--continue-session";
                      v49 = 19;
                      v50 = *(_DWORD *)(a2 + 4 * v14);
                      do
                      {
                        if ( !v49 )
                          break;
                        v15 = *(_BYTE *)v50++ == *(_BYTE *)v48++;
                        --v49;
                      }
                      while ( v15 );
                      if ( !v15 )
                      {
                        sub_809B0F0(*(const char **)(a2 + 4 * v14), (std::ios_base *)v2, v48);
                        exit(3);
                      }
                      byte_80CF868 = 1;
                    }
                  }
                }
              }
            }
          }
        }
        goto LABEL_20;
      }
      byte_80CE64C = 0;
      ++v14;
      v15 = a1 == v14;
      if ( a1 <= v14 )
        goto LABEL_34;
    }
  }
  sub_805A050("/etc/urlcheck.conf");
  sub_805A050("urlcheck.conf");
LABEL_34:
  _InterlockedExchange((volatile signed __int32 *)&dword_80CF860, dword_80CE668);
  _InterlockedExchange((volatile signed __int32 *)&dword_80CF85C, dword_80CE664);
  _InterlockedExchange((volatile signed __int32 *)&dword_80CF858, dword_80CE660);
  _InterlockedExchange((volatile signed __int32 *)&dword_80CF850, dword_80CE658);
  _InterlockedExchange((volatile signed __int32 *)&dword_80CF84C, dword_80CE654);
  _InterlockedExchange((volatile signed __int32 *)&dword_80CF854, dword_80CE65C);
  result = g_idrsa_path;
  if ( !*(_DWORD *)(g_idrsa_path - 12) )
  {
    std::string::resize((std::string *)&g_idrsa_path, 0x50u, 0);
    v72 = getenv("HOME");
    v73 = snprintf(g_idrsa_path, *(_DWORD *)(g_idrsa_path - 12), "%s/.ssh/id_rsa", v72);
    result = std::string::resize((std::string *)&g_idrsa_path, v73, 0);
  }
  if ( !g_time )
  {
    result = (unsigned __int16)time(0) | 1;
    g_time = result;
  }
  if ( log_level <= 3 )
  {
    sub_805D460((std::string *)&v90);
    std::ios_base::ios_base((std::ios_base *)&v103);
    v103 = (int)&unk_80CF5C8;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v109 = 0;
    v110 = 0;
    v57 = dword_80CF674;
    v92 = dword_80CF674;
    *(int *)((char *)&v92 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v92 + *(_DWORD *)(v92 - 12), 0);
    v92 = (int)&unk_80CF5DC;
    v103 = (int)&unk_80CF5F0;
    v93 = (int)&unk_80CF7F0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    v98 = 0;
    v99 = 0;
    std::locale::locale((std::locale *)&v100);
    v93 = (int)&unk_80CF588;
    v101 = 16;
    v102 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v103, &v93);
    v58 = std::__ostream_insert<char,std::char_traits<char>>(
            &v92,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v58, "Running agent ", 14);
    std::__ostream_insert<char,std::char_traits<char>>(v58, "WRT-1.3.0.38254", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v58, " with config: ", 14);
    v59 = std::__ostream_insert<char,std::char_traits<char>>(v58, v90, *(_DWORD *)(v90 - 12));
    v89 = (int)&unk_80CF83C;
    v60 = *(_DWORD *)(v59 + 24);
    if ( v60 )
    {
      v61 = *(_DWORD *)(v59 + 16);
      LOBYTE(v84) = 0;
      if ( v60 > (unsigned int)v61 )
      {
        v91 = std::string::_S_construct<char *>(v57, v2, &v103, *(_DWORD *)(v59 + 20), v60, (int)&v88);
        std::string::swap((std::string *)&v89, (std::string *)&v91);
      }
      else
      {
        v91 = std::string::_S_construct<char *>(v57, v2, &v103, *(_DWORD *)(v59 + 20), v61, (int)&v88);
        std::string::swap((std::string *)&v89, (std::string *)&v91);
      }
      v62 = v91 - 12;
      if ( (_DWORD *)(v91 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v80 = _InterlockedExchangeAdd((volatile signed __int32 *)(v91 - 4), 0xFFFFFFFF);
        }
        else
        {
          v82 = *(_DWORD *)(v91 - 4);
          *(_DWORD *)(v91 - 4) = v82 - 1;
          v80 = v82;
        }
        if ( v80 <= 0 )
          std::string::_Rep::_M_destroy(v62, &v87);
      }
    }
    else
    {
      std::string::assign((std::string *)&v89, (const std::string *)(v59 + 40));
    }
    v92 = (int)&unk_80CF5DC;
    v103 = (int)&unk_80CF5F0;
    v93 = (int)&unk_80CF588;
    v63 = v102 - 12;
    if ( (_DWORD *)(v102 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v79 = _InterlockedExchangeAdd((volatile signed __int32 *)(v102 - 4), 0xFFFFFFFF);
      }
      else
      {
        v83 = *(_DWORD *)(v102 - 4);
        *(_DWORD *)(v102 - 4) = v83 - 1;
        v79 = v83;
      }
      if ( v79 <= 0 )
        std::string::_Rep::_M_destroy(v63, &v91);
    }
    v93 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v100);
    v92 = v57;
    *(int *)((char *)&v92 + *(_DWORD *)(v57 - 12)) = dword_80CF678;
    v103 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v103);
    v64 = v90 - 12;
    if ( (_DWORD *)(v90 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v78 = _InterlockedExchangeAdd((volatile signed __int32 *)(v90 - 4), 0xFFFFFFFF);
      }
      else
      {
        v81 = *(_DWORD *)(v90 - 4);
        *(_DWORD *)(v90 - 4) = v81 - 1;
        v78 = v81;
      }
      if ( v78 <= 0 )
        std::string::_Rep::_M_destroy(v64, &v92);
    }
    if ( byte_80CE64C )
    {
      v65 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v89, *(_DWORD *)(v89 - 12));
      v66 = (std::ostream *)v65;
      v67 = *(_DWORD *)(*(_DWORD *)v65 - 12);
      v68 = *(_DWORD *)((char *)v66 + v67 + 124);
      if ( !v68 )
      {
        result = std::__throw_bad_cast();
        goto LABEL_117;
      }
      if ( *(_BYTE *)(v68 + 28) )
      {
        v69 = *(_BYTE *)(v68 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v66 + v67 + 124));
        v69 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v68 + 24))(v68, 10);
      }
      v70 = (std::ostream *)std::ostream::put(v66, v69);
      std::ostream::flush(v70);
    }
    syslog(5, "%s", v89, v84);
    result = v89;
    v71 = v89 - 12;
    if ( (_DWORD *)(v89 - 12) == &std::string::_Rep::_S_empty_rep_storage )
      return result;
    if ( &_pthread_key_create )
    {
      result = _InterlockedExchangeAdd((volatile signed __int32 *)(v89 - 4), 0xFFFFFFFF);
      goto LABEL_102;
    }
LABEL_117:
    v77 = *(_DWORD *)(result - 4);
    *(_DWORD *)(result - 4) = v77 - 1;
    result = v77;
LABEL_102:
    if ( result <= 0 )
      result = std::string::_Rep::_M_destroy(v71, &v92);
  }
  return result;
}
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80BD54B: using guessed type char byte_80BD54B;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CE654: using guessed type int dword_80CE654;
// 80CE658: using guessed type int dword_80CE658;
// 80CE65C: using guessed type int dword_80CE65C;
// 80CE660: using guessed type int dword_80CE660;
// 80CE664: using guessed type int dword_80CE664;
// 80CE668: using guessed type int dword_80CE668;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF84C: using guessed type int dword_80CF84C;
// 80CF850: using guessed type int dword_80CF850;
// 80CF854: using guessed type int dword_80CF854;
// 80CF858: using guessed type int dword_80CF858;
// 80CF85C: using guessed type int dword_80CF85C;
// 80CF860: using guessed type int dword_80CF860;
// 80CF868: using guessed type char byte_80CF868;
// 80CF86C: using guessed type int g_time;
// 80CF870: using guessed type int dword_80CF870;
// 80CF874: using guessed type int log_level;
// 80CF878: using guessed type char graceful_terminate;
// 80CF87C: using guessed type int terminate_timeout;
// 80CF898: using guessed type int dword_80CF898;

//----- (0809C210) --------------------------------------------------------
int __cdecl sub_809C210(int a1)
{
  void *v1; // eax@1
  int v2; // eax@3
  int v3; // ebp@4
  int v4; // esi@5
  int v5; // eax@5
  int v6; // eax@8
  void *v7; // edi@11
  void *v8; // ebx@11
  int v9; // eax@12
  int v10; // edx@12
  void *v11; // edi@17
  void *v12; // ebx@17
  int v13; // eax@18
  int v14; // edx@18
  int v15; // eax@23
  int v16; // edx@23
  int v17; // eax@24
  int v18; // eax@29
  int v19; // ebp@30
  int v20; // esi@31
  int v21; // eax@31
  int v22; // eax@34
  void *v23; // edi@37
  void *v24; // ebx@37
  int v25; // eax@38
  int v26; // edx@38
  void *v27; // edi@43
  void *v28; // ebx@43
  int v29; // eax@44
  int v30; // edx@44
  int v31; // eax@49
  int v32; // edx@49
  int v33; // eax@50
  int v34; // eax@55
  bool v35; // zf@55
  void *v36; // esi@62
  void *v37; // ebx@62
  int v38; // eax@63
  bool v39; // zf@63
  void *v40; // esi@70
  void *v41; // ebx@70
  int v42; // eax@71
  bool v43; // zf@71
  int v44; // eax@78
  int v45; // ecx@78
  int v46; // eax@79
  int v47; // ecx@79
  signed __int32 v49; // eax@82
  signed __int32 v50; // eax@86
  signed __int32 v51; // eax@90
  signed __int32 v52; // eax@94
  signed __int32 v53; // ecx@97
  signed __int32 v54; // eax@99
  signed __int32 v55; // ebx@103
  signed __int32 v56; // eax@107
  signed __int32 v57; // ebx@111
  signed __int32 v58; // ecx@114
  signed __int32 v59; // eax@116
  signed __int32 v60; // ebx@119
  signed __int32 v61; // ebx@120
  signed __int32 v62; // eax@122
  signed __int32 v63; // edx@125
  signed __int32 v64; // edx@126
  signed __int32 v65; // ecx@127
  signed __int32 v66; // ecx@129
  int v67; // [sp+Ch] [bp-60h]@4
  int v68; // [sp+Ch] [bp-60h]@30
  int v69; // [sp+10h] [bp-5Ch]@3
  int v70; // [sp+10h] [bp-5Ch]@29
  int v71; // [sp+14h] [bp-58h]@4
  int v72; // [sp+14h] [bp-58h]@30
  void *v73; // [sp+1Ch] [bp-50h]@3
  void *v74; // [sp+1Ch] [bp-50h]@29
  int v75; // [sp+20h] [bp-4Ch]@4
  int v76; // [sp+20h] [bp-4Ch]@30
  int v77; // [sp+24h] [bp-48h]@4
  int v78; // [sp+24h] [bp-48h]@30
  int v79; // [sp+28h] [bp-44h]@4
  int v80; // [sp+28h] [bp-44h]@30
  int v81; // [sp+2Ch] [bp-40h]@4
  int v82; // [sp+2Ch] [bp-40h]@30
  int v83; // [sp+30h] [bp-3Ch]@2
  int v84; // [sp+34h] [bp-38h]@2
  int v85; // [sp+38h] [bp-34h]@2
  void *v86; // [sp+3Ch] [bp-30h]@1
  char v87; // [sp+4Fh] [bp-1Dh]@84

  v86 = *(void **)(a1 + 484);
  v1 = *(void **)(a1 + 480);
  if ( v86 != v1 )
  {
    v84 = (int)((char *)v1 + 32);
    v85 = (int)((char *)v1 + 20);
    v83 = *(_DWORD *)(a1 + 480);
    do
    {
      v73 = *(void **)v84;
      v2 = *(_DWORD *)(v84 - 4);
      v69 = v2;
      if ( *(_DWORD *)v84 != v2 )
      {
        v71 = v2 + 28;
        v3 = v2 + 48;
        v67 = *(_DWORD *)(v84 - 4);
        v81 = v2 + 60;
        v79 = v2 + 56;
        v77 = v2 + 20;
        v75 = v2 + 8;
        do
        {
          v4 = v67 - v69;
          v5 = *(_DWORD *)(v67 - v69 + v81);
          if ( v5 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
            if ( !v5 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
          }
          v6 = *(_DWORD *)(v4 + v79);
          if ( v6 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v6 + 4));
            if ( !v6 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
          }
          v7 = *(void **)v3;
          v8 = *(void **)(v3 - 4);
          if ( *(void **)v3 != v8 )
          {
            do
            {
              v9 = *(_DWORD *)v8;
              v10 = *(_DWORD *)v8 - 12;
              if ( (_DWORD *)v10 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v52 = _InterlockedExchangeAdd((volatile signed __int32 *)(v9 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v53 = *(_DWORD *)(v9 - 4);
                  *(_DWORD *)(v9 - 4) = v53 - 1;
                  v52 = v53;
                }
                if ( v52 <= 0 )
                  std::string::_Rep::_M_destroy(v10, &v87);
              }
              v8 = (char *)v8 + 4;
            }
            while ( v7 != v8 );
            v7 = *(void **)(v67 + 44);
          }
          if ( v7 )
            operator delete(v7);
          v11 = *(void **)v71;
          v12 = *(void **)(v71 - 4);
          if ( *(void **)v71 != v12 )
          {
            do
            {
              v13 = *(_DWORD *)v12;
              v14 = *(_DWORD *)v12 - 12;
              if ( (_DWORD *)v14 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v51 = _InterlockedExchangeAdd((volatile signed __int32 *)(v13 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v66 = *(_DWORD *)(v13 - 4);
                  *(_DWORD *)(v13 - 4) = v66 - 1;
                  v51 = v66;
                }
                if ( v51 <= 0 )
                  std::string::_Rep::_M_destroy(v14, &v87);
              }
              v12 = (char *)v12 + 4;
            }
            while ( v11 != v12 );
            v11 = *(void **)(v67 + 24);
          }
          if ( v11 )
            operator delete(v11);
          v15 = *(_DWORD *)(v4 + v77);
          v16 = v15 - 12;
          if ( (_DWORD *)(v15 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v54 = _InterlockedExchangeAdd((volatile signed __int32 *)(v15 - 4), 0xFFFFFFFF);
            }
            else
            {
              v60 = *(_DWORD *)(v15 - 4);
              *(_DWORD *)(v15 - 4) = v60 - 1;
              v54 = v60;
            }
            if ( v54 <= 0 )
              std::string::_Rep::_M_destroy(v16, &v87);
          }
          v17 = *(_DWORD *)(v4 + v75);
          if ( (_DWORD *)(v17 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v55 = _InterlockedExchangeAdd((volatile signed __int32 *)(v17 - 4), 0xFFFFFFFF);
            }
            else
            {
              v55 = *(_DWORD *)(v17 - 4);
              *(_DWORD *)(v17 - 4) = v55 - 1;
            }
            if ( v55 <= 0 )
              std::string::_Rep::_M_destroy(v17 - 12, &v87);
          }
          v67 += 64;
          v71 += 64;
          v3 += 64;
        }
        while ( v73 != (void *)v67 );
        v73 = *(void **)(v83 + 28);
      }
      if ( v73 )
        operator delete(v73);
      v74 = *(void **)v85;
      v18 = *(_DWORD *)(v85 - 4);
      v70 = v18;
      if ( *(_DWORD *)v85 != v18 )
      {
        v72 = v18 + 28;
        v19 = v18 + 48;
        v68 = *(_DWORD *)(v85 - 4);
        v78 = v18 + 60;
        v76 = v18 + 56;
        v82 = v18 + 20;
        v80 = v18 + 8;
        do
        {
          v20 = v68 - v70;
          v21 = *(_DWORD *)(v68 - v70 + v78);
          if ( v21 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v21 + 4));
            if ( !v21 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
          }
          v22 = *(_DWORD *)(v20 + v76);
          if ( v22 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v22 + 4));
            if ( !v22 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
          }
          v23 = *(void **)v19;
          v24 = *(void **)(v19 - 4);
          if ( *(void **)v19 != v24 )
          {
            do
            {
              v25 = *(_DWORD *)v24;
              v26 = *(_DWORD *)v24 - 12;
              if ( (_DWORD *)v26 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v50 = _InterlockedExchangeAdd((volatile signed __int32 *)(v25 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v58 = *(_DWORD *)(v25 - 4);
                  *(_DWORD *)(v25 - 4) = v58 - 1;
                  v50 = v58;
                }
                if ( v50 <= 0 )
                  std::string::_Rep::_M_destroy(v26, &v87);
              }
              v24 = (char *)v24 + 4;
            }
            while ( v23 != v24 );
            v23 = *(void **)(v68 + 44);
          }
          if ( v23 )
            operator delete(v23);
          v27 = *(void **)v72;
          v28 = *(void **)(v72 - 4);
          if ( *(void **)v72 != v28 )
          {
            do
            {
              v29 = *(_DWORD *)v28;
              v30 = *(_DWORD *)v28 - 12;
              if ( (_DWORD *)v30 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v49 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v65 = *(_DWORD *)(v29 - 4);
                  *(_DWORD *)(v29 - 4) = v65 - 1;
                  v49 = v65;
                }
                if ( v49 <= 0 )
                  std::string::_Rep::_M_destroy(v30, &v87);
              }
              v28 = (char *)v28 + 4;
            }
            while ( v27 != v28 );
            v27 = *(void **)(v68 + 24);
          }
          if ( v27 )
            operator delete(v27);
          v31 = *(_DWORD *)(v20 + v82);
          v32 = v31 - 12;
          if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v59 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
            }
            else
            {
              v61 = *(_DWORD *)(v31 - 4);
              *(_DWORD *)(v31 - 4) = v61 - 1;
              v59 = v61;
            }
            if ( v59 <= 0 )
              std::string::_Rep::_M_destroy(v32, &v87);
          }
          v33 = *(_DWORD *)(v20 + v80);
          if ( (_DWORD *)(v33 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v57 = _InterlockedExchangeAdd((volatile signed __int32 *)(v33 - 4), 0xFFFFFFFF);
            }
            else
            {
              v57 = *(_DWORD *)(v33 - 4);
              *(_DWORD *)(v33 - 4) = v57 - 1;
            }
            if ( v57 <= 0 )
              std::string::_Rep::_M_destroy(v33 - 12, &v87);
          }
          v68 += 64;
          v72 += 64;
          v19 += 64;
        }
        while ( v74 != (void *)v68 );
        v74 = *(void **)(v83 + 16);
      }
      if ( v74 )
        operator delete(v74);
      v34 = *(_DWORD *)v83;
      v35 = *(_DWORD *)v83 == 0;
      if ( *(_DWORD *)v83 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v34 + 4));
        if ( v35 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v34 + 4))(v34);
      }
      v83 += 44;
      v84 += 44;
      v85 += 44;
    }
    while ( v86 != (void *)v83 );
    v86 = *(void **)(a1 + 480);
  }
  if ( v86 )
    operator delete(v86);
  v36 = *(void **)(a1 + 472);
  v37 = *(void **)(a1 + 468);
  if ( v36 != v37 )
  {
    do
    {
      v38 = *(_DWORD *)v37;
      v39 = *(_DWORD *)v37 == 0;
      if ( *(_DWORD *)v37 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v38 + 4));
        if ( v39 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v38 + 4))(v38);
      }
      v37 = (char *)v37 + 4;
    }
    while ( v36 != v37 );
    v36 = *(void **)(a1 + 468);
  }
  if ( v36 )
    operator delete(v36);
  std::condition_variable::~condition_variable((std::condition_variable *)(a1 + 420));
  sub_80A0F70((void *)(a1 + 368));
  v40 = *(void **)(a1 + 360);
  v41 = *(void **)(a1 + 356);
  if ( v40 != v41 )
  {
    do
    {
      v42 = *(_DWORD *)v41;
      v43 = *(_DWORD *)v41 == 0;
      if ( *(_DWORD *)v41 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v42 + 4));
        if ( v43 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v42 + 4))(v42);
      }
      v41 = (char *)v41 + 4;
    }
    while ( v40 != v41 );
    v40 = *(void **)(a1 + 356);
  }
  if ( v40 )
    operator delete(v40);
  v44 = *(_DWORD *)(a1 + 340);
  v45 = v44 - 12;
  if ( (_DWORD *)(v44 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v62 = _InterlockedExchangeAdd((volatile signed __int32 *)(v44 - 4), 0xFFFFFFFF);
    }
    else
    {
      v64 = *(_DWORD *)(v44 - 4);
      *(_DWORD *)(v44 - 4) = v64 - 1;
      v62 = v64;
    }
    if ( v62 <= 0 )
      std::string::_Rep::_M_destroy(v45, &v87);
  }
  v46 = *(_DWORD *)(a1 + 336);
  v47 = v46 - 12;
  if ( (_DWORD *)(v46 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v56 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
    }
    else
    {
      v63 = *(_DWORD *)(v46 - 4);
      *(_DWORD *)(v46 - 4) = v63 - 1;
      v56 = v63;
    }
    if ( v56 <= 0 )
      std::string::_Rep::_M_destroy(v47, &v87);
  }
  return sub_80B18C0(a1);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (0809C930) --------------------------------------------------------
std::string *__stdcall sub_809C930(std::string *a1, unsigned int a2)
{
  FILE *v2; // ebp@1
  unsigned int v3; // eax@2
  unsigned int v4; // eax@4
  unsigned int v5; // edx@5
  char ptr; // [sp+10h] [bp-101Ch]@2

  *(_DWORD *)a1 = &unk_80CF83C;
  v2 = popen("logread", "r");
  if ( v2 )
  {
    while ( 1 )
    {
      v3 = fread(&ptr, 1u, 0x1000u, v2);
      if ( !v3 )
        break;
      std::string::append(a1, &ptr, v3);
      if ( a2 )
      {
        v4 = *(_DWORD *)(*(_DWORD *)a1 - 12);
        if ( a2 < v4 )
        {
          v5 = v4 - a2;
          if ( v4 - a2 > v4 )
            v5 = *(_DWORD *)(*(_DWORD *)a1 - 12);
          std::string::_M_mutate(a1, 0, v5, 0);
        }
      }
    }
    pclose(v2);
  }
  return a1;
}

//----- (0809CA20) --------------------------------------------------------
time_t __cdecl sub_809CA20(int a1)
{
  int v1; // ebx@1
  time_t result; // eax@1

  v1 = a1;
  *(_DWORD *)a1 = &off_80BD870;
  *(_DWORD *)(v1 + 4) = v1;
  *(_DWORD *)(a1 + 8) = 0;
  memset((void *)(a1 + 12), 0, 0x18u);
  *(_DWORD *)(a1 + 36) = &off_80B9500;
  *(_DWORD *)(v1 + 40) = v1 + 36;
  *(_DWORD *)(v1 + 44) = v1 + 36;
  *(_DWORD *)(a1 + 48) = &off_80B9500;
  *(_DWORD *)(v1 + 52) = v1 + 48;
  *(_DWORD *)(v1 + 56) = v1 + 48;
  *(_DWORD *)(a1 + 60) = &off_80B9500;
  *(_DWORD *)(v1 + 64) = v1 + 60;
  *(_DWORD *)(v1 + 68) = v1 + 60;
  *(_DWORD *)(a1 + 76) = 0;
  result = time(0);
  *(_WORD *)(a1 + 72) = result;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BD870: using guessed type void *off_80BD870;

//----- (0809CB60) --------------------------------------------------------
int __cdecl sub_809CB60(int a1)
{
  int v2; // esi@7
  unsigned int v3; // ebp@7
  int v4; // eax@7
  int v5; // edx@8
  int v6; // ebp@9
  int v7; // edx@10
  int v8; // edx@11
  int v9; // edx@13
  signed __int32 v10; // eax@15
  int v11; // eax@19
  std::ostream *v12; // edi@19
  int v13; // eax@19
  int v14; // esi@19
  char v15; // al@21
  std::ostream *v16; // eax@22
  signed __int32 v17; // ecx@26
  signed __int32 v18; // ecx@30
  signed __int32 v19; // ecx@35
  int v20; // [sp+Ch] [bp-E0h]@0
  char v21; // [sp+12h] [bp-DAh]@28
  char v22; // [sp+13h] [bp-D9h]@9
  int v23; // [sp+14h] [bp-D8h]@7
  int v24; // [sp+18h] [bp-D4h]@9
  int v25; // [sp+1Ch] [bp-D0h]@7
  int v26; // [sp+20h] [bp-CCh]@7
  int v27; // [sp+24h] [bp-C8h]@7
  int v28; // [sp+28h] [bp-C4h]@7
  int v29; // [sp+2Ch] [bp-C0h]@7
  int v30; // [sp+30h] [bp-BCh]@7
  int v31; // [sp+34h] [bp-B8h]@7
  int v32; // [sp+38h] [bp-B4h]@7
  char v33; // [sp+3Ch] [bp-B0h]@7
  int v34; // [sp+40h] [bp-ACh]@7
  int v35; // [sp+44h] [bp-A8h]@7
  int v36; // [sp+48h] [bp-A4h]@7
  int v37; // [sp+B8h] [bp-34h]@7
  char v38; // [sp+BCh] [bp-30h]@7
  char v39; // [sp+BDh] [bp-2Fh]@7
  int v40; // [sp+C0h] [bp-2Ch]@7
  int v41; // [sp+C4h] [bp-28h]@7
  int v42; // [sp+C8h] [bp-24h]@7
  int v43; // [sp+CCh] [bp-20h]@7

  if ( log_level <= 2 )
  {
    std::ios_base::ios_base((std::ios_base *)&v36);
    v36 = (int)&unk_80CF5C8;
    v37 = 0;
    v38 = 0;
    v39 = 0;
    v40 = 0;
    v41 = 0;
    v42 = 0;
    v43 = 0;
    v2 = dword_80CF674;
    v25 = dword_80CF674;
    *(int *)((char *)&v25 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v25 + *(_DWORD *)(v25 - 12), 0);
    v25 = (int)&unk_80CF5DC;
    v36 = (int)&unk_80CF5F0;
    v26 = (int)&unk_80CF7F0;
    v27 = 0;
    v28 = 0;
    v29 = 0;
    v30 = 0;
    v31 = 0;
    v32 = 0;
    std::locale::locale((std::locale *)&v33);
    v26 = (int)&unk_80CF588;
    v34 = 16;
    v35 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v36, &v26);
    v3 = std::__ostream_insert<char,std::char_traits<char>>(&v25, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v3, "ICMP disposing listener", 23);
    v23 = (int)&unk_80CF83C;
    v4 = *(_DWORD *)(v3 + 24);
    if ( v4 )
    {
      v5 = *(_DWORD *)(v3 + 16);
      LOBYTE(v20) = 0;
      if ( v4 > (unsigned int)v5 )
      {
        v24 = std::string::_S_construct<char *>(a1, v3, &v36, *(_DWORD *)(v3 + 20), v4, (int)&v22);
        v6 = (int)&v24;
        std::string::swap((std::string *)&v23, (std::string *)&v24);
      }
      else
      {
        v24 = std::string::_S_construct<char *>(a1, v3, &v36, *(_DWORD *)(v3 + 20), v5, (int)&v22);
        v6 = (int)&v24;
        std::string::swap((std::string *)&v23, (std::string *)&v24);
      }
      v7 = v24 - 12;
      if ( (_DWORD *)(v24 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        v6 = (int)&_pthread_key_create;
        if ( &_pthread_key_create )
        {
          v17 = _InterlockedExchangeAdd((volatile signed __int32 *)(v24 - 4), 0xFFFFFFFF);
        }
        else
        {
          v17 = *(_DWORD *)(v24 - 4);
          v6 = v17 - 1;
          *(_DWORD *)(v24 - 4) = v17 - 1;
        }
        if ( v17 <= 0 )
          std::string::_Rep::_M_destroy(v7, &v21);
      }
    }
    else
    {
      v6 = v3 + 40;
      std::string::assign((std::string *)&v23, (const std::string *)v6);
    }
    v25 = (int)&unk_80CF5DC;
    v36 = (int)&unk_80CF5F0;
    v26 = (int)&unk_80CF588;
    v8 = v35 - 12;
    if ( (_DWORD *)(v35 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      v6 = (int)&_pthread_key_create;
      if ( &_pthread_key_create )
      {
        v18 = _InterlockedExchangeAdd((volatile signed __int32 *)(v35 - 4), 0xFFFFFFFF);
      }
      else
      {
        v18 = *(_DWORD *)(v35 - 4);
        v6 = v18 - 1;
        *(_DWORD *)(v35 - 4) = v18 - 1;
      }
      if ( v18 <= 0 )
        std::string::_Rep::_M_destroy(v8, &v24);
    }
    v26 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v33);
    v25 = v2;
    *(int *)((char *)&v25 + *(_DWORD *)(v2 - 12)) = dword_80CF678;
    v36 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v36);
    if ( byte_80CE64C )
    {
      v11 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v23, *(_DWORD *)(v23 - 12));
      v12 = (std::ostream *)v11;
      v13 = *(_DWORD *)(*(_DWORD *)v11 - 12);
      v14 = *(_DWORD *)((char *)v12 + v13 + 124);
      if ( !v14 )
      {
        std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v24 - 12, &v21);
        std::string::_Rep::_M_dispose(v23 - 12, v6);
        std::terminate();
      }
      if ( *(_BYTE *)(v14 + 28) )
      {
        v15 = *(_BYTE *)(v14 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v12 + v13 + 124));
        v15 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v14 + 24))(v14, 10);
      }
      v16 = (std::ostream *)std::ostream::put(v12, v15);
      std::ostream::flush(v16);
    }
    syslog(6, "%s", v23, v20);
    v9 = v23 - 12;
    if ( (_DWORD *)(v23 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v10 = _InterlockedExchangeAdd((volatile signed __int32 *)(v23 - 4), 0xFFFFFFFF);
      }
      else
      {
        v19 = *(_DWORD *)(v23 - 4);
        *(_DWORD *)(v23 - 4) = v19 - 1;
        v10 = v19;
      }
      if ( v10 <= 0 )
        std::string::_Rep::_M_destroy(v9, &v25);
    }
  }
  if ( *(_DWORD *)(a1 + 12) )
    event_free(*(_DWORD *)(a1 + 12));
  if ( *(_DWORD *)a1 != -1 )
    evutil_closesocket(*(_DWORD *)a1);
  return evdns_base_free(*(_DWORD *)(a1 + 8), 1);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CF30: using guessed type int __cdecl event_free(_DWORD);
// 804D0C0: using guessed type int __cdecl evutil_closesocket(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0809D020) --------------------------------------------------------
void __cdecl sub_809D020(void *a1, int a2)
{
  int v2; // edx@1
  int v3; // eax@6
  char *v4; // ebp@7
  char *v5; // edi@7
  int v6; // esi@9

  v2 = *(_DWORD *)(a2 + 52);
  if ( v2 && *((_DWORD *)a1 + 19) )
  {
    *(_DWORD *)(a2 + 44) = 0;
    evdns_getaddrinfo_cancel(v2);
    return;
  }
  (*(void (__cdecl **)(int))(*(_DWORD *)a2 + 4))(a2);
  if ( a1 == (void *)-12 )
  {
    std::__throw_system_error(1);
    goto LABEL_12;
  }
  if ( !&_pthread_key_create )
  {
LABEL_12:
    v4 = (char *)*((_DWORD *)a1 + 13);
    v5 = (char *)a1 + 48;
    goto LABEL_8;
  }
  v3 = pthread_mutex_lock((pthread_mutex_t *)((char *)a1 + 12));
  if ( v3 )
  {
    std::__throw_system_error(v3);
    return;
  }
  v4 = (char *)*((_DWORD *)a1 + 13);
  v5 = (char *)a1 + 48;
  pthread_mutex_unlock((pthread_mutex_t *)((char *)a1 + 12));
LABEL_8:
  if ( v4 == v5 )
  {
    v6 = *((_DWORD *)a1 + 19);
    *((_DWORD *)a1 + 19) = 0;
    if ( v6 )
    {
      sub_809CB60(v6);
      operator delete((void *)v6);
    }
  }
}
// 804CA20: using guessed type int __cdecl evdns_getaddrinfo_cancel(_DWORD);

//----- (0809D0E0) --------------------------------------------------------
int __cdecl sub_809D0E0(int a1, int a2)
{
  int v2; // eax@1
  int v3; // eax@1
  int v4; // eax@5
  int result; // eax@5
  int v6; // esi@8
  int v7; // eax@8
  int v8; // edx@9
  int v9; // edx@11
  int v10; // edx@12
  int v11; // eax@14
  std::ostream *v12; // edi@14
  int v13; // eax@14
  int v14; // esi@14
  char v15; // al@16
  std::ostream *v16; // eax@17
  int v17; // eax@18
  int v18; // edx@18
  signed __int32 v19; // eax@20
  signed int v20; // eax@23
  int v21; // esi@24
  int v22; // edi@24
  int v23; // eax@24
  int v24; // edx@25
  int v25; // edx@27
  int v26; // edx@28
  int v27; // eax@30
  std::ostream *v28; // edi@30
  int v29; // eax@30
  int v30; // esi@30
  char v31; // al@32
  std::ostream *v32; // eax@33
  int v33; // edx@34
  signed __int32 v34; // eax@36
  std::runtime_error *v35; // ebx@45
  signed __int32 v36; // edi@48
  signed __int32 v37; // edi@52
  int v38; // esi@55
  signed __int32 v39; // esi@58
  signed __int32 v40; // ecx@63
  signed __int32 v41; // ecx@66
  signed __int32 v42; // esi@68
  int v43; // [sp+Ch] [bp-F0h]@0
  char v44; // [sp+22h] [bp-DAh]@54
  char v45; // [sp+23h] [bp-D9h]@10
  int v46; // [sp+24h] [bp-D8h]@8
  int v47; // [sp+28h] [bp-D4h]@10
  int v48; // [sp+2Ch] [bp-D0h]@8
  int v49; // [sp+30h] [bp-CCh]@8
  int v50; // [sp+34h] [bp-C8h]@8
  int v51; // [sp+38h] [bp-C4h]@8
  int v52; // [sp+3Ch] [bp-C0h]@8
  int v53; // [sp+40h] [bp-BCh]@8
  int v54; // [sp+44h] [bp-B8h]@8
  int v55; // [sp+48h] [bp-B4h]@8
  char v56; // [sp+4Ch] [bp-B0h]@8
  int v57; // [sp+50h] [bp-ACh]@8
  int v58; // [sp+54h] [bp-A8h]@8
  int v59; // [sp+58h] [bp-A4h]@8
  int v60; // [sp+C8h] [bp-34h]@8
  char v61; // [sp+CCh] [bp-30h]@8
  char v62; // [sp+CDh] [bp-2Fh]@8
  int v63; // [sp+D0h] [bp-2Ch]@8
  int v64; // [sp+D4h] [bp-28h]@8
  int v65; // [sp+D8h] [bp-24h]@8
  int v66; // [sp+DCh] [bp-20h]@8

  *(_DWORD *)a1 = -1;
  v2 = *(_DWORD *)(a2 + 8);
  *(_DWORD *)(a1 + 4) = 2;
  v3 = evdns_base_new(*(_DWORD *)(v2 + 4), 32769);
  *(_DWORD *)(a1 + 8) = v3;
  if ( !v3 )
  {
    v35 = (std::runtime_error *)_cxa_allocate_exception(8);
    std::string::string(&v48, "Event DNS initialization failed", &v47);
    std::runtime_error::runtime_error(v35, (const std::string *)&v48);
    *(_DWORD *)v35 = &off_80BAB18;
    std::string::_Rep::_M_dispose(v48 - 12, &v46);
    _cxa_throw(v35, &off_80BAADC, sub_807B6C0);
  }
  if ( !evdns_base_set_option(v3, "randomize-case", 134981637) )
    goto LABEL_23;
  if ( log_level > 5 )
  {
    *(_DWORD *)(a1 + 12) = 0;
    goto LABEL_5;
  }
  std::ios_base::ios_base((std::ios_base *)&v59);
  v59 = (int)&unk_80CF5C8;
  v60 = 0;
  v61 = 0;
  v62 = 0;
  v63 = 0;
  v64 = 0;
  v65 = 0;
  v66 = 0;
  v48 = dword_80CF674;
  *(int *)((char *)&v48 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v48 + *(_DWORD *)(v48 - 12), 0);
  v48 = (int)&unk_80CF5DC;
  v59 = (int)&unk_80CF5F0;
  v49 = (int)&unk_80CF7F0;
  v50 = 0;
  v51 = 0;
  v52 = 0;
  v53 = 0;
  v54 = 0;
  v55 = 0;
  std::locale::locale((std::locale *)&v56);
  v49 = (int)&unk_80CF588;
  v57 = 16;
  v58 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v59, &v49);
  v6 = std::__ostream_insert<char,std::char_traits<char>>(&v48, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v6, "Event DNS failed to drop randomize-case option", 46);
  v46 = (int)&unk_80CF83C;
  v7 = *(_DWORD *)(v6 + 24);
  if ( v7 )
  {
    v8 = *(_DWORD *)(v6 + 16);
    LOBYTE(v43) = 0;
    if ( v7 > (unsigned int)v8 )
    {
      v47 = std::string::_S_construct<char *>(a1, (unsigned int)&v59, &v49, *(_DWORD *)(v6 + 20), v7, (int)&v45);
      std::string::swap((std::string *)&v46, (std::string *)&v47);
    }
    else
    {
      v47 = std::string::_S_construct<char *>(a1, (unsigned int)&v59, &v49, *(_DWORD *)(v6 + 20), v8, (int)&v45);
      std::string::swap((std::string *)&v46, (std::string *)&v47);
    }
    v9 = v47 - 12;
    if ( (_DWORD *)(v47 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v42 = _InterlockedExchangeAdd((volatile signed __int32 *)(v47 - 4), 0xFFFFFFFF);
      }
      else
      {
        v42 = *(_DWORD *)(v47 - 4);
        *(_DWORD *)(v47 - 4) = v42 - 1;
      }
      if ( v42 <= 0 )
        std::string::_Rep::_M_destroy(v9, &v44);
    }
  }
  else
  {
    std::string::assign((std::string *)&v46, (const std::string *)(v6 + 40));
  }
  v48 = (int)&unk_80CF5DC;
  v59 = (int)&unk_80CF5F0;
  v49 = (int)&unk_80CF588;
  v10 = v58 - 12;
  if ( (_DWORD *)(v58 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v58 - 4), 0xFFFFFFFF);
    }
    else
    {
      v39 = *(_DWORD *)(v58 - 4);
      *(_DWORD *)(v58 - 4) = v39 - 1;
    }
    if ( v39 <= 0 )
      std::string::_Rep::_M_destroy(v10, &v47);
  }
  v49 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v56);
  v48 = dword_80CF674;
  *(int *)((char *)&v48 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  v59 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v59);
  if ( byte_80CE64C )
  {
    v11 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v46, *(_DWORD *)(v46 - 12));
    v12 = (std::ostream *)v11;
    v13 = *(_DWORD *)(*(_DWORD *)v11 - 12);
    v14 = *(_DWORD *)((char *)v12 + v13 + 124);
    if ( !v14 )
    {
      v17 = std::__throw_bad_cast();
      goto LABEL_66;
    }
    if ( *(_BYTE *)(v14 + 28) )
    {
      v15 = *(_BYTE *)(v14 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v12 + v13 + 124));
      v15 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v14 + 24))(v14, 10);
    }
    v16 = (std::ostream *)std::ostream::put(v12, v15);
    std::ostream::flush(v16);
  }
  syslog(3, "%s", v46, v43);
  v17 = v46;
  v18 = v46 - 12;
  if ( (_DWORD *)(v46 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v19 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
      goto LABEL_21;
    }
LABEL_66:
    v41 = *(_DWORD *)(v17 - 4);
    *(_DWORD *)(v17 - 4) = v41 - 1;
    v19 = v41;
LABEL_21:
    if ( v19 <= 0 )
      std::string::_Rep::_M_destroy(v18, &v48);
  }
LABEL_23:
  v20 = log_level;
  *(_DWORD *)(a1 + 12) = 0;
  if ( v20 <= 2 )
  {
    std::ios_base::ios_base((std::ios_base *)&v59);
    v59 = (int)&unk_80CF5C8;
    v60 = 0;
    v61 = 0;
    v62 = 0;
    v63 = 0;
    v64 = 0;
    v65 = 0;
    v66 = 0;
    v21 = dword_80CF674;
    v48 = dword_80CF674;
    *(int *)((char *)&v48 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v48 + *(_DWORD *)(v48 - 12), 0);
    v48 = (int)&unk_80CF5DC;
    v59 = (int)&unk_80CF5F0;
    v49 = (int)&unk_80CF7F0;
    v50 = 0;
    v51 = 0;
    v52 = 0;
    v53 = 0;
    v54 = 0;
    v55 = 0;
    std::locale::locale((std::locale *)&v56);
    v49 = (int)&unk_80CF588;
    v57 = 16;
    v58 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v59, &v49);
    v22 = std::__ostream_insert<char,std::char_traits<char>>(
            &v48,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v22, "ICMP creating listener", 22);
    v46 = (int)&unk_80CF83C;
    v23 = *(_DWORD *)(v22 + 24);
    if ( v23 )
    {
      v24 = *(_DWORD *)(v22 + 16);
      LOBYTE(v43) = 0;
      if ( v23 <= (unsigned int)v24 )
      {
        v47 = std::string::_S_construct<char *>(
                a1,
                (unsigned int)&v59,
                (void *)v22,
                *(_DWORD *)(v22 + 20),
                v24,
                (int)&v45);
        std::string::swap((std::string *)&v46, (std::string *)&v47);
      }
      else
      {
        v47 = std::string::_S_construct<char *>(
                a1,
                (unsigned int)&v59,
                (void *)v22,
                *(_DWORD *)(v22 + 20),
                v23,
                (int)&v45);
        std::string::swap((std::string *)&v46, (std::string *)&v47);
      }
      v25 = v47 - 12;
      if ( (_DWORD *)(v47 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v47 - 4), 0xFFFFFFFF);
        }
        else
        {
          v37 = *(_DWORD *)(v47 - 4);
          *(_DWORD *)(v47 - 4) = v37 - 1;
        }
        if ( v37 <= 0 )
          std::string::_Rep::_M_destroy(v25, &v44);
      }
    }
    else
    {
      std::string::assign((std::string *)&v46, (const std::string *)(v22 + 40));
    }
    v48 = (int)&unk_80CF5DC;
    v59 = (int)&unk_80CF5F0;
    v49 = (int)&unk_80CF588;
    v26 = v58 - 12;
    if ( (_DWORD *)(v58 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v58 - 4), 0xFFFFFFFF);
      }
      else
      {
        v36 = *(_DWORD *)(v58 - 4);
        *(_DWORD *)(v58 - 4) = v36 - 1;
      }
      if ( v36 <= 0 )
        std::string::_Rep::_M_destroy(v26, &v47);
    }
    v49 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v56);
    v48 = v21;
    *(int *)((char *)&v48 + *(_DWORD *)(v21 - 12)) = dword_80CF678;
    v59 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v59);
    if ( byte_80CE64C )
    {
      v27 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v46, *(_DWORD *)(v46 - 12));
      v28 = (std::ostream *)v27;
      v29 = *(_DWORD *)(*(_DWORD *)v27 - 12);
      v30 = *(_DWORD *)((char *)v28 + v29 + 124);
      if ( !v30 )
      {
        v38 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v46 - 12, &v48);
        evdns_base_free(*(_DWORD *)(a1 + 8), 1);
        Unwind_Resume(v38);
      }
      if ( *(_BYTE *)(v30 + 28) )
      {
        v31 = *(_BYTE *)(v30 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v28 + v29 + 124));
        v31 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v30 + 24))(v30, 10);
      }
      v32 = (std::ostream *)std::ostream::put(v28, v31);
      std::ostream::flush(v32);
    }
    syslog(6, "%s", v46, v43);
    v33 = v46 - 12;
    if ( (_DWORD *)(v46 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v34 = _InterlockedExchangeAdd((volatile signed __int32 *)(v46 - 4), 0xFFFFFFFF);
      }
      else
      {
        v40 = *(_DWORD *)(v46 - 4);
        *(_DWORD *)(v46 - 4) = v40 - 1;
        v34 = v40;
      }
      if ( v34 <= 0 )
        std::string::_Rep::_M_destroy(v33, &v48);
    }
  }
LABEL_5:
  v4 = socket(2, 3, 1);
  *(_DWORD *)a1 = v4;
  evutil_make_socket_nonblocking(v4);
  result = event_new(*(_DWORD *)(*(_DWORD *)(a2 + 8) + 4), *(_DWORD *)a1, 18, sub_80A00D0, a2);
  *(_DWORD *)(a1 + 12) = result;
  if ( result )
    result = event_add((struct event *)result, 0);
  return result;
}
// 804C450: using guessed type int __cdecl evdns_base_new(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CC60: using guessed type int __cdecl evutil_make_socket_nonblocking(_DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CEF0: using guessed type int __cdecl _cxa_allocate_exception(_DWORD);
// 804D090: using guessed type int __cdecl evdns_base_set_option(_DWORD, _DWORD, _DWORD);
// 804D0B0: using guessed type int __cdecl _cxa_throw(_DWORD, _DWORD, _DWORD);
// 804D2B0: using guessed type int __cdecl event_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80A00D0: using guessed type int sub_80A00D0();
// 80BAADC: using guessed type void *off_80BAADC;
// 80BAB18: using guessed type void *off_80BAB18;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0809DC30) --------------------------------------------------------
int __cdecl sub_809DC30(int a1, int a2)
{
  int v2; // eax@1
  int result; // eax@2
  int v4; // ebp@3
  int v5; // edi@3

  v2 = *(_DWORD *)(a1 + 76);
  if ( !v2 )
  {
    v4 = operator new(0x10u);
    sub_809D0E0(v4, a1);
    v5 = *(_DWORD *)(a1 + 76);
    *(_DWORD *)(a1 + 76) = v4;
    if ( v5 )
    {
      sub_809CB60(v5);
      operator delete((void *)v5);
      v2 = *(_DWORD *)(a1 + 76);
    }
    else
    {
      v2 = v4;
    }
  }
  result = sub_807BE90(v2 + 4, *(char **)(*(_DWORD *)(a2 + 28) + 32), (int)sub_809F890, a2);
  *(_DWORD *)(a2 + 52) = result;
  return result;
}

//----- (0809DCE0) --------------------------------------------------------
ssize_t __usercall sub_809DCE0@<eax>(int a1@<eax>, struct sockaddr *a2@<edx>, unsigned __int16 a3@<cx>, unsigned __int16 a4)
{
  unsigned __int16 v4; // si@1
  __int16 v5; // ax@1
  __int16 v6; // ax@1
  signed int v7; // edx@1
  char *v8; // eax@1
  char *v10; // edx@6
  int v11; // ecx@7
  unsigned int v12; // eax@7
  int v13; // ebx@10
  int v14; // eax@10
  int v15; // edx@10
  int v16; // ecx@11
  int v17; // ebx@13
  int v18; // ebx@14
  int v19; // eax@16
  std::ostream *v20; // esi@16
  int v21; // eax@16
  int v22; // ebx@16
  char v23; // al@18
  std::ostream *v24; // eax@19
  int v25; // edx@20
  signed __int32 v26; // ecx@22
  signed __int32 v27; // ecx@30
  signed __int32 v28; // ecx@34
  int v29; // ebx@39
  int flags; // [sp+Ch] [bp-190h]@5
  struct sockaddr *v31; // [sp+24h] [bp-178h]@1
  int v32; // [sp+28h] [bp-174h]@1
  int v33; // [sp+2Ch] [bp-170h]@6
  char v34; // [sp+32h] [bp-16Ah]@36
  char v35; // [sp+33h] [bp-169h]@12
  int v36; // [sp+34h] [bp-168h]@10
  int v37; // [sp+38h] [bp-164h]@12
  char v38; // [sp+3Ch] [bp-160h]@1
  char v39; // [sp+3Dh] [bp-15Fh]@1
  __int16 v40; // [sp+3Eh] [bp-15Eh]@1
  __int16 v41; // [sp+40h] [bp-15Ch]@1
  __int16 v42; // [sp+42h] [bp-15Ah]@1
  char v43; // [sp+7Ch] [bp-120h]@2
  int v44; // [sp+CCh] [bp-D0h]@6
  int v45; // [sp+D0h] [bp-CCh]@6
  int v46; // [sp+D4h] [bp-C8h]@6
  int v47; // [sp+D8h] [bp-C4h]@6
  int v48; // [sp+DCh] [bp-C0h]@6
  int v49; // [sp+E0h] [bp-BCh]@6
  int v50; // [sp+E4h] [bp-B8h]@6
  int v51; // [sp+E8h] [bp-B4h]@6
  char v52; // [sp+ECh] [bp-B0h]@6
  int v53; // [sp+F0h] [bp-ACh]@6
  int v54; // [sp+F4h] [bp-A8h]@6
  int v55; // [sp+F8h] [bp-A4h]@6
  int v56; // [sp+168h] [bp-34h]@6
  char v57; // [sp+16Ch] [bp-30h]@6
  char v58; // [sp+16Dh] [bp-2Fh]@6
  int v59; // [sp+170h] [bp-2Ch]@6
  int v60; // [sp+174h] [bp-28h]@6
  int v61; // [sp+178h] [bp-24h]@6
  int v62; // [sp+17Ch] [bp-20h]@6

  v32 = a1;
  v31 = a2;
  v4 = a3;
  v38 = 8;
  v39 = 0;
  v40 = 0;
  v5 = __ROR2__(a3, 8);
  v42 = v5;
  v6 = __ROR2__(a4, 8);
  v41 = v6;
  v7 = 0;
  v8 = &v38;
  do
  {
    v8 += 2;
    v7 += *((_WORD *)v8 - 1);
  }
  while ( v8 != &v43 );
  v40 = ~((((v7 >> 16) + (unsigned __int16)v7) >> 16) + (v7 >> 16) + v7);
  if ( log_level <= 1 )
  {
    evutil_inet_ntop(2, &v31->sa_data[2], &v43, 80);
    if ( log_level <= 1 )
    {
      std::ios_base::ios_base((std::ios_base *)&v55);
      v55 = (int)&unk_80CF5C8;
      v56 = 0;
      v57 = 0;
      v58 = 0;
      v59 = 0;
      v60 = 0;
      v61 = 0;
      v62 = 0;
      v44 = dword_80CF674;
      *(int *)((char *)&v44 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v44 + *(_DWORD *)(v44 - 12), 0);
      v44 = (int)&unk_80CF5DC;
      v55 = (int)&unk_80CF5F0;
      v45 = (int)&unk_80CF7F0;
      v46 = 0;
      v47 = 0;
      v48 = 0;
      v49 = 0;
      v50 = 0;
      v51 = 0;
      std::locale::locale((std::locale *)&v52);
      v45 = (int)&unk_80CF588;
      v53 = 16;
      v54 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v55, &v45);
      v33 = std::__ostream_insert<char,std::char_traits<char>>(
              &v44,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v33, "ICMP REQ [", 10);
      v10 = &v43;
      do
      {
        v11 = *(_DWORD *)v10;
        v10 += 4;
        v12 = ~v11 & (v11 - 16843009) & 0x80808080;
      }
      while ( !v12 );
      if ( !(v12 & 0x8080) )
      {
        v12 >>= 16;
        v10 += 2;
      }
      std::__ostream_insert<char,std::char_traits<char>>(v33, &v43, &v10[-__CFADD__((_BYTE)v12, (_BYTE)v12) - 3] - &v43);
      std::__ostream_insert<char,std::char_traits<char>>(v33, "] ", 2);
      v13 = std::ostream::_M_insert<unsigned long>(v33, a4);
      std::__ostream_insert<char,std::char_traits<char>>(v13, " #", 2);
      v14 = std::ostream::_M_insert<unsigned long>(v13, v4);
      v36 = (int)&unk_80CF83C;
      v15 = *(_DWORD *)(v14 + 24);
      if ( v15 )
      {
        v16 = *(_DWORD *)(v14 + 16);
        LOBYTE(flags) = 0;
        if ( v15 <= (unsigned int)v16 )
        {
          v37 = std::string::_S_construct<char *>(
                  v13,
                  (unsigned int)&v38,
                  (void *)a4,
                  *(_DWORD *)(v14 + 20),
                  v16,
                  (int)&v35);
          std::string::swap((std::string *)&v36, (std::string *)&v37);
        }
        else
        {
          v37 = std::string::_S_construct<char *>(
                  v13,
                  (unsigned int)&v38,
                  (void *)a4,
                  *(_DWORD *)(v14 + 20),
                  v15,
                  (int)&v35);
          std::string::swap((std::string *)&v36, (std::string *)&v37);
        }
        v17 = v37 - 12;
        if ( (_DWORD *)(v37 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v28 = _InterlockedExchangeAdd((volatile signed __int32 *)(v37 - 4), 0xFFFFFFFF);
          }
          else
          {
            v28 = *(_DWORD *)(v37 - 4);
            *(_DWORD *)(v37 - 4) = v28 - 1;
          }
          if ( v28 <= 0 )
            std::string::_Rep::_M_destroy(v17, &v34);
        }
      }
      else
      {
        std::string::assign((std::string *)&v36, (const std::string *)(v14 + 40));
      }
      v44 = (int)&unk_80CF5DC;
      v55 = (int)&unk_80CF5F0;
      v45 = (int)&unk_80CF588;
      v18 = v54 - 12;
      if ( (_DWORD *)(v54 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v27 = _InterlockedExchangeAdd((volatile signed __int32 *)(v54 - 4), 0xFFFFFFFF);
        }
        else
        {
          v27 = *(_DWORD *)(v54 - 4);
          *(_DWORD *)(v54 - 4) = v27 - 1;
        }
        if ( v27 <= 0 )
          std::string::_Rep::_M_destroy(v18, &v37);
      }
      v45 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v52);
      v44 = dword_80CF674;
      *(int *)((char *)&v44 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v55 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v55);
      if ( byte_80CE64C )
      {
        v19 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v36, *(_DWORD *)(v36 - 12));
        v20 = (std::ostream *)v19;
        v21 = *(_DWORD *)(*(_DWORD *)v19 - 12);
        v22 = *(_DWORD *)((char *)v20 + v21 + 124);
        if ( !v22 )
        {
          v29 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v36 - 12, &v44);
          Unwind_Resume(v29);
        }
        if ( *(_BYTE *)(v22 + 28) )
        {
          v23 = *(_BYTE *)(v22 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v20 + v21 + 124));
          v23 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v22 + 24))(v22, 10);
        }
        v24 = (std::ostream *)std::ostream::put(v20, v23);
        std::ostream::flush(v24);
      }
      syslog(7, "%s", v36, flags);
      v25 = v36 - 12;
      if ( (_DWORD *)(v36 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v36 - 4), 0xFFFFFFFF);
        }
        else
        {
          v26 = *(_DWORD *)(v36 - 4);
          *(_DWORD *)(v36 - 4) = v26 - 1;
        }
        if ( v26 <= 0 )
          std::string::_Rep::_M_destroy(v25, &v44);
      }
    }
  }
  return sendto(v32, &v38, 0x40u, 0, v31, 0x10u);
}
// 804C480: using guessed type int __cdecl evutil_inet_ntop(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0809E380) --------------------------------------------------------
void __cdecl sub_809E380(int a1, int a2, char a3)
{
  unsigned int v3; // ebp@0
  __int64 v4; // rax@1
  long double v5; // fst7@2
  int v6; // edx@3
  void *v7; // eax@3
  int v8; // eax@7
  void *v9; // edi@7
  pthread_mutex_t *v10; // ST20_4@9
  int v11; // esi@9
  int v12; // esi@9
  int v13; // esi@9
  int v14; // eax@9
  int v15; // edx@10
  int v16; // edx@12
  int v17; // edx@13
  int v18; // eax@15
  std::ostream *v19; // esi@15
  int v20; // eax@15
  int v21; // edi@15
  char v22; // al@17
  std::ostream *v23; // eax@18
  int v24; // edx@19
  int v25; // eax@22
  int v26; // eax@23
  int v27; // eax@25
  int v28; // edi@32
  int v29; // esi@32
  int v30; // ebx@34
  signed __int32 v31; // eax@43
  signed __int32 v32; // eax@52
  signed __int32 v33; // eax@56
  int v34; // ebx@59
  signed __int32 v35; // esi@61
  signed __int32 v36; // ecx@62
  signed __int32 v37; // esi@63
  int v38; // [sp+8h] [bp-100h]@0
  __int64 v39; // [sp+10h] [bp-F8h]@1
  pthread_mutex_t *mutex; // [sp+1Ch] [bp-ECh]@20
  __int64 v41; // [sp+28h] [bp-E0h]@1
  char v42; // [sp+32h] [bp-D6h]@54
  char v43; // [sp+33h] [bp-D5h]@11
  int v44; // [sp+34h] [bp-D4h]@9
  int v45; // [sp+38h] [bp-D0h]@11
  int v46; // [sp+3Ch] [bp-CCh]@3
  double v47; // [sp+40h] [bp-C8h]@3
  int v48; // [sp+48h] [bp-C0h]@9
  int v49; // [sp+4Ch] [bp-BCh]@9
  int v50; // [sp+50h] [bp-B8h]@9
  int v51; // [sp+54h] [bp-B4h]@9
  int v52; // [sp+58h] [bp-B0h]@9
  char v53; // [sp+5Ch] [bp-ACh]@9
  int v54; // [sp+60h] [bp-A8h]@9
  int v55; // [sp+64h] [bp-A4h]@9
  int v56; // [sp+68h] [bp-A0h]@9
  int v57; // [sp+D8h] [bp-30h]@9
  char v58; // [sp+DCh] [bp-2Ch]@9
  char v59; // [sp+DDh] [bp-2Bh]@9
  int v60; // [sp+E0h] [bp-28h]@9
  int v61; // [sp+E4h] [bp-24h]@9
  int v62; // [sp+E8h] [bp-20h]@9
  int v63; // [sp+ECh] [bp-1Ch]@9

  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v41);
  v39 = v41;
  v4 = *(_QWORD *)(a2 + 72);
  if ( v4 )
    v5 = (long double)(v41 - v4) / 1000000000.0;
  else
    v5 = 0.0;
  LOBYTE(v46) = a3 == 0;
  v47 = v5;
  v6 = *(_DWORD *)(a2 + 32);
  v7 = *(void **)(v6 + 16);
  if ( v7 == *(void **)(v6 + 20) )
  {
    sub_80A08D0(v6 + 12, &v46);
  }
  else
  {
    if ( v7 )
    {
      qmemcpy(v7, &v46, 0xCu);
      v7 = *(void **)(v6 + 16);
    }
    *(_DWORD *)(v6 + 16) = (char *)v7 + 12;
  }
  v8 = *(_DWORD *)(a2 + 48);
  v9 = (void *)(v8 + 1);
  *(_WORD *)(a2 + 48) = v8 + 1;
  if ( (signed int)(unsigned __int16)(v8 + 1) < *(_DWORD *)(a2 + 36) )
  {
    *(_QWORD *)(a2 + 72) = v39;
    sub_809DCE0(**(_DWORD **)(a1 + 76), (struct sockaddr *)(a2 + 56), v8 + 1, *(_WORD *)(a1 + 72));
  }
  else
  {
    if ( log_level > 2 )
      goto LABEL_20;
    v10 = *(pthread_mutex_t **)(a2 + 28);
    std::ios_base::ios_base((std::ios_base *)&v56);
    v56 = (int)&unk_80CF5C8;
    v57 = 0;
    v58 = 0;
    v59 = 0;
    v60 = 0;
    v61 = 0;
    v62 = 0;
    v63 = 0;
    v46 = dword_80CF674;
    *(int *)((char *)&v46 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v46 + *(_DWORD *)(v46 - 12), 0);
    v46 = (int)&unk_80CF5DC;
    v56 = (int)&unk_80CF5F0;
    LODWORD(v47) = &unk_80CF7F0;
    HIDWORD(v47) = 0;
    v48 = 0;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    v52 = 0;
    std::locale::locale((std::locale *)&v53);
    LODWORD(v47) = &unk_80CF588;
    v54 = 16;
    v55 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v56, &v47);
    v11 = std::__ostream_insert<char,std::char_traits<char>>(
            &v46,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v11, "ICMP job done ", 14);
    v12 = std::__ostream_insert<char,std::char_traits<char>>(v11, v10[1].__owner, *(_DWORD *)(v10[1].__owner - 12));
    std::__ostream_insert<char,std::char_traits<char>>(v12, ": ", 2);
    v13 = std::ostream::_M_insert<unsigned long>(v12, (unsigned __int16)v9);
    std::__ostream_insert<char,std::char_traits<char>>(v13, " probes", 7);
    v44 = (int)&unk_80CF83C;
    v14 = *(_DWORD *)(v13 + 24);
    if ( !v14 )
      goto LABEL_47;
    v15 = *(_DWORD *)(v13 + 16);
    LOBYTE(v38) = 0;
    if ( v14 > (unsigned int)v15 )
    {
      v45 = std::string::_S_construct<char *>(a2, v3, v9, *(_DWORD *)(v13 + 20), v14, (int)&v43);
      std::string::swap((std::string *)&v44, (std::string *)&v45);
    }
    else
    {
      v45 = std::string::_S_construct<char *>(a2, v3, v9, *(_DWORD *)(v13 + 20), v15, (int)&v43);
      std::string::swap((std::string *)&v44, (std::string *)&v45);
    }
    v16 = v45 - 12;
    if ( (_DWORD *)(v45 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v32 = _InterlockedExchangeAdd((volatile signed __int32 *)(v45 - 4), 0xFFFFFFFF);
      }
      else
      {
        v35 = *(_DWORD *)(v45 - 4);
        *(_DWORD *)(v45 - 4) = v35 - 1;
        v32 = v35;
      }
      if ( v32 <= 0 )
        std::string::_Rep::_M_destroy(v16, &v42);
    }
    while ( 1 )
    {
      v46 = (int)&unk_80CF5DC;
      v56 = (int)&unk_80CF5F0;
      LODWORD(v47) = &unk_80CF588;
      v17 = v55 - 12;
      if ( (_DWORD *)(v55 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v33 = _InterlockedExchangeAdd((volatile signed __int32 *)(v55 - 4), 0xFFFFFFFF);
        }
        else
        {
          v37 = *(_DWORD *)(v55 - 4);
          *(_DWORD *)(v55 - 4) = v37 - 1;
          v33 = v37;
        }
        if ( v33 <= 0 )
          std::string::_Rep::_M_destroy(v17, &v45);
      }
      LODWORD(v47) = &unk_80CF7F0;
      std::locale::~locale((std::locale *)&v53);
      v46 = dword_80CF674;
      *(int *)((char *)&v46 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v56 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v56);
      if ( byte_80CE64C )
      {
        v18 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v44, *(_DWORD *)(v44 - 12));
        v19 = (std::ostream *)v18;
        v20 = *(_DWORD *)(*(_DWORD *)v18 - 12);
        v21 = *(_DWORD *)((char *)v19 + v20 + 124);
        if ( !v21 )
        {
          v34 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v44 - 12, &v46);
          Unwind_Resume(v34);
        }
        if ( *(_BYTE *)(v21 + 28) )
        {
          v22 = *(_BYTE *)(v21 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v19 + v20 + 124));
          v22 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v21 + 24))(v21, 10);
        }
        v23 = (std::ostream *)std::ostream::put(v19, v22);
        std::ostream::flush(v23);
      }
      syslog(6, "%s", v44, v38);
      v24 = v44 - 12;
      if ( (_DWORD *)(v44 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v31 = _InterlockedExchangeAdd((volatile signed __int32 *)(v44 - 4), 0xFFFFFFFF);
        }
        else
        {
          v36 = *(_DWORD *)(v44 - 4);
          *(_DWORD *)(v44 - 4) = v36 - 1;
          v31 = v36;
        }
        if ( v31 <= 0 )
          std::string::_Rep::_M_destroy(v24, &v46);
      }
LABEL_20:
      mutex = (pthread_mutex_t *)(a1 + 12);
      if ( a1 == -12 )
        break;
      v13 = (int)&_pthread_key_create;
      if ( &_pthread_key_create )
      {
        v25 = pthread_mutex_lock(mutex);
        if ( v25 )
          goto LABEL_48;
      }
      v26 = *(_DWORD *)(a2 + 4);
      if ( v26 )
        *(_DWORD *)(v26 + 8) = *(_DWORD *)(a2 + 8);
      v27 = *(_DWORD *)(a2 + 8);
      if ( v27 )
        *(_DWORD *)(v27 + 4) = *(_DWORD *)(a2 + 4);
      *(_DWORD *)(a2 + 4) = 0;
      *(_DWORD *)(a2 + 8) = 0;
      if ( &_pthread_key_create )
        pthread_mutex_unlock(mutex);
      if ( *(_DWORD *)(a2 + 20) )
      {
        (*(void (__cdecl **)(int, int))(a2 + 24))(a2 + 12, a2 + 32);
        (*(void (__cdecl **)(int))(*(_DWORD *)a2 + 4))(a2);
        if ( !&_pthread_key_create )
          goto LABEL_50;
        v25 = pthread_mutex_lock(mutex);
        if ( !v25 )
        {
          v28 = *(_DWORD *)(a1 + 52);
          v29 = a1 + 48;
          pthread_mutex_unlock(mutex);
          goto LABEL_33;
        }
LABEL_48:
        std::__throw_system_error(v25);
        break;
      }
      std::__throw_bad_function_call();
LABEL_47:
      std::string::assign((std::string *)&v44, (const std::string *)(v13 + 40));
    }
    std::__throw_system_error(1);
LABEL_50:
    v28 = *(_DWORD *)(a1 + 52);
    v29 = a1 + 48;
LABEL_33:
    if ( v28 == v29 )
    {
      v30 = *(_DWORD *)(a1 + 76);
      *(_DWORD *)(a1 + 76) = 0;
      if ( v30 )
      {
        sub_809CB60(v30);
        operator delete((void *)v30);
      }
    }
  }
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0809EB90) --------------------------------------------------------
void __cdecl sub_809EB90(int a1, void *a2, int a3, int a4)
{
  int v4; // eax@4
  int v5; // ebp@5
  int v6; // ebx@10
  char *v7; // edx@18
  int v8; // ecx@19
  unsigned int v9; // eax@19
  unsigned int v10; // ebp@22
  int v11; // ebx@22
  int v12; // eax@22
  int v13; // edx@22
  int v14; // ecx@23
  int v15; // ebx@25
  int v16; // ebx@26
  int v17; // eax@28
  std::ostream *v18; // ebp@28
  int v19; // eax@28
  int v20; // ebx@28
  char v21; // al@30
  std::ostream *v22; // eax@31
  int v23; // ebx@32
  signed __int32 v24; // edx@34
  signed __int32 v25; // ecx@42
  signed __int32 v26; // edx@46
  int v27; // ebx@53
  int v28; // [sp+Ch] [bp-140h]@17
  pthread_mutex_t *v29; // [sp+10h] [bp-13Ch]@2
  unsigned __int16 v30; // [sp+1Ah] [bp-132h]@18
  int v31; // [sp+1Ch] [bp-130h]@18
  char v32; // [sp+22h] [bp-12Ah]@48
  char v33; // [sp+23h] [bp-129h]@24
  int v34; // [sp+24h] [bp-128h]@22
  int v35; // [sp+28h] [bp-124h]@24
  char v36; // [sp+2Ch] [bp-120h]@17
  int v37; // [sp+7Ch] [bp-D0h]@18
  int v38; // [sp+80h] [bp-CCh]@18
  int v39; // [sp+84h] [bp-C8h]@18
  int v40; // [sp+88h] [bp-C4h]@18
  int v41; // [sp+8Ch] [bp-C0h]@18
  int v42; // [sp+90h] [bp-BCh]@18
  int v43; // [sp+94h] [bp-B8h]@18
  int v44; // [sp+98h] [bp-B4h]@18
  char v45; // [sp+9Ch] [bp-B0h]@18
  int v46; // [sp+A0h] [bp-ACh]@18
  int v47; // [sp+A4h] [bp-A8h]@18
  int v48; // [sp+A8h] [bp-A4h]@18
  int v49; // [sp+118h] [bp-34h]@18
  char v50; // [sp+11Ch] [bp-30h]@18
  char v51; // [sp+11Dh] [bp-2Fh]@18
  int v52; // [sp+120h] [bp-2Ch]@18
  int v53; // [sp+124h] [bp-28h]@18
  int v54; // [sp+128h] [bp-24h]@18
  int v55; // [sp+12Ch] [bp-20h]@18

  if ( log_level <= 1 )
  {
    evutil_inet_ntop(2, a2, &v36, 80);
    if ( log_level <= 1 )
    {
      v30 = *(_DWORD *)(a1 + 72);
      std::ios_base::ios_base((std::ios_base *)&v48);
      v48 = (int)&unk_80CF5C8;
      v49 = 0;
      v50 = 0;
      v51 = 0;
      v52 = 0;
      v53 = 0;
      v54 = 0;
      v55 = 0;
      v37 = dword_80CF674;
      *(int *)((char *)&v37 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v37 + *(_DWORD *)(v37 - 12), 0);
      v37 = (int)&unk_80CF5DC;
      v48 = (int)&unk_80CF5F0;
      v38 = (int)&unk_80CF7F0;
      v39 = 0;
      v40 = 0;
      v41 = 0;
      v42 = 0;
      v43 = 0;
      v44 = 0;
      std::locale::locale((std::locale *)&v45);
      v38 = (int)&unk_80CF588;
      v46 = 16;
      v47 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v48, &v38);
      v31 = std::__ostream_insert<char,std::char_traits<char>>(
              &v37,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v31, "ICMP RES [", 10);
      v7 = &v36;
      do
      {
        v8 = *(_DWORD *)v7;
        v7 += 4;
        v9 = ~v8 & (v8 - 16843009) & 0x80808080;
      }
      while ( !v9 );
      if ( !(~v8 & (v8 - 16843009) & 0x8080) )
      {
        v9 >>= 16;
        v7 += 2;
      }
      std::__ostream_insert<char,std::char_traits<char>>(v31, &v36, &v7[-__CFADD__((_BYTE)v9, (_BYTE)v9) - 3] - &v36);
      std::__ostream_insert<char,std::char_traits<char>>(v31, "] ", 2);
      v10 = std::ostream::_M_insert<unsigned long>(v31, v30);
      std::__ostream_insert<char,std::char_traits<char>>(v10, " #", 2);
      v11 = std::ostream::_M_insert<unsigned long>(v10, (unsigned __int16)a3);
      std::__ostream_insert<char,std::char_traits<char>>(v11, ": ", 2);
      v12 = std::ostream::operator<<(v11, (unsigned __int8)a4);
      v34 = (int)&unk_80CF83C;
      v13 = *(_DWORD *)(v12 + 24);
      if ( v13 )
      {
        v14 = *(_DWORD *)(v12 + 16);
        LOBYTE(v28) = 0;
        if ( v13 <= (unsigned int)v14 )
        {
          v35 = std::string::_S_construct<char *>((int)&v33, v10, a2, *(_DWORD *)(v12 + 20), v14, (int)&v33);
          std::string::swap((std::string *)&v34, (std::string *)&v35);
        }
        else
        {
          v35 = std::string::_S_construct<char *>((int)&v33, v10, a2, *(_DWORD *)(v12 + 20), v13, (int)&v33);
          std::string::swap((std::string *)&v34, (std::string *)&v35);
        }
        v15 = v35 - 12;
        if ( (_DWORD *)(v35 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v35 - 4), 0xFFFFFFFF);
          }
          else
          {
            v26 = *(_DWORD *)(v35 - 4);
            *(_DWORD *)(v35 - 4) = v26 - 1;
          }
          if ( v26 <= 0 )
            std::string::_Rep::_M_destroy(v15, &v32);
        }
      }
      else
      {
        std::string::assign((std::string *)&v34, (const std::string *)(v12 + 40));
      }
      v37 = (int)&unk_80CF5DC;
      v48 = (int)&unk_80CF5F0;
      v38 = (int)&unk_80CF588;
      v16 = v47 - 12;
      if ( (_DWORD *)(v47 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v47 - 4), 0xFFFFFFFF);
        }
        else
        {
          v25 = *(_DWORD *)(v47 - 4);
          *(_DWORD *)(v47 - 4) = v25 - 1;
        }
        if ( v25 <= 0 )
          std::string::_Rep::_M_destroy(v16, &v35);
      }
      v38 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v45);
      v37 = dword_80CF674;
      *(int *)((char *)&v37 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v48 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v48);
      if ( byte_80CE64C )
      {
        v17 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v34, *(_DWORD *)(v34 - 12));
        v18 = (std::ostream *)v17;
        v19 = *(_DWORD *)(*(_DWORD *)v17 - 12);
        v20 = *(_DWORD *)((char *)v18 + v19 + 124);
        if ( !v20 )
        {
LABEL_53:
          v27 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v34 - 12, &v37);
          Unwind_Resume(v27);
        }
        if ( *(_BYTE *)(v20 + 28) )
        {
          v21 = *(_BYTE *)(v20 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v18 + v19 + 124));
          v21 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v20 + 24))(v20, 10);
        }
        v22 = (std::ostream *)std::ostream::put(v18, v21);
        std::ostream::flush(v22);
      }
      syslog(7, "%s", v34, v28);
      v23 = v34 - 12;
      if ( (_DWORD *)(v34 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v34 - 4), 0xFFFFFFFF);
        }
        else
        {
          v24 = *(_DWORD *)(v34 - 4);
          *(_DWORD *)(v34 - 4) = v24 - 1;
        }
        if ( v24 <= 0 )
          std::string::_Rep::_M_destroy(v23, &v37);
      }
    }
  }
  v29 = (pthread_mutex_t *)(a1 + 12);
  if ( a1 == -12 )
  {
LABEL_52:
    std::__throw_system_error(1);
    goto LABEL_53;
  }
  if ( &_pthread_key_create )
  {
    v4 = pthread_mutex_lock(v29);
    if ( v4 )
    {
      std::__throw_system_error(v4);
      goto LABEL_52;
    }
  }
  v5 = *(_DWORD *)(a1 + 52);
  if ( v5 == a1 + 48 )
  {
LABEL_16:
    v6 = 0;
  }
  else
  {
    while ( memcmp((const void *)(v5 + 60), a2, 4u) || (_WORD)a3 != *(_WORD *)(v5 + 48) )
    {
      v5 = *(_DWORD *)(v5 + 4);
      if ( a1 + 48 == v5 )
        goto LABEL_16;
    }
    v6 = v5;
  }
  if ( &_pthread_key_create )
    pthread_mutex_unlock(v29);
  if ( v6 )
    sub_809E380(a1, v6, a4);
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C480: using guessed type int __cdecl evutil_inet_ntop(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0809F2A0) --------------------------------------------------------
void __cdecl sub_809F2A0(int a1, int a2, int a3, int a4)
{
  unsigned int v4; // ebp@0
  int v5; // eax@1
  int v6; // ST18_4@7
  int v7; // edi@7
  int v8; // esi@7
  int v9; // eax@7
  int v10; // edx@7
  int v11; // ecx@8
  int v12; // edx@10
  int v13; // edx@11
  int v14; // eax@13
  std::ostream *v15; // edi@13
  int v16; // eax@13
  int v17; // esi@13
  char v18; // al@15
  std::ostream *v19; // eax@16
  int v20; // eax@17
  int v21; // edx@17
  int v22; // eax@19
  int v23; // edx@19
  signed __int32 v24; // eax@24
  signed __int32 v25; // ecx@28
  signed __int32 v26; // esi@30
  signed __int32 v27; // esi@34
  int v28; // [sp+Ch] [bp-ECh]@0
  int v29; // [sp+18h] [bp-E0h]@19
  int v30; // [sp+1Ch] [bp-DCh]@19
  char v31; // [sp+22h] [bp-D6h]@36
  char v32; // [sp+23h] [bp-D5h]@9
  int v33; // [sp+24h] [bp-D4h]@7
  int v34; // [sp+28h] [bp-D0h]@9
  int v35; // [sp+2Ch] [bp-CCh]@7
  int v36; // [sp+30h] [bp-C8h]@7
  int v37; // [sp+34h] [bp-C4h]@7
  int v38; // [sp+38h] [bp-C0h]@7
  int v39; // [sp+3Ch] [bp-BCh]@7
  int v40; // [sp+40h] [bp-B8h]@7
  int v41; // [sp+44h] [bp-B4h]@7
  int v42; // [sp+48h] [bp-B0h]@7
  char v43; // [sp+4Ch] [bp-ACh]@7
  int v44; // [sp+50h] [bp-A8h]@7
  int v45; // [sp+54h] [bp-A4h]@7
  int v46; // [sp+58h] [bp-A0h]@7
  int v47; // [sp+C8h] [bp-30h]@7
  char v48; // [sp+CCh] [bp-2Ch]@7
  char v49; // [sp+CDh] [bp-2Bh]@7
  int v50; // [sp+D0h] [bp-28h]@7
  int v51; // [sp+D4h] [bp-24h]@7
  int v52; // [sp+D8h] [bp-20h]@7
  int v53; // [sp+DCh] [bp-1Ch]@7

  v5 = a3;
  if ( *(_DWORD *)(a1 + 76) )
  {
    while ( v5 )
    {
      if ( *(_DWORD *)(v5 + 4) == 2 )
      {
        v22 = *(_DWORD *)(v5 + 20);
        *(_WORD *)(a4 + 48) = 0;
        *(_WORD *)(a4 + 56) = 2;
        *(_DWORD *)(a4 + 60) = *(_DWORD *)(v22 + 4);
        std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v29);
        v23 = v30;
        *(_DWORD *)(a4 + 72) = v29;
        *(_DWORD *)(a4 + 76) = v23;
        sub_809DCE0(**(_DWORD **)(a1 + 76), (struct sockaddr *)(a4 + 56), *(_WORD *)(a4 + 48), *(_WORD *)(a1 + 72));
        return;
      }
      v5 = *(_DWORD *)(v5 + 28);
    }
  }
  if ( log_level <= 2 )
  {
    v6 = *(_DWORD *)(a4 + 28);
    std::ios_base::ios_base((std::ios_base *)&v46);
    v46 = (int)&unk_80CF5C8;
    v47 = 0;
    v48 = 0;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    v52 = 0;
    v53 = 0;
    v7 = dword_80CF674;
    v35 = dword_80CF674;
    *(int *)((char *)&v35 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v35 + *(_DWORD *)(v35 - 12), 0);
    v35 = (int)&unk_80CF5DC;
    v46 = (int)&unk_80CF5F0;
    v36 = (int)&unk_80CF7F0;
    v37 = 0;
    v38 = 0;
    v39 = 0;
    v40 = 0;
    v41 = 0;
    v42 = 0;
    std::locale::locale((std::locale *)&v43);
    v36 = (int)&unk_80CF588;
    v44 = 16;
    v45 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v46, &v36);
    v8 = std::__ostream_insert<char,std::char_traits<char>>(&v35, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v8, "ICMP failed to resolve host ", 28);
    v9 = std::__ostream_insert<char,std::char_traits<char>>(
           v8,
           *(_DWORD *)(v6 + 32),
           *(_DWORD *)(*(_DWORD *)(v6 + 32) - 12));
    v33 = (int)&unk_80CF83C;
    v10 = *(_DWORD *)(v9 + 24);
    if ( v10 )
    {
      v11 = *(_DWORD *)(v9 + 16);
      LOBYTE(v28) = 0;
      if ( v10 > (unsigned int)v11 )
      {
        v34 = std::string::_S_construct<char *>(a4, v4, (void *)v7, *(_DWORD *)(v9 + 20), v10, (int)&v32);
        std::string::swap((std::string *)&v33, (std::string *)&v34);
      }
      else
      {
        v34 = std::string::_S_construct<char *>(a4, v4, (void *)v7, *(_DWORD *)(v9 + 20), v11, (int)&v32);
        std::string::swap((std::string *)&v33, (std::string *)&v34);
      }
      v12 = v34 - 12;
      if ( (_DWORD *)(v34 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v27 = _InterlockedExchangeAdd((volatile signed __int32 *)(v34 - 4), 0xFFFFFFFF);
        }
        else
        {
          v27 = *(_DWORD *)(v34 - 4);
          *(_DWORD *)(v34 - 4) = v27 - 1;
        }
        if ( v27 <= 0 )
          std::string::_Rep::_M_destroy(v12, &v31);
      }
    }
    else
    {
      std::string::assign((std::string *)&v33, (const std::string *)(v9 + 40));
    }
    v35 = (int)&unk_80CF5DC;
    v46 = (int)&unk_80CF5F0;
    v36 = (int)&unk_80CF588;
    v13 = v45 - 12;
    if ( (_DWORD *)(v45 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v45 - 4), 0xFFFFFFFF);
      }
      else
      {
        v26 = *(_DWORD *)(v45 - 4);
        *(_DWORD *)(v45 - 4) = v26 - 1;
      }
      if ( v26 <= 0 )
        std::string::_Rep::_M_destroy(v13, &v34);
    }
    v36 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v43);
    v35 = v7;
    *(int *)((char *)&v35 + *(_DWORD *)(v7 - 12)) = dword_80CF678;
    v46 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v46);
    if ( byte_80CE64C )
    {
      v14 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v33, *(_DWORD *)(v33 - 12));
      v15 = (std::ostream *)v14;
      v16 = *(_DWORD *)(*(_DWORD *)v14 - 12);
      v17 = *(_DWORD *)((char *)v15 + v16 + 124);
      if ( !v17 )
      {
        v20 = std::__throw_bad_cast();
        goto LABEL_28;
      }
      if ( *(_BYTE *)(v17 + 28) )
      {
        v18 = *(_BYTE *)(v17 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v15 + v16 + 124));
        v18 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v17 + 24))(v17, 10);
      }
      v19 = (std::ostream *)std::ostream::put(v15, v18);
      std::ostream::flush(v19);
    }
    syslog(6, "%s", v33, v28);
    v20 = v33;
    v21 = v33 - 12;
    if ( (_DWORD *)(v33 - 12) == &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_18;
    if ( &_pthread_key_create )
    {
      v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v33 - 4), 0xFFFFFFFF);
      goto LABEL_25;
    }
LABEL_28:
    v25 = *(_DWORD *)(v20 - 4);
    *(_DWORD *)(v20 - 4) = v25 - 1;
    v24 = v25;
LABEL_25:
    if ( v24 <= 0 )
      std::string::_Rep::_M_destroy(v21, &v35);
  }
LABEL_18:
  *(_WORD *)(a4 + 48) = *(_DWORD *)(a4 + 36);
  sub_809E380(a1, a4, 3);
}
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (0809F890) --------------------------------------------------------
void __cdecl sub_809F890(int a1, int a2, int a3)
{
  int v3; // edx@1
  int v4; // edx@2
  int v5; // ecx@2

  *(_DWORD *)(a3 + 52) = 0;
  v3 = *(_DWORD *)(a3 + 44);
  if ( v3 )
    sub_809F2A0(v3, a1, a2, a3);
  else
    (*(void (__fastcall **)(int))(*(_DWORD *)a3 + 4))(a1);
  if ( a2 )
    evutil_freeaddrinfo(v5, v4);
}
// 804C7E0: using guessed type int __fastcall evutil_freeaddrinfo(_DWORD, _DWORD);

//----- (080A0100) --------------------------------------------------------
char __cdecl sub_80A0100(int a1, int a2)
{
  unsigned int v2; // ebp@0
  long double v4; // fst7@3
  int v5; // edi@5
  int v6; // ST18_4@5
  int v7; // esi@5
  int v8; // esi@5
  int v9; // esi@5
  int v10; // esi@5
  int v11; // eax@5
  int v12; // edx@6
  int v13; // edx@8
  int v14; // edx@9
  int v15; // eax@11
  std::ostream *v16; // edi@11
  int v17; // eax@11
  int v18; // esi@11
  char v19; // al@13
  std::ostream *v20; // eax@14
  int v21; // edx@15
  signed __int32 v22; // eax@17
  signed __int32 v23; // ecx@24
  signed __int32 v24; // ecx@26
  signed __int32 v25; // ecx@30
  int v26; // ebx@35
  int v27; // [sp+8h] [bp-100h]@0
  __int64 v28; // [sp+28h] [bp-E0h]@3
  char v29; // [sp+32h] [bp-D6h]@32
  char v30; // [sp+33h] [bp-D5h]@7
  int v31; // [sp+34h] [bp-D4h]@5
  int v32; // [sp+38h] [bp-D0h]@7
  int v33; // [sp+3Ch] [bp-CCh]@5
  int v34; // [sp+40h] [bp-C8h]@5
  int v35; // [sp+44h] [bp-C4h]@5
  int v36; // [sp+48h] [bp-C0h]@5
  int v37; // [sp+4Ch] [bp-BCh]@5
  int v38; // [sp+50h] [bp-B8h]@5
  int v39; // [sp+54h] [bp-B4h]@5
  int v40; // [sp+58h] [bp-B0h]@5
  char v41; // [sp+5Ch] [bp-ACh]@5
  int v42; // [sp+60h] [bp-A8h]@5
  int v43; // [sp+64h] [bp-A4h]@5
  int v44; // [sp+68h] [bp-A0h]@5
  int v45; // [sp+D8h] [bp-30h]@5
  char v46; // [sp+DCh] [bp-2Ch]@5
  char v47; // [sp+DDh] [bp-2Bh]@5
  int v48; // [sp+E0h] [bp-28h]@5
  int v49; // [sp+E4h] [bp-24h]@5
  int v50; // [sp+E8h] [bp-20h]@5
  int v51; // [sp+ECh] [bp-1Ch]@5

  if ( !*(_DWORD *)(a2 + 52) )
  {
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v28);
    v4 = (long double)(v28 - *(_QWORD *)(a2 + 72)) / 1000000000.0;
    if ( v4 >= (long double)*(signed int *)(a2 + 40) / 1000.0 )
    {
      if ( log_level <= 2 )
      {
        v5 = *(_DWORD *)(a2 + 48);
        v6 = *(_DWORD *)(a2 + 28);
        std::ios_base::ios_base((std::ios_base *)&v44);
        v44 = (int)&unk_80CF5C8;
        v45 = 0;
        v46 = 0;
        v47 = 0;
        v48 = 0;
        v49 = 0;
        v50 = 0;
        v51 = 0;
        v33 = dword_80CF674;
        *(int *)((char *)&v33 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        std::basic_ios<char,std::char_traits<char>>::init((char *)&v33 + *(_DWORD *)(v33 - 12), 0);
        v33 = (int)&unk_80CF5DC;
        v44 = (int)&unk_80CF5F0;
        v34 = (int)&unk_80CF7F0;
        v35 = 0;
        v36 = 0;
        v37 = 0;
        v38 = 0;
        v39 = 0;
        v40 = 0;
        std::locale::locale((std::locale *)&v41);
        v34 = (int)&unk_80CF588;
        v42 = 16;
        v43 = (int)&unk_80CF83C;
        std::basic_ios<char,std::char_traits<char>>::init(&v44, &v34);
        v7 = std::__ostream_insert<char,std::char_traits<char>>(
               &v33,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v7, "ICMP probe timeout ", 19);
        v8 = std::__ostream_insert<char,std::char_traits<char>>(
               v7,
               *(_DWORD *)(v6 + 32),
               *(_DWORD *)(*(_DWORD *)(v6 + 32) - 12));
        std::__ostream_insert<char,std::char_traits<char>>(v8, " #", 2);
        v9 = std::ostream::_M_insert<unsigned long>(v8, (unsigned __int16)v5);
        std::__ostream_insert<char,std::char_traits<char>>(v9, ": ", 2);
        v10 = std::ostream::_M_insert<double>(v9, COERCE_UNSIGNED_INT64(v4), COERCE_UNSIGNED_INT64(v4) >> 32);
        std::__ostream_insert<char,std::char_traits<char>>(v10, " sec", 4);
        v31 = (int)&unk_80CF83C;
        v11 = *(_DWORD *)(v10 + 24);
        if ( v11 )
        {
          v12 = *(_DWORD *)(v10 + 16);
          LOBYTE(v27) = 0;
          if ( v11 <= (unsigned int)v12 )
          {
            v32 = std::string::_S_construct<char *>(a2, v2, &v30, *(_DWORD *)(v10 + 20), v12, (int)&v30);
            std::string::swap((std::string *)&v31, (std::string *)&v32);
          }
          else
          {
            v32 = std::string::_S_construct<char *>(a2, v2, &v30, *(_DWORD *)(v10 + 20), v11, (int)&v30);
            std::string::swap((std::string *)&v31, (std::string *)&v32);
          }
          v13 = v32 - 12;
          if ( (_DWORD *)(v32 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
            }
            else
            {
              v25 = *(_DWORD *)(v32 - 4);
              *(_DWORD *)(v32 - 4) = v25 - 1;
            }
            if ( v25 <= 0 )
              std::string::_Rep::_M_destroy(v13, &v29);
          }
        }
        else
        {
          std::string::assign((std::string *)&v31, (const std::string *)(v10 + 40));
        }
        v33 = (int)&unk_80CF5DC;
        v44 = (int)&unk_80CF5F0;
        v34 = (int)&unk_80CF588;
        v14 = v43 - 12;
        if ( (_DWORD *)(v43 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v43 - 4), 0xFFFFFFFF);
          }
          else
          {
            v24 = *(_DWORD *)(v43 - 4);
            *(_DWORD *)(v43 - 4) = v24 - 1;
          }
          if ( v24 <= 0 )
            std::string::_Rep::_M_destroy(v14, &v32);
        }
        v34 = (int)&unk_80CF7F0;
        std::locale::~locale((std::locale *)&v41);
        v33 = dword_80CF674;
        *(int *)((char *)&v33 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        v44 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v44);
        if ( byte_80CE64C )
        {
          v15 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v31, *(_DWORD *)(v31 - 12));
          v16 = (std::ostream *)v15;
          v17 = *(_DWORD *)(*(_DWORD *)v15 - 12);
          v18 = *(_DWORD *)((char *)v16 + v17 + 124);
          if ( !v18 )
          {
            v26 = std::__throw_bad_cast();
            std::string::_Rep::_M_dispose(v31 - 12, &v33);
            Unwind_Resume(v26);
          }
          if ( *(_BYTE *)(v18 + 28) )
          {
            v19 = *(_BYTE *)(v18 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v16 + v17 + 124));
            v19 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v18 + 24))(v18, 10);
          }
          v20 = (std::ostream *)std::ostream::put(v16, v19);
          std::ostream::flush(v20);
        }
        syslog(6, "%s", v31, v27);
        v21 = v31 - 12;
        if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v22 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
          }
          else
          {
            v23 = *(_DWORD *)(v31 - 4);
            *(_DWORD *)(v31 - 4) = v23 - 1;
            v22 = v23;
          }
          if ( v22 <= 0 )
            std::string::_Rep::_M_destroy(v21, &v33);
        }
      }
      sub_809E380(a1, a2, 11);
    }
  }
  return 1;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D140: using guessed type int __cdecl std::ostream::_M_insert<double>(_DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080A0780) --------------------------------------------------------
int __cdecl sub_80A0780(int a1, int a2)
{
  int v2; // eax@3
  int v3; // eax@4
  int v4; // ebp@4
  int v5; // eax@8
  int v6; // ecx@8
  int result; // eax@12
  int v8; // edx@14
  int v9; // ecx@16
  int v10; // edi@17
  int v11; // edx@19
  int v12; // edi@21
  pthread_mutex_t *v13; // [sp+Ch] [bp-20h]@1

  v13 = (pthread_mutex_t *)(a1 + 12);
  if ( a1 == -12 )
    goto LABEL_27;
  if ( &_pthread_key_create )
  {
    v2 = pthread_mutex_lock(v13);
    if ( v2 )
    {
      std::__throw_system_error(v2);
LABEL_27:
      std::__throw_system_error(1);
      return sub_80A08D0(a1, (const void *)a2);
    }
  }
  v3 = *(_DWORD *)(a1 + 40);
  v4 = a1 + 36;
  while ( v3 != v4 )
  {
    while ( a2 != *(_DWORD *)(*(_DWORD *)(v3 + 28) + 8) )
    {
      v3 = *(_DWORD *)(v3 + 4);
      if ( v3 == v4 )
        goto LABEL_8;
    }
    v8 = *(_DWORD *)(v3 + 4);
    if ( v8 )
    {
      *(_DWORD *)(v8 + 8) = *(_DWORD *)(v3 + 8);
      v8 = *(_DWORD *)(v3 + 4);
    }
    v9 = *(_DWORD *)(v3 + 8);
    if ( v9 )
    {
      *(_DWORD *)(v9 + 4) = v8;
      v10 = *(_DWORD *)(v3 + 4);
    }
    else
    {
      v10 = v8;
    }
    *(_DWORD *)(v3 + 4) = 0;
    *(_DWORD *)(v3 + 8) = 0;
    (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
    v3 = v10;
  }
LABEL_8:
  v5 = *(_DWORD *)(a1 + 52);
  v6 = a1 + 48;
  while ( v5 != v6 )
  {
    while ( a2 != *(_DWORD *)(*(_DWORD *)(v5 + 28) + 8) )
    {
      v5 = *(_DWORD *)(v5 + 4);
      if ( v5 == v6 )
        goto LABEL_12;
    }
    v11 = *(_DWORD *)(v5 + 4);
    if ( v11 )
    {
      *(_DWORD *)(v11 + 8) = *(_DWORD *)(v5 + 8);
      v11 = *(_DWORD *)(v5 + 4);
    }
    v12 = *(_DWORD *)(v5 + 8);
    if ( v12 )
    {
      *(_DWORD *)(v12 + 4) = v11;
      v11 = *(_DWORD *)(v5 + 4);
    }
    *(_DWORD *)(v5 + 4) = 0;
    *(_DWORD *)(v5 + 8) = 0;
    *(_DWORD *)(v5 + 8) = *(_DWORD *)(a1 + 68);
    *(_DWORD *)(v5 + 4) = a1 + 60;
    *(_DWORD *)(*(_DWORD *)(a1 + 68) + 4) = v5;
    *(_DWORD *)(a1 + 68) = v5;
    v5 = v11;
  }
LABEL_12:
  result = (int)&_pthread_key_create;
  if ( &_pthread_key_create )
    result = pthread_mutex_unlock(v13);
  return result;
}

//----- (080A08D0) --------------------------------------------------------
int __cdecl sub_80A08D0(int a1, const void *a2)
{
  int v2; // eax@1
  void *v3; // eax@3
  void *v4; // eax@4
  void *v5; // ebx@5
  const void *v6; // edx@6
  void *v7; // eax@7
  unsigned int v8; // eax@11
  int result; // eax@14
  void *v10; // [sp+10h] [bp-2Ch]@4
  const void *v11; // [sp+14h] [bp-28h]@5
  unsigned int v12; // [sp+18h] [bp-24h]@3
  int v13; // [sp+1Ch] [bp-20h]@4

  v2 = -1431655765 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
  if ( v2 )
  {
    if ( __CFADD__(v2, v2) || (unsigned int)(1431655766 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2)) > 0x15555555 )
    {
      v12 = -4;
      v3 = (void *)operator new(0xFFFFFFFC);
    }
    else
    {
      v12 = 8 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
      v3 = (void *)operator new(8 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2));
    }
  }
  else
  {
    v12 = 12;
    v3 = (void *)operator new(0xCu);
  }
  v10 = v3;
  v13 = (int)((char *)v3 + 12);
  v4 = (char *)v3 + 4 * ((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2);
  if ( v4 )
  {
    qmemcpy(v4, a2, 0xCu);
    v5 = *(void **)(a1 + 4);
    v11 = *(const void **)a1;
  }
  else
  {
    v11 = *(const void **)a1;
    v5 = *(void **)(a1 + 4);
  }
  v6 = v11;
  if ( v5 != v11 )
  {
    v7 = v10;
    do
    {
      if ( v7 )
        qmemcpy(v7, v6, 0xCu);
      v6 = (char *)v6 + 12;
      v7 = (char *)v7 + 12;
    }
    while ( v6 != v5 );
    v8 = -2147483647 * ((unsigned int)((_BYTE *)v5 - ((_BYTE *)v11 + 12)) >> 2);
    v5 = *(void **)a1;
    v13 = (int)((char *)v10 + 4 * v8 + 24);
  }
  if ( v5 )
    operator delete(v5);
  *(_DWORD *)a1 = v10;
  *(_DWORD *)(a1 + 4) = v13;
  result = (int)((char *)v10 + v12);
  *(_DWORD *)(a1 + 8) = (char *)v10 + v12;
  return result;
}

//----- (080A0A50) --------------------------------------------------------
int __cdecl sub_80A0A50(int a1)
{
  int v1; // ebx@1
  pthread_mutex_t *v2; // esi@1
  int v3; // eax@3
  int i; // ebp@4
  int v5; // eax@5
  int v6; // eax@7
  int v7; // edi@14
  int v8; // ebp@15
  int v9; // ebx@15
  char v10; // bl@17
  int j; // ebp@24
  int v12; // eax@25
  int v13; // eax@27
  int result; // eax@34
  int v15; // [sp+Ch] [bp-20h]@14

  v1 = a1;
  v2 = (pthread_mutex_t *)(a1 + 12);
  if ( a1 == -12 )
    return std::__throw_system_error(1);
  if ( &_pthread_key_create )
  {
    v3 = pthread_mutex_lock((pthread_mutex_t *)(a1 + 12));
    if ( v3 )
    {
LABEL_36:
      std::__throw_system_error(v3);
      return std::__throw_system_error(1);
    }
  }
  for ( i = *(_DWORD *)(a1 + 64); i != a1 + 60; i = *(_DWORD *)(a1 + 64) )
  {
    v5 = *(_DWORD *)(i + 4);
    if ( v5 )
      *(_DWORD *)(v5 + 8) = *(_DWORD *)(i + 8);
    v6 = *(_DWORD *)(i + 8);
    if ( v6 )
      *(_DWORD *)(v6 + 4) = *(_DWORD *)(i + 4);
    *(_DWORD *)(i + 4) = 0;
    *(_DWORD *)(i + 8) = 0;
    if ( &_pthread_key_create )
      pthread_mutex_unlock(v2);
    sub_809D020(*(void **)(a1 + 4), i);
    if ( &_pthread_key_create )
    {
      v3 = pthread_mutex_lock(v2);
      if ( v3 )
        goto LABEL_36;
    }
  }
  v7 = *(_DWORD *)(a1 + 52);
  v15 = a1 + 48;
  if ( v7 != a1 + 48 )
  {
    v8 = *(_DWORD *)(v7 + 4);
    v9 = *(_DWORD *)(a1 + 52);
    if ( &_pthread_key_create )
LABEL_16:
      pthread_mutex_unlock(v2);
    while ( 1 )
    {
      v10 = sub_80A0100(*(_DWORD *)(a1 + 4), v9);
      if ( &_pthread_key_create )
      {
        v3 = pthread_mutex_lock(v2);
        if ( v3 )
          goto LABEL_36;
      }
      if ( !v10 || v8 == v15 )
      {
        v1 = a1;
        break;
      }
      v9 = v8;
      v8 = *(_DWORD *)(v8 + 4);
      if ( &_pthread_key_create )
        goto LABEL_16;
    }
  }
  for ( j = *(_DWORD *)(v1 + 40); v1 + 36 != j; j = *(_DWORD *)(v1 + 40) )
  {
    v12 = *(_DWORD *)(j + 4);
    if ( v12 )
      *(_DWORD *)(v12 + 8) = *(_DWORD *)(j + 8);
    v13 = *(_DWORD *)(j + 8);
    if ( v13 )
      *(_DWORD *)(v13 + 4) = *(_DWORD *)(j + 4);
    *(_DWORD *)(j + 4) = 0;
    *(_DWORD *)(j + 8) = 0;
    *(_DWORD *)(j + 8) = *(_DWORD *)(v1 + 56);
    *(_DWORD *)(j + 4) = v15;
    *(_DWORD *)(*(_DWORD *)(v1 + 56) + 4) = j;
    *(_DWORD *)(v1 + 56) = j;
    if ( &_pthread_key_create )
      pthread_mutex_unlock(v2);
    sub_809DC30(*(_DWORD *)(v1 + 4), j);
    if ( &_pthread_key_create )
    {
      v3 = pthread_mutex_lock(v2);
      if ( v3 )
        goto LABEL_36;
    }
  }
  result = (int)&_pthread_key_create;
  if ( &_pthread_key_create )
    result = pthread_mutex_unlock(v2);
  return result;
}

//----- (080A0C80) --------------------------------------------------------
int __usercall sub_80A0C80@<eax>(int a1@<eax>)
{
  return std::basic_ios<char,std::char_traits<char>>::clear(
           *(_DWORD *)(*(_DWORD *)a1 - 12) + a1,
           *(_DWORD *)(*(_DWORD *)(*(_DWORD *)a1 - 12) + a1 + 20) | 1);
}
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);

//----- (080A0CA0) --------------------------------------------------------
int __usercall sub_80A0CA0@<eax>(unsigned int a1@<eax>)
{
  unsigned int v1; // edi@2
  int result; // eax@2
  unsigned int v3; // edx@2
  int v4; // edi@2
  int v5; // eax@14
  int v6; // edx@14
  int v7; // ecx@14

  if ( a1 > 0x3FFFFFFF )
  {
    v5 = std::__throw_bad_alloc();
    return sub_80A0D50(v5, v6, v7);
  }
  v1 = 4 * a1;
  result = operator new(4 * a1);
  v3 = v1;
  v4 = result;
  if ( v3 >= 4 )
  {
    if ( result & 1 )
    {
      *(_BYTE *)result = 0;
      v4 = result + 1;
      --v3;
    }
    if ( v4 & 2 )
    {
      *(_WORD *)v4 = 0;
      v4 += 2;
      v3 -= 2;
    }
    memset((void *)v4, 0, 4 * (v3 >> 2));
    v4 += 4 * (v3 >> 2);
  }
  if ( !(v3 & 2) )
  {
    if ( !(v3 & 1) )
      return result;
LABEL_6:
    *(_BYTE *)v4 = 0;
    return result;
  }
  *(_WORD *)v4 = 0;
  v4 += 2;
  if ( v3 & 1 )
    goto LABEL_6;
  return result;
}

//----- (080A0D50) --------------------------------------------------------
int __usercall sub_80A0D50@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // esi@1
  int result; // eax@1
  int v5; // ebp@2
  int v6; // ecx@3
  int v7; // [sp+0h] [bp-14h]@2

  v3 = a1;
  result = *(_DWORD *)(*(_DWORD *)a1 + 4 * a2);
  if ( !result )
    return 0;
  v5 = *(_DWORD *)result;
  v7 = *(_DWORD *)a3;
  if ( *(_DWORD *)(*(_DWORD *)result + 4) != *(_DWORD *)a3 )
  {
    while ( 1 )
    {
      v6 = *(_DWORD *)v5;
      if ( !*(_DWORD *)v5 || a2 != *(_DWORD *)(v6 + 4) % *(_DWORD *)(v3 + 4) )
        break;
      result = v5;
      v5 = *(_DWORD *)v5;
      if ( *(_DWORD *)(v6 + 4) == v7 )
        return result;
    }
    return 0;
  }
  return result;
}

//----- (080A0DC0) --------------------------------------------------------
int __cdecl sub_80A0DC0(int a1, int a2)
{
  char *v2; // esi@1
  bool v3; // zf@2
  int v4; // edi@3
  signed int v5; // ecx@3
  int result; // eax@7

  v2 = *(char **)(a2 + 4);
  if ( v2 == "St19_Sp_make_shared_tag" )
    goto LABEL_11;
  v3 = *v2 == 42;
  if ( *v2 == 42 )
    goto LABEL_12;
  v4 = (int)"St19_Sp_make_shared_tag";
  v5 = 24;
  do
  {
    if ( !v5 )
      break;
    v3 = *v2++ == *(_BYTE *)v4++;
    --v5;
  }
  while ( v3 );
  if ( v3 )
LABEL_11:
    result = a1 + 16;
  else
LABEL_12:
    result = 0;
  return result;
}

//----- (080A0F20) --------------------------------------------------------
int __cdecl sub_80A0F20(int a1)
{
  unsigned int v1; // eax@1
  int result; // eax@1

  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 8) = 0;
  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 16) = 1065353216;
  *(_DWORD *)(a1 + 20) = 0;
  v1 = std::__detail::_Prime_rehash_policy::_M_next_bkt((std::__detail::_Prime_rehash_policy *)(a1 + 16), 0xAu);
  *(_DWORD *)(a1 + 4) = v1;
  result = sub_80A0CA0(v1);
  *(_DWORD *)a1 = result;
  return result;
}

//----- (080A0F70) --------------------------------------------------------
void __cdecl sub_80A0F70(void *a1)
{
  int v1; // ebx@1
  int v2; // edi@4
  int v3; // eax@4
  unsigned int v4; // edx@8
  void *v5; // edi@8

  v1 = *((_DWORD *)a1 + 2);
  if ( v1 )
  {
    while ( 1 )
    {
      v2 = *(_DWORD *)v1;
      v3 = *(_DWORD *)(v1 + 8);
      if ( v3 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
        if ( !v3 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      operator delete((void *)v1);
      if ( !v2 )
        break;
      v1 = v2;
    }
  }
  v4 = 4 * *((_DWORD *)a1 + 1);
  v5 = *(void **)a1;
  if ( v4 >= 4 )
  {
    if ( (unsigned __int8)v5 & 1 )
    {
      *(_BYTE *)v5 = 0;
      v5 = (char *)v5 + 1;
      --v4;
    }
    if ( (unsigned __int8)v5 & 2 )
    {
      *(_WORD *)v5 = 0;
      v5 = (char *)v5 + 2;
      v4 -= 2;
    }
    memset(v5, 0, 4 * (v4 >> 2));
    v5 = (char *)v5 + 4 * (v4 >> 2);
  }
  if ( v4 & 2 )
  {
    *(_WORD *)v5 = 0;
    v5 = (char *)v5 + 2;
  }
  if ( v4 & 1 )
    *(_BYTE *)v5 = 0;
  *((_DWORD *)a1 + 3) = 0;
  *((_DWORD *)a1 + 2) = 0;
  operator delete(*(void **)a1);
}

//----- (080A1030) --------------------------------------------------------
char __cdecl sub_80A1030(int a1, int a2)
{
  char result; // al@2
  unsigned int v3; // [sp+8h] [bp-10h]@3
  int v4; // [sp+Ch] [bp-Ch]@3

  if ( kill(*(_DWORD *)(a2 + 12), 0) )
  {
    result = 0;
  }
  else
  {
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v3);
    if ( *(_DWORD *)(a2 + 20) <= v4 && (*(_DWORD *)(a2 + 20) < v4 || *(_DWORD *)(a2 + 16) <= v3) )
    {
      *(_BYTE *)(a2 + 48) = 1;
      result = 0;
    }
    else
    {
      result = 1;
    }
  }
  return result;
}

//----- (080A10A0) --------------------------------------------------------
int __userpurge sub_80A10A0@<eax>(int a1, int a2, unsigned int a3)
{
  int v3; // esi@1
  int v4; // edi@4
  int v5; // ebx@4
  int v6; // eax@4
  int v7; // edx@4
  int v8; // ecx@5
  int v9; // edx@7
  int v10; // edx@8
  int v11; // eax@10
  std::ostream *v12; // edi@10
  int v13; // eax@10
  int v14; // ebx@10
  char v15; // al@12
  std::ostream *v16; // eax@13
  int v17; // edx@14
  pthread_t *v18; // ebx@16
  int v19; // edi@19
  int v20; // eax@19
  int i; // ebx@19
  int v22; // ecx@22
  int v23; // edx@24
  int v24; // eax@26
  bool v25; // zf@28
  int v27; // edx@35
  int v28; // edi@36
  signed __int32 v29; // ebx@44
  signed __int32 v30; // ebx@48
  int v31; // edi@54
  signed __int32 v32; // ecx@56
  int v33; // [sp+Ch] [bp-F0h]@0
  unsigned int v34; // [sp+14h] [bp-E8h]@19
  int v35; // [sp+18h] [bp-E4h]@19
  char v36; // [sp+22h] [bp-DAh]@46
  char v37; // [sp+23h] [bp-D9h]@6
  int v38; // [sp+24h] [bp-D8h]@4
  int v39; // [sp+28h] [bp-D4h]@6
  int v40; // [sp+2Ch] [bp-D0h]@4
  int v41; // [sp+30h] [bp-CCh]@4
  int v42; // [sp+34h] [bp-C8h]@4
  int v43; // [sp+38h] [bp-C4h]@4
  int v44; // [sp+3Ch] [bp-C0h]@4
  int v45; // [sp+40h] [bp-BCh]@4
  int v46; // [sp+44h] [bp-B8h]@4
  int v47; // [sp+48h] [bp-B4h]@4
  char v48; // [sp+4Ch] [bp-B0h]@4
  int v49; // [sp+50h] [bp-ACh]@4
  int v50; // [sp+54h] [bp-A8h]@4
  int v51; // [sp+58h] [bp-A4h]@4
  int v52; // [sp+C8h] [bp-34h]@4
  char v53; // [sp+CCh] [bp-30h]@4
  char v54; // [sp+CDh] [bp-2Fh]@4
  int v55; // [sp+D0h] [bp-2Ch]@4
  int v56; // [sp+D4h] [bp-28h]@4
  int v57; // [sp+D8h] [bp-24h]@4
  int v58; // [sp+DCh] [bp-20h]@4

  v3 = *(_DWORD *)(a3 + 8);
  if ( v3 )
    _InterlockedIncrement((volatile signed __int32 *)(v3 + 4));
  if ( log_level <= 3 )
  {
    std::ios_base::ios_base((std::ios_base *)&v51);
    v51 = (int)&unk_80CF5C8;
    v52 = 0;
    v53 = 0;
    v54 = 0;
    v55 = 0;
    v56 = 0;
    v57 = 0;
    v58 = 0;
    v4 = dword_80CF674;
    v40 = dword_80CF674;
    *(int *)((char *)&v40 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v40 + *(_DWORD *)(v40 - 12), 0);
    v40 = (int)&unk_80CF5DC;
    v51 = (int)&unk_80CF5F0;
    v41 = (int)&unk_80CF7F0;
    v42 = 0;
    v43 = 0;
    v44 = 0;
    v45 = 0;
    v46 = 0;
    v47 = 0;
    std::locale::locale((std::locale *)&v48);
    v41 = (int)&unk_80CF588;
    v49 = 16;
    v50 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v51, &v41);
    v5 = std::__ostream_insert<char,std::char_traits<char>>(&v40, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v5, "task process killed: ", 21);
    v6 = std::ostream::operator<<(v5, *(_DWORD *)(v3 + 12));
    v38 = (int)&unk_80CF83C;
    v7 = *(_DWORD *)(v6 + 24);
    if ( v7 )
    {
      v8 = *(_DWORD *)(v6 + 16);
      LOBYTE(v33) = 0;
      if ( v7 <= (unsigned int)v8 )
      {
        v39 = std::string::_S_construct<char *>((int)&v37, a3, (void *)v4, *(_DWORD *)(v6 + 20), v8, (int)&v37);
        std::string::swap((std::string *)&v38, (std::string *)&v39);
      }
      else
      {
        v39 = std::string::_S_construct<char *>((int)&v37, a3, (void *)v4, *(_DWORD *)(v6 + 20), v7, (int)&v37);
        std::string::swap((std::string *)&v38, (std::string *)&v39);
      }
      v9 = v39 - 12;
      if ( (_DWORD *)(v39 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v29 = _InterlockedExchangeAdd((volatile signed __int32 *)(v39 - 4), 0xFFFFFFFF);
        }
        else
        {
          v29 = *(_DWORD *)(v39 - 4);
          *(_DWORD *)(v39 - 4) = v29 - 1;
        }
        if ( v29 <= 0 )
          std::string::_Rep::_M_destroy(v9, &v36);
      }
    }
    else
    {
      std::string::assign((std::string *)&v38, (const std::string *)(v6 + 40));
    }
    v40 = (int)&unk_80CF5DC;
    v51 = (int)&unk_80CF5F0;
    v41 = (int)&unk_80CF588;
    v10 = v50 - 12;
    if ( (_DWORD *)(v50 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v30 = _InterlockedExchangeAdd((volatile signed __int32 *)(v50 - 4), 0xFFFFFFFF);
      }
      else
      {
        v30 = *(_DWORD *)(v50 - 4);
        *(_DWORD *)(v50 - 4) = v30 - 1;
      }
      if ( v30 <= 0 )
        std::string::_Rep::_M_destroy(v10, &v39);
    }
    v41 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v48);
    v40 = v4;
    *(int *)((char *)&v40 + *(_DWORD *)(v4 - 12)) = dword_80CF678;
    v51 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v51);
    if ( byte_80CE64C )
    {
      v11 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v38, *(_DWORD *)(v38 - 12));
      v12 = (std::ostream *)v11;
      v13 = *(_DWORD *)(*(_DWORD *)v11 - 12);
      v14 = *(_DWORD *)((char *)v12 + v13 + 124);
      if ( !v14 )
      {
        v31 = std::__throw_bad_cast();
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v40);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v37);
        sub_8056F10(v3);
        Unwind_Resume(v31);
      }
      if ( *(_BYTE *)(v14 + 28) )
      {
        v15 = *(_BYTE *)(v14 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v12 + v13 + 124));
        v15 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v14 + 24))(v14, 10);
      }
      v16 = (std::ostream *)std::ostream::put(v12, v15);
      std::ostream::flush(v16);
    }
    syslog(5, "%s", v38, v33);
    v17 = v38 - 12;
    if ( (_DWORD *)(v38 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v32 = _InterlockedExchangeAdd((volatile signed __int32 *)(v38 - 4), 0xFFFFFFFF);
      }
      else
      {
        v32 = *(_DWORD *)(v38 - 4);
        *(_DWORD *)(v38 - 4) = v32 - 1;
      }
      if ( v32 <= 0 )
        std::string::_Rep::_M_destroy(v17, &v40);
    }
  }
  kill(*(_DWORD *)(v3 + 12), 9);
  if ( *(_DWORD *)(v3 + 44) )
  {
    close(*(_DWORD *)(v3 + 40));
    std::thread::join(*(std::thread **)(v3 + 44));
    v18 = *(pthread_t **)(v3 + 44);
    *(_DWORD *)(v3 + 44) = 0;
    if ( v18 )
    {
      if ( !pthread_equal(*v18, 0) )
        std::terminate();
      operator delete(v18);
    }
  }
  v34 = *(_DWORD *)(a2 + 4);
  v35 = *(_DWORD *)(a3 + 4) % v34;
  v19 = *(_DWORD *)a2;
  v20 = *(_DWORD *)a2 + 4 * v35;
  for ( i = *(_DWORD *)v20; a3 != *(_DWORD *)i; i = *(_DWORD *)i )
    ;
  v22 = *(_DWORD *)a3;
  if ( *(_DWORD *)v20 == i )
  {
    if ( v22 )
    {
      v27 = *(_DWORD *)(v22 + 4) % v34;
      if ( v35 == v27 )
        goto LABEL_26;
      *(_DWORD *)(v19 + 4 * v27) = i;
      v20 = *(_DWORD *)a2 + 4 * v35;
      v28 = *(_DWORD *)v20;
    }
    else
    {
      v28 = i;
    }
    if ( v28 == a2 + 8 )
      *(_DWORD *)(a2 + 8) = v22;
    *(_DWORD *)v20 = 0;
    v22 = *(_DWORD *)a3;
  }
  else if ( v22 )
  {
    v23 = *(_DWORD *)(v22 + 4) % v34;
    if ( v35 != v23 )
    {
      *(_DWORD *)(v19 + 4 * v23) = i;
      v22 = *(_DWORD *)a3;
    }
  }
LABEL_26:
  *(_DWORD *)i = v22;
  *(_DWORD *)a1 = *(_DWORD *)a3;
  v24 = *(_DWORD *)(a3 + 8);
  if ( v24 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v24 + 4));
    if ( !v24 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  operator delete((void *)a3);
  v25 = (*(_DWORD *)(a2 + 12))-- == 1;
  _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
  if ( v25 )
    (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
  return a1;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080A1710) --------------------------------------------------------
char __cdecl sub_80A1710(int a1, char a2)
{
  char result; // al@2
  unsigned int v3; // [sp+Ch] [bp-Ch]@1

  sub_80A3E40((int)&v3, a1, (int)&a2);
  if ( v3 )
  {
    sub_80A10A0((int)&v3, a1, v3);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (080A1770) --------------------------------------------------------
void __cdecl sub_80A1770(int a1)
{
  unsigned int v1; // esi@1
  int v2; // ebx@3
  bool v3; // zf@6
  int v4; // ecx@10
  int v5; // eax@11
  void (__cdecl *v6)(_DWORD, _DWORD, _DWORD); // eax@13
  int v7; // eax@13
  int v8; // esi@16
  int v9; // [sp+18h] [bp-30h]@11
  unsigned int v10; // [sp+1Ch] [bp-2Ch]@10
  int v11; // [sp+2Ch] [bp-1Ch]@13

  v1 = *(_DWORD *)(a1 + 8);
LABEL_2:
  while ( v1 )
  {
    while ( 1 )
    {
      v2 = *(_DWORD *)(v1 + 8);
      if ( v2 )
        _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
      if ( sub_80A1030(a1, v2) )
      {
        v1 = *(_DWORD *)v1;
        v3 = v2 == 0;
        if ( !v2 )
          goto LABEL_2;
      }
      else
      {
        sub_80A10A0((int)&v10, a1, v1);
        v1 = v10;
        v4 = *(_DWORD *)(v2 + 32);
        v3 = v4 == 0;
        if ( v4 )
        {
          v5 = *(_DWORD *)(v2 + 8);
          v9 = v5;
          if ( v5 )
          {
            _InterlockedIncrement((volatile signed __int32 *)(v5 + 4));
            if ( !*(_DWORD *)(v2 + 32) )
            {
              v8 = std::__throw_bad_function_call();
              sub_8056F10(v9);
              sub_8056F10(v2);
              Unwind_Resume(v8);
            }
          }
          v6 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(v2 + 36);
          v11 = v9;
          v6(v2 + 24, &v11, v2 + 48);
          v7 = v11;
          v3 = v11 == 0;
          if ( v11 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v11 + 4));
            if ( v3 )
              (*(void (__cdecl **)(int))(*(_DWORD *)v7 + 4))(v7);
          }
        }
      }
      _InterlockedDecrement((volatile signed __int32 *)(v2 + 4));
      if ( !v3 )
        break;
      (*(void (__cdecl **)(int))(*(_DWORD *)v2 + 4))(v2);
      if ( !v1 )
        return;
    }
  }
}
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);

//----- (080A1870) --------------------------------------------------------
char __cdecl sub_80A1870(int a1, int a2, int a3, char *s, void *src, int a6, int a7, int a8, int a9)
{
  unsigned int v9; // ebp@0
  const void *v10; // ebx@1
  int v11; // esi@1
  int v13; // esi@8
  int v14; // eax@10
  int v15; // ebx@10
  int v16; // eax@12
  int v17; // eax@14
  int v18; // esi@20
  int v19; // eax@20
  int v20; // ebx@20
  int v21; // eax@20
  int v22; // edi@20
  int v23; // eax@21
  int v24; // esi@22
  signed __int32 v25; // eax@24
  signed __int32 v26; // eax@27
  int v27; // eax@30
  pthread_t *v28; // esi@30
  char *v29; // esi@40
  void *v30; // edi@40
  int v31; // ebx@40
  size_t v32; // eax@41
  int v33; // eax@42
  int v34; // edx@43
  int v35; // edx@45
  int v36; // edx@46
  int v37; // eax@48
  std::ostream *v38; // esi@48
  int v39; // eax@48
  int v40; // ebx@48
  char v41; // al@50
  std::ostream *v42; // eax@51
  int v43; // edx@53
  signed __int32 v44; // eax@55
  char *v45; // esi@60
  int v46; // ebx@60
  int v47; // ebx@60
  size_t v48; // eax@61
  int v49; // eax@62
  int v50; // edx@63
  int v51; // edx@65
  int v52; // edx@66
  int v53; // eax@68
  std::ostream *v54; // esi@68
  int v55; // eax@68
  int v56; // ebx@68
  char v57; // al@70
  std::ostream *v58; // eax@71
  int v59; // edx@72
  signed __int32 v60; // ebx@74
  char *v61; // esi@78
  void *v62; // edi@78
  int v63; // ebx@78
  size_t v64; // eax@79
  int v65; // eax@80
  int v66; // edx@81
  int v67; // edx@83
  int v68; // edx@84
  int v69; // eax@86
  std::ostream *v70; // esi@86
  int v71; // eax@86
  int v72; // ebx@86
  char v73; // al@88
  std::ostream *v74; // eax@89
  int i; // edi@110
  char **v76; // eax@113
  int v77; // edi@113
  int v78; // esi@114
  int v79; // ebx@137
  signed __int32 v80; // ecx@139
  signed __int32 v81; // ecx@143
  signed __int32 v82; // ecx@145
  signed __int32 v83; // ecx@149
  signed __int32 v84; // ecx@155
  int v85; // eax@158
  int v86; // ebx@159
  signed __int32 v87; // ebx@167
  signed __int32 v88; // ebx@171
  int v89; // [sp+Ch] [bp-11Ch]@0
  char ***v90; // [sp+20h] [bp-108h]@40
  int v91; // [sp+24h] [bp-104h]@3
  __pid_t v92; // [sp+28h] [bp-100h]@4
  int v93; // [sp+28h] [bp-100h]@7
  int v94; // [sp+28h] [bp-100h]@12
  unsigned int v95; // [sp+2Ch] [bp-FCh]@8
  std::ios_base *v96; // [sp+2Ch] [bp-FCh]@110
  __int64 v97; // [sp+30h] [bp-F8h]@8
  int v98; // [sp+3Ch] [bp-ECh]@1
  char v99; // [sp+42h] [bp-E6h]@151
  char v100; // [sp+43h] [bp-E5h]@64
  int v101; // [sp+44h] [bp-E4h]@4
  int v102; // [sp+48h] [bp-E0h]@7
  int pipedes; // [sp+4Ch] [bp-DCh]@20
  int fd; // [sp+50h] [bp-D8h]@20
  __int64 v105; // [sp+54h] [bp-D4h]@8
  char **argv; // [sp+5Ch] [bp-CCh]@22
  int v107; // [sp+60h] [bp-C8h]@22
  char **v108; // [sp+64h] [bp-C4h]@40
  int v109; // [sp+68h] [bp-C0h]@40
  int v110; // [sp+6Ch] [bp-BCh]@40
  int v111; // [sp+70h] [bp-B8h]@40
  int v112; // [sp+74h] [bp-B4h]@40
  int v113; // [sp+78h] [bp-B0h]@40
  char v114; // [sp+7Ch] [bp-ACh]@40
  int v115; // [sp+80h] [bp-A8h]@40
  int v116; // [sp+84h] [bp-A4h]@40
  int v117; // [sp+88h] [bp-A0h]@40
  int v118; // [sp+F8h] [bp-30h]@40
  char v119; // [sp+FCh] [bp-2Ch]@40
  char v120; // [sp+FDh] [bp-2Bh]@40
  int v121; // [sp+100h] [bp-28h]@40
  int v122; // [sp+104h] [bp-24h]@40
  int v123; // [sp+108h] [bp-20h]@40
  int v124; // [sp+10Ch] [bp-1Ch]@40

  v10 = src;
  v11 = a6;
  sub_80A3E40((int)&v98, a1, *(_DWORD *)a2 + 8);
  if ( v98 )
    return 0;
  v91 = a8 & 1;
  if ( a8 & 1 && pipe(&pipedes) == -1 )
  {
    if ( log_level <= 5 )
    {
      v29 = s;
      v90 = &argv;
      std::ios_base::ios_base((std::ios_base *)&v117);
      v117 = (int)&unk_80CF5C8;
      v118 = 0;
      v119 = 0;
      v120 = 0;
      v121 = 0;
      v122 = 0;
      v123 = 0;
      v124 = 0;
      v30 = (void *)dword_80CF674;
      argv = (char **)dword_80CF674;
      *(char ***)((char *)&argv + *(_DWORD *)(dword_80CF674 - 12)) = (char **)dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init(&(*(argv - 3))[(_DWORD)&argv], 0);
      argv = (char **)&unk_80CF5DC;
      v117 = (int)&unk_80CF5F0;
      v107 = (int)&unk_80CF7F0;
      v108 = 0;
      v109 = 0;
      v110 = 0;
      v111 = 0;
      v112 = 0;
      v113 = 0;
      std::locale::locale((std::locale *)&v114);
      v107 = (int)&unk_80CF588;
      v115 = 16;
      v116 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v117, &v107);
      v31 = std::__ostream_insert<char,std::char_traits<char>>(
              &argv,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v31, "failed to create pipe for: ", 27);
      if ( v29 )
      {
        v32 = strlen(v29);
        std::__ostream_insert<char,std::char_traits<char>>(v31, v29, v32);
      }
      else
      {
        sub_80A0C80(v31);
      }
      v102 = (int)&unk_80CF83C;
      v33 = *(_DWORD *)(v31 + 24);
      if ( v33 )
      {
        v34 = *(_DWORD *)(v31 + 16);
        LOBYTE(v89) = 0;
        if ( v33 <= (unsigned int)v34 )
        {
          LODWORD(v105) = std::string::_S_construct<char *>(v31, v9, v30, *(_DWORD *)(v31 + 20), v34, (int)&v101);
          std::string::swap((std::string *)&v102, (std::string *)&v105);
        }
        else
        {
          LODWORD(v105) = std::string::_S_construct<char *>(v31, v9, v30, *(_DWORD *)(v31 + 20), v33, (int)&v101);
          std::string::swap((std::string *)&v102, (std::string *)&v105);
        }
        v35 = v105 - 12;
        if ( (_DWORD *)(v105 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v80 = _InterlockedExchangeAdd((volatile signed __int32 *)(v105 - 4), 0xFFFFFFFF);
          }
          else
          {
            v80 = *(_DWORD *)(v105 - 4);
            *(_DWORD *)(v105 - 4) = v80 - 1;
          }
          if ( v80 <= 0 )
            std::string::_Rep::_M_destroy(v35, &v100);
        }
      }
      else
      {
        std::string::assign((std::string *)&v102, (const std::string *)(v31 + 40));
      }
      argv = (char **)&unk_80CF5DC;
      v117 = (int)&unk_80CF5F0;
      v107 = (int)&unk_80CF588;
      v36 = v116 - 12;
      if ( (_DWORD *)(v116 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v84 = _InterlockedExchangeAdd((volatile signed __int32 *)(v116 - 4), 0xFFFFFFFF);
        }
        else
        {
          v84 = *(_DWORD *)(v116 - 4);
          *(_DWORD *)(v116 - 4) = v84 - 1;
        }
        if ( v84 <= 0 )
          std::string::_Rep::_M_destroy(v36, &v105);
      }
      v107 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v114);
      argv = (char **)v30;
      *(char ***)((char *)&argv + *((_DWORD *)v30 - 3)) = (char **)dword_80CF678;
      v117 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v117);
      if ( !byte_80CE64C )
        goto LABEL_52;
      v37 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v102, *(_DWORD *)(v102 - 12));
      v38 = (std::ostream *)v37;
      v39 = *(_DWORD *)(*(_DWORD *)v37 - 12);
      v40 = *(_DWORD *)((char *)v38 + v39 + 124);
      if ( v40 )
      {
        if ( *(_BYTE *)(v40 + 28) )
        {
          v41 = *(_BYTE *)(v40 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v38 + v39 + 124));
          v41 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v40 + 24))(v40, 10);
        }
        v42 = (std::ostream *)std::ostream::put(v38, v41);
        std::ostream::flush(v42);
LABEL_52:
        syslog(3, "%s", v102, v89);
        goto LABEL_53;
      }
      v85 = std::__throw_bad_cast();
LABEL_159:
      v86 = v85;
      std::string::_Rep::_M_dispose(v102 - 12, v90);
      Unwind_Resume(v86);
    }
    return 0;
  }
  v92 = fork();
  v101 = v92;
  if ( v92 == -1 )
  {
    if ( log_level <= 5 )
    {
      v61 = s;
      v90 = &argv;
      std::ios_base::ios_base((std::ios_base *)&v117);
      v117 = (int)&unk_80CF5C8;
      v118 = 0;
      v119 = 0;
      v120 = 0;
      v121 = 0;
      v122 = 0;
      v123 = 0;
      v124 = 0;
      v62 = (void *)dword_80CF674;
      argv = (char **)dword_80CF674;
      *(char ***)((char *)&argv + *(_DWORD *)(dword_80CF674 - 12)) = (char **)dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init(&(*(argv - 3))[(_DWORD)&argv], 0);
      argv = (char **)&unk_80CF5DC;
      v117 = (int)&unk_80CF5F0;
      v107 = (int)&unk_80CF7F0;
      v108 = 0;
      v109 = 0;
      v110 = 0;
      v111 = 0;
      v112 = 0;
      v113 = 0;
      std::locale::locale((std::locale *)&v114);
      v107 = (int)&unk_80CF588;
      v115 = 16;
      v116 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v117, &v107);
      v63 = std::__ostream_insert<char,std::char_traits<char>>(
              &argv,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v63, "fork failed: ", 13);
      if ( v61 )
      {
        v64 = strlen(v61);
        std::__ostream_insert<char,std::char_traits<char>>(v63, v61, v64);
      }
      else
      {
        std::basic_ios<char,std::char_traits<char>>::clear(
          v63 + *(_DWORD *)(*(_DWORD *)v63 - 12),
          *(_DWORD *)(v63 + *(_DWORD *)(*(_DWORD *)v63 - 12) + 20) | 1);
      }
      v102 = (int)&unk_80CF83C;
      v65 = *(_DWORD *)(v63 + 24);
      if ( v65 )
      {
        v66 = *(_DWORD *)(v63 + 16);
        LOBYTE(v89) = 0;
        if ( v65 <= (unsigned int)v66 )
        {
          LODWORD(v105) = std::string::_S_construct<char *>(v63, v9, v62, *(_DWORD *)(v63 + 20), v66, (int)&v100);
          std::string::swap((std::string *)&v102, (std::string *)&v105);
        }
        else
        {
          LODWORD(v105) = std::string::_S_construct<char *>(v63, v9, v62, *(_DWORD *)(v63 + 20), v65, (int)&v100);
          std::string::swap((std::string *)&v102, (std::string *)&v105);
        }
        v67 = v105 - 12;
        if ( (_DWORD *)(v105 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v83 = _InterlockedExchangeAdd((volatile signed __int32 *)(v105 - 4), 0xFFFFFFFF);
          }
          else
          {
            v83 = *(_DWORD *)(v105 - 4);
            *(_DWORD *)(v105 - 4) = v83 - 1;
          }
          if ( v83 <= 0 )
            std::string::_Rep::_M_destroy(v67, &v99);
        }
      }
      else
      {
        std::string::assign((std::string *)&v102, (const std::string *)(v63 + 40));
      }
      argv = (char **)&unk_80CF5DC;
      v117 = (int)&unk_80CF5F0;
      v107 = (int)&unk_80CF588;
      v68 = v116 - 12;
      if ( (_DWORD *)(v116 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v82 = _InterlockedExchangeAdd((volatile signed __int32 *)(v116 - 4), 0xFFFFFFFF);
        }
        else
        {
          v82 = *(_DWORD *)(v116 - 4);
          *(_DWORD *)(v116 - 4) = v82 - 1;
        }
        if ( v82 <= 0 )
          std::string::_Rep::_M_destroy(v68, &v105);
      }
      v107 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v114);
      argv = (char **)v62;
      *(char ***)((char *)&argv + *((_DWORD *)v62 - 3)) = (char **)dword_80CF678;
      v117 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v117);
      if ( byte_80CE64C )
      {
        v69 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v102, *(_DWORD *)(v102 - 12));
        v70 = (std::ostream *)v69;
        v71 = *(_DWORD *)(*(_DWORD *)v69 - 12);
        v72 = *(_DWORD *)((char *)v70 + v71 + 124);
        if ( !v72 )
        {
          v85 = std::__throw_bad_cast();
          goto LABEL_159;
        }
        if ( *(_BYTE *)(v72 + 28) )
        {
          v73 = *(_BYTE *)(v72 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v70 + v71 + 124));
          v73 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v72 + 24))(v72, 10);
        }
        v74 = (std::ostream *)std::ostream::put(v70, v73);
        std::ostream::flush(v74);
      }
      syslog(3, "%s", v102, v89);
LABEL_53:
      v43 = v102 - 12;
      if ( (_DWORD *)(v102 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v44 = _InterlockedExchangeAdd((volatile signed __int32 *)(v102 - 4), 0xFFFFFFFF);
        }
        else
        {
          v81 = *(_DWORD *)(v102 - 4);
          *(_DWORD *)(v102 - 4) = v81 - 1;
          v44 = v81;
        }
        if ( v44 <= 0 )
          std::string::_Rep::_M_destroy(v43, v90);
      }
    }
    return 0;
  }
  if ( !v92 )
  {
    prctl(1, 1);
    if ( v91 )
    {
      while ( dup2(fd, 1) == -1 && *_errno_location() == 4 )
        ;
      while ( dup2(fd, 2) == -1 && *_errno_location() == 4 )
        ;
      close(fd);
      close(pipedes);
    }
    v96 = (std::ios_base *)sysconf(4);
    for ( i = 3; i < (signed int)v96; ++i )
      close(i);
    argv = 0;
    v107 = 0;
    v108 = 0;
    v76 = 0;
    v77 = 4 * v11 >> 2;
    if ( v77 )
    {
      if ( (unsigned int)v77 > 0x3FFFFFFF )
      {
        v79 = std::__throw_bad_alloc();
        v117 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base(v96);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v101);
        Unwind_Resume(v79);
      }
      v76 = (char **)operator new(4 * v77);
    }
    argv = v76;
    v78 = (int)&v76[v77];
    v108 = &v76[v77];
    if ( v77 )
      memmove(v76, v10, 4 * v77);
    v107 = v78;
    if ( (char **)v78 == v108 )
    {
      sub_80A4010((int)&argv, argv, (int)&s);
    }
    else if ( argv == (char **)v78 )
    {
      if ( v78 )
        *(_DWORD *)v78 = s;
      v107 += 4;
    }
    else
    {
      LODWORD(v105) = s;
      sub_80A3E80((int)&argv, argv, (int)&v105);
    }
    LODWORD(v105) = 0;
    if ( (char **)v107 == v108 )
    {
      sub_80A4320((int)&argv, (int)&v105);
    }
    else
    {
      if ( v107 )
        *(_DWORD *)v107 = 0;
      v107 += 4;
    }
    execv(s, argv);
    exit(0);
  }
  if ( log_level <= 3 )
  {
    v45 = s;
    v90 = &argv;
    std::ios_base::ios_base((std::ios_base *)&v117);
    v117 = (int)&unk_80CF5C8;
    v118 = 0;
    v119 = 0;
    v120 = 0;
    v121 = 0;
    v122 = 0;
    v123 = 0;
    v124 = 0;
    argv = (char **)dword_80CF674;
    *(char ***)((char *)&argv + *(_DWORD *)(dword_80CF674 - 12)) = (char **)dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init(&(*(argv - 3))[(_DWORD)&argv], 0);
    argv = (char **)&unk_80CF5DC;
    v117 = (int)&unk_80CF5F0;
    v107 = (int)&unk_80CF7F0;
    v108 = 0;
    v109 = 0;
    v110 = 0;
    v111 = 0;
    v112 = 0;
    v113 = 0;
    std::locale::locale((std::locale *)&v114);
    v107 = (int)&unk_80CF588;
    v115 = 16;
    v116 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v117, &v107);
    v46 = std::__ostream_insert<char,std::char_traits<char>>(
            &argv,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v46, "process started: (", 18);
    v47 = std::ostream::operator<<(v46, v92);
    std::__ostream_insert<char,std::char_traits<char>>(v47, ") ", 2);
    if ( v45 )
    {
      v48 = strlen(v45);
      std::__ostream_insert<char,std::char_traits<char>>(v47, v45, v48);
    }
    else
    {
      std::basic_ios<char,std::char_traits<char>>::clear(
        v47 + *(_DWORD *)(*(_DWORD *)v47 - 12),
        *(_DWORD *)(v47 + *(_DWORD *)(*(_DWORD *)v47 - 12) + 20) | 1);
    }
    v102 = (int)&unk_80CF83C;
    v49 = *(_DWORD *)(v47 + 24);
    if ( v49 )
    {
      v50 = *(_DWORD *)(v47 + 16);
      LOBYTE(v89) = 0;
      if ( v49 > (unsigned int)v50 )
      {
        LODWORD(v105) = std::string::_S_construct<char *>(v47, v9, &v98, *(_DWORD *)(v47 + 20), v49, (int)&v100);
        v93 = (int)&v102;
        std::string::swap((std::string *)&v102, (std::string *)&v105);
      }
      else
      {
        LODWORD(v105) = std::string::_S_construct<char *>(v47, v9, &v98, *(_DWORD *)(v47 + 20), v50, (int)&v100);
        v93 = (int)&v102;
        std::string::swap((std::string *)&v102, (std::string *)&v105);
      }
      v51 = v105 - 12;
      if ( (_DWORD *)(v105 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v88 = _InterlockedExchangeAdd((volatile signed __int32 *)(v105 - 4), 0xFFFFFFFF);
        }
        else
        {
          v88 = *(_DWORD *)(v105 - 4);
          *(_DWORD *)(v105 - 4) = v88 - 1;
        }
        if ( v88 <= 0 )
          std::string::_Rep::_M_destroy(v51, &v99);
      }
    }
    else
    {
      v93 = (int)&v102;
      std::string::assign((std::string *)&v102, (const std::string *)(v47 + 40));
    }
    argv = (char **)&unk_80CF5DC;
    v117 = (int)&unk_80CF5F0;
    v107 = (int)&unk_80CF588;
    v52 = v116 - 12;
    if ( (_DWORD *)(v116 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v87 = _InterlockedExchangeAdd((volatile signed __int32 *)(v116 - 4), 0xFFFFFFFF);
      }
      else
      {
        v87 = *(_DWORD *)(v116 - 4);
        *(_DWORD *)(v116 - 4) = v87 - 1;
      }
      if ( v87 <= 0 )
        std::string::_Rep::_M_destroy(v52, &v105);
    }
    v107 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v114);
    argv = (char **)dword_80CF674;
    *(char ***)((char *)&argv + *(_DWORD *)(dword_80CF674 - 12)) = (char **)dword_80CF678;
    v117 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v117);
    if ( byte_80CE64C )
    {
      v53 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v102, *(_DWORD *)(v102 - 12));
      v54 = (std::ostream *)v53;
      v55 = *(_DWORD *)(*(_DWORD *)v53 - 12);
      v56 = *(_DWORD *)((char *)v54 + v55 + 124);
      if ( !v56 )
      {
        v85 = std::__throw_bad_cast();
        goto LABEL_159;
      }
      if ( *(_BYTE *)(v56 + 28) )
      {
        v57 = *(_BYTE *)(v56 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v54 + v55 + 124));
        v57 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v56 + 24))(v56, 10);
      }
      v58 = (std::ostream *)std::ostream::put(v54, v57);
      std::ostream::flush(v58);
    }
    syslog(5, "%s", v102, v89);
    v59 = v102 - 12;
    if ( (_DWORD *)(v102 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v60 = _InterlockedExchangeAdd((volatile signed __int32 *)(v102 - 4), 0xFFFFFFFF);
      }
      else
      {
        v60 = *(_DWORD *)(v102 - 4);
        *(_DWORD *)(v102 - 4) = v60 - 1;
      }
      if ( v60 <= 0 )
        std::string::_Rep::_M_destroy(v59, &argv);
    }
  }
  else
  {
    v93 = (int)&v102;
  }
  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v97);
  v105 = v97 + 1000000000LL * a3;
  sub_80A3D50(v93, a2, (int)&v101, (int)&v105, a7);
  v95 = *(_DWORD *)(*(_DWORD *)a2 + 8);
  v13 = v102;
  if ( v102 )
    _InterlockedIncrement((volatile signed __int32 *)(v102 + 4));
  v14 = operator new(0xCu);
  v15 = v14;
  if ( v14 )
  {
    *(_DWORD *)v14 = 0;
    *(_DWORD *)(v14 + 4) = v95;
    *(_DWORD *)(v14 + 8) = v13;
    v13 = 0;
  }
  else
  {
    v95 = v4;
  }
  v94 = v95 % *(_DWORD *)(a1 + 4);
  v16 = sub_80A0D50(a1, v95 % *(_DWORD *)(a1 + 4), v14 + 4);
  if ( v16 && *(_DWORD *)v16 )
  {
    v17 = *(_DWORD *)(v15 + 8);
    if ( v17 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v17 + 4));
      if ( !v17 )
        (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
    }
    operator delete((void *)v15);
  }
  else
  {
    sub_80A43E0((int)&v98, a1, v94, v95, v15);
  }
  if ( v13 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v13 + 4));
    if ( !v13 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  if ( v91 )
  {
    close(fd);
    v18 = v102;
    *(_DWORD *)(v102 + 40) = pipedes;
    v19 = operator new(4u);
    v20 = v19;
    *(_DWORD *)v19 = 0;
    v21 = operator new(0x28u);
    v22 = v21;
    if ( v21 )
    {
      *(_DWORD *)(v21 + 4) = 1;
      *(_DWORD *)(v21 + 8) = 1;
      *(_DWORD *)v21 = &off_80BDB20;
      *(_DWORD *)(v21 + 12) = v21 + 16;
      *(_DWORD *)(v21 + 20) = 0;
      *(_DWORD *)(v21 + 24) = 0;
      *(_DWORD *)(v21 + 16) = &off_80BDB08;
      *(_DWORD *)(v21 + 28) = a1;
      *(_DWORD *)(v21 + 32) = v18;
      *(_DWORD *)(v21 + 36) = a9;
      v23 = sub_80A0DC0(v21, (int)&off_80BD238);
    }
    else
    {
      v23 = 0;
    }
    argv = (char **)v23;
    v107 = v22;
    std::thread::_M_start_thread(v20, (struct_thread_imp **)&argv);
    v24 = v107;
    if ( v107 )
    {
      if ( &_pthread_key_create )
      {
        v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v107 + 4), 0xFFFFFFFF);
      }
      else
      {
        v25 = *(_DWORD *)(v107 + 4);
        *(_DWORD *)(v107 + 4) = v25 - 1;
      }
      if ( v25 == 1 )
      {
        (*(void (__cdecl **)(int))(*(_DWORD *)v24 + 8))(v24);
        if ( &_pthread_key_create )
        {
          v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v24 + 8), 0xFFFFFFFF);
        }
        else
        {
          v26 = *(_DWORD *)(v24 + 8);
          *(_DWORD *)(v24 + 8) = v26 - 1;
        }
        if ( v26 == 1 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v24 + 12))(v24);
      }
    }
    v27 = v102;
    v28 = *(pthread_t **)(v102 + 44);
    *(_DWORD *)(v102 + 44) = v20;
    if ( !v28 )
      goto LABEL_34;
    if ( !pthread_equal(*v28, 0) )
      std::terminate();
    operator delete(v28);
  }
  v27 = v102;
LABEL_34:
  if ( v27 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v27 + 4));
    if ( !v27 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  return 1;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80BD238: using guessed type void *off_80BD238;
// 80BDB08: using guessed type void *off_80BDB08;
// 80BDB20: using guessed type void *off_80BDB20;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080A2E10) --------------------------------------------------------
ssize_t __cdecl sub_80A2E10(int a1, int a2, unsigned int a3)
{
  void *v3; // eax@2
  unsigned int v4; // edi@2
  std::string *v5; // ebp@3
  int v6; // edi@4
  unsigned int v7; // edi@4
  int v8; // edi@5
  ssize_t result; // eax@9
  unsigned int v10; // esi@9
  int v11; // edi@15
  void *v12; // edi@15
  int v13; // eax@15
  int v14; // edx@15
  int v15; // ecx@16
  int v16; // edx@18
  int v17; // edx@19
  int v18; // edx@20
  int v19; // eax@22
  std::ostream *v20; // ebp@22
  int v21; // eax@22
  int v22; // edi@22
  char v23; // al@24
  std::ostream *v24; // eax@25
  int v25; // edx@26
  signed __int32 v26; // edi@28
  unsigned int v27; // edi@35
  int v28; // edi@37
  int v29; // ebp@37
  unsigned int v30; // edi@37
  int v31; // edi@38
  int v32; // esi@45
  int v33; // edi@45
  int v34; // eax@45
  int v35; // edx@45
  int v36; // ecx@46
  int v37; // edi@48
  int v38; // edi@49
  int v39; // eax@51
  int v40; // edi@51
  int v41; // eax@51
  int v42; // esi@51
  char v43; // al@53
  std::ostream *v44; // eax@54
  int v45; // edx@55
  signed __int32 v46; // edi@64
  signed __int32 v47; // edi@68
  int v48; // ebx@74
  signed __int32 v49; // ecx@76
  signed __int32 v50; // edx@80
  signed __int32 v51; // edi@88
  ssize_t v52; // ecx@93
  int v53; // [sp+Ch] [bp-1110h]@0
  int v54; // [sp+Ch] [bp-1110h]@15
  int v55; // [sp+1Ch] [bp-1100h]@4
  char *v56; // [sp+28h] [bp-10F4h]@74
  char v57; // [sp+3Dh] [bp-10DFh]@15
  char v58; // [sp+3Eh] [bp-10DEh]@90
  char v59; // [sp+3Fh] [bp-10DDh]@17
  int v60; // [sp+40h] [bp-10DCh]@15
  int v61; // [sp+44h] [bp-10D8h]@15
  int v62; // [sp+48h] [bp-10D4h]@17
  int v63; // [sp+4Ch] [bp-10D0h]@15
  int v64; // [sp+50h] [bp-10CCh]@15
  int v65; // [sp+54h] [bp-10C8h]@15
  int v66; // [sp+58h] [bp-10C4h]@15
  int v67; // [sp+5Ch] [bp-10C0h]@15
  int v68; // [sp+60h] [bp-10BCh]@15
  int v69; // [sp+64h] [bp-10B8h]@15
  int v70; // [sp+68h] [bp-10B4h]@15
  char v71; // [sp+6Ch] [bp-10B0h]@15
  int v72; // [sp+70h] [bp-10ACh]@15
  int v73; // [sp+74h] [bp-10A8h]@15
  int v74; // [sp+78h] [bp-10A4h]@15
  int v75; // [sp+E8h] [bp-1034h]@15
  char v76; // [sp+ECh] [bp-1030h]@15
  char v77; // [sp+EDh] [bp-102Fh]@15
  int v78; // [sp+F0h] [bp-102Ch]@15
  int v79; // [sp+F4h] [bp-1028h]@15
  int v80; // [sp+F8h] [bp-1024h]@15
  int v81; // [sp+FCh] [bp-1020h]@15
  char v82; // [sp+100h] [bp-101Ch]@8

  while ( 1 )
  {
    result = read(*(_DWORD *)(a2 + 40), &v82, 0x1000u);
    v10 = result;
    if ( result <= 0 )
      break;
    if ( log_level <= 1 )
    {
      std::string::string(&v61, &v82, result, &v57);
      std::ios_base::ios_base((std::ios_base *)&v74);
      v74 = (int)&unk_80CF5C8;
      v75 = 0;
      v76 = 0;
      v77 = 0;
      v78 = 0;
      v79 = 0;
      v80 = 0;
      v81 = 0;
      v63 = dword_80CF674;
      *(int *)((char *)&v63 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v63 + *(_DWORD *)(v63 - 12), 0);
      v63 = (int)&unk_80CF5DC;
      v74 = (int)&unk_80CF5F0;
      v64 = (int)&unk_80CF7F0;
      v65 = 0;
      v66 = 0;
      v67 = 0;
      v68 = 0;
      v69 = 0;
      v70 = 0;
      std::locale::locale((std::locale *)&v71);
      v64 = (int)&unk_80CF588;
      v72 = 16;
      v73 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v74, &v64);
      v11 = std::__ostream_insert<char,std::char_traits<char>>(
              &v63,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v11, "task process read ", 18);
      v12 = (void *)std::ostream::operator<<(v11, *(_DWORD *)(a2 + 12));
      std::__ostream_insert<char,std::char_traits<char>>(v12, ": ", 2);
      v13 = std::__ostream_insert<char,std::char_traits<char>>(v12, v61, *(_DWORD *)(v61 - 12));
      v60 = (int)&unk_80CF83C;
      v14 = *(_DWORD *)(v13 + 24);
      if ( v14 )
      {
        v15 = *(_DWORD *)(v13 + 16);
        LOBYTE(v54) = 0;
        if ( v14 <= (unsigned int)v15 )
        {
          v62 = std::string::_S_construct<char *>(a2, (unsigned int)&v74, v12, *(_DWORD *)(v13 + 20), v15, (int)&v59);
          std::string::swap((std::string *)&v60, (std::string *)&v62);
        }
        else
        {
          v62 = std::string::_S_construct<char *>(a2, (unsigned int)&v74, v12, *(_DWORD *)(v13 + 20), v14, (int)&v59);
          std::string::swap((std::string *)&v60, (std::string *)&v62);
        }
        v16 = v62 - 12;
        if ( (_DWORD *)(v62 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v51 = _InterlockedExchangeAdd((volatile signed __int32 *)(v62 - 4), 0xFFFFFFFF);
          }
          else
          {
            v51 = *(_DWORD *)(v62 - 4);
            *(_DWORD *)(v62 - 4) = v51 - 1;
          }
          if ( v51 <= 0 )
            std::string::_Rep::_M_destroy(v16, &v58);
        }
      }
      else
      {
        std::string::assign((std::string *)&v60, (const std::string *)(v13 + 40));
      }
      v63 = (int)&unk_80CF5DC;
      v74 = (int)&unk_80CF5F0;
      v64 = (int)&unk_80CF588;
      v17 = v73 - 12;
      if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v47 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
        }
        else
        {
          v47 = *(_DWORD *)(v73 - 4);
          *(_DWORD *)(v73 - 4) = v47 - 1;
        }
        if ( v47 <= 0 )
          std::string::_Rep::_M_destroy(v17, &v62);
      }
      v64 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v71);
      v63 = dword_80CF674;
      *(int *)((char *)&v63 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v74 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v74);
      v18 = v61 - 12;
      if ( (_DWORD *)(v61 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v61 - 4), 0xFFFFFFFF);
        }
        else
        {
          v46 = *(_DWORD *)(v61 - 4);
          *(_DWORD *)(v61 - 4) = v46 - 1;
        }
        if ( v46 <= 0 )
          std::string::_Rep::_M_destroy(v18, &v63);
      }
      if ( byte_80CE64C )
      {
        v19 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v60, *(_DWORD *)(v60 - 12));
        v20 = (std::ostream *)v19;
        v21 = *(_DWORD *)(*(_DWORD *)v19 - 12);
        v22 = *(_DWORD *)((char *)v20 + v21 + 124);
        if ( !v22 )
        {
          v48 = std::__throw_bad_cast();
          v56 = &v59;
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v63);
LABEL_71:
          std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v56);
          std::string::_Rep::_M_dispose(v61 - 12, v56);
          Unwind_Resume(v48);
        }
        if ( *(_BYTE *)(v22 + 28) )
        {
          v23 = *(_BYTE *)(v22 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v20 + v21 + 124));
          v23 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v22 + 24))(v22, 10);
        }
        v24 = (std::ostream *)std::ostream::put(v20, v23);
        std::ostream::flush(v24);
      }
      syslog(7, "%s", v60, v54);
      v25 = v60 - 12;
      if ( (_DWORD *)(v60 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v60 - 4), 0xFFFFFFFF);
        }
        else
        {
          v26 = *(_DWORD *)(v60 - 4);
          *(_DWORD *)(v60 - 4) = v26 - 1;
        }
        if ( v26 <= 0 )
          std::string::_Rep::_M_destroy(v25, &v63);
      }
    }
    if ( a3 )
    {
      v3 = *(void **)(a2 + 52);
      v4 = *((_DWORD *)v3 - 3);
      if ( 2 * a3 < v4 )
      {
        v5 = (std::string *)(a2 + 52);
        if ( *((_DWORD *)v3 - 1) < 0 )
        {
          v55 = (int)((char *)v3 + v4);
          v7 = v4 - a3;
        }
        else
        {
          std::string::_M_leak_hard((std::string *)(a2 + 52));
          v3 = *(void **)(a2 + 52);
          v6 = *((_DWORD *)v3 - 3);
          v55 = (int)((char *)v3 + v6);
          v7 = v6 - a3;
          if ( *((_DWORD *)v3 - 1) >= 0 )
          {
            std::string::_M_leak_hard((std::string *)(a2 + 52));
            v3 = *(void **)(a2 + 52);
            v8 = (int)((char *)v3 + v7);
            if ( *((_DWORD *)v3 - 1) >= 0 )
            {
              std::string::_M_leak_hard((std::string *)(a2 + 52));
              v3 = *(void **)(a2 + 52);
            }
            goto LABEL_7;
          }
        }
        v8 = (int)((char *)v3 + v7);
LABEL_7:
        LOBYTE(v53) = 0;
        sub_80A41A0(v3, v8, v55);
        std::string::resize((std::string *)(a2 + 52), a3, 0);
        goto LABEL_8;
      }
    }
    v5 = (std::string *)(a2 + 52);
LABEL_8:
    std::string::append(v5, &v82, v10);
  }
  if ( log_level <= 1 )
  {
    std::ios_base::ios_base((std::ios_base *)&v74);
    v74 = (int)&unk_80CF5C8;
    v75 = 0;
    v76 = 0;
    v77 = 0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v81 = 0;
    v32 = dword_80CF674;
    v63 = dword_80CF674;
    *(int *)((char *)&v63 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v63 + *(_DWORD *)(v63 - 12), 0);
    v63 = (int)&unk_80CF5DC;
    v74 = (int)&unk_80CF5F0;
    v64 = (int)&unk_80CF7F0;
    v65 = 0;
    v66 = 0;
    v67 = 0;
    v68 = 0;
    v69 = 0;
    v70 = 0;
    std::locale::locale((std::locale *)&v71);
    v64 = (int)&unk_80CF588;
    v72 = 16;
    v73 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v74, &v64);
    v33 = std::__ostream_insert<char,std::char_traits<char>>(
            &v63,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v33, "task process read done: ", 24);
    v34 = std::ostream::operator<<(v33, *(_DWORD *)(a2 + 12));
    v61 = (int)&unk_80CF83C;
    v35 = *(_DWORD *)(v34 + 24);
    if ( v35 )
    {
      v36 = *(_DWORD *)(v34 + 16);
      LOBYTE(v53) = 0;
      if ( v35 <= (unsigned int)v36 )
      {
        v62 = std::string::_S_construct<char *>(a2, (unsigned int)&v74, &v60, *(_DWORD *)(v34 + 20), v36, (int)&v60);
        std::string::swap((std::string *)&v61, (std::string *)&v62);
      }
      else
      {
        v62 = std::string::_S_construct<char *>(a2, (unsigned int)&v74, &v60, *(_DWORD *)(v34 + 20), v35, (int)&v60);
        std::string::swap((std::string *)&v61, (std::string *)&v62);
      }
      v37 = v62 - 12;
      if ( (_DWORD *)(v62 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v50 = _InterlockedExchangeAdd((volatile signed __int32 *)(v62 - 4), 0xFFFFFFFF);
        }
        else
        {
          v50 = *(_DWORD *)(v62 - 4);
          *(_DWORD *)(v62 - 4) = v50 - 1;
        }
        if ( v50 <= 0 )
          std::string::_Rep::_M_destroy(v37, &v59);
      }
    }
    else
    {
      std::string::assign((std::string *)&v61, (const std::string *)(v34 + 40));
    }
    v63 = (int)&unk_80CF5DC;
    v74 = (int)&unk_80CF5F0;
    v64 = (int)&unk_80CF588;
    v38 = v73 - 12;
    if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v49 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
      }
      else
      {
        v49 = *(_DWORD *)(v73 - 4);
        *(_DWORD *)(v73 - 4) = v49 - 1;
      }
      if ( v49 <= 0 )
        std::string::_Rep::_M_destroy(v38, &v62);
    }
    v64 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v71);
    v63 = v32;
    *(int *)((char *)&v63 + *(_DWORD *)(v32 - 12)) = dword_80CF678;
    v74 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v74);
    if ( byte_80CE64C )
    {
      v39 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v61, *(_DWORD *)(v61 - 12));
      v40 = v39;
      v41 = *(_DWORD *)(*(_DWORD *)v39 - 12);
      v42 = *(_DWORD *)(v40 + v41 + 124);
      if ( !v42 )
      {
        v48 = std::__throw_bad_cast();
        std::basic_stringbuf<char,std::char_traits<char>,std::allocator<char>>::~basic_stringbuf(v40);
        v63 = dword_80CF674;
        *(int *)((char *)&v63 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        v74 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v74);
        v56 = &v59;
        goto LABEL_71;
      }
      if ( *(_BYTE *)(v42 + 28) )
      {
        v43 = *(_BYTE *)(v42 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)(v40 + v41 + 124));
        v43 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v42 + 24))(v42, 10);
      }
      v44 = (std::ostream *)std::ostream::put((std::ostream *)v40, v43);
      std::ostream::flush(v44);
    }
    syslog(7, "%s", v61, v53);
    result = v61;
    v45 = v61 - 12;
    if ( (_DWORD *)(v61 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        result = _InterlockedExchangeAdd((volatile signed __int32 *)(v61 - 4), 0xFFFFFFFF);
      }
      else
      {
        v52 = *(_DWORD *)(v61 - 4);
        *(_DWORD *)(v61 - 4) = v52 - 1;
        result = v52;
      }
      if ( result <= 0 )
        result = std::string::_Rep::_M_destroy(v45, &v63);
    }
  }
  if ( !a3 )
    return result;
  result = *(_DWORD *)(a2 + 52);
  v27 = *(_DWORD *)(result - 12);
  if ( a3 >= v27 )
    return result;
  if ( *(_DWORD *)(result - 4) < 0 )
  {
    v29 = result + v27;
    v30 = v27 - a3;
    goto LABEL_44;
  }
  std::string::_M_leak_hard((std::string *)(a2 + 52));
  result = *(_DWORD *)(a2 + 52);
  v28 = *(_DWORD *)(result - 12);
  v29 = result + v28;
  v30 = v28 - a3;
  if ( *(_DWORD *)(result - 4) < 0 )
  {
LABEL_44:
    v31 = result + v30;
    goto LABEL_40;
  }
  std::string::_M_leak_hard((std::string *)(a2 + 52));
  result = *(_DWORD *)(a2 + 52);
  v31 = result + v30;
  if ( *(_DWORD *)(result - 4) >= 0 )
  {
    std::string::_M_leak_hard((std::string *)(a2 + 52));
    result = *(_DWORD *)(a2 + 52);
  }
LABEL_40:
  sub_80A41A0((void *)result, v31, v29);
  return std::string::resize((std::string *)(a2 + 52), a3, 0);
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080A3A60) --------------------------------------------------------
ssize_t __cdecl sub_80A3A60(int a1)
{
  return sub_80A2E10(*(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 20));
}

//----- (080A3D50) --------------------------------------------------------
int __userpurge sub_80A3D50@<eax>(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // esi@1
  int v6; // edi@1
  int v7; // eax@1
  int v8; // ebx@1
  int v9; // eax@1

  v5 = *(_DWORD *)a4;
  v6 = *(_DWORD *)(a4 + 4);
  v7 = operator new(0x38u);
  v8 = v7;
  *(_DWORD *)(v7 + 4) = 0;
  *(_DWORD *)v7 = &off_80BDBA0;
  v9 = *(_DWORD *)a2;
  *(_DWORD *)(v8 + 8) = *(_DWORD *)a2;
  if ( v9 )
    _InterlockedIncrement((volatile signed __int32 *)(v9 + 4));
  *(_DWORD *)(v8 + 12) = *(_DWORD *)a3;
  *(_DWORD *)(v8 + 16) = v5;
  *(_DWORD *)(v8 + 20) = v6;
  *(_DWORD *)(v8 + 32) = 0;
  if ( *(_DWORD *)(a5 + 8) )
  {
    *(_DWORD *)(v8 + 36) = *(_DWORD *)(a5 + 12);
    *(_DWORD *)(v8 + 32) = *(_DWORD *)(a5 + 8);
    (*(void (__cdecl **)(int, int, signed int))(a5 + 8))(v8 + 24, a5, 2);
  }
  *(_DWORD *)(v8 + 40) = 0;
  *(_DWORD *)(v8 + 44) = 0;
  *(_BYTE *)(v8 + 48) = 0;
  *(_DWORD *)(v8 + 52) = &unk_80CF83C;
  *(_DWORD *)a1 = v8;
  _InterlockedIncrement((volatile signed __int32 *)(v8 + 4));
  return a1;
}
// 80BDBA0: using guessed type void *off_80BDBA0;

//----- (080A3E40) --------------------------------------------------------
int __userpurge sub_80A3E40@<eax>(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // eax@2
  int result; // eax@3

  v3 = sub_80A0D50(a2, *(_DWORD *)a3 % *(_DWORD *)(a2 + 4), a3);
  if ( v3 && (v4 = *(_DWORD *)v3) != 0 )
  {
    *(_DWORD *)a1 = v4;
    result = a1;
  }
  else
  {
    *(_DWORD *)a1 = 0;
    result = a1;
  }
  return result;
}

//----- (080A3E80) --------------------------------------------------------
void __cdecl sub_80A3E80(int a1, void *a2, int a3)
{
  int v3; // eax@1
  int v4; // edx@2
  int v5; // eax@2
  const void *v6; // edx@6
  int v7; // eax@6
  unsigned __int8 v8; // cf@7
  int v9; // eax@7
  signed int v10; // edx@8
  signed int v11; // ST1C_4@9
  void *v12; // ebp@9
  int v13; // eax@10
  signed int v14; // eax@12
  int v15; // edi@13
  void *v16; // edi@14
  int v17; // eax@14
  int v18; // edx@15
  int v19; // edi@16
  int v20; // ST1C_4@20
  int v21; // [sp+18h] [bp-24h]@8

  v3 = *(_DWORD *)(a1 + 4);
  if ( v3 != *(_DWORD *)(a1 + 8) )
  {
    *(_DWORD *)v3 = *(_DWORD *)(v3 - 4);
    v4 = *(_DWORD *)(a1 + 4);
    *(_DWORD *)(a1 + 4) = v4 + 4;
    v5 = (v4 - 4 - (signed int)a2) >> 2;
    if ( v5 )
      memmove((void *)(v4 - 4 * v5), a2, 4 * v5);
    *(_DWORD *)a2 = *(_DWORD *)a3;
    return;
  }
  v6 = *(const void **)a1;
  v7 = (v3 - *(_DWORD *)a1) >> 2;
  if ( v7 )
  {
    v8 = __CFADD__(v7, v7);
    v9 = 2 * v7;
    if ( v8 || (unsigned int)v9 > 0x3FFFFFFF )
    {
      v10 = ((_BYTE *)a2 - (_BYTE *)v6) >> 2;
      v21 = -4;
    }
    else
    {
      v21 = 4 * v9;
      v10 = ((_BYTE *)a2 - (_BYTE *)v6) >> 2;
      v12 = 0;
      if ( !v9 )
        goto LABEL_10;
    }
  }
  else
  {
    v10 = ((_BYTE *)a2 - (_BYTE *)v6) >> 2;
    v21 = 4;
  }
  v11 = v10;
  v12 = (void *)operator new(v21);
  v10 = v11;
LABEL_10:
  v13 = (int)((char *)v12 + 4 * v10);
  if ( v13 )
    *(_DWORD *)v13 = *(_DWORD *)a3;
  v14 = (signed int)((char *)a2 - *(_DWORD *)a1) >> 2;
  if ( v14 )
  {
    v15 = 4 * v14;
    memmove(v12, *(const void **)a1, 4 * v14);
  }
  else
  {
    v15 = 0;
  }
  v16 = (char *)v12 + v15 + 4;
  v17 = (*(_DWORD *)(a1 + 4) - (signed int)a2) >> 2;
  if ( v17 )
  {
    v20 = 4 * v17;
    memmove(v16, a2, 4 * v17);
    v18 = v20;
  }
  else
  {
    v18 = 0;
  }
  v19 = (int)((char *)v16 + v18);
  if ( *(_DWORD *)a1 )
    operator delete(*(void **)a1);
  *(_DWORD *)a1 = v12;
  *(_DWORD *)(a1 + 4) = v19;
  *(_DWORD *)(a1 + 8) = (char *)v12 + v21;
}

//----- (080A4010) --------------------------------------------------------
void __cdecl sub_80A4010(int a1, void *a2, int a3)
{
  int v3; // eax@1
  int v4; // edx@2
  int v5; // eax@2
  const void *v6; // edx@6
  int v7; // eax@6
  unsigned __int8 v8; // cf@7
  int v9; // eax@7
  signed int v10; // edx@8
  signed int v11; // ST1C_4@9
  void *v12; // ebp@9
  int v13; // eax@10
  signed int v14; // eax@12
  int v15; // edi@13
  void *v16; // edi@14
  int v17; // eax@14
  int v18; // edx@15
  int v19; // edi@16
  int v20; // ST1C_4@20
  int v21; // [sp+18h] [bp-24h]@8

  v3 = *(_DWORD *)(a1 + 4);
  if ( v3 != *(_DWORD *)(a1 + 8) )
  {
    *(_DWORD *)v3 = *(_DWORD *)(v3 - 4);
    v4 = *(_DWORD *)(a1 + 4);
    *(_DWORD *)(a1 + 4) = v4 + 4;
    v5 = (v4 - 4 - (signed int)a2) >> 2;
    if ( v5 )
      memmove((void *)(v4 - 4 * v5), a2, 4 * v5);
    *(_DWORD *)a2 = *(_DWORD *)a3;
    return;
  }
  v6 = *(const void **)a1;
  v7 = (v3 - *(_DWORD *)a1) >> 2;
  if ( v7 )
  {
    v8 = __CFADD__(v7, v7);
    v9 = 2 * v7;
    if ( v8 || (unsigned int)v9 > 0x3FFFFFFF )
    {
      v10 = ((_BYTE *)a2 - (_BYTE *)v6) >> 2;
      v21 = -4;
    }
    else
    {
      v21 = 4 * v9;
      v10 = ((_BYTE *)a2 - (_BYTE *)v6) >> 2;
      v12 = 0;
      if ( !v9 )
        goto LABEL_10;
    }
  }
  else
  {
    v10 = ((_BYTE *)a2 - (_BYTE *)v6) >> 2;
    v21 = 4;
  }
  v11 = v10;
  v12 = (void *)operator new(v21);
  v10 = v11;
LABEL_10:
  v13 = (int)((char *)v12 + 4 * v10);
  if ( v13 )
    *(_DWORD *)v13 = *(_DWORD *)a3;
  v14 = (signed int)((char *)a2 - *(_DWORD *)a1) >> 2;
  if ( v14 )
  {
    v15 = 4 * v14;
    memmove(v12, *(const void **)a1, 4 * v14);
  }
  else
  {
    v15 = 0;
  }
  v16 = (char *)v12 + v15 + 4;
  v17 = (*(_DWORD *)(a1 + 4) - (signed int)a2) >> 2;
  if ( v17 )
  {
    v20 = 4 * v17;
    memmove(v16, a2, 4 * v17);
    v18 = v20;
  }
  else
  {
    v18 = 0;
  }
  v19 = (int)((char *)v16 + v18);
  if ( *(_DWORD *)a1 )
    operator delete(*(void **)a1);
  *(_DWORD *)a1 = v12;
  *(_DWORD *)(a1 + 4) = v19;
  *(_DWORD *)(a1 + 8) = (char *)v12 + v21;
}

//----- (080A41A0) --------------------------------------------------------
void *__cdecl sub_80A41A0(void *a1, int a2, int a3)
{
  void *result; // eax@1
  int v4; // ebx@3
  signed int v5; // edi@3
  signed int v6; // esi@4
  int v7; // edx@6
  int v8; // eax@7
  char v9; // bp@8
  int v10; // ecx@15
  int v11; // ebp@15
  char v12; // dl@16
  int v13; // edx@20
  char v14; // bl@21
  char v15; // dl@26
  int v16; // esi@26
  size_t v17; // ecx@26
  char v18; // ST18_1@27
  char v19; // ST18_1@29
  signed int v20; // [sp+18h] [bp-24h]@3
  int v21; // [sp+1Ch] [bp-20h]@15

  result = a1;
  if ( (void *)a2 != a1 && a3 != a2 )
  {
    v4 = (int)a1;
    v20 = a3 - (_DWORD)a1;
    v5 = a2 - (_DWORD)a1;
    if ( a3 - (_DWORD)a1 - (a2 - (_DWORD)a1) == a2 - (_DWORD)a1 )
    {
      v13 = a2;
      do
      {
        v14 = *(_BYTE *)result;
        *(_BYTE *)result = *(_BYTE *)v13;
        *(_BYTE *)v13 = v14;
        result = (char *)result + 1;
        ++v13;
      }
      while ( result != (void *)a2 );
    }
    else
    {
      v6 = v20 - v5;
      if ( v20 - v5 <= v5 )
        goto LABEL_13;
      while ( v5 != 1 )
      {
        v7 = v4 + v5;
        if ( v6 > 0 )
        {
          v8 = 0;
          do
          {
            v9 = *(_BYTE *)(v4 + v8);
            *(_BYTE *)(v4 + v8) = *(_BYTE *)(v7 + v8);
            *(_BYTE *)(v7 + v8++) = v9;
          }
          while ( v8 != v6 );
          v4 += v8;
        }
        result = (void *)(v20 / v5);
        if ( !(v20 % v5) )
          return result;
        v6 = v5;
        v5 -= v20 % v5;
        while ( 1 )
        {
          v20 = v6;
          v6 -= v5;
          if ( v6 > v5 )
            break;
LABEL_13:
          result = (void *)(v4 + v20);
          if ( v6 == 1 )
          {
            if ( (char *)result - 1 == (_BYTE *)v4 )
            {
              *(_BYTE *)v4 = *((char *)result - 1);
            }
            else
            {
              v19 = *((char *)result - 1);
              result = memmove(
                         (void *)((_BYTE *)result - ((char *)result + -v4 - 1)),
                         (const void *)v4,
                         (size_t)((char *)result + -v4 - 1));
              *(_BYTE *)v4 = v19;
            }
            return result;
          }
          v4 = (int)((char *)result - v6);
          if ( v5 > 0 )
          {
            v10 = v4 - 1;
            v11 = (int)((char *)result - v5);
            v21 = (int)((char *)result - v6);
            do
            {
              v12 = *(_BYTE *)v10;
              *(_BYTE *)v10 = *((char *)result - 1);
              *((char *)result - 1) = v12;
              --v10;
              result = (char *)result - 1;
            }
            while ( result != (void *)v11 );
            v4 = v21 - v5;
          }
          result = (void *)(v20 / v6);
          v5 = v20 % v6;
          if ( !(v20 % v6) )
            return result;
        }
      }
      v15 = *(_BYTE *)v4;
      v16 = v4 + v20;
      result = (void *)(v4 + 1);
      v17 = v4 + v20 - (v4 + 1);
      if ( v4 + v20 != v4 + 1 )
      {
        v18 = *(_BYTE *)v4;
        result = memmove((void *)v4, (const void *)(v4 + 1), v17);
        v15 = v18;
      }
      *(_BYTE *)(v16 - 1) = v15;
    }
  }
  return result;
}

//----- (080A4320) --------------------------------------------------------
void __cdecl sub_80A4320(int a1, int a2)
{
  int v2; // eax@1
  unsigned int v3; // esi@2
  unsigned __int8 v4; // cf@2
  int v5; // eax@2
  void *v6; // ebp@6
  int v7; // edx@6
  size_t v8; // eax@6
  int v9; // edi@6
  const void *v10; // ecx@7
  int v11; // edi@10

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = -4;
    v4 = __CFADD__(v2, v2);
    v5 = 2 * v2;
    if ( !v4 && (unsigned int)v5 <= 0x3FFFFFFF )
      v3 = 4 * v5;
  }
  else
  {
    v3 = 4;
  }
  v6 = (void *)operator new(v3);
  v7 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  v8 = 4 * v7;
  v9 = (int)((char *)v6 + 4 * v7);
  if ( v9 )
  {
    *(_DWORD *)v9 = *(_DWORD *)a2;
    v10 = *(const void **)a1;
    v7 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
    v8 = 4 * v7;
    v9 = (int)((char *)v6 + 4 * v7);
  }
  else
  {
    v10 = *(const void **)a1;
  }
  if ( v7 )
  {
    memmove(v6, v10, v8);
    v10 = *(const void **)a1;
  }
  v11 = v9 + 4;
  if ( v10 )
    operator delete((void *)v10);
  *(_DWORD *)a1 = v6;
  *(_DWORD *)(a1 + 4) = v11;
  *(_DWORD *)(a1 + 8) = (char *)v6 + v3;
}

//----- (080A43E0) --------------------------------------------------------
int __userpurge sub_80A43E0@<eax>(int a1, int a2, int a3, unsigned int a4, int a5)
{
  int v5; // esi@1
  int v6; // ebx@1
  int v7; // ecx@2
  int v8; // edi@7
  int v9; // edx@7
  int v10; // ebx@7
  int v11; // eax@11
  int v12; // ecx@12
  int v13; // eax@12
  int result; // eax@14
  int v15; // [sp+1Ch] [bp-2Ch]@2
  int v16; // [sp+20h] [bp-28h]@2
  unsigned int v17; // [sp+24h] [bp-24h]@1
  char v18; // [sp+28h] [bp-20h]@1
  unsigned int v19; // [sp+2Ch] [bp-1Ch]@1

  v5 = a2;
  v6 = *(_DWORD *)(a2 + 20);
  std::__detail::_Prime_rehash_policy::_M_need_rehash(
    (std::__detail::_Prime_rehash_policy *)&v18,
    a2 + 16,
    *(_DWORD *)(a2 + 4),
    *(_DWORD *)(a2 + 12));
  v17 = v19;
  if ( !v18 )
  {
    v11 = *(_DWORD *)a2;
    goto LABEL_12;
  }
  v15 = sub_80A0CA0(v19);
  v7 = *(_DWORD *)(a2 + 8);
  *(_DWORD *)(a2 + 8) = 0;
  v16 = 0;
  if ( !v7 )
    goto LABEL_11;
  while ( 1 )
  {
    v8 = *(_DWORD *)v7;
    v9 = *(_DWORD *)(v7 + 4) % v17;
    v10 = v15 + 4 * v9;
    if ( *(_DWORD *)v10 )
    {
      *(_DWORD *)v7 = **(_DWORD **)v10;
      **(_DWORD **)v10 = v7;
      goto LABEL_5;
    }
    *(_DWORD *)v7 = *(_DWORD *)(a2 + 8);
    *(_DWORD *)(a2 + 8) = v7;
    *(_DWORD *)v10 = a2 + 8;
    if ( *(_DWORD *)v7 )
      break;
    v16 = v9;
LABEL_5:
    if ( !v8 )
      goto LABEL_10;
LABEL_6:
    v7 = v8;
  }
  *(_DWORD *)(v15 + 4 * v16) = v7;
  v16 = v9;
  if ( v8 )
    goto LABEL_6;
LABEL_10:
  v5 = a2;
LABEL_11:
  operator delete(*(void **)v5);
  *(_DWORD *)(v5 + 4) = v17;
  *(_DWORD *)v5 = v15;
  a3 = a4 % v17;
  v11 = v15;
LABEL_12:
  v12 = 4 * a3;
  v13 = *(_DWORD *)(v11 + 4 * a3);
  if ( v13 )
  {
    *(_DWORD *)a5 = *(_DWORD *)v13;
    **(_DWORD **)(*(_DWORD *)v5 + v12) = a5;
  }
  else
  {
    *(_DWORD *)a5 = *(_DWORD *)(v5 + 8);
    *(_DWORD *)(v5 + 8) = a5;
    if ( *(_DWORD *)a5 )
      *(_DWORD *)(*(_DWORD *)v5 + 4 * (*(_DWORD *)(*(_DWORD *)a5 + 4) % *(_DWORD *)(v5 + 4))) = a5;
    *(_DWORD *)(*(_DWORD *)v5 + v12) = v5 + 8;
  }
  ++*(_DWORD *)(v5 + 12);
  result = a1;
  *(_DWORD *)a1 = a5;
  return result;
}

//----- (080A4600) --------------------------------------------------------
int __cdecl sub_80A4600(int *a1)
{
  int result; // eax@1
  int v2; // ebx@2

  result = *a1;
  if ( !**(_BYTE **)*a1 )
  {
    v2 = *(_DWORD *)(result + 4);
    result = *(_DWORD *)(v2 + 4);
    if ( result )
    {
      result = event_base_loopbreak(*(_DWORD *)(v2 + 4));
      *(_BYTE *)v2 = 1;
    }
  }
  return result;
}
// 804CA60: using guessed type int __cdecl event_base_loopbreak(_DWORD);

//----- (080A4630) --------------------------------------------------------
int __cdecl sub_80A4630(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &ProxyWorker::workerLoop;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BDD30: using guessed type void *ProxyWorker::workerLoop;

//----- (080A46D0) --------------------------------------------------------
struct_thread_imp *__cdecl sub_80A46D0(struct_thread *t, int a2)
{
  char *v2; // esi@1
  bool v3; // zf@2
  int v4; // edi@3
  signed int v5; // ecx@3
  struct_thread_imp *result; // eax@7

  v2 = *(char **)(a2 + 4);
  if ( v2 == "St19_Sp_make_shared_tag" )
    goto LABEL_11;
  v3 = *v2 == 42;
  if ( *v2 == 42 )
    goto LABEL_12;
  v4 = (int)"St19_Sp_make_shared_tag";
  v5 = 24;
  do
  {
    if ( !v5 )
      break;
    v3 = *v2++ == *(_BYTE *)v4++;
    --v5;
  }
  while ( v3 );
  if ( v3 )
LABEL_11:
    result = &t->obj1;
  else
LABEL_12:
    result = 0;
  return result;
}

//----- (080A4710) --------------------------------------------------------
int __cdecl sub_80A4710(int a1)
{
  int result; // eax@1
  int v2; // ebx@1
  signed __int32 v3; // eax@3
  signed __int32 v4; // eax@7

  result = a1;
  *(_DWORD *)a1 = &off_80BDB88;
  v2 = *(_DWORD *)(a1 + 8);
  if ( v2 )
  {
    if ( &_pthread_key_create )
    {
      v3 = _InterlockedExchangeAdd((volatile signed __int32 *)(v2 + 4), 0xFFFFFFFF);
    }
    else
    {
      v3 = *(_DWORD *)(v2 + 4);
      *(_DWORD *)(v2 + 4) = v3 - 1;
    }
    result = v3 - 1;
    if ( !result )
    {
      (*(void (__cdecl **)(int))(*(_DWORD *)v2 + 8))(v2);
      if ( &_pthread_key_create )
      {
        v4 = _InterlockedExchangeAdd((volatile signed __int32 *)(v2 + 8), 0xFFFFFFFF);
      }
      else
      {
        v4 = *(_DWORD *)(v2 + 8);
        *(_DWORD *)(v2 + 8) = v4 - 1;
      }
      result = v4 - 1;
      if ( !result )
        result = (*(int (__cdecl **)(int))(*(_DWORD *)v2 + 12))(v2);
    }
  }
  return result;
}
// 80BDB88: using guessed type void *off_80BDB88;

//----- (080A47A0) --------------------------------------------------------
void __cdecl sub_80A47A0(int a1)
{
  int v1; // esi@1
  signed __int32 v2; // eax@3
  signed __int32 v3; // eax@7

  *(_DWORD *)a1 = &off_80BDB88;
  v1 = *(_DWORD *)(a1 + 8);
  if ( v1 )
  {
    if ( &_pthread_key_create )
    {
      v2 = _InterlockedExchangeAdd((volatile signed __int32 *)(v1 + 4), 0xFFFFFFFF);
    }
    else
    {
      v2 = *(_DWORD *)(v1 + 4);
      *(_DWORD *)(v1 + 4) = v2 - 1;
    }
    if ( v2 == 1 )
    {
      (*(void (__cdecl **)(int))(*(_DWORD *)v1 + 8))(v1);
      if ( &_pthread_key_create )
      {
        v3 = _InterlockedExchangeAdd((volatile signed __int32 *)(v1 + 8), 0xFFFFFFFF);
      }
      else
      {
        v3 = *(_DWORD *)(v1 + 8);
        *(_DWORD *)(v1 + 8) = v3 - 1;
      }
      if ( v3 == 1 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v1 + 12))(v1);
    }
  }
  operator delete((void *)a1);
}
// 80BDB88: using guessed type void *off_80BDB88;

//----- (080A4820) --------------------------------------------------------
signed __int32 __cdecl sub_80A4820(int a1)
{
  struct_thread *thread; // eax@1 MAPDST
  struct_thread_imp *ptr_thread; // eax@2 MAPDST
  volatile signed __int32 result; // eax@3
  volatile signed __int32 v6; // eax@5
  volatile signed __int32 v7; // eax@9

  *(_BYTE *)a1 = 1;
  *(_DWORD *)(a1 + 4) = 0;
  thread = (struct_thread *)operator new(0x20u);
  if ( thread )
  {
    thread->volatile4 = 1;
    thread->volatile8 = 1;
    thread->vftable = &ProxyWorker_vftable;
    thread->p_obj = &thread->obj1;
    thread->obj1.field_4 = 0;
    thread->obj1.field_8 = 0;
    thread->obj1.vftable = (int)&off_80BDD50;
    thread->obj1.field_C = a1;
    ptr_thread = sub_80A46D0(thread, (int)&off_80BD238);
  }
  else
  {
    ptr_thread = 0;
  }
  result = std::thread::_M_start_thread(a1 + 4, &ptr_thread);
  if ( thread )
  {
    if ( &_pthread_key_create )
    {
      v6 = _InterlockedExchangeAdd(&thread->volatile4, 0xFFFFFFFF);
    }
    else
    {
      v6 = thread->volatile4;
      thread->volatile4 = v6 - 1;
    }
    result = v6 - 1;
    if ( !result )
    {
      (*(void (__cdecl **)(struct_thread *))(thread->vftable + 8))(thread);
      if ( &_pthread_key_create )
      {
        v7 = _InterlockedExchangeAdd(&thread->volatile8, 0xFFFFFFFF);
      }
      else
      {
        v7 = thread->volatile8;
        thread->volatile8 = v7 - 1;
      }
      result = v7 - 1;
      if ( !result )
        result = (*(int (__cdecl **)(struct_thread *))(thread->vftable + 12))(thread);
    }
  }
  return result;
}
// 80BD238: using guessed type void *off_80BD238;
// 80BDD50: using guessed type void *off_80BDD50;
// 80BDD68: using guessed type void *ProxyWorker_vftable;

//----- (080A4940) --------------------------------------------------------
int __cdecl sub_80A4940(int a1)
{
  int result; // eax@2
  int v2; // esi@4
  unsigned int v3; // ebp@4
  int v4; // eax@4
  int v5; // edx@5
  int v6; // edx@7
  int v7; // edx@8
  int v8; // eax@10
  int v9; // edx@10
  signed __int32 v10; // eax@12
  int v11; // eax@16
  std::ostream *v12; // edi@16
  int v13; // eax@16
  int v14; // esi@16
  char v15; // al@18
  std::ostream *v16; // eax@19
  signed __int32 v17; // ecx@24
  signed __int32 v18; // ecx@28
  signed __int32 v19; // ecx@32
  int v20; // [sp+Ch] [bp-E0h]@0
  char v21; // [sp+12h] [bp-DAh]@26
  char v22; // [sp+13h] [bp-D9h]@6
  int v23; // [sp+14h] [bp-D8h]@4
  int v24; // [sp+18h] [bp-D4h]@6
  int v25; // [sp+1Ch] [bp-D0h]@4
  int v26; // [sp+20h] [bp-CCh]@4
  int v27; // [sp+24h] [bp-C8h]@4
  int v28; // [sp+28h] [bp-C4h]@4
  int v29; // [sp+2Ch] [bp-C0h]@4
  int v30; // [sp+30h] [bp-BCh]@4
  int v31; // [sp+34h] [bp-B8h]@4
  int v32; // [sp+38h] [bp-B4h]@4
  char v33; // [sp+3Ch] [bp-B0h]@4
  int v34; // [sp+40h] [bp-ACh]@4
  int v35; // [sp+44h] [bp-A8h]@4
  int v36; // [sp+48h] [bp-A4h]@4
  int v37; // [sp+B8h] [bp-34h]@4
  char v38; // [sp+BCh] [bp-30h]@4
  char v39; // [sp+BDh] [bp-2Fh]@4
  int v40; // [sp+C0h] [bp-2Ch]@4
  int v41; // [sp+C4h] [bp-28h]@4
  int v42; // [sp+C8h] [bp-24h]@4
  int v43; // [sp+CCh] [bp-20h]@4

  if ( log_level > 2 )
    goto LABEL_2;
  std::ios_base::ios_base((std::ios_base *)&v36);
  v36 = (int)&unk_80CF5C8;
  v37 = 0;
  v38 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  v42 = 0;
  v43 = 0;
  v2 = dword_80CF674;
  v25 = dword_80CF674;
  *(int *)((char *)&v25 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v25 + *(_DWORD *)(v25 - 12), 0);
  v25 = (int)&unk_80CF5DC;
  v36 = (int)&unk_80CF5F0;
  v26 = (int)&unk_80CF7F0;
  v27 = 0;
  v28 = 0;
  v29 = 0;
  v30 = 0;
  v31 = 0;
  v32 = 0;
  std::locale::locale((std::locale *)&v33);
  v26 = (int)&unk_80CF588;
  v34 = 16;
  v35 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v36, &v26);
  v3 = std::__ostream_insert<char,std::char_traits<char>>(&v25, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v3, "proxy worker stopping", 21);
  v23 = (int)&unk_80CF83C;
  v4 = *(_DWORD *)(v3 + 24);
  if ( v4 )
  {
    v5 = *(_DWORD *)(v3 + 16);
    LOBYTE(v20) = 0;
    if ( v4 > (unsigned int)v5 )
    {
      v24 = std::string::_S_construct<char *>(a1, v3, &v36, *(_DWORD *)(v3 + 20), v4, (int)&v22);
      std::string::swap((std::string *)&v23, (std::string *)&v24);
    }
    else
    {
      v24 = std::string::_S_construct<char *>(a1, v3, &v36, *(_DWORD *)(v3 + 20), v5, (int)&v22);
      std::string::swap((std::string *)&v23, (std::string *)&v24);
    }
    v6 = v24 - 12;
    if ( (_DWORD *)(v24 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v17 = _InterlockedExchangeAdd((volatile signed __int32 *)(v24 - 4), 0xFFFFFFFF);
      }
      else
      {
        v17 = *(_DWORD *)(v24 - 4);
        *(_DWORD *)(v24 - 4) = v17 - 1;
      }
      if ( v17 <= 0 )
        std::string::_Rep::_M_destroy(v6, &v21);
    }
  }
  else
  {
    std::string::assign((std::string *)&v23, (const std::string *)(v3 + 40));
  }
  v25 = (int)&unk_80CF5DC;
  v36 = (int)&unk_80CF5F0;
  v26 = (int)&unk_80CF588;
  v7 = v35 - 12;
  if ( (_DWORD *)(v35 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v18 = _InterlockedExchangeAdd((volatile signed __int32 *)(v35 - 4), 0xFFFFFFFF);
    }
    else
    {
      v18 = *(_DWORD *)(v35 - 4);
      *(_DWORD *)(v35 - 4) = v18 - 1;
    }
    if ( v18 <= 0 )
      std::string::_Rep::_M_destroy(v7, &v24);
  }
  v26 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v33);
  v25 = v2;
  *(int *)((char *)&v25 + *(_DWORD *)(v2 - 12)) = dword_80CF678;
  v36 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v36);
  if ( byte_80CE64C )
  {
    v11 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v23, *(_DWORD *)(v23 - 12));
    v12 = (std::ostream *)v11;
    v13 = *(_DWORD *)(*(_DWORD *)v11 - 12);
    v14 = *(_DWORD *)((char *)v12 + v13 + 124);
    if ( !v14 )
    {
      v8 = std::__throw_bad_cast();
      goto LABEL_32;
    }
    if ( *(_BYTE *)(v14 + 28) )
    {
      v15 = *(_BYTE *)(v14 + 39);
    }
    else
    {
      std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v12 + v13 + 124));
      v15 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v14 + 24))(v14, 10);
    }
    v16 = (std::ostream *)std::ostream::put(v12, v15);
    std::ostream::flush(v16);
  }
  syslog(6, "%s", v23, v20);
  v8 = v23;
  v9 = v23 - 12;
  if ( (_DWORD *)(v23 - 12) == &std::string::_Rep::_S_empty_rep_storage )
    goto LABEL_2;
  if ( &_pthread_key_create )
  {
    v10 = _InterlockedExchangeAdd((volatile signed __int32 *)(v23 - 4), 0xFFFFFFFF);
    goto LABEL_13;
  }
LABEL_32:
  v19 = *(_DWORD *)(v8 - 4);
  *(_DWORD *)(v8 - 4) = v19 - 1;
  v10 = v19;
LABEL_13:
  if ( v10 <= 0 )
    std::string::_Rep::_M_destroy(v9, &v25);
LABEL_2:
  *(_BYTE *)a1 = 0;
  std::thread::join((std::thread *)(a1 + 4));
  result = pthread_equal(*(_DWORD *)(a1 + 4), 0);
  if ( !result )
    std::terminate();
  return result;
}
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080A4E00) --------------------------------------------------------
int __cdecl event_dispath_thread(int a1)
{
  unsigned int v1; // ebp@0
  int v2; // edx@4
  int v3; // eax@6
  bool v4; // zf@6
  int v5; // ST24_4@9
  int v6; // edx@9
  int v7; // edx@10
  int v8; // edx@11
  int v9; // eax@15
  int v10; // edx@15
  int v11; // esi@23
  int v12; // eax@23
  int v13; // edx@24
  int v14; // esi@26
  int v15; // edx@27
  int v16; // eax@29
  std::ostream *v17; // edi@29
  int v18; // eax@29
  int v19; // esi@29
  char v20; // al@31
  std::ostream *v21; // eax@32
  int v22; // edx@33
  int result; // eax@44
  int v24; // ebx@48
  int v25; // eax@48
  int v26; // edx@49
  int v27; // ebx@51
  int v28; // ebx@52
  int v29; // eax@54
  std::ostream *v30; // esi@54
  int v31; // eax@54
  int v32; // ebx@54
  char v33; // al@56
  std::ostream *v34; // eax@57
  int v35; // eax@58
  int v36; // edx@58
  signed __int32 v37; // ecx@60
  signed __int32 v38; // ecx@86
  signed __int32 v39; // ecx@90
  signed __int32 v40; // ecx@96
  signed __int32 v41; // ecx@100
  signed __int32 v42; // ecx@106
  signed __int32 v43; // ecx@111
  signed __int32 v44; // esi@115
  int v45; // esi@120
  signed __int32 v46; // ecx@122
  std::runtime_error *v47; // esi@125
  int v48; // [sp+Ch] [bp-20Ch]@15
  int v49; // [sp+28h] [bp-1F0h]@9
  int v50; // [sp+2Ch] [bp-1ECh]@9
  char v51; // [sp+35h] [bp-1E3h]@5
  int v52; // [sp+38h] [bp-1E0h]@3
  int v53; // [sp+3Ch] [bp-1DCh]@9
  int v54; // [sp+40h] [bp-1D8h]@9
  struct timeval v55; // [sp+44h] [bp-1D4h]@15
  char v56; // [sp+4Ch] [bp-1CCh]@1
  struct event_base *evt_base; // [sp+50h] [bp-1C8h]@1
  int v58; // [sp+54h] [bp-1C4h]@1
  int v59; // [sp+58h] [bp-1C0h]@1
  int v60; // [sp+5Ch] [bp-1BCh]@15
  int v61; // [sp+60h] [bp-1B8h]@15
  void (__cdecl *v62)(int *, int *, signed int); // [sp+64h] [bp-1B4h]@15
  int (__cdecl *v63)(int *); // [sp+68h] [bp-1B0h]@15
  char v64; // [sp+6Ch] [bp-1ACh]@9
  char *v65; // [sp+80h] [bp-198h]@9
  int v66; // [sp+84h] [bp-194h]@15
  int v67; // [sp+88h] [bp-190h]@15
  int (__cdecl *v68)(void **, void **, signed int); // [sp+8Ch] [bp-18Ch]@15
  int (__cdecl *v69)(int *); // [sp+90h] [bp-188h]@15
  struct event *v70; // [sp+94h] [bp-184h]@15
  int v71; // [sp+98h] [bp-180h]@25
  int v72; // [sp+9Ch] [bp-17Ch]@48
  int v73; // [sp+A0h] [bp-178h]@48
  int v74; // [sp+A4h] [bp-174h]@48
  int v75; // [sp+A8h] [bp-170h]@48
  int v76; // [sp+ACh] [bp-16Ch]@48
  int v77; // [sp+B0h] [bp-168h]@48
  int v78; // [sp+B4h] [bp-164h]@48
  char v79; // [sp+B8h] [bp-160h]@48
  int v80; // [sp+BCh] [bp-15Ch]@48
  int v81; // [sp+C0h] [bp-158h]@48
  int v82; // [sp+C4h] [bp-154h]@48
  int v83; // [sp+134h] [bp-E4h]@48
  char v84; // [sp+138h] [bp-E0h]@48
  char v85; // [sp+139h] [bp-DFh]@48
  int v86; // [sp+13Ch] [bp-DCh]@48
  int v87; // [sp+140h] [bp-D8h]@48
  int v88; // [sp+144h] [bp-D4h]@48
  int v89; // [sp+148h] [bp-D0h]@48
  int v90; // [sp+14Ch] [bp-CCh]@5
  int v91; // [sp+150h] [bp-C8h]@23
  int v92; // [sp+154h] [bp-C4h]@23
  int v93; // [sp+158h] [bp-C0h]@23
  int v94; // [sp+15Ch] [bp-BCh]@23
  int v95; // [sp+160h] [bp-B8h]@23
  int v96; // [sp+164h] [bp-B4h]@23
  int v97; // [sp+168h] [bp-B0h]@23
  char v98; // [sp+16Ch] [bp-ACh]@23
  int v99; // [sp+170h] [bp-A8h]@23
  int v100; // [sp+174h] [bp-A4h]@23
  int v101; // [sp+178h] [bp-A0h]@23
  int v102; // [sp+1E8h] [bp-30h]@23
  char v103; // [sp+1ECh] [bp-2Ch]@23
  char v104; // [sp+1EDh] [bp-2Bh]@23
  int v105; // [sp+1F0h] [bp-28h]@23
  int v106; // [sp+1F4h] [bp-24h]@23
  int v107; // [sp+1F8h] [bp-20h]@23
  int v108; // [sp+1FCh] [bp-1Ch]@23

  v56 = 0;
  evt_base = (struct event_base *)event_base_new();
  v58 = 0;
  v59 = 0;
  if ( !evt_base )
  {
    v47 = (std::runtime_error *)_cxa_allocate_exception(8);
    std::string::string(&v90, "Event dispatcher initialization failed", &v71);
    std::runtime_error::runtime_error(v47, (const std::string *)&v90);
    *(_DWORD *)v47 = &off_80BAB18;
    std::string::_Rep::_M_dispose(v90 - 12, &v65);
    _cxa_throw(v47, &off_80BAADC, sub_807B6C0);
  }
  if ( sub_80721E0() )
  {
    sub_8067DC0((int)&v52, (std::string *)&dword_80CF894);
    if ( v52 && (v2 = *(_DWORD *)(v52 + 32)) != 0 )
      std::string::string(&v90, *(_DWORD *)(v52 + 28), v2, &v51);
    else
      std::string::string((std::string *)&v90, (const std::string *)&dword_80CF8FC);
    v3 = v52;
    v4 = v52 == 0;
    if ( v52 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v52 + 4));
      if ( v4 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
    }
    v50 = (int)&v64;
    std::string::string(&v53, "127.0.0.1", &v64);
    std::string::string(&v54, v90, &v65);
    v5 = (int)sub_80721E0();
    v49 = operator new(0x1Cu);
    sub_807E440((std::string *)v49, (std::string *)&v53, dword_80CE650, (std::string *)&v54, 22, v5);
    v6 = v54 - 12;
    if ( (_DWORD *)(v54 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v54 - 4), 0xFFFFFFFF);
      }
      else
      {
        v40 = *(_DWORD *)(v54 - 4);
        *(_DWORD *)(v54 - 4) = v40 - 1;
      }
      if ( v40 <= 0 )
        std::string::_Rep::_M_destroy(v6, &v71);
    }
    v7 = v53 - 12;
    if ( (_DWORD *)(v53 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v41 = _InterlockedExchangeAdd((volatile signed __int32 *)(v53 - 4), 0xFFFFFFFF);
      }
      else
      {
        v41 = *(_DWORD *)(v53 - 4);
        *(_DWORD *)(v53 - 4) = v41 - 1;
      }
      if ( v41 <= 0 )
        std::string::_Rep::_M_destroy(v7, &v71);
    }
    sub_807E6E0(v49, (int)&v56);
    v8 = v90 - 12;
    if ( (_DWORD *)(v90 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v42 = _InterlockedExchangeAdd((volatile signed __int32 *)(v90 - 4), 0xFFFFFFFF);
      }
      else
      {
        v42 = *(_DWORD *)(v90 - 4);
        *(_DWORD *)(v90 - 4) = v42 - 1;
      }
      if ( v42 <= 0 )
        std::string::_Rep::_M_destroy(v8, &v71);
    }
    sub_80817B0((int)&v64, (std::string *)&dword_80CF864, dword_80CE648);
  }
  else
  {
    v49 = 0;
    v50 = (int)&v64;
    sub_80817B0((int)&v64, (std::string *)&dword_80CF864, dword_80CE648);
  }
  if ( *(_DWORD *)(dword_80CF864 - 12) )
    sub_8084980(v50, (int)&v56);
  v62 = 0;
  v9 = operator new(8u);
  *(_DWORD *)v9 = a1;
  *(_DWORD *)(v9 + 4) = &v56;
  v65 = &v56;
  v10 = v61;
  v60 = v66;
  v61 = v67;
  v66 = v9;
  v67 = v10;
  v62 = 0;
  v68 = sub_80A4630;
  v63 = v69;
  v69 = sub_80A4600;
  v70 = (struct event *)event_new(evt_base, -1, 16, sub_80A5FC0, &v65);
  v55.tv_usec = 0;
  v55.tv_sec = 2;
  event_add(v70, &v55);
  if ( v62 )
    v62(&v60, &v60, 3);
  if ( log_level <= 2 )
  {
    std::ios_base::ios_base((std::ios_base *)&v82);
    v82 = (int)&unk_80CF5C8;
    v83 = 0;
    v84 = 0;
    v85 = 0;
    v86 = 0;
    v87 = 0;
    v88 = 0;
    v89 = 0;
    v71 = dword_80CF674;
    *(int *)((char *)&v71 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v71 + *(_DWORD *)(v71 - 12), 0);
    v71 = (int)&unk_80CF5DC;
    v82 = (int)&unk_80CF5F0;
    v72 = (int)&unk_80CF7F0;
    v73 = 0;
    v74 = 0;
    v75 = 0;
    v76 = 0;
    v77 = 0;
    v78 = 0;
    std::locale::locale((std::locale *)&v79);
    v72 = (int)&unk_80CF588;
    v80 = 16;
    v81 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v82, &v72);
    v24 = std::__ostream_insert<char,std::char_traits<char>>(
            &v71,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v24, "proxy worker running dispatcher", 31);
    v60 = (int)&unk_80CF83C;
    v25 = *(_DWORD *)(v24 + 24);
    if ( v25 )
    {
      v26 = *(_DWORD *)(v24 + 16);
      LOBYTE(v48) = 0;
      if ( v25 > (unsigned int)v26 )
      {
        v90 = std::string::_S_construct<char *>(v24, v1, (void *)a1, *(_DWORD *)(v24 + 20), v25, (int)&v55);
        std::string::swap((std::string *)&v60, (std::string *)&v90);
      }
      else
      {
        v90 = std::string::_S_construct<char *>(v24, v1, (void *)a1, *(_DWORD *)(v24 + 20), v26, (int)&v55);
        std::string::swap((std::string *)&v60, (std::string *)&v90);
      }
      v27 = v90 - 12;
      if ( (_DWORD *)(v90 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v90 - 4), 0xFFFFFFFF);
        }
        else
        {
          v39 = *(_DWORD *)(v90 - 4);
          *(_DWORD *)(v90 - 4) = v39 - 1;
        }
        if ( v39 <= 0 )
          std::string::_Rep::_M_destroy(v27, &v54);
      }
    }
    else
    {
      std::string::assign((std::string *)&v60, (const std::string *)(v24 + 40));
    }
    v71 = (int)&unk_80CF5DC;
    v82 = (int)&unk_80CF5F0;
    v72 = (int)&unk_80CF588;
    v28 = v81 - 12;
    if ( (_DWORD *)(v81 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v81 - 4), 0xFFFFFFFF);
      }
      else
      {
        v38 = *(_DWORD *)(v81 - 4);
        *(_DWORD *)(v81 - 4) = v38 - 1;
      }
      if ( v38 <= 0 )
        std::string::_Rep::_M_destroy(v28, &v90);
    }
    v72 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v79);
    v71 = dword_80CF674;
    *(int *)((char *)&v71 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v82 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v82);
    if ( byte_80CE64C )
    {
      v29 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v60, *(_DWORD *)(v60 - 12));
      v30 = (std::ostream *)v29;
      v31 = *(_DWORD *)(*(_DWORD *)v29 - 12);
      v32 = *(_DWORD *)((char *)v30 + v31 + 124);
      if ( !v32 )
      {
        v35 = std::__throw_bad_cast();
        goto LABEL_71;
      }
      if ( *(_BYTE *)(v32 + 28) )
      {
        v33 = *(_BYTE *)(v32 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v30 + v31 + 124));
        v33 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v32 + 24))(v32, 10);
      }
      v34 = (std::ostream *)std::ostream::put(v30, v33);
      std::ostream::flush(v34);
    }
    syslog(6, "%s", v60, v48);
    v35 = v60;
    v36 = v60 - 12;
    if ( (_DWORD *)(v60 - 12) == &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_18;
    if ( &_pthread_key_create )
    {
      v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v60 - 4), 0xFFFFFFFF);
      goto LABEL_61;
    }
LABEL_71:
    v37 = *(_DWORD *)(v35 - 4);
    *(_DWORD *)(v35 - 4) = v37 - 1;
LABEL_61:
    if ( v37 <= 0 )
      std::string::_Rep::_M_destroy(v36, &v90);
  }
LABEL_18:
  while ( *(_BYTE *)a1 )
  {
    while ( evt_base && !v56 )
    {
      event_base_dispatch(evt_base);
      if ( !*(_BYTE *)a1 )
        goto LABEL_22;
    }
  }
LABEL_22:
  if ( log_level <= 3 )
  {
    std::ios_base::ios_base((std::ios_base *)&v101);
    v101 = (int)&unk_80CF5C8;
    v102 = 0;
    v103 = 0;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v90 = dword_80CF674;
    *(int *)((char *)&v90 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v90 + *(_DWORD *)(v90 - 12), 0);
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF7F0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    std::locale::locale((std::locale *)&v98);
    v91 = (int)&unk_80CF588;
    v99 = 16;
    v100 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v101, &v91);
    v11 = std::__ostream_insert<char,std::char_traits<char>>(
            &v90,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v11, "proxy worker loop stopped", 25);
    v60 = (int)&unk_80CF83C;
    v12 = *(_DWORD *)(v11 + 24);
    if ( v12 )
    {
      v13 = *(_DWORD *)(v11 + 16);
      LOBYTE(v48) = 0;
      if ( v12 <= (unsigned int)v13 )
      {
        v71 = std::string::_S_construct<char *>((int)&v90, v1, (void *)a1, *(_DWORD *)(v11 + 20), v13, (int)&v55);
        std::string::swap((std::string *)&v60, (std::string *)&v71);
      }
      else
      {
        v71 = std::string::_S_construct<char *>((int)&v90, v1, (void *)a1, *(_DWORD *)(v11 + 20), v12, (int)&v55);
        std::string::swap((std::string *)&v60, (std::string *)&v71);
      }
      v14 = v71 - 12;
      if ( (_DWORD *)(v71 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v43 = _InterlockedExchangeAdd((volatile signed __int32 *)(v71 - 4), 0xFFFFFFFF);
        }
        else
        {
          v43 = *(_DWORD *)(v71 - 4);
          *(_DWORD *)(v71 - 4) = v43 - 1;
        }
        if ( v43 <= 0 )
          std::string::_Rep::_M_destroy(v14, &v54);
      }
    }
    else
    {
      std::string::assign((std::string *)&v60, (const std::string *)(v11 + 40));
    }
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF588;
    v15 = v100 - 12;
    if ( (_DWORD *)(v100 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v44 = _InterlockedExchangeAdd((volatile signed __int32 *)(v100 - 4), 0xFFFFFFFF);
      }
      else
      {
        v44 = *(_DWORD *)(v100 - 4);
        *(_DWORD *)(v100 - 4) = v44 - 1;
      }
      if ( v44 <= 0 )
        std::string::_Rep::_M_destroy(v15, &v71);
    }
    v91 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v98);
    v90 = dword_80CF674;
    *(int *)((char *)&v90 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v101 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v101);
    if ( byte_80CE64C )
    {
      v16 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v60, *(_DWORD *)(v60 - 12));
      v17 = (std::ostream *)v16;
      v18 = *(_DWORD *)(*(_DWORD *)v16 - 12);
      v19 = *(_DWORD *)((char *)v17 + v18 + 124);
      if ( !v19 )
      {
        v45 = std::__throw_bad_cast();
        v82 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v82);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v90);
        if ( v70 )
        {
          event_remove_timer(v70);
          event_free(v70);
          v70 = 0;
        }
        if ( v68 )
          ((void (__cdecl *)(int *, int *, signed int, int))v68)(&v66, &v66, 3, v48);
        sub_8081810(v50);
        if ( v49 )
        {
          sub_807E4C0(v49);
          operator delete((void *)v49);
        }
        if ( evt_base )
          event_base_free(evt_base);
        if ( v58 )
          SSL_CTX_free(v58);
        if ( v59 )
          SSL_CTX_free(v59);
        Unwind_Resume(v45);
      }
      if ( *(_BYTE *)(v19 + 28) )
      {
        v20 = *(_BYTE *)(v19 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v17 + v18 + 124));
        v20 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v19 + 24))(v19, 10);
      }
      v21 = (std::ostream *)std::ostream::put(v17, v20);
      std::ostream::flush(v21);
    }
    syslog(5, "%s", v60, v48);
    v22 = v60 - 12;
    if ( (_DWORD *)(v60 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v60 - 4), 0xFFFFFFFF);
      }
      else
      {
        v46 = *(_DWORD *)(v60 - 4);
        *(_DWORD *)(v60 - 4) = v46 - 1;
      }
      if ( v46 <= 0 )
        std::string::_Rep::_M_destroy(v22, &v90);
    }
  }
  if ( v70 )
  {
    event_remove_timer(v70);
    event_free(v70);
    v70 = 0;
  }
  if ( v68 )
    ((void (__cdecl *)(int *, int *, signed int, int))v68)(&v66, &v66, 3, v48);
  sub_8081810(v50);
  if ( v49 )
  {
    sub_807E4C0(v49);
    operator delete((void *)v49);
  }
  if ( evt_base )
    event_base_free(evt_base);
  if ( v58 )
    SSL_CTX_free(v58);
  result = v59;
  if ( v59 )
    result = SSL_CTX_free(v59);
  return result;
}
// 804C510: using guessed type int __cdecl event_base_free(_DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CB90: using guessed type int __cdecl event_remove_timer(_DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CEF0: using guessed type int __cdecl _cxa_allocate_exception(_DWORD);
// 804CF30: using guessed type int __cdecl event_free(_DWORD);
// 804D010: using guessed type int event_base_new(void);
// 804D0B0: using guessed type int __cdecl _cxa_throw(_DWORD, _DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D2B0: using guessed type int __cdecl event_new(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D400: using guessed type int __cdecl SSL_CTX_free(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80BAADC: using guessed type void *off_80BAADC;
// 80BAB18: using guessed type void *off_80BAB18;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF894: using guessed type int dword_80CF894;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (080A5FA0) --------------------------------------------------------
int __cdecl sub_80A5FA0(int a1)
{
  return event_dispath_thread(*(_DWORD *)(a1 + 12));
}

//----- (080A5FC0) --------------------------------------------------------
void __cdecl sub_80A5FC0(int a1, int a2, int a3)
{
  sub_8057D90((void *)(a3 + 4));
}

//----- (080A5FD0) --------------------------------------------------------
int __cdecl sub_80A5FD0(int a1, int a2)
{
  int result; // eax@1

  result = a1;
  *(_DWORD *)a1 = a2;
  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 8) = 0;
  *(_DWORD *)(a1 + 12) = 0;
  return result;
}

//----- (080A5FF0) --------------------------------------------------------
int __cdecl sub_80A5FF0(int a1, int a2, void *a3, int a4, int a5)
{
  int v5; // esi@1
  int v6; // eax@1
  const void *v8; // edx@6
  unsigned int v9; // eax@6
  char v10; // dl@7
  int v11; // eax@9
  bool v12; // zf@11
  int v13; // esi@22
  int v14; // edi@23
  int v15; // eax@24
  char v16; // al@24
  char v17; // ST0C_1@27
  char v18; // al@27
  char v19; // [sp+Ch] [bp-20h]@22

  v5 = *(_DWORD *)a1;
  v6 = *(_DWORD *)(*(_DWORD *)a1 + 4);
  if ( v6 < 0 )
  {
    if ( a2 && *(_DWORD *)(a2 + 64) )
      goto LABEL_4;
    v12 = *(_BYTE *)(a1 + 8) == 0;
    *(_DWORD *)(a1 + 12) = *(_DWORD *)v5;
    if ( !v12 )
    {
LABEL_12:
      *(_DWORD *)(a1 + 4) = 1;
      return a1 + 4;
    }
LABEL_19:
    *(_BYTE *)(a1 + 8) = 1;
    goto LABEL_12;
  }
  if ( v6 && v6 != *(_DWORD *)(a2 + 64) )
    goto LABEL_4;
  v8 = *(const void **)(v5 + 12);
  v9 = *((_DWORD *)v8 - 3);
  if ( !v9 )
  {
LABEL_7:
    v10 = 1;
    goto LABEL_8;
  }
  if ( a4 >= v9 )
  {
    if ( memcmp(a3, v8, *((_DWORD *)v8 - 3)) )
      goto LABEL_4;
    goto LABEL_7;
  }
  if ( (_BYTE)a5 )
    goto LABEL_4;
  v10 = 0;
LABEL_8:
  if ( *(_DWORD *)(*(_DWORD *)(v5 + 16) - 12) )
  {
    v17 = v10;
    v18 = sub_80A68E0(v5 + 20, (int)a3, a4);
    v10 = v17;
    if ( v18 )
    {
      v5 = *(_DWORD *)a1;
    }
    else
    {
      if ( (_BYTE)a5 )
        goto LABEL_4;
      v5 = *(_DWORD *)a1;
      v10 = 0;
    }
  }
  v11 = *(_DWORD *)(v5 + 24);
  if ( !*(_DWORD *)(v11 - 12)
    || (v19 = v10, v13 = evhttp_find_header(*(_DWORD *)(a2 + 16), v11), v10 = v19, v13)
    && ((v14 = *(_DWORD *)a1, !*(_DWORD *)(*(_DWORD *)(*(_DWORD *)a1 + 28) - 12))
     || (v15 = strlen((const char *)v13), v16 = sub_80A68E0(v14 + 32, v13, v15), v10 = v19, v16)) )
  {
    if ( v10 )
    {
      v12 = *(_BYTE *)(a1 + 8) == 0;
      *(_DWORD *)(a1 + 12) = **(_DWORD **)a1;
      if ( !v12 )
        goto LABEL_12;
      goto LABEL_19;
    }
  }
  if ( (_BYTE)a5 )
  {
LABEL_4:
    *(_DWORD *)(a1 + 4) = 2;
    return a1 + 4;
  }
  return a1 + 4;
}
// 804CAB0: using guessed type int __cdecl evhttp_find_header(_DWORD, _DWORD);

//----- (080A61B0) --------------------------------------------------------
int __cdecl sub_80A61B0(int a1, int a2, void *a3, int a4)
{
  return sub_80A5FF0(a1, a2, a3, a4, 0);
}

//----- (080A61F0) --------------------------------------------------------
int __cdecl sub_80A61F0(int a1, int a2, void *a3, int a4)
{
  return sub_80A5FF0(a1, a2, a3, a4, 1);
}

//----- (080A6230) --------------------------------------------------------
int __cdecl sub_80A6230(int a1)
{
  int result; // eax@1

  result = a1;
  *(_DWORD *)a1 = 0;
  *(_DWORD *)(a1 + 4) = 0;
  *(double *)(a1 + 8) = 0.0;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = 0;
  *(_DWORD *)(a1 + 24) = 0;
  *(_DWORD *)(a1 + 28) = 0;
  *(_DWORD *)(a1 + 32) = 0;
  *(_DWORD *)(a1 + 36) = 0;
  *(_DWORD *)(a1 + 40) = 0;
  *(_DWORD *)(a1 + 44) = 0;
  return result;
}

//----- (080A6280) --------------------------------------------------------
char __cdecl sub_80A6280(int a1)
{
  __int64 v1; // rcx@1
  int v2; // edx@3
  int v3; // edx@3
  FILE *v4; // ebx@3
  char v5; // di@4
  FILE *v6; // ebx@5
  __int64 v7; // rax@7
  __int64 v8; // rcx@7
  __int64 v9; // rax@9
  __int64 v10; // rcx@9
  char result; // al@11
  char v12; // [sp+Fh] [bp-39h]@6
  __int64 v13; // [sp+18h] [bp-30h]@1
  __int64 v14; // [sp+20h] [bp-28h]@3
  __int64 v15; // [sp+28h] [bp-20h]@3

  std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v13);
  v1 = v13;
  if ( *(_QWORD *)a1 )
    *(double *)(a1 + 8) = (long double)(v13 - *(_QWORD *)a1) / 1000000000.0;
  *(_QWORD *)a1 = v1;
  v2 = *(_DWORD *)(a1 + 20);
  LODWORD(v14) = *(_DWORD *)(a1 + 16);
  HIDWORD(v14) = v2;
  v3 = *(_DWORD *)(a1 + 36);
  LODWORD(v15) = *(_DWORD *)(a1 + 32);
  HIDWORD(v15) = v3;
  v4 = fopen("/sys/class/net/br-lan/statistics/rx_bytes", "r");
  if ( v4 )
  {
    fscanf(v4, "%llu", &v14);
    fclose(v4);
    v5 = 1;
  }
  else
  {
    v5 = 0;
  }
  v6 = fopen("/sys/class/net/br-lan/statistics/tx_bytes", "r");
  if ( v6 )
  {
    fscanf(v6, "%llu", &v15);
    fclose(v6);
    v12 = 1;
  }
  else
  {
    v12 = 0;
  }
  v7 = v14;
  v8 = v14 - *(_QWORD *)(a1 + 16);
  if ( SHIDWORD(v8) < 0 )
  {
    *(_DWORD *)(a1 + 24) = 0;
    *(_DWORD *)(a1 + 28) = 0;
  }
  else
  {
    *(_QWORD *)(a1 + 24) = v8;
  }
  *(_QWORD *)(a1 + 16) = v7;
  v9 = v15;
  v10 = v15 - *(_QWORD *)(a1 + 32);
  if ( SHIDWORD(v10) < 0 )
  {
    *(_DWORD *)(a1 + 40) = 0;
    *(_DWORD *)(a1 + 44) = 0;
  }
  else
  {
    *(_QWORD *)(a1 + 40) = v10;
  }
  *(_QWORD *)(a1 + 32) = v9;
  result = v5;
  if ( !v5 )
  {
    result = v12;
    if ( !v12 )
    {
      *(_DWORD *)(a1 + 8) = 0;
      *(_DWORD *)(a1 + 12) = 0;
    }
  }
  return result;
}

//----- (080A6440) --------------------------------------------------------
unsigned int __cdecl sub_80A6440(int a1)
{
  return 4 * ((a1 + 2) / 3u);
}

//----- (080A6460) --------------------------------------------------------
// local variable allocation has failed, the output may be wrong!
unsigned int __cdecl sub_80A6460(__int128 a1)
{
  unsigned int v1; // ebx@1
  int v2; // edx@3
  int v3; // esi@3
  int v4; // ecx@3
  int v5; // eax@4
  int v6; // edi@5
  int v7; // ebp@6
  int v8; // edi@6
  unsigned int v9; // eax@7
  int v10; // edx@12
  int v11; // eax@13
  int v12; // edx@13
  unsigned int v14; // [sp+1h] [bp-15h]@1

  v1 = *(_DWORD *)((char *)&a1 + 3);
  v14 = 4 * ((*(_DWORD *)((char *)&a1 + 3) + 2) / 3u);
  if ( *(_DWORD *)((char *)&a1 + 11) < v14 )
    return 0;
  if ( !*(_DWORD *)((char *)&a1 + 3) )
    goto LABEL_12;
  v2 = *(_DWORD *)((char *)&a1 + 7);
  v3 = 0;
  v4 = 0;
  do
  {
    if ( *(_DWORD *)((char *)&a1 + 3) > (unsigned int)v3 )
    {
      ++v4;
      v5 = *(_BYTE *)(*(_DWORD *)((char *)&a1 - 1) + v3) << 16;
      if ( *(_DWORD *)((char *)&a1 + 3) <= (unsigned int)v4 )
        goto LABEL_10;
    }
    else
    {
      v5 = 0;
      if ( *(_DWORD *)((char *)&a1 + 3) <= (unsigned int)v4 )
      {
LABEL_10:
        v3 = v4;
        v8 = 0;
        v7 = 0;
        goto LABEL_7;
      }
    }
    v3 = v4 + 1;
    v6 = *(_BYTE *)(*(_DWORD *)((char *)&a1 - 1) + v4);
    if ( *(_DWORD *)((char *)&a1 + 3) <= (unsigned int)(v4 + 1) )
    {
      v8 = v6 << 8;
      ++v4;
      v7 = 0;
    }
    else
    {
      v4 += 2;
      v7 = *(_BYTE *)(*(_DWORD *)((char *)&a1 - 1) + v3);
      v3 = v4;
      v8 = v6 << 8;
    }
LABEL_7:
    v9 = v7 + v8 + v5;
    *(_BYTE *)v2 = byte_80BDE00[v9 >> 18];
    *(_BYTE *)(v2 + 1) = byte_80BDE00[(v9 >> 12) & 0x3F];
    *(_BYTE *)(v2 + 2) = byte_80BDE00[(v9 >> 6) & 0x3F];
    *(_BYTE *)(v2 + 3) = byte_80BDE00[v9 & 0x3F];
    v2 += 4;
  }
  while ( *(_DWORD *)((char *)&a1 + 3) > (unsigned int)v3 );
  v1 = *(_DWORD *)((char *)&a1 + 3);
LABEL_12:
  v10 = dword_80BDDE0[v1 % 3];
  if ( v10 > 0 )
  {
    v11 = *(_DWORD *)((char *)&a1 + 7) + v14;
    v12 = *(_DWORD *)((char *)&a1 + 7) + v14 - v10;
    do
      *(_BYTE *)(v11-- - 1) = 61;
    while ( v11 != v12 );
  }
  return 4 * ((*(_DWORD *)((char *)&a1 + 3) + 2) / 3u);
}
// 80A6460: variables would overlap: ST1C_4.4 and ST1B_4.4
// 80A6460: variables would overlap: ST1C_8.8 and ST1B_4.4
// 80A6460: array has been used for an input argument
// 80A6460: variables would overlap: ST1C_12.12 and ST1B_4.4
// 80A6460: variables would overlap: ST1C_16.16 and ST1B_4.4
// 80A6460: failed to expand linear variable _1A
// 80BDDE0: using guessed type int dword_80BDDE0[];

//----- (080A65E0) --------------------------------------------------------
void *__cdecl sub_80A65E0(int a1, unsigned int a2, int a3)
{
  size_t v3; // eax@3
  signed int v4; // eax@6
  unsigned int v5; // edx@6
  int v6; // esi@7
  unsigned __int8 v7; // cl@7
  int v8; // edi@8
  unsigned __int8 v9; // cl@8
  unsigned __int8 v10; // cl@9
  int v11; // ebp@10
  unsigned int v12; // edi@12
  int v13; // edi@13
  void *v15; // eax@26
  int v16; // edx@26
  int v17; // [sp+4h] [bp-28h]@6
  int v18; // [sp+8h] [bp-24h]@9
  __int16 v19; // [sp+8h] [bp-24h]@12
  void *v20; // [sp+Ch] [bp-20h]@5

  if ( !dword_80CF920 )
  {
    v15 = malloc(0x100u);
    dword_80CF920 = (int)v15;
    v16 = 0;
    do
    {
      *((_BYTE *)v15 + (unsigned __int8)byte_80BDE00[v16]) = v16;
      ++v16;
    }
    while ( v16 != 64 );
  }
  if ( a2 & 3 )
    return 0;
  v3 = 3 * (a2 >> 2);
  *(_DWORD *)a3 = v3;
  if ( *(_BYTE *)(a1 + a2 - 1) == 61 )
  {
    --v3;
    *(_DWORD *)a3 = v3;
    if ( *(_BYTE *)(a1 + a2 - 2) != 61 )
      goto LABEL_5;
  }
  else if ( *(_BYTE *)(a1 + a2 - 2) != 61 )
  {
    goto LABEL_5;
  }
  --v3;
  *(_DWORD *)a3 = v3;
LABEL_5:
  v20 = malloc(v3);
  if ( v20 )
  {
    v17 = dword_80CF920;
    v4 = 3;
    v5 = 0;
    while ( 1 )
    {
      if ( a2 <= v4 - 3 )
        return v20;
      if ( *(_BYTE *)(a1 + v4 - 3) == 61 )
      {
        v6 = 0;
        v7 = *(_BYTE *)(a1 + v4 - 2);
        if ( v7 != 61 )
        {
LABEL_8:
          v8 = *(_BYTE *)(v17 + v7) << 12;
          v9 = *(_BYTE *)(a1 + v4 - 1);
          if ( v9 != 61 )
            goto LABEL_9;
          goto LABEL_20;
        }
      }
      else
      {
        v6 = *(_BYTE *)(v17 + *(_BYTE *)(a1 + v4 - 3)) << 18;
        v7 = *(_BYTE *)(a1 + v4 - 2);
        if ( v7 != 61 )
          goto LABEL_8;
      }
      v8 = 0;
      v9 = *(_BYTE *)(a1 + v4 - 1);
      if ( v9 != 61 )
      {
LABEL_9:
        v18 = *(_BYTE *)(v17 + v9) << 6;
        v10 = *(_BYTE *)(a1 + v4);
        if ( v10 != 61 )
          goto LABEL_10;
        goto LABEL_21;
      }
LABEL_20:
      v18 = 0;
      v10 = *(_BYTE *)(a1 + v4);
      if ( v10 != 61 )
      {
LABEL_10:
        v11 = *(_BYTE *)(v17 + v10);
        goto LABEL_11;
      }
LABEL_21:
      v11 = 0;
LABEL_11:
      if ( v5 < *(_DWORD *)a3 )
      {
        v12 = v8 + v6 + v18 + v11;
        v19 = v12;
        *((_BYTE *)v20 + v5) = v12 >> 16;
        if ( v5 + 1 >= *(_DWORD *)a3 )
        {
          ++v5;
        }
        else
        {
          v13 = v5 + 2;
          *((_BYTE *)v20 + v5 + 1) = HIBYTE(v19);
          if ( v5 + 2 >= *(_DWORD *)a3 )
          {
            v5 += 2;
          }
          else
          {
            v5 += 3;
            *((_BYTE *)v20 + v13) = v19;
          }
        }
      }
      v4 += 4;
    }
  }
  return 0;
}
// 80CF920: using guessed type int dword_80CF920;

//----- (080A6810) --------------------------------------------------------
int __cdecl sub_80A6810(int a1)
{
  int result; // eax@1

  result = a1;
  *(_DWORD *)a1 = 0;
  return result;
}

//----- (080A6820) --------------------------------------------------------
int __cdecl sub_80A6820(int *a1)
{
  int result; // eax@1

  result = *a1;
  if ( *a1 )
  {
    result = pcre_free(*a1);
    *a1 = 0;
  }
  return result;
}
// 80CF604: using guessed type int (__cdecl *pcre_free)(_DWORD);

//----- (080A6850) --------------------------------------------------------
int __cdecl sub_80A6850(int a1, int a2)
{
  int result; // eax@1

  result = a2;
  *(_DWORD *)a1 = *(_DWORD *)a2;
  *(_DWORD *)a2 = 0;
  return result;
}

//----- (080A6870) --------------------------------------------------------
int __cdecl sub_80A6870(int a1, int a2)
{
  if ( *(_DWORD *)a1 )
  {
    pcre_free(*(_DWORD *)a1);
    *(_DWORD *)a1 = 0;
  }
  *(_DWORD *)a1 = *(_DWORD *)a2;
  *(_DWORD *)a2 = 0;
  return a1;
}
// 80CF604: using guessed type int (__cdecl *pcre_free)(_DWORD);

//----- (080A68E0) --------------------------------------------------------
unsigned int __cdecl sub_80A68E0(int a1, int a2, int a3)
{
  unsigned int result; // eax@2
  char v4; // [sp+24h] [bp-18h]@2

  if ( *(_DWORD *)a1 )
    result = (unsigned int)~pcre_exec(*(_DWORD *)a1, 0, a2, a3, 0, 0, &v4, 3) >> 31;
  else
    result = 0;
  return result;
}
// 804CA10: using guessed type int __cdecl pcre_exec(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (080A6950) --------------------------------------------------------
int __cdecl sub_80A6950(int a1, int *a2)
{
  int result; // eax@1
  int v3; // ST1C_4@6
  int v4; // esi@6
  void *v5; // edi@6
  int v6; // ebx@6
  int v7; // eax@6
  int v8; // edx@6
  int v9; // ecx@7
  int v10; // edx@9
  int v11; // edx@10
  int v12; // eax@12
  std::ostream *v13; // esi@12
  int v14; // eax@12
  int v15; // ebx@12
  char v16; // al@14
  std::ostream *v17; // eax@15
  int v18; // edx@16
  int v19; // ecx@24
  signed __int32 v20; // ecx@26
  signed __int32 v21; // ecx@30
  int v22; // ebx@35
  int v23; // [sp+Ch] [bp-100h]@4
  char v24; // [sp+2Ah] [bp-E2h]@32
  char v25; // [sp+2Bh] [bp-E1h]@8
  int v26; // [sp+2Ch] [bp-E0h]@1
  int v27; // [sp+30h] [bp-DCh]@1
  int v28; // [sp+34h] [bp-D8h]@6
  int v29; // [sp+38h] [bp-D4h]@8
  int v30; // [sp+3Ch] [bp-D0h]@6
  int v31; // [sp+40h] [bp-CCh]@6
  int v32; // [sp+44h] [bp-C8h]@6
  int v33; // [sp+48h] [bp-C4h]@6
  int v34; // [sp+4Ch] [bp-C0h]@6
  int v35; // [sp+50h] [bp-BCh]@6
  int v36; // [sp+54h] [bp-B8h]@6
  int v37; // [sp+58h] [bp-B4h]@6
  char v38; // [sp+5Ch] [bp-B0h]@6
  int v39; // [sp+60h] [bp-ACh]@6
  int v40; // [sp+64h] [bp-A8h]@6
  int v41; // [sp+68h] [bp-A4h]@6
  int v42; // [sp+D8h] [bp-34h]@6
  char v43; // [sp+DCh] [bp-30h]@6
  char v44; // [sp+DDh] [bp-2Fh]@6
  int v45; // [sp+E0h] [bp-2Ch]@6
  int v46; // [sp+E4h] [bp-28h]@6
  int v47; // [sp+E8h] [bp-24h]@6
  int v48; // [sp+ECh] [bp-20h]@6

  v26 = 134986579;
  v27 = 0;
  result = *a2;
  if ( *(_DWORD *)(*a2 - 12) )
  {
    result = pcre_compile(result, 0, &v26, &v27);
    *(_DWORD *)a1 = result;
    if ( !result && log_level <= 5 )
    {
      v3 = v27;
      std::ios_base::ios_base((std::ios_base *)&v41);
      v41 = (int)&unk_80CF5C8;
      v42 = 0;
      v43 = 0;
      v44 = 0;
      v45 = 0;
      v46 = 0;
      v47 = 0;
      v48 = 0;
      v4 = dword_80CF674;
      v30 = dword_80CF674;
      *(int *)((char *)&v30 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v30 + *(_DWORD *)(v30 - 12), 0);
      v30 = (int)&unk_80CF5DC;
      v41 = (int)&unk_80CF5F0;
      v31 = (int)&unk_80CF7F0;
      v32 = 0;
      v33 = 0;
      v34 = 0;
      v35 = 0;
      v36 = 0;
      v37 = 0;
      std::locale::locale((std::locale *)&v38);
      v31 = (int)&unk_80CF588;
      v39 = 16;
      v40 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v41, &v31);
      v5 = (void *)std::__ostream_insert<char,std::char_traits<char>>(
                     &v30,
                     &unk_80CF83C,
                     std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v5, "pcre_compile failed '", 21);
      v6 = std::__ostream_insert<char,std::char_traits<char>>(v5, *a2, *(_DWORD *)(*a2 - 12));
      std::__ostream_insert<char,std::char_traits<char>>(v6, "': ", 3);
      v7 = std::ostream::operator<<(v6, v3);
      v28 = (int)&unk_80CF83C;
      v8 = *(_DWORD *)(v7 + 24);
      if ( v8 )
      {
        v9 = *(_DWORD *)(v7 + 16);
        LOBYTE(v23) = 0;
        if ( v8 <= (unsigned int)v9 )
        {
          v29 = std::string::_S_construct<char *>(
                  (int)&v25,
                  (unsigned int)&v41,
                  v5,
                  *(_DWORD *)(v7 + 20),
                  v9,
                  (int)&v25);
          std::string::swap((std::string *)&v28, (std::string *)&v29);
        }
        else
        {
          v29 = std::string::_S_construct<char *>(
                  (int)&v25,
                  (unsigned int)&v41,
                  v5,
                  *(_DWORD *)(v7 + 20),
                  v8,
                  (int)&v25);
          std::string::swap((std::string *)&v28, (std::string *)&v29);
        }
        v10 = v29 - 12;
        if ( (_DWORD *)(v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v21 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
          }
          else
          {
            v21 = *(_DWORD *)(v29 - 4);
            *(_DWORD *)(v29 - 4) = v21 - 1;
          }
          if ( v21 <= 0 )
            std::string::_Rep::_M_destroy(v10, &v24);
        }
      }
      else
      {
        std::string::assign((std::string *)&v28, (const std::string *)(v7 + 40));
      }
      v30 = (int)&unk_80CF5DC;
      v41 = (int)&unk_80CF5F0;
      v31 = (int)&unk_80CF588;
      v11 = v40 - 12;
      if ( (_DWORD *)(v40 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v20 = _InterlockedExchangeAdd((volatile signed __int32 *)(v40 - 4), 0xFFFFFFFF);
        }
        else
        {
          v20 = *(_DWORD *)(v40 - 4);
          *(_DWORD *)(v40 - 4) = v20 - 1;
        }
        if ( v20 <= 0 )
          std::string::_Rep::_M_destroy(v11, &v29);
      }
      v31 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v38);
      v30 = v4;
      *(int *)((char *)&v30 + *(_DWORD *)(v4 - 12)) = dword_80CF678;
      v41 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v41);
      if ( byte_80CE64C )
      {
        v12 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v28, *(_DWORD *)(v28 - 12));
        v13 = (std::ostream *)v12;
        v14 = *(_DWORD *)(*(_DWORD *)v12 - 12);
        v15 = *(_DWORD *)((char *)v13 + v14 + 124);
        if ( !v15 )
        {
          v22 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v28 - 12, &v30);
          Unwind_Resume(v22);
        }
        if ( *(_BYTE *)(v15 + 28) )
        {
          v16 = *(_BYTE *)(v15 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v13 + v14 + 124));
          v16 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v15 + 24))(v15, 10);
        }
        v17 = (std::ostream *)std::ostream::put(v13, v16);
        std::ostream::flush(v17);
      }
      syslog(3, "%s", v28, v23, 0);
      result = v28;
      v18 = v28 - 12;
      if ( (_DWORD *)(v28 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          result = _InterlockedExchangeAdd((volatile signed __int32 *)(v28 - 4), 0xFFFFFFFF);
        }
        else
        {
          v19 = *(_DWORD *)(v28 - 4);
          *(_DWORD *)(v28 - 4) = v19 - 1;
          result = v19;
        }
        if ( result <= 0 )
          result = std::string::_Rep::_M_destroy(v18, &v30);
      }
    }
  }
  else
  {
    *(_DWORD *)a1 = 0;
  }
  return result;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD40: using guessed type int __cdecl pcre_compile(_DWORD, _DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080A6EB0) --------------------------------------------------------
signed int __cdecl sub_80A6EB0(unsigned int a1, signed int *a2, int a3, unsigned int *a4, int a5)
{
  int v5; // ebp@2
  int v6; // eax@2
  unsigned int v7; // edx@3
  int v8; // esi@5
  int v9; // ebp@5
  int v10; // edx@6
  char v11; // cl@7
  int v12; // edi@12
  int v13; // esi@14
  int v14; // ecx@14
  signed int *v15; // eax@15
  signed int v16; // ebx@15
  unsigned int v17; // ebx@20
  unsigned int v18; // eax@23
  unsigned int v19; // eax@27
  unsigned int v20; // ebx@27
  int v21; // ecx@29
  unsigned int v22; // ett@31
  int v23; // ebx@34
  int v24; // ebx@34
  bool v25; // dl@35
  unsigned int v26; // ecx@37
  unsigned int v27; // ecx@38
  int i; // ebx@38
  signed int result; // eax@44
  unsigned int v30; // [sp+0h] [bp-34h]@1
  unsigned int v31; // [sp+4h] [bp-30h]@14
  int v32; // [sp+8h] [bp-2Ch]@21
  signed int v33; // [sp+Ch] [bp-28h]@20
  unsigned int v34; // [sp+18h] [bp-1Ch]@21
  int v35; // [sp+1Ch] [bp-18h]@14

  v30 = *a4;
  if ( !a1 )
  {
    v12 = 0;
    goto LABEL_52;
  }
  v5 = 0;
  v6 = 0;
  do
  {
    v7 = a2[v6];
    if ( v7 <= 0x7F )
    {
      if ( v30 - v5 <= 1 )
        return 2;
      v8 = v5 + 1;
      v9 = a5 + v5;
      if ( a3 )
      {
        v10 = v7 - (v7 - 97 < 0x1A ? 0x20 : 0);
        if ( *(_BYTE *)(a3 + v6) )
          v11 = 0;
        else
          v11 = 32 * ((unsigned int)(v10 - 65) <= 0x19);
        LOBYTE(v7) = v11 + v7;
      }
      *(_BYTE *)v9 = v7;
      v5 = v8;
    }
    ++v6;
  }
  while ( v6 != a1 );
  if ( v5 )
  {
    v12 = v5 + 1;
    *(_BYTE *)(a5 + v5) = 45;
  }
  else
  {
    v12 = 0;
  }
  if ( v5 >= a1 )
  {
LABEL_52:
    *a4 = v12;
    result = 0;
  }
  else
  {
    v35 = v5;
    v31 = 72;
    v13 = 0;
    v14 = 128;
LABEL_15:
    v15 = a2;
    v16 = -1;
    do
    {
      if ( *v15 >= (unsigned int)v14 && v16 > (unsigned int)*v15 )
        v16 = *v15;
      ++v15;
    }
    while ( v15 != &a2[a1] );
    v33 = v16;
    v17 = v16 - v14;
    if ( v17 <= ~v13 / (unsigned int)(v35 + 1) )
    {
      v34 = v17 * (v35 + 1) + v13;
      v32 = 0;
      while ( 1 )
      {
        while ( 1 )
        {
          v18 = a2[v32];
          if ( v18 < v33 )
          {
            ++v34;
            if ( !v34 )
              goto LABEL_50;
          }
          if ( v33 == v18 )
            break;
          ++v32;
          if ( v32 == a1 )
            goto LABEL_41;
        }
        if ( v30 <= v12 )
          return 2;
        v19 = v34;
        v20 = 36;
        while ( v31 >= v20 )
        {
          v21 = 1;
          if ( v19 < 1 )
            goto LABEL_34;
LABEL_31:
          ++v12;
          v22 = v19 - v21;
          v19 = (v19 - v21) / (36 - v21);
          *(_BYTE *)(a5 + v12 - 1) = (v22 % (36 - v21) + v21 < 0x1A ? 0x4B : 0) + v22 % (36 - v21) + v21 + 22;
          v20 += 36;
          if ( v30 <= v12 )
            return 2;
        }
        if ( v31 + 26 <= v20 )
          v21 = 26;
        else
          v21 = v20 - v31;
        if ( v21 <= v19 )
          goto LABEL_31;
LABEL_34:
        v23 = v12++;
        v24 = a5 + v23;
        if ( a3 )
          v25 = *(_BYTE *)(a3 + v32) != 0;
        else
          v25 = 0;
        *(_BYTE *)v24 = (v19 < 0x1A ? 0x4B : 0) + v19 + 22 - (v25 ? 0x20 : 0);
        if ( v35 == v5 )
          v26 = v34 / 0x2BC;
        else
          v26 = v34 >> 1;
        v27 = v26 / (v35 + 1) + v26;
        for ( i = 0; v27 > 0x1C7; i += 36 )
          v27 /= 0x23u;
        v31 = i + 36 * v27 / (v27 + 38);
        ++v35;
        v34 = 0;
        ++v32;
        if ( v32 == a1 )
        {
LABEL_41:
          v13 = v34 + 1;
          v14 = v33 + 1;
          if ( a1 <= v35 )
            goto LABEL_52;
          goto LABEL_15;
        }
      }
    }
LABEL_50:
    result = 3;
  }
  return result;
}

//----- (080A71E0) --------------------------------------------------------
signed int __cdecl sub_80A71E0(int a1, unsigned int a2, int a3, int a4)
{
  unsigned int v4; // ebx@1
  signed int v5; // ebp@1
  unsigned int v6; // eax@1
  int v7; // ecx@1
  unsigned int v8; // edx@6
  int v9; // ebp@8
  int v10; // edx@10
  signed int result; // eax@17
  int v12; // ebp@20
  int v13; // [sp+24h] [bp-14h]@20

  v4 = 0;
  v5 = 1;
  v6 = 0;
  v7 = 0;
  while ( 1 )
  {
    while ( a2 != v4 )
    {
      v8 = *(_DWORD *)(a1 + 4 * v4);
      if ( v8 == 46 )
        break;
      ++v4;
      if ( v8 > 0x7F )
        v5 = 0;
      if ( v4 > a2 )
        goto LABEL_17;
    }
    if ( v5 )
    {
      v9 = v4 - v6;
      if ( *(_DWORD *)a4 - v7 < v4 - v6 )
        return 2;
      if ( v4 > v6 )
      {
        v10 = a3 + v7 - v6;
        do
        {
          *(_BYTE *)(v10 + v6) = *(_BYTE *)(a1 + 4 * v6);
          ++v6;
        }
        while ( v6 != v4 );
        v7 += v9;
      }
      goto LABEL_13;
    }
    if ( (unsigned int)(*(_DWORD *)a4 - v7) <= 3 )
      return 2;
    *(_DWORD *)(a3 + v7) = 757952120;
    v12 = v7 + 4;
    v13 = *(_DWORD *)a4 - (v7 + 4);
    result = sub_80A6EB0(v4 - v6, (signed int *)(a1 + 4 * v6), 0, (unsigned int *)&v13, v7 + 4 + a3);
    if ( result )
      return result;
    v7 = v12 + v13;
LABEL_13:
    if ( a2 != v4 )
    {
      if ( *(_DWORD *)a4 == v7 )
        return 2;
      *(_BYTE *)(a3 + v7++) = 46;
    }
    ++v4;
    v6 = v4;
    v5 = 1;
    if ( v4 > a2 )
    {
LABEL_17:
      *(_DWORD *)a4 = v7;
      return 0;
    }
  }
}

//----- (080A7310) --------------------------------------------------------
int __cdecl sub_80A7310(char *a1, int a2)
{
  int v2; // eax@3
  int v3; // esi@3
  int v4; // edi@4
  int v5; // ebx@5
  int v6; // eax@7
  int v7; // ST1C_4@8
  const char *v8; // ebp@8
  int v9; // ST1C_4@8
  int v10; // eax@9
  signed int v11; // ebx@10
  int v12; // eax@11
  int v13; // esi@11
  int result; // eax@12
  int v15; // eax@16
  int v16; // eax@16
  int v17; // eax@17
  int v18; // ebx@17
  const char *v19; // esi@18
  int v20; // ebx@18
  size_t v21; // edx@18
  int v22; // eax@19

  if ( !a1 || !a2 )
    return 4;
  v2 = X509_get_ext_d2i(a2, 85, 0, 0);
  v3 = v2;
  if ( !v2 )
  {
    v12 = X509_get_subject_name(a2);
    v13 = X509_NAME_get_index_by_NID(v12, 13, -1);
    if ( v13 >= 0 )
    {
      v15 = X509_get_subject_name(a2);
      v16 = X509_NAME_get_entry(v15, v13);
      if ( v16 )
      {
        v17 = X509_NAME_ENTRY_get_data(v16);
        v18 = v17;
        if ( v17 )
        {
          v19 = (const char *)ASN1_STRING_data(v17);
          v20 = ASN1_STRING_length(v18);
          v21 = strlen(v19);
          result = 3;
          if ( v20 == v21 )
          {
            LOBYTE(v22) = sub_80A77B0((char *)v19, a1);
            result = v22 != 1;
          }
          return result;
        }
      }
    }
    return 4;
  }
  v4 = sk_num(v2);
  if ( v4 <= 0 )
  {
LABEL_14:
    v11 = 1;
    goto LABEL_15;
  }
  v5 = 0;
  while ( 1 )
  {
    v6 = sk_value(v3, v5);
    if ( *(_DWORD *)v6 != 2 )
      goto LABEL_6;
    v7 = v6;
    v8 = (const char *)ASN1_STRING_data(*(_DWORD *)(v6 + 4));
    v9 = ASN1_STRING_length(*(_DWORD *)(v7 + 4));
    if ( v9 != strlen(v8) )
      break;
    LOBYTE(v10) = sub_80A77B0((char *)v8, a1);
    if ( v10 == 1 )
    {
      v11 = 0;
      goto LABEL_15;
    }
LABEL_6:
    ++v5;
    if ( v5 == v4 )
      goto LABEL_14;
  }
  v11 = 3;
LABEL_15:
  sk_pop_free(v3, (const char *)&GENERAL_NAME_free);
  return v11;
}
// 804C4A0: using guessed type int sk_pop_free(_DWORD, const char *, ...);
// 804C5C0: using guessed type int __cdecl ASN1_STRING_length(_DWORD);
// 804C6A0: using guessed type int __cdecl X509_NAME_get_index_by_NID(_DWORD, _DWORD, _DWORD);
// 804C720: using guessed type int __cdecl sk_value(_DWORD, _DWORD);
// 804C910: using guessed type int __cdecl X509_get_subject_name(_DWORD);
// 804C980: using guessed type int __cdecl X509_NAME_get_entry(_DWORD, _DWORD);
// 804CA80: using guessed type int __cdecl X509_get_ext_d2i(_DWORD, _DWORD, _DWORD, _DWORD);
// 804CD30: using guessed type int __cdecl sk_num(_DWORD);
// 804CD60: using guessed type int __cdecl ASN1_STRING_data(_DWORD);
// 804D3E0: using guessed type int __cdecl X509_NAME_ENTRY_get_data(_DWORD);

//----- (080A74C0) --------------------------------------------------------
char __usercall sub_80A74C0@<al>(char result@<al>)
{
  switch ( result )
  {
    case 98:
      result = 66;
      break;
    case 97:
      result = 65;
      break;
    case 122:
      result = 90;
      break;
    case 121:
      result = 89;
      break;
    case 120:
      result = 88;
      break;
    case 119:
      result = 87;
      break;
    case 118:
      result = 86;
      break;
    case 117:
      result = 85;
      break;
    case 116:
      result = 84;
      break;
    case 115:
      result = 83;
      break;
    case 114:
      result = 82;
      break;
    case 113:
      result = 81;
      break;
    case 112:
      result = 80;
      break;
    case 111:
      result = 79;
      break;
    case 110:
      result = 78;
      break;
    case 109:
      result = 77;
      break;
    case 108:
      result = 76;
      break;
    case 107:
      result = 75;
      break;
    case 106:
      result = 74;
      break;
    case 105:
      result = 73;
      break;
    case 104:
      result = 72;
      break;
    case 103:
      result = 71;
      break;
    case 102:
      result = 70;
      break;
    case 101:
      result = 69;
      break;
    case 100:
      result = 68;
      break;
    case 99:
      result = 67;
      break;
    default:
      return result;
  }
  return result;
}

//----- (080A7680) --------------------------------------------------------
BOOL __usercall sub_80A7680@<al>(char *a1@<eax>, char *a2@<edx>)
{
  char *v2; // ebx@1
  char *v3; // esi@1
  char v4; // cl@1
  char v5; // dl@2
  char v6; // ST00_1@7
  char v7; // di@7
  char v8; // al@8

  v2 = a1;
  v3 = a2;
  v4 = *a1;
  if ( *a1 )
  {
    v5 = *a2;
    if ( v5 )
    {
      while ( 1 )
      {
        v6 = v5;
        v7 = sub_80A74C0(v4);
        if ( v7 != sub_80A74C0(v6) )
        {
          v8 = *v3;
          return sub_80A74C0(v8) == v7;
        }
        ++v2;
        v4 = *v2;
        if ( !*v2 )
          break;
        v5 = v3[1];
        if ( !v5 )
          goto LABEL_10;
        ++v3;
      }
      v7 = sub_80A74C0(0);
      v8 = v3[1];
    }
    else
    {
LABEL_10:
      v7 = sub_80A74C0(v4);
      v8 = 0;
    }
  }
  else
  {
    v7 = sub_80A74C0(0);
    v8 = *v3;
  }
  return sub_80A74C0(v8) == v7;
}

//----- (080A7720) --------------------------------------------------------
signed int __usercall sub_80A7720@<eax>(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  char *v3; // edi@1
  char *v4; // esi@1
  int v5; // ebp@1
  char v6; // bl@1
  char v7; // ST00_1@4
  char v8; // bl@4
  signed int result; // eax@9

  v3 = a1;
  v4 = a2;
  v5 = a3;
  v6 = *a1;
  if ( *a1 )
  {
    while ( *v4 )
    {
      if ( !v5 )
        goto LABEL_10;
      v7 = *v4;
      v8 = sub_80A74C0(v6);
      if ( v8 != sub_80A74C0(v7) )
        goto LABEL_9;
      --v5;
      ++v3;
      ++v4;
      v6 = *v3;
      if ( !*v3 )
        break;
    }
  }
  if ( v5 )
  {
    v8 = sub_80A74C0(v6);
LABEL_9:
    result = sub_80A74C0(*v4) == v8;
  }
  else
  {
LABEL_10:
    result = 1;
  }
  return result;
}

//----- (080A77B0) --------------------------------------------------------
char __cdecl sub_80A77B0(char *a1, char *a2)
{
  signed int v2; // eax@5
  int v3; // eax@7
  char *v4; // ebp@9
  char *v5; // eax@10
  char *v6; // edi@10
  char *v8; // [sp+Ch] [bp-20h]@14

  if ( !a1 || !*a1 || !a2 || !*a2 )
  {
LABEL_5:
    LOBYTE(v2) = 0;
    return v2;
  }
  LOBYTE(v3) = sub_80A7680(a2, a1);
  if ( v3 )
  {
    LOBYTE(v2) = 1;
  }
  else
  {
    v4 = strchr(a1, 42);
    if ( !v4
      || (v5 = strchr(a1, 46), (v6 = v5) == 0)
      || !strchr(v5 + 1, 46)
      || v4 > v6
      || sub_80A7720(a1, (char *)&dword_80BDEC8, 4) )
    {
      LOBYTE(v2) = sub_80A7680(a1, a2);
      LOBYTE(v2) = v2 != 0;
      return v2;
    }
    v8 = strchr(a2, 46);
    if ( !v8 )
      goto LABEL_5;
    LOBYTE(v2) = sub_80A7680(v6, v8);
    if ( !v2 )
      return v2;
    if ( v8 - a2 < v6 - a1 )
      goto LABEL_5;
    v2 = sub_80A7720(a1, a2, v4 - a1);
    if ( v2 )
      v2 = sub_80A7720(v4 + 1, &v8[-(v6 - (v4 + 1))], v6 - (v4 + 1)) != 0;
  }
  return v2;
}
// 80BDEC8: using guessed type int dword_80BDEC8;

//----- (080A7910) --------------------------------------------------------
char sub_80A7910()
{
  const void *v0; // eax@1
  int v1; // edx@1
  char *v2; // edi@1
  int v3; // esi@1
  unsigned int v4; // ecx@2
  signed int v5; // ecx@3
  unsigned int v7; // [sp+1Ch] [bp-10h]@1

  v7 = 0;
  v0 = sub_80A65E0((int)&unk_80CE6C0, dword_80CE6A0, (int)&v7);
  v1 = v7;
  v2 = (char *)&unk_80CE6C0;
  v3 = (int)v0;
  if ( v7 >= 4 )
  {
    v4 = v7 >> 2;
    qmemcpy(&unk_80CE6C0, v0, 4 * (v7 >> 2));
    v3 = (int)((char *)v0 + 4 * v4);
    v2 = (char *)&unk_80CE6C0 + 4 * v4;
  }
  v5 = 0;
  if ( v1 & 2 )
  {
    *(_WORD *)v2 = *(_WORD *)v3;
    v5 = 2;
  }
  if ( v1 & 1 )
    v2[v5] = *(_BYTE *)(v3 + v5);
  dword_80CE6A0 = v1;
  free((void *)v0);
  return 1;
}
// 80CE6A0: using guessed type int dword_80CE6A0;

//----- (080A7990) --------------------------------------------------------
int __cdecl sub_80A7990(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BE33C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BE33C: using guessed type void *off_80BE33C;

//----- (080A7A30) --------------------------------------------------------
int __cdecl sub_80A7A30(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BE334;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BE334: using guessed type void *off_80BE334;

//----- (080A7AD0) --------------------------------------------------------
int __cdecl sub_80A7AD0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BE324;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BE324: using guessed type void *off_80BE324;

//----- (080A7B70) --------------------------------------------------------
int __cdecl sub_80A7B70(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  int v5; // eax@7
  int v6; // ecx@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BE32C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = operator new(8u);
    v6 = *((_DWORD *)v4 + 1);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *(_DWORD *)(v5 + 4) = v6;
    *a1 = (void *)v5;
    result = 0;
  }
  return result;
}
// 80BE32C: using guessed type void *off_80BE32C;

//----- (080A7C10) --------------------------------------------------------
int __cdecl sub_80A7C10(int a1, int a2, int a3, int a4)
{
  int v4; // ebx@1
  int result; // eax@3

  v4 = a1;
  *(_DWORD *)a1 = &off_80B9500;
  *(_DWORD *)(v4 + 4) = v4;
  *(_DWORD *)(v4 + 8) = v4;
  *(_DWORD *)(a1 + 12) = a2;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = &off_80B9500;
  *(_DWORD *)(v4 + 24) = v4 + 20;
  *(_DWORD *)(v4 + 28) = v4 + 20;
  *(_DWORD *)(a1 + 32) = &off_80B94F0;
  *(_DWORD *)(v4 + 36) = v4 + 32;
  *(_DWORD *)(v4 + 40) = v4 + 32;
  *(_DWORD *)(a1 + 44) = &off_80B94F0;
  *(_DWORD *)(v4 + 48) = v4 + 44;
  *(_DWORD *)(v4 + 52) = v4 + 44;
  *(_DWORD *)(a1 + 56) = &off_80B94F0;
  *(_DWORD *)(v4 + 60) = v4 + 56;
  *(_DWORD *)(v4 + 64) = v4 + 56;
  *(_DWORD *)(a1 + 76) = 0;
  if ( *(_DWORD *)(a3 + 8) )
  {
    *(_DWORD *)(a1 + 80) = *(_DWORD *)(a3 + 12);
    *(_DWORD *)(a1 + 76) = *(_DWORD *)(a3 + 8);
    (*(void (__cdecl **)(int, int, signed int))(a3 + 8))(a1 + 68, a3, 2);
  }
  *(_DWORD *)(a1 + 92) = 0;
  result = *(_DWORD *)(a4 + 8);
  if ( result )
  {
    *(_DWORD *)(a1 + 96) = *(_DWORD *)(a4 + 12);
    *(_DWORD *)(a1 + 92) = *(_DWORD *)(a4 + 8);
    result = (*(int (__cdecl **)(int, int, signed int))(a4 + 8))(a1 + 84, a4, 2);
  }
  *(_DWORD *)(a1 + 100) = 0;
  *(_DWORD *)(a1 + 104) = 0;
  *(_DWORD *)(a1 + 108) = 0;
  return result;
}
// 80B94F0: using guessed type int (__cdecl *off_80B94F0)(int);
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);

//----- (080A7DD0) --------------------------------------------------------
int __cdecl sub_80A7DD0(int a1)
{
  int result; // eax@1
  int v2; // esi@2
  int v3; // eax@2
  int v4; // eax@2
  int v5; // edi@5
  unsigned int v6; // ebp@8
  int v7; // edi@8
  int v8; // eax@8
  int v9; // edx@9
  int v10; // edx@11
  int v11; // edx@12
  int v12; // eax@14
  std::ostream *v13; // ebp@14
  int v14; // eax@14
  int v15; // edi@14
  char v16; // al@16
  std::ostream *v17; // eax@17
  int v18; // edx@18
  signed __int32 v19; // eax@20
  signed __int32 v20; // ecx@26
  signed __int32 v21; // edi@28
  signed __int32 v22; // edi@32
  std::runtime_error *v23; // ebx@38
  int v24; // ebx@40
  int v25; // [sp+Ch] [bp-F0h]@0
  char v26; // [sp+21h] [bp-DBh]@40
  char v27; // [sp+22h] [bp-DAh]@34
  char v28; // [sp+23h] [bp-D9h]@10
  int v29; // [sp+24h] [bp-D8h]@8
  int v30; // [sp+28h] [bp-D4h]@10
  unsigned int v31; // [sp+2Ch] [bp-D0h]@8
  int v32; // [sp+30h] [bp-CCh]@8
  int v33; // [sp+34h] [bp-C8h]@8
  int v34; // [sp+38h] [bp-C4h]@8
  int v35; // [sp+3Ch] [bp-C0h]@8
  int v36; // [sp+40h] [bp-BCh]@8
  int v37; // [sp+44h] [bp-B8h]@8
  int v38; // [sp+48h] [bp-B4h]@8
  char v39; // [sp+4Ch] [bp-B0h]@8
  int v40; // [sp+50h] [bp-ACh]@8
  int v41; // [sp+54h] [bp-A8h]@8
  int v42; // [sp+58h] [bp-A4h]@8
  int v43; // [sp+C8h] [bp-34h]@8
  char v44; // [sp+CCh] [bp-30h]@8
  char v45; // [sp+CDh] [bp-2Fh]@8
  int v46; // [sp+D0h] [bp-2Ch]@8
  int v47; // [sp+D4h] [bp-28h]@8
  int v48; // [sp+D8h] [bp-24h]@8
  int v49; // [sp+DCh] [bp-20h]@8

  result = *(_DWORD *)(a1 + 16);
  if ( !result )
  {
    v2 = operator new(8u);
    v3 = *(_DWORD *)(a1 + 12);
    *(_DWORD *)v2 = 0;
    v4 = evdns_base_new(*(_DWORD *)(v3 + 4), 32769);
    *(_DWORD *)(v2 + 4) = v4;
    if ( !v4 )
    {
      v23 = (std::runtime_error *)_cxa_allocate_exception(8);
      std::string::string(&v30, "Event DNS initialization failed", &v31);
      std::runtime_error::runtime_error(v23, (const std::string *)&v30);
      *(_DWORD *)v23 = &off_80BAB18;
      std::string::_Rep::_M_dispose(v30 - 12, &v29);
      _cxa_throw(v23, &off_80BAADC, sub_807B6C0);
    }
    if ( evdns_base_set_option(v4, "randomize-case", 134981637) && log_level <= 5 )
    {
      std::ios_base::ios_base((std::ios_base *)&v42);
      v42 = (int)&unk_80CF5C8;
      v43 = 0;
      v44 = 0;
      v45 = 0;
      v46 = 0;
      v47 = 0;
      v48 = 0;
      v49 = 0;
      v6 = dword_80CF674;
      v31 = dword_80CF674;
      *(unsigned int *)((char *)&v31 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v31 + *(_DWORD *)(v31 - 12), 0);
      v31 = (unsigned int)&unk_80CF5DC;
      v42 = (int)&unk_80CF5F0;
      v32 = (int)&unk_80CF7F0;
      v33 = 0;
      v34 = 0;
      v35 = 0;
      v36 = 0;
      v37 = 0;
      v38 = 0;
      std::locale::locale((std::locale *)&v39);
      v32 = (int)&unk_80CF588;
      v40 = 16;
      v41 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v42, &v32);
      v7 = std::__ostream_insert<char,std::char_traits<char>>(
             &v31,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v7, "Event DNS failed to drop randomize-case option", 46);
      v29 = (int)&unk_80CF83C;
      v8 = *(_DWORD *)(v7 + 24);
      if ( v8 )
      {
        v9 = *(_DWORD *)(v7 + 16);
        LOBYTE(v25) = 0;
        if ( v8 <= (unsigned int)v9 )
        {
          v30 = std::string::_S_construct<char *>(a1, v6, (void *)v7, *(_DWORD *)(v7 + 20), v9, (int)&v28);
          std::string::swap((std::string *)&v29, (std::string *)&v30);
        }
        else
        {
          v30 = std::string::_S_construct<char *>(a1, v6, (void *)v7, *(_DWORD *)(v7 + 20), v8, (int)&v28);
          std::string::swap((std::string *)&v29, (std::string *)&v30);
        }
        v10 = v30 - 12;
        if ( (_DWORD *)(v30 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v22 = _InterlockedExchangeAdd((volatile signed __int32 *)(v30 - 4), 0xFFFFFFFF);
          }
          else
          {
            v22 = *(_DWORD *)(v30 - 4);
            *(_DWORD *)(v30 - 4) = v22 - 1;
          }
          if ( v22 <= 0 )
            std::string::_Rep::_M_destroy(v10, &v27);
        }
      }
      else
      {
        std::string::assign((std::string *)&v29, (const std::string *)(v7 + 40));
      }
      v31 = (unsigned int)&unk_80CF5DC;
      v42 = (int)&unk_80CF5F0;
      v32 = (int)&unk_80CF588;
      v11 = v41 - 12;
      if ( (_DWORD *)(v41 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v21 = _InterlockedExchangeAdd((volatile signed __int32 *)(v41 - 4), 0xFFFFFFFF);
        }
        else
        {
          v21 = *(_DWORD *)(v41 - 4);
          *(_DWORD *)(v41 - 4) = v21 - 1;
        }
        if ( v21 <= 0 )
          std::string::_Rep::_M_destroy(v11, &v30);
      }
      v32 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v39);
      v31 = v6;
      *(unsigned int *)((char *)&v31 + *(_DWORD *)(v6 - 12)) = dword_80CF678;
      v42 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v42);
      if ( byte_80CE64C )
      {
        v12 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v29, *(_DWORD *)(v29 - 12));
        v13 = (std::ostream *)v12;
        v14 = *(_DWORD *)(*(_DWORD *)v12 - 12);
        v15 = *(_DWORD *)((char *)v13 + v14 + 124);
        if ( !v15 )
        {
          v24 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v29 - 12, &v26);
          operator delete((void *)v2);
          Unwind_Resume(v24);
        }
        if ( *(_BYTE *)(v15 + 28) )
        {
          v16 = *(_BYTE *)(v15 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v13 + v14 + 124));
          v16 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v15 + 24))(v15, 10);
        }
        v17 = (std::ostream *)std::ostream::put(v13, v16);
        std::ostream::flush(v17);
      }
      syslog(3, "%s", v29, v25);
      v18 = v29 - 12;
      if ( (_DWORD *)(v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v19 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
        }
        else
        {
          v20 = *(_DWORD *)(v29 - 4);
          *(_DWORD *)(v29 - 4) = v20 - 1;
          v19 = v20;
        }
        if ( v19 <= 0 )
          std::string::_Rep::_M_destroy(v18, &v31);
      }
    }
    v5 = *(_DWORD *)(a1 + 16);
    *(_DWORD *)(a1 + 16) = v2;
    if ( v5 )
    {
      evdns_base_free(*(_DWORD *)(v5 + 4), 1);
      operator delete((void *)v5);
      v2 = *(_DWORD *)(a1 + 16);
    }
    *(_DWORD *)v2 = (unsigned __int8)byte_80CF88C < 1u ? 2 : 0;
    result = *(_DWORD *)(a1 + 16);
  }
  return result;
}
// 804C450: using guessed type int __cdecl evdns_base_new(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CEF0: using guessed type int __cdecl _cxa_allocate_exception(_DWORD);
// 804D090: using guessed type int __cdecl evdns_base_set_option(_DWORD, _DWORD, _DWORD);
// 804D0B0: using guessed type int __cdecl _cxa_throw(_DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80BAADC: using guessed type void *off_80BAADC;
// 80BAB18: using guessed type void *off_80BAB18;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF88C: using guessed type char byte_80CF88C;

//----- (080A83E0) --------------------------------------------------------
void __cdecl sub_80A83E0(int a1)
{
  int v1; // ebx@2
  int v2; // ebx@2
  int v3; // edi@9
  int v4; // ST1C_4@15
  int v5; // esi@15
  int v6; // eax@15
  signed int v7; // ST1C_4@17
  size_t v8; // eax@17
  signed int v9; // edx@17
  int v10; // eax@19
  int v11; // edx@20
  int v12; // edx@22
  volatile signed __int32 *v13; // eax@23
  std::ostream *v14; // esi@25
  char v15; // al@27
  std::ostream *v16; // eax@28
  int v17; // edx@29
  signed __int32 v18; // esi@31
  signed __int32 v19; // esi@40
  signed __int32 v20; // esi@45
  int v21; // ebx@51
  int v22; // [sp+Ch] [bp-104h]@0
  int v23; // [sp+1Ch] [bp-F4h]@25
  __int64 v24; // [sp+24h] [bp-ECh]@2
  __int64 v25; // [sp+2Ch] [bp-E4h]@2
  __int16 v26; // [sp+36h] [bp-DAh]@47
  char v27; // [sp+37h] [bp-D9h]@21
  _UNKNOWN *v28; // [sp+38h] [bp-D8h]@19
  int v29; // [sp+3Ch] [bp-D4h]@21
  int v30; // [sp+40h] [bp-D0h]@15
  _UNKNOWN *v31; // [sp+44h] [bp-CCh]@15
  int v32; // [sp+48h] [bp-C8h]@15
  int v33; // [sp+4Ch] [bp-C4h]@15
  int v34; // [sp+50h] [bp-C0h]@15
  int v35; // [sp+54h] [bp-BCh]@15
  int v36; // [sp+58h] [bp-B8h]@15
  int v37; // [sp+5Ch] [bp-B4h]@15
  int v38; // [sp+60h] [bp-B0h]@15
  signed int v39; // [sp+64h] [bp-ACh]@15
  volatile signed __int32 *v40; // [sp+68h] [bp-A8h]@15
  _UNKNOWN *v41; // [sp+6Ch] [bp-A4h]@15
  int v42; // [sp+DCh] [bp-34h]@15
  char v43; // [sp+E0h] [bp-30h]@15
  char v44; // [sp+E1h] [bp-2Fh]@15
  int v45; // [sp+E4h] [bp-2Ch]@15
  int v46; // [sp+E8h] [bp-28h]@15
  int v47; // [sp+ECh] [bp-24h]@15
  int v48; // [sp+F0h] [bp-20h]@15
  int v49; // [sp+10Ch] [bp-4h]@15

  if ( dword_80CF854 > 0 )
  {
    v1 = dword_80CF854;
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v25);
    v24 = v25 - 1000000000LL * v1;
    v2 = *(_DWORD *)(a1 + 60);
    while ( 1 )
    {
      if ( v2 == a1 + 56 )
        return;
      if ( v2 )
      {
        if ( SHIDWORD(v24) < *(_DWORD *)(v2 + 60)
          || SHIDWORD(v24) <= *(_DWORD *)(v2 + 60) && (unsigned int)v24 < *(_DWORD *)(v2 + 56) )
          return;
        v3 = v2 - 128;
      }
      else
      {
        if ( vB8 > v24 )
          return;
        v3 = 0;
      }
      v2 = *(_DWORD *)(v2 + 4);
      if ( *(_DWORD *)(v3 + 100) )
        break;
      if ( *(_DWORD *)(v3 + 112) )
      {
        if ( log_level > 1 )
          goto LABEL_12;
LABEL_15:
        v4 = *(_DWORD *)(v3 + 180);
        std::ios_base::ios_base((std::ios_base *)&v41);
        v41 = &unk_80CF5C8;
        v42 = 0;
        v43 = 0;
        v44 = 0;
        v45 = 0;
        v46 = 0;
        v47 = 0;
        v48 = 0;
        v30 = dword_80CF674;
        *(int *)((char *)&v49 + *(_DWORD *)(dword_80CF674 - 12) - 204) = dword_80CF678;
        std::basic_ios<char,std::char_traits<char>>::init((char *)&v30 + *(_DWORD *)(v30 - 12), 0);
        v30 = (int)&unk_80CF5DC;
        v41 = &unk_80CF5F0;
        v31 = &unk_80CF7F0;
        v32 = 0;
        v33 = 0;
        v34 = 0;
        v35 = 0;
        v36 = 0;
        v37 = 0;
        std::locale::locale((std::locale *)&v38);
        v31 = &unk_80CF588;
        v39 = 16;
        v40 = (volatile signed __int32 *)&unk_80CF83C;
        std::basic_ios<char,std::char_traits<char>>::init(&v41, &v31);
        v5 = std::__ostream_insert<char,std::char_traits<char>>(
               &v30,
               &unk_80CF83C,
               std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v5, "query timeout: ", 15);
        v6 = *(_DWORD *)(v4 + 28);
        if ( v6 )
        {
          if ( !*(_DWORD *)(v6 + 8) )
          {
            std::basic_ios<char,std::char_traits<char>>::clear(
              v5 + *(_DWORD *)(*(_DWORD *)v5 - 12),
              *(_DWORD *)(v5 + *(_DWORD *)(*(_DWORD *)v5 - 12) + 20) | 1);
            goto LABEL_19;
          }
          v7 = *(_DWORD *)(v6 + 8);
          v8 = strlen(*(const char **)(v6 + 8));
          v9 = v7;
        }
        else
        {
          v8 = 0;
          v9 = 134986579;
        }
        std::__ostream_insert<char,std::char_traits<char>>(v5, v9, v8);
LABEL_19:
        v28 = &unk_80CF83C;
        v10 = *(_DWORD *)(v5 + 24);
        if ( v10 )
        {
          v11 = *(_DWORD *)(v5 + 16);
          LOBYTE(v22) = 0;
          if ( v10 <= (unsigned int)v11 )
          {
            v29 = std::string::_S_construct<char *>(
                    v2,
                    (unsigned int)&v49,
                    (void *)v3,
                    *(_DWORD *)(v5 + 20),
                    v11,
                    (int)&v27);
            std::string::swap((std::string *)&v28, (std::string *)&v29);
          }
          else
          {
            v29 = std::string::_S_construct<char *>(
                    v2,
                    (unsigned int)&v49,
                    (void *)v3,
                    *(_DWORD *)(v5 + 20),
                    v10,
                    (int)&v27);
            std::string::swap((std::string *)&v28, (std::string *)&v29);
          }
          v12 = v29 - 12;
          if ( (_DWORD *)(v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v20 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
            }
            else
            {
              v20 = *(_DWORD *)(v29 - 4);
              *(_DWORD *)(v29 - 4) = v20 - 1;
            }
            if ( v20 <= 0 )
              std::string::_Rep::_M_destroy(v12, &v26);
          }
        }
        else
        {
          std::string::assign((std::string *)&v28, (const std::string *)(v5 + 40));
        }
        v30 = (int)&unk_80CF5DC;
        v41 = &unk_80CF5F0;
        v31 = &unk_80CF588;
        v13 = v40;
        if ( v40 - 3 != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v19 = _InterlockedExchangeAdd(v40 - 1, 0xFFFFFFFF);
          }
          else
          {
            v19 = *((_DWORD *)v40 - 1);
            *((_DWORD *)v40 - 1) = v19 - 1;
          }
          if ( v19 <= 0 )
            std::string::_Rep::_M_destroy(v13 - 3, &v29);
        }
        v31 = &unk_80CF7F0;
        std::locale::~locale((std::locale *)&v38);
        v30 = dword_80CF674;
        *(int *)((char *)&v49 + *(_DWORD *)(dword_80CF674 - 12) - 204) = dword_80CF678;
        v41 = &unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v41);
        if ( byte_80CE64C )
        {
          v14 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(
                                  &std::cout,
                                  v28,
                                  *((_DWORD *)v28 - 3));
          v23 = *(_DWORD *)((char *)v14 + *(_DWORD *)(*(_DWORD *)v14 - 12) + 124);
          if ( !v23 )
          {
            v21 = std::__throw_bad_cast();
            std::string::_Rep::_M_dispose((char *)v28 - 12, &v30);
            Unwind_Resume(v21);
          }
          if ( *(_BYTE *)(v23 + 28) )
          {
            v15 = *(_BYTE *)(v23 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(v23);
            v15 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v23 + 24))(v23, 10);
          }
          v16 = (std::ostream *)std::ostream::put(v14, v15);
          std::ostream::flush(v16);
        }
        syslog(7, "%s", v28, v22);
        v17 = (int)((char *)v28 - 12);
        if ( (_DWORD *)((char *)v28 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v18 = _InterlockedExchangeAdd((volatile signed __int32 *)v28 - 1, 0xFFFFFFFF);
          }
          else
          {
            v18 = *((_DWORD *)v28 - 1);
            *((_DWORD *)v28 - 1) = v18 - 1;
          }
          if ( v18 <= 0 )
            std::string::_Rep::_M_destroy(v17, &v30);
        }
LABEL_12:
        sub_8079ED0(v3);
      }
    }
    if ( log_level > 1 )
      goto LABEL_12;
    goto LABEL_15;
  }
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF854: using guessed type int dword_80CF854;
// 80CF874: using guessed type int log_level;

//----- (080A8AC0) --------------------------------------------------------
int __cdecl sub_80A8AC0(int a1, int a2)
{
  int v2; // eax@3
  int v3; // eax@6
  int v4; // eax@6
  int result; // eax@8
  int v6; // edi@11
  int v7; // eax@11
  signed int v8; // ST1C_4@13
  size_t v9; // eax@13
  signed int v10; // edx@13
  void *v11; // edi@15
  int v12; // eax@15
  int v13; // edx@15
  int v14; // ecx@16
  int v15; // edx@18
  int v16; // edx@19
  std::ostream *v17; // edi@21
  char v18; // al@23
  std::ostream *v19; // eax@24
  int v20; // edx@25
  signed __int32 v21; // eax@27
  signed __int32 v22; // edi@38
  int v23; // ebx@41
  signed __int32 v24; // edi@44
  signed __int32 v25; // ecx@48
  int v26; // [sp+Ch] [bp-100h]@0
  int v27; // [sp+18h] [bp-F4h]@11
  int v28; // [sp+18h] [bp-F4h]@21
  char v29; // [sp+26h] [bp-E6h]@40
  char v30; // [sp+27h] [bp-E5h]@17
  int v31; // [sp+28h] [bp-E4h]@15
  int v32; // [sp+2Ch] [bp-E0h]@6
  int (__cdecl *v33)(void **, void **, signed int); // [sp+34h] [bp-D8h]@6
  int (__cdecl *v34)(int **, int); // [sp+38h] [bp-D4h]@6
  int v35; // [sp+3Ch] [bp-D0h]@6
  int v36; // [sp+40h] [bp-CCh]@11
  int (__cdecl *v37)(void **, void **, signed int); // [sp+44h] [bp-C8h]@6
  void (__cdecl *v38)(int **, int *); // [sp+48h] [bp-C4h]@6
  int v39; // [sp+4Ch] [bp-C0h]@11
  int v40; // [sp+50h] [bp-BCh]@11
  int v41; // [sp+54h] [bp-B8h]@11
  int v42; // [sp+58h] [bp-B4h]@11
  char v43; // [sp+5Ch] [bp-B0h]@11
  int v44; // [sp+60h] [bp-ACh]@11
  int v45; // [sp+64h] [bp-A8h]@11
  int v46; // [sp+68h] [bp-A4h]@11
  int v47; // [sp+D8h] [bp-34h]@11
  char v48; // [sp+DCh] [bp-30h]@11
  char v49; // [sp+DDh] [bp-2Fh]@11
  int v50; // [sp+E0h] [bp-2Ch]@11
  int v51; // [sp+E4h] [bp-28h]@11
  int v52; // [sp+E8h] [bp-24h]@11
  int v53; // [sp+ECh] [bp-20h]@11

  if ( log_level <= 1 )
  {
    v27 = *(_DWORD *)(a2 + 8);
    std::ios_base::ios_base((std::ios_base *)&v46);
    v46 = (int)&unk_80CF5C8;
    v47 = 0;
    v48 = 0;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    v52 = 0;
    v53 = 0;
    v35 = dword_80CF674;
    *(int *)((char *)&v35 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v35 + *(_DWORD *)(v35 - 12), 0);
    v35 = (int)&unk_80CF5DC;
    v46 = (int)&unk_80CF5F0;
    v36 = (int)&unk_80CF7F0;
    v37 = 0;
    v38 = 0;
    v39 = 0;
    v40 = 0;
    v41 = 0;
    v42 = 0;
    std::locale::locale((std::locale *)&v43);
    v36 = (int)&unk_80CF588;
    v44 = 16;
    v45 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v46, &v36);
    v6 = std::__ostream_insert<char,std::char_traits<char>>(&v35, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v6, "query ", 6);
    v7 = *(_DWORD *)(a2 + 4);
    if ( v7 )
    {
      if ( !*(_DWORD *)(v7 + 8) )
      {
        std::basic_ios<char,std::char_traits<char>>::clear(
          v6 + *(_DWORD *)(*(_DWORD *)v6 - 12),
          *(_DWORD *)(v6 + *(_DWORD *)(*(_DWORD *)v6 - 12) + 20) | 1);
        goto LABEL_15;
      }
      v8 = *(_DWORD *)(v7 + 8);
      v9 = strlen(*(const char **)(v7 + 8));
      v10 = v8;
    }
    else
    {
      v9 = 0;
      v10 = 134986579;
    }
    std::__ostream_insert<char,std::char_traits<char>>(v6, v10, v9);
LABEL_15:
    std::__ostream_insert<char,std::char_traits<char>>(v6, ": ", 2);
    v11 = (void *)std::__ostream_insert<char,std::char_traits<char>>(
                    v6,
                    *(_DWORD *)(a2 + 12),
                    *(_DWORD *)(*(_DWORD *)(a2 + 12) - 12));
    std::__ostream_insert<char,std::char_traits<char>>(v11, " method: ", 9);
    v12 = std::ostream::operator<<(v11, v27);
    v31 = (int)&unk_80CF83C;
    v13 = *(_DWORD *)(v12 + 24);
    if ( v13 )
    {
      v14 = *(_DWORD *)(v12 + 16);
      LOBYTE(v26) = 0;
      if ( v13 > (unsigned int)v14 )
      {
        v32 = std::string::_S_construct<char *>(a1, (unsigned int)&v35, v11, *(_DWORD *)(v12 + 20), v13, (int)&v30);
        std::string::swap((std::string *)&v31, (std::string *)&v32);
      }
      else
      {
        v32 = std::string::_S_construct<char *>(a1, (unsigned int)&v35, &v30, *(_DWORD *)(v12 + 20), v14, (int)&v30);
        std::string::swap((std::string *)&v31, (std::string *)&v32);
      }
      v15 = v32 - 12;
      if ( (_DWORD *)(v32 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v22 = _InterlockedExchangeAdd((volatile signed __int32 *)(v32 - 4), 0xFFFFFFFF);
        }
        else
        {
          v22 = *(_DWORD *)(v32 - 4);
          *(_DWORD *)(v32 - 4) = v22 - 1;
        }
        if ( v22 <= 0 )
          std::string::_Rep::_M_destroy(v15, &v29);
      }
    }
    else
    {
      std::string::assign((std::string *)&v31, (const std::string *)(v12 + 40));
    }
    v35 = (int)&unk_80CF5DC;
    v46 = (int)&unk_80CF5F0;
    v36 = (int)&unk_80CF588;
    v16 = v45 - 12;
    if ( (_DWORD *)(v45 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v24 = _InterlockedExchangeAdd((volatile signed __int32 *)(v45 - 4), 0xFFFFFFFF);
      }
      else
      {
        v24 = *(_DWORD *)(v45 - 4);
        *(_DWORD *)(v45 - 4) = v24 - 1;
      }
      if ( v24 <= 0 )
        std::string::_Rep::_M_destroy(v16, &v32);
    }
    v36 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v43);
    v35 = dword_80CF674;
    *(int *)((char *)&v35 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v46 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v46);
    if ( byte_80CE64C )
    {
      v17 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v31, *(_DWORD *)(v31 - 12));
      v28 = *(_DWORD *)((char *)v17 + *(_DWORD *)(*(_DWORD *)v17 - 12) + 124);
      if ( !v28 )
      {
        v23 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v31 - 12, &v35);
        Unwind_Resume(v23);
      }
      if ( *(_BYTE *)(v28 + 28) )
      {
        v18 = *(_BYTE *)(v28 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(v28);
        v18 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v28 + 24))(v28, 10);
      }
      v19 = (std::ostream *)std::ostream::put(v17, v18);
      std::ostream::flush(v19);
    }
    syslog(7, "%s", v31, v26);
    v20 = v31 - 12;
    if ( (_DWORD *)(v31 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v21 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
      }
      else
      {
        v25 = *(_DWORD *)(v31 - 4);
        *(_DWORD *)(v31 - 4) = v25 - 1;
        v21 = v25;
      }
      if ( v21 <= 0 )
        std::string::_Rep::_M_destroy(v20, &v35);
    }
    goto LABEL_3;
  }
  if ( !a2 )
  {
    v2 = 0;
    goto LABEL_4;
  }
LABEL_3:
  v2 = a2 + 128;
LABEL_4:
  if ( *(_DWORD *)(v2 + 8) || *(_DWORD *)(v2 + 4) )
    sub_804D6DE();
  *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 64);
  *(_DWORD *)(v2 + 4) = a1 + 56;
  *(_DWORD *)(*(_DWORD *)(a1 + 64) + 4) = v2;
  *(_DWORD *)(a1 + 64) = v2;
  v37 = 0;
  v3 = operator new(8u);
  *(_DWORD *)v3 = a1;
  *(_DWORD *)(v3 + 4) = a2;
  v35 = v3;
  v38 = sub_80AF930;
  v37 = sub_80A7AD0;
  v33 = 0;
  v4 = operator new(8u);
  *(_DWORD *)v4 = a1;
  *(_DWORD *)(v4 + 4) = a2;
  v32 = v4;
  v34 = sub_80B08C0;
  v33 = sub_80A7B70;
  sub_807A7C0(a2, *(_DWORD *)(a1 + 12), (int)&v32, (int)&v35);
  if ( v33 )
    v33((void **)&v32, (void **)&v32, 3);
  result = (int)v37;
  if ( v37 )
    result = v37((void **)&v35, (void **)&v35, 3);
  return result;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080A9210) --------------------------------------------------------
int __cdecl sub_80A9210(int a1, int a2, int a3, std::string *a4, int a5)
{
  int v5; // ebx@1
  int v6; // eax@1
  int v7; // eax@5
  int v8; // eax@8
  int v9; // eax@10
  int v10; // eax@13
  int v11; // edx@13
  int (__cdecl *v12)(void **, void **, signed int); // edx@13
  int v13; // eax@13
  int (__cdecl *v14)(int **, int); // edx@13
  int result; // eax@18
  int v16; // edx@25
  int v17; // edi@34
  int v18; // eax@34
  signed int v19; // ST10_4@36
  size_t v20; // eax@36
  signed int v21; // edx@36
  void *v22; // edi@38
  int v23; // eax@38
  int v24; // edx@38
  int v25; // ecx@39
  int v26; // edx@41
  int v27; // edx@42
  std::ostream *v28; // edi@44
  char v29; // al@46
  std::ostream *v30; // eax@47
  int v31; // eax@48
  int v32; // edx@48
  signed __int32 v33; // ecx@50
  int v34; // eax@54
  signed __int32 v35; // edi@65
  signed __int32 v36; // edi@72
  std::string *v37; // [sp+Ch] [bp-100h]@1
  int v38; // [sp+10h] [bp-FCh]@13
  int v39; // [sp+10h] [bp-FCh]@44
  int v40; // [sp+14h] [bp-F8h]@13
  char v41; // [sp+1Fh] [bp-EDh]@11
  char v42; // [sp+26h] [bp-E6h]@74
  char v43; // [sp+27h] [bp-E5h]@40
  int v44; // [sp+28h] [bp-E4h]@38
  int v45; // [sp+2Ch] [bp-E0h]@13
  int (__cdecl *v46)(void **, void **, signed int); // [sp+34h] [bp-D8h]@13
  int (__cdecl *v47)(int **, int); // [sp+38h] [bp-D4h]@13
  int v48; // [sp+3Ch] [bp-D0h]@13
  int v49; // [sp+40h] [bp-CCh]@13
  int (__cdecl *v50)(void **, void **, signed int); // [sp+44h] [bp-C8h]@13
  int (__cdecl *v51)(int **, int); // [sp+48h] [bp-C4h]@13
  int v52; // [sp+4Ch] [bp-C0h]@34
  int v53; // [sp+50h] [bp-BCh]@34
  int v54; // [sp+54h] [bp-B8h]@34
  int v55; // [sp+58h] [bp-B4h]@34
  char v56; // [sp+5Ch] [bp-B0h]@34
  int v57; // [sp+60h] [bp-ACh]@34
  int v58; // [sp+64h] [bp-A8h]@34
  int v59; // [sp+68h] [bp-A4h]@34
  int v60; // [sp+D8h] [bp-34h]@34
  char v61; // [sp+DCh] [bp-30h]@34
  char v62; // [sp+DDh] [bp-2Fh]@34
  int v63; // [sp+E0h] [bp-2Ch]@34
  int v64; // [sp+E4h] [bp-28h]@34
  int v65; // [sp+E8h] [bp-24h]@34
  int v66; // [sp+ECh] [bp-20h]@34

  v5 = operator new(0xC0u);
  sub_808B220(v5, a2, a3, a4);
  v6 = *(_DWORD *)a5;
  if ( *(_DWORD *)a5 && *(_DWORD *)(*(_DWORD *)(v6 + 8) - 12) && a5 != v5 + 4 )
  {
    v16 = *(_DWORD *)(v5 + 4);
    if ( v16 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v16 + 4));
      if ( !v16 )
        (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      v6 = *(_DWORD *)a5;
    }
    *(_DWORD *)(v5 + 4) = v6;
    if ( v6 )
      _InterlockedIncrement((volatile signed __int32 *)(v6 + 4));
  }
  if ( *(_DWORD *)(dword_80CF888 - 12) )
  {
    *(_DWORD *)(v5 + 116) = dword_80CF888;
  }
  else if ( !v5 )
  {
    v7 = 0;
    goto LABEL_6;
  }
  v7 = v5 + 140;
LABEL_6:
  if ( *(_DWORD *)(v7 + 8) || *(_DWORD *)(v7 + 4) )
    _assert("!item_hook->_prev_item && !item_hook->_next_item", "util/intrusive_list.h", 178);
  *(_DWORD *)(v7 + 8) = *(_DWORD *)(a2 + 20);
  *(_DWORD *)(v7 + 4) = a2 + 12;
  *(_DWORD *)(*(_DWORD *)(a2 + 20) + 4) = v7;
  *(_DWORD *)(a2 + 20) = v7;
  v8 = *(_DWORD *)(v5 + 4);
  if ( !v8 || *(_DWORD *)(v8 + 16) != 5 || memcmp(*(const void **)(v8 + 12), "https", 5u) )
  {
    v9 = *(_DWORD *)(a1 + 104) + 1;
    *(_DWORD *)(a1 + 104) = v9;
    if ( *(_DWORD *)(a1 + 108) + v9 > dword_80CF85C )
    {
      v41 = 0;
      goto LABEL_12;
    }
    return sub_80A8AC0(a1, v5);
  }
  v34 = *(_DWORD *)(a1 + 108) + 1;
  *(_DWORD *)(a1 + 108) = v34;
  if ( dword_80CF85C >= v34 + *(_DWORD *)(a1 + 104) && v34 <= dword_80CF858 )
    return sub_80A8AC0(a1, v5);
  v41 = 1;
LABEL_12:
  if ( log_level <= 1 )
  {
    std::ios_base::ios_base((std::ios_base *)&v59);
    v59 = (int)&unk_80CF5C8;
    v60 = 0;
    v61 = 0;
    v62 = 0;
    v63 = 0;
    v64 = 0;
    v65 = 0;
    v66 = 0;
    v48 = dword_80CF674;
    *(int *)((char *)&v48 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v48 + *(_DWORD *)(v48 - 12), 0);
    v48 = (int)&unk_80CF5DC;
    v59 = (int)&unk_80CF5F0;
    v49 = (int)&unk_80CF7F0;
    v50 = 0;
    v51 = 0;
    v52 = 0;
    v53 = 0;
    v54 = 0;
    v55 = 0;
    std::locale::locale((std::locale *)&v56);
    v49 = (int)&unk_80CF588;
    v57 = 16;
    v58 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v59, &v49);
    v17 = std::__ostream_insert<char,std::char_traits<char>>(
            &v48,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v17, "queued query ", 13);
    v18 = *(_DWORD *)(v5 + 4);
    if ( v18 )
    {
      if ( !*(_DWORD *)(v18 + 8) )
      {
        std::basic_ios<char,std::char_traits<char>>::clear(
          v17 + *(_DWORD *)(*(_DWORD *)v17 - 12),
          *(_DWORD *)(v17 + *(_DWORD *)(*(_DWORD *)v17 - 12) + 20) | 1);
LABEL_38:
        std::__ostream_insert<char,std::char_traits<char>>(v17, ": ", 2);
        v22 = (void *)std::__ostream_insert<char,std::char_traits<char>>(
                        v17,
                        *(_DWORD *)a4,
                        *(_DWORD *)(*(_DWORD *)a4 - 12));
        std::__ostream_insert<char,std::char_traits<char>>(v22, " method: ", 9);
        v23 = std::ostream::operator<<(v22, a3);
        v44 = (int)&unk_80CF83C;
        v24 = *(_DWORD *)(v23 + 24);
        if ( v24 )
        {
          v25 = *(_DWORD *)(v23 + 16);
          LOBYTE(v37) = 0;
          if ( v24 <= (unsigned int)v25 )
          {
            v45 = std::string::_S_construct<char *>(v5, (unsigned int)&v48, &v43, *(_DWORD *)(v23 + 20), v25, (int)&v43);
            std::string::swap((std::string *)&v44, (std::string *)&v45);
          }
          else
          {
            v45 = std::string::_S_construct<char *>(v5, (unsigned int)&v48, v22, *(_DWORD *)(v23 + 20), v24, (int)&v43);
            std::string::swap((std::string *)&v44, (std::string *)&v45);
          }
          v26 = v45 - 12;
          if ( (_DWORD *)(v45 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v45 - 4), 0xFFFFFFFF);
            }
            else
            {
              v36 = *(_DWORD *)(v45 - 4);
              *(_DWORD *)(v45 - 4) = v36 - 1;
            }
            if ( v36 <= 0 )
              std::string::_Rep::_M_destroy(v26, &v42);
          }
        }
        else
        {
          std::string::assign((std::string *)&v44, (const std::string *)(v23 + 40));
        }
        v48 = (int)&unk_80CF5DC;
        v59 = (int)&unk_80CF5F0;
        v49 = (int)&unk_80CF588;
        v27 = v58 - 12;
        if ( (_DWORD *)(v58 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v35 = _InterlockedExchangeAdd((volatile signed __int32 *)(v58 - 4), 0xFFFFFFFF);
          }
          else
          {
            v35 = *(_DWORD *)(v58 - 4);
            *(_DWORD *)(v58 - 4) = v35 - 1;
          }
          if ( v35 <= 0 )
            std::string::_Rep::_M_destroy(v27, &v45);
        }
        v49 = (int)&unk_80CF7F0;
        std::locale::~locale((std::locale *)&v56);
        v48 = dword_80CF674;
        *(int *)((char *)&v48 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        v59 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v59);
        if ( byte_80CE64C )
        {
          v28 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(
                                  &std::cout,
                                  v44,
                                  *(_DWORD *)(v44 - 12));
          v39 = *(_DWORD *)((char *)v28 + *(_DWORD *)(*(_DWORD *)v28 - 12) + 124);
          if ( !v39 )
          {
            v31 = std::__throw_bad_cast();
            goto LABEL_70;
          }
          if ( *(_BYTE *)(v39 + 28) )
          {
            v29 = *(_BYTE *)(v39 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(v39);
            v29 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v39 + 24))(v39, 10);
          }
          v30 = (std::ostream *)std::ostream::put(v28, v29);
          std::ostream::flush(v30);
        }
        syslog(7, "%s", v44, v37);
        v31 = v44;
        v32 = v44 - 12;
        if ( (_DWORD *)(v44 - 12) == &std::string::_Rep::_S_empty_rep_storage )
          goto LABEL_13;
        if ( &_pthread_key_create )
        {
          v33 = _InterlockedExchangeAdd((volatile signed __int32 *)(v44 - 4), 0xFFFFFFFF);
          goto LABEL_51;
        }
LABEL_70:
        v33 = *(_DWORD *)(v31 - 4);
        *(_DWORD *)(v31 - 4) = v33 - 1;
LABEL_51:
        if ( v33 <= 0 )
          std::string::_Rep::_M_destroy(v32, &v48);
        goto LABEL_13;
      }
      v19 = *(_DWORD *)(v18 + 8);
      v20 = strlen(*(const char **)(v18 + 8));
      v21 = v19;
    }
    else
    {
      v20 = 0;
      v21 = 134986579;
    }
    std::__ostream_insert<char,std::char_traits<char>>(v17, v21, v20);
    goto LABEL_38;
  }
LABEL_13:
  v46 = 0;
  v10 = operator new(8u);
  *(_DWORD *)v10 = a1;
  *(_DWORD *)(v10 + 4) = v5;
  v45 = v10;
  v47 = sub_80B0890;
  v46 = sub_80A7A30;
  v51 = sub_80B0890;
  v50 = sub_80A7A30;
  sub_80A7A30((void **)&v48, (void **)&v45, 2);
  v38 = v48;
  v40 = v49;
  v11 = *(_DWORD *)(v5 + 60);
  v48 = *(_DWORD *)(v5 + 56);
  v49 = v11;
  *(_DWORD *)(v5 + 56) = v38;
  *(_DWORD *)(v5 + 60) = v40;
  v12 = v50;
  v50 = *(int (__cdecl **)(void **, void **, signed int))(v5 + 64);
  v13 = (int)v50;
  *(_DWORD *)(v5 + 64) = v12;
  v14 = v51;
  v51 = *(int (__cdecl **)(int **, int))(v5 + 68);
  *(_DWORD *)(v5 + 68) = v14;
  if ( v13 )
    ((void (__cdecl *)(int *, int *, signed int, std::string *, int, int))v13)(&v48, &v48, 3, v37, v38, v40);
  if ( v46 )
    ((void (__cdecl *)(int *, int *, signed int, std::string *, int, int))v46)(&v45, &v45, 3, v37, v38, v40);
  if ( !v41 )
  {
    result = v5 + 128;
    if ( !*(_DWORD *)(v5 + 136) && !*(_DWORD *)(v5 + 132) )
    {
      *(_DWORD *)(v5 + 136) = *(_DWORD *)(a1 + 40);
      *(_DWORD *)(v5 + 132) = a1 + 32;
      *(_DWORD *)(*(_DWORD *)(a1 + 40) + 4) = result;
      *(_DWORD *)(a1 + 40) = result;
      return result;
    }
LABEL_63:
    sub_804D6DE();
  }
  result = v5 + 128;
  if ( *(_DWORD *)(v5 + 136) || *(_DWORD *)(v5 + 132) )
    goto LABEL_63;
  *(_DWORD *)(v5 + 136) = *(_DWORD *)(a1 + 52);
  *(_DWORD *)(v5 + 132) = a1 + 44;
  *(_DWORD *)(*(_DWORD *)(a1 + 52) + 4) = result;
  *(_DWORD *)(a1 + 52) = result;
  return result;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF858: using guessed type int dword_80CF858;
// 80CF85C: using guessed type int dword_80CF85C;
// 80CF874: using guessed type int log_level;
// 80CF888: using guessed type int dword_80CF888;

//----- (080A9B50) --------------------------------------------------------
int __cdecl sub_80A9B50(int a1, int a2, std::string *a3)
{
  int v3; // ebx@1
  unsigned int v4; // edi@1
  int v5; // eax@1
  signed int v6; // esi@2
  int result; // eax@3
  int v8; // eax@5
  bool v9; // zf@5
  int v10; // eax@9
  bool v11; // zf@9
  int v12; // eax@16
  int v13; // esi@16
  const void *v14; // edx@19
  unsigned int v15; // eax@24
  int v16; // eax@24
  bool v17; // zf@24
  int v18; // edx@27
  int v19; // edx@30
  int v20; // esi@31
  int v21; // ecx@31
  const char *v22; // ecx@32
  signed int v23; // esi@33
  int v24; // esi@33
  int v25; // edi@34
  int v26; // ebx@34
  int v27; // eax@41
  int v28; // eax@46
  bool v29; // zf@46
  int v30; // eax@52
  int v31; // eax@53
  int v32; // edx@54
  char **v33; // eax@56
  int v34; // edi@56
  int v35; // eax@58
  int v36; // esi@58
  int v37; // eax@58
  int v38; // edx@58
  int v39; // edx@59
  int v40; // ecx@60
  int v41; // edx@60
  int v42; // edx@61
  int v43; // ecx@62
  int v44; // edx@62
  int v45; // eax@63
  int v46; // ecx@64
  int v47; // eax@64
  bool v48; // zf@64
  int v49; // edi@68
  int v50; // eax@68
  int v51; // edx@68
  int v52; // ecx@68
  int v53; // ecx@70
  int v54; // esi@72
  int v55; // ecx@72
  int v56; // edx@75
  bool v57; // zf@76
  int v58; // eax@84
  bool v59; // zf@84
  int v60; // esi@88
  unsigned int v61; // ST20_4@88
  const char *v62; // esi@88
  unsigned int v63; // eax@88
  signed __int32 v64; // edx@95
  signed __int32 v65; // eax@100
  signed __int32 v66; // edx@104
  signed __int32 v67; // ecx@107
  signed __int32 v68; // ecx@110
  unsigned int v69; // [sp+20h] [bp-48h]@34
  std::string *v70; // [sp+24h] [bp-44h]@33
  int v71; // [sp+24h] [bp-44h]@58
  char *s; // [sp+28h] [bp-40h]@23
  char *sa; // [sp+28h] [bp-40h]@33
  int sb; // [sp+28h] [bp-40h]@44
  char *sc; // [sp+28h] [bp-40h]@55
  char *sd; // [sp+28h] [bp-40h]@56
  int v77; // [sp+2Ch] [bp-3Ch]@12
  char v78; // [sp+3Bh] [bp-2Dh]@55
  int v79; // [sp+3Ch] [bp-2Ch]@52
  int v80; // [sp+40h] [bp-28h]@55
  int v81; // [sp+44h] [bp-24h]@24
  int v82; // [sp+48h] [bp-20h]@24
  char v83[4]; // [sp+4Ch] [bp-1Ch]@5

  v3 = a2;
  v4 = *(_DWORD *)(a2 + 24);
  v5 = *(_DWORD *)(v4 + 32);
  if ( *(_BYTE *)(v5 + 59) )
  {
    *(_DWORD *)v83 = 0;
    sub_80A9210(a1, a2, 1, a3, (int)v83);
    v8 = *(_DWORD *)v83;
    v9 = *(_DWORD *)v83 == 0;
    if ( *(_DWORD *)v83 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(*(_DWORD *)v83 + 4));
      if ( v9 )
        (*(void (__cdecl **)(int))(*(_DWORD *)v8 + 4))(v8);
    }
    v6 = 1;
    if ( !*(_BYTE *)(*(_DWORD *)(v4 + 32) + 60) )
      goto LABEL_3;
  }
  else
  {
    v6 = 0;
    if ( !*(_BYTE *)(v5 + 60) )
    {
LABEL_3:
      result = *(_DWORD *)(a2 + 32);
      if ( *(_DWORD *)(a2 + 36) != result || !v6 )
        return result;
      v77 = 1;
LABEL_16:
      v12 = *(_DWORD *)(a2 + 24);
      v13 = *(_DWORD *)(a2 + 28);
      if ( v13 )
      {
        result = *(_DWORD *)(v12 + 16);
        if ( !result )
          return result;
        if ( v13 != result )
        {
          v14 = *(const void **)(v13 + 8);
          result = *(_DWORD *)(result + 8);
          if ( *((_DWORD *)v14 - 3) != *(_DWORD *)(result - 12) )
            return result;
          result = memcmp(v14, (const void *)result, *((_DWORD *)v14 - 3));
          if ( result )
            return result;
        }
        result = *(_DWORD *)(v4 + 32);
        if ( *(_BYTE *)(result + 39) )
        {
          if ( *(_BYTE *)(*(_DWORD *)(v13 + 40) + *(_DWORD *)(v13 + 8)) )
          {
            s = (char *)(*(_DWORD *)(v13 + 40) + *(_DWORD *)(v13 + 8));
            goto LABEL_24;
          }
LABEL_83:
          s = "http://" + 6;
LABEL_24:
          std::string::string(&v82, 134981720, v83);
          v15 = strlen(s);
          std::string::append((std::string *)&v82, s, v15);
          v81 = v82;
          sub_80B0E70((int)v83, *(_DWORD *)(a2 + 28), (const char **)&v81);
          sub_80A9210(a1, a2, v77, a3, (int)v83);
          v16 = *(_DWORD *)v83;
          v17 = *(_DWORD *)v83 == 0;
          if ( *(_DWORD *)v83 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(*(_DWORD *)v83 + 4));
            if ( v17 )
              (*(void (__cdecl **)(int))(*(_DWORD *)v16 + 4))(v16);
          }
          v18 = v82 - 12;
          if ( (_DWORD *)(v82 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v68 = _InterlockedExchangeAdd((volatile signed __int32 *)(v82 - 4), 0xFFFFFFFF);
            }
            else
            {
              v68 = *(_DWORD *)(v82 - 4);
              *(_DWORD *)(v82 - 4) = v68 - 1;
            }
            if ( v68 <= 0 )
              std::string::_Rep::_M_destroy(v18, &v80);
          }
          result = *(_DWORD *)(v4 + 32);
          goto LABEL_29;
        }
      }
      else
      {
        result = *(_DWORD *)(v12 + 16);
        if ( result )
          return result;
        result = *(_DWORD *)(v4 + 32);
        if ( *(_BYTE *)(result + 39) )
          goto LABEL_83;
      }
LABEL_29:
      if ( !*(_BYTE *)(result + 38)
        || (v19 = *(_DWORD *)(a2 + 28)) == 0
        || (v20 = *(_DWORD *)(v19 + 8), v21 = *(_DWORD *)(v19 + 40), *(_DWORD *)(v20 - 12) - v21 <= 1) )
      {
LABEL_51:
        if ( *(_BYTE *)(result + 40) )
        {
          v30 = *(_DWORD *)(v3 + 28);
          v79 = v30;
          if ( v30
            && (_InterlockedIncrement((volatile signed __int32 *)(v30 + 4)), (v31 = *(_DWORD *)(v3 + 28)) != 0)
            && (v32 = *(_DWORD *)(v31 + 32)) != 0 )
          {
            sc = (char *)&v80;
            std::string::string(&v80, *(_DWORD *)(v31 + 28), v32, &v78);
          }
          else
          {
            sc = (char *)&v80;
            std::string::string((std::string *)&v80, (const std::string *)&dword_80CF8FC);
          }
          v33 = (char **)std::string::append((std::string *)sc, ".", 1u);
          sd = *v33;
          *v33 = (char *)&unk_80CF83C;
          v34 = v79;
          if ( v79 && *(_DWORD *)(v79 + 28) )
          {
            v35 = operator new(0x2Cu);
            v36 = v35;
            *(_DWORD *)(v35 + 4) = 0;
            *(_DWORD *)v35 = &off_80BA2F8;
            v71 = v35 + 8;
            std::string::string((std::string *)(v35 + 8), (const std::string *)(v34 + 8));
            *(_DWORD *)(v36 + 12) = 0;
            *(_DWORD *)(v36 + 16) = 0;
            *(_DWORD *)(v36 + 20) = 0;
            *(_DWORD *)(v36 + 24) = 0;
            *(_DWORD *)(v36 + 28) = 0;
            *(_DWORD *)(v36 + 32) = 0;
            *(_DWORD *)(v36 + 36) = *(_DWORD *)(v34 + 36);
            *(_DWORD *)(v36 + 40) = *(_DWORD *)(v34 + 40);
            v37 = *(_DWORD *)(v36 + 8);
            v38 = *(_DWORD *)(v34 + 12);
            if ( v38 )
              v39 = v37 + v38 - *(_DWORD *)(v34 + 8);
            else
              v39 = 0;
            v40 = *(_DWORD *)(v34 + 16);
            *(_DWORD *)(v36 + 12) = v39;
            *(_DWORD *)(v36 + 16) = v40;
            v41 = *(_DWORD *)(v34 + 28);
            if ( v41 )
              v42 = v37 + v41 - *(_DWORD *)(v34 + 8);
            else
              v42 = 0;
            v43 = *(_DWORD *)(v34 + 32);
            *(_DWORD *)(v36 + 28) = v42;
            *(_DWORD *)(v36 + 32) = v43;
            v44 = *(_DWORD *)(v34 + 20);
            if ( v44 )
              v45 = v44 - *(_DWORD *)(v34 + 8) + v37;
            else
              v45 = 0;
            v46 = *(_DWORD *)(v34 + 24);
            *(_DWORD *)(v36 + 20) = v45;
            *(_DWORD *)(v36 + 24) = v46;
            _InterlockedIncrement((volatile signed __int32 *)(v36 + 4));
            v47 = v79;
            v48 = v79 == 0;
            if ( v79 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v79 + 4));
              if ( v48 )
                (*(void (__cdecl **)(int))(*(_DWORD *)v47 + 4))(v47);
            }
            v79 = v36;
          }
          else
          {
            sub_80B1010((int)v83, 134986579);
            v58 = v79;
            v59 = v79 == 0;
            if ( v79 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(v79 + 4));
              if ( v59 )
                (*(void (__cdecl **)(int))(*(_DWORD *)v58 + 4))(v58);
            }
            v36 = *(_DWORD *)v83;
            v79 = *(_DWORD *)v83;
            v71 = *(_DWORD *)v83 + 8;
          }
          v49 = *(_DWORD *)(v36 + 8);
          std::string::replace(
            (std::string *)v71,
            *(_DWORD *)(v36 + 28) - v49,
            *(_DWORD *)(v36 + 32),
            sd,
            *((_DWORD *)sd - 3));
          v50 = v79;
          *(_DWORD *)(v50 + 40) += *((_DWORD *)sd - 3) - *(_DWORD *)(v79 + 32);
          v51 = *(_DWORD *)(v50 + 8);
          v52 = *(_DWORD *)(v50 + 12);
          if ( v52 )
            *(_DWORD *)(v50 + 12) = v51 + v49 - v52;
          v53 = *(_DWORD *)(v50 + 20);
          if ( v53 )
            *(_DWORD *)(v50 + 20) = v51 + v49 - v53;
          v54 = *((_DWORD *)sd - 3);
          v55 = *(_DWORD *)(v50 + 28);
          if ( v55 )
          {
            *(_DWORD *)(v50 + 28) = v51 + v55 - v49;
            *(_DWORD *)(v50 + 32) = v54;
          }
          else if ( v54 > 0 )
          {
            *(_DWORD *)(v50 + 28) = v51;
            *(_DWORD *)(v50 + 32) = v54;
          }
          if ( (_DWORD *)(sd - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v66 = _InterlockedExchangeAdd((volatile signed __int32 *)sd - 1, 0xFFFFFFFF);
            }
            else
            {
              v66 = *((_DWORD *)sd - 1);
              *((_DWORD *)sd - 1) = v66 - 1;
            }
            if ( v66 <= 0 )
              std::string::_Rep::_M_destroy(sd - 12, v83);
          }
          v56 = v80 - 12;
          if ( (_DWORD *)(v80 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v65 = _InterlockedExchangeAdd((volatile signed __int32 *)(v80 - 4), 0xFFFFFFFF);
            }
            else
            {
              v67 = *(_DWORD *)(v80 - 4);
              *(_DWORD *)(v80 - 4) = v67 - 1;
              v65 = v67;
            }
            if ( v65 <= 0 )
              std::string::_Rep::_M_destroy(v56, v83);
          }
          sub_80A9210(a1, v3, v77, a3, (int)&v79);
          result = v79;
          v57 = v79 == 0;
          if ( v79 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v79 + 4));
            if ( v57 )
              result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
          }
        }
        return result;
      }
      v22 = (const char *)(v20 + v21);
      if ( *v22 )
      {
        v70 = (std::string *)v22;
        v23 = strlen(v22);
        sa = (char *)v23;
        v24 = rand() % v23;
        if ( (signed int)sa <= v24 )
        {
LABEL_44:
          sb = (int)&unk_80CF83C;
LABEL_45:
          if ( *(_DWORD *)(sb - 12) )
          {
            v82 = sb;
            sub_80B0E70((int)v83, *(_DWORD *)(v3 + 28), (const char **)&v82);
            sub_80A9210(a1, v3, v77, a3, (int)v83);
            v28 = *(_DWORD *)v83;
            v29 = *(_DWORD *)v83 == 0;
            if ( *(_DWORD *)v83 )
            {
              _InterlockedDecrement((volatile signed __int32 *)(*(_DWORD *)v83 + 4));
              if ( v29 )
                (*(void (__cdecl **)(int))(*(_DWORD *)v28 + 4))(v28);
            }
          }
          if ( (_DWORD *)(sb - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v64 = _InterlockedExchangeAdd((volatile signed __int32 *)(sb - 4), 0xFFFFFFFF);
            }
            else
            {
              v64 = *(_DWORD *)(sb - 4);
              *(_DWORD *)(sb - 4) = v64 - 1;
            }
            if ( v64 <= 0 )
              std::string::_Rep::_M_destroy(sb - 12, v83);
          }
          result = *(_DWORD *)(v4 + 32);
          goto LABEL_51;
        }
      }
      else
      {
        rand();
        sa = (char *)1;
        v70 = (std::string *)("http://" + 6);
        v24 = 0;
      }
      v69 = v4;
      v25 = (int)((char *)v70 + v24);
      v26 = v24;
      while ( 1 )
      {
        if ( ((unsigned __int8)(*(_BYTE *)v25 - 48) <= 9u || (unsigned __int8)((*(_BYTE *)v25 & 0xDF) - 65) <= 0x19u)
          && (v26 <= 0 || *(_BYTE *)(v25 - 1) != 37 && (v26 == 1 || *(_BYTE *)(v25 - 2) != 37)) )
        {
          v27 = snprintf(v83, 4u, "%%%02X", *(_BYTE *)v25);
          if ( v27 > 0 )
            break;
        }
        ++v26;
        ++v25;
        if ( (signed int)sa <= v26 )
        {
          v4 = v69;
          v3 = a2;
          goto LABEL_44;
        }
      }
      v4 = v69;
      v60 = v26;
      v3 = a2;
      v61 = v27;
      std::string::string(&v82, v70, v60, &v80);
      std::string::append((std::string *)&v82, v83, v61);
      v62 = (char *)v70 + v60 + 1;
      v63 = strlen(v62);
      std::string::append((std::string *)&v82, v62, v63);
      sb = v82;
      goto LABEL_45;
    }
  }
  *(_DWORD *)v83 = 0;
  sub_80A9210(a1, a2, 2, a3, (int)v83);
  v10 = *(_DWORD *)v83;
  v11 = *(_DWORD *)v83 == 0;
  if ( *(_DWORD *)v83 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(*(_DWORD *)v83 + 4));
    if ( v11 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v10 + 4))(v10);
  }
  v77 = 2 - v6;
  result = *(_DWORD *)(a2 + 32);
  if ( *(_DWORD *)(a2 + 36) == result )
    goto LABEL_16;
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 80BA2F8: using guessed type void *off_80BA2F8;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (080AA430) --------------------------------------------------------
void __cdecl sub_80AA430(int a1, int a2, std::string *a3)
{
  int v3; // esi@1
  int v4; // eax@1
  int v5; // eax@3
  int v6; // eax@4
  int v7; // eax@5
  int v8; // eax@7
  int v9; // edx@11
  int v10; // eax@14
  int v11; // edx@15
  int v12; // esi@17
  char *v13; // edi@18
  size_t v14; // ebp@18
  const void *v15; // eax@20
  int v16; // eax@23
  char *v17; // edx@27
  bool v18; // zf@28
  bool v19; // zf@38
  int v20; // eax@42
  void *i; // edi@42
  unsigned int v22; // ebp@44
  int v23; // eax@44
  signed int v24; // esi@45
  size_t v25; // eax@46
  int v26; // eax@48
  int v27; // edx@48
  int v28; // ecx@49
  int v29; // edx@51
  int v30; // edx@52
  int v31; // eax@54
  std::ostream *v32; // edi@54
  int v33; // eax@54
  int v34; // esi@54
  char v35; // al@56
  std::ostream *v36; // eax@57
  int v37; // edx@58
  int v38; // eax@61
  int v39; // esi@61
  std::string *v40; // ecx@61
  int v41; // eax@61
  int v42; // edx@62
  char *v43; // edi@67
  int v44; // eax@67
  int v45; // eax@67
  char *v46; // edx@69
  signed __int32 v47; // eax@70
  int v48; // eax@73
  int v49; // esi@73
  int v50; // eax@73
  int v51; // ebx@73
  int (__cdecl *v52)(void **, void **, signed int); // eax@73
  int v53; // edi@79
  int v54; // ebx@79
  int v55; // eax@79
  int v56; // edx@79
  int v57; // ecx@80
  int v58; // ebx@82
  int v59; // ebx@83
  int v60; // eax@85
  std::ostream *v61; // edi@85
  int v62; // eax@85
  int v63; // ebx@85
  char v64; // al@87
  std::ostream *v65; // eax@88
  int v66; // edx@89
  signed __int32 v67; // ecx@91
  signed __int32 v68; // eax@105
  signed __int32 v69; // eax@109
  int v70; // ebx@112
  signed __int32 v71; // ecx@113
  signed __int32 v72; // ecx@115
  signed __int32 v73; // ecx@118
  signed __int32 v74; // ecx@122
  signed __int32 v75; // eax@128
  signed __int32 v76; // ecx@132
  signed __int32 v77; // esi@134
  signed __int32 v78; // esi@138
  int v79; // [sp+Ch] [bp-1D0h]@0
  int v80; // [sp+24h] [bp-1B8h]@3
  int v81; // [sp+28h] [bp-1B4h]@5
  char v82; // [sp+35h] [bp-1A7h]@16
  char v83; // [sp+37h] [bp-1A5h]@63
  char *v84; // [sp+38h] [bp-1A4h]@16
  int v85; // [sp+3Ch] [bp-1A0h]@61
  int v86; // [sp+40h] [bp-19Ch]@50
  int v87; // [sp+44h] [bp-198h]@75
  int v88; // [sp+48h] [bp-194h]@48
  int (__cdecl *v89)(void **, void **, signed int); // [sp+50h] [bp-18Ch]@73
  int (__cdecl *v90)(int **); // [sp+54h] [bp-188h]@73
  int v91; // [sp+58h] [bp-184h]@44
  int v92; // [sp+5Ch] [bp-180h]@44
  int v93; // [sp+60h] [bp-17Ch]@44
  int v94; // [sp+64h] [bp-178h]@44
  int v95; // [sp+68h] [bp-174h]@44
  int v96; // [sp+6Ch] [bp-170h]@44
  int v97; // [sp+70h] [bp-16Ch]@44
  int v98; // [sp+74h] [bp-168h]@44
  char v99; // [sp+78h] [bp-164h]@44
  int v100; // [sp+7Ch] [bp-160h]@44
  int v101; // [sp+80h] [bp-15Ch]@44
  int v102; // [sp+84h] [bp-158h]@44
  int v103; // [sp+F4h] [bp-E8h]@44
  char v104; // [sp+F8h] [bp-E4h]@44
  char v105; // [sp+F9h] [bp-E3h]@44
  int v106; // [sp+FCh] [bp-E0h]@44
  int v107; // [sp+100h] [bp-DCh]@44
  int v108; // [sp+104h] [bp-D8h]@44
  int v109; // [sp+108h] [bp-D4h]@44
  int v110; // [sp+10Ch] [bp-D0h]@35
  int v111; // [sp+110h] [bp-CCh]@79
  int v112; // [sp+114h] [bp-C8h]@79
  int v113; // [sp+118h] [bp-C4h]@79
  int v114; // [sp+11Ch] [bp-C0h]@79
  int v115; // [sp+120h] [bp-BCh]@79
  int v116; // [sp+124h] [bp-B8h]@79
  int v117; // [sp+128h] [bp-B4h]@79
  char v118; // [sp+12Ch] [bp-B0h]@79
  int v119; // [sp+130h] [bp-ACh]@79
  int v120; // [sp+134h] [bp-A8h]@79
  int v121; // [sp+138h] [bp-A4h]@79
  int v122; // [sp+1A8h] [bp-34h]@79
  char v123; // [sp+1ACh] [bp-30h]@79
  char v124; // [sp+1ADh] [bp-2Fh]@79
  int v125; // [sp+1B0h] [bp-2Ch]@79
  int v126; // [sp+1B4h] [bp-28h]@79
  int v127; // [sp+1B8h] [bp-24h]@79
  int v128; // [sp+1BCh] [bp-20h]@79

  v3 = a2;
  v4 = *(_DWORD *)(a2 + 28);
  if ( v4 && *(_DWORD *)(v4 + 32) )
  {
    v5 = *(_DWORD *)(a2 + 24);
    v80 = v5;
    if ( v5 )
    {
      _InterlockedIncrement((volatile signed __int32 *)(v5 + 4));
      v3 = a2;
      v6 = *(_DWORD *)(a2 + 24);
    }
    else
    {
      v6 = 0;
    }
    v7 = *(_DWORD *)(v6 + 32);
    v81 = v7;
    if ( v7 )
    {
      _InterlockedIncrement((volatile signed __int32 *)(v7 + 4));
      v3 = a2;
    }
    v8 = *(_DWORD *)(v80 + 36);
    if ( !v8 )
    {
      ++*(_DWORD *)(v81 + 64);
      v8 = *(_DWORD *)(v80 + 36);
    }
    *(_DWORD *)(v80 + 36) = v8 + 1;
    if ( *(_DWORD *)(v3 + 8) || *(_DWORD *)(v3 + 4) )
      _assert("!item_hook->_prev_item && !item_hook->_next_item", "util/intrusive_list.h", 178);
    *(_DWORD *)(v3 + 8) = *(_DWORD *)(a1 + 28);
    v9 = a1 + 20;
    *(_DWORD *)(v3 + 4) = a1 + 20;
    *(_DWORD *)(*(_DWORD *)(a1 + 28) + 4) = v3;
    *(_DWORD *)(a1 + 28) = v3;
    if ( log_level > 1 )
      goto LABEL_12;
    v20 = *(_DWORD *)(a1 + 24);
    for ( i = 0; v20 != v9; v20 = *(_DWORD *)(v20 + 4) )
      i = (char *)i + 1;
    std::ios_base::ios_base((std::ios_base *)&v102);
    v102 = (int)&unk_80CF5C8;
    v103 = 0;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v109 = 0;
    v91 = dword_80CF674;
    *(int *)((char *)&v91 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v91 + *(_DWORD *)(v91 - 12), 0);
    v91 = (int)&unk_80CF5DC;
    v102 = (int)&unk_80CF5F0;
    v92 = (int)&unk_80CF7F0;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    v98 = 0;
    std::locale::locale((std::locale *)&v99);
    v92 = (int)&unk_80CF588;
    v100 = 16;
    v101 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v102, &v92);
    v22 = std::__ostream_insert<char,std::char_traits<char>>(
            &v91,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v22, "job add: ", 9);
    v23 = *(_DWORD *)(v3 + 28);
    if ( v23 )
    {
      v24 = *(_DWORD *)(v23 + 8);
      if ( !v24 )
      {
        std::basic_ios<char,std::char_traits<char>>::clear(
          v22 + *(_DWORD *)(*(_DWORD *)v22 - 12),
          *(_DWORD *)(v22 + *(_DWORD *)(*(_DWORD *)v22 - 12) + 20) | 1);
        goto LABEL_48;
      }
      v25 = strlen(*(const char **)(v23 + 8));
    }
    else
    {
      v25 = 0;
      v24 = 134986579;
    }
    std::__ostream_insert<char,std::char_traits<char>>(v22, v24, v25);
LABEL_48:
    std::__ostream_insert<char,std::char_traits<char>>(v22, " total: ", 8);
    v26 = std::ostream::_M_insert<unsigned long>(v22, i);
    v88 = (int)&unk_80CF83C;
    v27 = *(_DWORD *)(v26 + 24);
    if ( v27 )
    {
      v28 = *(_DWORD *)(v26 + 16);
      LOBYTE(v79) = 0;
      if ( v27 <= (unsigned int)v28 )
      {
        v110 = std::string::_S_construct<char *>(a1, v22, i, *(_DWORD *)(v26 + 20), v28, (int)&v86);
        v22 = (unsigned int)&v110;
        std::string::swap((std::string *)&v88, (std::string *)&v110);
      }
      else
      {
        v110 = std::string::_S_construct<char *>(a1, v22, i, *(_DWORD *)(v26 + 20), v27, (int)&v86);
        v22 = (unsigned int)&v110;
        std::string::swap((std::string *)&v88, (std::string *)&v110);
      }
      v29 = v110 - 12;
      if ( (_DWORD *)(v110 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v78 = _InterlockedExchangeAdd((volatile signed __int32 *)(v110 - 4), 0xFFFFFFFF);
        }
        else
        {
          v78 = *(_DWORD *)(v110 - 4);
          *(_DWORD *)(v110 - 4) = v78 - 1;
        }
        if ( v78 <= 0 )
          std::string::_Rep::_M_destroy(v29, &v85);
      }
    }
    else
    {
      std::string::assign((std::string *)&v88, (const std::string *)(v26 + 40));
    }
    v91 = (int)&unk_80CF5DC;
    v102 = (int)&unk_80CF5F0;
    v92 = (int)&unk_80CF588;
    v30 = v101 - 12;
    if ( (_DWORD *)(v101 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v77 = _InterlockedExchangeAdd((volatile signed __int32 *)(v101 - 4), 0xFFFFFFFF);
      }
      else
      {
        v77 = *(_DWORD *)(v101 - 4);
        *(_DWORD *)(v101 - 4) = v77 - 1;
      }
      if ( v77 <= 0 )
        std::string::_Rep::_M_destroy(v30, &v110);
    }
    v92 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v99);
    v91 = dword_80CF674;
    *(int *)((char *)&v91 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v102 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v102);
    if ( byte_80CE64C )
    {
      v31 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v88, *(_DWORD *)(v88 - 12));
      v32 = (std::ostream *)v31;
      v33 = *(_DWORD *)(*(_DWORD *)v31 - 12);
      v34 = *(_DWORD *)((char *)v32 + v33 + 124);
      if ( !v34 )
      {
        v70 = std::__throw_bad_cast();
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(v22);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v91);
        std::string::_Rep::_M_dispose(v84 - 12, &v91);
        goto LABEL_102;
      }
      if ( *(_BYTE *)(v34 + 28) )
      {
        v35 = *(_BYTE *)(v34 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v32 + v33 + 124));
        v35 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v34 + 24))(v34, 10);
      }
      v36 = (std::ostream *)std::ostream::put(v32, v35);
      std::ostream::flush(v36);
    }
    syslog(7, "%s", v88, v79);
    v37 = v88 - 12;
    if ( (_DWORD *)(v88 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v68 = _InterlockedExchangeAdd((volatile signed __int32 *)(v88 - 4), 0xFFFFFFFF);
      }
      else
      {
        v71 = *(_DWORD *)(v88 - 4);
        *(_DWORD *)(v88 - 4) = v71 - 1;
        v68 = v71;
      }
      if ( v68 <= 0 )
        std::string::_Rep::_M_destroy(v37, &v110);
    }
    v3 = a2;
LABEL_12:
    if ( *(_DWORD *)(dword_80CF890 - 12) || *(_DWORD *)(*(_DWORD *)a3 - 12) )
    {
      sub_80A9B50(a1, v3, a3);
      v19 = v81 == 0;
      if ( !v81 )
      {
LABEL_39:
        _InterlockedDecrement((volatile signed __int32 *)(v80 + 4));
        if ( v19 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v80 + 4))(v80);
        return;
      }
    }
    else
    {
      ++*(_DWORD *)(a1 + 100);
      v10 = *(_DWORD *)(v3 + 28);
      if ( v10 && (v11 = *(_DWORD *)(v10 + 32)) != 0 )
        std::string::string(&v84, *(_DWORD *)(v10 + 28), v11, &v82);
      else
        std::string::string((std::string *)&v84, (const std::string *)&dword_80CF8FC);
      v12 = *(_DWORD *)(a1 + 4);
      if ( v12 != a1 )
      {
        v13 = v84;
        v14 = *((_DWORD *)v84 - 3);
        while ( 1 )
        {
          v15 = *(const void **)(v12 + 20);
          if ( v14 == *((_DWORD *)v15 - 3) && !memcmp(v13, v15, v14) )
            break;
          v12 = *(_DWORD *)(v12 + 4);
          if ( a1 == v12 )
            goto LABEL_61;
        }
        if ( log_level > 1 )
          goto LABEL_23;
        std::ios_base::ios_base((std::ios_base *)&v121);
        v121 = (int)&unk_80CF5C8;
        v122 = 0;
        v123 = 0;
        v124 = 0;
        v125 = 0;
        v126 = 0;
        v127 = 0;
        v128 = 0;
        v53 = dword_80CF674;
        v110 = dword_80CF674;
        *(int *)((char *)&v110 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        std::basic_ios<char,std::char_traits<char>>::init((char *)&v110 + *(_DWORD *)(v110 - 12), 0);
        v110 = (int)&unk_80CF5DC;
        v121 = (int)&unk_80CF5F0;
        v111 = (int)&unk_80CF7F0;
        v112 = 0;
        v113 = 0;
        v114 = 0;
        v115 = 0;
        v116 = 0;
        v117 = 0;
        std::locale::locale((std::locale *)&v118);
        v111 = (int)&unk_80CF588;
        v119 = 16;
        v120 = (int)&unk_80CF83C;
        std::basic_ios<char,std::char_traits<char>>::init(&v121, &v111);
        v54 = std::__ostream_insert<char,std::char_traits<char>>(
                &v110,
                &unk_80CF83C,
                std::string::_Rep::_S_empty_rep_storage);
        std::__ostream_insert<char,std::char_traits<char>>(v54, "dns reuse: ", 11);
        v55 = std::__ostream_insert<char,std::char_traits<char>>(v54, v84, *((_DWORD *)v84 - 3));
        v88 = (int)&unk_80CF83C;
        v56 = *(_DWORD *)(v55 + 24);
        if ( v56 )
        {
          v57 = *(_DWORD *)(v55 + 16);
          LOBYTE(v79) = 0;
          if ( v56 <= (unsigned int)v57 )
          {
            v91 = std::string::_S_construct<char *>(
                    v54,
                    (unsigned int)&v110,
                    (void *)v53,
                    *(_DWORD *)(v55 + 20),
                    v57,
                    (int)&v86);
            std::string::swap((std::string *)&v88, (std::string *)&v91);
          }
          else
          {
            v91 = std::string::_S_construct<char *>(
                    v54,
                    (unsigned int)&v110,
                    (void *)v53,
                    *(_DWORD *)(v55 + 20),
                    v56,
                    (int)&v86);
            std::string::swap((std::string *)&v88, (std::string *)&v91);
          }
          v58 = v91 - 12;
          if ( (_DWORD *)(v91 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v74 = _InterlockedExchangeAdd((volatile signed __int32 *)(v91 - 4), 0xFFFFFFFF);
            }
            else
            {
              v74 = *(_DWORD *)(v91 - 4);
              *(_DWORD *)(v91 - 4) = v74 - 1;
            }
            if ( v74 <= 0 )
              std::string::_Rep::_M_destroy(v58, &v85);
          }
        }
        else
        {
          std::string::assign((std::string *)&v88, (const std::string *)(v55 + 40));
        }
        v110 = (int)&unk_80CF5DC;
        v121 = (int)&unk_80CF5F0;
        v111 = (int)&unk_80CF588;
        v59 = v120 - 12;
        if ( (_DWORD *)(v120 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v73 = _InterlockedExchangeAdd((volatile signed __int32 *)(v120 - 4), 0xFFFFFFFF);
          }
          else
          {
            v73 = *(_DWORD *)(v120 - 4);
            *(_DWORD *)(v120 - 4) = v73 - 1;
          }
          if ( v73 <= 0 )
            std::string::_Rep::_M_destroy(v59, &v91);
        }
        v111 = (int)&unk_80CF7F0;
        std::locale::~locale((std::locale *)&v118);
        v110 = v53;
        *(int *)((char *)&v110 + *(_DWORD *)(v53 - 12)) = dword_80CF678;
        v121 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v121);
        if ( !byte_80CE64C )
        {
LABEL_89:
          syslog(7, "%s", v88, v79);
          v66 = v88 - 12;
          if ( (_DWORD *)(v88 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v67 = _InterlockedExchangeAdd((volatile signed __int32 *)(v88 - 4), 0xFFFFFFFF);
            }
            else
            {
              v67 = *(_DWORD *)(v88 - 4);
              *(_DWORD *)(v88 - 4) = v67 - 1;
            }
            if ( v67 <= 0 )
              std::string::_Rep::_M_destroy(v66, &v110);
          }
LABEL_23:
          v16 = *(_DWORD *)(v12 + 28);
          if ( v16 == *(_DWORD *)(v12 + 32) )
          {
            sub_80B1360(v12 + 24, (int)&a2);
          }
          else
          {
            if ( v16 )
            {
              *(_DWORD *)v16 = a2;
              v16 = *(_DWORD *)(v12 + 28);
            }
            *(_DWORD *)(v12 + 28) = v16 + 4;
          }
          v17 = v84 - 12;
          if ( (_DWORD *)(v84 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v69 = _InterlockedExchangeAdd((volatile signed __int32 *)v84 - 1, 0xFFFFFFFF);
            }
            else
            {
              v72 = *((_DWORD *)v84 - 1);
              *((_DWORD *)v84 - 1) = v72 - 1;
              v69 = v72;
            }
            if ( v69 <= 0 )
              std::string::_Rep::_M_destroy(v17, &v110);
          }
          v18 = v81 == 0;
          if ( v81 )
          {
            _InterlockedDecrement((volatile signed __int32 *)(v81 + 4));
            if ( !v81 )
              (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
          }
          _InterlockedDecrement((volatile signed __int32 *)(v80 + 4));
          if ( v18 )
            (*(void (__cdecl **)(int))(*(_DWORD *)v80 + 4))(v80);
          return;
        }
        v60 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v88, *(_DWORD *)(v88 - 12));
        v61 = (std::ostream *)v60;
        v62 = *(_DWORD *)(*(_DWORD *)v60 - 12);
        v63 = *(_DWORD *)((char *)v61 + v62 + 124);
        if ( v63 )
        {
          if ( *(_BYTE *)(v63 + 28) )
          {
            v64 = *(_BYTE *)(v63 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v61 + v62 + 124));
            v64 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v63 + 24))(v63, 10);
          }
          v65 = (std::ostream *)std::ostream::put(v61, v64);
          std::ostream::flush(v65);
          goto LABEL_89;
        }
        v70 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v88 - 12, &v110);
        std::string::_Rep::_M_dispose(v84 - 12, &v91);
LABEL_102:
        sub_8056F10(v81);
        sub_8056F10(v80);
        Unwind_Resume(v70);
      }
LABEL_61:
      v38 = operator new(0x24u);
      v39 = v38;
      v85 = a2;
      *(_DWORD *)(v38 + 4) = 0;
      *(_DWORD *)(v38 + 8) = 0;
      *(_DWORD *)v38 = &off_80BE398;
      *(_DWORD *)(v38 + 12) = a1;
      *(_DWORD *)(v38 + 16) = 0;
      v40 = (std::string *)(v38 + 20);
      v41 = *(_DWORD *)(v85 + 28);
      if ( v41 && (v42 = *(_DWORD *)(v41 + 32)) != 0 )
        std::string::string(v40, *(_DWORD *)(v41 + 28), v42, &v83);
      else
        std::string::string(v40, (const std::string *)&dword_80CF8FC);
      *(_DWORD *)(v39 + 24) = 0;
      *(_DWORD *)(v39 + 28) = 0;
      *(_DWORD *)(v39 + 32) = 0;
      sub_80B1360(v39 + 24, (int)&v85);
      if ( *(_DWORD *)(v39 + 8) || *(_DWORD *)(v39 + 4) )
        _assert("!item_hook->_prev_item && !item_hook->_next_item", "util/intrusive_list.h", 178);
      *(_DWORD *)(v39 + 8) = *(_DWORD *)(a1 + 8);
      *(_DWORD *)(v39 + 4) = a1;
      *(_DWORD *)(*(_DWORD *)(a1 + 8) + 4) = v39;
      *(_DWORD *)(a1 + 8) = v39;
      if ( *(_BYTE *)(v81 + 57) )
      {
        v43 = v84;
        v44 = sub_80A7DD0(a1);
        v45 = sub_807BE90(v44, v43, (int)sub_80AE840, v39);
        if ( v45 )
          *(_DWORD *)(v39 + 16) = v45;
      }
      else
      {
        v89 = 0;
        v48 = operator new(8u);
        *(_DWORD *)v48 = a1;
        *(_DWORD *)(v48 + 4) = v39;
        v88 = v48;
        v90 = sub_80AE810;
        v89 = sub_80A7990;
        v49 = *(_DWORD *)(a1 + 12);
        v50 = operator new(0x10u);
        v51 = v50;
        *(_DWORD *)(v50 + 8) = 0;
        v52 = v89;
        if ( v89 )
        {
          *(_DWORD *)(v51 + 12) = v90;
          *(_DWORD *)(v51 + 8) = v52;
          v89((void **)v51, (void **)&v88, 2);
        }
        v86 = 0;
        v87 = 0;
        event_base_once(*(_DWORD *)(v49 + 4), -1, 1, sub_8057E00, v51, &v86);
        if ( v89 )
          v89((void **)&v88, (void **)&v88, 3);
      }
      v46 = v84 - 12;
      if ( (_DWORD *)(v84 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v75 = _InterlockedExchangeAdd((volatile signed __int32 *)v84 - 1, 0xFFFFFFFF);
        }
        else
        {
          v76 = *((_DWORD *)v84 - 1);
          *((_DWORD *)v84 - 1) = v76 - 1;
          v75 = v76;
        }
        if ( v75 <= 0 )
          std::string::_Rep::_M_destroy(v46, &v110);
      }
    }
    v47 = _InterlockedDecrement((volatile signed __int32 *)(v81 + 4));
    v19 = v47 == 0;
    if ( !v47 )
      (*(void (__cdecl **)(int))(*(_DWORD *)v81 + 4))(v81);
    goto LABEL_39;
  }
  if ( !*(_DWORD *)(a1 + 92) || (v110 = 3, sub_80B1330(a1 + 84, a2, (int)&v110), (v3 = a2) != 0) )
    (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D310: using guessed type int __cdecl event_base_once(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80BE398: using guessed type void *off_80BE398;
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (080AB5A0) --------------------------------------------------------
int __cdecl sub_80AB5A0(int a1, int a2)
{
  int v2; // eax@1
  int v3; // ecx@1
  int v4; // edx@1
  int v5; // edx@3
  int result; // eax@5
  int v7; // edx@5
  int v8; // ecx@11
  char v9; // [sp+1Bh] [bp-11h]@10
  int v10; // [sp+1Ch] [bp-10h]@1

  v10 = (int)&unk_80CF83C;
  v2 = operator new(0x2Cu);
  v3 = *(_DWORD *)a2;
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)(v2 + 8) = 0;
  *(_DWORD *)v2 = &off_80BE388;
  *(_DWORD *)(v2 + 12) = &off_80BB6A0;
  *(_DWORD *)(v2 + 16) = v2 + 12;
  *(_DWORD *)(v2 + 20) = v2 + 12;
  v4 = *(_DWORD *)a2;
  *(_DWORD *)(v2 + 24) = *(_DWORD *)a2;
  if ( v4 )
    _InterlockedIncrement((volatile signed __int32 *)(v4 + 4));
  v5 = *(_DWORD *)(v3 + 16);
  *(_DWORD *)(v2 + 28) = v5;
  if ( v5 )
    _InterlockedIncrement((volatile signed __int32 *)(v5 + 4));
  *(_DWORD *)(v2 + 32) = 0;
  *(_DWORD *)(v2 + 36) = 0;
  *(_DWORD *)(v2 + 40) = 0;
  sub_80AA430(a1, v2, (std::string *)&v10);
  result = v10;
  v7 = v10 - 12;
  if ( (_DWORD *)(v10 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      result = _InterlockedExchangeAdd((volatile signed __int32 *)(v10 - 4), 0xFFFFFFFF);
    }
    else
    {
      v8 = *(_DWORD *)(v10 - 4);
      *(_DWORD *)(v10 - 4) = v8 - 1;
      result = v8;
    }
    if ( result <= 0 )
      result = std::string::_Rep::_M_destroy(v7, &v9);
  }
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80BB6A0: using guessed type int (__cdecl *off_80BB6A0)(int);
// 80BE388: using guessed type int (__cdecl *off_80BE388)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (080AB6A0) --------------------------------------------------------
unsigned int __cdecl sub_80AB6A0(int a1, int a2, int a3)
{
  int v3; // edi@1
  unsigned int result; // eax@1
  const std::string *v5; // esi@6
  unsigned int v6; // edx@6
  int v7; // eax@6
  int v8; // ebx@6
  std::string *v9; // ebx@9
  int v10; // eax@13
  signed int v11; // eax@14
  void **v12; // eax@15
  char *v13; // edx@15
  int v14; // edx@16
  int v15; // eax@17
  int v16; // esi@17
  int v17; // eax@17
  int v18; // eax@19
  unsigned int v19; // edi@21
  int v20; // ST1C_4@21
  void *v21; // ebx@21
  bool v22; // cl@22
  int v23; // edx@24
  int v24; // edx@25
  char *v25; // edx@26
  int v26; // edx@27
  int v27; // edx@28
  int v28; // edx@31
  void *v29; // esi@32
  void *v30; // ebx@32
  int v31; // eax@33
  int v32; // edx@33
  bool v33; // zf@38
  int v34; // eax@41
  bool v35; // zf@41
  char *v36; // edx@45
  signed __int32 v37; // eax@47
  signed __int32 v38; // ecx@56
  signed __int32 v39; // eax@61
  signed __int32 v40; // eax@65
  bool v41; // ST1C_1@67
  signed __int32 v42; // ecx@68
  signed __int32 v43; // ebx@69
  signed __int32 v44; // eax@71
  bool v45; // ST1C_1@73
  signed __int32 v46; // eax@75
  bool v47; // ST1C_1@77
  signed __int32 v48; // ebx@78
  signed __int32 v49; // ebx@79
  int v50; // ebx@80
  signed __int32 v51; // ecx@82
  signed __int32 v52; // eax@84
  bool v53; // ST1C_1@86
  signed __int32 v54; // eax@88
  bool v55; // ST1C_1@90
  signed __int32 v56; // ebx@91
  signed __int32 v57; // ebx@92
  signed __int32 v58; // edx@94
  bool v59; // ST1C_1@96
  signed __int32 v60; // esi@99
  signed __int32 v61; // esi@103
  int v62; // [sp+14h] [bp-64h]@0
  void *v63; // [sp+18h] [bp-60h]@7
  unsigned int v64; // [sp+1Ch] [bp-5Ch]@7
  int v65; // [sp+24h] [bp-54h]@3
  int v66; // [sp+28h] [bp-50h]@41
  int v67; // [sp+2Ch] [bp-4Ch]@15
  int v68; // [sp+30h] [bp-48h]@15
  int v69; // [sp+34h] [bp-44h]@21
  int v70; // [sp+38h] [bp-40h]@21
  void *s1; // [sp+3Ch] [bp-3Ch]@21
  int v72; // [sp+40h] [bp-38h]@21
  int v73; // [sp+44h] [bp-34h]@21
  void *s2; // [sp+48h] [bp-30h]@15
  int v75; // [sp+4Ch] [bp-2Ch]@3
  int v76; // [sp+50h] [bp-28h]@41
  void *v77; // [sp+54h] [bp-24h]@6
  void *v78; // [sp+58h] [bp-20h]@6
  char *v79; // [sp+5Ch] [bp-1Ch]@6

  v3 = *(_DWORD *)(a2 + 180);
  result = (*(_DWORD *)(v3 + 36) - *(_DWORD *)(v3 + 32)) >> 2;
  if ( *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v3 + 24) + 32) + 44) > result )
  {
    v75 = a3;
    sub_807B750((int)&v65, (int)&v75);
    if ( !v65 || !*(_DWORD *)(v65 + 32) || !*(_DWORD *)(v65 + 16) )
    {
      v76 = a3;
      sub_80B0E70((int)&v66, *(_DWORD *)(a2 + 4), (const char **)&v76);
      v34 = v65;
      v35 = v65 == 0;
      if ( v65 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v65 + 4));
        if ( v35 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v34 + 4))(v34);
      }
      v65 = v66;
    }
    v5 = *(const std::string **)(v3 + 32);
    v6 = *(_DWORD *)(v3 + 36);
    v7 = (*(_DWORD *)(v3 + 36) - (signed int)v5) >> 2;
    v8 = v7;
    v77 = 0;
    v78 = 0;
    v79 = 0;
    if ( v7 )
    {
      if ( (unsigned int)v7 > 0x3FFFFFFF )
      {
        v50 = std::__throw_bad_alloc();
        std::string::_Rep::_M_dispose((char *)s2 - 12, &v73);
        std::string::_Rep::_M_dispose(v67 - 12, &v66);
        sub_807B8A0(v62);
        sub_8056F10(v65);
        Unwind_Resume(v50);
      }
      v8 = 4 * v7;
      v63 = (void *)operator new(4 * v7);
      v64 = *(_DWORD *)(v3 + 36);
      v5 = *(const std::string **)(v3 + 32);
    }
    else
    {
      v64 = v6;
      v63 = 0;
    }
    v77 = v63;
    v78 = v63;
    v79 = (char *)v63 + v8;
    if ( (const std::string *)v64 == v5 )
    {
      v9 = (std::string *)v63;
    }
    else
    {
      v9 = (std::string *)v63;
      do
      {
        if ( v9 )
          std::string::string(v9, v5);
        v9 = (std::string *)((char *)v9 + 4);
        v5 = (const std::string *)((char *)v5 + 4);
      }
      while ( (const std::string *)v64 != v5 );
    }
    v78 = (void *)v9;
    v10 = *(_DWORD *)(a2 + 4);
    if ( v10 )
      v11 = *(_DWORD *)(v10 + 8);
    else
      v11 = 134986579;
    std::string::string(&v67, v11, &s2);
    v68 = (int)&unk_80CF83C;
    std::string::reserve((std::string *)&v68, *(_DWORD *)(*(_DWORD *)(a2 + 12) - 12) + 2);
    std::string::append((std::string *)&v68, " (", 2u);
    std::string::append((std::string *)&v68, (const std::string *)(a2 + 12));
    v12 = (void **)std::string::append((std::string *)&v68, ")", 1u);
    s2 = *v12;
    *v12 = &unk_80CF83C;
    std::string::append((std::string *)&v67, (const std::string *)&s2);
    v13 = (char *)s2 - 12;
    if ( (_DWORD *)((char *)s2 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v61 = _InterlockedExchangeAdd((volatile signed __int32 *)s2 - 1, 0xFFFFFFFF);
      }
      else
      {
        v61 = *((_DWORD *)s2 - 1);
        *((_DWORD *)s2 - 1) = v61 - 1;
      }
      if ( v61 <= 0 )
        std::string::_Rep::_M_destroy(v13, &v73);
    }
    v14 = v68 - 12;
    if ( (_DWORD *)(v68 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v60 = _InterlockedExchangeAdd((volatile signed __int32 *)(v68 - 4), 0xFFFFFFFF);
      }
      else
      {
        v60 = *(_DWORD *)(v68 - 4);
        *(_DWORD *)(v68 - 4) = v60 - 1;
      }
      if ( v60 <= 0 )
        std::string::_Rep::_M_destroy(v14, &s2);
    }
    sub_80B1640((int)&v77, (int)&v67);
    v15 = operator new(0x2Cu);
    v16 = v15;
    *(_DWORD *)(v15 + 4) = 0;
    *(_DWORD *)(v15 + 8) = 0;
    *(_DWORD *)v15 = &off_80BE388;
    *(_DWORD *)(v15 + 12) = &off_80BB6A0;
    v15 += 12;
    *(_DWORD *)(v16 + 16) = v15;
    *(_DWORD *)(v16 + 20) = v15;
    v17 = *(_DWORD *)(v3 + 24);
    *(_DWORD *)(v16 + 24) = v17;
    if ( v17 )
      _InterlockedIncrement((volatile signed __int32 *)(v17 + 4));
    v18 = v65;
    *(_DWORD *)(v16 + 28) = v65;
    if ( v18 )
      _InterlockedIncrement((volatile signed __int32 *)(v18 + 4));
    *(_DWORD *)(v16 + 32) = v77;
    v77 = 0;
    *(_DWORD *)(v16 + 36) = v78;
    v78 = 0;
    *(_DWORD *)(v16 + 40) = v79;
    v79 = 0;
    sub_808AF20((int)&v73, (int)&v65);
    v19 = std::string::find_last_not_of((std::string *)&v73, ".", 0xFFFFFFFF, 1u) + 1;
    sub_808AF20((int)&v72, (int)&v65);
    std::string::string((std::string *)&s2, (const std::string *)&v72, 0, v19);
    sub_808AF20((int)&v70, a2 + 4);
    v20 = std::string::find_last_not_of((std::string *)&v70, ".", 0xFFFFFFFF, 1u) + 1;
    sub_808AF20((int)&v69, a2 + 4);
    std::string::string((std::string *)&s1, (const std::string *)&v69, 0, v20);
    v21 = s1;
    if ( *((_DWORD *)s1 - 3) == *((_DWORD *)s2 - 3) )
      v22 = memcmp(s1, s2, *((_DWORD *)s1 - 3)) == 0;
    else
      v22 = 0;
    if ( (_DWORD *)((char *)v21 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v58 = _InterlockedExchangeAdd((volatile signed __int32 *)v21 - 1, 0xFFFFFFFF);
      }
      else
      {
        v58 = *((_DWORD *)v21 - 1);
        *((_DWORD *)v21 - 1) = v58 - 1;
      }
      if ( v58 <= 0 )
      {
        v59 = v22;
        std::string::_Rep::_M_destroy((char *)v21 - 12, &v68);
        v22 = v59;
      }
    }
    v23 = v69 - 12;
    if ( (_DWORD *)(v69 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v54 = _InterlockedExchangeAdd((volatile signed __int32 *)(v69 - 4), 0xFFFFFFFF);
      }
      else
      {
        v57 = *(_DWORD *)(v69 - 4);
        *(_DWORD *)(v69 - 4) = v57 - 1;
        v54 = v57;
      }
      if ( v54 <= 0 )
      {
        v55 = v22;
        std::string::_Rep::_M_destroy(v23, &s1);
        v22 = v55;
      }
    }
    v24 = v70 - 12;
    if ( (_DWORD *)(v70 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v52 = _InterlockedExchangeAdd((volatile signed __int32 *)(v70 - 4), 0xFFFFFFFF);
      }
      else
      {
        v56 = *(_DWORD *)(v70 - 4);
        *(_DWORD *)(v70 - 4) = v56 - 1;
        v52 = v56;
      }
      if ( v52 <= 0 )
      {
        v53 = v22;
        std::string::_Rep::_M_destroy(v24, &s1);
        v22 = v53;
      }
    }
    v25 = (char *)s2 - 12;
    if ( (_DWORD *)((char *)s2 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v46 = _InterlockedExchangeAdd((volatile signed __int32 *)s2 - 1, 0xFFFFFFFF);
      }
      else
      {
        v49 = *((_DWORD *)s2 - 1);
        *((_DWORD *)s2 - 1) = v49 - 1;
        v46 = v49;
      }
      if ( v46 <= 0 )
      {
        v47 = v22;
        std::string::_Rep::_M_destroy(v25, &s1);
        v22 = v47;
      }
    }
    v26 = v72 - 12;
    if ( (_DWORD *)(v72 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v44 = _InterlockedExchangeAdd((volatile signed __int32 *)(v72 - 4), 0xFFFFFFFF);
      }
      else
      {
        v48 = *(_DWORD *)(v72 - 4);
        *(_DWORD *)(v72 - 4) = v48 - 1;
        v44 = v48;
      }
      if ( v44 <= 0 )
      {
        v45 = v22;
        std::string::_Rep::_M_destroy(v26, &s2);
        v22 = v45;
      }
    }
    v27 = v73 - 12;
    if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
      }
      else
      {
        v43 = *(_DWORD *)(v73 - 4);
        *(_DWORD *)(v73 - 4) = v43 - 1;
        v40 = v43;
      }
      if ( v40 <= 0 )
      {
        v41 = v22;
        std::string::_Rep::_M_destroy(v27, &s2);
        v22 = v41;
      }
    }
    if ( v22 )
    {
      sub_80AA430(a1, v16, (std::string *)(a2 + 12));
    }
    else
    {
      s2 = &unk_80CF83C;
      sub_80AA430(a1, v16, (std::string *)&s2);
      v36 = (char *)s2 - 12;
      if ( (_DWORD *)((char *)s2 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v37 = _InterlockedExchangeAdd((volatile signed __int32 *)s2 - 1, 0xFFFFFFFF);
        }
        else
        {
          v51 = *((_DWORD *)s2 - 1);
          *((_DWORD *)s2 - 1) = v51 - 1;
          v37 = v51;
        }
        if ( v37 <= 0 )
          std::string::_Rep::_M_destroy(v36, &v73);
      }
    }
    v28 = v67 - 12;
    if ( (_DWORD *)(v67 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v39 = _InterlockedExchangeAdd((volatile signed __int32 *)(v67 - 4), 0xFFFFFFFF);
      }
      else
      {
        v42 = *(_DWORD *)(v67 - 4);
        *(_DWORD *)(v67 - 4) = v42 - 1;
        v39 = v42;
      }
      if ( v39 <= 0 )
        std::string::_Rep::_M_destroy(v28, &s2);
    }
    v29 = v78;
    v30 = v77;
    if ( v78 != v77 )
    {
      do
      {
        v31 = *(_DWORD *)v30;
        v32 = *(_DWORD *)v30 - 12;
        if ( (_DWORD *)v32 != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v31 - 4), 0xFFFFFFFF);
          }
          else
          {
            v38 = *(_DWORD *)(v31 - 4);
            *(_DWORD *)(v31 - 4) = v38 - 1;
          }
          if ( v38 <= 0 )
            std::string::_Rep::_M_destroy(v32, &s2);
        }
        v30 = (char *)v30 + 4;
      }
      while ( v29 != v30 );
      v29 = v77;
    }
    if ( v29 )
      operator delete(v29);
    result = v65;
    v33 = v65 == 0;
    if ( v65 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(v65 + 4));
      if ( v33 )
        result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
    }
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 80BB6A0: using guessed type int (__cdecl *off_80BB6A0)(int);
// 80BE388: using guessed type int (__cdecl *off_80BE388)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (080AC000) --------------------------------------------------------
int __cdecl sub_80AC000(int a1)
{
  int v1; // eax@1
  int v2; // edx@2
  int result; // eax@4
  void *v4; // edi@4
  unsigned int v5; // ebp@4
  int v6; // edx@5
  int v7; // esi@8
  int v8; // ecx@10
  int v9; // edx@11
  int v10; // edx@13
  int v11; // esi@30
  int v12; // esi@30
  int v13; // esi@30
  int v14; // esi@30
  int v15; // eax@30
  int v16; // edx@30
  int v17; // ecx@31
  int v18; // eax@32
  int v19; // edx@32
  int v20; // edx@33
  std::ostream *v21; // esi@35
  char v22; // al@37
  std::ostream *v23; // eax@38
  int v24; // edx@39
  signed __int32 v25; // ecx@41
  signed __int32 v26; // ecx@46
  unsigned int v27; // ebp@49
  int v28; // esi@49
  int v29; // edi@49
  int v30; // ebx@49
  int v31; // ebx@49
  int v32; // ebx@49
  int v33; // eax@49
  int v34; // edx@50
  int v35; // ebx@52
  int v36; // ebx@53
  int v37; // eax@55
  std::ostream *v38; // esi@55
  int v39; // eax@55
  int v40; // ebx@55
  char v41; // al@57
  std::ostream *v42; // eax@58
  int v43; // ecx@59
  signed __int32 v44; // edx@71
  signed __int32 v45; // ecx@76
  signed __int32 v46; // edx@83
  int v47; // ebx@87
  int v48; // edx@92
  int v49; // [sp+Ch] [bp-140h]@0
  int v50; // [sp+10h] [bp-13Ch]@2
  int v51; // [sp+10h] [bp-13Ch]@24
  int v52; // [sp+10h] [bp-13Ch]@35
  int v53; // [sp+14h] [bp-138h]@1
  int v54; // [sp+18h] [bp-134h]@4
  int v55; // [sp+1Ch] [bp-130h]@7
  char v56; // [sp+32h] [bp-11Ah]@85
  char v57; // [sp+33h] [bp-119h]@48
  int v58; // [sp+34h] [bp-118h]@32
  int v59; // [sp+38h] [bp-114h]@30
  int v60; // [sp+3Ch] [bp-110h]@23
  int v61; // [sp+50h] [bp-FCh]@23
  int v62; // [sp+58h] [bp-F4h]@23
  int v63; // [sp+7Ch] [bp-D0h]@30
  int v64; // [sp+80h] [bp-CCh]@30
  int v65; // [sp+84h] [bp-C8h]@30
  int v66; // [sp+88h] [bp-C4h]@30
  int v67; // [sp+8Ch] [bp-C0h]@30
  int v68; // [sp+90h] [bp-BCh]@30
  int v69; // [sp+94h] [bp-B8h]@30
  int v70; // [sp+98h] [bp-B4h]@30
  char v71; // [sp+9Ch] [bp-B0h]@30
  int v72; // [sp+A0h] [bp-ACh]@30
  int v73; // [sp+A4h] [bp-A8h]@30
  int v74; // [sp+A8h] [bp-A4h]@30
  int v75; // [sp+118h] [bp-34h]@30
  char v76; // [sp+11Ch] [bp-30h]@30
  char v77; // [sp+11Dh] [bp-2Fh]@30
  int v78; // [sp+120h] [bp-2Ch]@30
  int v79; // [sp+124h] [bp-28h]@30
  int v80; // [sp+128h] [bp-24h]@30
  int v81; // [sp+12Ch] [bp-20h]@30

  v1 = *(_DWORD *)(a1 + 36);
  v53 = a1 + 32;
  if ( v1 == a1 + 32 )
  {
    result = *(_DWORD *)(a1 + 48);
    v4 = (void *)(a1 + 44);
    if ( result == a1 + 44 )
      return result;
    v5 = *(_DWORD *)(a1 + 104);
    v54 = *(_DWORD *)(a1 + 108);
    v50 = *(_DWORD *)(a1 + 104);
  }
  else
  {
    v50 = *(_DWORD *)(a1 + 104);
    v2 = 0;
    do
    {
      ++v2;
      v1 = *(_DWORD *)(v1 + 4);
    }
    while ( v53 != v1 );
    result = *(_DWORD *)(a1 + 48);
    v4 = (void *)(a1 + 44);
    v5 = v50 - v2;
    v54 = *(_DWORD *)(a1 + 108);
    if ( result == a1 + 44 )
    {
      v6 = 0;
      goto LABEL_7;
    }
  }
  v6 = 0;
  do
  {
    ++v6;
    result = *(_DWORD *)(result + 4);
  }
  while ( (void *)result != v4 );
LABEL_7:
  v55 = v54 - v6;
  if ( log_level <= 1 )
  {
    std::ios_base::ios_base((std::ios_base *)&v74);
    v74 = (int)&unk_80CF5C8;
    v75 = 0;
    v76 = 0;
    v77 = 0;
    v78 = 0;
    v79 = 0;
    v80 = 0;
    v81 = 0;
    v63 = dword_80CF674;
    *(int *)((char *)&v63 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v63 + *(_DWORD *)(v63 - 12), 0);
    v63 = (int)&unk_80CF5DC;
    v74 = (int)&unk_80CF5F0;
    v64 = (int)&unk_80CF7F0;
    v65 = 0;
    v66 = 0;
    v67 = 0;
    v68 = 0;
    v69 = 0;
    v70 = 0;
    std::locale::locale((std::locale *)&v71);
    v64 = (int)&unk_80CF588;
    v72 = 16;
    v73 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v74, &v64);
    v11 = std::__ostream_insert<char,std::char_traits<char>>(
            &v63,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v11, "active http: ", 13);
    v12 = std::ostream::operator<<(v11, v5);
    std::__ostream_insert<char,std::char_traits<char>>(v12, 134981720, 1);
    v13 = std::ostream::operator<<(v12, v50);
    std::__ostream_insert<char,std::char_traits<char>>(v13, " https: ", 8);
    v14 = std::ostream::operator<<(v13, v55);
    std::__ostream_insert<char,std::char_traits<char>>(v14, 134981720, 1);
    v15 = std::ostream::operator<<(v14, v54);
    v59 = (int)&unk_80CF83C;
    v16 = *(_DWORD *)(v15 + 24);
    if ( v16 )
    {
      v17 = *(_DWORD *)(v15 + 16);
      LOBYTE(v49) = 0;
      if ( v16 <= (unsigned int)v17 )
      {
        v60 = std::string::_S_construct<char *>(a1, v5, v4, *(_DWORD *)(v15 + 20), v17, (int)&v58);
        std::string::swap((std::string *)&v59, (std::string *)&v60);
        v18 = v60;
        v19 = v60 - 12;
        if ( (_DWORD *)(v60 - 12) == &std::string::_Rep::_S_empty_rep_storage )
          goto LABEL_33;
        if ( &_pthread_key_create )
        {
          v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v60 - 4), 0xFFFFFFFF);
          goto LABEL_47;
        }
LABEL_89:
        v26 = *(_DWORD *)(v18 - 4);
        *(_DWORD *)(v18 - 4) = v26 - 1;
LABEL_47:
        if ( v26 <= 0 )
          std::string::_Rep::_M_destroy(v19, &v57);
        goto LABEL_33;
      }
      v60 = std::string::_S_construct<char *>(a1, v5, v4, *(_DWORD *)(v15 + 20), v16, (int)&v58);
      std::string::swap((std::string *)&v59, (std::string *)&v60);
      v18 = v60;
      v19 = v60 - 12;
      if ( (_DWORD *)(v60 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v26 = _InterlockedExchangeAdd((volatile signed __int32 *)(v60 - 4), 0xFFFFFFFF);
          goto LABEL_47;
        }
        goto LABEL_89;
      }
    }
    else
    {
      std::string::assign((std::string *)&v59, (const std::string *)(v15 + 40));
    }
LABEL_33:
    v63 = (int)&unk_80CF5DC;
    v74 = (int)&unk_80CF5F0;
    v64 = (int)&unk_80CF588;
    v20 = v73 - 12;
    if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v45 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
      }
      else
      {
        v45 = *(_DWORD *)(v73 - 4);
        *(_DWORD *)(v73 - 4) = v45 - 1;
      }
      if ( v45 <= 0 )
        std::string::_Rep::_M_destroy(v20, &v60);
    }
    v64 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v71);
    v63 = dword_80CF674;
    *(int *)((char *)&v63 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v74 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v74);
    if ( byte_80CE64C )
    {
      v21 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v59, *(_DWORD *)(v59 - 12));
      v52 = *(_DWORD *)((char *)v21 + *(_DWORD *)(*(_DWORD *)v21 - 12) + 124);
      if ( !v52 )
      {
        v47 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v59 - 12, &v63);
        goto LABEL_88;
      }
      if ( *(_BYTE *)(v52 + 28) )
      {
        v22 = *(_BYTE *)(v52 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(v52);
        v22 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v52 + 24))(v52, 10);
      }
      v23 = (std::ostream *)std::ostream::put(v21, v22);
      std::ostream::flush(v23);
    }
    syslog(7, "%s", v59, v49);
    v24 = v59 - 12;
    if ( (_DWORD *)(v59 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v25 = _InterlockedExchangeAdd((volatile signed __int32 *)(v59 - 4), 0xFFFFFFFF);
      }
      else
      {
        v25 = *(_DWORD *)(v59 - 4);
        *(_DWORD *)(v59 - 4) = v25 - 1;
      }
      if ( v25 <= 0 )
        std::string::_Rep::_M_destroy(v24, &v63);
    }
  }
  v7 = v55;
  while ( 1 )
  {
    result = v5 + v7;
    if ( (signed int)(v5 + v7) >= dword_80CF85C )
      return result;
    if ( result > 10 )
    {
      sysinfo((struct sysinfo *)&v60);
      result = v61 + v62;
      if ( (unsigned int)(v61 + v62) <= 0x1E847F )
        break;
    }
    if ( v4 != *(void **)(a1 + 48) && v7 < dword_80CF858 )
    {
      ++v7;
      result = *(_DWORD *)(a1 + 48);
      if ( !result )
      {
        v8 = 0;
        goto LABEL_11;
      }
    }
    else
    {
      result = *(_DWORD *)(a1 + 36);
      if ( v53 == result )
        return result;
      ++v5;
      if ( !result )
      {
        v8 = 0;
        result = 0;
        goto LABEL_11;
      }
    }
    v8 = result - 128;
    if ( result == 128 )
      result = 0;
LABEL_11:
    v9 = *(_DWORD *)(result + 4);
    if ( v9 )
      *(_DWORD *)(v9 + 8) = *(_DWORD *)(result + 8);
    v10 = *(_DWORD *)(result + 8);
    if ( v10 )
      *(_DWORD *)(v10 + 4) = *(_DWORD *)(result + 4);
    *(_DWORD *)(result + 4) = 0;
    *(_DWORD *)(result + 8) = 0;
    sub_80A8AC0(a1, v8);
  }
  v51 = v61 + v62;
  if ( log_level > 1 )
    return result;
  v27 = (unsigned int)result >> 10;
  std::ios_base::ios_base((std::ios_base *)&v74);
  v74 = (int)&unk_80CF5C8;
  v75 = 0;
  v76 = 0;
  v77 = 0;
  v78 = 0;
  v79 = 0;
  v80 = 0;
  v81 = 0;
  v28 = dword_80CF674;
  v63 = dword_80CF674;
  v29 = dword_80CF678;
  *(int *)((char *)&v63 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v63 + *(_DWORD *)(v63 - 12), 0);
  v63 = (int)&unk_80CF5DC;
  v74 = (int)&unk_80CF5F0;
  v64 = (int)&unk_80CF7F0;
  v65 = 0;
  v66 = 0;
  v67 = 0;
  v68 = 0;
  v69 = 0;
  v70 = 0;
  std::locale::locale((std::locale *)&v71);
  v64 = (int)&unk_80CF588;
  v72 = 16;
  v73 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v74, &v64);
  v30 = std::__ostream_insert<char,std::char_traits<char>>(&v63, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v30, "not enough memory ", 18);
  v31 = std::ostream::_M_insert<unsigned long>(v30, v51);
  std::__ostream_insert<char,std::char_traits<char>>(v31, " (", 2);
  v32 = std::ostream::_M_insert<unsigned long>(v31, v27);
  std::__ostream_insert<char,std::char_traits<char>>(v32, " KB) to start new query...", 26);
  v58 = (int)&unk_80CF83C;
  v33 = *(_DWORD *)(v32 + 24);
  if ( v33 )
  {
    v34 = *(_DWORD *)(v32 + 16);
    LOBYTE(v49) = 0;
    if ( v33 <= (unsigned int)v34 )
    {
      v59 = std::string::_S_construct<char *>(
              v32,
              (unsigned int)&v57,
              (void *)v29,
              *(_DWORD *)(v32 + 20),
              v34,
              (int)&v57);
      std::string::swap((std::string *)&v58, (std::string *)&v59);
    }
    else
    {
      v59 = std::string::_S_construct<char *>(
              v32,
              (unsigned int)&v57,
              (void *)v29,
              *(_DWORD *)(v32 + 20),
              v33,
              (int)&v57);
      std::string::swap((std::string *)&v58, (std::string *)&v59);
    }
    v35 = v59 - 12;
    if ( (_DWORD *)(v59 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v59 - 4), 0xFFFFFFFF);
      }
      else
      {
        v46 = *(_DWORD *)(v59 - 4);
        *(_DWORD *)(v59 - 4) = v46 - 1;
      }
      if ( v46 <= 0 )
        std::string::_Rep::_M_destroy(v35, &v56);
    }
  }
  else
  {
    std::string::assign((std::string *)&v58, (const std::string *)(v32 + 40));
  }
  v63 = (int)&unk_80CF5DC;
  v74 = (int)&unk_80CF5F0;
  v64 = (int)&unk_80CF588;
  v36 = v73 - 12;
  if ( (_DWORD *)(v73 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v44 = _InterlockedExchangeAdd((volatile signed __int32 *)(v73 - 4), 0xFFFFFFFF);
    }
    else
    {
      v44 = *(_DWORD *)(v73 - 4);
      *(_DWORD *)(v73 - 4) = v44 - 1;
    }
    if ( v44 <= 0 )
      std::string::_Rep::_M_destroy(v36, &v59);
  }
  v64 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v71);
  v63 = v28;
  *(int *)((char *)&v63 + *(_DWORD *)(v28 - 12)) = v29;
  v74 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v74);
  if ( byte_80CE64C )
  {
    v37 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v58, *(_DWORD *)(v58 - 12));
    v38 = (std::ostream *)v37;
    v39 = *(_DWORD *)(*(_DWORD *)v37 - 12);
    v40 = *(_DWORD *)((char *)v38 + v39 + 124);
    if ( v40 )
    {
      if ( *(_BYTE *)(v40 + 28) )
      {
        v41 = *(_BYTE *)(v40 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v38 + v39 + 124));
        v41 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v40 + 24))(v40, 10);
      }
      v42 = (std::ostream *)std::ostream::put(v38, v41);
      std::ostream::flush(v42);
      goto LABEL_59;
    }
    v47 = std::__throw_bad_cast();
    std::string::_Rep::_M_dispose(v58 - 12, &v63);
LABEL_88:
    Unwind_Resume(v47);
  }
LABEL_59:
  syslog(7, "%s", v58, v49);
  result = v58;
  v43 = v58 - 12;
  if ( (_DWORD *)(v58 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      result = _InterlockedExchangeAdd((volatile signed __int32 *)(v58 - 4), 0xFFFFFFFF);
    }
    else
    {
      v48 = *(_DWORD *)(v58 - 4);
      *(_DWORD *)(v58 - 4) = v48 - 1;
      result = v48;
    }
    if ( result <= 0 )
      result = std::string::_Rep::_M_destroy(v43, &v63);
  }
  return result;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF858: using guessed type int dword_80CF858;
// 80CF85C: using guessed type int dword_80CF85C;
// 80CF874: using guessed type int log_level;

//----- (080ACCA0) --------------------------------------------------------
int __cdecl sub_80ACCA0(int a1, int a2, char a3)
{
  int v3; // eax@1
  int v4; // eax@3
  int v5; // ebx@5
  int result; // eax@11
  bool v7; // zf@11
  int v8; // esi@16
  int v9; // edi@16
  int v10; // eax@16
  int v11; // edx@17
  int v12; // edx@19
  int v13; // edx@20
  int v14; // eax@22
  std::ostream *v15; // edi@22
  int v16; // eax@22
  int v17; // esi@22
  char v18; // al@24
  std::ostream *v19; // eax@25
  int v20; // edx@26
  signed __int32 v21; // ecx@35
  signed __int32 v22; // ecx@39
  int v23; // esi@45
  int v24; // ecx@46
  int v25; // [sp+Ch] [bp-F0h]@0
  char v26; // [sp+22h] [bp-DAh]@41
  char v27; // [sp+23h] [bp-D9h]@18
  int v28; // [sp+24h] [bp-D8h]@16
  int v29; // [sp+28h] [bp-D4h]@18
  int v30; // [sp+2Ch] [bp-D0h]@16
  int v31; // [sp+30h] [bp-CCh]@16
  int v32; // [sp+34h] [bp-C8h]@16
  int v33; // [sp+38h] [bp-C4h]@16
  int v34; // [sp+3Ch] [bp-C0h]@16
  int v35; // [sp+40h] [bp-BCh]@16
  int v36; // [sp+44h] [bp-B8h]@16
  int v37; // [sp+48h] [bp-B4h]@16
  char v38; // [sp+4Ch] [bp-B0h]@16
  int v39; // [sp+50h] [bp-ACh]@16
  int v40; // [sp+54h] [bp-A8h]@16
  int v41; // [sp+58h] [bp-A4h]@16
  int v42; // [sp+C8h] [bp-34h]@16
  char v43; // [sp+CCh] [bp-30h]@16
  char v44; // [sp+CDh] [bp-2Fh]@16
  int v45; // [sp+D0h] [bp-2Ch]@16
  int v46; // [sp+D4h] [bp-28h]@16
  int v47; // [sp+D8h] [bp-24h]@16
  int v48; // [sp+DCh] [bp-20h]@16

  v3 = *(_DWORD *)(a2 + 4);
  if ( v3 )
    *(_DWORD *)(v3 + 8) = *(_DWORD *)(a2 + 8);
  v4 = *(_DWORD *)(a2 + 8);
  if ( v4 )
    *(_DWORD *)(v4 + 4) = *(_DWORD *)(a2 + 4);
  *(_DWORD *)(a2 + 4) = 0;
  *(_DWORD *)(a2 + 8) = 0;
  sub_80AC000(a1);
  v5 = *(_DWORD *)(a2 + 24);
  if ( v5 )
    _InterlockedIncrement((volatile signed __int32 *)(v5 + 4));
  v7 = (*(_DWORD *)(v5 + 36))-- == 1;
  if ( v7 )
    --*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a2 + 24) + 32) + 64);
  if ( *(_DWORD *)(a1 + 92) )
    sub_80B1330(a1 + 84, a2, (int)&a3);
  (*(void (__cdecl **)(int))(*(_DWORD *)a2 + 4))(a2);
  result = a1 + 20;
  v7 = *(_DWORD *)(a1 + 24) == a1 + 20;
  if ( *(_DWORD *)(a1 + 24) == a1 + 20 )
  {
    v7 = log_level == 2;
    if ( log_level <= 2 )
    {
      std::ios_base::ios_base((std::ios_base *)&v41);
      v41 = (int)&unk_80CF5C8;
      v42 = 0;
      v43 = 0;
      v44 = 0;
      v45 = 0;
      v46 = 0;
      v47 = 0;
      v48 = 0;
      v8 = dword_80CF674;
      v30 = dword_80CF674;
      *(int *)((char *)&v30 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v30 + *(_DWORD *)(v30 - 12), 0);
      v30 = (int)&unk_80CF5DC;
      v41 = (int)&unk_80CF5F0;
      v31 = (int)&unk_80CF7F0;
      v32 = 0;
      v33 = 0;
      v34 = 0;
      v35 = 0;
      v36 = 0;
      v37 = 0;
      std::locale::locale((std::locale *)&v38);
      v31 = (int)&unk_80CF588;
      v39 = 16;
      v40 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v41, &v31);
      v9 = std::__ostream_insert<char,std::char_traits<char>>(
             &v30,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v9, "no jobs left", 12);
      v28 = (int)&unk_80CF83C;
      v10 = *(_DWORD *)(v9 + 24);
      if ( v10 )
      {
        v11 = *(_DWORD *)(v9 + 16);
        LOBYTE(v25) = 0;
        if ( v10 <= (unsigned int)v11 )
        {
          v29 = std::string::_S_construct<char *>(
                  v5,
                  (unsigned int)&v41,
                  (void *)v9,
                  *(_DWORD *)(v9 + 20),
                  v11,
                  (int)&v27);
          std::string::swap((std::string *)&v28, (std::string *)&v29);
        }
        else
        {
          v29 = std::string::_S_construct<char *>(
                  v5,
                  (unsigned int)&v41,
                  (void *)v9,
                  *(_DWORD *)(v9 + 20),
                  v10,
                  (int)&v27);
          std::string::swap((std::string *)&v28, (std::string *)&v29);
        }
        v12 = v29 - 12;
        if ( (_DWORD *)(v29 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v22 = _InterlockedExchangeAdd((volatile signed __int32 *)(v29 - 4), 0xFFFFFFFF);
          }
          else
          {
            v22 = *(_DWORD *)(v29 - 4);
            *(_DWORD *)(v29 - 4) = v22 - 1;
          }
          if ( v22 <= 0 )
            std::string::_Rep::_M_destroy(v12, &v26);
        }
      }
      else
      {
        std::string::assign((std::string *)&v28, (const std::string *)(v9 + 40));
      }
      v30 = (int)&unk_80CF5DC;
      v41 = (int)&unk_80CF5F0;
      v31 = (int)&unk_80CF588;
      v13 = v40 - 12;
      if ( (_DWORD *)(v40 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v21 = _InterlockedExchangeAdd((volatile signed __int32 *)(v40 - 4), 0xFFFFFFFF);
        }
        else
        {
          v21 = *(_DWORD *)(v40 - 4);
          *(_DWORD *)(v40 - 4) = v21 - 1;
        }
        if ( v21 <= 0 )
          std::string::_Rep::_M_destroy(v13, &v29);
      }
      v31 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v38);
      v30 = v8;
      *(int *)((char *)&v30 + *(_DWORD *)(v8 - 12)) = dword_80CF678;
      v41 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v41);
      if ( byte_80CE64C )
      {
        v14 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v28, *(_DWORD *)(v28 - 12));
        v15 = (std::ostream *)v14;
        v16 = *(_DWORD *)(*(_DWORD *)v14 - 12);
        v17 = *(_DWORD *)((char *)v15 + v16 + 124);
        if ( !v17 )
        {
          v23 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v28 - 12, &v30);
          sub_8056F10(v5);
          Unwind_Resume(v23);
        }
        if ( *(_BYTE *)(v17 + 28) )
        {
          v18 = *(_BYTE *)(v17 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v15 + v16 + 124));
          v18 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v17 + 24))(v17, 10);
        }
        v19 = (std::ostream *)std::ostream::put(v15, v18);
        std::ostream::flush(v19);
      }
      syslog(6, "%s", v28, v25);
      result = v28;
      v20 = v28 - 12;
      v7 = v28 - 12 == (_DWORD)&std::string::_Rep::_S_empty_rep_storage;
      if ( (_DWORD *)(v28 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          result = _InterlockedExchangeAdd((volatile signed __int32 *)(v28 - 4), 0xFFFFFFFF);
        }
        else
        {
          v24 = *(_DWORD *)(v28 - 4);
          *(_DWORD *)(v28 - 4) = v24 - 1;
          result = v24;
        }
        v7 = result == 0;
        if ( result <= 0 )
          result = std::string::_Rep::_M_destroy(v20, &v30);
      }
    }
  }
  _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
  if ( v7 )
    result = (*(int (__cdecl **)(int))(*(_DWORD *)v5 + 4))(v5);
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080AD210) --------------------------------------------------------
void __cdecl sub_80AD210(int a1, int a2)
{
  int v2; // ebx@1
  unsigned int v3; // ebp@5
  int v4; // esi@7
  int v5; // ecx@8
  int v6; // eax@8
  int v7; // edi@10
  int v8; // edx@12
  int v9; // eax@14
  int v10; // esi@14
  int v11; // ebx@17
  int v12; // edi@21
  int v13; // ecx@23
  int v14; // eax@24
  int v15; // edi@25
  int v16; // eax@27
  int v17; // eax@29
  int v18; // edi@35
  int v19; // esi@35
  int v20; // eax@35
  signed int v21; // ST18_4@37
  size_t v22; // eax@37
  signed int v23; // edx@37
  int v24; // eax@39
  int v25; // edx@40
  int v26; // esi@42
  int v27; // eax@45
  std::ostream *v28; // edi@45
  int v29; // eax@45
  int v30; // esi@45
  char v31; // al@47
  std::ostream *v32; // eax@48
  int v33; // esi@49
  signed __int32 v34; // ecx@51
  signed __int32 v35; // edx@62
  signed __int32 v36; // ecx@66
  int v37; // ebx@71
  int v38; // [sp+Ch] [bp-F0h]@0
  int v39; // [sp+18h] [bp-E4h]@20
  int v40; // [sp+18h] [bp-E4h]@43
  int v41; // [sp+1Ch] [bp-E0h]@1
  char v42; // [sp+22h] [bp-DAh]@64
  char v43; // [sp+23h] [bp-D9h]@41
  int v44; // [sp+24h] [bp-D8h]@39
  int v45; // [sp+28h] [bp-D4h]@41
  int v46; // [sp+2Ch] [bp-D0h]@35
  int v47; // [sp+30h] [bp-CCh]@35
  int v48; // [sp+34h] [bp-C8h]@35
  int v49; // [sp+38h] [bp-C4h]@35
  int v50; // [sp+3Ch] [bp-C0h]@35
  int v51; // [sp+40h] [bp-BCh]@35
  int v52; // [sp+44h] [bp-B8h]@35
  int v53; // [sp+48h] [bp-B4h]@35
  char v54; // [sp+4Ch] [bp-B0h]@35
  int v55; // [sp+50h] [bp-ACh]@35
  int v56; // [sp+54h] [bp-A8h]@35
  int v57; // [sp+58h] [bp-A4h]@35
  int v58; // [sp+C8h] [bp-34h]@35
  char v59; // [sp+CCh] [bp-30h]@35
  char v60; // [sp+CDh] [bp-2Fh]@35
  int v61; // [sp+D0h] [bp-2Ch]@35
  int v62; // [sp+D4h] [bp-28h]@35
  int v63; // [sp+D8h] [bp-24h]@35
  int v64; // [sp+DCh] [bp-20h]@35

  v2 = *(_DWORD *)(a1 + 24);
  v41 = a1 + 20;
  if ( v2 == a1 + 20 )
    return;
  while ( 2 )
  {
    v3 = *(_DWORD *)(v2 + 4);
    if ( *(_DWORD *)(*(_DWORD *)(v2 + 24) + 32) != *(_DWORD *)a2 )
      goto LABEL_3;
    if ( log_level > 3 )
      goto LABEL_7;
    std::ios_base::ios_base((std::ios_base *)&v57);
    v57 = (int)&unk_80CF5C8;
    v58 = 0;
    v59 = 0;
    v60 = 0;
    v61 = 0;
    v62 = 0;
    v63 = 0;
    v64 = 0;
    v18 = dword_80CF674;
    v46 = dword_80CF674;
    *(int *)((char *)&v46 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v46 + *(_DWORD *)(v46 - 12), 0);
    v46 = (int)&unk_80CF5DC;
    v57 = (int)&unk_80CF5F0;
    v47 = (int)&unk_80CF7F0;
    v48 = 0;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    v52 = 0;
    v53 = 0;
    std::locale::locale((std::locale *)&v54);
    v47 = (int)&unk_80CF588;
    v55 = 16;
    v56 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v57, &v47);
    v19 = std::__ostream_insert<char,std::char_traits<char>>(
            &v46,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v19, "job cancel: ", 12);
    v20 = *(_DWORD *)(v2 + 28);
    if ( v20 )
    {
      if ( !*(_DWORD *)(v20 + 8) )
      {
        std::basic_ios<char,std::char_traits<char>>::clear(
          v19 + *(_DWORD *)(*(_DWORD *)v19 - 12),
          *(_DWORD *)(v19 + *(_DWORD *)(*(_DWORD *)v19 - 12) + 20) | 1);
        goto LABEL_39;
      }
      v21 = *(_DWORD *)(v20 + 8);
      v22 = strlen(*(const char **)(v20 + 8));
      v23 = v21;
    }
    else
    {
      v22 = 0;
      v23 = 134986579;
    }
    std::__ostream_insert<char,std::char_traits<char>>(v19, v23, v22);
LABEL_39:
    v44 = (int)&unk_80CF83C;
    v24 = *(_DWORD *)(v19 + 24);
    if ( v24 )
    {
      v25 = *(_DWORD *)(v19 + 16);
      LOBYTE(v38) = 0;
      if ( v24 <= (unsigned int)v25 )
      {
        v45 = std::string::_S_construct<char *>(v2, v3, (void *)v18, *(_DWORD *)(v19 + 20), v25, (int)&v43);
        std::string::swap((std::string *)&v44, (std::string *)&v45);
      }
      else
      {
        v45 = std::string::_S_construct<char *>(v2, v3, (void *)v18, *(_DWORD *)(v19 + 20), v24, (int)&v43);
        std::string::swap((std::string *)&v44, (std::string *)&v45);
      }
      v26 = v45 - 12;
      if ( (_DWORD *)(v45 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v35 = _InterlockedExchangeAdd((volatile signed __int32 *)(v45 - 4), 0xFFFFFFFF);
        }
        else
        {
          v35 = *(_DWORD *)(v45 - 4);
          *(_DWORD *)(v45 - 4) = v35 - 1;
        }
        if ( v35 <= 0 )
          std::string::_Rep::_M_destroy(v26, &v42);
      }
    }
    else
    {
      std::string::assign((std::string *)&v44, (const std::string *)(v19 + 40));
    }
    v46 = (int)&unk_80CF5DC;
    v57 = (int)&unk_80CF5F0;
    v47 = (int)&unk_80CF588;
    v40 = v56 - 12;
    if ( (_DWORD *)(v56 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v36 = _InterlockedExchangeAdd((volatile signed __int32 *)(v56 - 4), 0xFFFFFFFF);
      }
      else
      {
        v36 = *(_DWORD *)(v56 - 4);
        *(_DWORD *)(v56 - 4) = v36 - 1;
      }
      if ( v36 <= 0 )
        std::string::_Rep::_M_destroy(v40, &v45);
    }
    v47 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v54);
    v46 = v18;
    *(int *)((char *)&v46 + *(_DWORD *)(v18 - 12)) = dword_80CF678;
    v57 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v57);
    if ( byte_80CE64C )
    {
      v27 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v44, *(_DWORD *)(v44 - 12));
      v28 = (std::ostream *)v27;
      v29 = *(_DWORD *)(*(_DWORD *)v27 - 12);
      v30 = *(_DWORD *)((char *)v28 + v29 + 124);
      if ( !v30 )
      {
        v37 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v44 - 12, &v45);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v46);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v40);
        Unwind_Resume(v37);
      }
      if ( *(_BYTE *)(v30 + 28) )
      {
        v31 = *(_BYTE *)(v30 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v28 + v29 + 124));
        v31 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v30 + 24))(v30, 10);
      }
      v32 = (std::ostream *)std::ostream::put(v28, v31);
      std::ostream::flush(v32);
    }
    syslog(5, "%s", v44, v38);
    v33 = v44 - 12;
    if ( (_DWORD *)(v44 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v34 = _InterlockedExchangeAdd((volatile signed __int32 *)(v44 - 4), 0xFFFFFFFF);
      }
      else
      {
        v34 = *(_DWORD *)(v44 - 4);
        *(_DWORD *)(v44 - 4) = v34 - 1;
      }
      if ( v34 <= 0 )
        std::string::_Rep::_M_destroy(v33, &v46);
    }
LABEL_7:
    v4 = *(_DWORD *)(a1 + 4);
    if ( v4 == a1 )
      goto LABEL_14;
    while ( 1 )
    {
      v5 = *(_DWORD *)(v4 + 24);
      v6 = *(_DWORD *)(v4 + 28);
      if ( v5 != v6 )
        break;
LABEL_13:
      v4 = *(_DWORD *)(v4 + 4);
      if ( a1 == v4 )
        goto LABEL_14;
    }
    if ( v2 != *(_DWORD *)v5 )
    {
      v7 = v5 + 4;
      while ( 1 )
      {
        v8 = v7;
        if ( v7 == v6 )
          goto LABEL_13;
        v7 += 4;
        if ( v2 == *(_DWORD *)(v7 - 4) )
        {
          v39 = *(_DWORD *)(v4 + 24);
          goto LABEL_21;
        }
      }
    }
    v39 = *(_DWORD *)(v4 + 24);
    v8 = *(_DWORD *)(v4 + 24);
LABEL_21:
    v12 = v8 + 4;
    if ( v6 != v8 + 4 && (v6 - v12) >> 2 )
    {
      memmove((void *)v8, (const void *)(v8 + 4), 4 * ((v6 - v12) >> 2));
      v13 = *(_DWORD *)(v4 + 24);
      v6 = *(_DWORD *)(v4 + 28);
    }
    else
    {
      v13 = v39;
    }
    v14 = v6 - 4;
    *(_DWORD *)(v4 + 28) = v14;
    if ( v14 != v13 )
    {
LABEL_14:
      v9 = *(_DWORD *)(v2 + 16);
      v10 = v2 + 12;
      if ( v9 == v2 + 12 )
        goto LABEL_32;
LABEL_17:
      while ( 1 )
      {
        v11 = *(_DWORD *)(v9 + 4);
        sub_8079ED0(v9 - 140);
        if ( v10 == v11 )
          break;
        v9 = v11;
      }
      if ( v41 != v3 )
        goto LABEL_4;
      return;
    }
    v15 = *(_DWORD *)(v4 + 16);
    if ( v15 )
    {
      *(_DWORD *)(v4 + 12) = 0;
      sub_80A7DD0(a1);
      evdns_getaddrinfo_cancel(v15);
    }
    v16 = *(_DWORD *)(v4 + 4);
    if ( v16 )
      *(_DWORD *)(v16 + 8) = *(_DWORD *)(v4 + 8);
    v17 = *(_DWORD *)(v4 + 8);
    if ( v17 )
      *(_DWORD *)(v17 + 4) = *(_DWORD *)(v4 + 4);
    *(_DWORD *)(v4 + 4) = 0;
    *(_DWORD *)(v4 + 8) = 0;
    v9 = *(_DWORD *)(v2 + 16);
    v10 = v2 + 12;
    if ( v9 != v2 + 12 )
      goto LABEL_17;
LABEL_32:
    sub_80ACCA0(a1, v2, 8);
LABEL_3:
    if ( v41 != v3 )
    {
LABEL_4:
      v2 = v3;
      continue;
    }
    break;
  }
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA20: using guessed type int __cdecl evdns_getaddrinfo_cancel(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080AD900) --------------------------------------------------------
int __cdecl sub_80AD900(int a1, int a2, int a3, int a4)
{
  unsigned int v4; // ebp@0
  int v5; // ebx@1
  int v6; // eax@1
  int v7; // eax@3
  void *v8; // edx@5
  void *v9; // eax@5
  void *v10; // edi@8
  int v11; // eax@9
  int v12; // edx@10
  int v13; // eax@12
  int v14; // edx@13
  void *v15; // esi@15
  void *v16; // ebx@15
  bool v17; // dl@16
  int v18; // eax@18
  void *v19; // ecx@20
  void *v20; // esi@20
  void *v21; // esi@23
  void *v22; // ebx@23
  int v23; // eax@24
  int v24; // edx@24
  int v26; // eax@35
  int v27; // eax@36
  int v28; // edx@38
  signed __int32 v29; // edi@40
  int v30; // eax@45
  int v31; // edx@45
  int v32; // eax@46
  int v33; // ebx@46
  std::string *v34; // ebx@49
  const void **v35; // esi@54
  std::string *v36; // eax@59
  int v37; // eax@63
  std::string *v38; // ebx@64
  std::string *v39; // esi@64
  std::string *v40; // esi@68
  int v41; // eax@69
  int v42; // edx@69
  int v43; // eax@82
  int v44; // eax@86
  int v45; // edx@87
  std::string *v46; // esi@89
  int v47; // ebx@89
  int v48; // ebx@89
  int v49; // ebx@89
  int v50; // eax@89
  int v51; // edx@90
  char *v52; // edx@92
  int v53; // edx@93
  int v54; // edx@94
  int v55; // eax@96
  std::ostream *v56; // esi@96
  int v57; // eax@96
  int v58; // ebx@96
  char v59; // al@98
  std::ostream *v60; // eax@99
  void *v61; // eax@100
  char *v62; // edx@100
  signed __int32 v63; // eax@110
  signed __int32 v64; // ebx@114
  bool v65; // ST28_1@116
  signed __int32 v66; // ebx@118
  signed __int32 v67; // ecx@121
  signed __int32 v68; // ecx@123
  int v69; // ebx@126
  signed __int32 v70; // ebx@130
  signed __int32 v71; // ebx@134
  signed __int32 v72; // ebx@140
  signed __int32 v73; // ebx@146
  signed __int32 v74; // esi@152
  bool v75; // ST28_1@153
  int v76; // [sp+Ch] [bp-11Ch]@0
  int v77; // [sp+10h] [bp-118h]@0
  std::string *v78; // [sp+18h] [bp-110h]@47
  void *v79; // [sp+1Ch] [bp-10Ch]@7
  int v80; // [sp+24h] [bp-104h]@21
  void *v81; // [sp+28h] [bp-100h]@47
  const void **v82; // [sp+28h] [bp-100h]@54
  std::string *v83; // [sp+2Ch] [bp-FCh]@58
  char v84; // [sp+3Ch] [bp-ECh]@11
  char v85; // [sp+3Dh] [bp-EBh]@14
  char v86; // [sp+3Eh] [bp-EAh]@88
  char v87; // [sp+3Fh] [bp-E9h]@132
  int v88; // [sp+40h] [bp-E8h]@38
  void *s1; // [sp+44h] [bp-E4h]@14
  int v90; // [sp+48h] [bp-E0h]@38
  void *s2; // [sp+4Ch] [bp-DCh]@11
  void *v92; // [sp+50h] [bp-D8h]@6
  void *v93; // [sp+54h] [bp-D4h]@6
  int v94; // [sp+58h] [bp-D0h]@6
  std::string *v95; // [sp+5Ch] [bp-CCh]@36
  std::string *v96; // [sp+60h] [bp-C8h]@46
  std::string *v97; // [sp+64h] [bp-C4h]@46
  int v98; // [sp+68h] [bp-C0h]@89
  int v99; // [sp+6Ch] [bp-BCh]@89
  int v100; // [sp+70h] [bp-B8h]@89
  int v101; // [sp+74h] [bp-B4h]@89
  int v102; // [sp+78h] [bp-B0h]@89
  char v103; // [sp+7Ch] [bp-ACh]@89
  int v104; // [sp+80h] [bp-A8h]@89
  int v105; // [sp+84h] [bp-A4h]@89
  int v106; // [sp+88h] [bp-A0h]@89
  int v107; // [sp+F8h] [bp-30h]@89
  char v108; // [sp+FCh] [bp-2Ch]@89
  char v109; // [sp+FDh] [bp-2Bh]@89
  int v110; // [sp+100h] [bp-28h]@89
  int v111; // [sp+104h] [bp-24h]@89
  int v112; // [sp+108h] [bp-20h]@89
  int v113; // [sp+10Ch] [bp-1Ch]@89

  v5 = a4;
  v6 = *(_DWORD *)(a2 + 4);
  if ( v6 )
    *(_DWORD *)(v6 + 8) = *(_DWORD *)(a2 + 8);
  v7 = *(_DWORD *)(a2 + 8);
  if ( v7 )
    *(_DWORD *)(v7 + 4) = *(_DWORD *)(a2 + 4);
  *(_DWORD *)(a2 + 4) = 0;
  *(_DWORD *)(a2 + 8) = 0;
  v8 = *(void **)(a2 + 28);
  v9 = *(void **)(a2 + 24);
  if ( v8 != v9 )
  {
    v92 = 0;
    v93 = 0;
    v94 = 0;
    if ( a3 || !a4 )
    {
      v79 = v8;
      goto LABEL_8;
    }
    while ( 1 )
    {
      v26 = *(_DWORD *)(v5 + 4);
      if ( v26 == 2 )
        break;
      if ( v26 == 10 && byte_80CF88C )
      {
        v27 = evutil_inet_ntop(10, *(_DWORD *)(v5 + 20) + 8, &v95, 128);
LABEL_37:
        if ( v27 )
        {
          std::string::string(&v88, v27, &v90);
          sub_80B1640((int)&v92, (int)&v88);
          v28 = v88 - 12;
          if ( (_DWORD *)(v88 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v29 = _InterlockedExchangeAdd((volatile signed __int32 *)(v88 - 4), 0xFFFFFFFF);
            }
            else
            {
              v29 = *(_DWORD *)(v88 - 4);
              *(_DWORD *)(v88 - 4) = v29 - 1;
            }
            if ( v29 <= 0 )
              std::string::_Rep::_M_destroy(v28, &s2);
          }
        }
      }
      v5 = *(_DWORD *)(v5 + 28);
      if ( !v5 )
      {
        v9 = *(void **)(a2 + 24);
        v79 = *(void **)(a2 + 28);
        if ( v9 == v79 )
        {
LABEL_23:
          v21 = v93;
          v22 = v92;
          if ( v93 != v92 )
          {
            do
            {
              v23 = *(_DWORD *)v22;
              v24 = *(_DWORD *)v22 - 12;
              if ( (_DWORD *)v24 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v68 = _InterlockedExchangeAdd((volatile signed __int32 *)(v23 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v68 = *(_DWORD *)(v23 - 4);
                  *(_DWORD *)(v23 - 4) = v68 - 1;
                }
                if ( v68 <= 0 )
                  std::string::_Rep::_M_destroy(v24, &v95);
              }
              v22 = (char *)v22 + 4;
            }
            while ( v21 != v22 );
            v21 = v92;
          }
          if ( v21 )
            operator delete(v21);
          return (*(int (__cdecl **)(int))(*(_DWORD *)a2 + 4))(a2);
        }
LABEL_8:
        v10 = v9;
        while ( 2 )
        {
          --*(_DWORD *)(a1 + 100);
          v11 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)v10 + 24) + 16);
          if ( v11 && (v12 = *(_DWORD *)(v11 + 32)) != 0 )
            std::string::string(&s2, *(_DWORD *)(v11 + 28), v12, &v84);
          else
            std::string::string((std::string *)&s2, (const std::string *)&dword_80CF8FC);
          v13 = *(_DWORD *)(*(_DWORD *)v10 + 28);
          if ( v13 && (v14 = *(_DWORD *)(v13 + 32)) != 0 )
            std::string::string(&s1, *(_DWORD *)(v13 + 28), v14, &v85);
          else
            std::string::string((std::string *)&s1, (const std::string *)&dword_80CF8FC);
          v15 = s1;
          v16 = s2;
          if ( *((_DWORD *)s1 - 3) == *((_DWORD *)s2 - 3) )
            v17 = memcmp(s1, s2, *((_DWORD *)s1 - 3)) == 0;
          else
            v17 = 0;
          if ( (_DWORD *)((char *)v15 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v66 = _InterlockedExchangeAdd((volatile signed __int32 *)v15 - 1, 0xFFFFFFFF);
            }
            else
            {
              v66 = *((_DWORD *)v15 - 1);
              *((_DWORD *)v15 - 1) = v66 - 1;
            }
            if ( v66 <= 0 )
            {
              v75 = v17;
              std::string::_Rep::_M_destroy((char *)v15 - 12, &v95);
              v16 = s2;
              v17 = v75;
            }
            else
            {
              v16 = s2;
            }
          }
          v18 = (int)((char *)v16 - 12);
          if ( (_DWORD *)((char *)v16 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v64 = _InterlockedExchangeAdd((volatile signed __int32 *)v16 - 1, 0xFFFFFFFF);
            }
            else
            {
              v74 = *((_DWORD *)v16 - 1);
              *((_DWORD *)v16 - 1) = v74 - 1;
              v64 = v74;
            }
            if ( v64 <= 0 )
            {
              v65 = v17;
              std::string::_Rep::_M_destroy(v18, &v95);
              v17 = v65;
            }
          }
          if ( !v17 )
          {
            v19 = v93;
            v20 = v92;
            if ( v93 != v92 )
            {
              v80 = 0;
              goto LABEL_46;
            }
            v30 = *(_DWORD *)v10;
LABEL_85:
            if ( log_level <= 3 )
            {
              v44 = *(_DWORD *)(v30 + 28);
              if ( v44 && (v45 = *(_DWORD *)(v44 + 32)) != 0 )
                std::string::string(&v90, *(_DWORD *)(v44 + 28), v45, &v86);
              else
                std::string::string((std::string *)&v90, (const std::string *)&dword_80CF8FC);
              std::ios_base::ios_base((std::ios_base *)&v106);
              v106 = (int)&unk_80CF5C8;
              v107 = 0;
              v108 = 0;
              v109 = 0;
              v110 = 0;
              v111 = 0;
              v112 = 0;
              v113 = 0;
              v46 = (std::string *)dword_80CF674;
              v95 = (std::string *)dword_80CF674;
              *(std::string **)((char *)&v95 + *(_DWORD *)(dword_80CF674 - 12)) = (std::string *)dword_80CF678;
              std::basic_ios<char,std::char_traits<char>>::init((char *)&v95 + *((_DWORD *)v95 - 3), 0);
              v95 = (std::string *)&unk_80CF5DC;
              v106 = (int)&unk_80CF5F0;
              v96 = (std::string *)&unk_80CF7F0;
              v97 = 0;
              v98 = 0;
              v99 = 0;
              v100 = 0;
              v101 = 0;
              v102 = 0;
              std::locale::locale((std::locale *)&v103);
              v96 = (std::string *)&unk_80CF588;
              v104 = 16;
              v105 = (int)&unk_80CF83C;
              std::basic_ios<char,std::char_traits<char>>::init(&v106, &v96);
              v47 = std::__ostream_insert<char,std::char_traits<char>>(
                      &v95,
                      &unk_80CF83C,
                      std::string::_Rep::_S_empty_rep_storage);
              std::__ostream_insert<char,std::char_traits<char>>(v47, "DNS failed for '", 16);
              v48 = std::__ostream_insert<char,std::char_traits<char>>(v47, v90, *(_DWORD *)(v90 - 12));
              std::__ostream_insert<char,std::char_traits<char>>(v48, "' (", 3);
              v49 = std::ostream::operator<<(v48, a3);
              std::__ostream_insert<char,std::char_traits<char>>(v49, 134976047, 1);
              s1 = &unk_80CF83C;
              v50 = *(_DWORD *)(v49 + 24);
              if ( v50 )
              {
                v51 = *(_DWORD *)(v49 + 16);
                LOBYTE(v76) = 0;
                if ( v50 <= (unsigned int)v51 )
                {
                  s2 = (void *)std::string::_S_construct<char *>(v49, v4, v10, *(_DWORD *)(v49 + 20), v51, (int)&v88);
                  std::string::swap((std::string *)&s1, (std::string *)&s2);
                }
                else
                {
                  s2 = (void *)std::string::_S_construct<char *>(v49, v4, v10, *(_DWORD *)(v49 + 20), v50, (int)&v88);
                  std::string::swap((std::string *)&s1, (std::string *)&s2);
                }
                v52 = (char *)s2 - 12;
                if ( (_DWORD *)((char *)s2 - 12) != &std::string::_Rep::_S_empty_rep_storage )
                {
                  if ( &_pthread_key_create )
                  {
                    v70 = _InterlockedExchangeAdd((volatile signed __int32 *)s2 - 1, 0xFFFFFFFF);
                  }
                  else
                  {
                    v70 = *((_DWORD *)s2 - 1);
                    *((_DWORD *)s2 - 1) = v70 - 1;
                  }
                  if ( v70 <= 0 )
                    std::string::_Rep::_M_destroy(v52, &v87);
                }
              }
              else
              {
                std::string::assign((std::string *)&s1, (const std::string *)(v49 + 40));
              }
              v95 = (std::string *)&unk_80CF5DC;
              v106 = (int)&unk_80CF5F0;
              v96 = (std::string *)&unk_80CF588;
              v53 = v105 - 12;
              if ( (_DWORD *)(v105 - 12) != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v71 = _InterlockedExchangeAdd((volatile signed __int32 *)(v105 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v71 = *(_DWORD *)(v105 - 4);
                  *(_DWORD *)(v105 - 4) = v71 - 1;
                }
                if ( v71 <= 0 )
                  std::string::_Rep::_M_destroy(v53, &s2);
              }
              v96 = (std::string *)&unk_80CF7F0;
              std::locale::~locale((std::locale *)&v103);
              v95 = v46;
              *(std::string **)((char *)&v95 + *((_DWORD *)v46 - 3)) = (std::string *)dword_80CF678;
              v106 = (int)&unk_80CF5C8;
              std::ios_base::~ios_base((std::ios_base *)&v106);
              v54 = v90 - 12;
              if ( (_DWORD *)(v90 - 12) != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v72 = _InterlockedExchangeAdd((volatile signed __int32 *)(v90 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v72 = *(_DWORD *)(v90 - 4);
                  *(_DWORD *)(v90 - 4) = v72 - 1;
                }
                if ( v72 <= 0 )
                  std::string::_Rep::_M_destroy(v54, &v95);
              }
              if ( byte_80CE64C )
              {
                v55 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, s1, *((_DWORD *)s1 - 3));
                v56 = (std::ostream *)v55;
                v57 = *(_DWORD *)(*(_DWORD *)v55 - 12);
                v58 = *(_DWORD *)((char *)v56 + v57 + 124);
                if ( v58 )
                {
                  if ( *(_BYTE *)(v58 + 28) )
                  {
                    v59 = *(_BYTE *)(v58 + 39);
                  }
                  else
                  {
                    std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v56 + v57 + 124));
                    v59 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v58 + 24))(v58, 10);
                  }
                  v60 = (std::ostream *)std::ostream::put(v56, v59);
                  std::ostream::flush(v60);
                  goto LABEL_100;
                }
                v61 = (void *)std::__throw_bad_cast();
LABEL_145:
                if ( &_pthread_key_create )
                {
                  v73 = _InterlockedExchangeAdd((volatile signed __int32 *)v61 - 1, 0xFFFFFFFF);
                }
                else
                {
                  v73 = *((_DWORD *)v61 - 1);
                  *((_DWORD *)v61 - 1) = v73 - 1;
                }
                if ( v73 <= 0 )
                  std::string::_Rep::_M_destroy(v62, &v95);
              }
              else
              {
LABEL_100:
                syslog(5, "%s", s1, v76, v77);
                v61 = s1;
                v62 = (char *)s1 - 12;
                if ( (_DWORD *)((char *)s1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
                  goto LABEL_145;
              }
              v30 = *(_DWORD *)v10;
            }
            sub_80ACCA0(a1, v30, 4);
LABEL_74:
            v10 = (char *)v10 + 4;
            if ( v79 == v10 )
              goto LABEL_23;
            continue;
          }
          break;
        }
        v30 = *(_DWORD *)v10;
        v31 = *(_DWORD *)(*(_DWORD *)v10 + 24);
        v80 = v31 + 20;
        v19 = v93;
        v20 = v92;
        if ( v93 == v92 )
        {
          if ( v31 == -20 || *(_DWORD *)(v31 + 24) == *(_DWORD *)(v31 + 20) )
            goto LABEL_85;
          v20 = v93;
        }
LABEL_46:
        v32 = ((_BYTE *)v19 - (_BYTE *)v20) >> 2;
        v33 = v32;
        v95 = 0;
        v96 = 0;
        v97 = 0;
        if ( v32 )
        {
          if ( (unsigned int)v32 > 0x3FFFFFFF )
          {
            v69 = std::__throw_bad_alloc();
            v106 = (int)&unk_80CF5C8;
            std::ios_base::~ios_base((std::ios_base *)&v106);
            std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &s2);
            std::string::_Rep::_M_dispose(v90 - 12, &s2);
            sub_807B8A0((int)&v92);
            Unwind_Resume(v69);
          }
          v33 = 4 * v32;
          v78 = (std::string *)operator new(4 * v32);
          v81 = v93;
          v20 = v92;
        }
        else
        {
          v81 = v19;
          v78 = 0;
        }
        v95 = v78;
        v96 = v78;
        v97 = (std::string *)((char *)v78 + v33);
        if ( v81 == v20 )
        {
          v34 = v78;
        }
        else
        {
          v34 = v78;
          do
          {
            if ( v34 )
              std::string::string(v34, (const std::string *)v20);
            v34 = (std::string *)((char *)v34 + 4);
            v20 = (char *)v20 + 4;
          }
          while ( v81 != v20 );
        }
        v96 = v34;
        if ( !v80 || (v35 = *(const void ***)v80, v82 = *(const void ***)(v80 + 4), *(const void ***)v80 == v82) )
        {
LABEL_63:
          v37 = *(_DWORD *)v10;
          if ( *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)v10 + 24) + 32) + 37) )
          {
            v38 = v95;
            v39 = v96;
            if ( v95 == v96 )
            {
LABEL_72:
              if ( v38 )
                operator delete((void *)v38);
              goto LABEL_74;
            }
            while ( 1 )
            {
              sub_80A9B50(a1, v37, v38);
              v38 = (std::string *)((char *)v38 + 4);
              if ( v39 == v38 )
                break;
              v37 = *(_DWORD *)v10;
            }
          }
          else
          {
            v43 = rand();
            sub_80A9B50(a1, *(_DWORD *)v10, (std::string *)((char *)v95 + 4 * (v43 % (unsigned int)((v96 - v95) >> 2))));
          }
          v40 = v96;
          v38 = v95;
          if ( v95 != v96 )
          {
            do
            {
              v41 = *(_DWORD *)v38;
              v42 = *(_DWORD *)v38 - 12;
              if ( (_DWORD *)v42 != &std::string::_Rep::_S_empty_rep_storage )
              {
                if ( &_pthread_key_create )
                {
                  v63 = _InterlockedExchangeAdd((volatile signed __int32 *)(v41 - 4), 0xFFFFFFFF);
                }
                else
                {
                  v67 = *(_DWORD *)(v41 - 4);
                  *(_DWORD *)(v41 - 4) = v67 - 1;
                  v63 = v67;
                }
                if ( v63 <= 0 )
                  std::string::_Rep::_M_destroy(v42, &s2);
              }
              v38 = (std::string *)((char *)v38 + 4);
            }
            while ( v38 != v40 );
            v38 = v95;
          }
          goto LABEL_72;
        }
        while ( 2 )
        {
          LOBYTE(v77) = 0;
          sub_80B1420((int)&v83, (int)v95, (int)v34, v35);
          if ( v34 == v83 )
          {
            v36 = v96;
            if ( v96 != v97 )
            {
              if ( v96 )
              {
                std::string::string(v96, (const std::string *)v35);
                v36 = v96;
              }
              v96 = (std::string *)((char *)v36 + 4);
              ++v35;
              if ( v82 == v35 )
                goto LABEL_63;
              goto LABEL_57;
            }
            sub_8099450((int)&v95, (std::string *)v35);
          }
          ++v35;
          if ( v82 == v35 )
            goto LABEL_63;
LABEL_57:
          v34 = v96;
          continue;
        }
      }
    }
    v27 = evutil_inet_ntop(2, *(_DWORD *)(v5 + 20) + 4, &v95, 128);
    goto LABEL_37;
  }
  return (*(int (__cdecl **)(int))(*(_DWORD *)a2 + 4))(a2);
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C480: using guessed type int __cdecl evutil_inet_ntop(_DWORD, _DWORD, _DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D1A0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;
// 80CF88C: using guessed type char byte_80CF88C;
// 80CF8FC: using guessed type int dword_80CF8FC;

//----- (080AE810) --------------------------------------------------------
int __cdecl sub_80AE810(int **a1)
{
  return sub_80AD900(**a1, (*a1)[1], 3, 0);
}

//----- (080AE840) --------------------------------------------------------
int __cdecl sub_80AE840(int a1, int a2, int a3)
{
  int v3; // edx@1
  int result; // eax@2
  int v5; // edx@2
  int v6; // ecx@2

  v3 = *(_DWORD *)(a3 + 12);
  if ( v3 )
    result = sub_80AD900(v3, a3, a1, a2);
  else
    result = (*(int (__fastcall **)(int))(*(_DWORD *)a3 + 4))(a1);
  if ( a2 )
    result = evutil_freeaddrinfo(v6, v5);
  return result;
}
// 804C7E0: using guessed type int __fastcall evutil_freeaddrinfo(_DWORD, _DWORD);

//----- (080AE8A0) --------------------------------------------------------
int __cdecl sub_80AE8A0(int a1, int a2, signed int a3)
{
  unsigned int v3; // ebp@1
  int v4; // eax@1
  int v5; // eax@3
  int v6; // eax@5
  int v7; // eax@7
  int v8; // eax@9
  int v9; // eax@12
  int v10; // edi@13
  int result; // eax@17
  int v12; // eax@20
  unsigned int v13; // ecx@21
  int v14; // eax@29
  signed int v15; // ST1C_4@31
  size_t v16; // eax@31
  signed int v17; // edx@31
  int v18; // eax@33
  int v19; // edx@33
  int v20; // ecx@34
  int v21; // edx@36
  int v22; // edx@37
  std::ostream *v23; // edi@39
  char v24; // al@41
  std::ostream *v25; // eax@42
  int v26; // edx@43
  int v27; // ebx@51
  signed __int32 v28; // edi@54
  signed __int32 v29; // edi@58
  signed __int32 v30; // eax@64
  signed __int32 v31; // ecx@67
  int v32; // [sp+Ch] [bp-F0h]@0
  int v33; // [sp+18h] [bp-E4h]@29
  int v34; // [sp+18h] [bp-E4h]@39
  char v35; // [sp+22h] [bp-DAh]@60
  char v36; // [sp+23h] [bp-D9h]@35
  int v37; // [sp+24h] [bp-D8h]@33
  int v38; // [sp+28h] [bp-D4h]@35
  int v39; // [sp+2Ch] [bp-D0h]@29
  int v40; // [sp+30h] [bp-CCh]@29
  int v41; // [sp+34h] [bp-C8h]@29
  int v42; // [sp+38h] [bp-C4h]@29
  int v43; // [sp+3Ch] [bp-C0h]@29
  int v44; // [sp+40h] [bp-BCh]@29
  int v45; // [sp+44h] [bp-B8h]@29
  int v46; // [sp+48h] [bp-B4h]@29
  char v47; // [sp+4Ch] [bp-B0h]@29
  int v48; // [sp+50h] [bp-ACh]@29
  int v49; // [sp+54h] [bp-A8h]@29
  int v50; // [sp+58h] [bp-A4h]@29
  int v51; // [sp+C8h] [bp-34h]@29
  char v52; // [sp+CCh] [bp-30h]@29
  char v53; // [sp+CDh] [bp-2Fh]@29
  int v54; // [sp+D0h] [bp-2Ch]@29
  int v55; // [sp+D4h] [bp-28h]@29
  int v56; // [sp+D8h] [bp-24h]@29
  int v57; // [sp+DCh] [bp-20h]@29

  v3 = *(_DWORD *)(a2 + 180);
  v4 = *(_DWORD *)(a2 + 144);
  if ( v4 )
    *(_DWORD *)(v4 + 8) = *(_DWORD *)(a2 + 148);
  v5 = *(_DWORD *)(a2 + 148);
  if ( v5 )
    *(_DWORD *)(v5 + 4) = *(_DWORD *)(a2 + 144);
  *(_DWORD *)(a2 + 144) = 0;
  *(_DWORD *)(a2 + 148) = 0;
  v6 = *(_DWORD *)(a2 + 132);
  if ( v6 )
    *(_DWORD *)(v6 + 8) = *(_DWORD *)(a2 + 136);
  v7 = *(_DWORD *)(a2 + 136);
  if ( v7 )
    *(_DWORD *)(v7 + 4) = *(_DWORD *)(a2 + 132);
  *(_DWORD *)(a2 + 132) = 0;
  *(_DWORD *)(a2 + 136) = 0;
  v8 = *(_DWORD *)(a2 + 4);
  if ( v8 && *(_DWORD *)(v8 + 16) == 5 && !memcmp(*(const void **)(v8 + 12), "https", 5u) )
    --*(_DWORD *)(a1 + 108);
  else
    --*(_DWORD *)(a1 + 104);
  v9 = *(_DWORD *)(a2 + 100);
  if ( v9 )
  {
    v10 = *(_DWORD *)(v9 + 64);
    if ( (unsigned int)(v10 - 300) <= 0x63
      && (!*(_BYTE *)(*(_DWORD *)(*(_DWORD *)(v3 + 24) + 32) + 58) || !*(_BYTE *)(a2 + 176)) )
    {
      if ( log_level > 1 )
      {
LABEL_20:
        v12 = evhttp_find_header(*(_DWORD *)(v9 + 16), "Location");
        if ( v12 )
        {
          v13 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v3 + 24) + 32) + 44);
          if ( v13 > (*(_DWORD *)(v3 + 36) - *(_DWORD *)(v3 + 32)) >> 2 )
          {
            sub_80AB6A0(a1, a2, v12);
          }
          else if ( (signed int)v13 > 0 )
          {
            a3 = 7;
          }
        }
        goto LABEL_14;
      }
      std::ios_base::ios_base((std::ios_base *)&v50);
      v50 = (int)&unk_80CF5C8;
      v51 = 0;
      v52 = 0;
      v53 = 0;
      v54 = 0;
      v55 = 0;
      v56 = 0;
      v57 = 0;
      v39 = dword_80CF674;
      *(int *)((char *)&v39 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v39 + *(_DWORD *)(v39 - 12), 0);
      v39 = (int)&unk_80CF5DC;
      v50 = (int)&unk_80CF5F0;
      v40 = (int)&unk_80CF7F0;
      v41 = 0;
      v42 = 0;
      v43 = 0;
      v44 = 0;
      v45 = 0;
      v46 = 0;
      std::locale::locale((std::locale *)&v47);
      v40 = (int)&unk_80CF588;
      v48 = 16;
      v49 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v50, &v40);
      v33 = std::__ostream_insert<char,std::char_traits<char>>(
              &v39,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v33, "redirect ", 9);
      v14 = *(_DWORD *)(a2 + 4);
      if ( v14 )
      {
        if ( !*(_DWORD *)(v14 + 8) )
        {
          std::basic_ios<char,std::char_traits<char>>::clear(
            *(_DWORD *)(*(_DWORD *)v33 - 12) + v33,
            *(_DWORD *)(*(_DWORD *)(*(_DWORD *)v33 - 12) + v33 + 20) | 1);
          goto LABEL_33;
        }
        v15 = *(_DWORD *)(v14 + 8);
        v16 = strlen(*(const char **)(v14 + 8));
        v17 = v15;
      }
      else
      {
        v16 = 0;
        v17 = 134986579;
      }
      std::__ostream_insert<char,std::char_traits<char>>(v33, v17, v16);
LABEL_33:
      std::__ostream_insert<char,std::char_traits<char>>(v33, 134986578, 1);
      v18 = std::ostream::operator<<(v33, v10);
      v37 = (int)&unk_80CF83C;
      v19 = *(_DWORD *)(v18 + 24);
      if ( v19 )
      {
        v20 = *(_DWORD *)(v18 + 16);
        LOBYTE(v32) = 0;
        if ( v19 <= (unsigned int)v20 )
        {
          v38 = std::string::_S_construct<char *>(a2, v3, &v36, *(_DWORD *)(v18 + 20), v20, (int)&v36);
          std::string::swap((std::string *)&v37, (std::string *)&v38);
        }
        else
        {
          v38 = std::string::_S_construct<char *>(a2, v3, &v36, *(_DWORD *)(v18 + 20), v19, (int)&v36);
          std::string::swap((std::string *)&v37, (std::string *)&v38);
        }
        v21 = v38 - 12;
        if ( (_DWORD *)(v38 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v29 = _InterlockedExchangeAdd((volatile signed __int32 *)(v38 - 4), 0xFFFFFFFF);
          }
          else
          {
            v29 = *(_DWORD *)(v38 - 4);
            *(_DWORD *)(v38 - 4) = v29 - 1;
          }
          if ( v29 <= 0 )
            std::string::_Rep::_M_destroy(v21, &v35);
        }
      }
      else
      {
        std::string::assign((std::string *)&v37, (const std::string *)(v18 + 40));
      }
      v39 = (int)&unk_80CF5DC;
      v50 = (int)&unk_80CF5F0;
      v40 = (int)&unk_80CF588;
      v22 = v49 - 12;
      if ( (_DWORD *)(v49 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v28 = _InterlockedExchangeAdd((volatile signed __int32 *)(v49 - 4), 0xFFFFFFFF);
        }
        else
        {
          v28 = *(_DWORD *)(v49 - 4);
          *(_DWORD *)(v49 - 4) = v28 - 1;
        }
        if ( v28 <= 0 )
          std::string::_Rep::_M_destroy(v22, &v38);
      }
      v40 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v47);
      v39 = dword_80CF674;
      *(int *)((char *)&v39 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      v50 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v50);
      if ( byte_80CE64C )
      {
        v23 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v37, *(_DWORD *)(v37 - 12));
        v34 = *(_DWORD *)((char *)v23 + *(_DWORD *)(*(_DWORD *)v23 - 12) + 124);
        if ( !v34 )
        {
          v27 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v37 - 12, &v39);
          Unwind_Resume(v27);
        }
        if ( *(_BYTE *)(v34 + 28) )
        {
          v24 = *(_BYTE *)(v34 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(v34);
          v24 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v34 + 24))(v34, 10);
        }
        v25 = (std::ostream *)std::ostream::put(v23, v24);
        std::ostream::flush(v25);
      }
      syslog(7, "%s", v37, v32);
      v26 = v37 - 12;
      if ( (_DWORD *)(v37 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v30 = _InterlockedExchangeAdd((volatile signed __int32 *)(v37 - 4), 0xFFFFFFFF);
        }
        else
        {
          v31 = *(_DWORD *)(v37 - 4);
          *(_DWORD *)(v37 - 4) = v31 - 1;
          v30 = v31;
        }
        if ( v30 <= 0 )
          std::string::_Rep::_M_destroy(v26, &v39);
      }
      v9 = *(_DWORD *)(a2 + 100);
      goto LABEL_20;
    }
  }
LABEL_14:
  if ( *(_DWORD *)(a1 + 76) )
    (*(void (__cdecl **)(int, int, signed int *))(a1 + 80))(a1 + 68, a2, &a3);
  (*(void (__cdecl **)(int))(*(_DWORD *)a2 + 4))(a2);
  if ( *(_DWORD *)(v3 + 16) == v3 + 12 )
    result = sub_80ACCA0(a1, v3, 1);
  else
    result = sub_80AC000(a1);
  return result;
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CAB0: using guessed type int __cdecl evhttp_find_header(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080AF000) --------------------------------------------------------
void __cdecl sub_80AF000(int a1, int a2, int *a3)
{
  int v3; // eax@5
  int v4; // edi@5
  int v5; // eax@5
  int v6; // eax@5
  int v7; // edi@5
  int v8; // eax@7
  int v9; // eax@7
  size_t v10; // edx@7
  int v11; // edi@9
  int v12; // esi@10
  int v13; // eax@13
  int v14; // eax@19
  const char *v15; // ebp@22
  int v16; // edi@23
  int v17; // edi@23
  int v18; // eax@23
  signed int v19; // ST2C_4@25
  size_t v20; // eax@25
  signed int v21; // edx@25
  int v22; // edi@27
  size_t v23; // eax@28
  int v24; // edi@29
  size_t v25; // eax@29
  int v26; // eax@29
  int v27; // edx@30
  int v28; // edx@32
  int v29; // edx@33
  int v30; // eax@35
  std::ostream *v31; // ebp@35
  int v32; // eax@35
  int v33; // edi@35
  char v34; // al@37
  std::ostream *v35; // eax@38
  int v36; // edx@39
  signed __int32 v37; // eax@41
  void *v38; // eax@47
  int v39; // eax@52
  int v40; // eax@52
  int v41; // edx@52
  int v42; // eax@60
  int v43; // edi@60
  int v44; // eax@60
  int v45; // eax@62
  signed __int32 v46; // edi@72
  signed __int32 v47; // edi@76
  int v48; // ebx@81
  signed __int32 v49; // ecx@82
  int v50; // [sp+Ch] [bp-100h]@0
  int v51; // [sp+20h] [bp-ECh]@8
  int v52; // [sp+20h] [bp-ECh]@22
  int v53; // [sp+24h] [bp-E8h]@8
  size_t v54; // [sp+24h] [bp-E8h]@22
  char *v55; // [sp+28h] [bp-E4h]@20
  char v56; // [sp+32h] [bp-DAh]@74
  char v57; // [sp+33h] [bp-D9h]@31
  int v58; // [sp+34h] [bp-D8h]@29
  int v59; // [sp+38h] [bp-D4h]@31
  int v60; // [sp+3Ch] [bp-D0h]@23
  int v61; // [sp+40h] [bp-CCh]@23
  int v62; // [sp+44h] [bp-C8h]@23
  int v63; // [sp+48h] [bp-C4h]@23
  int v64; // [sp+4Ch] [bp-C0h]@23
  int v65; // [sp+50h] [bp-BCh]@23
  int v66; // [sp+54h] [bp-B8h]@23
  int v67; // [sp+58h] [bp-B4h]@23
  char v68; // [sp+5Ch] [bp-B0h]@23
  int v69; // [sp+60h] [bp-ACh]@23
  int v70; // [sp+64h] [bp-A8h]@23
  int v71; // [sp+68h] [bp-A4h]@23
  int v72; // [sp+D8h] [bp-34h]@23
  char v73; // [sp+DCh] [bp-30h]@23
  char v74; // [sp+DDh] [bp-2Fh]@23
  int v75; // [sp+E0h] [bp-2Ch]@23
  int v76; // [sp+E4h] [bp-28h]@23
  int v77; // [sp+E8h] [bp-24h]@23
  int v78; // [sp+ECh] [bp-20h]@23

  if ( log_level <= 1 )
  {
    v14 = *a3;
    if ( *(_DWORD *)(*a3 + 80) > 0 || *(_DWORD *)(*a3 + 80) >= 0 && *(_DWORD *)(v14 + 76) )
      v55 = ") " + 2;
    else
      v55 = " - end-of-chunk";
    if ( *((_BYTE *)a3 + 4) )
    {
      v54 = 0;
      v15 = 0;
      v52 = 0;
    }
    else
    {
      v39 = evhttp_request_get_input_buffer(v14);
      v40 = evbuffer_get_length(v39);
      v41 = *a3;
      if ( !*a3 || *((_BYTE *)a3 + 4) )
      {
        v54 = v40;
        v15 = 0;
        v52 = 0;
      }
      else
      {
        v15 = *(const char **)(v41 + 68);
        v52 = *(_DWORD *)(v41 + 64);
        v54 = v40;
      }
    }
    std::ios_base::ios_base((std::ios_base *)&v71);
    v71 = (int)&unk_80CF5C8;
    v72 = 0;
    v73 = 0;
    v74 = 0;
    v75 = 0;
    v76 = 0;
    v77 = 0;
    v78 = 0;
    v60 = dword_80CF674;
    *(int *)((char *)&v60 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v60 + *(_DWORD *)(v60 - 12), 0);
    v60 = (int)&unk_80CF5DC;
    v71 = (int)&unk_80CF5F0;
    v61 = (int)&unk_80CF7F0;
    v62 = 0;
    v63 = 0;
    v64 = 0;
    v65 = 0;
    v66 = 0;
    v67 = 0;
    std::locale::locale((std::locale *)&v68);
    v61 = (int)&unk_80CF588;
    v69 = 16;
    v70 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v71, &v61);
    v16 = std::__ostream_insert<char,std::char_traits<char>>(
            &v60,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v16, "read ", 5);
    std::__ostream_insert<char,std::char_traits<char>>(v16, " [", 2);
    v17 = std::__ostream_insert<char,std::char_traits<char>>(
            v16,
            *(_DWORD *)(a2 + 12),
            *(_DWORD *)(*(_DWORD *)(a2 + 12) - 12));
    std::__ostream_insert<char,std::char_traits<char>>(v17, "] ", 2);
    v18 = *(_DWORD *)(a2 + 4);
    if ( v18 )
    {
      if ( !*(_DWORD *)(v18 + 8) )
      {
        std::basic_ios<char,std::char_traits<char>>::clear(
          v17 + *(_DWORD *)(*(_DWORD *)v17 - 12),
          *(_DWORD *)(v17 + *(_DWORD *)(*(_DWORD *)v17 - 12) + 20) | 1);
        goto LABEL_27;
      }
      v19 = *(_DWORD *)(v18 + 8);
      v20 = strlen(*(const char **)(v18 + 8));
      v21 = v19;
    }
    else
    {
      v20 = 0;
      v21 = 134986579;
    }
    std::__ostream_insert<char,std::char_traits<char>>(v17, v21, v20);
LABEL_27:
    std::__ostream_insert<char,std::char_traits<char>>(v17, "  [", 3);
    v22 = std::ostream::operator<<(v17, v52);
    std::__ostream_insert<char,std::char_traits<char>>(v22, "] ", 2);
    if ( v15 )
    {
      v23 = strlen(v15);
      std::__ostream_insert<char,std::char_traits<char>>(v22, v15, v23);
    }
    else
    {
      std::basic_ios<char,std::char_traits<char>>::clear(
        v22 + *(_DWORD *)(*(_DWORD *)v22 - 12),
        *(_DWORD *)(v22 + *(_DWORD *)(*(_DWORD *)v22 - 12) + 20) | 1);
    }
    std::__ostream_insert<char,std::char_traits<char>>(v22, 134976116, 7);
    v24 = std::ostream::_M_insert<unsigned long>(v22, v54);
    v25 = strlen(v55);
    std::__ostream_insert<char,std::char_traits<char>>(v24, v55, v25);
    v58 = (int)&unk_80CF83C;
    v26 = *(_DWORD *)(v24 + 24);
    if ( v26 )
    {
      v27 = *(_DWORD *)(v24 + 16);
      LOBYTE(v50) = 0;
      if ( v26 <= (unsigned int)v27 )
      {
        v59 = std::string::_S_construct<char *>(
                a2,
                (unsigned int)&v57,
                (void *)v24,
                *(_DWORD *)(v24 + 20),
                v27,
                (int)&v57);
        std::string::swap((std::string *)&v58, (std::string *)&v59);
      }
      else
      {
        v59 = std::string::_S_construct<char *>(
                a2,
                (unsigned int)&v57,
                (void *)v24,
                *(_DWORD *)(v24 + 20),
                v26,
                (int)&v57);
        std::string::swap((std::string *)&v58, (std::string *)&v59);
      }
      v28 = v59 - 12;
      if ( (_DWORD *)(v59 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v46 = _InterlockedExchangeAdd((volatile signed __int32 *)(v59 - 4), 0xFFFFFFFF);
        }
        else
        {
          v46 = *(_DWORD *)(v59 - 4);
          *(_DWORD *)(v59 - 4) = v46 - 1;
        }
        if ( v46 <= 0 )
          std::string::_Rep::_M_destroy(v28, &v56);
      }
    }
    else
    {
      std::string::assign((std::string *)&v58, (const std::string *)(v24 + 40));
    }
    v60 = (int)&unk_80CF5DC;
    v71 = (int)&unk_80CF5F0;
    v61 = (int)&unk_80CF588;
    v29 = v70 - 12;
    if ( (_DWORD *)(v70 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v47 = _InterlockedExchangeAdd((volatile signed __int32 *)(v70 - 4), 0xFFFFFFFF);
      }
      else
      {
        v47 = *(_DWORD *)(v70 - 4);
        *(_DWORD *)(v70 - 4) = v47 - 1;
      }
      if ( v47 <= 0 )
        std::string::_Rep::_M_destroy(v29, &v59);
    }
    v61 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v68);
    v60 = dword_80CF674;
    *(int *)((char *)&v60 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v71 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v71);
    if ( byte_80CE64C )
    {
      v30 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v58, *(_DWORD *)(v58 - 12));
      v31 = (std::ostream *)v30;
      v32 = *(_DWORD *)(*(_DWORD *)v30 - 12);
      v33 = *(_DWORD *)((char *)v31 + v32 + 124);
      if ( !v33 )
      {
        v48 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(v58 - 12, &v59);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v60);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v31);
        Unwind_Resume(v48);
      }
      if ( *(_BYTE *)(v33 + 28) )
      {
        v34 = *(_BYTE *)(v33 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v31 + v32 + 124));
        v34 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v33 + 24))(v33, 10);
      }
      v35 = (std::ostream *)std::ostream::put(v31, v34);
      std::ostream::flush(v35);
    }
    syslog(7, "%s", v58, v50);
    v36 = v58 - 12;
    if ( (_DWORD *)(v58 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v58 - 4), 0xFFFFFFFF);
      }
      else
      {
        v49 = *(_DWORD *)(v58 - 4);
        *(_DWORD *)(v58 - 4) = v49 - 1;
        v37 = v49;
      }
      if ( v37 <= 0 )
        std::string::_Rep::_M_destroy(v36, &v60);
    }
  }
  if ( *a3 )
  {
    if ( *(_DWORD *)(a2 + 156) == *(_DWORD *)(a2 + 152) )
    {
      if ( *((_BYTE *)a3 + 4) )
      {
        v53 = 0;
        v51 = 0;
      }
      else
      {
        v42 = evhttp_request_get_input_buffer(*a3);
        v43 = evbuffer_get_length(v42);
        v44 = evhttp_request_get_input_buffer(*a3);
        v53 = evbuffer_pullup(v44, v43);
        if ( !*a3 || *((_BYTE *)a3 + 4) )
        {
          v51 = 0;
        }
        else
        {
          v45 = evhttp_request_get_input_buffer(*a3);
          v51 = evbuffer_get_length(v45);
        }
      }
    }
    else
    {
      if ( *((_BYTE *)a3 + 4) )
      {
        v10 = 0;
        v9 = 0;
      }
      else
      {
        v3 = evhttp_request_get_input_buffer(*a3);
        v4 = evbuffer_get_length(v3);
        v5 = evhttp_request_get_input_buffer(*a3);
        v6 = evbuffer_pullup(v5, v4);
        v7 = v6;
        if ( !*a3 || *((_BYTE *)a3 + 4) )
        {
          v10 = v6;
          v9 = 0;
        }
        else
        {
          v8 = evhttp_request_get_input_buffer(*a3);
          v9 = evbuffer_get_length(v8);
          v10 = v7;
        }
      }
      sub_8058890((void *)(a2 + 152), *(void **)(a2 + 156), v10, v10 + v9);
      v53 = *(_DWORD *)(a2 + 152);
      v51 = *(_DWORD *)(a2 + 156) - v53;
    }
  }
  else
  {
    v51 = 0;
    v53 = 0;
  }
  v11 = *(_DWORD *)(a2 + 168);
  if ( *(_DWORD *)(a2 + 164) == v11 )
    goto LABEL_16;
  v12 = *(_DWORD *)(a2 + 164);
  do
  {
    v13 = *(_DWORD *)(v12 + 4);
    if ( v13 )
    {
      if ( v13 == 1 )
        goto LABEL_15;
    }
    else
    {
      sub_80A61B0(v12, *a3, (void *)v53, v51);
      if ( *(_DWORD *)(v12 + 4) == 1 )
      {
LABEL_15:
        *(_BYTE *)(a2 + 176) = 1;
        goto LABEL_16;
      }
    }
    v12 += 16;
  }
  while ( v11 != v12 );
  if ( *(_DWORD *)(a2 + 164) == *(_DWORD *)(a2 + 168) || dword_80CF850 > 0 && v51 >= (unsigned int)dword_80CF850 )
  {
LABEL_16:
    sub_80AE8A0(a1, a2, 1);
  }
  else
  {
    v38 = *(void **)(a2 + 156);
    if ( v38 == *(void **)(a2 + 152) )
      sub_8058890((void *)(a2 + 152), v38, v53, v53 + v51);
  }
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CDA0: using guessed type int __cdecl evbuffer_pullup(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D1F0: using guessed type int __cdecl evhttp_request_get_input_buffer(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF850: using guessed type int dword_80CF850;
// 80CF874: using guessed type int log_level;

//----- (080AF930) --------------------------------------------------------
void __cdecl sub_80AF930(int **a1, int *a2)
{
  sub_80AF000(**a1, (*a1)[1], a2);
}

//----- (080AF960) --------------------------------------------------------
int __cdecl sub_80AF960(int a1, int a2, int a3)
{
  unsigned int v3; // ebp@0
  int v4; // edi@1
  int v5; // eax@1
  int v6; // eax@6
  int v7; // esi@6
  int v8; // eax@6
  size_t v9; // esi@6
  int v10; // eax@9
  int v11; // esi@11
  int v12; // edi@12
  int v13; // eax@15
  int v15; // eax@20
  int v16; // eax@23
  int v17; // eax@25
  int v18; // eax@25
  int v19; // esi@28
  int v20; // esi@28
  int v21; // eax@28
  signed int v22; // ST20_4@30
  size_t v23; // eax@30
  signed int v24; // edx@30
  int v25; // esi@32
  size_t v26; // eax@33
  int v27; // eax@34
  int v28; // edx@34
  int v29; // ecx@35
  int v30; // esi@37
  int v31; // edx@38
  std::ostream *v32; // esi@40
  char v33; // al@42
  std::ostream *v34; // eax@43
  int v35; // edx@44
  char v36; // dl@46
  int v37; // eax@52
  int v38; // esi@52
  int v39; // eax@52
  int v40; // eax@56
  int v41; // esi@57
  int v42; // esi@57
  int v43; // eax@57
  signed int v44; // ST24_4@59
  size_t v45; // eax@59
  signed int v46; // edx@59
  int v47; // esi@61
  int v48; // eax@61
  int v49; // edx@62
  int v50; // esi@64
  int v51; // esi@65
  int v52; // eax@67
  int v53; // ecx@67
  int v54; // eax@67
  int v55; // esi@67
  char v56; // al@69
  std::ostream *v57; // eax@70
  int v58; // eax@71
  int v59; // edx@71
  signed __int32 v60; // ecx@73
  int v61; // ebx@88
  signed __int32 v62; // ecx@91
  signed __int32 v63; // esi@96
  signed __int32 v64; // ecx@103
  signed __int32 v65; // ecx@107
  signed __int32 v66; // ecx@113
  int v67; // [sp+8h] [bp-120h]@0
  int v68; // [sp+Ch] [bp-11Ch]@0
  int v69; // [sp+20h] [bp-108h]@25
  __int64 v70; // [sp+28h] [bp-100h]@19
  int v71; // [sp+28h] [bp-100h]@27
  void *s; // [sp+30h] [bp-F8h]@10
  __int64 sa; // [sp+30h] [bp-F8h]@19
  const char *sb; // [sp+30h] [bp-F8h]@27
  int *v75; // [sp+38h] [bp-F0h]@28
  int v76; // [sp+3Ch] [bp-ECh]@10
  std::ios_base *v77; // [sp+3Ch] [bp-ECh]@40
  std::ios_base *v78; // [sp+3Ch] [bp-ECh]@67
  __int64 v79; // [sp+48h] [bp-E0h]@19
  char v80; // [sp+52h] [bp-D6h]@93
  char v81; // [sp+53h] [bp-D5h]@36
  int v82; // [sp+54h] [bp-D4h]@34
  int v83; // [sp+58h] [bp-D0h]@36
  int v84; // [sp+5Ch] [bp-CCh]@28
  int v85; // [sp+60h] [bp-C8h]@28
  int v86; // [sp+64h] [bp-C4h]@28
  int v87; // [sp+68h] [bp-C0h]@28
  int v88; // [sp+6Ch] [bp-BCh]@28
  int v89; // [sp+70h] [bp-B8h]@28
  int v90; // [sp+74h] [bp-B4h]@28
  int v91; // [sp+78h] [bp-B0h]@28
  char v92; // [sp+7Ch] [bp-ACh]@28
  int v93; // [sp+80h] [bp-A8h]@28
  int v94; // [sp+84h] [bp-A4h]@28
  int v95; // [sp+88h] [bp-A0h]@28
  int v96; // [sp+F8h] [bp-30h]@28
  char v97; // [sp+FCh] [bp-2Ch]@28
  char v98; // [sp+FDh] [bp-2Bh]@28
  int v99; // [sp+100h] [bp-28h]@28
  int v100; // [sp+104h] [bp-24h]@28
  int v101; // [sp+108h] [bp-20h]@28
  int v102; // [sp+10Ch] [bp-1Ch]@28

  v4 = a2;
  v5 = *(_DWORD *)a3;
  if ( !*(_DWORD *)a3 || *(_BYTE *)(a3 + 4) || !*(_DWORD *)(v5 + 64) )
  {
    v70 = *(_QWORD *)(a2 + 184);
    std::chrono::_V2::steady_clock::now((std::chrono::_V2::steady_clock *)&v79);
    sa = v79;
    if ( log_level > 1 )
    {
LABEL_20:
      v15 = *(_DWORD *)(a2 + 100);
      if ( v15 )
        *(_DWORD *)(v15 + 64) = 0;
      return sub_80AE8A0(a1, a2, 6 - (*(_BYTE *)(a3 + 4) < 1u));
    }
    v75 = &v84;
    std::ios_base::ios_base((std::ios_base *)&v95);
    v95 = (int)&unk_80CF5C8;
    v96 = 0;
    v97 = 0;
    v98 = 0;
    v99 = 0;
    v100 = 0;
    v101 = 0;
    v102 = 0;
    v84 = dword_80CF674;
    *(int *)((char *)&v84 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v84 + *(_DWORD *)(v84 - 12), 0);
    v84 = (int)&unk_80CF5DC;
    v95 = (int)&unk_80CF5F0;
    v85 = (int)&unk_80CF7F0;
    v86 = 0;
    v87 = 0;
    v88 = 0;
    v89 = 0;
    v90 = 0;
    v91 = 0;
    std::locale::locale((std::locale *)&v92);
    v85 = (int)&unk_80CF588;
    v93 = 16;
    v94 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v95, &v85);
    v41 = std::__ostream_insert<char,std::char_traits<char>>(
            &v84,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v41, "done [", 6);
    v42 = std::__ostream_insert<char,std::char_traits<char>>(
            v41,
            *(_DWORD *)(a2 + 12),
            *(_DWORD *)(*(_DWORD *)(a2 + 12) - 12));
    std::__ostream_insert<char,std::char_traits<char>>(v42, "] ", 2);
    v43 = *(_DWORD *)(a2 + 4);
    if ( v43 )
    {
      if ( !*(_DWORD *)(v43 + 8) )
      {
        std::basic_ios<char,std::char_traits<char>>::clear(
          v42 + *(_DWORD *)(*(_DWORD *)v42 - 12),
          *(_DWORD *)(v42 + *(_DWORD *)(*(_DWORD *)v42 - 12) + 20) | 1);
LABEL_61:
        std::__ostream_insert<char,std::char_traits<char>>(v42, " connection refused in ", 23);
        v47 = std::ostream::_M_insert<double>(
                v42,
                COERCE_UNSIGNED_INT64((long double)(sa - v70) / 1000000000.0),
                COERCE_UNSIGNED_INT64((long double)(sa - v70) / 1000000000.0) >> 32);
        std::__ostream_insert<char,std::char_traits<char>>(v47, " sec", 4);
        v82 = (int)&unk_80CF83C;
        v48 = *(_DWORD *)(v47 + 24);
        if ( v48 )
        {
          v49 = *(_DWORD *)(v47 + 16);
          LOBYTE(v67) = 0;
          if ( v48 <= (unsigned int)v49 )
          {
            v83 = std::string::_S_construct<char *>(a3, v3, (void *)a2, *(_DWORD *)(v47 + 20), v49, (int)&v81);
            std::string::swap((std::string *)&v82, (std::string *)&v83);
          }
          else
          {
            v83 = std::string::_S_construct<char *>(a3, v3, (void *)a2, *(_DWORD *)(v47 + 20), v48, (int)&v81);
            std::string::swap((std::string *)&v82, (std::string *)&v83);
          }
          v50 = v83 - 12;
          if ( (_DWORD *)(v83 - 12) != &std::string::_Rep::_S_empty_rep_storage )
          {
            if ( &_pthread_key_create )
            {
              v65 = _InterlockedExchangeAdd((volatile signed __int32 *)(v83 - 4), 0xFFFFFFFF);
            }
            else
            {
              v65 = *(_DWORD *)(v83 - 4);
              *(_DWORD *)(v83 - 4) = v65 - 1;
            }
            if ( v65 <= 0 )
              std::string::_Rep::_M_destroy(v50, &v80);
          }
        }
        else
        {
          std::string::assign((std::string *)&v82, (const std::string *)(v47 + 40));
        }
        v84 = (int)&unk_80CF5DC;
        v95 = (int)&unk_80CF5F0;
        v85 = (int)&unk_80CF588;
        v51 = v94 - 12;
        if ( (_DWORD *)(v94 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v64 = _InterlockedExchangeAdd((volatile signed __int32 *)(v94 - 4), 0xFFFFFFFF);
          }
          else
          {
            v64 = *(_DWORD *)(v94 - 4);
            *(_DWORD *)(v94 - 4) = v64 - 1;
          }
          if ( v64 <= 0 )
            std::string::_Rep::_M_destroy(v51, &v83);
        }
        v85 = (int)&unk_80CF7F0;
        std::locale::~locale((std::locale *)&v92);
        v84 = dword_80CF674;
        *(int *)((char *)&v84 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
        v95 = (int)&unk_80CF5C8;
        std::ios_base::~ios_base((std::ios_base *)&v95);
        if ( byte_80CE64C )
        {
          v52 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v82, *(_DWORD *)(v82 - 12));
          v53 = v52;
          v78 = (std::ios_base *)v52;
          v54 = *(_DWORD *)(*(_DWORD *)v52 - 12);
          v55 = *(_DWORD *)(v53 + v54 + 124);
          if ( !v55 )
          {
            v61 = std::__throw_bad_cast();
            std::string::_Rep::_M_dispose(v82 - 12, &v84);
            Unwind_Resume(v61);
          }
          if ( *(_BYTE *)(v55 + 28) )
          {
            v56 = *(_BYTE *)(v55 + 39);
          }
          else
          {
            std::ctype<char>::_M_widen_init(*(_DWORD *)(v53 + v54 + 124));
            v56 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v55 + 24))(v55, 10);
          }
          v57 = (std::ostream *)std::ostream::put(v78, v56);
          std::ostream::flush(v57);
        }
        syslog(7, "%s", v82, v67);
        v58 = v82;
        v59 = v82 - 12;
        if ( (_DWORD *)(v82 - 12) == &std::string::_Rep::_S_empty_rep_storage )
          goto LABEL_20;
        if ( &_pthread_key_create )
        {
          v60 = _InterlockedExchangeAdd((volatile signed __int32 *)(v82 - 4), 0xFFFFFFFF);
          goto LABEL_74;
        }
LABEL_100:
        v60 = *(_DWORD *)(v58 - 4);
        *(_DWORD *)(v58 - 4) = v60 - 1;
LABEL_74:
        if ( v60 <= 0 )
          std::string::_Rep::_M_destroy(v59, v75);
        goto LABEL_20;
      }
      v44 = *(_DWORD *)(v43 + 8);
      v45 = strlen(*(const char **)(v43 + 8));
      v46 = v44;
    }
    else
    {
      v45 = 0;
      v46 = 134986579;
    }
    std::__ostream_insert<char,std::char_traits<char>>(v42, v46, v45);
    goto LABEL_61;
  }
  if ( log_level > 1 )
  {
    if ( *(_DWORD *)(a2 + 156) != *(_DWORD *)(a2 + 152) )
      goto LABEL_6;
    goto LABEL_52;
  }
  v17 = evhttp_request_get_input_buffer(*(_DWORD *)a3);
  v69 = evbuffer_get_length(v17);
  v18 = *(_DWORD *)a3;
  if ( !*(_DWORD *)a3 || *(_BYTE *)(a3 + 4) )
  {
    sb = 0;
    v71 = 0;
  }
  else
  {
    sb = *(const char **)(v18 + 68);
    v71 = *(_DWORD *)(v18 + 64);
  }
  v75 = &v84;
  std::ios_base::ios_base((std::ios_base *)&v95);
  v95 = (int)&unk_80CF5C8;
  v96 = 0;
  v97 = 0;
  v98 = 0;
  v99 = 0;
  v100 = 0;
  v101 = 0;
  v102 = 0;
  v84 = dword_80CF674;
  *(int *)((char *)&v84 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v84 + *(_DWORD *)(v84 - 12), 0);
  v84 = (int)&unk_80CF5DC;
  v95 = (int)&unk_80CF5F0;
  v85 = (int)&unk_80CF7F0;
  v86 = 0;
  v87 = 0;
  v88 = 0;
  v89 = 0;
  v90 = 0;
  v91 = 0;
  std::locale::locale((std::locale *)&v92);
  v85 = (int)&unk_80CF588;
  v93 = 16;
  v94 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v95, &v85);
  v19 = std::__ostream_insert<char,std::char_traits<char>>(&v84, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v19, "done [", 6);
  v20 = std::__ostream_insert<char,std::char_traits<char>>(
          v19,
          *(_DWORD *)(a2 + 12),
          *(_DWORD *)(*(_DWORD *)(a2 + 12) - 12));
  std::__ostream_insert<char,std::char_traits<char>>(v20, "] ", 2);
  v21 = *(_DWORD *)(a2 + 4);
  if ( !v21 )
  {
    v23 = 0;
    v24 = 134986579;
    goto LABEL_31;
  }
  if ( *(_DWORD *)(v21 + 8) )
  {
    v22 = *(_DWORD *)(v21 + 8);
    v23 = strlen(*(const char **)(v21 + 8));
    v24 = v22;
LABEL_31:
    std::__ostream_insert<char,std::char_traits<char>>(v20, v24, v23);
    goto LABEL_32;
  }
  std::basic_ios<char,std::char_traits<char>>::clear(
    v20 + *(_DWORD *)(*(_DWORD *)v20 - 12),
    *(_DWORD *)(v20 + *(_DWORD *)(*(_DWORD *)v20 - 12) + 20) | 1);
LABEL_32:
  std::__ostream_insert<char,std::char_traits<char>>(v20, "  [", 3);
  v25 = std::ostream::operator<<(v20, v71);
  std::__ostream_insert<char,std::char_traits<char>>(v25, "] ", 2);
  if ( sb )
  {
    v26 = strlen(sb);
    std::__ostream_insert<char,std::char_traits<char>>(v25, sb, v26);
  }
  else
  {
    std::basic_ios<char,std::char_traits<char>>::clear(
      v25 + *(_DWORD *)(*(_DWORD *)v25 - 12),
      *(_DWORD *)(v25 + *(_DWORD *)(*(_DWORD *)v25 - 12) + 20) | 1);
  }
  std::__ostream_insert<char,std::char_traits<char>>(v25, 134976116, 7);
  v27 = std::ostream::_M_insert<unsigned long>(v25, v69);
  v82 = (int)&unk_80CF83C;
  v28 = *(_DWORD *)(v27 + 24);
  if ( v28 )
  {
    v29 = *(_DWORD *)(v27 + 16);
    LOBYTE(v68) = 0;
    if ( v28 <= (unsigned int)v29 )
    {
      v83 = std::string::_S_construct<char *>(a3, v3, (void *)a2, *(_DWORD *)(v27 + 20), v29, (int)&v81);
      std::string::swap((std::string *)&v82, (std::string *)&v83);
    }
    else
    {
      v83 = std::string::_S_construct<char *>(a3, v3, (void *)a2, *(_DWORD *)(v27 + 20), v28, (int)&v81);
      std::string::swap((std::string *)&v82, (std::string *)&v83);
    }
    v30 = v83 - 12;
    if ( (_DWORD *)(v83 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v62 = _InterlockedExchangeAdd((volatile signed __int32 *)(v83 - 4), 0xFFFFFFFF);
      }
      else
      {
        v62 = *(_DWORD *)(v83 - 4);
        *(_DWORD *)(v83 - 4) = v62 - 1;
      }
      if ( v62 <= 0 )
        std::string::_Rep::_M_destroy(v30, &v80);
    }
  }
  else
  {
    std::string::assign((std::string *)&v82, (const std::string *)(v27 + 40));
  }
  v84 = (int)&unk_80CF5DC;
  v95 = (int)&unk_80CF5F0;
  v85 = (int)&unk_80CF588;
  v31 = v94 - 12;
  if ( (_DWORD *)(v94 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v63 = _InterlockedExchangeAdd((volatile signed __int32 *)(v94 - 4), 0xFFFFFFFF);
    }
    else
    {
      v63 = *(_DWORD *)(v94 - 4);
      *(_DWORD *)(v94 - 4) = v63 - 1;
    }
    if ( v63 <= 0 )
      std::string::_Rep::_M_destroy(v31, &v83);
  }
  v85 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v92);
  v84 = dword_80CF674;
  *(int *)((char *)&v84 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  v95 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v95);
  if ( byte_80CE64C )
  {
    v32 = (std::ostream *)std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v82, *(_DWORD *)(v82 - 12));
    v77 = *(std::ios_base **)((char *)v32 + *(_DWORD *)(*(_DWORD *)v32 - 12) + 124);
    if ( v77 )
    {
      if ( *((_BYTE *)v77 + 28) )
      {
        v33 = *((_BYTE *)v77 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(v77);
        v33 = (*(int (__cdecl **)(std::ios_base *, signed int))(*(_DWORD *)v77 + 24))(v77, 10);
      }
      v34 = (std::ostream *)std::ostream::put(v32, v33);
      std::ostream::flush(v34);
      goto LABEL_44;
    }
    v58 = std::__throw_bad_cast();
    goto LABEL_100;
  }
LABEL_44:
  syslog(7, "%s", v82, v68);
  v35 = v82 - 12;
  if ( (_DWORD *)(v82 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v66 = _InterlockedExchangeAdd((volatile signed __int32 *)(v82 - 4), 0xFFFFFFFF);
    }
    else
    {
      v66 = *(_DWORD *)(v82 - 4);
      *(_DWORD *)(v82 - 4) = v66 - 1;
    }
    if ( v66 <= 0 )
      std::string::_Rep::_M_destroy(v35, &v84);
  }
  v5 = *(_DWORD *)a3;
  if ( *(_DWORD *)a3 )
  {
    v36 = *(_BYTE *)(a3 + 4);
    if ( *(_DWORD *)(a2 + 156) != *(_DWORD *)(a2 + 152) )
    {
      if ( v36 )
      {
        v9 = 0;
LABEL_7:
        if ( *(_DWORD *)a3 && !*(_BYTE *)(a3 + 4) )
        {
          v16 = evhttp_request_get_input_buffer(*(_DWORD *)a3);
          v10 = evbuffer_get_length(v16);
        }
        else
        {
          v10 = 0;
        }
        sub_8058890((void *)(a2 + 152), *(void **)(a2 + 156), v9, v9 + v10);
        s = *(void **)(a2 + 152);
        v76 = *(_DWORD *)(a2 + 156) - (_DWORD)s;
        goto LABEL_11;
      }
LABEL_6:
      v6 = evhttp_request_get_input_buffer(v5);
      v7 = evbuffer_get_length(v6);
      v8 = evhttp_request_get_input_buffer(*(_DWORD *)a3);
      v9 = evbuffer_pullup(v8, v7);
      goto LABEL_7;
    }
    if ( v36 )
    {
      s = 0;
      goto LABEL_53;
    }
LABEL_52:
    v37 = evhttp_request_get_input_buffer(v5);
    v38 = evbuffer_get_length(v37);
    v39 = evhttp_request_get_input_buffer(*(_DWORD *)a3);
    s = (void *)evbuffer_pullup(v39, v38);
LABEL_53:
    if ( *(_DWORD *)a3 && !*(_BYTE *)(a3 + 4) )
    {
      v40 = evhttp_request_get_input_buffer(*(_DWORD *)a3);
      v76 = evbuffer_get_length(v40);
    }
    else
    {
      v76 = 0;
    }
    goto LABEL_11;
  }
  v76 = 0;
  s = 0;
LABEL_11:
  v11 = *(_DWORD *)(a2 + 168);
  if ( *(_DWORD *)(a2 + 164) != v11 )
  {
    v12 = *(_DWORD *)(a2 + 164);
    do
    {
      v13 = *(_DWORD *)(v12 + 4);
      if ( v13 )
      {
        if ( v13 == 1 )
          goto LABEL_17;
      }
      else
      {
        sub_80A61F0(v12, *(_DWORD *)a3, s, v76);
        if ( *(_DWORD *)(v12 + 4) == 1 )
        {
LABEL_17:
          v4 = a2;
          *(_BYTE *)(a2 + 176) = 1;
          return sub_80AE8A0(a1, v4, 1);
        }
      }
      v12 += 16;
    }
    while ( v11 != v12 );
    v4 = a2;
  }
  return sub_80AE8A0(a1, v4, 1);
}
// 804C470: using guessed type int __cdecl std::ostream::operator<<(_DWORD, _DWORD);
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804C9C0: using guessed type int __cdecl evbuffer_get_length(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CDA0: using guessed type int __cdecl evbuffer_pullup(_DWORD, _DWORD);
// 804D0A0: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::clear(_DWORD, _DWORD);
// 804D110: using guessed type int __cdecl std::ostream::_M_insert<unsigned long>(_DWORD, _DWORD);
// 804D140: using guessed type int __cdecl std::ostream::_M_insert<double>(_DWORD, _DWORD, _DWORD);
// 804D1F0: using guessed type int __cdecl evhttp_request_get_input_buffer(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080B0890) --------------------------------------------------------
int __cdecl sub_80B0890(int **a1, int a2)
{
  return sub_80AF960(**a1, (*a1)[1], a2);
}

//----- (080B08C0) --------------------------------------------------------
int __cdecl sub_80B08C0(int **a1, int a2)
{
  return sub_80AF960(**a1, (*a1)[1], a2);
}

//----- (080B0A40) --------------------------------------------------------
int __cdecl sub_80B0A40(int a1)
{
  int v1; // eax@1
  int v2; // esi@1
  int v3; // ebx@3
  void *v4; // ebp@9
  void *v5; // ebx@9
  int v6; // eax@10
  int v7; // edx@10
  int v8; // eax@15
  int v9; // eax@17
  int v10; // eax@19
  int v11; // edx@22
  int v12; // ecx@24
  int v13; // eax@28
  int v14; // eax@31
  int result; // eax@32
  signed __int32 v16; // eax@43
  signed __int32 v17; // ecx@46
  char v18; // [sp+1Fh] [bp-1Dh]@45

  *(_DWORD *)a1 = &off_80BE388;
  v1 = *(_DWORD *)(a1 + 16);
  v2 = a1 + 12;
  if ( v1 != a1 + 12 )
  {
    while ( 1 )
    {
      if ( v1 )
      {
        v3 = *(_DWORD *)(v1 + 4);
        if ( v1 != 140 )
          (*(void (__cdecl **)(int))(*(_DWORD *)(v1 - 140) + 4))(v1 - 140);
        if ( v2 == v3 )
          break;
      }
      else
      {
        v3 = ::v4;
        if ( v2 == ::v4 )
          break;
      }
      v1 = v3;
    }
  }
  v4 = *(void **)(a1 + 36);
  v5 = *(void **)(a1 + 32);
  if ( v4 != v5 )
  {
    do
    {
      v6 = *(_DWORD *)v5;
      v7 = *(_DWORD *)v5 - 12;
      if ( (_DWORD *)v7 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v16 = _InterlockedExchangeAdd((volatile signed __int32 *)(v6 - 4), 0xFFFFFFFF);
        }
        else
        {
          v17 = *(_DWORD *)(v6 - 4);
          *(_DWORD *)(v6 - 4) = v17 - 1;
          v16 = v17;
        }
        if ( v16 <= 0 )
          std::string::_Rep::_M_destroy(v7, &v18);
      }
      v5 = (char *)v5 + 4;
    }
    while ( v4 != v5 );
    v4 = *(void **)(a1 + 32);
  }
  if ( v4 )
    operator delete(v4);
  v8 = *(_DWORD *)(a1 + 28);
  if ( v8 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v8 + 4));
    if ( !v8 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v9 = *(_DWORD *)(a1 + 24);
  if ( v9 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v9 + 4));
    if ( !v9 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v10 = *(_DWORD *)(a1 + 16);
  if ( v2 == v10 )
  {
    *(_DWORD *)(a1 + 12) = &off_80BB6A0;
    goto LABEL_28;
  }
  while ( 1 )
  {
    v11 = *(_DWORD *)(v10 + 4);
    if ( v11 )
    {
      *(_DWORD *)(v11 + 8) = *(_DWORD *)(v10 + 8);
      v11 = *(_DWORD *)(v10 + 4);
    }
    v12 = *(_DWORD *)(v10 + 8);
    if ( v12 )
    {
      *(_DWORD *)(v12 + 4) = v11;
      v11 = *(_DWORD *)(v10 + 4);
    }
    *(_DWORD *)(v10 + 4) = 0;
    *(_DWORD *)(v10 + 8) = 0;
    if ( v2 == v11 )
      break;
    v10 = v11;
  }
  v2 = *(_DWORD *)(a1 + 16);
  *(_DWORD *)(a1 + 12) = &off_80BB6A0;
  if ( v2 )
  {
LABEL_28:
    *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 20);
    v13 = *(_DWORD *)(a1 + 20);
    if ( !v13 )
    {
LABEL_30:
      *(_DWORD *)(a1 + 16) = 0;
      *(_DWORD *)(a1 + 20) = 0;
      goto LABEL_31;
    }
LABEL_29:
    *(_DWORD *)(v13 + 4) = *(_DWORD *)(a1 + 16);
    goto LABEL_30;
  }
  v13 = *(_DWORD *)(a1 + 20);
  if ( v13 )
    goto LABEL_29;
LABEL_31:
  *(_DWORD *)a1 = &off_80B9500;
  v14 = *(_DWORD *)(a1 + 4);
  if ( v14 )
  {
    *(_DWORD *)(v14 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_34:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_33:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_34;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_33;
  return result;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BB6A0: using guessed type int (__cdecl *off_80BB6A0)(int);
// 80BE388: using guessed type int (__cdecl *off_80BE388)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (080B0C50) --------------------------------------------------------
void __cdecl sub_80B0C50(void *a1)
{
  char *v1; // eax@1
  char *v2; // esi@1
  char *v3; // ebx@3
  void *v4; // ebp@9
  void *v5; // ebx@9
  int v6; // eax@10
  int v7; // edx@10
  int v8; // eax@15
  int v9; // eax@17
  int v10; // eax@19
  int v11; // edx@22
  int v12; // ecx@24
  int v13; // eax@28
  int v14; // eax@31
  int v15; // eax@32
  signed __int32 v16; // eax@43
  signed __int32 v17; // ecx@46
  char v18; // [sp+1Fh] [bp-1Dh]@45

  *(_DWORD *)a1 = &off_80BE388;
  v1 = (char *)*((_DWORD *)a1 + 4);
  v2 = (char *)a1 + 12;
  if ( v1 != (char *)a1 + 12 )
  {
    while ( 1 )
    {
      if ( v1 )
      {
        v3 = (char *)*((_DWORD *)v1 + 1);
        if ( v1 != (char *)140 )
          (*(void (__cdecl **)(int))(*((_DWORD *)v1 - 35) + 4))(v1 - 140);
        if ( v2 == v3 )
          break;
      }
      else
      {
        v3 = (char *)::v4;
        if ( v2 == (char *)::v4 )
          break;
      }
      v1 = v3;
    }
  }
  v4 = (void *)*((_DWORD *)a1 + 9);
  v5 = (void *)*((_DWORD *)a1 + 8);
  if ( v4 != v5 )
  {
    do
    {
      v6 = *(_DWORD *)v5;
      v7 = *(_DWORD *)v5 - 12;
      if ( (_DWORD *)v7 != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v16 = _InterlockedExchangeAdd((volatile signed __int32 *)(v6 - 4), 0xFFFFFFFF);
        }
        else
        {
          v17 = *(_DWORD *)(v6 - 4);
          *(_DWORD *)(v6 - 4) = v17 - 1;
          v16 = v17;
        }
        if ( v16 <= 0 )
          std::string::_Rep::_M_destroy(v7, &v18);
      }
      v5 = (char *)v5 + 4;
    }
    while ( v4 != v5 );
    v4 = (void *)*((_DWORD *)a1 + 8);
  }
  if ( v4 )
    operator delete(v4);
  v8 = *((_DWORD *)a1 + 7);
  if ( v8 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v8 + 4));
    if ( !v8 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v9 = *((_DWORD *)a1 + 6);
  if ( v9 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v9 + 4));
    if ( !v9 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v10 = *((_DWORD *)a1 + 4);
  if ( v2 == (char *)v10 )
  {
    *((_DWORD *)a1 + 3) = &off_80BB6A0;
    goto LABEL_28;
  }
  while ( 1 )
  {
    v11 = *(_DWORD *)(v10 + 4);
    if ( v11 )
    {
      *(_DWORD *)(v11 + 8) = *(_DWORD *)(v10 + 8);
      v11 = *(_DWORD *)(v10 + 4);
    }
    v12 = *(_DWORD *)(v10 + 8);
    if ( v12 )
    {
      *(_DWORD *)(v12 + 4) = v11;
      v11 = *(_DWORD *)(v10 + 4);
    }
    *(_DWORD *)(v10 + 4) = 0;
    *(_DWORD *)(v10 + 8) = 0;
    if ( v2 == (char *)v11 )
      break;
    v10 = v11;
  }
  v2 = (char *)*((_DWORD *)a1 + 4);
  *((_DWORD *)a1 + 3) = &off_80BB6A0;
  if ( v2 )
  {
LABEL_28:
    *((_DWORD *)v2 + 2) = *((_DWORD *)a1 + 5);
    v13 = *((_DWORD *)a1 + 5);
    if ( !v13 )
    {
LABEL_30:
      *((_DWORD *)a1 + 4) = 0;
      *((_DWORD *)a1 + 5) = 0;
      goto LABEL_31;
    }
LABEL_29:
    *(_DWORD *)(v13 + 4) = *((_DWORD *)a1 + 4);
    goto LABEL_30;
  }
  v13 = *((_DWORD *)a1 + 5);
  if ( v13 )
    goto LABEL_29;
LABEL_31:
  *(_DWORD *)a1 = &off_80B9500;
  v14 = *((_DWORD *)a1 + 1);
  if ( !v14 )
  {
    v15 = *((_DWORD *)a1 + 2);
    if ( !v15 )
      goto LABEL_35;
    goto LABEL_33;
  }
  *(_DWORD *)(v14 + 8) = *((_DWORD *)a1 + 2);
  v15 = *((_DWORD *)a1 + 2);
  if ( v15 )
LABEL_33:
    *(_DWORD *)(v15 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_35:
  operator delete(a1);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BB6A0: using guessed type int (__cdecl *off_80BB6A0)(int);
// 80BE388: using guessed type int (__cdecl *off_80BE388)(int);
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (080B0E70) --------------------------------------------------------
int __userpurge sub_80B0E70@<eax>(int a1, int a2, const char **a3)
{
  const char *v3; // edi@1
  int v4; // eax@1
  int v5; // ebx@1
  std::string *v6; // ebp@1
  unsigned int v7; // eax@1
  unsigned int v8; // eax@5
  int v9; // eax@6
  int v10; // edx@6
  int v11; // ecx@8
  int v12; // edx@8
  int v13; // edx@9
  int v14; // ecx@10
  int v15; // edx@10
  int v16; // eax@11
  int v17; // ecx@12
  int v19; // esi@15
  char v20; // [sp+1Fh] [bp-1Dh]@15

  v3 = *a3;
  v4 = operator new(0x2Cu);
  v5 = v4;
  *(_DWORD *)(v4 + 4) = 0;
  *(_DWORD *)v4 = &off_80BA2F8;
  v6 = (std::string *)(v4 + 8);
  std::string::string((std::string *)(v4 + 8), (const std::string *)(a2 + 8));
  *(_DWORD *)(v5 + 12) = 0;
  *(_DWORD *)(v5 + 16) = 0;
  *(_DWORD *)(v5 + 20) = 0;
  *(_DWORD *)(v5 + 24) = 0;
  *(_DWORD *)(v5 + 28) = 0;
  *(_DWORD *)(v5 + 32) = 0;
  *(_DWORD *)(v5 + 36) = *(_DWORD *)(a2 + 36);
  v7 = *(_DWORD *)(a2 + 40);
  *(_DWORD *)(v5 + 40) = v7;
  if ( v3 )
  {
    if ( v7 > *(_DWORD *)(*(_DWORD *)(v5 + 8) - 12) )
    {
      v19 = std::__throw_out_of_range("basic_string::erase");
      std::string::_Rep::_M_dispose(*(_DWORD *)(v5 + 8) - 12, &v20);
      *(_DWORD *)v5 = &off_80BA2E8;
      operator delete((void *)v5);
      Unwind_Resume(v19);
    }
    std::string::_M_mutate(v6, v7, *(_DWORD *)(*(_DWORD *)(v5 + 8) - 12) - v7, 0);
    if ( *v3 != 47 )
      std::string::append(v6, "/", 1u);
    v8 = strlen(v3);
    std::string::append(v6, v3, v8);
  }
  v9 = *(_DWORD *)(v5 + 8);
  v10 = *(_DWORD *)(a2 + 12);
  if ( v10 )
    v10 = v9 + v10 - *(_DWORD *)(a2 + 8);
  v11 = *(_DWORD *)(a2 + 16);
  *(_DWORD *)(v5 + 12) = v10;
  *(_DWORD *)(v5 + 16) = v11;
  v12 = *(_DWORD *)(a2 + 28);
  if ( v12 )
    v13 = v9 + v12 - *(_DWORD *)(a2 + 8);
  else
    v13 = 0;
  v14 = *(_DWORD *)(a2 + 32);
  *(_DWORD *)(v5 + 28) = v13;
  *(_DWORD *)(v5 + 32) = v14;
  v15 = *(_DWORD *)(a2 + 20);
  if ( v15 )
    v16 = v15 - *(_DWORD *)(a2 + 8) + v9;
  else
    v16 = 0;
  v17 = *(_DWORD *)(a2 + 24);
  *(_DWORD *)(v5 + 20) = v16;
  *(_DWORD *)(v5 + 24) = v17;
  *(_DWORD *)a1 = v5;
  _InterlockedIncrement((volatile signed __int32 *)(v5 + 4));
  return a1;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA2F8: using guessed type void *off_80BA2F8;

//----- (080B1010) --------------------------------------------------------
int __userpurge sub_80B1010@<eax>(int a1, int a2)
{
  int v2; // ebx@1
  int v3; // edx@1
  signed __int32 v5; // eax@4
  signed __int32 v6; // ecx@7
  char v7; // [sp+1Ah] [bp-12h]@1
  char v8; // [sp+1Bh] [bp-11h]@6
  int v9; // [sp+1Ch] [bp-10h]@1

  std::string::string(&v9, a2, &v7);
  v2 = operator new(0x2Cu);
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)v2 = &off_80BA2F8;
  std::string::string((std::string *)(v2 + 8), (const std::string *)&v9);
  *(_DWORD *)(v2 + 12) = 0;
  *(_DWORD *)(v2 + 16) = 0;
  *(_DWORD *)(v2 + 20) = 0;
  *(_DWORD *)(v2 + 24) = 0;
  *(_DWORD *)(v2 + 28) = 0;
  *(_DWORD *)(v2 + 32) = 0;
  *(_DWORD *)(v2 + 36) = 0;
  *(_DWORD *)(v2 + 40) = 0;
  sub_808ABF0(v2, *(char **)(v2 + 8));
  *(_DWORD *)a1 = v2;
  _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
  v3 = v9 - 12;
  if ( (_DWORD *)(v9 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v5 = _InterlockedExchangeAdd((volatile signed __int32 *)(v9 - 4), 0xFFFFFFFF);
    }
    else
    {
      v6 = *(_DWORD *)(v9 - 4);
      *(_DWORD *)(v9 - 4) = v6 - 1;
      v5 = v6;
    }
    if ( v5 <= 0 )
      std::string::_Rep::_M_destroy(v3, &v8);
  }
  return a1;
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 80BA2F8: using guessed type void *off_80BA2F8;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (080B1150) --------------------------------------------------------
int __cdecl sub_80B1150(int a1)
{
  int v1; // eax@1
  int v2; // edx@4
  int v3; // ecx@6
  int result; // eax@10
  int v5; // eax@2

  v1 = *(_DWORD *)(a1 + 4);
  if ( v1 == a1 )
  {
    *(_DWORD *)a1 = &off_80B9500;
    v5 = a1;
    goto LABEL_10;
  }
  while ( 1 )
  {
    v2 = *(_DWORD *)(v1 + 4);
    if ( v2 )
    {
      *(_DWORD *)(v2 + 8) = *(_DWORD *)(v1 + 8);
      v2 = *(_DWORD *)(v1 + 4);
    }
    v3 = *(_DWORD *)(v1 + 8);
    if ( v3 )
    {
      *(_DWORD *)(v3 + 4) = v2;
      v2 = *(_DWORD *)(v1 + 4);
    }
    *(_DWORD *)(v1 + 4) = 0;
    *(_DWORD *)(v1 + 8) = 0;
    if ( a1 == v2 )
      break;
    v1 = v2;
  }
  v5 = *(_DWORD *)(a1 + 4);
  *(_DWORD *)a1 = &off_80B9500;
  if ( v5 )
  {
LABEL_10:
    *(_DWORD *)(v5 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_12:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_11:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_12;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_11;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);

//----- (080B11F0) --------------------------------------------------------
int __cdecl sub_80B11F0(int a1)
{
  int v1; // eax@1
  int v2; // edx@4
  int v3; // ecx@6
  int result; // eax@10
  int v5; // eax@2

  v1 = *(_DWORD *)(a1 + 4);
  if ( v1 == a1 )
  {
    *(_DWORD *)a1 = &off_80B9500;
    v5 = a1;
    goto LABEL_10;
  }
  while ( 1 )
  {
    v2 = *(_DWORD *)(v1 + 4);
    if ( v2 )
    {
      *(_DWORD *)(v2 + 8) = *(_DWORD *)(v1 + 8);
      v2 = *(_DWORD *)(v1 + 4);
    }
    v3 = *(_DWORD *)(v1 + 8);
    if ( v3 )
    {
      *(_DWORD *)(v3 + 4) = v2;
      v2 = *(_DWORD *)(v1 + 4);
    }
    *(_DWORD *)(v1 + 4) = 0;
    *(_DWORD *)(v1 + 8) = 0;
    if ( a1 == v2 )
      break;
    v1 = v2;
  }
  v5 = *(_DWORD *)(a1 + 4);
  *(_DWORD *)a1 = &off_80B9500;
  if ( v5 )
  {
LABEL_10:
    *(_DWORD *)(v5 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_12:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_11:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_12;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_11;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);

//----- (080B1290) --------------------------------------------------------
int __cdecl sub_80B1290(int a1)
{
  int v1; // eax@1
  int v2; // edx@4
  int v3; // ecx@6
  int result; // eax@10
  int v5; // eax@2

  v1 = *(_DWORD *)(a1 + 4);
  if ( v1 == a1 )
  {
    *(_DWORD *)a1 = &off_80B94F0;
    v5 = a1;
    goto LABEL_10;
  }
  while ( 1 )
  {
    v2 = *(_DWORD *)(v1 + 4);
    if ( v2 )
    {
      *(_DWORD *)(v2 + 8) = *(_DWORD *)(v1 + 8);
      v2 = *(_DWORD *)(v1 + 4);
    }
    v3 = *(_DWORD *)(v1 + 8);
    if ( v3 )
    {
      *(_DWORD *)(v3 + 4) = v2;
      v2 = *(_DWORD *)(v1 + 4);
    }
    *(_DWORD *)(v1 + 4) = 0;
    *(_DWORD *)(v1 + 8) = 0;
    if ( a1 == v2 )
      break;
    v1 = v2;
  }
  v5 = *(_DWORD *)(a1 + 4);
  *(_DWORD *)a1 = &off_80B94F0;
  if ( v5 )
  {
LABEL_10:
    *(_DWORD *)(v5 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_12:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_11:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_12;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_11;
  return result;
}
// 80B94F0: using guessed type int (__cdecl *off_80B94F0)(int);

//----- (080B1330) --------------------------------------------------------
void __cdecl sub_80B1330(int a1, int a2, int a3)
{
  if ( *(_DWORD *)(a1 + 8) )
  {
    (*(void (**)(void))(a1 + 12))();
  }
  else
  {
    std::__throw_bad_function_call();
    sub_80B1360(a1, a2);
  }
}

//----- (080B1360) --------------------------------------------------------
void __cdecl sub_80B1360(int a1, int a2)
{
  int v2; // eax@1
  unsigned int v3; // esi@2
  unsigned __int8 v4; // cf@2
  int v5; // eax@2
  void *v6; // ebp@6
  int v7; // edx@6
  size_t v8; // eax@6
  int v9; // edi@6
  const void *v10; // ecx@7
  int v11; // edi@10

  v2 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  if ( v2 )
  {
    v3 = -4;
    v4 = __CFADD__(v2, v2);
    v5 = 2 * v2;
    if ( !v4 && (unsigned int)v5 <= 0x3FFFFFFF )
      v3 = 4 * v5;
  }
  else
  {
    v3 = 4;
  }
  v6 = (void *)operator new(v3);
  v7 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
  v8 = 4 * v7;
  v9 = (int)((char *)v6 + 4 * v7);
  if ( v9 )
  {
    *(_DWORD *)v9 = *(_DWORD *)a2;
    v10 = *(const void **)a1;
    v7 = (*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) >> 2;
    v8 = 4 * v7;
    v9 = (int)((char *)v6 + 4 * v7);
  }
  else
  {
    v10 = *(const void **)a1;
  }
  if ( v7 )
  {
    memmove(v6, v10, v8);
    v10 = *(const void **)a1;
  }
  v11 = v9 + 4;
  if ( v10 )
    operator delete((void *)v10);
  *(_DWORD *)a1 = v6;
  *(_DWORD *)(a1 + 4) = v11;
  *(_DWORD *)(a1 + 8) = (char *)v6 + v3;
}

//----- (080B1420) --------------------------------------------------------
int __userpurge sub_80B1420@<eax>(int a1, int a2, int a3, const void **a4)
{
  int v4; // eax@1
  const void *v5; // ebp@2
  size_t v6; // ebx@2
  int v7; // esi@2
  int v8; // ecx@3
  const void *v9; // eax@3
  const void *v10; // eax@4
  const void *v11; // eax@5
  int v13; // eax@11
  int v14; // ST1C_4@13
  int v15; // eax@13
  const void *v16; // edi@22
  size_t v17; // ebx@22
  int v18; // [sp+18h] [bp-24h]@1

  v4 = (a3 - a2) >> 2;
  v18 = (a3 - a2) >> 4;
  if ( v18 > 0 )
  {
    v5 = *a4;
    v6 = *((_DWORD *)*a4 - 3);
    v7 = a2;
    while ( *(_DWORD *)(*(_DWORD *)v7 - 12) != v6 || memcmp(*(const void **)v7, v5, v6) )
    {
      v8 = v7 - a2;
      v9 = *(const void **)(v7 + 4);
      if ( v6 == *((_DWORD *)v9 - 3) )
      {
        v13 = memcmp(v9, v5, v6);
        v8 = v7 - a2;
        if ( !v13 )
        {
          *(_DWORD *)a1 = v7 + 4;
          return a1;
        }
      }
      v10 = *(const void **)(v8 + a2 + 8);
      if ( v6 == *((_DWORD *)v10 - 3) )
      {
        v14 = v8;
        v15 = memcmp(v10, v5, v6);
        v8 = v14;
        if ( !v15 )
        {
          *(_DWORD *)a1 = v7 + 8;
          return a1;
        }
      }
      v11 = *(const void **)(v8 + a2 + 12);
      if ( v6 == *((_DWORD *)v11 - 3) && !memcmp(v11, v5, v6) )
      {
        *(_DWORD *)a1 = v7 + 12;
        return a1;
      }
      v7 += 16;
      --v18;
      if ( !v18 )
      {
        v4 = (a3 - v7) >> 2;
        goto LABEL_18;
      }
    }
    goto LABEL_9;
  }
  v7 = a2;
LABEL_18:
  if ( v4 == 2 )
  {
    v16 = *a4;
    v17 = *((_DWORD *)*a4 - 3);
  }
  else
  {
    if ( v4 != 3 )
    {
      if ( v4 != 1 )
      {
LABEL_21:
        *(_DWORD *)a1 = a3;
        return a1;
      }
      v16 = *a4;
      v17 = *((_DWORD *)*a4 - 3);
      goto LABEL_25;
    }
    v16 = *a4;
    v17 = *((_DWORD *)*a4 - 3);
    if ( *(_DWORD *)(*(_DWORD *)v7 - 12) == v17 && !memcmp(*(const void **)v7, v16, *(_DWORD *)(*(_DWORD *)v7 - 12)) )
      goto LABEL_9;
    v7 += 4;
  }
  if ( v17 == *(_DWORD *)(*(_DWORD *)v7 - 12) && !memcmp(*(const void **)v7, v16, v17) )
    goto LABEL_9;
  v7 += 4;
LABEL_25:
  if ( v17 != *(_DWORD *)(*(_DWORD *)v7 - 12) || memcmp(*(const void **)v7, v16, v17) )
    goto LABEL_21;
LABEL_9:
  *(_DWORD *)a1 = v7;
  return a1;
}

//----- (080B1640) --------------------------------------------------------
int __cdecl sub_80B1640(int a1, int a2)
{
  int v2; // eax@1
  int result; // eax@4

  v2 = *(_DWORD *)(a1 + 4);
  if ( v2 == *(_DWORD *)(a1 + 8) )
  {
    result = sub_8058720(a1, a2);
  }
  else
  {
    if ( v2 )
    {
      *(_DWORD *)v2 = *(_DWORD *)a2;
      *(_DWORD *)a2 = &unk_80CF83C;
      v2 = *(_DWORD *)(a1 + 4);
    }
    result = v2 + 4;
    *(_DWORD *)(a1 + 4) = result;
  }
  return result;
}

//----- (080B16D0) --------------------------------------------------------
int __cdecl sub_80B16D0(void **a1, void **a2, signed int a3)
{
  int result; // eax@6
  void *v4; // ebx@7
  void *v5; // eax@7

  if ( a3 == 1 )
  {
    *a1 = *a2;
    result = 0;
  }
  else if ( a3 <= 1 )
  {
    if ( a3 )
      return 0;
    *a1 = &off_80BE66C;
    result = 0;
  }
  else
  {
    if ( a3 != 2 )
    {
      if ( a3 == 3 )
        operator delete(*a1);
      return 0;
    }
    v4 = *a2;
    v5 = (void *)operator new(4u);
    *(_DWORD *)v5 = *(_DWORD *)v4;
    *a1 = v5;
    result = 0;
  }
  return result;
}
// 80BE66C: using guessed type void *off_80BE66C;

//----- (080B1770) --------------------------------------------------------
int __cdecl sub_80B1770(int a1, int a2)
{
  char *v2; // esi@1
  bool v3; // zf@2
  int v4; // edi@3
  signed int v5; // ecx@3
  int result; // eax@7

  v2 = *(char **)(a2 + 4);
  if ( v2 == "St19_Sp_make_shared_tag" )
    goto LABEL_11;
  v3 = *v2 == 42;
  if ( *v2 == 42 )
    goto LABEL_12;
  v4 = (int)"St19_Sp_make_shared_tag";
  v5 = 24;
  do
  {
    if ( !v5 )
      break;
    v3 = *v2++ == *(_BYTE *)v4++;
    --v5;
  }
  while ( v3 );
  if ( v3 )
LABEL_11:
    result = a1 + 16;
  else
LABEL_12:
    result = 0;
  return result;
}

//----- (080B18C0) --------------------------------------------------------
int __cdecl sub_80B18C0(int a1)
{
  void *v1; // esi@2
  int v2; // eax@4
  int v3; // edx@7
  int v4; // ecx@9
  int v5; // eax@13
  int v6; // eax@16
  int v7; // edx@19
  int v8; // ecx@21
  int v9; // eax@25
  int v10; // eax@28
  int v11; // edx@31
  int v12; // ecx@33
  int v13; // eax@37
  int v14; // eax@40
  int v15; // edx@43
  int v16; // ecx@45
  int v17; // eax@49
  int v18; // eax@52
  int v19; // edx@55
  int v20; // ecx@57
  int v21; // eax@61
  int v22; // eax@64
  int v23; // edx@67
  int v24; // ecx@69
  int v25; // eax@73
  int v26; // esi@76
  int v27; // eax@78
  int v28; // edx@81
  int v29; // ecx@83
  int v30; // eax@87
  int v31; // eax@90
  int v32; // edx@93
  int v33; // ecx@95
  int v34; // eax@99
  int v35; // eax@102
  int v36; // edx@105
  int v37; // ecx@107
  int v38; // eax@111
  int result; // eax@118

  *(_BYTE *)(a1 + 328) = 0;
  std::thread::join((std::thread *)(a1 + 332));
  if ( !pthread_equal(*(_DWORD *)(a1 + 332), 0) )
    std::terminate();
  sub_804E980((void *)(a1 + 244));
  v1 = *(void **)(a1 + 240);
  if ( v1 )
  {
    sub_809CB60(*(_DWORD *)(a1 + 240));
    operator delete(v1);
  }
  *(_DWORD *)(a1 + 240) = 0;
  *(_DWORD *)(a1 + 164) = &off_80BD870;
  v2 = *(_DWORD *)(a1 + 228);
  if ( v2 == a1 + 224 )
  {
    *(_DWORD *)(a1 + 224) = &off_80B9500;
    goto LABEL_13;
  }
  while ( 1 )
  {
    v3 = *(_DWORD *)(v2 + 4);
    if ( v3 )
    {
      *(_DWORD *)(v3 + 8) = *(_DWORD *)(v2 + 8);
      v3 = *(_DWORD *)(v2 + 4);
    }
    v4 = *(_DWORD *)(v2 + 8);
    if ( v4 )
    {
      *(_DWORD *)(v4 + 4) = v3;
      v3 = *(_DWORD *)(v2 + 4);
    }
    *(_DWORD *)(v2 + 4) = 0;
    *(_DWORD *)(v2 + 8) = 0;
    if ( a1 + 224 == v3 )
      break;
    v2 = v3;
  }
  v2 = *(_DWORD *)(a1 + 228);
  *(_DWORD *)(a1 + 224) = &off_80B9500;
  if ( v2 )
  {
LABEL_13:
    *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 232);
    v5 = *(_DWORD *)(a1 + 232);
    if ( !v5 )
    {
LABEL_15:
      *(_DWORD *)(a1 + 228) = 0;
      *(_DWORD *)(a1 + 232) = 0;
      goto LABEL_16;
    }
LABEL_14:
    *(_DWORD *)(v5 + 4) = *(_DWORD *)(a1 + 228);
    goto LABEL_15;
  }
  v5 = *(_DWORD *)(a1 + 232);
  if ( v5 )
    goto LABEL_14;
LABEL_16:
  v6 = *(_DWORD *)(a1 + 216);
  if ( v6 == a1 + 212 )
  {
    *(_DWORD *)(a1 + 212) = &off_80B9500;
    goto LABEL_25;
  }
  while ( 1 )
  {
    v7 = *(_DWORD *)(v6 + 4);
    if ( v7 )
    {
      *(_DWORD *)(v7 + 8) = *(_DWORD *)(v6 + 8);
      v7 = *(_DWORD *)(v6 + 4);
    }
    v8 = *(_DWORD *)(v6 + 8);
    if ( v8 )
    {
      *(_DWORD *)(v8 + 4) = v7;
      v7 = *(_DWORD *)(v6 + 4);
    }
    *(_DWORD *)(v6 + 4) = 0;
    *(_DWORD *)(v6 + 8) = 0;
    if ( a1 + 212 == v7 )
      break;
    v6 = v7;
  }
  v6 = *(_DWORD *)(a1 + 216);
  *(_DWORD *)(a1 + 212) = &off_80B9500;
  if ( v6 )
  {
LABEL_25:
    *(_DWORD *)(v6 + 8) = *(_DWORD *)(a1 + 220);
    v9 = *(_DWORD *)(a1 + 220);
    if ( !v9 )
    {
LABEL_27:
      *(_DWORD *)(a1 + 216) = 0;
      *(_DWORD *)(a1 + 220) = 0;
      goto LABEL_28;
    }
LABEL_26:
    *(_DWORD *)(v9 + 4) = *(_DWORD *)(a1 + 216);
    goto LABEL_27;
  }
  v9 = *(_DWORD *)(a1 + 220);
  if ( v9 )
    goto LABEL_26;
LABEL_28:
  v10 = *(_DWORD *)(a1 + 204);
  if ( v10 == a1 + 200 )
  {
    *(_DWORD *)(a1 + 200) = &off_80B9500;
    goto LABEL_37;
  }
  while ( 1 )
  {
    v11 = *(_DWORD *)(v10 + 4);
    if ( v11 )
    {
      *(_DWORD *)(v11 + 8) = *(_DWORD *)(v10 + 8);
      v11 = *(_DWORD *)(v10 + 4);
    }
    v12 = *(_DWORD *)(v10 + 8);
    if ( v12 )
    {
      *(_DWORD *)(v12 + 4) = v11;
      v11 = *(_DWORD *)(v10 + 4);
    }
    *(_DWORD *)(v10 + 4) = 0;
    *(_DWORD *)(v10 + 8) = 0;
    if ( a1 + 200 == v11 )
      break;
    v10 = v11;
  }
  v10 = *(_DWORD *)(a1 + 204);
  *(_DWORD *)(a1 + 200) = &off_80B9500;
  if ( v10 )
  {
LABEL_37:
    *(_DWORD *)(v10 + 8) = *(_DWORD *)(a1 + 208);
    v13 = *(_DWORD *)(a1 + 208);
    if ( !v13 )
    {
LABEL_39:
      *(_DWORD *)(a1 + 204) = 0;
      *(_DWORD *)(a1 + 208) = 0;
      goto LABEL_40;
    }
LABEL_38:
    *(_DWORD *)(v13 + 4) = *(_DWORD *)(a1 + 204);
    goto LABEL_39;
  }
  v13 = *(_DWORD *)(a1 + 208);
  if ( v13 )
    goto LABEL_38;
LABEL_40:
  *(_DWORD *)(a1 + 92) = &off_80BEAB8;
  v14 = *(_DWORD *)(a1 + 156);
  if ( v14 == a1 + 152 )
  {
    *(_DWORD *)(a1 + 152) = &off_80B9500;
    goto LABEL_49;
  }
  while ( 1 )
  {
    v15 = *(_DWORD *)(v14 + 4);
    if ( v15 )
    {
      *(_DWORD *)(v15 + 8) = *(_DWORD *)(v14 + 8);
      v15 = *(_DWORD *)(v14 + 4);
    }
    v16 = *(_DWORD *)(v14 + 8);
    if ( v16 )
    {
      *(_DWORD *)(v16 + 4) = v15;
      v15 = *(_DWORD *)(v14 + 4);
    }
    *(_DWORD *)(v14 + 4) = 0;
    *(_DWORD *)(v14 + 8) = 0;
    if ( a1 + 152 == v15 )
      break;
    v14 = v15;
  }
  v14 = *(_DWORD *)(a1 + 156);
  *(_DWORD *)(a1 + 152) = &off_80B9500;
  if ( v14 )
  {
LABEL_49:
    *(_DWORD *)(v14 + 8) = *(_DWORD *)(a1 + 160);
    v17 = *(_DWORD *)(a1 + 160);
    if ( !v17 )
    {
LABEL_51:
      *(_DWORD *)(a1 + 156) = 0;
      *(_DWORD *)(a1 + 160) = 0;
      goto LABEL_52;
    }
LABEL_50:
    *(_DWORD *)(v17 + 4) = *(_DWORD *)(a1 + 156);
    goto LABEL_51;
  }
  v17 = *(_DWORD *)(a1 + 160);
  if ( v17 )
    goto LABEL_50;
LABEL_52:
  v18 = *(_DWORD *)(a1 + 144);
  if ( v18 == a1 + 140 )
  {
    *(_DWORD *)(a1 + 140) = &off_80B9500;
    goto LABEL_61;
  }
  while ( 1 )
  {
    v19 = *(_DWORD *)(v18 + 4);
    if ( v19 )
    {
      *(_DWORD *)(v19 + 8) = *(_DWORD *)(v18 + 8);
      v19 = *(_DWORD *)(v18 + 4);
    }
    v20 = *(_DWORD *)(v18 + 8);
    if ( v20 )
    {
      *(_DWORD *)(v20 + 4) = v19;
      v19 = *(_DWORD *)(v18 + 4);
    }
    *(_DWORD *)(v18 + 4) = 0;
    *(_DWORD *)(v18 + 8) = 0;
    if ( a1 + 140 == v19 )
      break;
    v18 = v19;
  }
  v18 = *(_DWORD *)(a1 + 144);
  *(_DWORD *)(a1 + 140) = &off_80B9500;
  if ( v18 )
  {
LABEL_61:
    *(_DWORD *)(v18 + 8) = *(_DWORD *)(a1 + 148);
    v21 = *(_DWORD *)(a1 + 148);
    if ( !v21 )
    {
LABEL_63:
      *(_DWORD *)(a1 + 144) = 0;
      *(_DWORD *)(a1 + 148) = 0;
      goto LABEL_64;
    }
LABEL_62:
    *(_DWORD *)(v21 + 4) = *(_DWORD *)(a1 + 144);
    goto LABEL_63;
  }
  v21 = *(_DWORD *)(a1 + 148);
  if ( v21 )
    goto LABEL_62;
LABEL_64:
  v22 = *(_DWORD *)(a1 + 132);
  if ( v22 == a1 + 128 )
  {
    *(_DWORD *)(a1 + 128) = &off_80B9500;
    goto LABEL_73;
  }
  while ( 1 )
  {
    v23 = *(_DWORD *)(v22 + 4);
    if ( v23 )
    {
      *(_DWORD *)(v23 + 8) = *(_DWORD *)(v22 + 8);
      v23 = *(_DWORD *)(v22 + 4);
    }
    v24 = *(_DWORD *)(v22 + 8);
    if ( v24 )
    {
      *(_DWORD *)(v24 + 4) = v23;
      v23 = *(_DWORD *)(v22 + 4);
    }
    *(_DWORD *)(v22 + 4) = 0;
    *(_DWORD *)(v22 + 8) = 0;
    if ( a1 + 128 == v23 )
      break;
    v22 = v23;
  }
  v22 = *(_DWORD *)(a1 + 132);
  *(_DWORD *)(a1 + 128) = &off_80B9500;
  if ( v22 )
  {
LABEL_73:
    *(_DWORD *)(v22 + 8) = *(_DWORD *)(a1 + 136);
    v25 = *(_DWORD *)(a1 + 136);
    if ( !v25 )
    {
LABEL_75:
      *(_DWORD *)(a1 + 132) = 0;
      *(_DWORD *)(a1 + 136) = 0;
      goto LABEL_76;
    }
LABEL_74:
    *(_DWORD *)(v25 + 4) = *(_DWORD *)(a1 + 132);
    goto LABEL_75;
  }
  v25 = *(_DWORD *)(a1 + 136);
  if ( v25 )
    goto LABEL_74;
LABEL_76:
  v26 = *(_DWORD *)(a1 + 88);
  if ( v26 )
  {
    evdns_base_free(*(_DWORD *)(v26 + 4), 1);
    operator delete((void *)v26);
  }
  *(_DWORD *)(a1 + 88) = 0;
  *(_DWORD *)(a1 + 16) = &off_80BEA58;
  v27 = *(_DWORD *)(a1 + 80);
  if ( v27 == a1 + 76 )
  {
    *(_DWORD *)(a1 + 76) = &off_80B9500;
    goto LABEL_87;
  }
  while ( 1 )
  {
    v28 = *(_DWORD *)(v27 + 4);
    if ( v28 )
    {
      *(_DWORD *)(v28 + 8) = *(_DWORD *)(v27 + 8);
      v28 = *(_DWORD *)(v27 + 4);
    }
    v29 = *(_DWORD *)(v27 + 8);
    if ( v29 )
    {
      *(_DWORD *)(v29 + 4) = v28;
      v28 = *(_DWORD *)(v27 + 4);
    }
    *(_DWORD *)(v27 + 4) = 0;
    *(_DWORD *)(v27 + 8) = 0;
    if ( a1 + 76 == v28 )
      break;
    v27 = v28;
  }
  v27 = *(_DWORD *)(a1 + 80);
  *(_DWORD *)(a1 + 76) = &off_80B9500;
  if ( v27 )
  {
LABEL_87:
    *(_DWORD *)(v27 + 8) = *(_DWORD *)(a1 + 84);
    v30 = *(_DWORD *)(a1 + 84);
    if ( !v30 )
    {
LABEL_89:
      *(_DWORD *)(a1 + 80) = 0;
      *(_DWORD *)(a1 + 84) = 0;
      goto LABEL_90;
    }
LABEL_88:
    *(_DWORD *)(v30 + 4) = *(_DWORD *)(a1 + 80);
    goto LABEL_89;
  }
  v30 = *(_DWORD *)(a1 + 84);
  if ( v30 )
    goto LABEL_88;
LABEL_90:
  v31 = *(_DWORD *)(a1 + 68);
  if ( v31 == a1 + 64 )
  {
    *(_DWORD *)(a1 + 64) = &off_80B9500;
    goto LABEL_99;
  }
  while ( 1 )
  {
    v32 = *(_DWORD *)(v31 + 4);
    if ( v32 )
    {
      *(_DWORD *)(v32 + 8) = *(_DWORD *)(v31 + 8);
      v32 = *(_DWORD *)(v31 + 4);
    }
    v33 = *(_DWORD *)(v31 + 8);
    if ( v33 )
    {
      *(_DWORD *)(v33 + 4) = v32;
      v32 = *(_DWORD *)(v31 + 4);
    }
    *(_DWORD *)(v31 + 4) = 0;
    *(_DWORD *)(v31 + 8) = 0;
    if ( a1 + 64 == v32 )
      break;
    v31 = v32;
  }
  v31 = *(_DWORD *)(a1 + 68);
  *(_DWORD *)(a1 + 64) = &off_80B9500;
  if ( v31 )
  {
LABEL_99:
    *(_DWORD *)(v31 + 8) = *(_DWORD *)(a1 + 72);
    v34 = *(_DWORD *)(a1 + 72);
    if ( !v34 )
    {
LABEL_101:
      *(_DWORD *)(a1 + 68) = 0;
      *(_DWORD *)(a1 + 72) = 0;
      goto LABEL_102;
    }
LABEL_100:
    *(_DWORD *)(v34 + 4) = *(_DWORD *)(a1 + 68);
    goto LABEL_101;
  }
  v34 = *(_DWORD *)(a1 + 72);
  if ( v34 )
    goto LABEL_100;
LABEL_102:
  v35 = *(_DWORD *)(a1 + 56);
  if ( v35 == a1 + 52 )
  {
    *(_DWORD *)(a1 + 52) = &off_80B9500;
    goto LABEL_111;
  }
  while ( 1 )
  {
    v36 = *(_DWORD *)(v35 + 4);
    if ( v36 )
    {
      *(_DWORD *)(v36 + 8) = *(_DWORD *)(v35 + 8);
      v36 = *(_DWORD *)(v35 + 4);
    }
    v37 = *(_DWORD *)(v35 + 8);
    if ( v37 )
    {
      *(_DWORD *)(v37 + 4) = v36;
      v36 = *(_DWORD *)(v35 + 4);
    }
    *(_DWORD *)(v35 + 4) = 0;
    *(_DWORD *)(v35 + 8) = 0;
    if ( a1 + 52 == v36 )
      break;
    v35 = v36;
  }
  v35 = *(_DWORD *)(a1 + 56);
  *(_DWORD *)(a1 + 52) = &off_80B9500;
  if ( v35 )
  {
LABEL_111:
    *(_DWORD *)(v35 + 8) = *(_DWORD *)(a1 + 60);
    v38 = *(_DWORD *)(a1 + 60);
    if ( !v38 )
    {
LABEL_113:
      *(_DWORD *)(a1 + 56) = 0;
      *(_DWORD *)(a1 + 60) = 0;
      goto LABEL_114;
    }
LABEL_112:
    *(_DWORD *)(v38 + 4) = *(_DWORD *)(a1 + 56);
    goto LABEL_113;
  }
  v38 = *(_DWORD *)(a1 + 60);
  if ( v38 )
    goto LABEL_112;
LABEL_114:
  if ( *(_DWORD *)(a1 + 4) )
    event_base_free(*(_DWORD *)(a1 + 4));
  if ( *(_DWORD *)(a1 + 8) )
    SSL_CTX_free(*(_DWORD *)(a1 + 8));
  result = *(_DWORD *)(a1 + 12);
  if ( result )
    result = SSL_CTX_free(*(_DWORD *)(a1 + 12));
  return result;
}
// 804C510: using guessed type int __cdecl event_base_free(_DWORD);
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 804D400: using guessed type int __cdecl SSL_CTX_free(_DWORD);
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BD870: using guessed type void *off_80BD870;
// 80BEA58: using guessed type void *off_80BEA58;
// 80BEAB8: using guessed type void *off_80BEAB8;

//----- (080B2020) --------------------------------------------------------
pthread_mutex_t *__usercall sub_80B2020@<eax>(int a1@<edi>, pthread_mutex_t *mutex, int a3, int a4)
{
  return sub_804FB50(a1, (pthread_mutex_t *)((char *)mutex + 244), a3, a4);
}

//----- (080B2040) --------------------------------------------------------
int __cdecl sub_80B2040(pthread_mutex_t *a1, int a2)
{
  int v2; // eax@3
  int v3; // eax@4
  char *v4; // ebp@4
  int v5; // eax@8
  char *v6; // ecx@8
  int v7; // eax@14
  char *v8; // ebp@14
  int v9; // eax@18
  char *v10; // ecx@18
  int v11; // eax@24
  char *v12; // ebp@24
  int v13; // eax@28
  char *v14; // ecx@28
  int result; // eax@32
  int v16; // edx@34
  int v17; // ecx@36
  int v18; // edi@37
  int v19; // edx@39
  int v20; // edi@41
  int v21; // edx@44
  int v22; // ecx@46
  int v23; // edi@47
  int v24; // edx@49
  int v25; // edi@51
  int v26; // edx@54
  int v27; // ecx@56
  int v28; // edi@57
  int v29; // edx@59
  int v30; // edi@61
  int v31; // [sp+8h] [bp-24h]@0
  pthread_mutex_t *v32; // [sp+Ch] [bp-20h]@1
  pthread_mutex_t *v33; // [sp+Ch] [bp-20h]@13
  pthread_mutex_t *v34; // [sp+Ch] [bp-20h]@23

  sub_804F480((pthread_mutex_t *)((char *)a1 + 244), a2, v31);
  v32 = (pthread_mutex_t *)((char *)a1 + 28);
  if ( a1 == (pthread_mutex_t *)-28 )
    goto LABEL_71;
  if ( &_pthread_key_create )
  {
    v2 = pthread_mutex_lock(v32);
    if ( v2 )
      goto LABEL_70;
  }
  v3 = a1[2].__owner;
  v4 = &a1[2].__size[4];
  while ( (char *)v3 != v4 )
  {
    while ( a2 != *(_DWORD *)(*(_DWORD *)(v3 + 28) + 8) )
    {
      v3 = *(_DWORD *)(v3 + 4);
      if ( (char *)v3 == v4 )
        goto LABEL_8;
    }
    v16 = *(_DWORD *)(v3 + 4);
    if ( v16 )
    {
      *(_DWORD *)(v16 + 8) = *(_DWORD *)(v3 + 8);
      v16 = *(_DWORD *)(v3 + 4);
    }
    v17 = *(_DWORD *)(v3 + 8);
    if ( v17 )
    {
      *(_DWORD *)(v17 + 4) = v16;
      v18 = *(_DWORD *)(v3 + 4);
    }
    else
    {
      v18 = v16;
    }
    *(_DWORD *)(v3 + 4) = 0;
    *(_DWORD *)(v3 + 8) = 0;
    (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
    v3 = v18;
  }
LABEL_8:
  v5 = a1[2].__spins;
  v6 = &a1[2].__size[16];
  while ( (char *)v5 != v6 )
  {
    while ( a2 != *(_DWORD *)(*(_DWORD *)(v5 + 28) + 8) )
    {
      v5 = *(_DWORD *)(v5 + 4);
      if ( (char *)v5 == v6 )
        goto LABEL_12;
    }
    v19 = *(_DWORD *)(v5 + 4);
    if ( v19 )
    {
      *(_DWORD *)(v19 + 8) = *(_DWORD *)(v5 + 8);
      v19 = *(_DWORD *)(v5 + 4);
    }
    v20 = *(_DWORD *)(v5 + 8);
    if ( v20 )
    {
      *(_DWORD *)(v20 + 4) = v19;
      v19 = *(_DWORD *)(v5 + 4);
    }
    *(_DWORD *)(v5 + 4) = 0;
    *(_DWORD *)(v5 + 8) = 0;
    *(_DWORD *)(v5 + 8) = a1[3].__kind;
    *(_DWORD *)(v5 + 4) = (char *)a1 + 76;
    *(_DWORD *)(a1[3].__kind + 4) = v5;
    a1[3].__kind = v5;
    v5 = v19;
  }
LABEL_12:
  if ( !&_pthread_key_create )
  {
    v33 = (pthread_mutex_t *)((char *)a1 + 104);
    goto LABEL_14;
  }
  pthread_mutex_unlock(v32);
  v33 = (pthread_mutex_t *)((char *)a1 + 104);
  v2 = pthread_mutex_lock((pthread_mutex_t *)((char *)a1 + 104));
  if ( v2 )
  {
LABEL_70:
    std::__throw_system_error(v2);
LABEL_71:
    std::__throw_system_error(1);
    return sub_80B2410((int)a1);
  }
LABEL_14:
  v7 = a1[5].__kind;
  v8 = &a1[5].__size[8];
  while ( (char *)v7 != v8 )
  {
    while ( a2 != *(_DWORD *)(*(_DWORD *)(v7 + 28) + 8) )
    {
      v7 = *(_DWORD *)(v7 + 4);
      if ( (char *)v7 == v8 )
        goto LABEL_18;
    }
    v21 = *(_DWORD *)(v7 + 4);
    if ( v21 )
    {
      *(_DWORD *)(v21 + 8) = *(_DWORD *)(v7 + 8);
      v21 = *(_DWORD *)(v7 + 4);
    }
    v22 = *(_DWORD *)(v7 + 8);
    if ( v22 )
    {
      *(_DWORD *)(v22 + 4) = v21;
      v23 = *(_DWORD *)(v7 + 4);
    }
    else
    {
      v23 = v21;
    }
    *(_DWORD *)(v7 + 4) = 0;
    *(_DWORD *)(v7 + 8) = 0;
    (*(void (__cdecl **)(int))(*(_DWORD *)v7 + 4))(v7);
    v7 = v23;
  }
LABEL_18:
  v9 = a1[6].__lock;
  v10 = &a1[5].__size[20];
  while ( (char *)v9 != v10 )
  {
    while ( a2 != *(_DWORD *)(*(_DWORD *)(v9 + 28) + 8) )
    {
      v9 = *(_DWORD *)(v9 + 4);
      if ( (char *)v9 == v10 )
        goto LABEL_22;
    }
    v24 = *(_DWORD *)(v9 + 4);
    if ( v24 )
    {
      *(_DWORD *)(v24 + 8) = *(_DWORD *)(v9 + 8);
      v24 = *(_DWORD *)(v9 + 4);
    }
    v25 = *(_DWORD *)(v9 + 8);
    if ( v25 )
    {
      *(_DWORD *)(v25 + 4) = v24;
      v24 = *(_DWORD *)(v9 + 4);
    }
    *(_DWORD *)(v9 + 4) = 0;
    *(_DWORD *)(v9 + 8) = 0;
    *(_DWORD *)(v9 + 8) = a1[6].__nusers;
    *(_DWORD *)(v9 + 4) = (char *)a1 + 152;
    *(_DWORD *)(a1[6].__nusers + 4) = v9;
    a1[6].__nusers = v9;
    v9 = v24;
  }
LABEL_22:
  if ( &_pthread_key_create )
  {
    pthread_mutex_unlock(v33);
    v34 = (pthread_mutex_t *)((char *)a1 + 176);
    v2 = pthread_mutex_lock((pthread_mutex_t *)((char *)a1 + 176));
    if ( !v2 )
      goto LABEL_24;
    goto LABEL_70;
  }
  v34 = (pthread_mutex_t *)((char *)a1 + 176);
LABEL_24:
  v11 = a1[8].__kind;
  v12 = &a1[8].__size[8];
  while ( v12 != (char *)v11 )
  {
    while ( a2 != *(_DWORD *)(*(_DWORD *)(v11 + 28) + 8) )
    {
      v11 = *(_DWORD *)(v11 + 4);
      if ( v12 == (char *)v11 )
        goto LABEL_28;
    }
    v26 = *(_DWORD *)(v11 + 4);
    if ( v26 )
    {
      *(_DWORD *)(v26 + 8) = *(_DWORD *)(v11 + 8);
      v26 = *(_DWORD *)(v11 + 4);
    }
    v27 = *(_DWORD *)(v11 + 8);
    if ( v27 )
    {
      *(_DWORD *)(v27 + 4) = v26;
      v28 = *(_DWORD *)(v11 + 4);
    }
    else
    {
      v28 = v26;
    }
    *(_DWORD *)(v11 + 4) = 0;
    *(_DWORD *)(v11 + 8) = 0;
    (*(void (__cdecl **)(int))(*(_DWORD *)v11 + 4))(v11);
    v11 = v28;
  }
LABEL_28:
  v13 = a1[9].__lock;
  v14 = &a1[8].__size[20];
  while ( v14 != (char *)v13 )
  {
    while ( a2 != *(_DWORD *)(*(_DWORD *)(v13 + 28) + 8) )
    {
      v13 = *(_DWORD *)(v13 + 4);
      if ( v14 == (char *)v13 )
        goto LABEL_32;
    }
    v29 = *(_DWORD *)(v13 + 4);
    if ( v29 )
    {
      *(_DWORD *)(v29 + 8) = *(_DWORD *)(v13 + 8);
      v29 = *(_DWORD *)(v13 + 4);
    }
    v30 = *(_DWORD *)(v13 + 8);
    if ( v30 )
    {
      *(_DWORD *)(v30 + 4) = v29;
      v29 = *(_DWORD *)(v13 + 4);
    }
    *(_DWORD *)(v13 + 4) = 0;
    *(_DWORD *)(v13 + 8) = 0;
    *(_DWORD *)(v13 + 8) = a1[9].__nusers;
    *(_DWORD *)(v13 + 4) = (char *)a1 + 224;
    *(_DWORD *)(a1[9].__nusers + 4) = v13;
    a1[9].__nusers = v13;
    v13 = v29;
  }
LABEL_32:
  result = (int)&_pthread_key_create;
  if ( &_pthread_key_create )
    result = pthread_mutex_unlock(v34);
  return result;
}

//----- (080B2410) --------------------------------------------------------
int __cdecl sub_80B2410(int a1)
{
  int v1; // eax@1
  int v2; // eax@2
  int v3; // edx@2
  int v4; // ST18_4@3
  int v5; // eax@3
  int result; // eax@4
  int v7; // ebx@4
  signed __int32 v8; // eax@6
  signed __int32 v9; // eax@10
  std::runtime_error *v10; // ebx@14
  char v11; // [sp+26h] [bp-26h]@14
  char v12; // [sp+27h] [bp-25h]@14
  int v13; // [sp+28h] [bp-24h]@4
  int v14; // [sp+2Ch] [bp-20h]@4

  *(_BYTE *)a1 = 0;
  v1 = event_base_new();
  *(_DWORD *)(a1 + 4) = v1;
  *(_DWORD *)(a1 + 8) = 0;
  *(_DWORD *)(a1 + 12) = 0;
  if ( !v1 )
  {
    v10 = (std::runtime_error *)_cxa_allocate_exception(8);
    std::string::string(&v13, "Event dispatcher initialization failed", &v12);
    std::runtime_error::runtime_error(v10, (const std::string *)&v13);
    *(_DWORD *)v10 = &off_80BAB18;
    std::string::_Rep::_M_dispose(v13 - 12, &v11);
    _cxa_throw(v10, &off_80BAADC, sub_807B6C0);
  }
  *(_DWORD *)(a1 + 16) = &off_80BEA58;
  *(_DWORD *)(a1 + 20) = a1 + 16;
  *(_DWORD *)(a1 + 24) = 0;
  memset((void *)(a1 + 28), 0, 0x18u);
  *(_DWORD *)(a1 + 52) = &off_80B9500;
  *(_DWORD *)(a1 + 56) = a1 + 52;
  *(_DWORD *)(a1 + 60) = a1 + 52;
  *(_DWORD *)(a1 + 64) = &off_80B9500;
  *(_DWORD *)(a1 + 68) = a1 + 64;
  *(_DWORD *)(a1 + 72) = a1 + 64;
  *(_DWORD *)(a1 + 76) = &off_80B9500;
  *(_DWORD *)(a1 + 80) = a1 + 76;
  *(_DWORD *)(a1 + 84) = a1 + 76;
  *(_DWORD *)(a1 + 88) = 0;
  *(_DWORD *)(a1 + 92) = &off_80BEAB8;
  *(_DWORD *)(a1 + 96) = a1 + 92;
  *(_DWORD *)(a1 + 100) = 0;
  memset((void *)(a1 + 104), 0, 0x18u);
  *(_DWORD *)(a1 + 128) = &off_80B9500;
  *(_DWORD *)(a1 + 132) = a1 + 128;
  *(_DWORD *)(a1 + 136) = a1 + 128;
  *(_DWORD *)(a1 + 140) = &off_80B9500;
  *(_DWORD *)(a1 + 144) = a1 + 140;
  *(_DWORD *)(a1 + 148) = a1 + 140;
  *(_DWORD *)(a1 + 152) = &off_80B9500;
  *(_DWORD *)(a1 + 156) = a1 + 152;
  *(_DWORD *)(a1 + 160) = a1 + 152;
  sub_809CA20(a1 + 164);
  sub_804E8E0(a1 + 244);
  *(_BYTE *)(a1 + 328) = 1;
  *(_DWORD *)(a1 + 332) = 0;
  v2 = operator new(0x20u);
  v3 = v2;
  if ( v2 )
  {
    *(_DWORD *)(v2 + 4) = 1;
    *(_DWORD *)(v2 + 8) = 1;
    *(_DWORD *)v2 = &off_80BE6A0;
    *(_DWORD *)(v2 + 12) = v2 + 16;
    *(_DWORD *)(v2 + 20) = 0;
    *(_DWORD *)(v2 + 24) = 0;
    *(_DWORD *)(v2 + 16) = &off_80BE688;
    *(_DWORD *)(v2 + 28) = a1;
    v4 = v2;
    v5 = sub_80B1770(v2, (int)&off_80BD238);
    v3 = v4;
  }
  else
  {
    v5 = 0;
  }
  v13 = v5;
  v14 = v3;
  result = std::thread::_M_start_thread(a1 + 332, (struct_thread_imp **)&v13);
  v7 = v14;
  if ( v14 )
  {
    if ( &_pthread_key_create )
    {
      v8 = _InterlockedExchangeAdd((volatile signed __int32 *)(v14 + 4), 0xFFFFFFFF);
    }
    else
    {
      v8 = *(_DWORD *)(v14 + 4);
      *(_DWORD *)(v14 + 4) = v8 - 1;
    }
    result = v8 - 1;
    if ( !result )
    {
      (*(void (__cdecl **)(int))(*(_DWORD *)v7 + 8))(v7);
      if ( &_pthread_key_create )
      {
        v9 = _InterlockedExchangeAdd((volatile signed __int32 *)(v7 + 8), 0xFFFFFFFF);
      }
      else
      {
        v9 = *(_DWORD *)(v7 + 8);
        *(_DWORD *)(v7 + 8) = v9 - 1;
      }
      result = v9 - 1;
      if ( !result )
        result = (*(int (__cdecl **)(int))(*(_DWORD *)v7 + 12))(v7);
    }
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804CBF0: using guessed type int __cdecl std::string::string(_DWORD, _DWORD, _DWORD);
// 804CEF0: using guessed type int __cdecl _cxa_allocate_exception(_DWORD);
// 804D010: using guessed type int event_base_new(void);
// 804D0B0: using guessed type int __cdecl _cxa_throw(_DWORD, _DWORD, _DWORD);
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BAADC: using guessed type void *off_80BAADC;
// 80BAB18: using guessed type void *off_80BAB18;
// 80BD238: using guessed type void *off_80BD238;
// 80BE688: using guessed type void *off_80BE688;
// 80BE6A0: using guessed type void *off_80BE6A0;
// 80BEA58: using guessed type void *off_80BEA58;
// 80BEAB8: using guessed type void *off_80BEAB8;

//----- (080B2770) --------------------------------------------------------
char __cdecl sub_80B2770(int a1)
{
  int v1; // ebx@1
  int v2; // eax@2
  pthread_mutex_t *v3; // ebx@6
  int v4; // esi@6
  pthread_mutex_t *v5; // eax@6
  int v6; // eax@8
  int v7; // ebp@9
  int v8; // eax@10
  int v9; // eax@12
  int v10; // eax@22
  char v11; // bp@25
  int v12; // eax@29
  int v13; // ebp@31
  int v14; // eax@32
  int v15; // eax@34
  int v16; // eax@44
  int v17; // esi@49
  pthread_mutex_t *v18; // eax@49
  int v19; // ebp@52
  int v20; // eax@53
  int v21; // eax@55
  int v22; // eax@65
  char v23; // bp@68
  int v24; // eax@72
  int v25; // ebp@74
  int v26; // eax@75
  int v27; // eax@77
  int v28; // eax@87
  int v29; // esi@92
  pthread_mutex_t *v30; // eax@92
  int v31; // ebp@95
  int v32; // eax@96
  int v33; // eax@98
  int v34; // eax@108
  int v35; // ebp@110
  int v36; // edi@111
  pthread_mutex_t *v37; // eax@112
  char v38; // bp@116
  int v39; // eax@119
  int v40; // ebp@124
  int v41; // eax@125
  int v42; // eax@127
  int v43; // eax@137
  int v44; // eax@148
  int v45; // ST08_4@149
  int v46; // ST08_4@159
  int v47; // ST08_4@172
  int v49; // [sp+4h] [bp-48h]@0
  int v50; // [sp+8h] [bp-44h]@110
  int v51; // [sp+Ch] [bp-40h]@1
  pthread_mutex_t *v52; // [sp+18h] [bp-34h]@6
  char v53; // [sp+1Ch] [bp-30h]@6
  pthread_mutex_t *v54; // [sp+20h] [bp-2Ch]@49
  char v55; // [sp+24h] [bp-28h]@49
  pthread_mutex_t *v56; // [sp+28h] [bp-24h]@92
  char v57; // [sp+2Ch] [bp-20h]@92

  v51 = *(_DWORD *)a1;
  v1 = **(_DWORD **)a1;
  if ( !*(_BYTE *)(**(_DWORD **)a1 + 328) )
    goto LABEL_2;
  v3 = (pthread_mutex_t *)(v1 + 244);
  sub_80518D0(v3);
  v4 = *(_DWORD *)v51;
  v5 = (pthread_mutex_t *)(*(_DWORD *)v51 + 28);
  v52 = v5;
  v53 = 0;
  if ( !v5 )
    goto LABEL_143;
  v3 = (pthread_mutex_t *)&_pthread_key_create;
  if ( &_pthread_key_create )
  {
    v6 = pthread_mutex_lock(v5);
    if ( v6 )
    {
LABEL_187:
      v44 = std::__throw_system_error(v6);
      goto LABEL_152;
    }
  }
  v53 = 1;
  v7 = *(_DWORD *)(v4 + 80);
  if ( v7 != v4 + 76 )
  {
    while ( 1 )
    {
      v8 = *(_DWORD *)(v7 + 4);
      if ( v8 )
        *(_DWORD *)(v8 + 8) = *(_DWORD *)(v7 + 8);
      v9 = *(_DWORD *)(v7 + 8);
      if ( v9 )
        *(_DWORD *)(v9 + 4) = *(_DWORD *)(v7 + 4);
      *(_DWORD *)(v7 + 4) = 0;
      *(_DWORD *)(v7 + 8) = 0;
      if ( !v53 )
        goto LABEL_143;
      if ( v52 )
      {
        if ( &_pthread_key_create )
          pthread_mutex_unlock(v52);
        v53 = 0;
      }
      sub_80698F0(*(_DWORD *)(v4 + 20), v7);
      if ( !v52 )
        break;
      if ( v53 )
      {
        v44 = std::__throw_system_error(35);
        goto LABEL_149;
      }
      if ( &_pthread_key_create )
      {
        v10 = pthread_mutex_lock(v52);
        if ( v10 )
        {
          v44 = std::__throw_system_error(v10);
          goto LABEL_152;
        }
      }
      v53 = 1;
      v7 = *(_DWORD *)(v4 + 80);
      if ( v7 == v4 + 76 )
        goto LABEL_24;
    }
    v44 = std::__throw_system_error(1);
    goto LABEL_152;
  }
LABEL_24:
  if ( *(_DWORD *)(v4 + 68) == v4 + 64 )
    goto LABEL_31;
  v11 = v53;
  if ( !v53 )
    goto LABEL_143;
  if ( !v52 )
    goto LABEL_179;
  if ( &_pthread_key_create )
  {
    pthread_mutex_unlock(v52);
    v53 = 0;
    if ( v52 )
    {
      v12 = pthread_mutex_lock(v52);
      if ( v12 )
      {
        v44 = std::__throw_system_error(v12);
        goto LABEL_152;
      }
      goto LABEL_30;
    }
    v11 = 0;
LABEL_179:
    v44 = std::__throw_system_error(1);
LABEL_153:
    if ( !v11 )
      goto LABEL_150;
LABEL_149:
    v45 = v44;
    sub_80584A0((int)&v52, v49);
    v44 = v45;
    goto LABEL_150;
  }
LABEL_30:
  v53 = 1;
LABEL_31:
  v13 = *(_DWORD *)(v4 + 56);
  if ( v13 == v4 + 52 )
    goto LABEL_144;
  do
  {
    v14 = *(_DWORD *)(v13 + 4);
    if ( v14 )
      *(_DWORD *)(v14 + 8) = *(_DWORD *)(v13 + 8);
    v15 = *(_DWORD *)(v13 + 8);
    if ( v15 )
      *(_DWORD *)(v15 + 4) = *(_DWORD *)(v13 + 4);
    *(_DWORD *)(v13 + 4) = 0;
    *(_DWORD *)(v13 + 8) = 0;
    *(_DWORD *)(v13 + 8) = *(_DWORD *)(v4 + 72);
    *(_DWORD *)(v13 + 4) = v4 + 64;
    *(_DWORD *)(*(_DWORD *)(v4 + 72) + 4) = v13;
    *(_DWORD *)(v4 + 72) = v13;
    if ( !v53 )
      goto LABEL_143;
    if ( v52 )
    {
      if ( &_pthread_key_create )
        pthread_mutex_unlock(v52);
      v53 = 0;
    }
    sub_806A110(*(_DWORD *)(v4 + 20), v13);
    if ( !v52 )
    {
      v44 = std::__throw_system_error(1);
LABEL_152:
      v11 = v53;
      goto LABEL_153;
    }
    if ( v53 )
    {
      v16 = std::__throw_system_error(35);
LABEL_166:
      v44 = std::__throw_system_error(v16);
      goto LABEL_152;
    }
    if ( &_pthread_key_create )
    {
      v16 = pthread_mutex_lock(v52);
      if ( v16 )
        goto LABEL_166;
    }
    v53 = 1;
    v13 = *(_DWORD *)(v4 + 56);
  }
  while ( v4 + 52 != v13 );
LABEL_46:
  if ( v52 && v3 )
    pthread_mutex_unlock(v52);
  while ( 1 )
  {
    v17 = *(_DWORD *)v51;
    v18 = (pthread_mutex_t *)(*(_DWORD *)v51 + 104);
    v54 = v18;
    v55 = 0;
    if ( !v18 )
      goto LABEL_143;
    if ( v3 )
    {
      v6 = pthread_mutex_lock(v18);
      if ( v6 )
        goto LABEL_187;
    }
    v55 = 1;
    v19 = *(_DWORD *)(v17 + 156);
    if ( v19 != v17 + 152 )
    {
      while ( 1 )
      {
        v20 = *(_DWORD *)(v19 + 4);
        if ( v20 )
          *(_DWORD *)(v20 + 8) = *(_DWORD *)(v19 + 8);
        v21 = *(_DWORD *)(v19 + 8);
        if ( v21 )
          *(_DWORD *)(v21 + 4) = *(_DWORD *)(v19 + 4);
        *(_DWORD *)(v19 + 4) = 0;
        *(_DWORD *)(v19 + 8) = 0;
        if ( !v55 )
          goto LABEL_143;
        if ( v54 )
        {
          if ( v3 )
            pthread_mutex_unlock(v54);
          v55 = 0;
        }
        sub_806CE20(*(_DWORD *)(v17 + 96), v19);
        if ( !v54 )
        {
          v44 = std::__throw_system_error(1);
          goto LABEL_157;
        }
        if ( v55 )
          break;
        if ( v3 )
        {
          v22 = pthread_mutex_lock(v54);
          if ( v22 )
          {
            v44 = std::__throw_system_error(v22);
            goto LABEL_157;
          }
        }
        v55 = 1;
        v19 = *(_DWORD *)(v17 + 156);
        if ( v19 == v17 + 152 )
          goto LABEL_67;
      }
      v28 = std::__throw_system_error(35);
LABEL_169:
      v44 = std::__throw_system_error(v28);
LABEL_157:
      v23 = v55;
LABEL_158:
      if ( v23 )
        goto LABEL_159;
      goto LABEL_150;
    }
LABEL_67:
    if ( *(_DWORD *)(v17 + 144) != v17 + 140 )
    {
      v23 = v55;
      if ( !v55 )
        goto LABEL_143;
      if ( !v54 )
        goto LABEL_186;
      if ( v3 )
      {
        pthread_mutex_unlock(v54);
        v55 = 0;
        if ( !v54 )
        {
          v23 = 0;
LABEL_186:
          v44 = std::__throw_system_error(1);
          goto LABEL_158;
        }
        v24 = pthread_mutex_lock(v54);
        if ( v24 )
        {
          v44 = std::__throw_system_error(v24);
          goto LABEL_157;
        }
      }
      v55 = 1;
    }
    v25 = *(_DWORD *)(v17 + 132);
    if ( v25 != v17 + 128 )
    {
      while ( 1 )
      {
        v26 = *(_DWORD *)(v25 + 4);
        if ( v26 )
          *(_DWORD *)(v26 + 8) = *(_DWORD *)(v25 + 8);
        v27 = *(_DWORD *)(v25 + 8);
        if ( v27 )
          *(_DWORD *)(v27 + 4) = *(_DWORD *)(v25 + 4);
        *(_DWORD *)(v25 + 4) = 0;
        *(_DWORD *)(v25 + 8) = 0;
        *(_DWORD *)(v25 + 8) = *(_DWORD *)(v17 + 148);
        *(_DWORD *)(v25 + 4) = v17 + 140;
        *(_DWORD *)(*(_DWORD *)(v17 + 148) + 4) = v25;
        *(_DWORD *)(v17 + 148) = v25;
        if ( !v55 )
          goto LABEL_143;
        if ( v54 )
        {
          if ( v3 )
            pthread_mutex_unlock(v54);
          v55 = 0;
        }
        sub_806DA10(*(_DWORD *)(v17 + 96), v25);
        if ( !v54 )
          break;
        if ( v55 )
        {
          v44 = std::__throw_system_error(35);
LABEL_159:
          v46 = v44;
          sub_80584A0((int)&v54, v49);
          v44 = v46;
LABEL_150:
          Unwind_Resume(v44);
        }
        if ( v3 )
        {
          v28 = pthread_mutex_lock(v54);
          if ( v28 )
            goto LABEL_169;
        }
        v55 = 1;
        v25 = *(_DWORD *)(v17 + 132);
        if ( v17 + 128 == v25 )
          goto LABEL_89;
      }
      v44 = std::__throw_system_error(1);
      goto LABEL_157;
    }
    if ( v55 )
    {
LABEL_89:
      if ( v54 && v3 )
        pthread_mutex_unlock(v54);
    }
    v29 = *(_DWORD *)v51;
    v30 = (pthread_mutex_t *)(*(_DWORD *)v51 + 176);
    v56 = v30;
    v57 = 0;
    if ( v30 )
      break;
LABEL_143:
    std::__throw_system_error(1);
LABEL_144:
    if ( v53 )
      goto LABEL_46;
  }
  if ( v3 )
  {
    v6 = pthread_mutex_lock(v30);
    if ( v6 )
      goto LABEL_187;
  }
  v57 = 1;
  v31 = *(_DWORD *)(v29 + 228);
  if ( v31 != v29 + 224 )
  {
    while ( 1 )
    {
      v32 = *(_DWORD *)(v31 + 4);
      if ( v32 )
        *(_DWORD *)(v32 + 8) = *(_DWORD *)(v31 + 8);
      v33 = *(_DWORD *)(v31 + 8);
      if ( v33 )
        *(_DWORD *)(v33 + 4) = *(_DWORD *)(v31 + 4);
      *(_DWORD *)(v31 + 4) = 0;
      *(_DWORD *)(v31 + 8) = 0;
      if ( !v57 )
        goto LABEL_143;
      if ( v56 )
      {
        if ( v3 )
          pthread_mutex_unlock(v56);
        v57 = 0;
      }
      sub_809D020(*(void **)(v29 + 168), v31);
      if ( !v56 )
      {
        v44 = std::__throw_system_error(1);
        goto LABEL_171;
      }
      if ( v57 )
        break;
      if ( v3 )
      {
        v34 = pthread_mutex_lock(v56);
        if ( v34 )
        {
          v44 = std::__throw_system_error(v34);
          goto LABEL_171;
        }
      }
      v57 = 1;
      v31 = *(_DWORD *)(v29 + 228);
      if ( v31 == v29 + 224 )
        goto LABEL_110;
    }
    v44 = std::__throw_system_error(35);
LABEL_172:
    v47 = v44;
    sub_80584A0((int)&v56, v49);
    v44 = v47;
    goto LABEL_150;
  }
LABEL_110:
  v35 = *(_DWORD *)(v29 + 216);
  v50 = v29 + 212;
  if ( v35 != v29 + 212 )
  {
    v36 = *(_DWORD *)(v35 + 4);
    if ( v57 )
    {
      v37 = v56;
      if ( !v56 )
        goto LABEL_116;
LABEL_113:
      if ( v3 )
        pthread_mutex_unlock(v37);
      v57 = 0;
      while ( 1 )
      {
LABEL_116:
        v38 = sub_80A0100(*(_DWORD *)(v29 + 168), v35);
        if ( !v56 )
          goto LABEL_184;
        if ( v57 )
          break;
        if ( v3 )
        {
          v39 = pthread_mutex_lock(v56);
          if ( v39 )
          {
            v44 = std::__throw_system_error(v39);
            goto LABEL_171;
          }
        }
        v57 = 1;
        if ( !v38 || v50 == v36 )
          goto LABEL_124;
        v35 = v36;
        v36 = *(_DWORD *)(v36 + 4);
        v37 = v56;
        if ( v56 )
          goto LABEL_113;
      }
      std::__throw_system_error(35);
LABEL_184:
      v44 = std::__throw_system_error(1);
LABEL_171:
      if ( !v57 )
        goto LABEL_150;
      goto LABEL_172;
    }
    goto LABEL_143;
  }
LABEL_124:
  v40 = *(_DWORD *)(v29 + 204);
  if ( v40 != v29 + 200 )
  {
    while ( 1 )
    {
      v41 = *(_DWORD *)(v40 + 4);
      if ( v41 )
        *(_DWORD *)(v41 + 8) = *(_DWORD *)(v40 + 8);
      v42 = *(_DWORD *)(v40 + 8);
      if ( v42 )
        *(_DWORD *)(v42 + 4) = *(_DWORD *)(v40 + 4);
      *(_DWORD *)(v40 + 4) = 0;
      *(_DWORD *)(v40 + 8) = 0;
      *(_DWORD *)(v40 + 8) = *(_DWORD *)(v29 + 220);
      *(_DWORD *)(v40 + 4) = v50;
      *(_DWORD *)(*(_DWORD *)(v29 + 220) + 4) = v40;
      *(_DWORD *)(v29 + 220) = v40;
      if ( !v57 )
        goto LABEL_143;
      if ( v56 )
      {
        if ( v3 )
          pthread_mutex_unlock(v56);
        v57 = 0;
      }
      sub_809DC30(*(_DWORD *)(v29 + 168), v40);
      if ( !v56 )
        goto LABEL_177;
      if ( v57 )
        break;
      if ( v3 )
      {
        v43 = pthread_mutex_lock(v56);
        if ( v43 )
        {
          v44 = std::__throw_system_error(v43);
          goto LABEL_171;
        }
      }
      v57 = 1;
      v40 = *(_DWORD *)(v29 + 204);
      if ( v40 == v29 + 200 )
        goto LABEL_139;
    }
    std::__throw_system_error(35);
LABEL_177:
    v44 = std::__throw_system_error(1);
    goto LABEL_171;
  }
  if ( v57 )
  {
LABEL_139:
    if ( v56 && v3 )
      pthread_mutex_unlock(v56);
  }
  v1 = *(_DWORD *)v51;
LABEL_2:
  LOBYTE(v2) = *(_BYTE *)(v1 + 328);
  if ( !(_BYTE)v2 )
  {
    v2 = *(_DWORD *)(v1 + 4);
    if ( v2 )
    {
      LOBYTE(v2) = event_base_loopbreak(*(_DWORD *)(v1 + 4));
      *(_BYTE *)v1 = 1;
    }
  }
  return v2;
}
// 804CA60: using guessed type int __cdecl event_base_loopbreak(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);

//----- (080B3E80) --------------------------------------------------------
char __cdecl sub_80B3E80(int a1, int a2, int a3)
{
  unsigned int v3; // ebp@0
  int v4; // eax@3
  int v5; // ST10_4@3
  int v6; // ST14_4@3
  int v7; // ebx@3
  int v8; // edx@3
  int v9; // edx@3
  int v10; // eax@4
  int v11; // ebx@4
  int (*v12)(); // eax@4
  int v13; // eax@6
  int v14; // eax@10
  int v16; // eax@22
  int v17; // ST10_4@22
  int v18; // ST14_4@22
  int v19; // ebx@22
  int v20; // edx@22
  int v21; // edx@22
  int v22; // eax@23
  int v23; // ebx@23
  int v24; // eax@23
  int v25; // eax@25
  int v26; // edx@25
  int v27; // eax@28
  const char *v28; // eax@32
  int v29; // eax@36
  int v30; // eax@50
  int v31; // ST10_4@50
  int v32; // ST14_4@50
  int v33; // ebx@50
  int v34; // edx@50
  int v35; // edx@50
  int v36; // eax@51
  int v37; // ebx@51
  int v38; // eax@51
  int v39; // eax@53
  int v40; // edx@53
  int v41; // eax@56
  int v42; // edi@60
  unsigned int v43; // edx@60
  int v44; // edi@62
  int v45; // eax@66
  int v46; // ST1C_4@75
  int v47; // edi@75
  int v48; // ebx@75
  int v49; // eax@75
  int v50; // edx@75
  int v51; // ecx@76
  int v52; // edx@78
  int v53; // edx@79
  int v54; // eax@81
  std::ostream *v55; // esi@81
  int v56; // eax@81
  int v57; // ebx@81
  char v58; // al@83
  std::ostream *v59; // eax@84
  int v60; // edx@85
  signed __int32 v61; // eax@87
  int v62; // eax@90
  bool v63; // zf@90
  int v64; // ebx@96
  int v65; // eax@101
  bool v66; // zf@101
  signed __int32 v67; // ecx@118
  signed __int32 v68; // ecx@122
  signed __int32 v69; // ecx@124
  int v70; // [sp+Ch] [bp-FCh]@0
  int *v71; // [sp+10h] [bp-F8h]@51
  char v72; // [sp+26h] [bp-E2h]@126
  char v73; // [sp+27h] [bp-E1h]@77
  int v74; // [sp+28h] [bp-E0h]@27
  int v75; // [sp+2Ch] [bp-DCh]@2
  int v76; // [sp+30h] [bp-D8h]@3
  int v77; // [sp+34h] [bp-D4h]@2
  int v78; // [sp+38h] [bp-D0h]@3
  int v79; // [sp+3Ch] [bp-CCh]@3
  int v80; // [sp+40h] [bp-C8h]@75
  int (*v81)(); // [sp+44h] [bp-C4h]@2
  int (__cdecl *v82)(int *, int *); // [sp+48h] [bp-C0h]@3
  int v83; // [sp+4Ch] [bp-BCh]@75
  int v84; // [sp+50h] [bp-B8h]@75
  int v85; // [sp+54h] [bp-B4h]@75
  int v86; // [sp+58h] [bp-B0h]@75
  char v87; // [sp+5Ch] [bp-ACh]@75
  int v88; // [sp+60h] [bp-A8h]@75
  int v89; // [sp+64h] [bp-A4h]@75
  int v90; // [sp+68h] [bp-A0h]@75
  int v91; // [sp+D8h] [bp-30h]@75
  char v92; // [sp+DCh] [bp-2Ch]@75
  char v93; // [sp+DDh] [bp-2Bh]@75
  int v94; // [sp+E0h] [bp-28h]@75
  int v95; // [sp+E4h] [bp-24h]@75
  int v96; // [sp+E8h] [bp-20h]@75
  int v97; // [sp+ECh] [bp-1Ch]@75

  if ( !std::string::compare((std::string *)(*(_DWORD *)a2 + 28), "dnsresolve") )
  {
    sub_80B62E0((int)&v75, a3);
    v81 = 0;
    if ( v77 )
    {
      v4 = operator new(0x10u);
      *(_DWORD *)(v4 + 8) = 0;
      v5 = v75;
      v6 = v76;
      v7 = *(_DWORD *)(v4 + 4);
      v75 = *(_DWORD *)v4;
      v76 = v7;
      *(_DWORD *)v4 = v5;
      *(_DWORD *)(v4 + 4) = v6;
      v8 = v77;
      v77 = 0;
      *(_DWORD *)(v4 + 8) = v8;
      v9 = v78;
      v78 = *(_DWORD *)(v4 + 12);
      *(_DWORD *)(v4 + 12) = v9;
      v79 = v4;
      v82 = sub_80B6B30;
      v81 = sub_80B6350;
    }
    v10 = operator new(0x28u);
    v11 = v10;
    *(_DWORD *)(v10 + 4) = 0;
    *(_DWORD *)(v10 + 8) = 0;
    *(_DWORD *)v10 = &off_80BEA38;
    *(_DWORD *)(v10 + 20) = 0;
    v12 = v81;
    if ( v81 )
    {
      *(_DWORD *)(v11 + 24) = v82;
      *(_DWORD *)(v11 + 20) = v12;
      ((void (__cdecl *)(int, int *, signed int))v12)(v11 + 12, &v79, 2);
    }
    v13 = *(_DWORD *)a2;
    *(_DWORD *)(v11 + 28) = *(_DWORD *)a2;
    if ( v13 )
      _InterlockedIncrement((volatile signed __int32 *)(v13 + 4));
    *(_DWORD *)v11 = &off_80BEA48;
    *(_DWORD *)(v11 + 32) = a1 + 16;
    *(_DWORD *)(v11 + 36) = 0;
    if ( a1 != -28 )
    {
      if ( !&_pthread_key_create || (v14 = pthread_mutex_lock((pthread_mutex_t *)(a1 + 28))) == 0 )
      {
        if ( *(_DWORD *)(v11 + 8) || *(_DWORD *)(v11 + 4) )
          sub_804D724();
        *(_DWORD *)(v11 + 8) = *(_DWORD *)(a1 + 60);
        *(_DWORD *)(v11 + 4) = a1 + 52;
        *(_DWORD *)(*(_DWORD *)(a1 + 60) + 4) = v11;
        *(_DWORD *)(a1 + 60) = v11;
        if ( &_pthread_key_create )
          pthread_mutex_unlock((pthread_mutex_t *)(a1 + 28));
        if ( v81 )
          ((void (__cdecl *)(int *, int *, signed int))v81)(&v79, &v79, 3);
        if ( v77 )
          ((void (__cdecl *)(int *, int *, signed int))v77)(&v75, &v75, 3);
        return 1;
      }
      std::__throw_system_error(v14);
      goto LABEL_110;
    }
    v64 = std::__throw_system_error(1);
    if ( v81 )
      ((void (__cdecl *)(int *, int *, signed int))v81)(&v79, &v79, 3);
    if ( v77 )
      ((void (__cdecl *)(int *, int *, signed int))v77)(&v75, &v75, 3);
    goto LABEL_100;
  }
  if ( !std::string::compare((std::string *)(*(_DWORD *)a2 + 28), "download") )
  {
    sub_80B62E0((int)&v75, a3);
    v81 = 0;
    if ( v77 )
    {
      v16 = operator new(0x10u);
      *(_DWORD *)(v16 + 8) = 0;
      v17 = v75;
      v18 = v76;
      v19 = *(_DWORD *)(v16 + 4);
      v75 = *(_DWORD *)v16;
      v76 = v19;
      *(_DWORD *)v16 = v17;
      *(_DWORD *)(v16 + 4) = v18;
      v20 = v77;
      v77 = 0;
      *(_DWORD *)(v16 + 8) = v20;
      v21 = v78;
      v78 = *(_DWORD *)(v16 + 12);
      *(_DWORD *)(v16 + 12) = v21;
      v79 = v16;
      v82 = sub_80B6B90;
      v81 = sub_80B6350;
    }
    v22 = operator new(0xB4u);
    v23 = v22;
    *(_DWORD *)(v22 + 4) = 0;
    *(_DWORD *)(v22 + 8) = 0;
    *(_DWORD *)v22 = &off_80BEA88;
    sub_80B6A20(v22 + 12, (int)&v79);
    v24 = *(_DWORD *)a2;
    *(_DWORD *)(v23 + 28) = *(_DWORD *)a2;
    if ( v24 )
      _InterlockedIncrement((volatile signed __int32 *)(v24 + 4));
    *(_DWORD *)v23 = &off_80BEA98;
    *(_DWORD *)(v23 + 32) = 0;
    v25 = operator new(0x1Cu);
    *(_DWORD *)(v25 + 4) = 0;
    *(_DWORD *)v25 = &off_80BA3F0;
    v26 = *(_DWORD *)a2;
    *(_DWORD *)(v25 + 8) = *(_DWORD *)a2;
    if ( v26 )
      _InterlockedIncrement((volatile signed __int32 *)(v26 + 4));
    *(_DWORD *)v25 = &off_80BEA70;
    *(_DWORD *)(v25 + 12) = &unk_80CF83C;
    *(_DWORD *)(v25 + 16) = 0;
    *(_DWORD *)(v25 + 20) = 0;
    *(_DWORD *)(v25 + 24) = 0;
    v74 = v25;
    _InterlockedIncrement((volatile signed __int32 *)(v25 + 4));
    if ( &v74 == (int *)(v23 + 32) )
    {
      v62 = v74;
      v63 = v74 == 0;
      if ( v74 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v74 + 4));
        if ( v63 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v62 + 4))(v62);
      }
    }
    else
    {
      v27 = *(_DWORD *)(v23 + 32);
      if ( v27 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v27 + 4));
        if ( !v27 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      *(_DWORD *)(v23 + 32) = v74;
    }
    *(_DWORD *)v23 = &off_80BEAA8;
    v74 = *(_DWORD *)(*(_DWORD *)a2 + 32);
    sub_807B750(v23 + 36, (int)&v74);
    *(_DWORD *)(v23 + 40) = 0;
    HttpClient::HttpClient(v23 + 44);
    *(_DWORD *)(v23 + 172) = 0;
    *(_DWORD *)(v23 + 176) = 0;
    v28 = *(const char **)(*(_DWORD *)a2 + 36);
    if ( *((_DWORD *)v28 - 3) )
      *(_DWORD *)(v23 + 40) = atoll(v28);
    if ( a1 != -104 )
    {
      if ( !&_pthread_key_create || (v29 = pthread_mutex_lock((pthread_mutex_t *)(a1 + 104))) == 0 )
      {
        if ( !*(_DWORD *)(v23 + 8) && !*(_DWORD *)(v23 + 4) )
        {
          *(_DWORD *)(v23 + 8) = *(_DWORD *)(a1 + 136);
          *(_DWORD *)(v23 + 4) = a1 + 128;
          *(_DWORD *)(*(_DWORD *)(a1 + 136) + 4) = v23;
          *(_DWORD *)(a1 + 136) = v23;
          if ( &_pthread_key_create )
            pthread_mutex_unlock((pthread_mutex_t *)(a1 + 104));
          if ( v81 )
            ((void (__cdecl *)(_DWORD, _DWORD, _DWORD))v81)(&v79, &v79, 3);
          if ( v77 )
            ((void (__cdecl *)(_DWORD, _DWORD, _DWORD))v77)(&v75, &v75, 3);
          return 1;
        }
LABEL_110:
        sub_804D74C();
      }
      v64 = std::__throw_system_error(v29);
      if ( v81 )
        ((void (__cdecl *)(_DWORD, _DWORD, _DWORD))v81)(&v79, &v79, 3);
      if ( v77 )
        ((void (__cdecl *)(_DWORD, _DWORD, _DWORD))v77)(&v75, &v75, 3);
LABEL_100:
      Unwind_Resume(v64);
    }
    std::__throw_system_error(1);
LABEL_116:
    sub_804D774();
  }
  if ( !std::string::compare((std::string *)(*(_DWORD *)a2 + 28), "ping") )
  {
    sub_80B62E0((int)&v75, a3);
    v81 = 0;
    if ( v77 )
    {
      v30 = operator new(0x10u);
      *(_DWORD *)(v30 + 8) = 0;
      v31 = v75;
      v32 = v76;
      v33 = *(_DWORD *)(v30 + 4);
      v75 = *(_DWORD *)v30;
      v76 = v33;
      *(_DWORD *)v30 = v31;
      *(_DWORD *)(v30 + 4) = v32;
      v34 = v77;
      v77 = 0;
      *(_DWORD *)(v30 + 8) = v34;
      v35 = v78;
      v78 = *(_DWORD *)(v30 + 12);
      *(_DWORD *)(v30 + 12) = v35;
      v79 = v30;
      v82 = sub_80B6BF0;
      v81 = sub_80B6350;
    }
    v36 = operator new(0x50u);
    v37 = v36;
    *(_DWORD *)(v36 + 4) = 0;
    *(_DWORD *)(v36 + 8) = 0;
    *(_DWORD *)v36 = &off_80BEAE8;
    v71 = &v79;
    sub_80B6A90(v36 + 12, (int)&v79);
    v38 = *(_DWORD *)a2;
    *(_DWORD *)(v37 + 28) = *(_DWORD *)a2;
    if ( v38 )
      _InterlockedIncrement((volatile signed __int32 *)(v38 + 4));
    *(_DWORD *)v37 = &off_80BEAF8;
    *(_DWORD *)(v37 + 32) = 0;
    v39 = operator new(0x18u);
    *(_DWORD *)(v39 + 4) = 0;
    *(_DWORD *)v39 = &off_80BA3F0;
    v40 = *(_DWORD *)a2;
    *(_DWORD *)(v39 + 8) = *(_DWORD *)a2;
    if ( v40 )
      _InterlockedIncrement((volatile signed __int32 *)(v40 + 4));
    *(_DWORD *)v39 = &off_80BEAD0;
    *(_DWORD *)(v39 + 12) = 0;
    *(_DWORD *)(v39 + 16) = 0;
    *(_DWORD *)(v39 + 20) = 0;
    v74 = v39;
    _InterlockedIncrement((volatile signed __int32 *)(v39 + 4));
    if ( &v74 == (int *)(v37 + 32) )
    {
      v65 = v74;
      v66 = v74 == 0;
      if ( v74 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v74 + 4));
        if ( v66 )
          (*(void (__cdecl **)(int))(*(_DWORD *)v65 + 4))(v65);
      }
    }
    else
    {
      v41 = *(_DWORD *)(v37 + 32);
      if ( v41 )
      {
        _InterlockedDecrement((volatile signed __int32 *)(v41 + 4));
        if ( !v41 )
          (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
      }
      *(_DWORD *)(v37 + 32) = v74;
    }
    *(_DWORD *)v37 = &off_80BEB08;
    *(_DWORD *)(v37 + 44) = a1 + 164;
    *(_WORD *)(v37 + 48) = 0;
    *(_DWORD *)(v37 + 52) = 0;
    *(_DWORD *)(v37 + 72) = 0;
    *(_DWORD *)(v37 + 76) = 0;
    v42 = v37 + 56;
    v43 = 16;
    if ( (v37 + 56) & 1 )
    {
      *(_BYTE *)(v37 + 56) = 0;
      v42 = v37 + 57;
      LOBYTE(v43) = 15;
    }
    if ( v42 & 2 )
    {
      *(_WORD *)v42 = 0;
      v42 += 2;
      v43 -= 2;
    }
    memset((void *)v42, 0, 4 * (v43 >> 2));
    v44 = v42 + 4 * (v43 >> 2);
    if ( v43 & 2 )
    {
      *(_WORD *)v44 = 0;
      v44 += 2;
    }
    if ( v43 & 1 )
      *(_BYTE *)v44 = 0;
    *(_DWORD *)(v37 + 36) = atoi(*(const char **)(*(_DWORD *)a2 + 36));
    *(_DWORD *)(v37 + 40) = atoi(*(const char **)(*(_DWORD *)a2 + 40));
    if ( a1 != -176 )
    {
      if ( !&_pthread_key_create || (v45 = pthread_mutex_lock((pthread_mutex_t *)(a1 + 176))) == 0 )
      {
        if ( !*(_DWORD *)(v37 + 8) && !*(_DWORD *)(v37 + 4) )
        {
          *(_DWORD *)(v37 + 8) = *(_DWORD *)(a1 + 208);
          *(_DWORD *)(v37 + 4) = a1 + 200;
          *(_DWORD *)(*(_DWORD *)(a1 + 208) + 4) = v37;
          *(_DWORD *)(a1 + 208) = v37;
          if ( &_pthread_key_create )
            pthread_mutex_unlock((pthread_mutex_t *)(a1 + 176));
          if ( v81 )
            ((void (__cdecl *)(_DWORD, _DWORD, _DWORD))v81)(&v79, &v79, 3);
          if ( v77 )
            ((void (__cdecl *)(_DWORD, _DWORD, _DWORD))v77)(&v75, &v75, 3);
          return 1;
        }
        goto LABEL_116;
      }
      std::__throw_system_error(v45);
    }
    std::__throw_system_error(1);
    goto LABEL_130;
  }
  if ( log_level > 3 )
    return 0;
  v46 = *(_DWORD *)a2;
  v71 = &v79;
  std::ios_base::ios_base((std::ios_base *)&v90);
  v90 = (int)&unk_80CF5C8;
  v91 = 0;
  v92 = 0;
  v93 = 0;
  v94 = 0;
  v95 = 0;
  v96 = 0;
  v97 = 0;
  v47 = dword_80CF674;
  v79 = dword_80CF674;
  *(int *)((char *)&v79 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
  std::basic_ios<char,std::char_traits<char>>::init((char *)&v79 + *(_DWORD *)(v79 - 12), 0);
  v79 = (int)&unk_80CF5DC;
  v90 = (int)&unk_80CF5F0;
  v80 = (int)&unk_80CF7F0;
  v81 = 0;
  v82 = 0;
  v83 = 0;
  v84 = 0;
  v85 = 0;
  v86 = 0;
  std::locale::locale((std::locale *)&v87);
  v80 = (int)&unk_80CF588;
  v88 = 16;
  v89 = (int)&unk_80CF83C;
  std::basic_ios<char,std::char_traits<char>>::init(&v90, &v80);
  v48 = std::__ostream_insert<char,std::char_traits<char>>(&v79, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
  std::__ostream_insert<char,std::char_traits<char>>(v48, "unsupported task: ", 18);
  v49 = std::__ostream_insert<char,std::char_traits<char>>(
          v48,
          *(_DWORD *)(v46 + 28),
          *(_DWORD *)(*(_DWORD *)(v46 + 28) - 12));
  v74 = (int)&unk_80CF83C;
  v50 = *(_DWORD *)(v49 + 24);
  if ( v50 )
  {
    v51 = *(_DWORD *)(v49 + 16);
    LOBYTE(v70) = 0;
    if ( v50 > (unsigned int)v51 )
    {
      v75 = std::string::_S_construct<char *>((int)&v73, v3, (void *)v47, *(_DWORD *)(v49 + 20), v50, (int)&v73);
      std::string::swap((std::string *)&v74, (std::string *)&v75);
    }
    else
    {
      v75 = std::string::_S_construct<char *>((int)&v73, v3, (void *)v47, *(_DWORD *)(v49 + 20), v51, (int)&v73);
      std::string::swap((std::string *)&v74, (std::string *)&v75);
    }
    v52 = v75 - 12;
    if ( (_DWORD *)(v75 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v69 = _InterlockedExchangeAdd((volatile signed __int32 *)(v75 - 4), 0xFFFFFFFF);
      }
      else
      {
        v69 = *(_DWORD *)(v75 - 4);
        *(_DWORD *)(v75 - 4) = v69 - 1;
      }
      if ( v69 <= 0 )
        std::string::_Rep::_M_destroy(v52, &v72);
    }
  }
  else
  {
    std::string::assign((std::string *)&v74, (const std::string *)(v49 + 40));
  }
  v79 = (int)&unk_80CF5DC;
  v90 = (int)&unk_80CF5F0;
  v80 = (int)&unk_80CF588;
  v53 = v89 - 12;
  if ( (_DWORD *)(v89 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v67 = _InterlockedExchangeAdd((volatile signed __int32 *)(v89 - 4), 0xFFFFFFFF);
    }
    else
    {
      v67 = *(_DWORD *)(v89 - 4);
      *(_DWORD *)(v89 - 4) = v67 - 1;
    }
    if ( v67 <= 0 )
      std::string::_Rep::_M_destroy(v53, &v75);
  }
  v80 = (int)&unk_80CF7F0;
  std::locale::~locale((std::locale *)&v87);
  v79 = v47;
  *(int *)((char *)&v79 + *(_DWORD *)(v47 - 12)) = dword_80CF678;
  v90 = (int)&unk_80CF5C8;
  std::ios_base::~ios_base((std::ios_base *)&v90);
  if ( byte_80CE64C )
  {
    v54 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v74, *(_DWORD *)(v74 - 12));
    v55 = (std::ostream *)v54;
    v56 = *(_DWORD *)(*(_DWORD *)v54 - 12);
    v57 = *(_DWORD *)((char *)v55 + v56 + 124);
    if ( v57 )
    {
      if ( *(_BYTE *)(v57 + 28) )
      {
        v58 = *(_BYTE *)(v57 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v55 + v56 + 124));
        v58 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v57 + 24))(v57, 10);
      }
      v59 = (std::ostream *)std::ostream::put(v55, v58);
      std::ostream::flush(v59);
      goto LABEL_85;
    }
LABEL_130:
    v64 = std::__throw_bad_cast();
    std::string::_Rep::_M_dispose(v74 - 12, v71);
    goto LABEL_100;
  }
LABEL_85:
  syslog(5, "%s", v74, v70);
  v60 = v74 - 12;
  if ( (_DWORD *)(v74 - 12) == &std::string::_Rep::_S_empty_rep_storage )
    return 0;
  if ( &_pthread_key_create )
  {
    v61 = _InterlockedExchangeAdd((volatile signed __int32 *)(v74 - 4), 0xFFFFFFFF);
  }
  else
  {
    v68 = *(_DWORD *)(v74 - 4);
    *(_DWORD *)(v74 - 4) = v68 - 1;
    v61 = v68;
  }
  if ( v61 > 0 )
    return 0;
  std::string::_Rep::_M_destroy(v60, &v79);
  return 0;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80B6350: using guessed type int sub_80B6350();
// 80BA3F0: using guessed type int (__cdecl *off_80BA3F0)(int);
// 80BEA38: using guessed type int (__cdecl *off_80BEA38)(int);
// 80BEA48: using guessed type int (__cdecl *off_80BEA48)(int);
// 80BEA70: using guessed type void *off_80BEA70;
// 80BEA88: using guessed type int (__cdecl *off_80BEA88)(int);
// 80BEA98: using guessed type int (__cdecl *off_80BEA98)(int);
// 80BEAA8: using guessed type int (__cdecl *off_80BEAA8)(int);
// 80BEAD0: using guessed type int (__cdecl *off_80BEAD0)(int);
// 80BEAE8: using guessed type int (__cdecl *off_80BEAE8)(int);
// 80BEAF8: using guessed type int (__cdecl *off_80BEAF8)(int);
// 80BEB08: using guessed type int (__cdecl *off_80BEB08)(int);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080B5010) --------------------------------------------------------
int __cdecl sub_80B5010(int a1)
{
  int result; // eax@3

  *(_DWORD *)a1 = &off_80BEAD0;
  if ( *(_DWORD *)(a1 + 12) )
    operator delete(*(void **)(a1 + 12));
  *(_DWORD *)a1 = &off_80BA3F0;
  result = *(_DWORD *)(a1 + 8);
  if ( result )
  {
    _InterlockedDecrement((volatile signed __int32 *)(result + 4));
    if ( !result )
      result = (*(int (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BA2E8;
  return result;
}
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA3F0: using guessed type int (__cdecl *off_80BA3F0)(int);
// 80BEAD0: using guessed type int (__cdecl *off_80BEAD0)(int);

//----- (080B5060) --------------------------------------------------------
void __cdecl sub_80B5060(void *a1)
{
  int v1; // eax@1
  int v2; // edx@1
  int v3; // eax@2
  signed __int32 v4; // eax@7
  signed __int32 v5; // ecx@10
  char v6; // [sp+1Fh] [bp-Dh]@9

  *(_DWORD *)a1 = &off_80BEA70;
  v1 = *((_DWORD *)a1 + 3);
  v2 = v1 - 12;
  if ( (_DWORD *)(v1 - 12) != &std::string::_Rep::_S_empty_rep_storage )
  {
    if ( &_pthread_key_create )
    {
      v4 = _InterlockedExchangeAdd((volatile signed __int32 *)(v1 - 4), 0xFFFFFFFF);
    }
    else
    {
      v5 = *(_DWORD *)(v1 - 4);
      *(_DWORD *)(v1 - 4) = v5 - 1;
      v4 = v5;
    }
    if ( v4 <= 0 )
      std::string::_Rep::_M_destroy(v2, &v6);
  }
  *(_DWORD *)a1 = &off_80BA3F0;
  v3 = *((_DWORD *)a1 + 2);
  if ( v3 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
    if ( !v3 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BA2E8;
  operator delete(a1);
}
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA3F0: using guessed type int (__cdecl *off_80BA3F0)(int);
// 80BEA70: using guessed type void *off_80BEA70;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;

//----- (080B50F0) --------------------------------------------------------
void __cdecl sub_80B50F0(void *a1)
{
  int v1; // eax@3

  *(_DWORD *)a1 = &off_80BEAD0;
  if ( *((_DWORD *)a1 + 3) )
    operator delete(*((void **)a1 + 3));
  *(_DWORD *)a1 = &off_80BA3F0;
  v1 = *((_DWORD *)a1 + 2);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BA2E8;
  operator delete(a1);
}
// 80BA2E8: using guessed type void *off_80BA2E8;
// 80BA3F0: using guessed type int (__cdecl *off_80BA3F0)(int);
// 80BEAD0: using guessed type int (__cdecl *off_80BEAD0)(int);

//----- (080B5140) --------------------------------------------------------
int __cdecl sub_80B5140(int a1)
{
  int v1; // eax@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@3
  int v3; // eax@5
  int result; // eax@6

  *(_DWORD *)a1 = &off_80BEA88;
  v1 = *(_DWORD *)(a1 + 28);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v2 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 20);
  if ( v2 )
    v2(a1 + 12, a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v3 = *(_DWORD *)(a1 + 4);
  if ( v3 )
  {
    *(_DWORD *)(v3 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_8:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_7:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_8;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_7;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA88: using guessed type int (__cdecl *off_80BEA88)(int);

//----- (080B51D0) --------------------------------------------------------
int __cdecl sub_80B51D0(int a1)
{
  int v1; // eax@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@3
  int v3; // eax@5
  int result; // eax@6

  *(_DWORD *)a1 = &off_80BEA38;
  v1 = *(_DWORD *)(a1 + 28);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v2 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 20);
  if ( v2 )
    v2(a1 + 12, a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v3 = *(_DWORD *)(a1 + 4);
  if ( v3 )
  {
    *(_DWORD *)(v3 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_8:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_7:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_8;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_7;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA38: using guessed type int (__cdecl *off_80BEA38)(int);

//----- (080B5260) --------------------------------------------------------
int __cdecl sub_80B5260(int a1)
{
  int v1; // eax@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@3
  int v3; // eax@5
  int result; // eax@6

  *(_DWORD *)a1 = &off_80BEAE8;
  v1 = *(_DWORD *)(a1 + 28);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v2 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 20);
  if ( v2 )
    v2(a1 + 12, a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v3 = *(_DWORD *)(a1 + 4);
  if ( v3 )
  {
    *(_DWORD *)(v3 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_8:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_7:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_8;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_7;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEAE8: using guessed type int (__cdecl *off_80BEAE8)(int);

//----- (080B52F0) --------------------------------------------------------
int __cdecl sub_80B52F0(int a1)
{
  int v1; // eax@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@3
  int v3; // eax@5
  int result; // eax@6

  *(_DWORD *)a1 = &off_80BEA38;
  v1 = *(_DWORD *)(a1 + 28);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v2 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 20);
  if ( v2 )
    v2(a1 + 12, a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v3 = *(_DWORD *)(a1 + 4);
  if ( v3 )
  {
    *(_DWORD *)(v3 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_8:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_7:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_8;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_7;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA38: using guessed type int (__cdecl *off_80BEA38)(int);

//----- (080B5380) --------------------------------------------------------
void __cdecl sub_80B5380(void *a1)
{
  int v1; // eax@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@3
  int v3; // eax@5
  int v4; // eax@6

  *(_DWORD *)a1 = &off_80BEA88;
  v1 = *((_DWORD *)a1 + 7);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v2 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 5);
  if ( v2 )
    v2((char *)a1 + 12, (char *)a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v3 = *((_DWORD *)a1 + 1);
  if ( !v3 )
  {
    v4 = *((_DWORD *)a1 + 2);
    if ( !v4 )
      goto LABEL_9;
    goto LABEL_7;
  }
  *(_DWORD *)(v3 + 8) = *((_DWORD *)a1 + 2);
  v4 = *((_DWORD *)a1 + 2);
  if ( v4 )
LABEL_7:
    *(_DWORD *)(v4 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_9:
  operator delete(a1);
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA88: using guessed type int (__cdecl *off_80BEA88)(int);

//----- (080B5420) --------------------------------------------------------
void __cdecl sub_80B5420(void *a1)
{
  int v1; // eax@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@3
  int v3; // eax@5
  int v4; // eax@6

  *(_DWORD *)a1 = &off_80BEA38;
  v1 = *((_DWORD *)a1 + 7);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v2 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 5);
  if ( v2 )
    v2((char *)a1 + 12, (char *)a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v3 = *((_DWORD *)a1 + 1);
  if ( !v3 )
  {
    v4 = *((_DWORD *)a1 + 2);
    if ( !v4 )
      goto LABEL_9;
    goto LABEL_7;
  }
  *(_DWORD *)(v3 + 8) = *((_DWORD *)a1 + 2);
  v4 = *((_DWORD *)a1 + 2);
  if ( v4 )
LABEL_7:
    *(_DWORD *)(v4 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_9:
  operator delete(a1);
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA38: using guessed type int (__cdecl *off_80BEA38)(int);

//----- (080B54C0) --------------------------------------------------------
void __cdecl sub_80B54C0(void *a1)
{
  int v1; // eax@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@3
  int v3; // eax@5
  int v4; // eax@6

  *(_DWORD *)a1 = &off_80BEAE8;
  v1 = *((_DWORD *)a1 + 7);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v2 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 5);
  if ( v2 )
    v2((char *)a1 + 12, (char *)a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v3 = *((_DWORD *)a1 + 1);
  if ( !v3 )
  {
    v4 = *((_DWORD *)a1 + 2);
    if ( !v4 )
      goto LABEL_9;
    goto LABEL_7;
  }
  *(_DWORD *)(v3 + 8) = *((_DWORD *)a1 + 2);
  v4 = *((_DWORD *)a1 + 2);
  if ( v4 )
LABEL_7:
    *(_DWORD *)(v4 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_9:
  operator delete(a1);
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEAE8: using guessed type int (__cdecl *off_80BEAE8)(int);

//----- (080B5560) --------------------------------------------------------
void __cdecl sub_80B5560(void *a1)
{
  int v1; // eax@1
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD); // eax@3
  int v3; // eax@5
  int v4; // eax@6

  *(_DWORD *)a1 = &off_80BEA38;
  v1 = *((_DWORD *)a1 + 7);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v2 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 5);
  if ( v2 )
    v2((char *)a1 + 12, (char *)a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v3 = *((_DWORD *)a1 + 1);
  if ( !v3 )
  {
    v4 = *((_DWORD *)a1 + 2);
    if ( !v4 )
      goto LABEL_9;
    goto LABEL_7;
  }
  *(_DWORD *)(v3 + 8) = *((_DWORD *)a1 + 2);
  v4 = *((_DWORD *)a1 + 2);
  if ( v4 )
LABEL_7:
    *(_DWORD *)(v4 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_9:
  operator delete(a1);
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA38: using guessed type int (__cdecl *off_80BEA38)(int);

//----- (080B5600) --------------------------------------------------------
int __cdecl sub_80B5600(int a1)
{
  int v1; // eax@1
  int v2; // eax@3
  void (__cdecl *v3)(_DWORD, _DWORD, _DWORD); // eax@5
  int v4; // eax@7
  int result; // eax@8

  *(_DWORD *)a1 = &off_80BEA98;
  v1 = *(_DWORD *)(a1 + 32);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEA88;
  v2 = *(_DWORD *)(a1 + 28);
  if ( v2 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v2 + 4));
    if ( !v2 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v3 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 20);
  if ( v3 )
    v3(a1 + 12, a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v4 = *(_DWORD *)(a1 + 4);
  if ( v4 )
  {
    *(_DWORD *)(v4 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_10:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_9:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_10;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_9;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA88: using guessed type int (__cdecl *off_80BEA88)(int);
// 80BEA98: using guessed type int (__cdecl *off_80BEA98)(int);

//----- (080B56B0) --------------------------------------------------------
int __cdecl sub_80B56B0(int a1)
{
  int v1; // eax@1
  int v2; // eax@3
  void (__cdecl *v3)(_DWORD, _DWORD, _DWORD); // eax@5
  int v4; // eax@7
  int result; // eax@8

  *(_DWORD *)a1 = &off_80BEAF8;
  v1 = *(_DWORD *)(a1 + 32);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEAE8;
  v2 = *(_DWORD *)(a1 + 28);
  if ( v2 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v2 + 4));
    if ( !v2 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v3 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 20);
  if ( v3 )
    v3(a1 + 12, a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v4 = *(_DWORD *)(a1 + 4);
  if ( v4 )
  {
    *(_DWORD *)(v4 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_10:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_9:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_10;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_9;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEAE8: using guessed type int (__cdecl *off_80BEAE8)(int);
// 80BEAF8: using guessed type int (__cdecl *off_80BEAF8)(int);

//----- (080B5760) --------------------------------------------------------
int __cdecl sub_80B5760(int a1)
{
  int v1; // eax@1
  int v2; // eax@3
  void (__cdecl *v3)(_DWORD, _DWORD, _DWORD); // eax@5
  int v4; // eax@7
  int result; // eax@8

  *(_DWORD *)a1 = &off_80BEAF8;
  v1 = *(_DWORD *)(a1 + 32);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEAE8;
  v2 = *(_DWORD *)(a1 + 28);
  if ( v2 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v2 + 4));
    if ( !v2 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v3 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 20);
  if ( v3 )
    v3(a1 + 12, a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v4 = *(_DWORD *)(a1 + 4);
  if ( v4 )
  {
    *(_DWORD *)(v4 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_10:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_9:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_10;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_9;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEAE8: using guessed type int (__cdecl *off_80BEAE8)(int);
// 80BEAF8: using guessed type int (__cdecl *off_80BEAF8)(int);

//----- (080B5810) --------------------------------------------------------
void __cdecl sub_80B5810(void *a1)
{
  int v1; // eax@1
  int v2; // eax@3
  void (__cdecl *v3)(_DWORD, _DWORD, _DWORD); // eax@5
  int v4; // eax@7
  int v5; // eax@8

  *(_DWORD *)a1 = &off_80BEAF8;
  v1 = *((_DWORD *)a1 + 8);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEAE8;
  v2 = *((_DWORD *)a1 + 7);
  if ( v2 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v2 + 4));
    if ( !v2 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v3 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 5);
  if ( v3 )
    v3((char *)a1 + 12, (char *)a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v4 = *((_DWORD *)a1 + 1);
  if ( !v4 )
  {
    v5 = *((_DWORD *)a1 + 2);
    if ( !v5 )
      goto LABEL_11;
    goto LABEL_9;
  }
  *(_DWORD *)(v4 + 8) = *((_DWORD *)a1 + 2);
  v5 = *((_DWORD *)a1 + 2);
  if ( v5 )
LABEL_9:
    *(_DWORD *)(v5 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_11:
  operator delete(a1);
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEAE8: using guessed type int (__cdecl *off_80BEAE8)(int);
// 80BEAF8: using guessed type int (__cdecl *off_80BEAF8)(int);

//----- (080B58D0) --------------------------------------------------------
void __cdecl sub_80B58D0(void *a1)
{
  int v1; // eax@1
  int v2; // eax@3
  void (__cdecl *v3)(_DWORD, _DWORD, _DWORD); // eax@5
  int v4; // eax@7
  int v5; // eax@8

  *(_DWORD *)a1 = &off_80BEA98;
  v1 = *((_DWORD *)a1 + 8);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEA88;
  v2 = *((_DWORD *)a1 + 7);
  if ( v2 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v2 + 4));
    if ( !v2 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v3 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 5);
  if ( v3 )
    v3((char *)a1 + 12, (char *)a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v4 = *((_DWORD *)a1 + 1);
  if ( !v4 )
  {
    v5 = *((_DWORD *)a1 + 2);
    if ( !v5 )
      goto LABEL_11;
    goto LABEL_9;
  }
  *(_DWORD *)(v4 + 8) = *((_DWORD *)a1 + 2);
  v5 = *((_DWORD *)a1 + 2);
  if ( v5 )
LABEL_9:
    *(_DWORD *)(v5 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_11:
  operator delete(a1);
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA88: using guessed type int (__cdecl *off_80BEA88)(int);
// 80BEA98: using guessed type int (__cdecl *off_80BEA98)(int);

//----- (080B5990) --------------------------------------------------------
void __cdecl sub_80B5990(void *a1)
{
  int v1; // eax@1
  int v2; // eax@3
  void (__cdecl *v3)(_DWORD, _DWORD, _DWORD); // eax@5
  int v4; // eax@7
  int v5; // eax@8

  *(_DWORD *)a1 = &off_80BEAF8;
  v1 = *((_DWORD *)a1 + 8);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEAE8;
  v2 = *((_DWORD *)a1 + 7);
  if ( v2 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v2 + 4));
    if ( !v2 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v3 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 5);
  if ( v3 )
    v3((char *)a1 + 12, (char *)a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v4 = *((_DWORD *)a1 + 1);
  if ( !v4 )
  {
    v5 = *((_DWORD *)a1 + 2);
    if ( !v5 )
      goto LABEL_11;
    goto LABEL_9;
  }
  *(_DWORD *)(v4 + 8) = *((_DWORD *)a1 + 2);
  v5 = *((_DWORD *)a1 + 2);
  if ( v5 )
LABEL_9:
    *(_DWORD *)(v5 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_11:
  operator delete(a1);
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEAE8: using guessed type int (__cdecl *off_80BEAE8)(int);
// 80BEAF8: using guessed type int (__cdecl *off_80BEAF8)(int);

//----- (080B5A50) --------------------------------------------------------
int __cdecl sub_80B5A50(int a1, int a2)
{
  int v2; // eax@3
  int v3; // eax@4
  int v4; // ebp@4
  int v5; // eax@8
  int v6; // ecx@8
  int result; // eax@12
  int v8; // edx@14
  int v9; // ecx@16
  int v10; // edi@17
  int v11; // edx@19
  int v12; // edi@21
  int v13; // eax@29
  int v14; // eax@30
  int v15; // ebp@30
  int v16; // eax@34
  int v17; // ecx@34
  int v18; // edx@40
  int v19; // ecx@42
  int v20; // edi@43
  int v21; // edx@45
  int v22; // edi@47
  int v23; // [sp+30h] [bp-28h]@0
  int v24; // [sp+34h] [bp-24h]@0
  pthread_mutex_t *v25; // [sp+38h] [bp-20h]@1

  v25 = (pthread_mutex_t *)(a1 + 12);
  if ( a1 != -12 )
  {
    if ( !&_pthread_key_create || (v2 = pthread_mutex_lock(v25)) == 0 )
    {
      v3 = *(_DWORD *)(a1 + 40);
      v4 = a1 + 36;
      while ( v3 != v4 )
      {
        while ( a2 != *(_DWORD *)(*(_DWORD *)(v3 + 28) + 8) )
        {
          v3 = *(_DWORD *)(v3 + 4);
          if ( v3 == v4 )
            goto LABEL_8;
        }
        v8 = *(_DWORD *)(v3 + 4);
        if ( v8 )
        {
          *(_DWORD *)(v8 + 8) = *(_DWORD *)(v3 + 8);
          v8 = *(_DWORD *)(v3 + 4);
        }
        v9 = *(_DWORD *)(v3 + 8);
        if ( v9 )
        {
          *(_DWORD *)(v9 + 4) = v8;
          v10 = *(_DWORD *)(v3 + 4);
        }
        else
        {
          v10 = v8;
        }
        *(_DWORD *)(v3 + 4) = 0;
        *(_DWORD *)(v3 + 8) = 0;
        (*(void (__cdecl **)(int))(*(_DWORD *)v3 + 4))(v3);
        v3 = v10;
      }
LABEL_8:
      v5 = *(_DWORD *)(a1 + 52);
      v6 = a1 + 48;
      while ( v5 != v6 )
      {
        while ( a2 != *(_DWORD *)(*(_DWORD *)(v5 + 28) + 8) )
        {
          v5 = *(_DWORD *)(v5 + 4);
          if ( v5 == v6 )
            goto LABEL_12;
        }
        v11 = *(_DWORD *)(v5 + 4);
        if ( v11 )
        {
          *(_DWORD *)(v11 + 8) = *(_DWORD *)(v5 + 8);
          v11 = *(_DWORD *)(v5 + 4);
        }
        v12 = *(_DWORD *)(v5 + 8);
        if ( v12 )
        {
          *(_DWORD *)(v12 + 4) = v11;
          v11 = *(_DWORD *)(v5 + 4);
        }
        *(_DWORD *)(v5 + 4) = 0;
        *(_DWORD *)(v5 + 8) = 0;
        *(_DWORD *)(v5 + 8) = *(_DWORD *)(a1 + 68);
        *(_DWORD *)(v5 + 4) = a1 + 60;
        *(_DWORD *)(*(_DWORD *)(a1 + 68) + 4) = v5;
        *(_DWORD *)(a1 + 68) = v5;
        v5 = v11;
      }
LABEL_12:
      result = (int)&_pthread_key_create;
      if ( &_pthread_key_create )
        result = pthread_mutex_unlock(v25);
      return result;
    }
    std::__throw_system_error(v2);
  }
  std::__throw_system_error(1);
  if ( v23 == -12 )
  {
LABEL_53:
    std::__throw_system_error(1);
    return sub_80B5CF0(a1);
  }
  if ( &_pthread_key_create )
  {
    v13 = pthread_mutex_lock((pthread_mutex_t *)(v23 + 12));
    if ( v13 )
    {
      std::__throw_system_error(v13);
      goto LABEL_53;
    }
  }
  v14 = *(_DWORD *)(v23 + 40);
  v15 = v23 + 36;
  while ( v14 != v15 )
  {
    while ( v24 != *(_DWORD *)(*(_DWORD *)(v14 + 28) + 8) )
    {
      v14 = *(_DWORD *)(v14 + 4);
      if ( v14 == v15 )
        goto LABEL_34;
    }
    v18 = *(_DWORD *)(v14 + 4);
    if ( v18 )
    {
      *(_DWORD *)(v18 + 8) = *(_DWORD *)(v14 + 8);
      v18 = *(_DWORD *)(v14 + 4);
    }
    v19 = *(_DWORD *)(v14 + 8);
    if ( v19 )
    {
      *(_DWORD *)(v19 + 4) = v18;
      v20 = *(_DWORD *)(v14 + 4);
    }
    else
    {
      v20 = v18;
    }
    *(_DWORD *)(v14 + 4) = 0;
    *(_DWORD *)(v14 + 8) = 0;
    (*(void (__cdecl **)(int))(*(_DWORD *)v14 + 4))(v14);
    v14 = v20;
  }
LABEL_34:
  v16 = *(_DWORD *)(v23 + 52);
  v17 = v23 + 48;
  while ( v16 != v17 )
  {
    while ( v24 != *(_DWORD *)(*(_DWORD *)(v16 + 28) + 8) )
    {
      v16 = *(_DWORD *)(v16 + 4);
      if ( v16 == v17 )
        goto LABEL_38;
    }
    v21 = *(_DWORD *)(v16 + 4);
    if ( v21 )
    {
      *(_DWORD *)(v21 + 8) = *(_DWORD *)(v16 + 8);
      v21 = *(_DWORD *)(v16 + 4);
    }
    v22 = *(_DWORD *)(v16 + 8);
    if ( v22 )
    {
      *(_DWORD *)(v22 + 4) = v21;
      v21 = *(_DWORD *)(v16 + 4);
    }
    *(_DWORD *)(v16 + 4) = 0;
    *(_DWORD *)(v16 + 8) = 0;
    *(_DWORD *)(v16 + 8) = *(_DWORD *)(v23 + 68);
    *(_DWORD *)(v16 + 4) = v23 + 60;
    *(_DWORD *)(*(_DWORD *)(v23 + 68) + 4) = v16;
    *(_DWORD *)(v23 + 68) = v16;
    v16 = v21;
  }
LABEL_38:
  result = (int)&_pthread_key_create;
  if ( &_pthread_key_create )
    result = pthread_mutex_unlock((pthread_mutex_t *)a1);
  return result;
}

//----- (080B5CF0) --------------------------------------------------------
int __cdecl sub_80B5CF0(int a1)
{
  int v1; // eax@1
  int v2; // edx@4
  int v3; // ebx@6
  int v4; // eax@10
  int v5; // eax@13
  int v6; // edx@16
  int v7; // ebx@18
  int v8; // eax@22
  int v9; // eax@25
  int v10; // edx@28
  int v11; // ebx@30
  int result; // eax@34

  *(_DWORD *)a1 = &off_80BEAB8;
  v1 = *(_DWORD *)(a1 + 64);
  if ( v1 == a1 + 60 )
  {
    *(_DWORD *)(a1 + 60) = &off_80B9500;
    goto LABEL_10;
  }
  while ( 1 )
  {
    v2 = *(_DWORD *)(v1 + 4);
    if ( v2 )
    {
      *(_DWORD *)(v2 + 8) = *(_DWORD *)(v1 + 8);
      v2 = *(_DWORD *)(v1 + 4);
    }
    v3 = *(_DWORD *)(v1 + 8);
    if ( v3 )
    {
      *(_DWORD *)(v3 + 4) = v2;
      v2 = *(_DWORD *)(v1 + 4);
    }
    *(_DWORD *)(v1 + 4) = 0;
    *(_DWORD *)(v1 + 8) = 0;
    if ( a1 + 60 == v2 )
      break;
    v1 = v2;
  }
  v1 = *(_DWORD *)(a1 + 64);
  *(_DWORD *)(a1 + 60) = &off_80B9500;
  if ( v1 )
  {
LABEL_10:
    *(_DWORD *)(v1 + 8) = *(_DWORD *)(a1 + 68);
    v4 = *(_DWORD *)(a1 + 68);
    if ( !v4 )
    {
LABEL_12:
      *(_DWORD *)(a1 + 64) = 0;
      *(_DWORD *)(a1 + 68) = 0;
      goto LABEL_13;
    }
LABEL_11:
    *(_DWORD *)(v4 + 4) = *(_DWORD *)(a1 + 64);
    goto LABEL_12;
  }
  v4 = *(_DWORD *)(a1 + 68);
  if ( v4 )
    goto LABEL_11;
LABEL_13:
  v5 = *(_DWORD *)(a1 + 52);
  if ( v5 == a1 + 48 )
  {
    *(_DWORD *)(a1 + 48) = &off_80B9500;
    goto LABEL_22;
  }
  while ( 1 )
  {
    v6 = *(_DWORD *)(v5 + 4);
    if ( v6 )
    {
      *(_DWORD *)(v6 + 8) = *(_DWORD *)(v5 + 8);
      v6 = *(_DWORD *)(v5 + 4);
    }
    v7 = *(_DWORD *)(v5 + 8);
    if ( v7 )
    {
      *(_DWORD *)(v7 + 4) = v6;
      v6 = *(_DWORD *)(v5 + 4);
    }
    *(_DWORD *)(v5 + 4) = 0;
    *(_DWORD *)(v5 + 8) = 0;
    if ( a1 + 48 == v6 )
      break;
    v5 = v6;
  }
  v5 = *(_DWORD *)(a1 + 52);
  *(_DWORD *)(a1 + 48) = &off_80B9500;
  if ( v5 )
  {
LABEL_22:
    *(_DWORD *)(v5 + 8) = *(_DWORD *)(a1 + 56);
    v8 = *(_DWORD *)(a1 + 56);
    if ( !v8 )
    {
LABEL_24:
      *(_DWORD *)(a1 + 52) = 0;
      *(_DWORD *)(a1 + 56) = 0;
      goto LABEL_25;
    }
LABEL_23:
    *(_DWORD *)(v8 + 4) = *(_DWORD *)(a1 + 52);
    goto LABEL_24;
  }
  v8 = *(_DWORD *)(a1 + 56);
  if ( v8 )
    goto LABEL_23;
LABEL_25:
  v9 = *(_DWORD *)(a1 + 40);
  if ( v9 == a1 + 36 )
  {
    *(_DWORD *)(a1 + 36) = &off_80B9500;
    goto LABEL_34;
  }
  while ( 1 )
  {
    v10 = *(_DWORD *)(v9 + 4);
    if ( v10 )
    {
      *(_DWORD *)(v10 + 8) = *(_DWORD *)(v9 + 8);
      v10 = *(_DWORD *)(v9 + 4);
    }
    v11 = *(_DWORD *)(v9 + 8);
    if ( v11 )
    {
      *(_DWORD *)(v11 + 4) = v10;
      v10 = *(_DWORD *)(v9 + 4);
    }
    *(_DWORD *)(v9 + 4) = 0;
    *(_DWORD *)(v9 + 8) = 0;
    if ( a1 + 36 == v10 )
      break;
    v9 = v10;
  }
  v9 = *(_DWORD *)(a1 + 40);
  *(_DWORD *)(a1 + 36) = &off_80B9500;
  if ( v9 )
  {
LABEL_34:
    *(_DWORD *)(v9 + 8) = *(_DWORD *)(a1 + 44);
    result = *(_DWORD *)(a1 + 44);
    if ( !result )
    {
LABEL_36:
      *(_DWORD *)(a1 + 40) = 0;
      *(_DWORD *)(a1 + 44) = 0;
      return result;
    }
LABEL_35:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 40);
    goto LABEL_36;
  }
  result = *(_DWORD *)(a1 + 44);
  if ( result )
    goto LABEL_35;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEAB8: using guessed type void *off_80BEAB8;

//----- (080B5ED0) --------------------------------------------------------
int __cdecl sub_80B5ED0(int a1)
{
  int v1; // esi@1
  int v2; // eax@3
  int v3; // edx@6
  int v4; // ecx@8
  int v5; // eax@12
  int v6; // eax@15
  int v7; // edx@18
  int v8; // ecx@20
  int v9; // eax@24
  int v10; // eax@27
  int v11; // edx@30
  int v12; // ecx@32
  int result; // eax@36

  v1 = *(_DWORD *)(a1 + 72);
  if ( v1 )
  {
    evdns_base_free(*(_DWORD *)(v1 + 4), 1);
    operator delete((void *)v1);
  }
  *(_DWORD *)(a1 + 72) = 0;
  *(_DWORD *)a1 = &off_80BEA58;
  v2 = *(_DWORD *)(a1 + 64);
  if ( v2 == a1 + 60 )
  {
    *(_DWORD *)(a1 + 60) = &off_80B9500;
    goto LABEL_12;
  }
  while ( 1 )
  {
    v3 = *(_DWORD *)(v2 + 4);
    if ( v3 )
    {
      *(_DWORD *)(v3 + 8) = *(_DWORD *)(v2 + 8);
      v3 = *(_DWORD *)(v2 + 4);
    }
    v4 = *(_DWORD *)(v2 + 8);
    if ( v4 )
    {
      *(_DWORD *)(v4 + 4) = v3;
      v3 = *(_DWORD *)(v2 + 4);
    }
    *(_DWORD *)(v2 + 4) = 0;
    *(_DWORD *)(v2 + 8) = 0;
    if ( a1 + 60 == v3 )
      break;
    v2 = v3;
  }
  v2 = *(_DWORD *)(a1 + 64);
  *(_DWORD *)(a1 + 60) = &off_80B9500;
  if ( v2 )
  {
LABEL_12:
    *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 68);
    v5 = *(_DWORD *)(a1 + 68);
    if ( !v5 )
    {
LABEL_14:
      *(_DWORD *)(a1 + 64) = 0;
      *(_DWORD *)(a1 + 68) = 0;
      goto LABEL_15;
    }
LABEL_13:
    *(_DWORD *)(v5 + 4) = *(_DWORD *)(a1 + 64);
    goto LABEL_14;
  }
  v5 = *(_DWORD *)(a1 + 68);
  if ( v5 )
    goto LABEL_13;
LABEL_15:
  v6 = *(_DWORD *)(a1 + 52);
  if ( v6 == a1 + 48 )
  {
    *(_DWORD *)(a1 + 48) = &off_80B9500;
    goto LABEL_24;
  }
  while ( 1 )
  {
    v7 = *(_DWORD *)(v6 + 4);
    if ( v7 )
    {
      *(_DWORD *)(v7 + 8) = *(_DWORD *)(v6 + 8);
      v7 = *(_DWORD *)(v6 + 4);
    }
    v8 = *(_DWORD *)(v6 + 8);
    if ( v8 )
    {
      *(_DWORD *)(v8 + 4) = v7;
      v7 = *(_DWORD *)(v6 + 4);
    }
    *(_DWORD *)(v6 + 4) = 0;
    *(_DWORD *)(v6 + 8) = 0;
    if ( a1 + 48 == v7 )
      break;
    v6 = v7;
  }
  v6 = *(_DWORD *)(a1 + 52);
  *(_DWORD *)(a1 + 48) = &off_80B9500;
  if ( v6 )
  {
LABEL_24:
    *(_DWORD *)(v6 + 8) = *(_DWORD *)(a1 + 56);
    v9 = *(_DWORD *)(a1 + 56);
    if ( !v9 )
    {
LABEL_26:
      *(_DWORD *)(a1 + 52) = 0;
      *(_DWORD *)(a1 + 56) = 0;
      goto LABEL_27;
    }
LABEL_25:
    *(_DWORD *)(v9 + 4) = *(_DWORD *)(a1 + 52);
    goto LABEL_26;
  }
  v9 = *(_DWORD *)(a1 + 56);
  if ( v9 )
    goto LABEL_25;
LABEL_27:
  v10 = *(_DWORD *)(a1 + 40);
  if ( v10 == a1 + 36 )
  {
    *(_DWORD *)(a1 + 36) = &off_80B9500;
    goto LABEL_36;
  }
  while ( 1 )
  {
    v11 = *(_DWORD *)(v10 + 4);
    if ( v11 )
    {
      *(_DWORD *)(v11 + 8) = *(_DWORD *)(v10 + 8);
      v11 = *(_DWORD *)(v10 + 4);
    }
    v12 = *(_DWORD *)(v10 + 8);
    if ( v12 )
    {
      *(_DWORD *)(v12 + 4) = v11;
      v11 = *(_DWORD *)(v10 + 4);
    }
    *(_DWORD *)(v10 + 4) = 0;
    *(_DWORD *)(v10 + 8) = 0;
    if ( a1 + 36 == v11 )
      break;
    v10 = v11;
  }
  v10 = *(_DWORD *)(a1 + 40);
  *(_DWORD *)(a1 + 36) = &off_80B9500;
  if ( v10 )
  {
LABEL_36:
    *(_DWORD *)(v10 + 8) = *(_DWORD *)(a1 + 44);
    result = *(_DWORD *)(a1 + 44);
    if ( !result )
    {
LABEL_38:
      *(_DWORD *)(a1 + 40) = 0;
      *(_DWORD *)(a1 + 44) = 0;
      return result;
    }
LABEL_37:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 40);
    goto LABEL_38;
  }
  result = *(_DWORD *)(a1 + 44);
  if ( result )
    goto LABEL_37;
  return result;
}
// 804C920: using guessed type int __cdecl evdns_base_free(_DWORD, _DWORD);
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA58: using guessed type void *off_80BEA58;

//----- (080B60E0) --------------------------------------------------------
int __cdecl sub_80B60E0(int a1)
{
  void *v1; // esi@1
  int v2; // eax@3
  int v3; // edx@6
  int v4; // ecx@8
  int v5; // eax@12
  int v6; // eax@15
  int v7; // edx@18
  int v8; // ecx@20
  int v9; // eax@24
  int v10; // eax@27
  int v11; // edx@30
  int v12; // ecx@32
  int result; // eax@36

  v1 = *(void **)(a1 + 76);
  if ( v1 )
  {
    sub_809CB60(*(_DWORD *)(a1 + 76));
    operator delete(v1);
  }
  *(_DWORD *)(a1 + 76) = 0;
  *(_DWORD *)a1 = &off_80BD870;
  v2 = *(_DWORD *)(a1 + 64);
  if ( v2 == a1 + 60 )
  {
    *(_DWORD *)(a1 + 60) = &off_80B9500;
    goto LABEL_12;
  }
  while ( 1 )
  {
    v3 = *(_DWORD *)(v2 + 4);
    if ( v3 )
    {
      *(_DWORD *)(v3 + 8) = *(_DWORD *)(v2 + 8);
      v3 = *(_DWORD *)(v2 + 4);
    }
    v4 = *(_DWORD *)(v2 + 8);
    if ( v4 )
    {
      *(_DWORD *)(v4 + 4) = v3;
      v3 = *(_DWORD *)(v2 + 4);
    }
    *(_DWORD *)(v2 + 4) = 0;
    *(_DWORD *)(v2 + 8) = 0;
    if ( a1 + 60 == v3 )
      break;
    v2 = v3;
  }
  v2 = *(_DWORD *)(a1 + 64);
  *(_DWORD *)(a1 + 60) = &off_80B9500;
  if ( v2 )
  {
LABEL_12:
    *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 68);
    v5 = *(_DWORD *)(a1 + 68);
    if ( !v5 )
    {
LABEL_14:
      *(_DWORD *)(a1 + 64) = 0;
      *(_DWORD *)(a1 + 68) = 0;
      goto LABEL_15;
    }
LABEL_13:
    *(_DWORD *)(v5 + 4) = *(_DWORD *)(a1 + 64);
    goto LABEL_14;
  }
  v5 = *(_DWORD *)(a1 + 68);
  if ( v5 )
    goto LABEL_13;
LABEL_15:
  v6 = *(_DWORD *)(a1 + 52);
  if ( v6 == a1 + 48 )
  {
    *(_DWORD *)(a1 + 48) = &off_80B9500;
    goto LABEL_24;
  }
  while ( 1 )
  {
    v7 = *(_DWORD *)(v6 + 4);
    if ( v7 )
    {
      *(_DWORD *)(v7 + 8) = *(_DWORD *)(v6 + 8);
      v7 = *(_DWORD *)(v6 + 4);
    }
    v8 = *(_DWORD *)(v6 + 8);
    if ( v8 )
    {
      *(_DWORD *)(v8 + 4) = v7;
      v7 = *(_DWORD *)(v6 + 4);
    }
    *(_DWORD *)(v6 + 4) = 0;
    *(_DWORD *)(v6 + 8) = 0;
    if ( a1 + 48 == v7 )
      break;
    v6 = v7;
  }
  v6 = *(_DWORD *)(a1 + 52);
  *(_DWORD *)(a1 + 48) = &off_80B9500;
  if ( v6 )
  {
LABEL_24:
    *(_DWORD *)(v6 + 8) = *(_DWORD *)(a1 + 56);
    v9 = *(_DWORD *)(a1 + 56);
    if ( !v9 )
    {
LABEL_26:
      *(_DWORD *)(a1 + 52) = 0;
      *(_DWORD *)(a1 + 56) = 0;
      goto LABEL_27;
    }
LABEL_25:
    *(_DWORD *)(v9 + 4) = *(_DWORD *)(a1 + 52);
    goto LABEL_26;
  }
  v9 = *(_DWORD *)(a1 + 56);
  if ( v9 )
    goto LABEL_25;
LABEL_27:
  v10 = *(_DWORD *)(a1 + 40);
  if ( v10 == a1 + 36 )
  {
    *(_DWORD *)(a1 + 36) = &off_80B9500;
    goto LABEL_36;
  }
  while ( 1 )
  {
    v11 = *(_DWORD *)(v10 + 4);
    if ( v11 )
    {
      *(_DWORD *)(v11 + 8) = *(_DWORD *)(v10 + 8);
      v11 = *(_DWORD *)(v10 + 4);
    }
    v12 = *(_DWORD *)(v10 + 8);
    if ( v12 )
    {
      *(_DWORD *)(v12 + 4) = v11;
      v11 = *(_DWORD *)(v10 + 4);
    }
    *(_DWORD *)(v10 + 4) = 0;
    *(_DWORD *)(v10 + 8) = 0;
    if ( a1 + 36 == v11 )
      break;
    v10 = v11;
  }
  v10 = *(_DWORD *)(a1 + 40);
  *(_DWORD *)(a1 + 36) = &off_80B9500;
  if ( v10 )
  {
LABEL_36:
    *(_DWORD *)(v10 + 8) = *(_DWORD *)(a1 + 44);
    result = *(_DWORD *)(a1 + 44);
    if ( !result )
    {
LABEL_38:
      *(_DWORD *)(a1 + 40) = 0;
      *(_DWORD *)(a1 + 44) = 0;
      return result;
    }
LABEL_37:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 40);
    goto LABEL_38;
  }
  result = *(_DWORD *)(a1 + 44);
  if ( result )
    goto LABEL_37;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BD870: using guessed type void *off_80BD870;

//----- (080B62E0) --------------------------------------------------------
int __cdecl sub_80B62E0(int a1, int a2)
{
  int result; // eax@1

  result = a2;
  *(_DWORD *)(a1 + 8) = 0;
  if ( *(_DWORD *)(a2 + 8) )
  {
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
    result = (*(int (__cdecl **)(int, int, signed int))(a2 + 8))(a1, a2, 2);
  }
  return result;
}

//----- (080B6420) --------------------------------------------------------
pthread_mutex_t *__usercall sub_80B6420@<eax>(_UNKNOWN *a1@<esi>, int a2)
{
  int v2; // eax@3
  int v3; // edi@4
  int v4; // eax@5
  int v5; // eax@7
  int v6; // eax@17
  char v7; // bp@20
  int v8; // eax@24
  int v9; // ebp@26
  pthread_mutex_t *result; // eax@26
  int v11; // eax@27
  int v12; // eax@29
  int v13; // eax@39
  int v14; // eax@48
  int v15; // ST0C_4@54
  int v16; // [sp+4h] [bp-38h]@0
  pthread_mutex_t *v17; // [sp+18h] [bp-24h]@1
  char v18; // [sp+1Ch] [bp-20h]@1

  v17 = (pthread_mutex_t *)(a2 + 12);
  v18 = 0;
  if ( a2 == -12 )
    goto LABEL_45;
  a1 = &_pthread_key_create;
  if ( &_pthread_key_create )
  {
    v2 = pthread_mutex_lock((pthread_mutex_t *)(a2 + 12));
    if ( v2 )
    {
      v14 = std::__throw_system_error(v2);
      goto LABEL_49;
    }
  }
  v18 = 1;
  v3 = *(_DWORD *)(a2 + 64);
  if ( v3 != a2 + 60 )
  {
    while ( 1 )
    {
      v4 = *(_DWORD *)(v3 + 4);
      if ( v4 )
        *(_DWORD *)(v4 + 8) = *(_DWORD *)(v3 + 8);
      v5 = *(_DWORD *)(v3 + 8);
      if ( v5 )
        *(_DWORD *)(v5 + 4) = *(_DWORD *)(v3 + 4);
      *(_DWORD *)(v3 + 4) = 0;
      *(_DWORD *)(v3 + 8) = 0;
      if ( !v18 )
        goto LABEL_45;
      if ( v17 )
      {
        if ( &_pthread_key_create )
          pthread_mutex_unlock(v17);
        v18 = 0;
      }
      sub_80698F0(*(_DWORD *)(a2 + 4), v3);
      if ( !v17 )
      {
        v14 = std::__throw_system_error(1);
        goto LABEL_49;
      }
      if ( v18 )
        break;
      if ( &_pthread_key_create )
      {
        v6 = pthread_mutex_lock(v17);
        if ( v6 )
        {
          v14 = std::__throw_system_error(v6);
          goto LABEL_49;
        }
      }
      v18 = 1;
      v3 = *(_DWORD *)(a2 + 64);
      if ( v3 == a2 + 60 )
        goto LABEL_19;
    }
    v14 = std::__throw_system_error(35);
LABEL_54:
    v15 = v14;
    sub_80584A0((int)&v17, v16);
    v14 = v15;
LABEL_51:
    Unwind_Resume(v14);
  }
LABEL_19:
  if ( *(_DWORD *)(a2 + 52) != a2 + 48 )
  {
    v7 = v18;
    if ( v18 )
    {
      if ( v17 )
      {
        if ( !&_pthread_key_create )
        {
LABEL_25:
          v18 = 1;
          goto LABEL_26;
        }
        pthread_mutex_unlock(v17);
        v18 = 0;
        if ( v17 )
        {
          v8 = pthread_mutex_lock(v17);
          if ( !v8 )
            goto LABEL_25;
          v14 = std::__throw_system_error(v8);
LABEL_49:
          v7 = v18;
          goto LABEL_50;
        }
        v7 = 0;
      }
      v14 = std::__throw_system_error(1);
LABEL_50:
      if ( !v7 )
        goto LABEL_51;
      goto LABEL_54;
    }
LABEL_45:
    result = (pthread_mutex_t *)std::__throw_system_error(1);
    goto LABEL_46;
  }
LABEL_26:
  v9 = *(_DWORD *)(a2 + 40);
  result = (pthread_mutex_t *)(a2 + 36);
  if ( v9 != a2 + 36 )
  {
    while ( 1 )
    {
      v11 = *(_DWORD *)(v9 + 4);
      if ( v11 )
        *(_DWORD *)(v11 + 8) = *(_DWORD *)(v9 + 8);
      v12 = *(_DWORD *)(v9 + 8);
      if ( v12 )
        *(_DWORD *)(v12 + 4) = *(_DWORD *)(v9 + 4);
      *(_DWORD *)(v9 + 4) = 0;
      *(_DWORD *)(v9 + 8) = 0;
      *(_DWORD *)(v9 + 8) = *(_DWORD *)(a2 + 56);
      *(_DWORD *)(v9 + 4) = a2 + 48;
      *(_DWORD *)(*(_DWORD *)(a2 + 56) + 4) = v9;
      *(_DWORD *)(a2 + 56) = v9;
      if ( !v18 )
        goto LABEL_45;
      if ( v17 )
      {
        if ( &_pthread_key_create )
          pthread_mutex_unlock(v17);
        v18 = 0;
      }
      sub_806A110(*(_DWORD *)(a2 + 4), v9);
      if ( !v17 )
        goto LABEL_57;
      if ( v18 )
        break;
      if ( &_pthread_key_create )
      {
        v13 = pthread_mutex_lock(v17);
        if ( v13 )
        {
          v14 = std::__throw_system_error(v13);
          goto LABEL_49;
        }
      }
      v18 = 1;
      v9 = *(_DWORD *)(a2 + 40);
      if ( v9 == a2 + 36 )
        goto LABEL_41;
    }
    std::__throw_system_error(35);
LABEL_57:
    v14 = std::__throw_system_error(1);
    goto LABEL_49;
  }
LABEL_46:
  if ( v18 )
  {
LABEL_41:
    result = v17;
    if ( v17 )
    {
      if ( a1 )
        result = (pthread_mutex_t *)pthread_mutex_unlock(v17);
    }
  }
  return result;
}
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);

//----- (080B6720) --------------------------------------------------------
pthread_mutex_t *__usercall sub_80B6720@<eax>(_UNKNOWN *a1@<esi>, int a2)
{
  int v2; // eax@3
  int v3; // edi@4
  int v4; // eax@5
  int v5; // eax@7
  int v6; // eax@17
  char v7; // bp@20
  int v8; // eax@24
  int v9; // ebp@26
  pthread_mutex_t *result; // eax@26
  int v11; // eax@27
  int v12; // eax@29
  int v13; // eax@39
  int v14; // eax@48
  int v15; // ST0C_4@54
  int v16; // [sp+4h] [bp-38h]@0
  pthread_mutex_t *v17; // [sp+18h] [bp-24h]@1
  char v18; // [sp+1Ch] [bp-20h]@1

  v17 = (pthread_mutex_t *)(a2 + 12);
  v18 = 0;
  if ( a2 == -12 )
    goto LABEL_45;
  a1 = &_pthread_key_create;
  if ( &_pthread_key_create )
  {
    v2 = pthread_mutex_lock((pthread_mutex_t *)(a2 + 12));
    if ( v2 )
    {
      v14 = std::__throw_system_error(v2);
      goto LABEL_49;
    }
  }
  v18 = 1;
  v3 = *(_DWORD *)(a2 + 64);
  if ( v3 != a2 + 60 )
  {
    while ( 1 )
    {
      v4 = *(_DWORD *)(v3 + 4);
      if ( v4 )
        *(_DWORD *)(v4 + 8) = *(_DWORD *)(v3 + 8);
      v5 = *(_DWORD *)(v3 + 8);
      if ( v5 )
        *(_DWORD *)(v5 + 4) = *(_DWORD *)(v3 + 4);
      *(_DWORD *)(v3 + 4) = 0;
      *(_DWORD *)(v3 + 8) = 0;
      if ( !v18 )
        goto LABEL_45;
      if ( v17 )
      {
        if ( &_pthread_key_create )
          pthread_mutex_unlock(v17);
        v18 = 0;
      }
      sub_806CE20(*(_DWORD *)(a2 + 4), v3);
      if ( !v17 )
      {
        v14 = std::__throw_system_error(1);
        goto LABEL_49;
      }
      if ( v18 )
        break;
      if ( &_pthread_key_create )
      {
        v6 = pthread_mutex_lock(v17);
        if ( v6 )
        {
          v14 = std::__throw_system_error(v6);
          goto LABEL_49;
        }
      }
      v18 = 1;
      v3 = *(_DWORD *)(a2 + 64);
      if ( v3 == a2 + 60 )
        goto LABEL_19;
    }
    v14 = std::__throw_system_error(35);
LABEL_54:
    v15 = v14;
    sub_80584A0((int)&v17, v16);
    v14 = v15;
LABEL_51:
    Unwind_Resume(v14);
  }
LABEL_19:
  if ( *(_DWORD *)(a2 + 52) != a2 + 48 )
  {
    v7 = v18;
    if ( v18 )
    {
      if ( v17 )
      {
        if ( !&_pthread_key_create )
        {
LABEL_25:
          v18 = 1;
          goto LABEL_26;
        }
        pthread_mutex_unlock(v17);
        v18 = 0;
        if ( v17 )
        {
          v8 = pthread_mutex_lock(v17);
          if ( !v8 )
            goto LABEL_25;
          v14 = std::__throw_system_error(v8);
LABEL_49:
          v7 = v18;
          goto LABEL_50;
        }
        v7 = 0;
      }
      v14 = std::__throw_system_error(1);
LABEL_50:
      if ( !v7 )
        goto LABEL_51;
      goto LABEL_54;
    }
LABEL_45:
    result = (pthread_mutex_t *)std::__throw_system_error(1);
    goto LABEL_46;
  }
LABEL_26:
  v9 = *(_DWORD *)(a2 + 40);
  result = (pthread_mutex_t *)(a2 + 36);
  if ( v9 != a2 + 36 )
  {
    while ( 1 )
    {
      v11 = *(_DWORD *)(v9 + 4);
      if ( v11 )
        *(_DWORD *)(v11 + 8) = *(_DWORD *)(v9 + 8);
      v12 = *(_DWORD *)(v9 + 8);
      if ( v12 )
        *(_DWORD *)(v12 + 4) = *(_DWORD *)(v9 + 4);
      *(_DWORD *)(v9 + 4) = 0;
      *(_DWORD *)(v9 + 8) = 0;
      *(_DWORD *)(v9 + 8) = *(_DWORD *)(a2 + 56);
      *(_DWORD *)(v9 + 4) = a2 + 48;
      *(_DWORD *)(*(_DWORD *)(a2 + 56) + 4) = v9;
      *(_DWORD *)(a2 + 56) = v9;
      if ( !v18 )
        goto LABEL_45;
      if ( v17 )
      {
        if ( &_pthread_key_create )
          pthread_mutex_unlock(v17);
        v18 = 0;
      }
      sub_806DA10(*(_DWORD *)(a2 + 4), v9);
      if ( !v17 )
        goto LABEL_57;
      if ( v18 )
        break;
      if ( &_pthread_key_create )
      {
        v13 = pthread_mutex_lock(v17);
        if ( v13 )
        {
          v14 = std::__throw_system_error(v13);
          goto LABEL_49;
        }
      }
      v18 = 1;
      v9 = *(_DWORD *)(a2 + 40);
      if ( v9 == a2 + 36 )
        goto LABEL_41;
    }
    std::__throw_system_error(35);
LABEL_57:
    v14 = std::__throw_system_error(1);
    goto LABEL_49;
  }
LABEL_46:
  if ( v18 )
  {
LABEL_41:
    result = v17;
    if ( v17 )
    {
      if ( a1 )
        result = (pthread_mutex_t *)pthread_mutex_unlock(v17);
    }
  }
  return result;
}
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);

//----- (080B6A20) --------------------------------------------------------
int __cdecl sub_80B6A20(int a1, int a2)
{
  int result; // eax@1

  result = a2;
  *(_DWORD *)(a1 + 8) = 0;
  if ( *(_DWORD *)(a2 + 8) )
  {
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
    result = (*(int (__cdecl **)(int, int, signed int))(a2 + 8))(a1, a2, 2);
  }
  return result;
}

//----- (080B6A90) --------------------------------------------------------
int __cdecl sub_80B6A90(int a1, int a2)
{
  int result; // eax@1

  result = a2;
  *(_DWORD *)(a1 + 8) = 0;
  if ( *(_DWORD *)(a2 + 8) )
  {
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
    result = (*(int (__cdecl **)(int, int, signed int))(a2 + 8))(a1, a2, 2);
  }
  return result;
}

//----- (080B6B00) --------------------------------------------------------
int __cdecl sub_80B6B00(int a1, int a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a1 + 8) )
  {
    result = (*(int (**)(void))(a1 + 12))();
  }
  else
  {
    std::__throw_bad_function_call();
    result = sub_80B6B30((int *)a1, (int *)a2);
  }
  return result;
}

//----- (080B6B30) --------------------------------------------------------
int __cdecl sub_80B6B30(int *a1, int *a2)
{
  int v2; // eax@1
  int result; // eax@3
  bool v4; // zf@3
  int v5; // [sp+1Ch] [bp-10h]@1

  v2 = *a2;
  v5 = v2;
  if ( v2 )
    _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
  sub_80B6B00(*a1, (int)&v5);
  result = v5;
  v4 = v5 == 0;
  if ( v5 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
    if ( v4 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}

//----- (080B6B90) --------------------------------------------------------
int __cdecl sub_80B6B90(int *a1, int *a2)
{
  int v2; // eax@1
  int result; // eax@3
  bool v4; // zf@3
  int v5; // [sp+1Ch] [bp-10h]@1

  v2 = *a2;
  v5 = v2;
  if ( v2 )
    _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
  sub_80B6B00(*a1, (int)&v5);
  result = v5;
  v4 = v5 == 0;
  if ( v5 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
    if ( v4 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}

//----- (080B6BF0) --------------------------------------------------------
int __cdecl sub_80B6BF0(int *a1, int *a2)
{
  int v2; // eax@1
  int result; // eax@3
  bool v4; // zf@3
  int v5; // [sp+1Ch] [bp-10h]@1

  v2 = *a2;
  v5 = v2;
  if ( v2 )
    _InterlockedIncrement((volatile signed __int32 *)(v2 + 4));
  sub_80B6B00(*a1, (int)&v5);
  result = v5;
  v4 = v5 == 0;
  if ( v5 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v5 + 4));
    if ( v4 )
      result = (*(int (__cdecl **)(int))(*(_DWORD *)result + 4))(result);
  }
  return result;
}

//----- (080B6C50) --------------------------------------------------------
int __cdecl sub_80B6C50(int a1, void *a2)
{
  int v2; // ebx@3
  int v3; // eax@3
  int v4; // ebx@4
  signed int v5; // eax@5
  int v6; // esi@8
  unsigned int v7; // ebp@8
  int v8; // eax@8
  int v9; // edx@9
  int v10; // edx@11
  int v11; // edx@12
  int v12; // eax@14
  std::ostream *v13; // esi@14
  int v14; // eax@14
  int v15; // ebx@14
  char v16; // al@16
  std::ostream *v17; // eax@17
  int v18; // edx@19
  int v19; // esi@25
  int v20; // eax@25
  int v21; // esi@26
  signed int v22; // eax@27
  unsigned int v23; // ebp@30
  int v24; // ebx@30
  int v25; // eax@30
  int v26; // edx@31
  int v27; // ebx@33
  int v28; // edx@34
  int v29; // eax@36
  std::ostream *v30; // esi@36
  int v31; // eax@36
  int v32; // ebx@36
  char v33; // al@38
  std::ostream *v34; // eax@39
  int v36; // esi@75
  signed __int32 v37; // ecx@55
  signed __int32 v38; // eax@59
  signed __int32 v39; // ecx@63
  signed __int32 v40; // ecx@65
  signed __int32 v41; // edx@69
  int v42; // ebx@74
  signed __int32 v43; // ecx@77
  int v44; // [sp+Ch] [bp-150h]@5
  int v45; // [sp+Ch] [bp-150h]@27
  int *v46; // [sp+20h] [bp-13Ch]@2
  int *v47; // [sp+20h] [bp-13Ch]@24
  int v48; // [sp+24h] [bp-138h]@2
  int v49; // [sp+24h] [bp-138h]@8
  int v50; // [sp+24h] [bp-138h]@24
  std::locale *v51; // [sp+28h] [bp-134h]@1
  std::locale *v52; // [sp+28h] [bp-134h]@23
  char v53; // [sp+3Fh] [bp-11Dh]@57
  int *v54; // [sp+40h] [bp-11Ch]@4
  int *v55; // [sp+44h] [bp-118h]@10
  int v56; // [sp+48h] [bp-114h]@8
  int v57; // [sp+4Ch] [bp-110h]@2
  int v58; // [sp+6Ch] [bp-F0h]@10
  int v59; // [sp+8Ch] [bp-D0h]@8
  int v60; // [sp+90h] [bp-CCh]@8
  int v61; // [sp+94h] [bp-C8h]@8
  int v62; // [sp+98h] [bp-C4h]@8
  int v63; // [sp+9Ch] [bp-C0h]@8
  int v64; // [sp+A0h] [bp-BCh]@8
  int v65; // [sp+A4h] [bp-B8h]@8
  int v66; // [sp+A8h] [bp-B4h]@8
  char v67; // [sp+ACh] [bp-B0h]@8
  int v68; // [sp+B0h] [bp-ACh]@8
  int v69; // [sp+B4h] [bp-A8h]@8
  int v70; // [sp+B8h] [bp-A4h]@8
  int v71; // [sp+128h] [bp-34h]@8
  char v72; // [sp+12Ch] [bp-30h]@8
  char v73; // [sp+12Dh] [bp-2Fh]@8
  int v74; // [sp+130h] [bp-2Ch]@8
  int v75; // [sp+134h] [bp-28h]@8
  int v76; // [sp+138h] [bp-24h]@8
  int v77; // [sp+13Ch] [bp-20h]@8

  sub_8069320(a2, 3, (int)"reach", 5);
  sub_8098450(a2, 6);
  v51 = *(std::locale **)(a1 + 16);
  if ( *(std::locale **)(a1 + 12) != v51 )
  {
    v48 = *(_DWORD *)(a1 + 12);
    v46 = &v57;
    while ( 1 )
    {
      v2 = snprintf((char *)&v57, 0x1Fu, "%d", *(_BYTE *)v48);
      v3 = *((_DWORD *)a2 + 4);
      if ( !v3 )
      {
        sub_8067E80(a2);
        *((_DWORD *)a2 + 4) = v3;
      }
      v54 = &v57;
      v4 = (int)((char *)&v57 + v2);
      while ( 1 )
      {
        v5 = sub_808C480((int)((char *)a2 + 20), 1u, (const void **)&v54, v4, (void **)v3, *(_DWORD *)(v3 + 4));
        if ( v5 != 4 )
          break;
        sub_8067E80(a2);
        *((_DWORD *)a2 + 4) = v3;
      }
      if ( v5 )
        break;
      v48 += 12;
      if ( v51 == (std::locale *)v48 )
        goto LABEL_23;
    }
    if ( log_level <= 5 )
    {
      v49 = (int)&v59;
      std::ios_base::ios_base((std::ios_base *)&v70);
      v70 = (int)&unk_80CF5C8;
      v71 = 0;
      v72 = 0;
      v73 = 0;
      v74 = 0;
      v75 = 0;
      v76 = 0;
      v77 = 0;
      v6 = dword_80CF674;
      v59 = dword_80CF674;
      *(int *)((char *)&v59 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v59 + *(_DWORD *)(v59 - 12), 0);
      v59 = (int)&unk_80CF5DC;
      v70 = (int)&unk_80CF5F0;
      v60 = (int)&unk_80CF7F0;
      v61 = 0;
      v62 = 0;
      v63 = 0;
      v64 = 0;
      v65 = 0;
      v66 = 0;
      std::locale::locale((std::locale *)&v67);
      v60 = (int)&unk_80CF588;
      v68 = 16;
      v69 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v70, &v60);
      v7 = std::__ostream_insert<char,std::char_traits<char>>(
             &v59,
             &unk_80CF83C,
             std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v7, "VERIFY failed (", 15);
      std::__ostream_insert<char,std::char_traits<char>>(v7, "res == JSTN_STATUS_SUCCESS", 26);
      std::__ostream_insert<char,std::char_traits<char>>(v7, "): ", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v7, "Could not write value", 21);
      v56 = (int)&unk_80CF83C;
      v8 = *(_DWORD *)(v7 + 24);
      if ( v8 )
      {
        v9 = *(_DWORD *)(v7 + 16);
        LOBYTE(v44) = 0;
        if ( v8 > (unsigned int)v9 )
        {
          v58 = std::string::_S_construct<char *>((int)&v55, v7, &v70, *(_DWORD *)(v7 + 20), v8, (int)&v55);
          v46 = &v58;
          std::string::swap((std::string *)&v56, (std::string *)&v58);
        }
        else
        {
          v58 = std::string::_S_construct<char *>((int)&v55, v7, &v70, *(_DWORD *)(v7 + 20), v9, (int)&v55);
          v46 = &v58;
          std::string::swap((std::string *)&v56, (std::string *)&v58);
        }
        v10 = v58 - 12;
        if ( (_DWORD *)(v58 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v37 = _InterlockedExchangeAdd((volatile signed __int32 *)(v58 - 4), 0xFFFFFFFF);
          }
          else
          {
            v37 = *(_DWORD *)(v58 - 4);
            *(_DWORD *)(v58 - 4) = v37 - 1;
          }
          if ( v37 <= 0 )
            std::string::_Rep::_M_destroy(v10, &v53);
        }
      }
      else
      {
        std::string::assign((std::string *)&v56, (const std::string *)(v7 + 40));
      }
      v59 = (int)&unk_80CF5DC;
      v70 = (int)&unk_80CF5F0;
      v60 = (int)&unk_80CF588;
      v11 = v69 - 12;
      if ( (_DWORD *)(v69 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v43 = _InterlockedExchangeAdd((volatile signed __int32 *)(v69 - 4), 0xFFFFFFFF);
        }
        else
        {
          v43 = *(_DWORD *)(v69 - 4);
          *(_DWORD *)(v69 - 4) = v43 - 1;
        }
        if ( v43 <= 0 )
          std::string::_Rep::_M_destroy(v11, &v58);
      }
      v60 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v67);
      v59 = v6;
      *(int *)((char *)&v59 + *(_DWORD *)(v6 - 12)) = dword_80CF678;
      v70 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v70);
      if ( byte_80CE64C )
      {
        v12 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v56, *(_DWORD *)(v56 - 12));
        v13 = (std::ostream *)v12;
        v14 = *(_DWORD *)(*(_DWORD *)v12 - 12);
        v15 = *(_DWORD *)((char *)v13 + v14 + 124);
        if ( !v15 )
        {
          v36 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v58 - 12, &v53);
          std::string::_Rep::_M_dispose(v56 - 12, v46);
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v59);
          std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, 0);
          Unwind_Resume(v36);
        }
        if ( *(_BYTE *)(v15 + 28) )
        {
          v16 = *(_BYTE *)(v15 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v13 + v14 + 124));
          v16 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v15 + 24))(v15, 10);
        }
        v17 = (std::ostream *)std::ostream::put(v13, v16);
        std::ostream::flush(v17);
      }
      syslog(3, "%s", v56, v44);
LABEL_19:
      v18 = v56 - 12;
      if ( (_DWORD *)(v56 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v38 = _InterlockedExchangeAdd((volatile signed __int32 *)(v56 - 4), 0xFFFFFFFF);
        }
        else
        {
          v39 = *(_DWORD *)(v56 - 4);
          *(_DWORD *)(v56 - 4) = v39 - 1;
          v38 = v39;
        }
        if ( v38 <= 0 )
          std::string::_Rep::_M_destroy(v18, v49);
      }
      goto LABEL_20;
    }
    goto LABEL_20;
  }
LABEL_23:
  sub_8098450(a2, 7);
  sub_8069320(a2, 3, (int)"time", 4);
  sub_8098450(a2, 6);
  v52 = *(std::locale **)(a1 + 16);
  if ( *(std::locale **)(a1 + 12) != v52 )
  {
    v50 = *(_DWORD *)(a1 + 12);
    v47 = &v58;
    while ( 1 )
    {
      v19 = snprintf((char *)&v58, 0x1Fu, "%d", (signed int)(1000.0 * *(double *)(v50 + 4) + 0.5));
      v20 = *((_DWORD *)a2 + 4);
      if ( !v20 )
      {
        sub_8067E80(a2);
        *((_DWORD *)a2 + 4) = v20;
      }
      v55 = &v58;
      v21 = (int)((char *)&v58 + v19);
      while ( 1 )
      {
        v22 = sub_808C480((int)((char *)a2 + 20), 1u, (const void **)&v55, v21, (void **)v20, *(_DWORD *)(v20 + 4));
        if ( v22 != 4 )
          break;
        sub_8067E80(a2);
        *((_DWORD *)a2 + 4) = v20;
      }
      if ( v22 )
        break;
      v50 += 12;
      if ( v52 == (std::locale *)v50 )
        return sub_8098450(a2, 7);
    }
    if ( log_level <= 5 )
    {
      v49 = (int)&v59;
      std::ios_base::ios_base((std::ios_base *)&v70);
      v70 = (int)&unk_80CF5C8;
      v71 = 0;
      v72 = 0;
      v73 = 0;
      v74 = 0;
      v75 = 0;
      v76 = 0;
      v77 = 0;
      v23 = dword_80CF674;
      v59 = dword_80CF674;
      *(int *)((char *)&v59 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
      std::basic_ios<char,std::char_traits<char>>::init((char *)&v59 + *(_DWORD *)(v59 - 12), 0);
      v59 = (int)&unk_80CF5DC;
      v70 = (int)&unk_80CF5F0;
      v60 = (int)&unk_80CF7F0;
      v61 = 0;
      v62 = 0;
      v63 = 0;
      v64 = 0;
      v65 = 0;
      v66 = 0;
      std::locale::locale((std::locale *)&v67);
      v60 = (int)&unk_80CF588;
      v68 = 16;
      v69 = (int)&unk_80CF83C;
      std::basic_ios<char,std::char_traits<char>>::init(&v70, &v60);
      v24 = std::__ostream_insert<char,std::char_traits<char>>(
              &v59,
              &unk_80CF83C,
              std::string::_Rep::_S_empty_rep_storage);
      std::__ostream_insert<char,std::char_traits<char>>(v24, "VERIFY failed (", 15);
      std::__ostream_insert<char,std::char_traits<char>>(v24, "res == JSTN_STATUS_SUCCESS", 26);
      std::__ostream_insert<char,std::char_traits<char>>(v24, "): ", 3);
      std::__ostream_insert<char,std::char_traits<char>>(v24, "Could not write value", 21);
      v56 = (int)&unk_80CF83C;
      v25 = *(_DWORD *)(v24 + 24);
      if ( v25 )
      {
        v26 = *(_DWORD *)(v24 + 16);
        LOBYTE(v45) = 0;
        if ( v25 <= (unsigned int)v26 )
        {
          v57 = std::string::_S_construct<char *>(v24, v23, &v70, *(_DWORD *)(v24 + 20), v26, (int)&v54);
          v47 = &v57;
          std::string::swap((std::string *)&v56, (std::string *)&v57);
        }
        else
        {
          v57 = std::string::_S_construct<char *>(v24, v23, &v70, *(_DWORD *)(v24 + 20), v25, (int)&v54);
          v47 = &v57;
          std::string::swap((std::string *)&v56, (std::string *)&v57);
        }
        v27 = v57 - 12;
        if ( (_DWORD *)(v57 - 12) != &std::string::_Rep::_S_empty_rep_storage )
        {
          if ( &_pthread_key_create )
          {
            v41 = _InterlockedExchangeAdd((volatile signed __int32 *)(v57 - 4), 0xFFFFFFFF);
          }
          else
          {
            v41 = *(_DWORD *)(v57 - 4);
            *(_DWORD *)(v57 - 4) = v41 - 1;
          }
          if ( v41 <= 0 )
            std::string::_Rep::_M_destroy(v27, &v53);
        }
      }
      else
      {
        std::string::assign((std::string *)&v56, (const std::string *)(v24 + 40));
      }
      v59 = (int)&unk_80CF5DC;
      v70 = (int)&unk_80CF5F0;
      v60 = (int)&unk_80CF588;
      v28 = v69 - 12;
      if ( (_DWORD *)(v69 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v40 = _InterlockedExchangeAdd((volatile signed __int32 *)(v69 - 4), 0xFFFFFFFF);
        }
        else
        {
          v40 = *(_DWORD *)(v69 - 4);
          *(_DWORD *)(v69 - 4) = v40 - 1;
        }
        if ( v40 <= 0 )
          std::string::_Rep::_M_destroy(v28, &v57);
      }
      v60 = (int)&unk_80CF7F0;
      std::locale::~locale((std::locale *)&v67);
      v59 = v23;
      *(int *)((char *)&v59 + *(_DWORD *)(v23 - 12)) = dword_80CF678;
      v70 = (int)&unk_80CF5C8;
      std::ios_base::~ios_base((std::ios_base *)&v70);
      if ( byte_80CE64C )
      {
        v29 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v56, *(_DWORD *)(v56 - 12));
        v30 = (std::ostream *)v29;
        v31 = *(_DWORD *)(*(_DWORD *)v29 - 12);
        v32 = *(_DWORD *)((char *)v30 + v31 + 124);
        if ( !v32 )
        {
          v42 = std::__throw_bad_cast();
          std::string::_Rep::_M_dispose(v57 - 12, &v53);
          std::string::_Rep::_M_dispose(v56 - 12, v47);
          std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v59);
          std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, v30);
          Unwind_Resume(v42);
        }
        if ( *(_BYTE *)(v32 + 28) )
        {
          v33 = *(_BYTE *)(v32 + 39);
        }
        else
        {
          std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v30 + v31 + 124));
          v33 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v32 + 24))(v32, 10);
        }
        v34 = (std::ostream *)std::ostream::put(v30, v33);
        std::ostream::flush(v34);
      }
      syslog(3, "%s", v56, v45);
      goto LABEL_19;
    }
LABEL_20:
    abort();
  }
  return sub_8098450(a2, 7);
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080B7910) --------------------------------------------------------
int __cdecl sub_80B7910(int a1, void *a2)
{
  int v2; // eax@1
  signed int v3; // eax@3
  int v4; // esi@6
  int v5; // ebx@6
  int v6; // eax@6
  int v7; // edx@7
  int v8; // edx@9
  int v9; // edx@10
  int v10; // eax@12
  std::ostream *v11; // esi@12
  int v12; // eax@12
  int v13; // ebx@12
  char v14; // al@14
  std::ostream *v15; // eax@15
  int v16; // eax@17
  int v17; // edx@17
  int v18; // ebp@21
  int v19; // eax@21
  int v20; // ebp@22
  signed int v21; // eax@23
  std::ios_base *v22; // edi@26
  unsigned int v23; // ebp@26
  int v24; // ebx@26
  int v25; // eax@26
  int v26; // edx@27
  int v27; // ebx@29
  int v28; // edx@30
  int v29; // eax@32
  std::ostream *v30; // esi@32
  int v31; // eax@32
  int v32; // ebx@32
  char v33; // al@34
  std::ostream *v34; // eax@35
  signed __int32 v35; // eax@39
  int v36; // eax@45
  signed int v37; // eax@47
  int v38; // esi@50
  unsigned int v39; // ebp@50
  int v40; // ebx@50
  int v41; // eax@50
  int v42; // edx@51
  int v43; // ebx@53
  int v44; // edx@54
  int v45; // eax@56
  std::ostream *v46; // esi@56
  int v47; // eax@56
  int v48; // ebx@56
  char v49; // al@58
  std::ostream *v50; // eax@59
  int v51; // edx@63
  int v52; // eax@63
  int result; // eax@65
  int v54; // ebx@68
  int v55; // eax@68
  int v56; // edx@69
  int v57; // ebx@71
  int v58; // eax@72
  int v59; // eax@74
  std::ostream *v60; // esi@74
  int v61; // eax@74
  int v62; // ebx@74
  char v63; // al@76
  std::ostream *v64; // eax@77
  int v65; // ST18_4@91
  int v66; // ebx@94
  signed __int32 v67; // edx@97
  int v68; // ebx@102
  signed __int32 v69; // ecx@101
  signed __int32 v70; // ecx@104
  signed __int32 v71; // ecx@109
  signed __int32 v72; // ecx@113
  signed __int32 v73; // ecx@120
  signed __int32 v74; // ecx@126
  signed __int32 v75; // ecx@130
  signed __int32 v76; // ecx@136
  int v77; // [sp+Ch] [bp-150h]@3
  int v78; // [sp+Ch] [bp-150h]@23
  int v79; // [sp+Ch] [bp-150h]@47
  int *v80; // [sp+18h] [bp-144h]@6
  double v81; // [sp+18h] [bp-144h]@45
  int v82; // [sp+18h] [bp-144h]@64
  std::locale *v83; // [sp+20h] [bp-13Ch]@26
  int v84; // [sp+3Ch] [bp-120h]@2
  char *v85; // [sp+40h] [bp-11Ch]@22
  char *v86; // [sp+44h] [bp-118h]@28
  int v87; // [sp+48h] [bp-114h]@8
  char s[4]; // [sp+4Ch] [bp-110h]@6
  char v89[4]; // [sp+6Ch] [bp-F0h]@8
  int v90; // [sp+8Ch] [bp-D0h]@6
  int v91; // [sp+90h] [bp-CCh]@6
  int v92; // [sp+94h] [bp-C8h]@6
  int v93; // [sp+98h] [bp-C4h]@6
  int v94; // [sp+9Ch] [bp-C0h]@6
  int v95; // [sp+A0h] [bp-BCh]@6
  int v96; // [sp+A4h] [bp-B8h]@6
  int v97; // [sp+A8h] [bp-B4h]@6
  char v98; // [sp+ACh] [bp-B0h]@6
  int v99; // [sp+B0h] [bp-ACh]@6
  int v100; // [sp+B4h] [bp-A8h]@6
  int v101; // [sp+B8h] [bp-A4h]@6
  int v102; // [sp+128h] [bp-34h]@6
  char v103; // [sp+12Ch] [bp-30h]@6
  char v104; // [sp+12Dh] [bp-2Fh]@6
  int v105; // [sp+130h] [bp-2Ch]@6
  int v106; // [sp+134h] [bp-28h]@6
  int v107; // [sp+138h] [bp-24h]@6
  int v108; // [sp+13Ch] [bp-20h]@6

  v2 = *((_DWORD *)a2 + 4);
  if ( !v2 )
  {
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v2;
  }
  v84 = (int)"bytes_downloaded";
  while ( 1 )
  {
    v3 = sub_808C480((int)((char *)a2 + 20), 3u, (const void **)&v84, 134996962, (void **)v2, *(_DWORD *)(v2 + 4));
    if ( v3 != 4 )
      break;
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v2;
  }
  if ( v3 )
  {
    if ( log_level > 5 )
      goto LABEL_18;
    v80 = &v90;
    std::ios_base::ios_base((std::ios_base *)&v101);
    v101 = (int)&unk_80CF5C8;
    v102 = 0;
    v103 = 0;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v4 = dword_80CF674;
    v90 = dword_80CF674;
    *(int *)((char *)&v90 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v90 + *(_DWORD *)(v90 - 12), 0);
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF7F0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    std::locale::locale((std::locale *)&v98);
    v91 = (int)&unk_80CF588;
    v99 = 16;
    v100 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v101, &v91);
    v5 = std::__ostream_insert<char,std::char_traits<char>>(&v90, &unk_80CF83C, std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v5, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v5, "res == JSTN_STATUS_SUCCESS", 26);
    std::__ostream_insert<char,std::char_traits<char>>(v5, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v5, "Could not write value", 21);
    *(_DWORD *)s = &unk_80CF83C;
    v6 = *(_DWORD *)(v5 + 24);
    if ( v6 )
    {
      v7 = *(_DWORD *)(v5 + 16);
      LOBYTE(v77) = 0;
      if ( v6 > (unsigned int)v7 )
      {
        *(_DWORD *)v89 = std::string::_S_construct<char *>(
                           v5,
                           (unsigned int)&v87,
                           &v101,
                           *(_DWORD *)(v5 + 20),
                           v6,
                           (int)&v87);
        std::string::swap((std::string *)s, (std::string *)v89);
      }
      else
      {
        *(_DWORD *)v89 = std::string::_S_construct<char *>(
                           v5,
                           (unsigned int)&v87,
                           &v101,
                           *(_DWORD *)(v5 + 20),
                           v7,
                           (int)&v87);
        std::string::swap((std::string *)s, (std::string *)v89);
      }
      v8 = *(_DWORD *)v89 - 12;
      if ( (_DWORD *)(*(_DWORD *)v89 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v76 = _InterlockedExchangeAdd((volatile signed __int32 *)(*(_DWORD *)v89 - 4), 0xFFFFFFFF);
        }
        else
        {
          v76 = *(_DWORD *)(*(_DWORD *)v89 - 4);
          *(_DWORD *)(*(_DWORD *)v89 - 4) = v76 - 1;
        }
        if ( v76 <= 0 )
          std::string::_Rep::_M_destroy(v8, &v86);
      }
    }
    else
    {
      std::string::assign((std::string *)s, (const std::string *)(v5 + 40));
    }
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF588;
    v9 = v100 - 12;
    if ( (_DWORD *)(v100 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v70 = _InterlockedExchangeAdd((volatile signed __int32 *)(v100 - 4), 0xFFFFFFFF);
      }
      else
      {
        v70 = *(_DWORD *)(v100 - 4);
        *(_DWORD *)(v100 - 4) = v70 - 1;
      }
      if ( v70 <= 0 )
        std::string::_Rep::_M_destroy(v9, v89);
    }
    v91 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v98);
    v90 = v4;
    *(int *)((char *)&v90 + *(_DWORD *)(v4 - 12)) = dword_80CF678;
    v101 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v101);
    if ( byte_80CE64C )
    {
      v10 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, *(_DWORD *)s, *(_DWORD *)(*(_DWORD *)s - 12));
      v11 = (std::ostream *)v10;
      v12 = *(_DWORD *)(*(_DWORD *)v10 - 12);
      v13 = *(_DWORD *)((char *)v11 + v12 + 124);
      if ( !v13 )
      {
        v68 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(*(_DWORD *)s - 12, v11);
        std::string::_Rep::_M_dispose(v87 - 12, s);
        std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(&v90);
        std::string::_Rep::_M_dispose(&std::string::_Rep::_S_empty_rep_storage, &v85);
        Unwind_Resume(v68);
      }
      if ( *(_BYTE *)(v13 + 28) )
      {
        v14 = *(_BYTE *)(v13 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v11 + v12 + 124));
        v14 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v13 + 24))(v13, 10);
      }
      v15 = (std::ostream *)std::ostream::put(v11, v14);
      std::ostream::flush(v15);
    }
    syslog(3, "%s", *(_DWORD *)s, v77);
LABEL_17:
    v16 = *(_DWORD *)s;
    v17 = *(_DWORD *)s - 12;
    if ( (_DWORD *)(*(_DWORD *)s - 12) == &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_18;
LABEL_38:
    if ( &_pthread_key_create )
    {
      v35 = _InterlockedExchangeAdd((volatile signed __int32 *)(v16 - 4), 0xFFFFFFFF);
    }
    else
    {
      v69 = *(_DWORD *)(v16 - 4);
      *(_DWORD *)(v16 - 4) = v69 - 1;
      v35 = v69;
    }
    if ( v35 <= 0 )
      std::string::_Rep::_M_destroy(v17, v80);
LABEL_18:
    abort();
  }
  v18 = snprintf(s, 0x1Fu, "%u", *(_DWORD *)(a1 + 16));
  v19 = *((_DWORD *)a2 + 4);
  if ( !v19 )
  {
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v19;
  }
  v85 = s;
  v20 = (int)&s[v18];
  while ( 1 )
  {
    v21 = sub_808C480((int)((char *)a2 + 20), 1u, (const void **)&v85, v20, (void **)v19, *(_DWORD *)(v19 + 4));
    if ( v21 != 4 )
      break;
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v19;
  }
  if ( v21 )
  {
    if ( log_level > 5 )
      goto LABEL_18;
    v80 = &v90;
    v22 = (std::ios_base *)&v101;
    std::ios_base::ios_base((std::ios_base *)&v101);
    v101 = (int)&unk_80CF5C8;
    v102 = 0;
    v103 = 0;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v23 = dword_80CF674;
    v90 = dword_80CF674;
    *(int *)((char *)&v90 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v90 + *(_DWORD *)(v90 - 12), 0);
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF7F0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    v83 = (std::locale *)&v98;
    std::locale::locale((std::locale *)&v98);
    v91 = (int)&unk_80CF588;
    v99 = 16;
    v100 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v101, &v91);
    v24 = std::__ostream_insert<char,std::char_traits<char>>(
            &v90,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v24, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v24, "res == JSTN_STATUS_SUCCESS", 26);
    std::__ostream_insert<char,std::char_traits<char>>(v24, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v24, "Could not write value", 21);
    v87 = (int)&unk_80CF83C;
    v25 = *(_DWORD *)(v24 + 24);
    if ( v25 )
    {
      v26 = *(_DWORD *)(v24 + 16);
      LOBYTE(v78) = 0;
      if ( v25 > (unsigned int)v26 )
      {
        *(_DWORD *)v89 = std::string::_S_construct<char *>(v24, v23, &v101, *(_DWORD *)(v24 + 20), v25, (int)&v86);
        std::string::swap((std::string *)&v87, (std::string *)v89);
      }
      else
      {
        *(_DWORD *)v89 = std::string::_S_construct<char *>(v24, v23, &v101, *(_DWORD *)(v24 + 20), v26, (int)&v86);
        std::string::swap((std::string *)&v87, (std::string *)v89);
      }
      v27 = *(_DWORD *)v89 - 12;
      if ( (_DWORD *)(*(_DWORD *)v89 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v75 = _InterlockedExchangeAdd((volatile signed __int32 *)(*(_DWORD *)v89 - 4), 0xFFFFFFFF);
        }
        else
        {
          v75 = *(_DWORD *)(*(_DWORD *)v89 - 4);
          *(_DWORD *)(*(_DWORD *)v89 - 4) = v75 - 1;
        }
        if ( v75 <= 0 )
          std::string::_Rep::_M_destroy(v27, &v84);
      }
    }
    else
    {
      std::string::assign((std::string *)&v87, (const std::string *)(v24 + 40));
    }
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF588;
    v28 = v100 - 12;
    if ( (_DWORD *)(v100 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v74 = _InterlockedExchangeAdd((volatile signed __int32 *)(v100 - 4), 0xFFFFFFFF);
      }
      else
      {
        v74 = *(_DWORD *)(v100 - 4);
        *(_DWORD *)(v100 - 4) = v74 - 1;
      }
      if ( v74 <= 0 )
        std::string::_Rep::_M_destroy(v28, v89);
    }
    v91 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v98);
    v90 = v23;
    *(int *)((char *)&v90 + *(_DWORD *)(v23 - 12)) = dword_80CF678;
    v101 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v101);
    if ( !byte_80CE64C )
      goto LABEL_36;
    v29 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v87, *(_DWORD *)(v87 - 12));
    v30 = (std::ostream *)v29;
    v31 = *(_DWORD *)(*(_DWORD *)v29 - 12);
    v32 = *(_DWORD *)((char *)v30 + v31 + 124);
    if ( v32 )
    {
      if ( *(_BYTE *)(v32 + 28) )
      {
        v33 = *(_BYTE *)(v32 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v30 + v31 + 124));
        v33 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v32 + 24))(v32, 10);
      }
      v34 = (std::ostream *)std::ostream::put(v30, v33);
      std::ostream::flush(v34);
LABEL_36:
      syslog(3, "%s", v87, v78);
      goto LABEL_37;
    }
    v58 = std::__throw_bad_cast();
    goto LABEL_124;
  }
  v81 = *(double *)(a1 + 20);
  v36 = *((_DWORD *)a2 + 4);
  if ( !v36 )
  {
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v36;
  }
  v87 = (int)"time_ms";
  while ( 1 )
  {
    v37 = sub_808C480((int)((char *)a2 + 20), 3u, (const void **)&v87, 134996970, (void **)v36, *(_DWORD *)(v36 + 4));
    if ( v37 != 4 )
      break;
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v36;
  }
  if ( v37 )
  {
    if ( log_level > 5 )
      goto LABEL_18;
    v80 = &v90;
    std::ios_base::ios_base((std::ios_base *)&v101);
    v101 = (int)&unk_80CF5C8;
    v102 = 0;
    v103 = 0;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v38 = dword_80CF674;
    v90 = dword_80CF674;
    v39 = dword_80CF678;
    *(int *)((char *)&v90 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v90 + *(_DWORD *)(v90 - 12), 0);
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF7F0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    std::locale::locale((std::locale *)&v98);
    v91 = (int)&unk_80CF588;
    v99 = 16;
    v100 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v101, &v91);
    v40 = std::__ostream_insert<char,std::char_traits<char>>(
            &v90,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v40, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v40, "res == JSTN_STATUS_SUCCESS", 26);
    std::__ostream_insert<char,std::char_traits<char>>(v40, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v40, "Could not write value", 21);
    *(_DWORD *)s = &unk_80CF83C;
    v41 = *(_DWORD *)(v40 + 24);
    if ( v41 )
    {
      v42 = *(_DWORD *)(v40 + 16);
      LOBYTE(v79) = 0;
      if ( v41 > (unsigned int)v42 )
      {
        *(_DWORD *)v89 = std::string::_S_construct<char *>(v40, v39, &v101, *(_DWORD *)(v40 + 20), v41, (int)&v86);
        std::string::swap((std::string *)s, (std::string *)v89);
      }
      else
      {
        *(_DWORD *)v89 = std::string::_S_construct<char *>(v40, v39, &v101, *(_DWORD *)(v40 + 20), v42, (int)&v86);
        std::string::swap((std::string *)s, (std::string *)v89);
      }
      v43 = *(_DWORD *)v89 - 12;
      if ( (_DWORD *)(*(_DWORD *)v89 - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v72 = _InterlockedExchangeAdd((volatile signed __int32 *)(*(_DWORD *)v89 - 4), 0xFFFFFFFF);
        }
        else
        {
          v72 = *(_DWORD *)(*(_DWORD *)v89 - 4);
          *(_DWORD *)(*(_DWORD *)v89 - 4) = v72 - 1;
        }
        if ( v72 <= 0 )
          std::string::_Rep::_M_destroy(v43, &v85);
      }
    }
    else
    {
      std::string::assign((std::string *)s, (const std::string *)(v40 + 40));
    }
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF588;
    v44 = v100 - 12;
    if ( (_DWORD *)(v100 - 12) != &std::string::_Rep::_S_empty_rep_storage )
    {
      if ( &_pthread_key_create )
      {
        v71 = _InterlockedExchangeAdd((volatile signed __int32 *)(v100 - 4), 0xFFFFFFFF);
      }
      else
      {
        v71 = *(_DWORD *)(v100 - 4);
        *(_DWORD *)(v100 - 4) = v71 - 1;
      }
      if ( v71 <= 0 )
        std::string::_Rep::_M_destroy(v44, v89);
    }
    v91 = (int)&unk_80CF7F0;
    std::locale::~locale((std::locale *)&v98);
    v90 = v38;
    *(int *)((char *)&v90 + *(_DWORD *)(v38 - 12)) = v39;
    v101 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base((std::ios_base *)&v101);
    if ( byte_80CE64C )
    {
      v45 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, *(_DWORD *)s, *(_DWORD *)(*(_DWORD *)s - 12));
      v46 = (std::ostream *)v45;
      v47 = *(_DWORD *)(*(_DWORD *)v45 - 12);
      v48 = *(_DWORD *)((char *)v46 + v47 + 124);
      if ( !v48 )
      {
        v66 = std::__throw_bad_cast();
        std::string::_Rep::_M_dispose(*(_DWORD *)s - 12, &v90);
        goto LABEL_95;
      }
      if ( *(_BYTE *)(v48 + 28) )
      {
        v49 = *(_BYTE *)(v48 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v46 + v47 + 124));
        v49 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v48 + 24))(v48, 10);
      }
      v50 = (std::ostream *)std::ostream::put(v46, v49);
      std::ostream::flush(v50);
    }
    syslog(3, "%s", *(_DWORD *)s, v79);
    goto LABEL_17;
  }
  v51 = snprintf(v89, 0x1Fu, "%d", (signed int)(v81 * 1000.0 + 0.5));
  v52 = *((_DWORD *)a2 + 4);
  if ( !v52 )
  {
    v65 = v51;
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v52;
    v51 = v65;
  }
  v86 = v89;
  v82 = (int)&v89[v51];
  while ( 1 )
  {
    result = sub_808C480((int)((char *)a2 + 20), 1u, (const void **)&v86, v82, (void **)v52, *(_DWORD *)(v52 + 4));
    if ( result != 4 )
      break;
    sub_8067E80(a2);
    *((_DWORD *)a2 + 4) = v52;
  }
  if ( result )
  {
    if ( log_level > 5 )
      goto LABEL_18;
    v80 = &v90;
    v22 = (std::ios_base *)&v101;
    std::ios_base::ios_base((std::ios_base *)&v101);
    v101 = (int)&unk_80CF5C8;
    v102 = 0;
    v103 = 0;
    v104 = 0;
    v105 = 0;
    v106 = 0;
    v107 = 0;
    v108 = 0;
    v90 = dword_80CF674;
    *(int *)((char *)&v90 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    std::basic_ios<char,std::char_traits<char>>::init((char *)&v90 + *(_DWORD *)(v90 - 12), 0);
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF7F0;
    v92 = 0;
    v93 = 0;
    v94 = 0;
    v95 = 0;
    v96 = 0;
    v97 = 0;
    v83 = (std::locale *)&v98;
    std::locale::locale((std::locale *)&v98);
    v91 = (int)&unk_80CF588;
    v99 = 16;
    v100 = (int)&unk_80CF83C;
    std::basic_ios<char,std::char_traits<char>>::init(&v101, &v91);
    v54 = std::__ostream_insert<char,std::char_traits<char>>(
            &v90,
            &unk_80CF83C,
            std::string::_Rep::_S_empty_rep_storage);
    std::__ostream_insert<char,std::char_traits<char>>(v54, "VERIFY failed (", 15);
    std::__ostream_insert<char,std::char_traits<char>>(v54, "res == JSTN_STATUS_SUCCESS", 26);
    std::__ostream_insert<char,std::char_traits<char>>(v54, "): ", 3);
    std::__ostream_insert<char,std::char_traits<char>>(v54, "Could not write value", 21);
    v87 = (int)&unk_80CF83C;
    v55 = *(_DWORD *)(v54 + 24);
    if ( v55 )
    {
      v56 = *(_DWORD *)(v54 + 16);
      LOBYTE(v78) = 0;
      if ( v55 <= (unsigned int)v56 )
      {
        *(_DWORD *)s = std::string::_S_construct<char *>(
                         v54,
                         (unsigned int)&v87,
                         &v101,
                         *(_DWORD *)(v54 + 20),
                         v56,
                         (int)&v85);
        std::string::swap((std::string *)&v87, (std::string *)s);
      }
      else
      {
        *(_DWORD *)s = std::string::_S_construct<char *>(
                         v54,
                         (unsigned int)&v87,
                         &v101,
                         *(_DWORD *)(v54 + 20),
                         v55,
                         (int)&v85);
        std::string::swap((std::string *)&v87, (std::string *)s);
      }
      v57 = *(_DWORD *)s - 12;
      if ( (_DWORD *)(*(_DWORD *)s - 12) != &std::string::_Rep::_S_empty_rep_storage )
      {
        if ( &_pthread_key_create )
        {
          v67 = _InterlockedExchangeAdd((volatile signed __int32 *)(*(_DWORD *)s - 4), 0xFFFFFFFF);
        }
        else
        {
          v67 = *(_DWORD *)(*(_DWORD *)s - 4);
          *(_DWORD *)(*(_DWORD *)s - 4) = v67 - 1;
        }
        if ( v67 <= 0 )
          std::string::_Rep::_M_destroy(v57, &v84);
      }
    }
    else
    {
      std::string::assign((std::string *)&v87, (const std::string *)(v54 + 40));
    }
    v90 = (int)&unk_80CF5DC;
    v101 = (int)&unk_80CF5F0;
    v91 = (int)&unk_80CF588;
    v58 = v100;
    v32 = v100 - 12;
    if ( (_DWORD *)(v100 - 12) == &std::string::_Rep::_S_empty_rep_storage )
      goto LABEL_73;
    if ( &_pthread_key_create )
    {
      v73 = _InterlockedExchangeAdd((volatile signed __int32 *)(v100 - 4), 0xFFFFFFFF);
      goto LABEL_121;
    }
LABEL_124:
    v73 = *(_DWORD *)(v58 - 4);
    *(_DWORD *)(v58 - 4) = v73 - 1;
LABEL_121:
    if ( v73 <= 0 )
      std::string::_Rep::_M_destroy(v32, s);
LABEL_73:
    v91 = (int)&unk_80CF7F0;
    std::locale::~locale(v83);
    v90 = dword_80CF674;
    *(int *)((char *)&v90 + *(_DWORD *)(dword_80CF674 - 12)) = dword_80CF678;
    v101 = (int)&unk_80CF5C8;
    std::ios_base::~ios_base(v22);
    if ( !byte_80CE64C )
    {
LABEL_78:
      syslog(3, "%s", v87, v78);
LABEL_37:
      v16 = v87;
      v17 = v87 - 12;
      if ( (_DWORD *)(v87 - 12) == &std::string::_Rep::_S_empty_rep_storage )
        goto LABEL_18;
      goto LABEL_38;
    }
    v59 = std::__ostream_insert<char,std::char_traits<char>>(&std::cout, v87, *(_DWORD *)(v87 - 12));
    v60 = (std::ostream *)v59;
    v61 = *(_DWORD *)(*(_DWORD *)v59 - 12);
    v62 = *(_DWORD *)((char *)v60 + v61 + 124);
    if ( v62 )
    {
      if ( *(_BYTE *)(v62 + 28) )
      {
        v63 = *(_BYTE *)(v62 + 39);
      }
      else
      {
        std::ctype<char>::_M_widen_init(*(_DWORD *)((char *)v60 + v61 + 124));
        v63 = (*(int (__cdecl **)(int, signed int))(*(_DWORD *)v62 + 24))(v62, 10);
      }
      v64 = (std::ostream *)std::ostream::put(v60, v63);
      std::ostream::flush(v64);
      goto LABEL_78;
    }
    v66 = std::__throw_bad_cast();
    std::string::_Rep::_M_dispose(v87 - 12, v80);
LABEL_95:
    Unwind_Resume(v66);
  }
  return result;
}
// 804C630: using guessed type int __cdecl std::string::_Rep::_M_dispose(_DWORD, _DWORD);
// 804C670: using guessed type int __cdecl std::ctype<char>::_M_widen_init(_DWORD);
// 804CA70: using guessed type int __cdecl std::string::_Rep::_M_destroy(_DWORD, _DWORD);
// 804CD90: using guessed type int __cdecl std::basic_ios<char,std::char_traits<char>>::init(_DWORD, _DWORD);
// 804CE90: using guessed type int __stdcall std::basic_ostringstream<char,std::char_traits<char>,std::allocator<char>>::~basic_ostringstream(_DWORD);
// 804D350: using guessed type int __cdecl Unwind_Resume(_DWORD);
// 804D410: using guessed type int __cdecl std::__ostream_insert<char,std::char_traits<char>>(_DWORD, _DWORD, _DWORD);
// 80CE64C: using guessed type char byte_80CE64C;
// 80CF674: using guessed type int dword_80CF674;
// 80CF678: using guessed type int dword_80CF678;
// 80CF6E8: using guessed type _DWORD std::cout;
// 80CF830: using guessed type _DWORD std::string::_Rep::_S_empty_rep_storage;
// 80CF874: using guessed type int log_level;

//----- (080B8F80) --------------------------------------------------------
int __cdecl sub_80B8F80(int a1)
{
  int v1; // eax@1
  int v2; // eax@3
  int v3; // eax@5
  void (__cdecl *v4)(_DWORD, _DWORD, _DWORD); // eax@7
  int v5; // eax@9
  int result; // eax@10

  *(_DWORD *)a1 = &off_80BEAA8;
  sub_80725E0(a1 + 44);
  v1 = *(_DWORD *)(a1 + 36);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEA98;
  v2 = *(_DWORD *)(a1 + 32);
  if ( v2 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v2 + 4));
    if ( !v2 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEA88;
  v3 = *(_DWORD *)(a1 + 28);
  if ( v3 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
    if ( !v3 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v4 = *(void (__cdecl **)(_DWORD, _DWORD, _DWORD))(a1 + 20);
  if ( v4 )
    v4(a1 + 12, a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v5 = *(_DWORD *)(a1 + 4);
  if ( v5 )
  {
    *(_DWORD *)(v5 + 8) = *(_DWORD *)(a1 + 8);
    result = *(_DWORD *)(a1 + 8);
    if ( !result )
    {
LABEL_12:
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)(a1 + 8) = 0;
      return result;
    }
LABEL_11:
    *(_DWORD *)(result + 4) = *(_DWORD *)(a1 + 4);
    goto LABEL_12;
  }
  result = *(_DWORD *)(a1 + 8);
  if ( result )
    goto LABEL_11;
  return result;
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA88: using guessed type int (__cdecl *off_80BEA88)(int);
// 80BEA98: using guessed type int (__cdecl *off_80BEA98)(int);
// 80BEAA8: using guessed type int (__cdecl *off_80BEAA8)(int);

//----- (080B9060) --------------------------------------------------------
void __cdecl sub_80B9060(void *a1)
{
  int v1; // eax@1
  int v2; // eax@3
  int v3; // eax@5
  void (__cdecl *v4)(_DWORD, _DWORD, _DWORD); // eax@7
  int v5; // eax@9
  int v6; // eax@10

  *(_DWORD *)a1 = &off_80BEAA8;
  sub_80725E0((int)((char *)a1 + 44));
  v1 = *((_DWORD *)a1 + 9);
  if ( v1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v1 + 4));
    if ( !v1 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEA98;
  v2 = *((_DWORD *)a1 + 8);
  if ( v2 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v2 + 4));
    if ( !v2 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  *(_DWORD *)a1 = &off_80BEA88;
  v3 = *((_DWORD *)a1 + 7);
  if ( v3 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(v3 + 4));
    if ( !v3 )
      (*(void (__cdecl **)(_DWORD))(v0 + 4))(0);
  }
  v4 = (void (__cdecl *)(_DWORD, _DWORD, _DWORD))*((_DWORD *)a1 + 5);
  if ( v4 )
    v4((char *)a1 + 12, (char *)a1 + 12, 3);
  *(_DWORD *)a1 = &off_80B9500;
  v5 = *((_DWORD *)a1 + 1);
  if ( !v5 )
  {
    v6 = *((_DWORD *)a1 + 2);
    if ( !v6 )
      goto LABEL_13;
    goto LABEL_11;
  }
  *(_DWORD *)(v5 + 8) = *((_DWORD *)a1 + 2);
  v6 = *((_DWORD *)a1 + 2);
  if ( v6 )
LABEL_11:
    *(_DWORD *)(v6 + 4) = *((_DWORD *)a1 + 1);
  *((_DWORD *)a1 + 1) = 0;
  *((_DWORD *)a1 + 2) = 0;
LABEL_13:
  operator delete(a1);
}
// 80B9500: using guessed type int (__cdecl *off_80B9500)(int);
// 80BEA88: using guessed type int (__cdecl *off_80BEA88)(int);
// 80BEA98: using guessed type int (__cdecl *off_80BEA98)(int);
// 80BEAA8: using guessed type int (__cdecl *off_80BEAA8)(int);

//----- (080B914C) --------------------------------------------------------
int __fastcall sub_80B914C(int a1, int a2)
{
  int (**i)(); // ebx@1
  int v4; // [sp-4h] [bp-8h]@1

  v4 = a2;
  for ( i = &off_80CE060; *i != (int (*)())-1; --i )
    (*i)();
  return v4;
}
// 80CE060: using guessed type int (*off_80CE060)();

//----- (080B9168) --------------------------------------------------------
int __fastcall term_proc(int a1, int a2)
{
  return sub_804E00B(a1, a2);
}

#error "There were 1 decompilation failure(s) on 574 function(s)"
